var bF=Object.create;var og=Object.defineProperty,wF=Object.defineProperties,_F=Object.getOwnPropertyDescriptor,TF=Object.getOwnPropertyDescriptors,xF=Object.getOwnPropertyNames,pT=Object.getOwnPropertySymbols,SF=Object.getPrototypeOf,mT=Object.prototype.hasOwnProperty,EF=Object.prototype.propertyIsEnumerable;var gT=(r,e,n)=>e in r?og(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n,C=(r,e)=>{for(var n in e||={})mT.call(e,n)&&gT(r,n,e[n]);if(pT)for(var n of pT(e))EF.call(e,n)&&gT(r,n,e[n]);return r},k=(r,e)=>wF(r,TF(e));var To=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(e,n)=>(typeof require<"u"?require:e)[n]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var St=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var DF=(r,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of xF(e))!mT.call(r,i)&&i!==n&&og(r,i,{get:()=>e[i],enumerable:!(t=_F(e,i))||t.enumerable});return r};var CF=(r,e,n)=>(n=r!=null?bF(SF(r)):{},DF(e||!r||!r.__esModule?og(n,"default",{value:r,enumerable:!0}):n,r));var F=(r,e,n)=>new Promise((t,i)=>{var o=c=>{try{l(n.next(c))}catch(a){i(a)}},s=c=>{try{l(n.throw(c))}catch(a){i(a)}},l=c=>c.done?t(c.value):Promise.resolve(c.value).then(o,s);l((n=n.apply(r,e)).next())});var $R=St((sre,VR)=>{"use strict";VR.exports=Jq;function Jq(r,e){for(var n=new Array(arguments.length-1),t=0,i=2,o=!0;i<arguments.length;)n[t++]=arguments[i++];return new Promise(function(l,c){n[t]=function(u){if(o)if(o=!1,u)c(u);else{for(var d=new Array(arguments.length-1),h=0;h<d.length;)d[h++]=arguments[h];l.apply(null,d)}};try{r.apply(e||null,n)}catch(a){o&&(o=!1,c(a))}})}});var GR=St(zR=>{"use strict";var jp=zR;jp.length=function(e){var n=e.length;if(!n)return 0;for(var t=0;--n%4>1&&e.charAt(n)==="=";)++t;return Math.ceil(e.length*3)/4-t};var El=new Array(64),HR=new Array(123);for(Dr=0;Dr<64;)HR[El[Dr]=Dr<26?Dr+65:Dr<52?Dr+71:Dr<62?Dr-4:Dr-59|43]=Dr++;var Dr;jp.encode=function(e,n,t){for(var i=null,o=[],s=0,l=0,c;n<t;){var a=e[n++];switch(l){case 0:o[s++]=El[a>>2],c=(a&3)<<4,l=1;break;case 1:o[s++]=El[c|a>>4],c=(a&15)<<2,l=2;break;case 2:o[s++]=El[c|a>>6],o[s++]=El[a&63],l=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return l&&(o[s++]=El[c],o[s++]=61,l===1&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var UR="invalid encoding";jp.decode=function(e,n,t){for(var i=t,o=0,s,l=0;l<e.length;){var c=e.charCodeAt(l++);if(c===61&&o>1)break;if((c=HR[c])===void 0)throw Error(UR);switch(o){case 0:s=c,o=1;break;case 1:n[t++]=s<<2|(c&48)>>4,s=c,o=2;break;case 2:n[t++]=(s&15)<<4|(c&60)>>2,s=c,o=3;break;case 3:n[t++]=(s&3)<<6|c,o=0;break}}if(o===1)throw Error(UR);return t-i};jp.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var qR=St((lre,WR)=>{"use strict";WR.exports=Vp;function Vp(){this._listeners={}}Vp.prototype.on=function(e,n,t){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:n,ctx:t||this}),this};Vp.prototype.off=function(e,n){if(e===void 0)this._listeners={};else if(n===void 0)this._listeners[e]=[];else for(var t=this._listeners[e],i=0;i<t.length;)t[i].fn===n?t.splice(i,1):++i;return this};Vp.prototype.emit=function(e){var n=this._listeners[e];if(n){for(var t=[],i=1;i<arguments.length;)t.push(arguments[i++]);for(i=0;i<n.length;)n[i].fn.apply(n[i++].ctx,t)}return this}});var ek=St((cre,QR)=>{"use strict";QR.exports=YR(YR);function YR(r){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),n=new Uint8Array(e.buffer),t=n[3]===128;function i(c,a,u){e[0]=c,a[u]=n[0],a[u+1]=n[1],a[u+2]=n[2],a[u+3]=n[3]}function o(c,a,u){e[0]=c,a[u]=n[3],a[u+1]=n[2],a[u+2]=n[1],a[u+3]=n[0]}r.writeFloatLE=t?i:o,r.writeFloatBE=t?o:i;function s(c,a){return n[0]=c[a],n[1]=c[a+1],n[2]=c[a+2],n[3]=c[a+3],e[0]}function l(c,a){return n[3]=c[a],n[2]=c[a+1],n[1]=c[a+2],n[0]=c[a+3],e[0]}r.readFloatLE=t?s:l,r.readFloatBE=t?l:s}():function(){function e(t,i,o,s){var l=i<0?1:0;if(l&&(i=-i),i===0)t(1/i>0?0:2147483648,o,s);else if(isNaN(i))t(2143289344,o,s);else if(i>34028234663852886e22)t((l<<31|2139095040)>>>0,o,s);else if(i<11754943508222875e-54)t((l<<31|Math.round(i/1401298464324817e-60))>>>0,o,s);else{var c=Math.floor(Math.log(i)/Math.LN2),a=Math.round(i*Math.pow(2,-c)*8388608)&8388607;t((l<<31|c+127<<23|a)>>>0,o,s)}}r.writeFloatLE=e.bind(null,XR),r.writeFloatBE=e.bind(null,KR);function n(t,i,o){var s=t(i,o),l=(s>>31)*2+1,c=s>>>23&255,a=s&8388607;return c===255?a?NaN:l*(1/0):c===0?l*1401298464324817e-60*a:l*Math.pow(2,c-150)*(a+8388608)}r.readFloatLE=n.bind(null,ZR),r.readFloatBE=n.bind(null,JR)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),n=new Uint8Array(e.buffer),t=n[7]===128;function i(c,a,u){e[0]=c,a[u]=n[0],a[u+1]=n[1],a[u+2]=n[2],a[u+3]=n[3],a[u+4]=n[4],a[u+5]=n[5],a[u+6]=n[6],a[u+7]=n[7]}function o(c,a,u){e[0]=c,a[u]=n[7],a[u+1]=n[6],a[u+2]=n[5],a[u+3]=n[4],a[u+4]=n[3],a[u+5]=n[2],a[u+6]=n[1],a[u+7]=n[0]}r.writeDoubleLE=t?i:o,r.writeDoubleBE=t?o:i;function s(c,a){return n[0]=c[a],n[1]=c[a+1],n[2]=c[a+2],n[3]=c[a+3],n[4]=c[a+4],n[5]=c[a+5],n[6]=c[a+6],n[7]=c[a+7],e[0]}function l(c,a){return n[7]=c[a],n[6]=c[a+1],n[5]=c[a+2],n[4]=c[a+3],n[3]=c[a+4],n[2]=c[a+5],n[1]=c[a+6],n[0]=c[a+7],e[0]}r.readDoubleLE=t?s:l,r.readDoubleBE=t?l:s}():function(){function e(t,i,o,s,l,c){var a=s<0?1:0;if(a&&(s=-s),s===0)t(0,l,c+i),t(1/s>0?0:2147483648,l,c+o);else if(isNaN(s))t(0,l,c+i),t(2146959360,l,c+o);else if(s>17976931348623157e292)t(0,l,c+i),t((a<<31|2146435072)>>>0,l,c+o);else{var u;if(s<22250738585072014e-324)u=s/5e-324,t(u>>>0,l,c+i),t((a<<31|u/4294967296)>>>0,l,c+o);else{var d=Math.floor(Math.log(s)/Math.LN2);d===1024&&(d=1023),u=s*Math.pow(2,-d),t(u*4503599627370496>>>0,l,c+i),t((a<<31|d+1023<<20|u*1048576&1048575)>>>0,l,c+o)}}}r.writeDoubleLE=e.bind(null,XR,0,4),r.writeDoubleBE=e.bind(null,KR,4,0);function n(t,i,o,s,l){var c=t(s,l+i),a=t(s,l+o),u=(a>>31)*2+1,d=a>>>20&2047,h=4294967296*(a&1048575)+c;return d===2047?h?NaN:u*(1/0):d===0?u*5e-324*h:u*Math.pow(2,d-1075)*(h+4503599627370496)}r.readDoubleLE=n.bind(null,ZR,0,4),r.readDoubleBE=n.bind(null,JR,4,0)}(),r}function XR(r,e,n){e[n]=r&255,e[n+1]=r>>>8&255,e[n+2]=r>>>16&255,e[n+3]=r>>>24}function KR(r,e,n){e[n]=r>>>24,e[n+1]=r>>>16&255,e[n+2]=r>>>8&255,e[n+3]=r&255}function ZR(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0}function JR(r,e){return(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}});var tk=St((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var rk=St(nk=>{"use strict";var t_=nk;t_.length=function(e){for(var n=0,t=0,i=0;i<e.length;++i)t=e.charCodeAt(i),t<128?n+=1:t<2048?n+=2:(t&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,n+=4):n+=3;return n};t_.read=function(e,n,t){var i=t-n;if(i<1)return"";for(var o=null,s=[],l=0,c;n<t;)c=e[n++],c<128?s[l++]=c:c>191&&c<224?s[l++]=(c&31)<<6|e[n++]&63:c>239&&c<365?(c=((c&7)<<18|(e[n++]&63)<<12|(e[n++]&63)<<6|e[n++]&63)-65536,s[l++]=55296+(c>>10),s[l++]=56320+(c&1023)):s[l++]=(c&15)<<12|(e[n++]&63)<<6|e[n++]&63,l>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),l=0);return o?(l&&o.push(String.fromCharCode.apply(String,s.slice(0,l))),o.join("")):String.fromCharCode.apply(String,s.slice(0,l))};t_.write=function(e,n,t){for(var i=t,o,s,l=0;l<e.length;++l)o=e.charCodeAt(l),o<128?n[t++]=o:o<2048?(n[t++]=o>>6|192,n[t++]=o&63|128):(o&64512)===55296&&((s=e.charCodeAt(l+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++l,n[t++]=o>>18|240,n[t++]=o>>12&63|128,n[t++]=o>>6&63|128,n[t++]=o&63|128):(n[t++]=o>>12|224,n[t++]=o>>6&63|128,n[t++]=o&63|128);return t-i}});var ok=St((dre,ik)=>{"use strict";ik.exports=Qq;function Qq(r,e,n){var t=n||8192,i=t>>>1,o=null,s=t;return function(c){if(c<1||c>i)return r(c);s+c>t&&(o=r(t),s=0);var a=e.call(o,s,s+=c);return s&7&&(s=(s|7)+1),a}}});var ak=St((hre,sk)=>{"use strict";sk.exports=Lt;var Iu=vo();function Lt(r,e){this.lo=r>>>0,this.hi=e>>>0}var Ms=Lt.zero=new Lt(0,0);Ms.toNumber=function(){return 0};Ms.zzEncode=Ms.zzDecode=function(){return this};Ms.length=function(){return 1};var e7=Lt.zeroHash="\0\0\0\0\0\0\0\0";Lt.fromNumber=function(e){if(e===0)return Ms;var n=e<0;n&&(e=-e);var t=e>>>0,i=(e-t)/4294967296>>>0;return n&&(i=~i>>>0,t=~t>>>0,++t>4294967295&&(t=0,++i>4294967295&&(i=0))),new Lt(t,i)};Lt.from=function(e){if(typeof e=="number")return Lt.fromNumber(e);if(Iu.isString(e))if(Iu.Long)e=Iu.Long.fromString(e);else return Lt.fromNumber(parseInt(e,10));return e.low||e.high?new Lt(e.low>>>0,e.high>>>0):Ms};Lt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var n=~this.lo+1>>>0,t=~this.hi>>>0;return n||(t=t+1>>>0),-(n+t*4294967296)}return this.lo+this.hi*4294967296};Lt.prototype.toLong=function(e){return Iu.Long?new Iu.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var yo=String.prototype.charCodeAt;Lt.fromHash=function(e){return e===e7?Ms:new Lt((yo.call(e,0)|yo.call(e,1)<<8|yo.call(e,2)<<16|yo.call(e,3)<<24)>>>0,(yo.call(e,4)|yo.call(e,5)<<8|yo.call(e,6)<<16|yo.call(e,7)<<24)>>>0)};Lt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Lt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Lt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Lt.prototype.length=function(){var e=this.lo,n=(this.lo>>>28|this.hi<<4)>>>0,t=this.hi>>>24;return t===0?n===0?e<16384?e<128?1:2:e<2097152?3:4:n<16384?n<128?5:6:n<2097152?7:8:t<128?9:10}});var vo=St(n_=>{"use strict";var K=n_;K.asPromise=$R();K.base64=GR();K.EventEmitter=qR();K.float=ek();K.inquire=tk();K.utf8=rk();K.pool=ok();K.LongBits=ak();K.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);K.global=K.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||n_;K.emptyArray=Object.freeze?Object.freeze([]):[];K.emptyObject=Object.freeze?Object.freeze({}):{};K.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};K.isString=function(e){return typeof e=="string"||e instanceof String};K.isObject=function(e){return e&&typeof e=="object"};K.isset=K.isSet=function(e,n){var t=e[n];return t!=null&&e.hasOwnProperty(n)?typeof t!="object"||(Array.isArray(t)?t.length:Object.keys(t).length)>0:!1};K.Buffer=function(){try{var r=K.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch{return null}}();K._Buffer_from=null;K._Buffer_allocUnsafe=null;K.newBuffer=function(e){return typeof e=="number"?K.Buffer?K._Buffer_allocUnsafe(e):new K.Array(e):K.Buffer?K._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};K.Array=typeof Uint8Array<"u"?Uint8Array:Array;K.Long=K.global.dcodeIO&&K.global.dcodeIO.Long||K.global.Long||K.inquire("long");K.key2Re=/^true|false|0|1$/;K.key32Re=/^-?(?:0|[1-9][0-9]*)$/;K.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;K.longToHash=function(e){return e?K.LongBits.from(e).toHash():K.LongBits.zeroHash};K.longFromHash=function(e,n){var t=K.LongBits.fromHash(e);return K.Long?K.Long.fromBits(t.lo,t.hi,n):t.toNumber(!!n)};function lk(r,e,n){for(var t=Object.keys(e),i=0;i<t.length;++i)(r[t[i]]===void 0||!n)&&(r[t[i]]=e[t[i]]);return r}K.merge=lk;K.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function ck(r){function e(n,t){if(!(this instanceof e))return new e(n,t);Object.defineProperty(this,"message",{get:function(){return n}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),t&&lk(this,t)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return r}}),e.prototype.toString=function(){return this.name+": "+this.message},e}K.newError=ck;K.ProtocolError=ck("ProtocolError");K.oneOfGetter=function(e){for(var n={},t=0;t<e.length;++t)n[e[t]]=1;return function(){for(var i=Object.keys(this),o=i.length-1;o>-1;--o)if(n[i[o]]===1&&this[i[o]]!==void 0&&this[i[o]]!==null)return i[o]}};K.oneOfSetter=function(e){return function(n){for(var t=0;t<e.length;++t)e[t]!==n&&delete this[e[t]]}};K.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};K._configure=function(){var r=K.Buffer;if(!r){K._Buffer_from=K._Buffer_allocUnsafe=null;return}K._Buffer_from=r.from!==Uint8Array.from&&r.from||function(n,t){return new r(n,t)},K._Buffer_allocUnsafe=r.allocUnsafe||function(n){return new r(n)}}});var c_=St((pre,fk)=>{"use strict";fk.exports=Ae;var sr=vo(),r_,$p=sr.LongBits,uk=sr.base64,dk=sr.utf8;function Ou(r,e,n){this.fn=r,this.len=e,this.next=void 0,this.val=n}function o_(){}function t7(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function Ae(){this.len=0,this.head=new Ou(o_,0,0),this.tail=this.head,this.states=null}var hk=function(){return sr.Buffer?function(){return(Ae.create=function(){return new r_})()}:function(){return new Ae}};Ae.create=hk();Ae.alloc=function(e){return new sr.Array(e)};sr.Array!==Array&&(Ae.alloc=sr.pool(Ae.alloc,sr.Array.prototype.subarray));Ae.prototype._push=function(e,n,t){return this.tail=this.tail.next=new Ou(e,n,t),this.len+=n,this};function s_(r,e,n){e[n]=r&255}function n7(r,e,n){for(;r>127;)e[n++]=r&127|128,r>>>=7;e[n]=r}function a_(r,e){this.len=r,this.next=void 0,this.val=e}a_.prototype=Object.create(Ou.prototype);a_.prototype.fn=n7;Ae.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new a_((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Ae.prototype.int32=function(e){return e<0?this._push(l_,10,$p.fromNumber(e)):this.uint32(e)};Ae.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function l_(r,e,n){for(;r.hi;)e[n++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)e[n++]=r.lo&127|128,r.lo=r.lo>>>7;e[n++]=r.lo}Ae.prototype.uint64=function(e){var n=$p.from(e);return this._push(l_,n.length(),n)};Ae.prototype.int64=Ae.prototype.uint64;Ae.prototype.sint64=function(e){var n=$p.from(e).zzEncode();return this._push(l_,n.length(),n)};Ae.prototype.bool=function(e){return this._push(s_,1,e?1:0)};function i_(r,e,n){e[n]=r&255,e[n+1]=r>>>8&255,e[n+2]=r>>>16&255,e[n+3]=r>>>24}Ae.prototype.fixed32=function(e){return this._push(i_,4,e>>>0)};Ae.prototype.sfixed32=Ae.prototype.fixed32;Ae.prototype.fixed64=function(e){var n=$p.from(e);return this._push(i_,4,n.lo)._push(i_,4,n.hi)};Ae.prototype.sfixed64=Ae.prototype.fixed64;Ae.prototype.float=function(e){return this._push(sr.float.writeFloatLE,4,e)};Ae.prototype.double=function(e){return this._push(sr.float.writeDoubleLE,8,e)};var r7=sr.Array.prototype.set?function(e,n,t){n.set(e,t)}:function(e,n,t){for(var i=0;i<e.length;++i)n[t+i]=e[i]};Ae.prototype.bytes=function(e){var n=e.length>>>0;if(!n)return this._push(s_,1,0);if(sr.isString(e)){var t=Ae.alloc(n=uk.length(e));uk.decode(e,t,0),e=t}return this.uint32(n)._push(r7,n,e)};Ae.prototype.string=function(e){var n=dk.length(e);return n?this.uint32(n)._push(dk.write,n,e):this._push(s_,1,0)};Ae.prototype.fork=function(){return this.states=new t7(this),this.head=this.tail=new Ou(o_,0,0),this.len=0,this};Ae.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Ou(o_,0,0),this.len=0),this};Ae.prototype.ldelim=function(){var e=this.head,n=this.tail,t=this.len;return this.reset().uint32(t),t&&(this.tail.next=e.next,this.tail=n,this.len+=t),this};Ae.prototype.finish=function(){for(var e=this.head.next,n=this.constructor.alloc(this.len),t=0;e;)e.fn(e.val,n,t),t+=e.len,e=e.next;return n};Ae._configure=function(r){r_=r,Ae.create=hk(),r_._configure()}});var mk=St((gre,gk)=>{"use strict";gk.exports=zr;var pk=c_();(zr.prototype=Object.create(pk.prototype)).constructor=zr;var bo=vo();function zr(){pk.call(this)}zr._configure=function(){zr.alloc=bo._Buffer_allocUnsafe,zr.writeBytesBuffer=bo.Buffer&&bo.Buffer.prototype instanceof Uint8Array&&bo.Buffer.prototype.set.name==="set"?function(e,n,t){n.set(e,t)}:function(e,n,t){if(e.copy)e.copy(n,t,0,e.length);else for(var i=0;i<e.length;)n[t++]=e[i++]}};zr.prototype.bytes=function(e){bo.isString(e)&&(e=bo._Buffer_from(e,"base64"));var n=e.length>>>0;return this.uint32(n),n&&this._push(zr.writeBytesBuffer,n,e),this};function i7(r,e,n){r.length<40?bo.utf8.write(r,e,n):e.utf8Write?e.utf8Write(r,n):e.write(r,n)}zr.prototype.string=function(e){var n=bo.Buffer.byteLength(e);return this.uint32(n),n&&this._push(i7,n,e),this};zr._configure()});var h_=St((mre,_k)=>{"use strict";_k.exports=gt;var Gr=vo(),d_,bk=Gr.LongBits,o7=Gr.utf8;function Cr(r,e){return RangeError("index out of range: "+r.pos+" + "+(e||1)+" > "+r.len)}function gt(r){this.buf=r,this.pos=0,this.len=r.length}var yk=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new gt(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new gt(e);throw Error("illegal buffer")},wk=function(){return Gr.Buffer?function(n){return(gt.create=function(i){return Gr.Buffer.isBuffer(i)?new d_(i):yk(i)})(n)}:yk};gt.create=wk();gt.prototype._slice=Gr.Array.prototype.subarray||Gr.Array.prototype.slice;gt.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Cr(this,10);return e}}();gt.prototype.int32=function(){return this.uint32()|0};gt.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function u_(){var r=new bk(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Cr(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,r}if(this.len-this.pos>4){for(;e<5;++e)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;e<5;++e){if(this.pos>=this.len)throw Cr(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}gt.prototype.bool=function(){return this.uint32()!==0};function Up(r,e){return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0}gt.prototype.fixed32=function(){if(this.pos+4>this.len)throw Cr(this,4);return Up(this.buf,this.pos+=4)};gt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Cr(this,4);return Up(this.buf,this.pos+=4)|0};function vk(){if(this.pos+8>this.len)throw Cr(this,8);return new bk(Up(this.buf,this.pos+=4),Up(this.buf,this.pos+=4))}gt.prototype.float=function(){if(this.pos+4>this.len)throw Cr(this,4);var e=Gr.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};gt.prototype.double=function(){if(this.pos+8>this.len)throw Cr(this,4);var e=Gr.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};gt.prototype.bytes=function(){var e=this.uint32(),n=this.pos,t=this.pos+e;if(t>this.len)throw Cr(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(n,t):n===t?new this.buf.constructor(0):this._slice.call(this.buf,n,t)};gt.prototype.string=function(){var e=this.bytes();return o7.read(e,0,e.length)};gt.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Cr(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Cr(this);while(this.buf[this.pos++]&128);return this};gt.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!==4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};gt._configure=function(r){d_=r,gt.create=wk(),d_._configure();var e=Gr.Long?"toLong":"toNumber";Gr.merge(gt.prototype,{int64:function(){return u_.call(this)[e](!1)},uint64:function(){return u_.call(this)[e](!0)},sint64:function(){return u_.call(this).zzDecode()[e](!1)},fixed64:function(){return vk.call(this)[e](!0)},sfixed64:function(){return vk.call(this)[e](!1)}})}});var Ek=St((yre,Sk)=>{"use strict";Sk.exports=Ns;var xk=h_();(Ns.prototype=Object.create(xk.prototype)).constructor=Ns;var Tk=vo();function Ns(r){xk.call(this,r)}Ns._configure=function(){Tk.Buffer&&(Ns.prototype._slice=Tk.Buffer.prototype.slice)};Ns.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Ns._configure()});var Ck=St((vre,Dk)=>{"use strict";Dk.exports=Au;var f_=vo();(Au.prototype=Object.create(f_.EventEmitter.prototype)).constructor=Au;function Au(r,e,n){if(typeof r!="function")throw TypeError("rpcImpl must be a function");f_.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=!!e,this.responseDelimited=!!n}Au.prototype.rpcCall=function r(e,n,t,i,o){if(!i)throw TypeError("request must be specified");var s=this;if(!o)return f_.asPromise(r,s,e,n,t,i);if(!s.rpcImpl){setTimeout(function(){o(Error("already ended"))},0);return}try{return s.rpcImpl(e,n[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(c,a){if(c)return s.emit("error",c,e),o(c);if(a===null){s.end(!0);return}if(!(a instanceof t))try{a=t[s.responseDelimited?"decodeDelimited":"decode"](a)}catch(u){return s.emit("error",u,e),o(u)}return s.emit("data",a,e),o(null,a)})}catch(l){s.emit("error",l,e),setTimeout(function(){o(l)},0);return}};Au.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Ok=St(Ik=>{"use strict";var s7=Ik;s7.Service=Ck()});var Pk=St((wre,Ak)=>{"use strict";Ak.exports={}});var Rk=St(Nk=>{"use strict";var _n=Nk;_n.build="minimal";_n.Writer=c_();_n.BufferWriter=mk();_n.Reader=h_();_n.BufferReader=Ek();_n.util=vo();_n.rpc=Ok();_n.roots=Pk();_n.configure=Mk;function Mk(){_n.util._configure(),_n.Writer._configure(_n.BufferWriter),_n.Reader._configure(_n.BufferReader)}Mk()});var Fk=St((Tre,kk)=>{"use strict";kk.exports=Rk()});var Bk=St((xre,Lk)=>{"use strict";var qe=Fk(),U=qe.Reader,mt=qe.Writer,T=qe.util,b=qe.roots.default||(qe.roots.default={});b.onnx=function(){var r={};return r.Version=function(){var e={},n=Object.create(e);return n[e[0]="_START_VERSION"]=0,n[e[1]="IR_VERSION_2017_10_10"]=1,n[e[2]="IR_VERSION_2017_10_30"]=2,n[e[3]="IR_VERSION_2017_11_3"]=3,n[e[4]="IR_VERSION_2019_1_22"]=4,n[e[5]="IR_VERSION_2019_3_18"]=5,n[e[6]="IR_VERSION_2019_9_19"]=6,n[e[7]="IR_VERSION_2020_5_8"]=7,n[e[8]="IR_VERSION"]=8,n}(),r.AttributeProto=function(){function e(n){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],this.sparseTensors=[],this.typeProtos=[],n)for(var t=Object.keys(n),i=0;i<t.length;++i)n[t[i]]!=null&&(this[t[i]]=n[t[i]])}return e.prototype.name="",e.prototype.refAttrName="",e.prototype.docString="",e.prototype.type=0,e.prototype.f=0,e.prototype.i=T.Long?T.Long.fromBits(0,0,!1):0,e.prototype.s=T.newBuffer([]),e.prototype.t=null,e.prototype.g=null,e.prototype.sparseTensor=null,e.prototype.tp=null,e.prototype.floats=T.emptyArray,e.prototype.ints=T.emptyArray,e.prototype.strings=T.emptyArray,e.prototype.tensors=T.emptyArray,e.prototype.graphs=T.emptyArray,e.prototype.sparseTensors=T.emptyArray,e.prototype.typeProtos=T.emptyArray,e.create=function(t){return new e(t)},e.encode=function(t,i){if(i||(i=mt.create()),t.name!=null&&Object.hasOwnProperty.call(t,"name")&&i.uint32(10).string(t.name),t.f!=null&&Object.hasOwnProperty.call(t,"f")&&i.uint32(21).float(t.f),t.i!=null&&Object.hasOwnProperty.call(t,"i")&&i.uint32(24).int64(t.i),t.s!=null&&Object.hasOwnProperty.call(t,"s")&&i.uint32(34).bytes(t.s),t.t!=null&&Object.hasOwnProperty.call(t,"t")&&b.onnx.TensorProto.encode(t.t,i.uint32(42).fork()).ldelim(),t.g!=null&&Object.hasOwnProperty.call(t,"g")&&b.onnx.GraphProto.encode(t.g,i.uint32(50).fork()).ldelim(),t.floats!=null&&t.floats.length){i.uint32(58).fork();for(var o=0;o<t.floats.length;++o)i.float(t.floats[o]);i.ldelim()}if(t.ints!=null&&t.ints.length){i.uint32(66).fork();for(var o=0;o<t.ints.length;++o)i.int64(t.ints[o]);i.ldelim()}if(t.strings!=null&&t.strings.length)for(var o=0;o<t.strings.length;++o)i.uint32(74).bytes(t.strings[o]);if(t.tensors!=null&&t.tensors.length)for(var o=0;o<t.tensors.length;++o)b.onnx.TensorProto.encode(t.tensors[o],i.uint32(82).fork()).ldelim();if(t.graphs!=null&&t.graphs.length)for(var o=0;o<t.graphs.length;++o)b.onnx.GraphProto.encode(t.graphs[o],i.uint32(90).fork()).ldelim();if(t.docString!=null&&Object.hasOwnProperty.call(t,"docString")&&i.uint32(106).string(t.docString),t.tp!=null&&Object.hasOwnProperty.call(t,"tp")&&b.onnx.TypeProto.encode(t.tp,i.uint32(114).fork()).ldelim(),t.typeProtos!=null&&t.typeProtos.length)for(var o=0;o<t.typeProtos.length;++o)b.onnx.TypeProto.encode(t.typeProtos[o],i.uint32(122).fork()).ldelim();if(t.type!=null&&Object.hasOwnProperty.call(t,"type")&&i.uint32(160).int32(t.type),t.refAttrName!=null&&Object.hasOwnProperty.call(t,"refAttrName")&&i.uint32(170).string(t.refAttrName),t.sparseTensor!=null&&Object.hasOwnProperty.call(t,"sparseTensor")&&b.onnx.SparseTensorProto.encode(t.sparseTensor,i.uint32(178).fork()).ldelim(),t.sparseTensors!=null&&t.sparseTensors.length)for(var o=0;o<t.sparseTensors.length;++o)b.onnx.SparseTensorProto.encode(t.sparseTensors[o],i.uint32(186).fork()).ldelim();return i},e.encodeDelimited=function(t,i){return this.encode(t,i).ldelim()},e.decode=function(t,i){t instanceof U||(t=U.create(t));for(var o=i===void 0?t.len:t.pos+i,s=new b.onnx.AttributeProto;t.pos<o;){var l=t.uint32();switch(l>>>3){case 1:s.name=t.string();break;case 21:s.refAttrName=t.string();break;case 13:s.docString=t.string();break;case 20:s.type=t.int32();break;case 2:s.f=t.float();break;case 3:s.i=t.int64();break;case 4:s.s=t.bytes();break;case 5:s.t=b.onnx.TensorProto.decode(t,t.uint32());break;case 6:s.g=b.onnx.GraphProto.decode(t,t.uint32());break;case 22:s.sparseTensor=b.onnx.SparseTensorProto.decode(t,t.uint32());break;case 14:s.tp=b.onnx.TypeProto.decode(t,t.uint32());break;case 7:if(s.floats&&s.floats.length||(s.floats=[]),(l&7)===2)for(var c=t.uint32()+t.pos;t.pos<c;)s.floats.push(t.float());else s.floats.push(t.float());break;case 8:if(s.ints&&s.ints.length||(s.ints=[]),(l&7)===2)for(var c=t.uint32()+t.pos;t.pos<c;)s.ints.push(t.int64());else s.ints.push(t.int64());break;case 9:s.strings&&s.strings.length||(s.strings=[]),s.strings.push(t.bytes());break;case 10:s.tensors&&s.tensors.length||(s.tensors=[]),s.tensors.push(b.onnx.TensorProto.decode(t,t.uint32()));break;case 11:s.graphs&&s.graphs.length||(s.graphs=[]),s.graphs.push(b.onnx.GraphProto.decode(t,t.uint32()));break;case 23:s.sparseTensors&&s.sparseTensors.length||(s.sparseTensors=[]),s.sparseTensors.push(b.onnx.SparseTensorProto.decode(t,t.uint32()));break;case 15:s.typeProtos&&s.typeProtos.length||(s.typeProtos=[]),s.typeProtos.push(b.onnx.TypeProto.decode(t,t.uint32()));break;default:t.skipType(l&7);break}}return s},e.decodeDelimited=function(t){return t instanceof U||(t=new U(t)),this.decode(t,t.uint32())},e.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.name!=null&&t.hasOwnProperty("name")&&!T.isString(t.name))return"name: string expected";if(t.refAttrName!=null&&t.hasOwnProperty("refAttrName")&&!T.isString(t.refAttrName))return"refAttrName: string expected";if(t.docString!=null&&t.hasOwnProperty("docString")&&!T.isString(t.docString))return"docString: string expected";if(t.type!=null&&t.hasOwnProperty("type"))switch(t.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 11:case 13:case 6:case 7:case 8:case 9:case 10:case 12:case 14:break}if(t.f!=null&&t.hasOwnProperty("f")&&typeof t.f!="number")return"f: number expected";if(t.i!=null&&t.hasOwnProperty("i")&&!T.isInteger(t.i)&&!(t.i&&T.isInteger(t.i.low)&&T.isInteger(t.i.high)))return"i: integer|Long expected";if(t.s!=null&&t.hasOwnProperty("s")&&!(t.s&&typeof t.s.length=="number"||T.isString(t.s)))return"s: buffer expected";if(t.t!=null&&t.hasOwnProperty("t")){var i=b.onnx.TensorProto.verify(t.t);if(i)return"t."+i}if(t.g!=null&&t.hasOwnProperty("g")){var i=b.onnx.GraphProto.verify(t.g);if(i)return"g."+i}if(t.sparseTensor!=null&&t.hasOwnProperty("sparseTensor")){var i=b.onnx.SparseTensorProto.verify(t.sparseTensor);if(i)return"sparseTensor."+i}if(t.tp!=null&&t.hasOwnProperty("tp")){var i=b.onnx.TypeProto.verify(t.tp);if(i)return"tp."+i}if(t.floats!=null&&t.hasOwnProperty("floats")){if(!Array.isArray(t.floats))return"floats: array expected";for(var o=0;o<t.floats.length;++o)if(typeof t.floats[o]!="number")return"floats: number[] expected"}if(t.ints!=null&&t.hasOwnProperty("ints")){if(!Array.isArray(t.ints))return"ints: array expected";for(var o=0;o<t.ints.length;++o)if(!T.isInteger(t.ints[o])&&!(t.ints[o]&&T.isInteger(t.ints[o].low)&&T.isInteger(t.ints[o].high)))return"ints: integer|Long[] expected"}if(t.strings!=null&&t.hasOwnProperty("strings")){if(!Array.isArray(t.strings))return"strings: array expected";for(var o=0;o<t.strings.length;++o)if(!(t.strings[o]&&typeof t.strings[o].length=="number"||T.isString(t.strings[o])))return"strings: buffer[] expected"}if(t.tensors!=null&&t.hasOwnProperty("tensors")){if(!Array.isArray(t.tensors))return"tensors: array expected";for(var o=0;o<t.tensors.length;++o){var i=b.onnx.TensorProto.verify(t.tensors[o]);if(i)return"tensors."+i}}if(t.graphs!=null&&t.hasOwnProperty("graphs")){if(!Array.isArray(t.graphs))return"graphs: array expected";for(var o=0;o<t.graphs.length;++o){var i=b.onnx.GraphProto.verify(t.graphs[o]);if(i)return"graphs."+i}}if(t.sparseTensors!=null&&t.hasOwnProperty("sparseTensors")){if(!Array.isArray(t.sparseTensors))return"sparseTensors: array expected";for(var o=0;o<t.sparseTensors.length;++o){var i=b.onnx.SparseTensorProto.verify(t.sparseTensors[o]);if(i)return"sparseTensors."+i}}if(t.typeProtos!=null&&t.hasOwnProperty("typeProtos")){if(!Array.isArray(t.typeProtos))return"typeProtos: array expected";for(var o=0;o<t.typeProtos.length;++o){var i=b.onnx.TypeProto.verify(t.typeProtos[o]);if(i)return"typeProtos."+i}}return null},e.fromObject=function(t){if(t instanceof b.onnx.AttributeProto)return t;var i=new b.onnx.AttributeProto;switch(t.name!=null&&(i.name=String(t.name)),t.refAttrName!=null&&(i.refAttrName=String(t.refAttrName)),t.docString!=null&&(i.docString=String(t.docString)),t.type){case"UNDEFINED":case 0:i.type=0;break;case"FLOAT":case 1:i.type=1;break;case"INT":case 2:i.type=2;break;case"STRING":case 3:i.type=3;break;case"TENSOR":case 4:i.type=4;break;case"GRAPH":case 5:i.type=5;break;case"SPARSE_TENSOR":case 11:i.type=11;break;case"TYPE_PROTO":case 13:i.type=13;break;case"FLOATS":case 6:i.type=6;break;case"INTS":case 7:i.type=7;break;case"STRINGS":case 8:i.type=8;break;case"TENSORS":case 9:i.type=9;break;case"GRAPHS":case 10:i.type=10;break;case"SPARSE_TENSORS":case 12:i.type=12;break;case"TYPE_PROTOS":case 14:i.type=14;break}if(t.f!=null&&(i.f=Number(t.f)),t.i!=null&&(T.Long?(i.i=T.Long.fromValue(t.i)).unsigned=!1:typeof t.i=="string"?i.i=parseInt(t.i,10):typeof t.i=="number"?i.i=t.i:typeof t.i=="object"&&(i.i=new T.LongBits(t.i.low>>>0,t.i.high>>>0).toNumber())),t.s!=null&&(typeof t.s=="string"?T.base64.decode(t.s,i.s=T.newBuffer(T.base64.length(t.s)),0):t.s.length&&(i.s=t.s)),t.t!=null){if(typeof t.t!="object")throw TypeError(".onnx.AttributeProto.t: object expected");i.t=b.onnx.TensorProto.fromObject(t.t)}if(t.g!=null){if(typeof t.g!="object")throw TypeError(".onnx.AttributeProto.g: object expected");i.g=b.onnx.GraphProto.fromObject(t.g)}if(t.sparseTensor!=null){if(typeof t.sparseTensor!="object")throw TypeError(".onnx.AttributeProto.sparseTensor: object expected");i.sparseTensor=b.onnx.SparseTensorProto.fromObject(t.sparseTensor)}if(t.tp!=null){if(typeof t.tp!="object")throw TypeError(".onnx.AttributeProto.tp: object expected");i.tp=b.onnx.TypeProto.fromObject(t.tp)}if(t.floats){if(!Array.isArray(t.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");i.floats=[];for(var o=0;o<t.floats.length;++o)i.floats[o]=Number(t.floats[o])}if(t.ints){if(!Array.isArray(t.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");i.ints=[];for(var o=0;o<t.ints.length;++o)T.Long?(i.ints[o]=T.Long.fromValue(t.ints[o])).unsigned=!1:typeof t.ints[o]=="string"?i.ints[o]=parseInt(t.ints[o],10):typeof t.ints[o]=="number"?i.ints[o]=t.ints[o]:typeof t.ints[o]=="object"&&(i.ints[o]=new T.LongBits(t.ints[o].low>>>0,t.ints[o].high>>>0).toNumber())}if(t.strings){if(!Array.isArray(t.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");i.strings=[];for(var o=0;o<t.strings.length;++o)typeof t.strings[o]=="string"?T.base64.decode(t.strings[o],i.strings[o]=T.newBuffer(T.base64.length(t.strings[o])),0):t.strings[o].length&&(i.strings[o]=t.strings[o])}if(t.tensors){if(!Array.isArray(t.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");i.tensors=[];for(var o=0;o<t.tensors.length;++o){if(typeof t.tensors[o]!="object")throw TypeError(".onnx.AttributeProto.tensors: object expected");i.tensors[o]=b.onnx.TensorProto.fromObject(t.tensors[o])}}if(t.graphs){if(!Array.isArray(t.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");i.graphs=[];for(var o=0;o<t.graphs.length;++o){if(typeof t.graphs[o]!="object")throw TypeError(".onnx.AttributeProto.graphs: object expected");i.graphs[o]=b.onnx.GraphProto.fromObject(t.graphs[o])}}if(t.sparseTensors){if(!Array.isArray(t.sparseTensors))throw TypeError(".onnx.AttributeProto.sparseTensors: array expected");i.sparseTensors=[];for(var o=0;o<t.sparseTensors.length;++o){if(typeof t.sparseTensors[o]!="object")throw TypeError(".onnx.AttributeProto.sparseTensors: object expected");i.sparseTensors[o]=b.onnx.SparseTensorProto.fromObject(t.sparseTensors[o])}}if(t.typeProtos){if(!Array.isArray(t.typeProtos))throw TypeError(".onnx.AttributeProto.typeProtos: array expected");i.typeProtos=[];for(var o=0;o<t.typeProtos.length;++o){if(typeof t.typeProtos[o]!="object")throw TypeError(".onnx.AttributeProto.typeProtos: object expected");i.typeProtos[o]=b.onnx.TypeProto.fromObject(t.typeProtos[o])}}return i},e.toObject=function(t,i){i||(i={});var o={};if((i.arrays||i.defaults)&&(o.floats=[],o.ints=[],o.strings=[],o.tensors=[],o.graphs=[],o.typeProtos=[],o.sparseTensors=[]),i.defaults){if(o.name="",o.f=0,T.Long){var s=new T.Long(0,0,!1);o.i=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else o.i=i.longs===String?"0":0;i.bytes===String?o.s="":(o.s=[],i.bytes!==Array&&(o.s=T.newBuffer(o.s))),o.t=null,o.g=null,o.docString="",o.tp=null,o.type=i.enums===String?"UNDEFINED":0,o.refAttrName="",o.sparseTensor=null}if(t.name!=null&&t.hasOwnProperty("name")&&(o.name=t.name),t.f!=null&&t.hasOwnProperty("f")&&(o.f=i.json&&!isFinite(t.f)?String(t.f):t.f),t.i!=null&&t.hasOwnProperty("i")&&(typeof t.i=="number"?o.i=i.longs===String?String(t.i):t.i:o.i=i.longs===String?T.Long.prototype.toString.call(t.i):i.longs===Number?new T.LongBits(t.i.low>>>0,t.i.high>>>0).toNumber():t.i),t.s!=null&&t.hasOwnProperty("s")&&(o.s=i.bytes===String?T.base64.encode(t.s,0,t.s.length):i.bytes===Array?Array.prototype.slice.call(t.s):t.s),t.t!=null&&t.hasOwnProperty("t")&&(o.t=b.onnx.TensorProto.toObject(t.t,i)),t.g!=null&&t.hasOwnProperty("g")&&(o.g=b.onnx.GraphProto.toObject(t.g,i)),t.floats&&t.floats.length){o.floats=[];for(var l=0;l<t.floats.length;++l)o.floats[l]=i.json&&!isFinite(t.floats[l])?String(t.floats[l]):t.floats[l]}if(t.ints&&t.ints.length){o.ints=[];for(var l=0;l<t.ints.length;++l)typeof t.ints[l]=="number"?o.ints[l]=i.longs===String?String(t.ints[l]):t.ints[l]:o.ints[l]=i.longs===String?T.Long.prototype.toString.call(t.ints[l]):i.longs===Number?new T.LongBits(t.ints[l].low>>>0,t.ints[l].high>>>0).toNumber():t.ints[l]}if(t.strings&&t.strings.length){o.strings=[];for(var l=0;l<t.strings.length;++l)o.strings[l]=i.bytes===String?T.base64.encode(t.strings[l],0,t.strings[l].length):i.bytes===Array?Array.prototype.slice.call(t.strings[l]):t.strings[l]}if(t.tensors&&t.tensors.length){o.tensors=[];for(var l=0;l<t.tensors.length;++l)o.tensors[l]=b.onnx.TensorProto.toObject(t.tensors[l],i)}if(t.graphs&&t.graphs.length){o.graphs=[];for(var l=0;l<t.graphs.length;++l)o.graphs[l]=b.onnx.GraphProto.toObject(t.graphs[l],i)}if(t.docString!=null&&t.hasOwnProperty("docString")&&(o.docString=t.docString),t.tp!=null&&t.hasOwnProperty("tp")&&(o.tp=b.onnx.TypeProto.toObject(t.tp,i)),t.typeProtos&&t.typeProtos.length){o.typeProtos=[];for(var l=0;l<t.typeProtos.length;++l)o.typeProtos[l]=b.onnx.TypeProto.toObject(t.typeProtos[l],i)}if(t.type!=null&&t.hasOwnProperty("type")&&(o.type=i.enums===String?b.onnx.AttributeProto.AttributeType[t.type]:t.type),t.refAttrName!=null&&t.hasOwnProperty("refAttrName")&&(o.refAttrName=t.refAttrName),t.sparseTensor!=null&&t.hasOwnProperty("sparseTensor")&&(o.sparseTensor=b.onnx.SparseTensorProto.toObject(t.sparseTensor,i)),t.sparseTensors&&t.sparseTensors.length){o.sparseTensors=[];for(var l=0;l<t.sparseTensors.length;++l)o.sparseTensors[l]=b.onnx.SparseTensorProto.toObject(t.sparseTensors[l],i)}return o},e.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},e.AttributeType=function(){var n={},t=Object.create(n);return t[n[0]="UNDEFINED"]=0,t[n[1]="FLOAT"]=1,t[n[2]="INT"]=2,t[n[3]="STRING"]=3,t[n[4]="TENSOR"]=4,t[n[5]="GRAPH"]=5,t[n[11]="SPARSE_TENSOR"]=11,t[n[13]="TYPE_PROTO"]=13,t[n[6]="FLOATS"]=6,t[n[7]="INTS"]=7,t[n[8]="STRINGS"]=8,t[n[9]="TENSORS"]=9,t[n[10]="GRAPHS"]=10,t[n[12]="SPARSE_TENSORS"]=12,t[n[14]="TYPE_PROTOS"]=14,t}(),e}(),r.ValueInfoProto=function(){function e(n){if(n)for(var t=Object.keys(n),i=0;i<t.length;++i)n[t[i]]!=null&&(this[t[i]]=n[t[i]])}return e.prototype.name="",e.prototype.type=null,e.prototype.docString="",e.create=function(t){return new e(t)},e.encode=function(t,i){return i||(i=mt.create()),t.name!=null&&Object.hasOwnProperty.call(t,"name")&&i.uint32(10).string(t.name),t.type!=null&&Object.hasOwnProperty.call(t,"type")&&b.onnx.TypeProto.encode(t.type,i.uint32(18).fork()).ldelim(),t.docString!=null&&Object.hasOwnProperty.call(t,"docString")&&i.uint32(26).string(t.docString),i},e.encodeDelimited=function(t,i){return this.encode(t,i).ldelim()},e.decode=function(t,i){t instanceof U||(t=U.create(t));for(var o=i===void 0?t.len:t.pos+i,s=new b.onnx.ValueInfoProto;t.pos<o;){var l=t.uint32();switch(l>>>3){case 1:s.name=t.string();break;case 2:s.type=b.onnx.TypeProto.decode(t,t.uint32());break;case 3:s.docString=t.string();break;default:t.skipType(l&7);break}}return s},e.decodeDelimited=function(t){return t instanceof U||(t=new U(t)),this.decode(t,t.uint32())},e.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.name!=null&&t.hasOwnProperty("name")&&!T.isString(t.name))return"name: string expected";if(t.type!=null&&t.hasOwnProperty("type")){var i=b.onnx.TypeProto.verify(t.type);if(i)return"type."+i}return t.docString!=null&&t.hasOwnProperty("docString")&&!T.isString(t.docString)?"docString: string expected":null},e.fromObject=function(t){if(t instanceof b.onnx.ValueInfoProto)return t;var i=new b.onnx.ValueInfoProto;if(t.name!=null&&(i.name=String(t.name)),t.type!=null){if(typeof t.type!="object")throw TypeError(".onnx.ValueInfoProto.type: object expected");i.type=b.onnx.TypeProto.fromObject(t.type)}return t.docString!=null&&(i.docString=String(t.docString)),i},e.toObject=function(t,i){i||(i={});var o={};return i.defaults&&(o.name="",o.type=null,o.docString=""),t.name!=null&&t.hasOwnProperty("name")&&(o.name=t.name),t.type!=null&&t.hasOwnProperty("type")&&(o.type=b.onnx.TypeProto.toObject(t.type,i)),t.docString!=null&&t.hasOwnProperty("docString")&&(o.docString=t.docString),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},e}(),r.NodeProto=function(){function e(n){if(this.input=[],this.output=[],this.attribute=[],n)for(var t=Object.keys(n),i=0;i<t.length;++i)n[t[i]]!=null&&(this[t[i]]=n[t[i]])}return e.prototype.input=T.emptyArray,e.prototype.output=T.emptyArray,e.prototype.name="",e.prototype.opType="",e.prototype.domain="",e.prototype.attribute=T.emptyArray,e.prototype.docString="",e.create=function(t){return new e(t)},e.encode=function(t,i){if(i||(i=mt.create()),t.input!=null&&t.input.length)for(var o=0;o<t.input.length;++o)i.uint32(10).string(t.input[o]);if(t.output!=null&&t.output.length)for(var o=0;o<t.output.length;++o)i.uint32(18).string(t.output[o]);if(t.name!=null&&Object.hasOwnProperty.call(t,"name")&&i.uint32(26).string(t.name),t.opType!=null&&Object.hasOwnProperty.call(t,"opType")&&i.uint32(34).string(t.opType),t.attribute!=null&&t.attribute.length)for(var o=0;o<t.attribute.length;++o)b.onnx.AttributeProto.encode(t.attribute[o],i.uint32(42).fork()).ldelim();return t.docString!=null&&Object.hasOwnProperty.call(t,"docString")&&i.uint32(50).string(t.docString),t.domain!=null&&Object.hasOwnProperty.call(t,"domain")&&i.uint32(58).string(t.domain),i},e.encodeDelimited=function(t,i){return this.encode(t,i).ldelim()},e.decode=function(t,i){t instanceof U||(t=U.create(t));for(var o=i===void 0?t.len:t.pos+i,s=new b.onnx.NodeProto;t.pos<o;){var l=t.uint32();switch(l>>>3){case 1:s.input&&s.input.length||(s.input=[]),s.input.push(t.string());break;case 2:s.output&&s.output.length||(s.output=[]),s.output.push(t.string());break;case 3:s.name=t.string();break;case 4:s.opType=t.string();break;case 7:s.domain=t.string();break;case 5:s.attribute&&s.attribute.length||(s.attribute=[]),s.attribute.push(b.onnx.AttributeProto.decode(t,t.uint32()));break;case 6:s.docString=t.string();break;default:t.skipType(l&7);break}}return s},e.decodeDelimited=function(t){return t instanceof U||(t=new U(t)),this.decode(t,t.uint32())},e.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.input!=null&&t.hasOwnProperty("input")){if(!Array.isArray(t.input))return"input: array expected";for(var i=0;i<t.input.length;++i)if(!T.isString(t.input[i]))return"input: string[] expected"}if(t.output!=null&&t.hasOwnProperty("output")){if(!Array.isArray(t.output))return"output: array expected";for(var i=0;i<t.output.length;++i)if(!T.isString(t.output[i]))return"output: string[] expected"}if(t.name!=null&&t.hasOwnProperty("name")&&!T.isString(t.name))return"name: string expected";if(t.opType!=null&&t.hasOwnProperty("opType")&&!T.isString(t.opType))return"opType: string expected";if(t.domain!=null&&t.hasOwnProperty("domain")&&!T.isString(t.domain))return"domain: string expected";if(t.attribute!=null&&t.hasOwnProperty("attribute")){if(!Array.isArray(t.attribute))return"attribute: array expected";for(var i=0;i<t.attribute.length;++i){var o=b.onnx.AttributeProto.verify(t.attribute[i]);if(o)return"attribute."+o}}return t.docString!=null&&t.hasOwnProperty("docString")&&!T.isString(t.docString)?"docString: string expected":null},e.fromObject=function(t){if(t instanceof b.onnx.NodeProto)return t;var i=new b.onnx.NodeProto;if(t.input){if(!Array.isArray(t.input))throw TypeError(".onnx.NodeProto.input: array expected");i.input=[];for(var o=0;o<t.input.length;++o)i.input[o]=String(t.input[o])}if(t.output){if(!Array.isArray(t.output))throw TypeError(".onnx.NodeProto.output: array expected");i.output=[];for(var o=0;o<t.output.length;++o)i.output[o]=String(t.output[o])}if(t.name!=null&&(i.name=String(t.name)),t.opType!=null&&(i.opType=String(t.opType)),t.domain!=null&&(i.domain=String(t.domain)),t.attribute){if(!Array.isArray(t.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");i.attribute=[];for(var o=0;o<t.attribute.length;++o){if(typeof t.attribute[o]!="object")throw TypeError(".onnx.NodeProto.attribute: object expected");i.attribute[o]=b.onnx.AttributeProto.fromObject(t.attribute[o])}}return t.docString!=null&&(i.docString=String(t.docString)),i},e.toObject=function(t,i){i||(i={});var o={};if((i.arrays||i.defaults)&&(o.input=[],o.output=[],o.attribute=[]),i.defaults&&(o.name="",o.opType="",o.docString="",o.domain=""),t.input&&t.input.length){o.input=[];for(var s=0;s<t.input.length;++s)o.input[s]=t.input[s]}if(t.output&&t.output.length){o.output=[];for(var s=0;s<t.output.length;++s)o.output[s]=t.output[s]}if(t.name!=null&&t.hasOwnProperty("name")&&(o.name=t.name),t.opType!=null&&t.hasOwnProperty("opType")&&(o.opType=t.opType),t.attribute&&t.attribute.length){o.attribute=[];for(var s=0;s<t.attribute.length;++s)o.attribute[s]=b.onnx.AttributeProto.toObject(t.attribute[s],i)}return t.docString!=null&&t.hasOwnProperty("docString")&&(o.docString=t.docString),t.domain!=null&&t.hasOwnProperty("domain")&&(o.domain=t.domain),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},e}(),r.TrainingInfoProto=function(){function e(n){if(this.initializationBinding=[],this.updateBinding=[],n)for(var t=Object.keys(n),i=0;i<t.length;++i)n[t[i]]!=null&&(this[t[i]]=n[t[i]])}return e.prototype.initialization=null,e.prototype.algorithm=null,e.prototype.initializationBinding=T.emptyArray,e.prototype.updateBinding=T.emptyArray,e.create=function(t){return new e(t)},e.encode=function(t,i){if(i||(i=mt.create()),t.initialization!=null&&Object.hasOwnProperty.call(t,"initialization")&&b.onnx.GraphProto.encode(t.initialization,i.uint32(10).fork()).ldelim(),t.algorithm!=null&&Object.hasOwnProperty.call(t,"algorithm")&&b.onnx.GraphProto.encode(t.algorithm,i.uint32(18).fork()).ldelim(),t.initializationBinding!=null&&t.initializationBinding.length)for(var o=0;o<t.initializationBinding.length;++o)b.onnx.StringStringEntryProto.encode(t.initializationBinding[o],i.uint32(26).fork()).ldelim();if(t.updateBinding!=null&&t.updateBinding.length)for(var o=0;o<t.updateBinding.length;++o)b.onnx.StringStringEntryProto.encode(t.updateBinding[o],i.uint32(34).fork()).ldelim();return i},e.encodeDelimited=function(t,i){return this.encode(t,i).ldelim()},e.decode=function(t,i){t instanceof U||(t=U.create(t));for(var o=i===void 0?t.len:t.pos+i,s=new b.onnx.TrainingInfoProto;t.pos<o;){var l=t.uint32();switch(l>>>3){case 1:s.initialization=b.onnx.GraphProto.decode(t,t.uint32());break;case 2:s.algorithm=b.onnx.GraphProto.decode(t,t.uint32());break;case 3:s.initializationBinding&&s.initializationBinding.length||(s.initializationBinding=[]),s.initializationBinding.push(b.onnx.StringStringEntryProto.decode(t,t.uint32()));break;case 4:s.updateBinding&&s.updateBinding.length||(s.updateBinding=[]),s.updateBinding.push(b.onnx.StringStringEntryProto.decode(t,t.uint32()));break;default:t.skipType(l&7);break}}return s},e.decodeDelimited=function(t){return t instanceof U||(t=new U(t)),this.decode(t,t.uint32())},e.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.initialization!=null&&t.hasOwnProperty("initialization")){var i=b.onnx.GraphProto.verify(t.initialization);if(i)return"initialization."+i}if(t.algorithm!=null&&t.hasOwnProperty("algorithm")){var i=b.onnx.GraphProto.verify(t.algorithm);if(i)return"algorithm."+i}if(t.initializationBinding!=null&&t.hasOwnProperty("initializationBinding")){if(!Array.isArray(t.initializationBinding))return"initializationBinding: array expected";for(var o=0;o<t.initializationBinding.length;++o){var i=b.onnx.StringStringEntryProto.verify(t.initializationBinding[o]);if(i)return"initializationBinding."+i}}if(t.updateBinding!=null&&t.hasOwnProperty("updateBinding")){if(!Array.isArray(t.updateBinding))return"updateBinding: array expected";for(var o=0;o<t.updateBinding.length;++o){var i=b.onnx.StringStringEntryProto.verify(t.updateBinding[o]);if(i)return"updateBinding."+i}}return null},e.fromObject=function(t){if(t instanceof b.onnx.TrainingInfoProto)return t;var i=new b.onnx.TrainingInfoProto;if(t.initialization!=null){if(typeof t.initialization!="object")throw TypeError(".onnx.TrainingInfoProto.initialization: object expected");i.initialization=b.onnx.GraphProto.fromObject(t.initialization)}if(t.algorithm!=null){if(typeof t.algorithm!="object")throw TypeError(".onnx.TrainingInfoProto.algorithm: object expected");i.algorithm=b.onnx.GraphProto.fromObject(t.algorithm)}if(t.initializationBinding){if(!Array.isArray(t.initializationBinding))throw TypeError(".onnx.TrainingInfoProto.initializationBinding: array expected");i.initializationBinding=[];for(var o=0;o<t.initializationBinding.length;++o){if(typeof t.initializationBinding[o]!="object")throw TypeError(".onnx.TrainingInfoProto.initializationBinding: object expected");i.initializationBinding[o]=b.onnx.StringStringEntryProto.fromObject(t.initializationBinding[o])}}if(t.updateBinding){if(!Array.isArray(t.updateBinding))throw TypeError(".onnx.TrainingInfoProto.updateBinding: array expected");i.updateBinding=[];for(var o=0;o<t.updateBinding.length;++o){if(typeof t.updateBinding[o]!="object")throw TypeError(".onnx.TrainingInfoProto.updateBinding: object expected");i.updateBinding[o]=b.onnx.StringStringEntryProto.fromObject(t.updateBinding[o])}}return i},e.toObject=function(t,i){i||(i={});var o={};if((i.arrays||i.defaults)&&(o.initializationBinding=[],o.updateBinding=[]),i.defaults&&(o.initialization=null,o.algorithm=null),t.initialization!=null&&t.hasOwnProperty("initialization")&&(o.initialization=b.onnx.GraphProto.toObject(t.initialization,i)),t.algorithm!=null&&t.hasOwnProperty("algorithm")&&(o.algorithm=b.onnx.GraphProto.toObject(t.algorithm,i)),t.initializationBinding&&t.initializationBinding.length){o.initializationBinding=[];for(var s=0;s<t.initializationBinding.length;++s)o.initializationBinding[s]=b.onnx.StringStringEntryProto.toObject(t.initializationBinding[s],i)}if(t.updateBinding&&t.updateBinding.length){o.updateBinding=[];for(var s=0;s<t.updateBinding.length;++s)o.updateBinding[s]=b.onnx.StringStringEntryProto.toObject(t.updateBinding[s],i)}return o},e.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},e}(),r.ModelProto=function(){function e(n){if(this.opsetImport=[],this.metadataProps=[],this.trainingInfo=[],this.functions=[],n)for(var t=Object.keys(n),i=0;i<t.length;++i)n[t[i]]!=null&&(this[t[i]]=n[t[i]])}return e.prototype.irVersion=T.Long?T.Long.fromBits(0,0,!1):0,e.prototype.opsetImport=T.emptyArray,e.prototype.producerName="",e.prototype.producerVersion="",e.prototype.domain="",e.prototype.modelVersion=T.Long?T.Long.fromBits(0,0,!1):0,e.prototype.docString="",e.prototype.graph=null,e.prototype.metadataProps=T.emptyArray,e.prototype.trainingInfo=T.emptyArray,e.prototype.functions=T.emptyArray,e.create=function(t){return new e(t)},e.encode=function(t,i){if(i||(i=mt.create()),t.irVersion!=null&&Object.hasOwnProperty.call(t,"irVersion")&&i.uint32(8).int64(t.irVersion),t.producerName!=null&&Object.hasOwnProperty.call(t,"producerName")&&i.uint32(18).string(t.producerName),t.producerVersion!=null&&Object.hasOwnProperty.call(t,"producerVersion")&&i.uint32(26).string(t.producerVersion),t.domain!=null&&Object.hasOwnProperty.call(t,"domain")&&i.uint32(34).string(t.domain),t.modelVersion!=null&&Object.hasOwnProperty.call(t,"modelVersion")&&i.uint32(40).int64(t.modelVersion),t.docString!=null&&Object.hasOwnProperty.call(t,"docString")&&i.uint32(50).string(t.docString),t.graph!=null&&Object.hasOwnProperty.call(t,"graph")&&b.onnx.GraphProto.encode(t.graph,i.uint32(58).fork()).ldelim(),t.opsetImport!=null&&t.opsetImport.length)for(var o=0;o<t.opsetImport.length;++o)b.onnx.OperatorSetIdProto.encode(t.opsetImport[o],i.uint32(66).fork()).ldelim();if(t.metadataProps!=null&&t.metadataProps.length)for(var o=0;o<t.metadataProps.length;++o)b.onnx.StringStringEntryProto.encode(t.metadataProps[o],i.uint32(114).fork()).ldelim();if(t.trainingInfo!=null&&t.trainingInfo.length)for(var o=0;o<t.trainingInfo.length;++o)b.onnx.TrainingInfoProto.encode(t.trainingInfo[o],i.uint32(162).fork()).ldelim();if(t.functions!=null&&t.functions.length)for(var o=0;o<t.functions.length;++o)b.onnx.FunctionProto.encode(t.functions[o],i.uint32(202).fork()).ldelim();return i},e.encodeDelimited=function(t,i){return this.encode(t,i).ldelim()},e.decode=function(t,i){t instanceof U||(t=U.create(t));for(var o=i===void 0?t.len:t.pos+i,s=new b.onnx.ModelProto;t.pos<o;){var l=t.uint32();switch(l>>>3){case 1:s.irVersion=t.int64();break;case 8:s.opsetImport&&s.opsetImport.length||(s.opsetImport=[]),s.opsetImport.push(b.onnx.OperatorSetIdProto.decode(t,t.uint32()));break;case 2:s.producerName=t.string();break;case 3:s.producerVersion=t.string();break;case 4:s.domain=t.string();break;case 5:s.modelVersion=t.int64();break;case 6:s.docString=t.string();break;case 7:s.graph=b.onnx.GraphProto.decode(t,t.uint32());break;case 14:s.metadataProps&&s.metadataProps.length||(s.metadataProps=[]),s.metadataProps.push(b.onnx.StringStringEntryProto.decode(t,t.uint32()));break;case 20:s.trainingInfo&&s.trainingInfo.length||(s.trainingInfo=[]),s.trainingInfo.push(b.onnx.TrainingInfoProto.decode(t,t.uint32()));break;case 25:s.functions&&s.functions.length||(s.functions=[]),s.functions.push(b.onnx.FunctionProto.decode(t,t.uint32()));break;default:t.skipType(l&7);break}}return s},e.decodeDelimited=function(t){return t instanceof U||(t=new U(t)),this.decode(t,t.uint32())},e.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.irVersion!=null&&t.hasOwnProperty("irVersion")&&!T.isInteger(t.irVersion)&&!(t.irVersion&&T.isInteger(t.irVersion.low)&&T.isInteger(t.irVersion.high)))return"irVersion: integer|Long expected";if(t.opsetImport!=null&&t.hasOwnProperty("opsetImport")){if(!Array.isArray(t.opsetImport))return"opsetImport: array expected";for(var i=0;i<t.opsetImport.length;++i){var o=b.onnx.OperatorSetIdProto.verify(t.opsetImport[i]);if(o)return"opsetImport."+o}}if(t.producerName!=null&&t.hasOwnProperty("producerName")&&!T.isString(t.producerName))return"producerName: string expected";if(t.producerVersion!=null&&t.hasOwnProperty("producerVersion")&&!T.isString(t.producerVersion))return"producerVersion: string expected";if(t.domain!=null&&t.hasOwnProperty("domain")&&!T.isString(t.domain))return"domain: string expected";if(t.modelVersion!=null&&t.hasOwnProperty("modelVersion")&&!T.isInteger(t.modelVersion)&&!(t.modelVersion&&T.isInteger(t.modelVersion.low)&&T.isInteger(t.modelVersion.high)))return"modelVersion: integer|Long expected";if(t.docString!=null&&t.hasOwnProperty("docString")&&!T.isString(t.docString))return"docString: string expected";if(t.graph!=null&&t.hasOwnProperty("graph")){var o=b.onnx.GraphProto.verify(t.graph);if(o)return"graph."+o}if(t.metadataProps!=null&&t.hasOwnProperty("metadataProps")){if(!Array.isArray(t.metadataProps))return"metadataProps: array expected";for(var i=0;i<t.metadataProps.length;++i){var o=b.onnx.StringStringEntryProto.verify(t.metadataProps[i]);if(o)return"metadataProps."+o}}if(t.trainingInfo!=null&&t.hasOwnProperty("trainingInfo")){if(!Array.isArray(t.trainingInfo))return"trainingInfo: array expected";for(var i=0;i<t.trainingInfo.length;++i){var o=b.onnx.TrainingInfoProto.verify(t.trainingInfo[i]);if(o)return"trainingInfo."+o}}if(t.functions!=null&&t.hasOwnProperty("functions")){if(!Array.isArray(t.functions))return"functions: array expected";for(var i=0;i<t.functions.length;++i){var o=b.onnx.FunctionProto.verify(t.functions[i]);if(o)return"functions."+o}}return null},e.fromObject=function(t){if(t instanceof b.onnx.ModelProto)return t;var i=new b.onnx.ModelProto;if(t.irVersion!=null&&(T.Long?(i.irVersion=T.Long.fromValue(t.irVersion)).unsigned=!1:typeof t.irVersion=="string"?i.irVersion=parseInt(t.irVersion,10):typeof t.irVersion=="number"?i.irVersion=t.irVersion:typeof t.irVersion=="object"&&(i.irVersion=new T.LongBits(t.irVersion.low>>>0,t.irVersion.high>>>0).toNumber())),t.opsetImport){if(!Array.isArray(t.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");i.opsetImport=[];for(var o=0;o<t.opsetImport.length;++o){if(typeof t.opsetImport[o]!="object")throw TypeError(".onnx.ModelProto.opsetImport: object expected");i.opsetImport[o]=b.onnx.OperatorSetIdProto.fromObject(t.opsetImport[o])}}if(t.producerName!=null&&(i.producerName=String(t.producerName)),t.producerVersion!=null&&(i.producerVersion=String(t.producerVersion)),t.domain!=null&&(i.domain=String(t.domain)),t.modelVersion!=null&&(T.Long?(i.modelVersion=T.Long.fromValue(t.modelVersion)).unsigned=!1:typeof t.modelVersion=="string"?i.modelVersion=parseInt(t.modelVersion,10):typeof t.modelVersion=="number"?i.modelVersion=t.modelVersion:typeof t.modelVersion=="object"&&(i.modelVersion=new T.LongBits(t.modelVersion.low>>>0,t.modelVersion.high>>>0).toNumber())),t.docString!=null&&(i.docString=String(t.docString)),t.graph!=null){if(typeof t.graph!="object")throw TypeError(".onnx.ModelProto.graph: object expected");i.graph=b.onnx.GraphProto.fromObject(t.graph)}if(t.metadataProps){if(!Array.isArray(t.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");i.metadataProps=[];for(var o=0;o<t.metadataProps.length;++o){if(typeof t.metadataProps[o]!="object")throw TypeError(".onnx.ModelProto.metadataProps: object expected");i.metadataProps[o]=b.onnx.StringStringEntryProto.fromObject(t.metadataProps[o])}}if(t.trainingInfo){if(!Array.isArray(t.trainingInfo))throw TypeError(".onnx.ModelProto.trainingInfo: array expected");i.trainingInfo=[];for(var o=0;o<t.trainingInfo.length;++o){if(typeof t.trainingInfo[o]!="object")throw TypeError(".onnx.ModelProto.trainingInfo: object expected");i.trainingInfo[o]=b.onnx.TrainingInfoProto.fromObject(t.trainingInfo[o])}}if(t.functions){if(!Array.isArray(t.functions))throw TypeError(".onnx.ModelProto.functions: array expected");i.functions=[];for(var o=0;o<t.functions.length;++o){if(typeof t.functions[o]!="object")throw TypeError(".onnx.ModelProto.functions: object expected");i.functions[o]=b.onnx.FunctionProto.fromObject(t.functions[o])}}return i},e.toObject=function(t,i){i||(i={});var o={};if((i.arrays||i.defaults)&&(o.opsetImport=[],o.metadataProps=[],o.trainingInfo=[],o.functions=[]),i.defaults){if(T.Long){var s=new T.Long(0,0,!1);o.irVersion=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else o.irVersion=i.longs===String?"0":0;if(o.producerName="",o.producerVersion="",o.domain="",T.Long){var s=new T.Long(0,0,!1);o.modelVersion=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else o.modelVersion=i.longs===String?"0":0;o.docString="",o.graph=null}if(t.irVersion!=null&&t.hasOwnProperty("irVersion")&&(typeof t.irVersion=="number"?o.irVersion=i.longs===String?String(t.irVersion):t.irVersion:o.irVersion=i.longs===String?T.Long.prototype.toString.call(t.irVersion):i.longs===Number?new T.LongBits(t.irVersion.low>>>0,t.irVersion.high>>>0).toNumber():t.irVersion),t.producerName!=null&&t.hasOwnProperty("producerName")&&(o.producerName=t.producerName),t.producerVersion!=null&&t.hasOwnProperty("producerVersion")&&(o.producerVersion=t.producerVersion),t.domain!=null&&t.hasOwnProperty("domain")&&(o.domain=t.domain),t.modelVersion!=null&&t.hasOwnProperty("modelVersion")&&(typeof t.modelVersion=="number"?o.modelVersion=i.longs===String?String(t.modelVersion):t.modelVersion:o.modelVersion=i.longs===String?T.Long.prototype.toString.call(t.modelVersion):i.longs===Number?new T.LongBits(t.modelVersion.low>>>0,t.modelVersion.high>>>0).toNumber():t.modelVersion),t.docString!=null&&t.hasOwnProperty("docString")&&(o.docString=t.docString),t.graph!=null&&t.hasOwnProperty("graph")&&(o.graph=b.onnx.GraphProto.toObject(t.graph,i)),t.opsetImport&&t.opsetImport.length){o.opsetImport=[];for(var l=0;l<t.opsetImport.length;++l)o.opsetImport[l]=b.onnx.OperatorSetIdProto.toObject(t.opsetImport[l],i)}if(t.metadataProps&&t.metadataProps.length){o.metadataProps=[];for(var l=0;l<t.metadataProps.length;++l)o.metadataProps[l]=b.onnx.StringStringEntryProto.toObject(t.metadataProps[l],i)}if(t.trainingInfo&&t.trainingInfo.length){o.trainingInfo=[];for(var l=0;l<t.trainingInfo.length;++l)o.trainingInfo[l]=b.onnx.TrainingInfoProto.toObject(t.trainingInfo[l],i)}if(t.functions&&t.functions.length){o.functions=[];for(var l=0;l<t.functions.length;++l)o.functions[l]=b.onnx.FunctionProto.toObject(t.functions[l],i)}return o},e.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},e}(),r.StringStringEntryProto=function(){function e(n){if(n)for(var t=Object.keys(n),i=0;i<t.length;++i)n[t[i]]!=null&&(this[t[i]]=n[t[i]])}return e.prototype.key="",e.prototype.value="",e.create=function(t){return new e(t)},e.encode=function(t,i){return i||(i=mt.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&i.uint32(10).string(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(18).string(t.value),i},e.encodeDelimited=function(t,i){return this.encode(t,i).ldelim()},e.decode=function(t,i){t instanceof U||(t=U.create(t));for(var o=i===void 0?t.len:t.pos+i,s=new b.onnx.StringStringEntryProto;t.pos<o;){var l=t.uint32();switch(l>>>3){case 1:s.key=t.string();break;case 2:s.value=t.string();break;default:t.skipType(l&7);break}}return s},e.decodeDelimited=function(t){return t instanceof U||(t=new U(t)),this.decode(t,t.uint32())},e.verify=function(t){return typeof t!="object"||t===null?"object expected":t.key!=null&&t.hasOwnProperty("key")&&!T.isString(t.key)?"key: string expected":t.value!=null&&t.hasOwnProperty("value")&&!T.isString(t.value)?"value: string expected":null},e.fromObject=function(t){if(t instanceof b.onnx.StringStringEntryProto)return t;var i=new b.onnx.StringStringEntryProto;return t.key!=null&&(i.key=String(t.key)),t.value!=null&&(i.value=String(t.value)),i},e.toObject=function(t,i){i||(i={});var o={};return i.defaults&&(o.key="",o.value=""),t.key!=null&&t.hasOwnProperty("key")&&(o.key=t.key),t.value!=null&&t.hasOwnProperty("value")&&(o.value=t.value),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},e}(),r.TensorAnnotation=function(){function e(n){if(this.quantParameterTensorNames=[],n)for(var t=Object.keys(n),i=0;i<t.length;++i)n[t[i]]!=null&&(this[t[i]]=n[t[i]])}return e.prototype.tensorName="",e.prototype.quantParameterTensorNames=T.emptyArray,e.create=function(t){return new e(t)},e.encode=function(t,i){if(i||(i=mt.create()),t.tensorName!=null&&Object.hasOwnProperty.call(t,"tensorName")&&i.uint32(10).string(t.tensorName),t.quantParameterTensorNames!=null&&t.quantParameterTensorNames.length)for(var o=0;o<t.quantParameterTensorNames.length;++o)b.onnx.StringStringEntryProto.encode(t.quantParameterTensorNames[o],i.uint32(18).fork()).ldelim();return i},e.encodeDelimited=function(t,i){return this.encode(t,i).ldelim()},e.decode=function(t,i){t instanceof U||(t=U.create(t));for(var o=i===void 0?t.len:t.pos+i,s=new b.onnx.TensorAnnotation;t.pos<o;){var l=t.uint32();switch(l>>>3){case 1:s.tensorName=t.string();break;case 2:s.quantParameterTensorNames&&s.quantParameterTensorNames.length||(s.quantParameterTensorNames=[]),s.quantParameterTensorNames.push(b.onnx.StringStringEntryProto.decode(t,t.uint32()));break;default:t.skipType(l&7);break}}return s},e.decodeDelimited=function(t){return t instanceof U||(t=new U(t)),this.decode(t,t.uint32())},e.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.tensorName!=null&&t.hasOwnProperty("tensorName")&&!T.isString(t.tensorName))return"tensorName: string expected";if(t.quantParameterTensorNames!=null&&t.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(t.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var i=0;i<t.quantParameterTensorNames.length;++i){var o=b.onnx.StringStringEntryProto.verify(t.quantParameterTensorNames[i]);if(o)return"quantParameterTensorNames."+o}}return null},e.fromObject=function(t){if(t instanceof b.onnx.TensorAnnotation)return t;var i=new b.onnx.TensorAnnotation;if(t.tensorName!=null&&(i.tensorName=String(t.tensorName)),t.quantParameterTensorNames){if(!Array.isArray(t.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");i.quantParameterTensorNames=[];for(var o=0;o<t.quantParameterTensorNames.length;++o){if(typeof t.quantParameterTensorNames[o]!="object")throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");i.quantParameterTensorNames[o]=b.onnx.StringStringEntryProto.fromObject(t.quantParameterTensorNames[o])}}return i},e.toObject=function(t,i){i||(i={});var o={};if((i.arrays||i.defaults)&&(o.quantParameterTensorNames=[]),i.defaults&&(o.tensorName=""),t.tensorName!=null&&t.hasOwnProperty("tensorName")&&(o.tensorName=t.tensorName),t.quantParameterTensorNames&&t.quantParameterTensorNames.length){o.quantParameterTensorNames=[];for(var s=0;s<t.quantParameterTensorNames.length;++s)o.quantParameterTensorNames[s]=b.onnx.StringStringEntryProto.toObject(t.quantParameterTensorNames[s],i)}return o},e.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},e}(),r.GraphProto=function(){function e(n){if(this.node=[],this.initializer=[],this.sparseInitializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],n)for(var t=Object.keys(n),i=0;i<t.length;++i)n[t[i]]!=null&&(this[t[i]]=n[t[i]])}return e.prototype.node=T.emptyArray,e.prototype.name="",e.prototype.initializer=T.emptyArray,e.prototype.sparseInitializer=T.emptyArray,e.prototype.docString="",e.prototype.input=T.emptyArray,e.prototype.output=T.emptyArray,e.prototype.valueInfo=T.emptyArray,e.prototype.quantizationAnnotation=T.emptyArray,e.create=function(t){return new e(t)},e.encode=function(t,i){if(i||(i=mt.create()),t.node!=null&&t.node.length)for(var o=0;o<t.node.length;++o)b.onnx.NodeProto.encode(t.node[o],i.uint32(10).fork()).ldelim();if(t.name!=null&&Object.hasOwnProperty.call(t,"name")&&i.uint32(18).string(t.name),t.initializer!=null&&t.initializer.length)for(var o=0;o<t.initializer.length;++o)b.onnx.TensorProto.encode(t.initializer[o],i.uint32(42).fork()).ldelim();if(t.docString!=null&&Object.hasOwnProperty.call(t,"docString")&&i.uint32(82).string(t.docString),t.input!=null&&t.input.length)for(var o=0;o<t.input.length;++o)b.onnx.ValueInfoProto.encode(t.input[o],i.uint32(90).fork()).ldelim();if(t.output!=null&&t.output.length)for(var o=0;o<t.output.length;++o)b.onnx.ValueInfoProto.encode(t.output[o],i.uint32(98).fork()).ldelim();if(t.valueInfo!=null&&t.valueInfo.length)for(var o=0;o<t.valueInfo.length;++o)b.onnx.ValueInfoProto.encode(t.valueInfo[o],i.uint32(106).fork()).ldelim();if(t.quantizationAnnotation!=null&&t.quantizationAnnotation.length)for(var o=0;o<t.quantizationAnnotation.length;++o)b.onnx.TensorAnnotation.encode(t.quantizationAnnotation[o],i.uint32(114).fork()).ldelim();if(t.sparseInitializer!=null&&t.sparseInitializer.length)for(var o=0;o<t.sparseInitializer.length;++o)b.onnx.SparseTensorProto.encode(t.sparseInitializer[o],i.uint32(122).fork()).ldelim();return i},e.encodeDelimited=function(t,i){return this.encode(t,i).ldelim()},e.decode=function(t,i){t instanceof U||(t=U.create(t));for(var o=i===void 0?t.len:t.pos+i,s=new b.onnx.GraphProto;t.pos<o;){var l=t.uint32();switch(l>>>3){case 1:s.node&&s.node.length||(s.node=[]),s.node.push(b.onnx.NodeProto.decode(t,t.uint32()));break;case 2:s.name=t.string();break;case 5:s.initializer&&s.initializer.length||(s.initializer=[]),s.initializer.push(b.onnx.TensorProto.decode(t,t.uint32()));break;case 15:s.sparseInitializer&&s.sparseInitializer.length||(s.sparseInitializer=[]),s.sparseInitializer.push(b.onnx.SparseTensorProto.decode(t,t.uint32()));break;case 10:s.docString=t.string();break;case 11:s.input&&s.input.length||(s.input=[]),s.input.push(b.onnx.ValueInfoProto.decode(t,t.uint32()));break;case 12:s.output&&s.output.length||(s.output=[]),s.output.push(b.onnx.ValueInfoProto.decode(t,t.uint32()));break;case 13:s.valueInfo&&s.valueInfo.length||(s.valueInfo=[]),s.valueInfo.push(b.onnx.ValueInfoProto.decode(t,t.uint32()));break;case 14:s.quantizationAnnotation&&s.quantizationAnnotation.length||(s.quantizationAnnotation=[]),s.quantizationAnnotation.push(b.onnx.TensorAnnotation.decode(t,t.uint32()));break;default:t.skipType(l&7);break}}return s},e.decodeDelimited=function(t){return t instanceof U||(t=new U(t)),this.decode(t,t.uint32())},e.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.node!=null&&t.hasOwnProperty("node")){if(!Array.isArray(t.node))return"node: array expected";for(var i=0;i<t.node.length;++i){var o=b.onnx.NodeProto.verify(t.node[i]);if(o)return"node."+o}}if(t.name!=null&&t.hasOwnProperty("name")&&!T.isString(t.name))return"name: string expected";if(t.initializer!=null&&t.hasOwnProperty("initializer")){if(!Array.isArray(t.initializer))return"initializer: array expected";for(var i=0;i<t.initializer.length;++i){var o=b.onnx.TensorProto.verify(t.initializer[i]);if(o)return"initializer."+o}}if(t.sparseInitializer!=null&&t.hasOwnProperty("sparseInitializer")){if(!Array.isArray(t.sparseInitializer))return"sparseInitializer: array expected";for(var i=0;i<t.sparseInitializer.length;++i){var o=b.onnx.SparseTensorProto.verify(t.sparseInitializer[i]);if(o)return"sparseInitializer."+o}}if(t.docString!=null&&t.hasOwnProperty("docString")&&!T.isString(t.docString))return"docString: string expected";if(t.input!=null&&t.hasOwnProperty("input")){if(!Array.isArray(t.input))return"input: array expected";for(var i=0;i<t.input.length;++i){var o=b.onnx.ValueInfoProto.verify(t.input[i]);if(o)return"input."+o}}if(t.output!=null&&t.hasOwnProperty("output")){if(!Array.isArray(t.output))return"output: array expected";for(var i=0;i<t.output.length;++i){var o=b.onnx.ValueInfoProto.verify(t.output[i]);if(o)return"output."+o}}if(t.valueInfo!=null&&t.hasOwnProperty("valueInfo")){if(!Array.isArray(t.valueInfo))return"valueInfo: array expected";for(var i=0;i<t.valueInfo.length;++i){var o=b.onnx.ValueInfoProto.verify(t.valueInfo[i]);if(o)return"valueInfo."+o}}if(t.quantizationAnnotation!=null&&t.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(t.quantizationAnnotation))return"quantizationAnnotation: array expected";for(var i=0;i<t.quantizationAnnotation.length;++i){var o=b.onnx.TensorAnnotation.verify(t.quantizationAnnotation[i]);if(o)return"quantizationAnnotation."+o}}return null},e.fromObject=function(t){if(t instanceof b.onnx.GraphProto)return t;var i=new b.onnx.GraphProto;if(t.node){if(!Array.isArray(t.node))throw TypeError(".onnx.GraphProto.node: array expected");i.node=[];for(var o=0;o<t.node.length;++o){if(typeof t.node[o]!="object")throw TypeError(".onnx.GraphProto.node: object expected");i.node[o]=b.onnx.NodeProto.fromObject(t.node[o])}}if(t.name!=null&&(i.name=String(t.name)),t.initializer){if(!Array.isArray(t.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");i.initializer=[];for(var o=0;o<t.initializer.length;++o){if(typeof t.initializer[o]!="object")throw TypeError(".onnx.GraphProto.initializer: object expected");i.initializer[o]=b.onnx.TensorProto.fromObject(t.initializer[o])}}if(t.sparseInitializer){if(!Array.isArray(t.sparseInitializer))throw TypeError(".onnx.GraphProto.sparseInitializer: array expected");i.sparseInitializer=[];for(var o=0;o<t.sparseInitializer.length;++o){if(typeof t.sparseInitializer[o]!="object")throw TypeError(".onnx.GraphProto.sparseInitializer: object expected");i.sparseInitializer[o]=b.onnx.SparseTensorProto.fromObject(t.sparseInitializer[o])}}if(t.docString!=null&&(i.docString=String(t.docString)),t.input){if(!Array.isArray(t.input))throw TypeError(".onnx.GraphProto.input: array expected");i.input=[];for(var o=0;o<t.input.length;++o){if(typeof t.input[o]!="object")throw TypeError(".onnx.GraphProto.input: object expected");i.input[o]=b.onnx.ValueInfoProto.fromObject(t.input[o])}}if(t.output){if(!Array.isArray(t.output))throw TypeError(".onnx.GraphProto.output: array expected");i.output=[];for(var o=0;o<t.output.length;++o){if(typeof t.output[o]!="object")throw TypeError(".onnx.GraphProto.output: object expected");i.output[o]=b.onnx.ValueInfoProto.fromObject(t.output[o])}}if(t.valueInfo){if(!Array.isArray(t.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");i.valueInfo=[];for(var o=0;o<t.valueInfo.length;++o){if(typeof t.valueInfo[o]!="object")throw TypeError(".onnx.GraphProto.valueInfo: object expected");i.valueInfo[o]=b.onnx.ValueInfoProto.fromObject(t.valueInfo[o])}}if(t.quantizationAnnotation){if(!Array.isArray(t.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");i.quantizationAnnotation=[];for(var o=0;o<t.quantizationAnnotation.length;++o){if(typeof t.quantizationAnnotation[o]!="object")throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");i.quantizationAnnotation[o]=b.onnx.TensorAnnotation.fromObject(t.quantizationAnnotation[o])}}return i},e.toObject=function(t,i){i||(i={});var o={};if((i.arrays||i.defaults)&&(o.node=[],o.initializer=[],o.input=[],o.output=[],o.valueInfo=[],o.quantizationAnnotation=[],o.sparseInitializer=[]),i.defaults&&(o.name="",o.docString=""),t.node&&t.node.length){o.node=[];for(var s=0;s<t.node.length;++s)o.node[s]=b.onnx.NodeProto.toObject(t.node[s],i)}if(t.name!=null&&t.hasOwnProperty("name")&&(o.name=t.name),t.initializer&&t.initializer.length){o.initializer=[];for(var s=0;s<t.initializer.length;++s)o.initializer[s]=b.onnx.TensorProto.toObject(t.initializer[s],i)}if(t.docString!=null&&t.hasOwnProperty("docString")&&(o.docString=t.docString),t.input&&t.input.length){o.input=[];for(var s=0;s<t.input.length;++s)o.input[s]=b.onnx.ValueInfoProto.toObject(t.input[s],i)}if(t.output&&t.output.length){o.output=[];for(var s=0;s<t.output.length;++s)o.output[s]=b.onnx.ValueInfoProto.toObject(t.output[s],i)}if(t.valueInfo&&t.valueInfo.length){o.valueInfo=[];for(var s=0;s<t.valueInfo.length;++s)o.valueInfo[s]=b.onnx.ValueInfoProto.toObject(t.valueInfo[s],i)}if(t.quantizationAnnotation&&t.quantizationAnnotation.length){o.quantizationAnnotation=[];for(var s=0;s<t.quantizationAnnotation.length;++s)o.quantizationAnnotation[s]=b.onnx.TensorAnnotation.toObject(t.quantizationAnnotation[s],i)}if(t.sparseInitializer&&t.sparseInitializer.length){o.sparseInitializer=[];for(var s=0;s<t.sparseInitializer.length;++s)o.sparseInitializer[s]=b.onnx.SparseTensorProto.toObject(t.sparseInitializer[s],i)}return o},e.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},e}(),r.TensorProto=function(){function e(n){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],n)for(var t=Object.keys(n),i=0;i<t.length;++i)n[t[i]]!=null&&(this[t[i]]=n[t[i]])}return e.prototype.dims=T.emptyArray,e.prototype.dataType=0,e.prototype.segment=null,e.prototype.floatData=T.emptyArray,e.prototype.int32Data=T.emptyArray,e.prototype.stringData=T.emptyArray,e.prototype.int64Data=T.emptyArray,e.prototype.name="",e.prototype.docString="",e.prototype.rawData=T.newBuffer([]),e.prototype.externalData=T.emptyArray,e.prototype.dataLocation=0,e.prototype.doubleData=T.emptyArray,e.prototype.uint64Data=T.emptyArray,e.create=function(t){return new e(t)},e.encode=function(t,i){if(i||(i=mt.create()),t.dims!=null&&t.dims.length){i.uint32(10).fork();for(var o=0;o<t.dims.length;++o)i.int64(t.dims[o]);i.ldelim()}if(t.dataType!=null&&Object.hasOwnProperty.call(t,"dataType")&&i.uint32(16).int32(t.dataType),t.segment!=null&&Object.hasOwnProperty.call(t,"segment")&&b.onnx.TensorProto.Segment.encode(t.segment,i.uint32(26).fork()).ldelim(),t.floatData!=null&&t.floatData.length){i.uint32(34).fork();for(var o=0;o<t.floatData.length;++o)i.float(t.floatData[o]);i.ldelim()}if(t.int32Data!=null&&t.int32Data.length){i.uint32(42).fork();for(var o=0;o<t.int32Data.length;++o)i.int32(t.int32Data[o]);i.ldelim()}if(t.stringData!=null&&t.stringData.length)for(var o=0;o<t.stringData.length;++o)i.uint32(50).bytes(t.stringData[o]);if(t.int64Data!=null&&t.int64Data.length){i.uint32(58).fork();for(var o=0;o<t.int64Data.length;++o)i.int64(t.int64Data[o]);i.ldelim()}if(t.name!=null&&Object.hasOwnProperty.call(t,"name")&&i.uint32(66).string(t.name),t.rawData!=null&&Object.hasOwnProperty.call(t,"rawData")&&i.uint32(74).bytes(t.rawData),t.doubleData!=null&&t.doubleData.length){i.uint32(82).fork();for(var o=0;o<t.doubleData.length;++o)i.double(t.doubleData[o]);i.ldelim()}if(t.uint64Data!=null&&t.uint64Data.length){i.uint32(90).fork();for(var o=0;o<t.uint64Data.length;++o)i.uint64(t.uint64Data[o]);i.ldelim()}if(t.docString!=null&&Object.hasOwnProperty.call(t,"docString")&&i.uint32(98).string(t.docString),t.externalData!=null&&t.externalData.length)for(var o=0;o<t.externalData.length;++o)b.onnx.StringStringEntryProto.encode(t.externalData[o],i.uint32(106).fork()).ldelim();return t.dataLocation!=null&&Object.hasOwnProperty.call(t,"dataLocation")&&i.uint32(112).int32(t.dataLocation),i},e.encodeDelimited=function(t,i){return this.encode(t,i).ldelim()},e.decode=function(t,i){t instanceof U||(t=U.create(t));for(var o=i===void 0?t.len:t.pos+i,s=new b.onnx.TensorProto;t.pos<o;){var l=t.uint32();switch(l>>>3){case 1:if(s.dims&&s.dims.length||(s.dims=[]),(l&7)===2)for(var c=t.uint32()+t.pos;t.pos<c;)s.dims.push(t.int64());else s.dims.push(t.int64());break;case 2:s.dataType=t.int32();break;case 3:s.segment=b.onnx.TensorProto.Segment.decode(t,t.uint32());break;case 4:if(s.floatData&&s.floatData.length||(s.floatData=[]),(l&7)===2)for(var c=t.uint32()+t.pos;t.pos<c;)s.floatData.push(t.float());else s.floatData.push(t.float());break;case 5:if(s.int32Data&&s.int32Data.length||(s.int32Data=[]),(l&7)===2)for(var c=t.uint32()+t.pos;t.pos<c;)s.int32Data.push(t.int32());else s.int32Data.push(t.int32());break;case 6:s.stringData&&s.stringData.length||(s.stringData=[]),s.stringData.push(t.bytes());break;case 7:if(s.int64Data&&s.int64Data.length||(s.int64Data=[]),(l&7)===2)for(var c=t.uint32()+t.pos;t.pos<c;)s.int64Data.push(t.int64());else s.int64Data.push(t.int64());break;case 8:s.name=t.string();break;case 12:s.docString=t.string();break;case 9:s.rawData=t.bytes();break;case 13:s.externalData&&s.externalData.length||(s.externalData=[]),s.externalData.push(b.onnx.StringStringEntryProto.decode(t,t.uint32()));break;case 14:s.dataLocation=t.int32();break;case 10:if(s.doubleData&&s.doubleData.length||(s.doubleData=[]),(l&7)===2)for(var c=t.uint32()+t.pos;t.pos<c;)s.doubleData.push(t.double());else s.doubleData.push(t.double());break;case 11:if(s.uint64Data&&s.uint64Data.length||(s.uint64Data=[]),(l&7)===2)for(var c=t.uint32()+t.pos;t.pos<c;)s.uint64Data.push(t.uint64());else s.uint64Data.push(t.uint64());break;default:t.skipType(l&7);break}}return s},e.decodeDelimited=function(t){return t instanceof U||(t=new U(t)),this.decode(t,t.uint32())},e.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.dims!=null&&t.hasOwnProperty("dims")){if(!Array.isArray(t.dims))return"dims: array expected";for(var i=0;i<t.dims.length;++i)if(!T.isInteger(t.dims[i])&&!(t.dims[i]&&T.isInteger(t.dims[i].low)&&T.isInteger(t.dims[i].high)))return"dims: integer|Long[] expected"}if(t.dataType!=null&&t.hasOwnProperty("dataType")&&!T.isInteger(t.dataType))return"dataType: integer expected";if(t.segment!=null&&t.hasOwnProperty("segment")){var o=b.onnx.TensorProto.Segment.verify(t.segment);if(o)return"segment."+o}if(t.floatData!=null&&t.hasOwnProperty("floatData")){if(!Array.isArray(t.floatData))return"floatData: array expected";for(var i=0;i<t.floatData.length;++i)if(typeof t.floatData[i]!="number")return"floatData: number[] expected"}if(t.int32Data!=null&&t.hasOwnProperty("int32Data")){if(!Array.isArray(t.int32Data))return"int32Data: array expected";for(var i=0;i<t.int32Data.length;++i)if(!T.isInteger(t.int32Data[i]))return"int32Data: integer[] expected"}if(t.stringData!=null&&t.hasOwnProperty("stringData")){if(!Array.isArray(t.stringData))return"stringData: array expected";for(var i=0;i<t.stringData.length;++i)if(!(t.stringData[i]&&typeof t.stringData[i].length=="number"||T.isString(t.stringData[i])))return"stringData: buffer[] expected"}if(t.int64Data!=null&&t.hasOwnProperty("int64Data")){if(!Array.isArray(t.int64Data))return"int64Data: array expected";for(var i=0;i<t.int64Data.length;++i)if(!T.isInteger(t.int64Data[i])&&!(t.int64Data[i]&&T.isInteger(t.int64Data[i].low)&&T.isInteger(t.int64Data[i].high)))return"int64Data: integer|Long[] expected"}if(t.name!=null&&t.hasOwnProperty("name")&&!T.isString(t.name))return"name: string expected";if(t.docString!=null&&t.hasOwnProperty("docString")&&!T.isString(t.docString))return"docString: string expected";if(t.rawData!=null&&t.hasOwnProperty("rawData")&&!(t.rawData&&typeof t.rawData.length=="number"||T.isString(t.rawData)))return"rawData: buffer expected";if(t.externalData!=null&&t.hasOwnProperty("externalData")){if(!Array.isArray(t.externalData))return"externalData: array expected";for(var i=0;i<t.externalData.length;++i){var o=b.onnx.StringStringEntryProto.verify(t.externalData[i]);if(o)return"externalData."+o}}if(t.dataLocation!=null&&t.hasOwnProperty("dataLocation"))switch(t.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:break}if(t.doubleData!=null&&t.hasOwnProperty("doubleData")){if(!Array.isArray(t.doubleData))return"doubleData: array expected";for(var i=0;i<t.doubleData.length;++i)if(typeof t.doubleData[i]!="number")return"doubleData: number[] expected"}if(t.uint64Data!=null&&t.hasOwnProperty("uint64Data")){if(!Array.isArray(t.uint64Data))return"uint64Data: array expected";for(var i=0;i<t.uint64Data.length;++i)if(!T.isInteger(t.uint64Data[i])&&!(t.uint64Data[i]&&T.isInteger(t.uint64Data[i].low)&&T.isInteger(t.uint64Data[i].high)))return"uint64Data: integer|Long[] expected"}return null},e.fromObject=function(t){if(t instanceof b.onnx.TensorProto)return t;var i=new b.onnx.TensorProto;if(t.dims){if(!Array.isArray(t.dims))throw TypeError(".onnx.TensorProto.dims: array expected");i.dims=[];for(var o=0;o<t.dims.length;++o)T.Long?(i.dims[o]=T.Long.fromValue(t.dims[o])).unsigned=!1:typeof t.dims[o]=="string"?i.dims[o]=parseInt(t.dims[o],10):typeof t.dims[o]=="number"?i.dims[o]=t.dims[o]:typeof t.dims[o]=="object"&&(i.dims[o]=new T.LongBits(t.dims[o].low>>>0,t.dims[o].high>>>0).toNumber())}if(t.dataType!=null&&(i.dataType=t.dataType|0),t.segment!=null){if(typeof t.segment!="object")throw TypeError(".onnx.TensorProto.segment: object expected");i.segment=b.onnx.TensorProto.Segment.fromObject(t.segment)}if(t.floatData){if(!Array.isArray(t.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");i.floatData=[];for(var o=0;o<t.floatData.length;++o)i.floatData[o]=Number(t.floatData[o])}if(t.int32Data){if(!Array.isArray(t.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");i.int32Data=[];for(var o=0;o<t.int32Data.length;++o)i.int32Data[o]=t.int32Data[o]|0}if(t.stringData){if(!Array.isArray(t.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");i.stringData=[];for(var o=0;o<t.stringData.length;++o)typeof t.stringData[o]=="string"?T.base64.decode(t.stringData[o],i.stringData[o]=T.newBuffer(T.base64.length(t.stringData[o])),0):t.stringData[o].length&&(i.stringData[o]=t.stringData[o])}if(t.int64Data){if(!Array.isArray(t.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");i.int64Data=[];for(var o=0;o<t.int64Data.length;++o)T.Long?(i.int64Data[o]=T.Long.fromValue(t.int64Data[o])).unsigned=!1:typeof t.int64Data[o]=="string"?i.int64Data[o]=parseInt(t.int64Data[o],10):typeof t.int64Data[o]=="number"?i.int64Data[o]=t.int64Data[o]:typeof t.int64Data[o]=="object"&&(i.int64Data[o]=new T.LongBits(t.int64Data[o].low>>>0,t.int64Data[o].high>>>0).toNumber())}if(t.name!=null&&(i.name=String(t.name)),t.docString!=null&&(i.docString=String(t.docString)),t.rawData!=null&&(typeof t.rawData=="string"?T.base64.decode(t.rawData,i.rawData=T.newBuffer(T.base64.length(t.rawData)),0):t.rawData.length&&(i.rawData=t.rawData)),t.externalData){if(!Array.isArray(t.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");i.externalData=[];for(var o=0;o<t.externalData.length;++o){if(typeof t.externalData[o]!="object")throw TypeError(".onnx.TensorProto.externalData: object expected");i.externalData[o]=b.onnx.StringStringEntryProto.fromObject(t.externalData[o])}}switch(t.dataLocation){case"DEFAULT":case 0:i.dataLocation=0;break;case"EXTERNAL":case 1:i.dataLocation=1;break}if(t.doubleData){if(!Array.isArray(t.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");i.doubleData=[];for(var o=0;o<t.doubleData.length;++o)i.doubleData[o]=Number(t.doubleData[o])}if(t.uint64Data){if(!Array.isArray(t.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");i.uint64Data=[];for(var o=0;o<t.uint64Data.length;++o)T.Long?(i.uint64Data[o]=T.Long.fromValue(t.uint64Data[o])).unsigned=!0:typeof t.uint64Data[o]=="string"?i.uint64Data[o]=parseInt(t.uint64Data[o],10):typeof t.uint64Data[o]=="number"?i.uint64Data[o]=t.uint64Data[o]:typeof t.uint64Data[o]=="object"&&(i.uint64Data[o]=new T.LongBits(t.uint64Data[o].low>>>0,t.uint64Data[o].high>>>0).toNumber(!0))}return i},e.toObject=function(t,i){i||(i={});var o={};if((i.arrays||i.defaults)&&(o.dims=[],o.floatData=[],o.int32Data=[],o.stringData=[],o.int64Data=[],o.doubleData=[],o.uint64Data=[],o.externalData=[]),i.defaults&&(o.dataType=0,o.segment=null,o.name="",i.bytes===String?o.rawData="":(o.rawData=[],i.bytes!==Array&&(o.rawData=T.newBuffer(o.rawData))),o.docString="",o.dataLocation=i.enums===String?"DEFAULT":0),t.dims&&t.dims.length){o.dims=[];for(var s=0;s<t.dims.length;++s)typeof t.dims[s]=="number"?o.dims[s]=i.longs===String?String(t.dims[s]):t.dims[s]:o.dims[s]=i.longs===String?T.Long.prototype.toString.call(t.dims[s]):i.longs===Number?new T.LongBits(t.dims[s].low>>>0,t.dims[s].high>>>0).toNumber():t.dims[s]}if(t.dataType!=null&&t.hasOwnProperty("dataType")&&(o.dataType=t.dataType),t.segment!=null&&t.hasOwnProperty("segment")&&(o.segment=b.onnx.TensorProto.Segment.toObject(t.segment,i)),t.floatData&&t.floatData.length){o.floatData=[];for(var s=0;s<t.floatData.length;++s)o.floatData[s]=i.json&&!isFinite(t.floatData[s])?String(t.floatData[s]):t.floatData[s]}if(t.int32Data&&t.int32Data.length){o.int32Data=[];for(var s=0;s<t.int32Data.length;++s)o.int32Data[s]=t.int32Data[s]}if(t.stringData&&t.stringData.length){o.stringData=[];for(var s=0;s<t.stringData.length;++s)o.stringData[s]=i.bytes===String?T.base64.encode(t.stringData[s],0,t.stringData[s].length):i.bytes===Array?Array.prototype.slice.call(t.stringData[s]):t.stringData[s]}if(t.int64Data&&t.int64Data.length){o.int64Data=[];for(var s=0;s<t.int64Data.length;++s)typeof t.int64Data[s]=="number"?o.int64Data[s]=i.longs===String?String(t.int64Data[s]):t.int64Data[s]:o.int64Data[s]=i.longs===String?T.Long.prototype.toString.call(t.int64Data[s]):i.longs===Number?new T.LongBits(t.int64Data[s].low>>>0,t.int64Data[s].high>>>0).toNumber():t.int64Data[s]}if(t.name!=null&&t.hasOwnProperty("name")&&(o.name=t.name),t.rawData!=null&&t.hasOwnProperty("rawData")&&(o.rawData=i.bytes===String?T.base64.encode(t.rawData,0,t.rawData.length):i.bytes===Array?Array.prototype.slice.call(t.rawData):t.rawData),t.doubleData&&t.doubleData.length){o.doubleData=[];for(var s=0;s<t.doubleData.length;++s)o.doubleData[s]=i.json&&!isFinite(t.doubleData[s])?String(t.doubleData[s]):t.doubleData[s]}if(t.uint64Data&&t.uint64Data.length){o.uint64Data=[];for(var s=0;s<t.uint64Data.length;++s)typeof t.uint64Data[s]=="number"?o.uint64Data[s]=i.longs===String?String(t.uint64Data[s]):t.uint64Data[s]:o.uint64Data[s]=i.longs===String?T.Long.prototype.toString.call(t.uint64Data[s]):i.longs===Number?new T.LongBits(t.uint64Data[s].low>>>0,t.uint64Data[s].high>>>0).toNumber(!0):t.uint64Data[s]}if(t.docString!=null&&t.hasOwnProperty("docString")&&(o.docString=t.docString),t.externalData&&t.externalData.length){o.externalData=[];for(var s=0;s<t.externalData.length;++s)o.externalData[s]=b.onnx.StringStringEntryProto.toObject(t.externalData[s],i)}return t.dataLocation!=null&&t.hasOwnProperty("dataLocation")&&(o.dataLocation=i.enums===String?b.onnx.TensorProto.DataLocation[t.dataLocation]:t.dataLocation),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},e.DataType=function(){var n={},t=Object.create(n);return t[n[0]="UNDEFINED"]=0,t[n[1]="FLOAT"]=1,t[n[2]="UINT8"]=2,t[n[3]="INT8"]=3,t[n[4]="UINT16"]=4,t[n[5]="INT16"]=5,t[n[6]="INT32"]=6,t[n[7]="INT64"]=7,t[n[8]="STRING"]=8,t[n[9]="BOOL"]=9,t[n[10]="FLOAT16"]=10,t[n[11]="DOUBLE"]=11,t[n[12]="UINT32"]=12,t[n[13]="UINT64"]=13,t[n[14]="COMPLEX64"]=14,t[n[15]="COMPLEX128"]=15,t[n[16]="BFLOAT16"]=16,t}(),e.Segment=function(){function n(t){if(t)for(var i=Object.keys(t),o=0;o<i.length;++o)t[i[o]]!=null&&(this[i[o]]=t[i[o]])}return n.prototype.begin=T.Long?T.Long.fromBits(0,0,!1):0,n.prototype.end=T.Long?T.Long.fromBits(0,0,!1):0,n.create=function(i){return new n(i)},n.encode=function(i,o){return o||(o=mt.create()),i.begin!=null&&Object.hasOwnProperty.call(i,"begin")&&o.uint32(8).int64(i.begin),i.end!=null&&Object.hasOwnProperty.call(i,"end")&&o.uint32(16).int64(i.end),o},n.encodeDelimited=function(i,o){return this.encode(i,o).ldelim()},n.decode=function(i,o){i instanceof U||(i=U.create(i));for(var s=o===void 0?i.len:i.pos+o,l=new b.onnx.TensorProto.Segment;i.pos<s;){var c=i.uint32();switch(c>>>3){case 1:l.begin=i.int64();break;case 2:l.end=i.int64();break;default:i.skipType(c&7);break}}return l},n.decodeDelimited=function(i){return i instanceof U||(i=new U(i)),this.decode(i,i.uint32())},n.verify=function(i){return typeof i!="object"||i===null?"object expected":i.begin!=null&&i.hasOwnProperty("begin")&&!T.isInteger(i.begin)&&!(i.begin&&T.isInteger(i.begin.low)&&T.isInteger(i.begin.high))?"begin: integer|Long expected":i.end!=null&&i.hasOwnProperty("end")&&!T.isInteger(i.end)&&!(i.end&&T.isInteger(i.end.low)&&T.isInteger(i.end.high))?"end: integer|Long expected":null},n.fromObject=function(i){if(i instanceof b.onnx.TensorProto.Segment)return i;var o=new b.onnx.TensorProto.Segment;return i.begin!=null&&(T.Long?(o.begin=T.Long.fromValue(i.begin)).unsigned=!1:typeof i.begin=="string"?o.begin=parseInt(i.begin,10):typeof i.begin=="number"?o.begin=i.begin:typeof i.begin=="object"&&(o.begin=new T.LongBits(i.begin.low>>>0,i.begin.high>>>0).toNumber())),i.end!=null&&(T.Long?(o.end=T.Long.fromValue(i.end)).unsigned=!1:typeof i.end=="string"?o.end=parseInt(i.end,10):typeof i.end=="number"?o.end=i.end:typeof i.end=="object"&&(o.end=new T.LongBits(i.end.low>>>0,i.end.high>>>0).toNumber())),o},n.toObject=function(i,o){o||(o={});var s={};if(o.defaults){if(T.Long){var l=new T.Long(0,0,!1);s.begin=o.longs===String?l.toString():o.longs===Number?l.toNumber():l}else s.begin=o.longs===String?"0":0;if(T.Long){var l=new T.Long(0,0,!1);s.end=o.longs===String?l.toString():o.longs===Number?l.toNumber():l}else s.end=o.longs===String?"0":0}return i.begin!=null&&i.hasOwnProperty("begin")&&(typeof i.begin=="number"?s.begin=o.longs===String?String(i.begin):i.begin:s.begin=o.longs===String?T.Long.prototype.toString.call(i.begin):o.longs===Number?new T.LongBits(i.begin.low>>>0,i.begin.high>>>0).toNumber():i.begin),i.end!=null&&i.hasOwnProperty("end")&&(typeof i.end=="number"?s.end=o.longs===String?String(i.end):i.end:s.end=o.longs===String?T.Long.prototype.toString.call(i.end):o.longs===Number?new T.LongBits(i.end.low>>>0,i.end.high>>>0).toNumber():i.end),s},n.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},n}(),e.DataLocation=function(){var n={},t=Object.create(n);return t[n[0]="DEFAULT"]=0,t[n[1]="EXTERNAL"]=1,t}(),e}(),r.SparseTensorProto=function(){function e(n){if(this.dims=[],n)for(var t=Object.keys(n),i=0;i<t.length;++i)n[t[i]]!=null&&(this[t[i]]=n[t[i]])}return e.prototype.values=null,e.prototype.indices=null,e.prototype.dims=T.emptyArray,e.create=function(t){return new e(t)},e.encode=function(t,i){if(i||(i=mt.create()),t.values!=null&&Object.hasOwnProperty.call(t,"values")&&b.onnx.TensorProto.encode(t.values,i.uint32(10).fork()).ldelim(),t.indices!=null&&Object.hasOwnProperty.call(t,"indices")&&b.onnx.TensorProto.encode(t.indices,i.uint32(18).fork()).ldelim(),t.dims!=null&&t.dims.length){i.uint32(26).fork();for(var o=0;o<t.dims.length;++o)i.int64(t.dims[o]);i.ldelim()}return i},e.encodeDelimited=function(t,i){return this.encode(t,i).ldelim()},e.decode=function(t,i){t instanceof U||(t=U.create(t));for(var o=i===void 0?t.len:t.pos+i,s=new b.onnx.SparseTensorProto;t.pos<o;){var l=t.uint32();switch(l>>>3){case 1:s.values=b.onnx.TensorProto.decode(t,t.uint32());break;case 2:s.indices=b.onnx.TensorProto.decode(t,t.uint32());break;case 3:if(s.dims&&s.dims.length||(s.dims=[]),(l&7)===2)for(var c=t.uint32()+t.pos;t.pos<c;)s.dims.push(t.int64());else s.dims.push(t.int64());break;default:t.skipType(l&7);break}}return s},e.decodeDelimited=function(t){return t instanceof U||(t=new U(t)),this.decode(t,t.uint32())},e.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.values!=null&&t.hasOwnProperty("values")){var i=b.onnx.TensorProto.verify(t.values);if(i)return"values."+i}if(t.indices!=null&&t.hasOwnProperty("indices")){var i=b.onnx.TensorProto.verify(t.indices);if(i)return"indices."+i}if(t.dims!=null&&t.hasOwnProperty("dims")){if(!Array.isArray(t.dims))return"dims: array expected";for(var o=0;o<t.dims.length;++o)if(!T.isInteger(t.dims[o])&&!(t.dims[o]&&T.isInteger(t.dims[o].low)&&T.isInteger(t.dims[o].high)))return"dims: integer|Long[] expected"}return null},e.fromObject=function(t){if(t instanceof b.onnx.SparseTensorProto)return t;var i=new b.onnx.SparseTensorProto;if(t.values!=null){if(typeof t.values!="object")throw TypeError(".onnx.SparseTensorProto.values: object expected");i.values=b.onnx.TensorProto.fromObject(t.values)}if(t.indices!=null){if(typeof t.indices!="object")throw TypeError(".onnx.SparseTensorProto.indices: object expected");i.indices=b.onnx.TensorProto.fromObject(t.indices)}if(t.dims){if(!Array.isArray(t.dims))throw TypeError(".onnx.SparseTensorProto.dims: array expected");i.dims=[];for(var o=0;o<t.dims.length;++o)T.Long?(i.dims[o]=T.Long.fromValue(t.dims[o])).unsigned=!1:typeof t.dims[o]=="string"?i.dims[o]=parseInt(t.dims[o],10):typeof t.dims[o]=="number"?i.dims[o]=t.dims[o]:typeof t.dims[o]=="object"&&(i.dims[o]=new T.LongBits(t.dims[o].low>>>0,t.dims[o].high>>>0).toNumber())}return i},e.toObject=function(t,i){i||(i={});var o={};if((i.arrays||i.defaults)&&(o.dims=[]),i.defaults&&(o.values=null,o.indices=null),t.values!=null&&t.hasOwnProperty("values")&&(o.values=b.onnx.TensorProto.toObject(t.values,i)),t.indices!=null&&t.hasOwnProperty("indices")&&(o.indices=b.onnx.TensorProto.toObject(t.indices,i)),t.dims&&t.dims.length){o.dims=[];for(var s=0;s<t.dims.length;++s)typeof t.dims[s]=="number"?o.dims[s]=i.longs===String?String(t.dims[s]):t.dims[s]:o.dims[s]=i.longs===String?T.Long.prototype.toString.call(t.dims[s]):i.longs===Number?new T.LongBits(t.dims[s].low>>>0,t.dims[s].high>>>0).toNumber():t.dims[s]}return o},e.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},e}(),r.TensorShapeProto=function(){function e(n){if(this.dim=[],n)for(var t=Object.keys(n),i=0;i<t.length;++i)n[t[i]]!=null&&(this[t[i]]=n[t[i]])}return e.prototype.dim=T.emptyArray,e.create=function(t){return new e(t)},e.encode=function(t,i){if(i||(i=mt.create()),t.dim!=null&&t.dim.length)for(var o=0;o<t.dim.length;++o)b.onnx.TensorShapeProto.Dimension.encode(t.dim[o],i.uint32(10).fork()).ldelim();return i},e.encodeDelimited=function(t,i){return this.encode(t,i).ldelim()},e.decode=function(t,i){t instanceof U||(t=U.create(t));for(var o=i===void 0?t.len:t.pos+i,s=new b.onnx.TensorShapeProto;t.pos<o;){var l=t.uint32();switch(l>>>3){case 1:s.dim&&s.dim.length||(s.dim=[]),s.dim.push(b.onnx.TensorShapeProto.Dimension.decode(t,t.uint32()));break;default:t.skipType(l&7);break}}return s},e.decodeDelimited=function(t){return t instanceof U||(t=new U(t)),this.decode(t,t.uint32())},e.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.dim!=null&&t.hasOwnProperty("dim")){if(!Array.isArray(t.dim))return"dim: array expected";for(var i=0;i<t.dim.length;++i){var o=b.onnx.TensorShapeProto.Dimension.verify(t.dim[i]);if(o)return"dim."+o}}return null},e.fromObject=function(t){if(t instanceof b.onnx.TensorShapeProto)return t;var i=new b.onnx.TensorShapeProto;if(t.dim){if(!Array.isArray(t.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");i.dim=[];for(var o=0;o<t.dim.length;++o){if(typeof t.dim[o]!="object")throw TypeError(".onnx.TensorShapeProto.dim: object expected");i.dim[o]=b.onnx.TensorShapeProto.Dimension.fromObject(t.dim[o])}}return i},e.toObject=function(t,i){i||(i={});var o={};if((i.arrays||i.defaults)&&(o.dim=[]),t.dim&&t.dim.length){o.dim=[];for(var s=0;s<t.dim.length;++s)o.dim[s]=b.onnx.TensorShapeProto.Dimension.toObject(t.dim[s],i)}return o},e.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},e.Dimension=function(){function n(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}n.prototype.dimValue=null,n.prototype.dimParam=null,n.prototype.denotation="";var t;return Object.defineProperty(n.prototype,"value",{get:T.oneOfGetter(t=["dimValue","dimParam"]),set:T.oneOfSetter(t)}),n.create=function(o){return new n(o)},n.encode=function(o,s){return s||(s=mt.create()),o.dimValue!=null&&Object.hasOwnProperty.call(o,"dimValue")&&s.uint32(8).int64(o.dimValue),o.dimParam!=null&&Object.hasOwnProperty.call(o,"dimParam")&&s.uint32(18).string(o.dimParam),o.denotation!=null&&Object.hasOwnProperty.call(o,"denotation")&&s.uint32(26).string(o.denotation),s},n.encodeDelimited=function(o,s){return this.encode(o,s).ldelim()},n.decode=function(o,s){o instanceof U||(o=U.create(o));for(var l=s===void 0?o.len:o.pos+s,c=new b.onnx.TensorShapeProto.Dimension;o.pos<l;){var a=o.uint32();switch(a>>>3){case 1:c.dimValue=o.int64();break;case 2:c.dimParam=o.string();break;case 3:c.denotation=o.string();break;default:o.skipType(a&7);break}}return c},n.decodeDelimited=function(o){return o instanceof U||(o=new U(o)),this.decode(o,o.uint32())},n.verify=function(o){if(typeof o!="object"||o===null)return"object expected";var s={};if(o.dimValue!=null&&o.hasOwnProperty("dimValue")&&(s.value=1,!T.isInteger(o.dimValue)&&!(o.dimValue&&T.isInteger(o.dimValue.low)&&T.isInteger(o.dimValue.high))))return"dimValue: integer|Long expected";if(o.dimParam!=null&&o.hasOwnProperty("dimParam")){if(s.value===1)return"value: multiple values";if(s.value=1,!T.isString(o.dimParam))return"dimParam: string expected"}return o.denotation!=null&&o.hasOwnProperty("denotation")&&!T.isString(o.denotation)?"denotation: string expected":null},n.fromObject=function(o){if(o instanceof b.onnx.TensorShapeProto.Dimension)return o;var s=new b.onnx.TensorShapeProto.Dimension;return o.dimValue!=null&&(T.Long?(s.dimValue=T.Long.fromValue(o.dimValue)).unsigned=!1:typeof o.dimValue=="string"?s.dimValue=parseInt(o.dimValue,10):typeof o.dimValue=="number"?s.dimValue=o.dimValue:typeof o.dimValue=="object"&&(s.dimValue=new T.LongBits(o.dimValue.low>>>0,o.dimValue.high>>>0).toNumber())),o.dimParam!=null&&(s.dimParam=String(o.dimParam)),o.denotation!=null&&(s.denotation=String(o.denotation)),s},n.toObject=function(o,s){s||(s={});var l={};return s.defaults&&(l.denotation=""),o.dimValue!=null&&o.hasOwnProperty("dimValue")&&(typeof o.dimValue=="number"?l.dimValue=s.longs===String?String(o.dimValue):o.dimValue:l.dimValue=s.longs===String?T.Long.prototype.toString.call(o.dimValue):s.longs===Number?new T.LongBits(o.dimValue.low>>>0,o.dimValue.high>>>0).toNumber():o.dimValue,s.oneofs&&(l.value="dimValue")),o.dimParam!=null&&o.hasOwnProperty("dimParam")&&(l.dimParam=o.dimParam,s.oneofs&&(l.value="dimParam")),o.denotation!=null&&o.hasOwnProperty("denotation")&&(l.denotation=o.denotation),l},n.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},n}(),e}(),r.TypeProto=function(){function e(t){if(t)for(var i=Object.keys(t),o=0;o<i.length;++o)t[i[o]]!=null&&(this[i[o]]=t[i[o]])}e.prototype.tensorType=null,e.prototype.sequenceType=null,e.prototype.mapType=null,e.prototype.optionalType=null,e.prototype.sparseTensorType=null,e.prototype.denotation="";var n;return Object.defineProperty(e.prototype,"value",{get:T.oneOfGetter(n=["tensorType","sequenceType","mapType","optionalType","sparseTensorType"]),set:T.oneOfSetter(n)}),e.create=function(i){return new e(i)},e.encode=function(i,o){return o||(o=mt.create()),i.tensorType!=null&&Object.hasOwnProperty.call(i,"tensorType")&&b.onnx.TypeProto.Tensor.encode(i.tensorType,o.uint32(10).fork()).ldelim(),i.sequenceType!=null&&Object.hasOwnProperty.call(i,"sequenceType")&&b.onnx.TypeProto.Sequence.encode(i.sequenceType,o.uint32(34).fork()).ldelim(),i.mapType!=null&&Object.hasOwnProperty.call(i,"mapType")&&b.onnx.TypeProto.Map.encode(i.mapType,o.uint32(42).fork()).ldelim(),i.denotation!=null&&Object.hasOwnProperty.call(i,"denotation")&&o.uint32(50).string(i.denotation),i.sparseTensorType!=null&&Object.hasOwnProperty.call(i,"sparseTensorType")&&b.onnx.TypeProto.SparseTensor.encode(i.sparseTensorType,o.uint32(66).fork()).ldelim(),i.optionalType!=null&&Object.hasOwnProperty.call(i,"optionalType")&&b.onnx.TypeProto.Optional.encode(i.optionalType,o.uint32(74).fork()).ldelim(),o},e.encodeDelimited=function(i,o){return this.encode(i,o).ldelim()},e.decode=function(i,o){i instanceof U||(i=U.create(i));for(var s=o===void 0?i.len:i.pos+o,l=new b.onnx.TypeProto;i.pos<s;){var c=i.uint32();switch(c>>>3){case 1:l.tensorType=b.onnx.TypeProto.Tensor.decode(i,i.uint32());break;case 4:l.sequenceType=b.onnx.TypeProto.Sequence.decode(i,i.uint32());break;case 5:l.mapType=b.onnx.TypeProto.Map.decode(i,i.uint32());break;case 9:l.optionalType=b.onnx.TypeProto.Optional.decode(i,i.uint32());break;case 8:l.sparseTensorType=b.onnx.TypeProto.SparseTensor.decode(i,i.uint32());break;case 6:l.denotation=i.string();break;default:i.skipType(c&7);break}}return l},e.decodeDelimited=function(i){return i instanceof U||(i=new U(i)),this.decode(i,i.uint32())},e.verify=function(i){if(typeof i!="object"||i===null)return"object expected";var o={};if(i.tensorType!=null&&i.hasOwnProperty("tensorType")){o.value=1;{var s=b.onnx.TypeProto.Tensor.verify(i.tensorType);if(s)return"tensorType."+s}}if(i.sequenceType!=null&&i.hasOwnProperty("sequenceType")){if(o.value===1)return"value: multiple values";o.value=1;{var s=b.onnx.TypeProto.Sequence.verify(i.sequenceType);if(s)return"sequenceType."+s}}if(i.mapType!=null&&i.hasOwnProperty("mapType")){if(o.value===1)return"value: multiple values";o.value=1;{var s=b.onnx.TypeProto.Map.verify(i.mapType);if(s)return"mapType."+s}}if(i.optionalType!=null&&i.hasOwnProperty("optionalType")){if(o.value===1)return"value: multiple values";o.value=1;{var s=b.onnx.TypeProto.Optional.verify(i.optionalType);if(s)return"optionalType."+s}}if(i.sparseTensorType!=null&&i.hasOwnProperty("sparseTensorType")){if(o.value===1)return"value: multiple values";o.value=1;{var s=b.onnx.TypeProto.SparseTensor.verify(i.sparseTensorType);if(s)return"sparseTensorType."+s}}return i.denotation!=null&&i.hasOwnProperty("denotation")&&!T.isString(i.denotation)?"denotation: string expected":null},e.fromObject=function(i){if(i instanceof b.onnx.TypeProto)return i;var o=new b.onnx.TypeProto;if(i.tensorType!=null){if(typeof i.tensorType!="object")throw TypeError(".onnx.TypeProto.tensorType: object expected");o.tensorType=b.onnx.TypeProto.Tensor.fromObject(i.tensorType)}if(i.sequenceType!=null){if(typeof i.sequenceType!="object")throw TypeError(".onnx.TypeProto.sequenceType: object expected");o.sequenceType=b.onnx.TypeProto.Sequence.fromObject(i.sequenceType)}if(i.mapType!=null){if(typeof i.mapType!="object")throw TypeError(".onnx.TypeProto.mapType: object expected");o.mapType=b.onnx.TypeProto.Map.fromObject(i.mapType)}if(i.optionalType!=null){if(typeof i.optionalType!="object")throw TypeError(".onnx.TypeProto.optionalType: object expected");o.optionalType=b.onnx.TypeProto.Optional.fromObject(i.optionalType)}if(i.sparseTensorType!=null){if(typeof i.sparseTensorType!="object")throw TypeError(".onnx.TypeProto.sparseTensorType: object expected");o.sparseTensorType=b.onnx.TypeProto.SparseTensor.fromObject(i.sparseTensorType)}return i.denotation!=null&&(o.denotation=String(i.denotation)),o},e.toObject=function(i,o){o||(o={});var s={};return o.defaults&&(s.denotation=""),i.tensorType!=null&&i.hasOwnProperty("tensorType")&&(s.tensorType=b.onnx.TypeProto.Tensor.toObject(i.tensorType,o),o.oneofs&&(s.value="tensorType")),i.sequenceType!=null&&i.hasOwnProperty("sequenceType")&&(s.sequenceType=b.onnx.TypeProto.Sequence.toObject(i.sequenceType,o),o.oneofs&&(s.value="sequenceType")),i.mapType!=null&&i.hasOwnProperty("mapType")&&(s.mapType=b.onnx.TypeProto.Map.toObject(i.mapType,o),o.oneofs&&(s.value="mapType")),i.denotation!=null&&i.hasOwnProperty("denotation")&&(s.denotation=i.denotation),i.sparseTensorType!=null&&i.hasOwnProperty("sparseTensorType")&&(s.sparseTensorType=b.onnx.TypeProto.SparseTensor.toObject(i.sparseTensorType,o),o.oneofs&&(s.value="sparseTensorType")),i.optionalType!=null&&i.hasOwnProperty("optionalType")&&(s.optionalType=b.onnx.TypeProto.Optional.toObject(i.optionalType,o),o.oneofs&&(s.value="optionalType")),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},e.Tensor=function(){function t(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return t.prototype.elemType=0,t.prototype.shape=null,t.create=function(o){return new t(o)},t.encode=function(o,s){return s||(s=mt.create()),o.elemType!=null&&Object.hasOwnProperty.call(o,"elemType")&&s.uint32(8).int32(o.elemType),o.shape!=null&&Object.hasOwnProperty.call(o,"shape")&&b.onnx.TensorShapeProto.encode(o.shape,s.uint32(18).fork()).ldelim(),s},t.encodeDelimited=function(o,s){return this.encode(o,s).ldelim()},t.decode=function(o,s){o instanceof U||(o=U.create(o));for(var l=s===void 0?o.len:o.pos+s,c=new b.onnx.TypeProto.Tensor;o.pos<l;){var a=o.uint32();switch(a>>>3){case 1:c.elemType=o.int32();break;case 2:c.shape=b.onnx.TensorShapeProto.decode(o,o.uint32());break;default:o.skipType(a&7);break}}return c},t.decodeDelimited=function(o){return o instanceof U||(o=new U(o)),this.decode(o,o.uint32())},t.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.elemType!=null&&o.hasOwnProperty("elemType")&&!T.isInteger(o.elemType))return"elemType: integer expected";if(o.shape!=null&&o.hasOwnProperty("shape")){var s=b.onnx.TensorShapeProto.verify(o.shape);if(s)return"shape."+s}return null},t.fromObject=function(o){if(o instanceof b.onnx.TypeProto.Tensor)return o;var s=new b.onnx.TypeProto.Tensor;if(o.elemType!=null&&(s.elemType=o.elemType|0),o.shape!=null){if(typeof o.shape!="object")throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");s.shape=b.onnx.TensorShapeProto.fromObject(o.shape)}return s},t.toObject=function(o,s){s||(s={});var l={};return s.defaults&&(l.elemType=0,l.shape=null),o.elemType!=null&&o.hasOwnProperty("elemType")&&(l.elemType=o.elemType),o.shape!=null&&o.hasOwnProperty("shape")&&(l.shape=b.onnx.TensorShapeProto.toObject(o.shape,s)),l},t.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},t}(),e.Sequence=function(){function t(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return t.prototype.elemType=null,t.create=function(o){return new t(o)},t.encode=function(o,s){return s||(s=mt.create()),o.elemType!=null&&Object.hasOwnProperty.call(o,"elemType")&&b.onnx.TypeProto.encode(o.elemType,s.uint32(10).fork()).ldelim(),s},t.encodeDelimited=function(o,s){return this.encode(o,s).ldelim()},t.decode=function(o,s){o instanceof U||(o=U.create(o));for(var l=s===void 0?o.len:o.pos+s,c=new b.onnx.TypeProto.Sequence;o.pos<l;){var a=o.uint32();switch(a>>>3){case 1:c.elemType=b.onnx.TypeProto.decode(o,o.uint32());break;default:o.skipType(a&7);break}}return c},t.decodeDelimited=function(o){return o instanceof U||(o=new U(o)),this.decode(o,o.uint32())},t.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.elemType!=null&&o.hasOwnProperty("elemType")){var s=b.onnx.TypeProto.verify(o.elemType);if(s)return"elemType."+s}return null},t.fromObject=function(o){if(o instanceof b.onnx.TypeProto.Sequence)return o;var s=new b.onnx.TypeProto.Sequence;if(o.elemType!=null){if(typeof o.elemType!="object")throw TypeError(".onnx.TypeProto.Sequence.elemType: object expected");s.elemType=b.onnx.TypeProto.fromObject(o.elemType)}return s},t.toObject=function(o,s){s||(s={});var l={};return s.defaults&&(l.elemType=null),o.elemType!=null&&o.hasOwnProperty("elemType")&&(l.elemType=b.onnx.TypeProto.toObject(o.elemType,s)),l},t.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},t}(),e.Map=function(){function t(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return t.prototype.keyType=0,t.prototype.valueType=null,t.create=function(o){return new t(o)},t.encode=function(o,s){return s||(s=mt.create()),o.keyType!=null&&Object.hasOwnProperty.call(o,"keyType")&&s.uint32(8).int32(o.keyType),o.valueType!=null&&Object.hasOwnProperty.call(o,"valueType")&&b.onnx.TypeProto.encode(o.valueType,s.uint32(18).fork()).ldelim(),s},t.encodeDelimited=function(o,s){return this.encode(o,s).ldelim()},t.decode=function(o,s){o instanceof U||(o=U.create(o));for(var l=s===void 0?o.len:o.pos+s,c=new b.onnx.TypeProto.Map;o.pos<l;){var a=o.uint32();switch(a>>>3){case 1:c.keyType=o.int32();break;case 2:c.valueType=b.onnx.TypeProto.decode(o,o.uint32());break;default:o.skipType(a&7);break}}return c},t.decodeDelimited=function(o){return o instanceof U||(o=new U(o)),this.decode(o,o.uint32())},t.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.keyType!=null&&o.hasOwnProperty("keyType")&&!T.isInteger(o.keyType))return"keyType: integer expected";if(o.valueType!=null&&o.hasOwnProperty("valueType")){var s=b.onnx.TypeProto.verify(o.valueType);if(s)return"valueType."+s}return null},t.fromObject=function(o){if(o instanceof b.onnx.TypeProto.Map)return o;var s=new b.onnx.TypeProto.Map;if(o.keyType!=null&&(s.keyType=o.keyType|0),o.valueType!=null){if(typeof o.valueType!="object")throw TypeError(".onnx.TypeProto.Map.valueType: object expected");s.valueType=b.onnx.TypeProto.fromObject(o.valueType)}return s},t.toObject=function(o,s){s||(s={});var l={};return s.defaults&&(l.keyType=0,l.valueType=null),o.keyType!=null&&o.hasOwnProperty("keyType")&&(l.keyType=o.keyType),o.valueType!=null&&o.hasOwnProperty("valueType")&&(l.valueType=b.onnx.TypeProto.toObject(o.valueType,s)),l},t.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},t}(),e.Optional=function(){function t(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return t.prototype.elemType=null,t.create=function(o){return new t(o)},t.encode=function(o,s){return s||(s=mt.create()),o.elemType!=null&&Object.hasOwnProperty.call(o,"elemType")&&b.onnx.TypeProto.encode(o.elemType,s.uint32(10).fork()).ldelim(),s},t.encodeDelimited=function(o,s){return this.encode(o,s).ldelim()},t.decode=function(o,s){o instanceof U||(o=U.create(o));for(var l=s===void 0?o.len:o.pos+s,c=new b.onnx.TypeProto.Optional;o.pos<l;){var a=o.uint32();switch(a>>>3){case 1:c.elemType=b.onnx.TypeProto.decode(o,o.uint32());break;default:o.skipType(a&7);break}}return c},t.decodeDelimited=function(o){return o instanceof U||(o=new U(o)),this.decode(o,o.uint32())},t.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.elemType!=null&&o.hasOwnProperty("elemType")){var s=b.onnx.TypeProto.verify(o.elemType);if(s)return"elemType."+s}return null},t.fromObject=function(o){if(o instanceof b.onnx.TypeProto.Optional)return o;var s=new b.onnx.TypeProto.Optional;if(o.elemType!=null){if(typeof o.elemType!="object")throw TypeError(".onnx.TypeProto.Optional.elemType: object expected");s.elemType=b.onnx.TypeProto.fromObject(o.elemType)}return s},t.toObject=function(o,s){s||(s={});var l={};return s.defaults&&(l.elemType=null),o.elemType!=null&&o.hasOwnProperty("elemType")&&(l.elemType=b.onnx.TypeProto.toObject(o.elemType,s)),l},t.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},t}(),e.SparseTensor=function(){function t(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return t.prototype.elemType=0,t.prototype.shape=null,t.create=function(o){return new t(o)},t.encode=function(o,s){return s||(s=mt.create()),o.elemType!=null&&Object.hasOwnProperty.call(o,"elemType")&&s.uint32(8).int32(o.elemType),o.shape!=null&&Object.hasOwnProperty.call(o,"shape")&&b.onnx.TensorShapeProto.encode(o.shape,s.uint32(18).fork()).ldelim(),s},t.encodeDelimited=function(o,s){return this.encode(o,s).ldelim()},t.decode=function(o,s){o instanceof U||(o=U.create(o));for(var l=s===void 0?o.len:o.pos+s,c=new b.onnx.TypeProto.SparseTensor;o.pos<l;){var a=o.uint32();switch(a>>>3){case 1:c.elemType=o.int32();break;case 2:c.shape=b.onnx.TensorShapeProto.decode(o,o.uint32());break;default:o.skipType(a&7);break}}return c},t.decodeDelimited=function(o){return o instanceof U||(o=new U(o)),this.decode(o,o.uint32())},t.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.elemType!=null&&o.hasOwnProperty("elemType")&&!T.isInteger(o.elemType))return"elemType: integer expected";if(o.shape!=null&&o.hasOwnProperty("shape")){var s=b.onnx.TensorShapeProto.verify(o.shape);if(s)return"shape."+s}return null},t.fromObject=function(o){if(o instanceof b.onnx.TypeProto.SparseTensor)return o;var s=new b.onnx.TypeProto.SparseTensor;if(o.elemType!=null&&(s.elemType=o.elemType|0),o.shape!=null){if(typeof o.shape!="object")throw TypeError(".onnx.TypeProto.SparseTensor.shape: object expected");s.shape=b.onnx.TensorShapeProto.fromObject(o.shape)}return s},t.toObject=function(o,s){s||(s={});var l={};return s.defaults&&(l.elemType=0,l.shape=null),o.elemType!=null&&o.hasOwnProperty("elemType")&&(l.elemType=o.elemType),o.shape!=null&&o.hasOwnProperty("shape")&&(l.shape=b.onnx.TensorShapeProto.toObject(o.shape,s)),l},t.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},t}(),e}(),r.OperatorSetIdProto=function(){function e(n){if(n)for(var t=Object.keys(n),i=0;i<t.length;++i)n[t[i]]!=null&&(this[t[i]]=n[t[i]])}return e.prototype.domain="",e.prototype.version=T.Long?T.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(t,i){return i||(i=mt.create()),t.domain!=null&&Object.hasOwnProperty.call(t,"domain")&&i.uint32(10).string(t.domain),t.version!=null&&Object.hasOwnProperty.call(t,"version")&&i.uint32(16).int64(t.version),i},e.encodeDelimited=function(t,i){return this.encode(t,i).ldelim()},e.decode=function(t,i){t instanceof U||(t=U.create(t));for(var o=i===void 0?t.len:t.pos+i,s=new b.onnx.OperatorSetIdProto;t.pos<o;){var l=t.uint32();switch(l>>>3){case 1:s.domain=t.string();break;case 2:s.version=t.int64();break;default:t.skipType(l&7);break}}return s},e.decodeDelimited=function(t){return t instanceof U||(t=new U(t)),this.decode(t,t.uint32())},e.verify=function(t){return typeof t!="object"||t===null?"object expected":t.domain!=null&&t.hasOwnProperty("domain")&&!T.isString(t.domain)?"domain: string expected":t.version!=null&&t.hasOwnProperty("version")&&!T.isInteger(t.version)&&!(t.version&&T.isInteger(t.version.low)&&T.isInteger(t.version.high))?"version: integer|Long expected":null},e.fromObject=function(t){if(t instanceof b.onnx.OperatorSetIdProto)return t;var i=new b.onnx.OperatorSetIdProto;return t.domain!=null&&(i.domain=String(t.domain)),t.version!=null&&(T.Long?(i.version=T.Long.fromValue(t.version)).unsigned=!1:typeof t.version=="string"?i.version=parseInt(t.version,10):typeof t.version=="number"?i.version=t.version:typeof t.version=="object"&&(i.version=new T.LongBits(t.version.low>>>0,t.version.high>>>0).toNumber())),i},e.toObject=function(t,i){i||(i={});var o={};if(i.defaults)if(o.domain="",T.Long){var s=new T.Long(0,0,!1);o.version=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else o.version=i.longs===String?"0":0;return t.domain!=null&&t.hasOwnProperty("domain")&&(o.domain=t.domain),t.version!=null&&t.hasOwnProperty("version")&&(typeof t.version=="number"?o.version=i.longs===String?String(t.version):t.version:o.version=i.longs===String?T.Long.prototype.toString.call(t.version):i.longs===Number?new T.LongBits(t.version.low>>>0,t.version.high>>>0).toNumber():t.version),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},e}(),r.OperatorStatus=function(){var e={},n=Object.create(e);return n[e[0]="EXPERIMENTAL"]=0,n[e[1]="STABLE"]=1,n}(),r.FunctionProto=function(){function e(n){if(this.input=[],this.output=[],this.attribute=[],this.node=[],this.opsetImport=[],n)for(var t=Object.keys(n),i=0;i<t.length;++i)n[t[i]]!=null&&(this[t[i]]=n[t[i]])}return e.prototype.name="",e.prototype.input=T.emptyArray,e.prototype.output=T.emptyArray,e.prototype.attribute=T.emptyArray,e.prototype.node=T.emptyArray,e.prototype.docString="",e.prototype.opsetImport=T.emptyArray,e.prototype.domain="",e.create=function(t){return new e(t)},e.encode=function(t,i){if(i||(i=mt.create()),t.name!=null&&Object.hasOwnProperty.call(t,"name")&&i.uint32(10).string(t.name),t.input!=null&&t.input.length)for(var o=0;o<t.input.length;++o)i.uint32(34).string(t.input[o]);if(t.output!=null&&t.output.length)for(var o=0;o<t.output.length;++o)i.uint32(42).string(t.output[o]);if(t.attribute!=null&&t.attribute.length)for(var o=0;o<t.attribute.length;++o)i.uint32(50).string(t.attribute[o]);if(t.node!=null&&t.node.length)for(var o=0;o<t.node.length;++o)b.onnx.NodeProto.encode(t.node[o],i.uint32(58).fork()).ldelim();if(t.docString!=null&&Object.hasOwnProperty.call(t,"docString")&&i.uint32(66).string(t.docString),t.opsetImport!=null&&t.opsetImport.length)for(var o=0;o<t.opsetImport.length;++o)b.onnx.OperatorSetIdProto.encode(t.opsetImport[o],i.uint32(74).fork()).ldelim();return t.domain!=null&&Object.hasOwnProperty.call(t,"domain")&&i.uint32(82).string(t.domain),i},e.encodeDelimited=function(t,i){return this.encode(t,i).ldelim()},e.decode=function(t,i){t instanceof U||(t=U.create(t));for(var o=i===void 0?t.len:t.pos+i,s=new b.onnx.FunctionProto;t.pos<o;){var l=t.uint32();switch(l>>>3){case 1:s.name=t.string();break;case 4:s.input&&s.input.length||(s.input=[]),s.input.push(t.string());break;case 5:s.output&&s.output.length||(s.output=[]),s.output.push(t.string());break;case 6:s.attribute&&s.attribute.length||(s.attribute=[]),s.attribute.push(t.string());break;case 7:s.node&&s.node.length||(s.node=[]),s.node.push(b.onnx.NodeProto.decode(t,t.uint32()));break;case 8:s.docString=t.string();break;case 9:s.opsetImport&&s.opsetImport.length||(s.opsetImport=[]),s.opsetImport.push(b.onnx.OperatorSetIdProto.decode(t,t.uint32()));break;case 10:s.domain=t.string();break;default:t.skipType(l&7);break}}return s},e.decodeDelimited=function(t){return t instanceof U||(t=new U(t)),this.decode(t,t.uint32())},e.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.name!=null&&t.hasOwnProperty("name")&&!T.isString(t.name))return"name: string expected";if(t.input!=null&&t.hasOwnProperty("input")){if(!Array.isArray(t.input))return"input: array expected";for(var i=0;i<t.input.length;++i)if(!T.isString(t.input[i]))return"input: string[] expected"}if(t.output!=null&&t.hasOwnProperty("output")){if(!Array.isArray(t.output))return"output: array expected";for(var i=0;i<t.output.length;++i)if(!T.isString(t.output[i]))return"output: string[] expected"}if(t.attribute!=null&&t.hasOwnProperty("attribute")){if(!Array.isArray(t.attribute))return"attribute: array expected";for(var i=0;i<t.attribute.length;++i)if(!T.isString(t.attribute[i]))return"attribute: string[] expected"}if(t.node!=null&&t.hasOwnProperty("node")){if(!Array.isArray(t.node))return"node: array expected";for(var i=0;i<t.node.length;++i){var o=b.onnx.NodeProto.verify(t.node[i]);if(o)return"node."+o}}if(t.docString!=null&&t.hasOwnProperty("docString")&&!T.isString(t.docString))return"docString: string expected";if(t.opsetImport!=null&&t.hasOwnProperty("opsetImport")){if(!Array.isArray(t.opsetImport))return"opsetImport: array expected";for(var i=0;i<t.opsetImport.length;++i){var o=b.onnx.OperatorSetIdProto.verify(t.opsetImport[i]);if(o)return"opsetImport."+o}}return t.domain!=null&&t.hasOwnProperty("domain")&&!T.isString(t.domain)?"domain: string expected":null},e.fromObject=function(t){if(t instanceof b.onnx.FunctionProto)return t;var i=new b.onnx.FunctionProto;if(t.name!=null&&(i.name=String(t.name)),t.input){if(!Array.isArray(t.input))throw TypeError(".onnx.FunctionProto.input: array expected");i.input=[];for(var o=0;o<t.input.length;++o)i.input[o]=String(t.input[o])}if(t.output){if(!Array.isArray(t.output))throw TypeError(".onnx.FunctionProto.output: array expected");i.output=[];for(var o=0;o<t.output.length;++o)i.output[o]=String(t.output[o])}if(t.attribute){if(!Array.isArray(t.attribute))throw TypeError(".onnx.FunctionProto.attribute: array expected");i.attribute=[];for(var o=0;o<t.attribute.length;++o)i.attribute[o]=String(t.attribute[o])}if(t.node){if(!Array.isArray(t.node))throw TypeError(".onnx.FunctionProto.node: array expected");i.node=[];for(var o=0;o<t.node.length;++o){if(typeof t.node[o]!="object")throw TypeError(".onnx.FunctionProto.node: object expected");i.node[o]=b.onnx.NodeProto.fromObject(t.node[o])}}if(t.docString!=null&&(i.docString=String(t.docString)),t.opsetImport){if(!Array.isArray(t.opsetImport))throw TypeError(".onnx.FunctionProto.opsetImport: array expected");i.opsetImport=[];for(var o=0;o<t.opsetImport.length;++o){if(typeof t.opsetImport[o]!="object")throw TypeError(".onnx.FunctionProto.opsetImport: object expected");i.opsetImport[o]=b.onnx.OperatorSetIdProto.fromObject(t.opsetImport[o])}}return t.domain!=null&&(i.domain=String(t.domain)),i},e.toObject=function(t,i){i||(i={});var o={};if((i.arrays||i.defaults)&&(o.input=[],o.output=[],o.attribute=[],o.node=[],o.opsetImport=[]),i.defaults&&(o.name="",o.docString="",o.domain=""),t.name!=null&&t.hasOwnProperty("name")&&(o.name=t.name),t.input&&t.input.length){o.input=[];for(var s=0;s<t.input.length;++s)o.input[s]=t.input[s]}if(t.output&&t.output.length){o.output=[];for(var s=0;s<t.output.length;++s)o.output[s]=t.output[s]}if(t.attribute&&t.attribute.length){o.attribute=[];for(var s=0;s<t.attribute.length;++s)o.attribute[s]=t.attribute[s]}if(t.node&&t.node.length){o.node=[];for(var s=0;s<t.node.length;++s)o.node[s]=b.onnx.NodeProto.toObject(t.node[s],i)}if(t.docString!=null&&t.hasOwnProperty("docString")&&(o.docString=t.docString),t.opsetImport&&t.opsetImport.length){o.opsetImport=[];for(var s=0;s<t.opsetImport.length;++s)o.opsetImport[s]=b.onnx.OperatorSetIdProto.toObject(t.opsetImport[s],i)}return t.domain!=null&&t.hasOwnProperty("domain")&&(o.domain=t.domain),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,qe.util.toJSONOptions)},e}(),r}();Lk.exports=b});function cg(r,e){return Object.is(r,e)}var Et=null,ju=!1,ug=1,xn=Symbol("SIGNAL");function De(r){let e=Et;return Et=r,e}function yT(){return Et}var Pl={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function $u(r){if(ju)throw new Error("");if(Et===null)return;Et.consumerOnSignalRead(r);let e=Et.nextProducerIndex++;if(zu(Et),e<Et.producerNode.length&&Et.producerNode[e]!==r&&Al(Et)){let n=Et.producerNode[e];Hu(n,Et.producerIndexOfThis[e])}Et.producerNode[e]!==r&&(Et.producerNode[e]=r,Et.producerIndexOfThis[e]=Al(Et)?wT(r,Et,e):0),Et.producerLastReadVersion[e]=r.version}function IF(){ug++}function dg(r){if(!(Al(r)&&!r.dirty)&&!(!r.dirty&&r.lastCleanEpoch===ug)){if(!r.producerMustRecompute(r)&&!fg(r)){lg(r);return}r.producerRecomputeValue(r),lg(r)}}function vT(r){if(r.liveConsumerNode===void 0)return;let e=ju;ju=!0;try{for(let n of r.liveConsumerNode)n.dirty||OF(n)}finally{ju=e}}function bT(){return Et?.consumerAllowSignalWrites!==!1}function OF(r){r.dirty=!0,vT(r),r.consumerMarkedDirty?.(r)}function lg(r){r.dirty=!1,r.lastCleanEpoch=ug}function Uu(r){return r&&(r.nextProducerIndex=0),De(r)}function hg(r,e){if(De(e),!(!r||r.producerNode===void 0||r.producerIndexOfThis===void 0||r.producerLastReadVersion===void 0)){if(Al(r))for(let n=r.nextProducerIndex;n<r.producerNode.length;n++)Hu(r.producerNode[n],r.producerIndexOfThis[n]);for(;r.producerNode.length>r.nextProducerIndex;)r.producerNode.pop(),r.producerLastReadVersion.pop(),r.producerIndexOfThis.pop()}}function fg(r){zu(r);for(let e=0;e<r.producerNode.length;e++){let n=r.producerNode[e],t=r.producerLastReadVersion[e];if(t!==n.version||(dg(n),t!==n.version))return!0}return!1}function pg(r){if(zu(r),Al(r))for(let e=0;e<r.producerNode.length;e++)Hu(r.producerNode[e],r.producerIndexOfThis[e]);r.producerNode.length=r.producerLastReadVersion.length=r.producerIndexOfThis.length=0,r.liveConsumerNode&&(r.liveConsumerNode.length=r.liveConsumerIndexOfThis.length=0)}function wT(r,e,n){if(_T(r),r.liveConsumerNode.length===0&&TT(r))for(let t=0;t<r.producerNode.length;t++)r.producerIndexOfThis[t]=wT(r.producerNode[t],r,t);return r.liveConsumerIndexOfThis.push(n),r.liveConsumerNode.push(e)-1}function Hu(r,e){if(_T(r),r.liveConsumerNode.length===1&&TT(r))for(let t=0;t<r.producerNode.length;t++)Hu(r.producerNode[t],r.producerIndexOfThis[t]);let n=r.liveConsumerNode.length-1;if(r.liveConsumerNode[e]=r.liveConsumerNode[n],r.liveConsumerIndexOfThis[e]=r.liveConsumerIndexOfThis[n],r.liveConsumerNode.length--,r.liveConsumerIndexOfThis.length--,e<r.liveConsumerNode.length){let t=r.liveConsumerIndexOfThis[e],i=r.liveConsumerNode[e];zu(i),i.producerIndexOfThis[t]=e}}function Al(r){return r.consumerIsAlwaysLive||(r?.liveConsumerNode?.length??0)>0}function zu(r){r.producerNode??=[],r.producerIndexOfThis??=[],r.producerLastReadVersion??=[]}function _T(r){r.liveConsumerNode??=[],r.liveConsumerIndexOfThis??=[]}function TT(r){return r.producerNode!==void 0}function xT(r){let e=Object.create(AF);e.computation=r;let n=()=>{if(dg(e),$u(e),e.value===Vu)throw e.error;return e.value};return n[xn]=e,n}var sg=Symbol("UNSET"),ag=Symbol("COMPUTING"),Vu=Symbol("ERRORED"),AF=k(C({},Pl),{value:sg,dirty:!0,error:null,equal:cg,kind:"computed",producerMustRecompute(r){return r.value===sg||r.value===ag},producerRecomputeValue(r){if(r.value===ag)throw new Error("Detected cycle in computations.");let e=r.value;r.value=ag;let n=Uu(r),t,i=!1;try{t=r.computation(),De(null),i=e!==sg&&e!==Vu&&t!==Vu&&r.equal(e,t)}catch(o){t=Vu,r.error=o}finally{hg(r,n)}if(i){r.value=e;return}r.value=t,r.version++}});function PF(){throw new Error}var ST=PF;function ET(){ST()}function DT(r){ST=r}var MF=null;function CT(r){let e=Object.create(gg);e.value=r;let n=()=>($u(e),e.value);return n[xn]=e,n}function Gu(r,e){bT()||ET(),r.equal(r.value,e)||(r.value=e,NF(r))}function IT(r,e){bT()||ET(),Gu(r,e(r.value))}var gg=k(C({},Pl),{equal:cg,value:void 0,kind:"signal"});function NF(r){r.version++,IF(),vT(r),MF?.()}function le(r){return typeof r=="function"}function Ls(r){let n=r(t=>{Error.call(t),t.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Wu=Ls(r=>function(n){r(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((t,i)=>`${i+1}) ${t.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function xo(r,e){if(r){let n=r.indexOf(e);0<=n&&r.splice(n,1)}}var ot=class r{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let o of n)o.remove(this);else n.remove(this);let{initialTeardown:t}=this;if(le(t))try{t()}catch(o){e=o instanceof Wu?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{OT(o)}catch(s){e=e??[],s instanceof Wu?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Wu(e)}}add(e){var n;if(e&&e!==this)if(this.closed)OT(e);else{if(e instanceof r){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&xo(n,e)}remove(e){let{_finalizers:n}=this;n&&xo(n,e),e instanceof r&&e._removeParent(this)}};ot.EMPTY=(()=>{let r=new ot;return r.closed=!0,r})();var mg=ot.EMPTY;function qu(r){return r instanceof ot||r&&"closed"in r&&le(r.remove)&&le(r.add)&&le(r.unsubscribe)}function OT(r){le(r)?r():r.unsubscribe()}var lr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Bs={setTimeout(r,e,...n){let{delegate:t}=Bs;return t?.setTimeout?t.setTimeout(r,e,...n):setTimeout(r,e,...n)},clearTimeout(r){let{delegate:e}=Bs;return(e?.clearTimeout||clearTimeout)(r)},delegate:void 0};function Yu(r){Bs.setTimeout(()=>{let{onUnhandledError:e}=lr;if(e)e(r);else throw r})}function Ml(){}var AT=yg("C",void 0,void 0);function PT(r){return yg("E",void 0,r)}function MT(r){return yg("N",r,void 0)}function yg(r,e,n){return{kind:r,value:e,error:n}}var So=null;function js(r){if(lr.useDeprecatedSynchronousErrorHandling){let e=!So;if(e&&(So={errorThrown:!1,error:null}),r(),e){let{errorThrown:n,error:t}=So;if(So=null,n)throw t}}else r()}function NT(r){lr.useDeprecatedSynchronousErrorHandling&&So&&(So.errorThrown=!0,So.error=r)}var Eo=class extends ot{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,qu(e)&&e.add(this)):this.destination=FF}static create(e,n,t){return new Vs(e,n,t)}next(e){this.isStopped?bg(MT(e),this):this._next(e)}error(e){this.isStopped?bg(PT(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?bg(AT,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},RF=Function.prototype.bind;function vg(r,e){return RF.call(r,e)}var wg=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(t){Xu(t)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(t){Xu(t)}else Xu(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Xu(n)}}},Vs=class extends Eo{constructor(e,n,t){super();let i;if(le(e)||!e)i={next:e??void 0,error:n??void 0,complete:t??void 0};else{let o;this&&lr.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&vg(e.next,o),error:e.error&&vg(e.error,o),complete:e.complete&&vg(e.complete,o)}):i=e}this.destination=new wg(i)}};function Xu(r){lr.useDeprecatedSynchronousErrorHandling?NT(r):Yu(r)}function kF(r){throw r}function bg(r,e){let{onStoppedNotification:n}=lr;n&&Bs.setTimeout(()=>n(r,e))}var FF={closed:!0,next:Ml,error:kF,complete:Ml};var $s=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Sn(r){return r}function _g(...r){return Tg(r)}function Tg(r){return r.length===0?Sn:r.length===1?r[0]:function(n){return r.reduce((t,i)=>i(t),n)}}var Ie=(()=>{class r{constructor(n){n&&(this._subscribe=n)}lift(n){let t=new r;return t.source=this,t.operator=n,t}subscribe(n,t,i){let o=BF(n)?n:new Vs(n,t,i);return js(()=>{let{operator:s,source:l}=this;o.add(s?s.call(o,l):l?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(n){try{return this._subscribe(n)}catch(t){n.error(t)}}forEach(n,t){return t=RT(t),new t((i,o)=>{let s=new Vs({next:l=>{try{n(l)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(n){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(n)}[$s](){return this}pipe(...n){return Tg(n)(this)}toPromise(n){return n=RT(n),new n((t,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>t(o))})}}return r.create=e=>new r(e),r})();function RT(r){var e;return(e=r??lr.Promise)!==null&&e!==void 0?e:Promise}function LF(r){return r&&le(r.next)&&le(r.error)&&le(r.complete)}function BF(r){return r&&r instanceof Eo||LF(r)&&qu(r)}function xg(r){return le(r?.lift)}function Te(r){return e=>{if(xg(e))return e.lift(function(n){try{return r(n,this)}catch(t){this.error(t)}});throw new TypeError("Unable to lift unknown Observable type")}}function ye(r,e,n,t,i){return new Sg(r,e,n,t,i)}var Sg=class extends Eo{constructor(e,n,t,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=n?function(l){try{n(l)}catch(c){e.error(c)}}:super._next,this._error=i?function(l){try{i(l)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=t?function(){try{t()}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Us(){return Te((r,e)=>{let n=null;r._refCount++;let t=ye(e,void 0,void 0,void 0,()=>{if(!r||r._refCount<=0||0<--r._refCount){n=null;return}let i=r._connection,o=n;n=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});r.subscribe(t),t.closed||(n=r.connect())})}var Hs=class extends Ie{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,xg(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new ot;let n=this.getSubject();e.add(this.source.subscribe(ye(n,void 0,()=>{this._teardown(),n.complete()},t=>{this._teardown(),n.error(t)},()=>this._teardown()))),e.closed&&(this._connection=null,e=ot.EMPTY)}return e}refCount(){return Us()(this)}};var kT=Ls(r=>function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Dt=(()=>{class r extends Ie{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let t=new Ku(this,this);return t.operator=n,t}_throwIfClosed(){if(this.closed)throw new kT}next(n){js(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let t of this.currentObservers)t.next(n)}})}error(n){js(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:t}=this;for(;t.length;)t.shift().error(n)}})}complete(){js(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:t,isStopped:i,observers:o}=this;return t||i?mg:(this.currentObservers=null,o.push(n),new ot(()=>{this.currentObservers=null,xo(o,n)}))}_checkFinalizedStatuses(n){let{hasError:t,thrownError:i,isStopped:o}=this;t?n.error(i):o&&n.complete()}asObservable(){let n=new Ie;return n.source=this,n}}return r.create=(e,n)=>new Ku(e,n),r})(),Ku=class extends Dt{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,t;(t=(n=this.destination)===null||n===void 0?void 0:n.next)===null||t===void 0||t.call(n,e)}error(e){var n,t;(t=(n=this.destination)===null||n===void 0?void 0:n.error)===null||t===void 0||t.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,t;return(t=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&t!==void 0?t:mg}};var st=class extends Dt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:t}=this;if(e)throw n;return this._throwIfClosed(),t}next(e){super.next(this._value=e)}};var Eg={now(){return(Eg.delegate||Date).now()},delegate:void 0};var Zu=class extends ot{constructor(e,n){super()}schedule(e,n=0){return this}};var Nl={setInterval(r,e,...n){let{delegate:t}=Nl;return t?.setInterval?t.setInterval(r,e,...n):setInterval(r,e,...n)},clearInterval(r){let{delegate:e}=Nl;return(e?.clearInterval||clearInterval)(r)},delegate:void 0};var Ju=class extends Zu{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var t;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,n)),this.pending=!0,this.delay=n,this.id=(t=this.id)!==null&&t!==void 0?t:this.requestAsyncId(o,this.id,n),this}requestAsyncId(e,n,t=0){return Nl.setInterval(e.flush.bind(e,this),t)}recycleAsyncId(e,n,t=0){if(t!=null&&this.delay===t&&this.pending===!1)return n;n!=null&&Nl.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let t=this._execute(e,n);if(t)return t;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let t=!1,i;try{this.work(e)}catch(o){t=!0,i=o||new Error("Scheduled action threw falsy error")}if(t)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:t}=n;this.work=this.state=this.scheduler=null,this.pending=!1,xo(t,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var zs=class r{constructor(e,n=r.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,t){return new this.schedulerActionCtor(this,e).schedule(t,n)}};zs.now=Eg.now;var Qu=class extends zs{constructor(e,n=zs.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let t;this._active=!0;do if(t=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,t){for(;e=n.shift();)e.unsubscribe();throw t}}};var FT=new Qu(Ju);var En=new Ie(r=>r.complete());function LT(r){return r&&le(r.schedule)}function BT(r){return r[r.length-1]}function ed(r){return le(BT(r))?r.pop():void 0}function Si(r){return LT(BT(r))?r.pop():void 0}function VT(r,e,n,t){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function l(u){try{a(t.next(u))}catch(d){s(d)}}function c(u){try{a(t.throw(u))}catch(d){s(d)}}function a(u){u.done?o(u.value):i(u.value).then(l,c)}a((t=t.apply(r,e||[])).next())})}function jT(r){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&r[e],t=0;if(n)return n.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&t>=r.length&&(r=void 0),{value:r&&r[t++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Do(r){return this instanceof Do?(this.v=r,this):new Do(r)}function $T(r,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=n.apply(r,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(f){return function(p){return Promise.resolve(p).then(f,d)}}function l(f,p){t[f]&&(i[f]=function(g){return new Promise(function(y,w){o.push([f,g,y,w])>1||c(f,g)})},p&&(i[f]=p(i[f])))}function c(f,p){try{a(t[f](p))}catch(g){h(o[0][3],g)}}function a(f){f.value instanceof Do?Promise.resolve(f.value.v).then(u,d):h(o[0][2],f)}function u(f){c("next",f)}function d(f){c("throw",f)}function h(f,p){f(p),o.shift(),o.length&&c(o[0][0],o[0][1])}}function UT(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],n;return e?e.call(r):(r=typeof jT=="function"?jT(r):r[Symbol.iterator](),n={},t("next"),t("throw"),t("return"),n[Symbol.asyncIterator]=function(){return this},n);function t(o){n[o]=r[o]&&function(s){return new Promise(function(l,c){s=r[o](s),i(l,c,s.done,s.value)})}}function i(o,s,l,c){Promise.resolve(c).then(function(a){o({value:a,done:l})},s)}}var td=r=>r&&typeof r.length=="number"&&typeof r!="function";function nd(r){return le(r?.then)}function rd(r){return le(r[$s])}function id(r){return Symbol.asyncIterator&&le(r?.[Symbol.asyncIterator])}function od(r){return new TypeError(`You provided ${r!==null&&typeof r=="object"?"an invalid object":`'${r}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function jF(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var sd=jF();function ad(r){return le(r?.[sd])}function ld(r){return $T(this,arguments,function*(){let n=r.getReader();try{for(;;){let{value:t,done:i}=yield Do(n.read());if(i)return yield Do(void 0);yield yield Do(t)}}finally{n.releaseLock()}})}function cd(r){return le(r?.getReader)}function vt(r){if(r instanceof Ie)return r;if(r!=null){if(rd(r))return VF(r);if(td(r))return $F(r);if(nd(r))return UF(r);if(id(r))return HT(r);if(ad(r))return HF(r);if(cd(r))return zF(r)}throw od(r)}function VF(r){return new Ie(e=>{let n=r[$s]();if(le(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function $F(r){return new Ie(e=>{for(let n=0;n<r.length&&!e.closed;n++)e.next(r[n]);e.complete()})}function UF(r){return new Ie(e=>{r.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Yu)})}function HF(r){return new Ie(e=>{for(let n of r)if(e.next(n),e.closed)return;e.complete()})}function HT(r){return new Ie(e=>{GF(r,e).catch(n=>e.error(n))})}function zF(r){return HT(ld(r))}function GF(r,e){var n,t,i,o;return VT(this,void 0,void 0,function*(){try{for(n=UT(r);t=yield n.next(),!t.done;){let s=t.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{t&&!t.done&&(o=n.return)&&(yield o.call(n))}finally{if(i)throw i.error}}e.complete()})}function pn(r,e,n,t=0,i=!1){let o=e.schedule(function(){n(),i?r.add(this.schedule(null,t)):this.unsubscribe()},t);if(r.add(o),!i)return o}function ud(r,e=0){return Te((n,t)=>{n.subscribe(ye(t,i=>pn(t,r,()=>t.next(i),e),()=>pn(t,r,()=>t.complete(),e),i=>pn(t,r,()=>t.error(i),e)))})}function dd(r,e=0){return Te((n,t)=>{t.add(r.schedule(()=>n.subscribe(t),e))})}function zT(r,e){return vt(r).pipe(dd(e),ud(e))}function GT(r,e){return vt(r).pipe(dd(e),ud(e))}function WT(r,e){return new Ie(n=>{let t=0;return e.schedule(function(){t===r.length?n.complete():(n.next(r[t++]),n.closed||this.schedule())})})}function qT(r,e){return new Ie(n=>{let t;return pn(n,e,()=>{t=r[sd](),pn(n,e,()=>{let i,o;try{({value:i,done:o}=t.next())}catch(s){n.error(s);return}o?n.complete():n.next(i)},0,!0)}),()=>le(t?.return)&&t.return()})}function hd(r,e){if(!r)throw new Error("Iterable cannot be null");return new Ie(n=>{pn(n,e,()=>{let t=r[Symbol.asyncIterator]();pn(n,e,()=>{t.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function YT(r,e){return hd(ld(r),e)}function XT(r,e){if(r!=null){if(rd(r))return zT(r,e);if(td(r))return WT(r,e);if(nd(r))return GT(r,e);if(id(r))return hd(r,e);if(ad(r))return qT(r,e);if(cd(r))return YT(r,e)}throw od(r)}function Xe(r,e){return e?XT(r,e):vt(r)}function ee(...r){let e=Si(r);return Xe(r,e)}function Gs(r,e){let n=le(r)?r:()=>r,t=i=>i.error(n());return new Ie(e?i=>e.schedule(t,0,i):t)}function Dg(r){return!!r&&(r instanceof Ie||le(r.lift)&&le(r.subscribe))}var Yr=Ls(r=>function(){r(this),this.name="EmptyError",this.message="no elements in sequence"});function ue(r,e){return Te((n,t)=>{let i=0;n.subscribe(ye(t,o=>{t.next(r.call(e,o,i++))}))})}var{isArray:WF}=Array;function qF(r,e){return WF(e)?r(...e):r(e)}function fd(r){return ue(e=>qF(r,e))}var{isArray:YF}=Array,{getPrototypeOf:XF,prototype:KF,keys:ZF}=Object;function pd(r){if(r.length===1){let e=r[0];if(YF(e))return{args:e,keys:null};if(JF(e)){let n=ZF(e);return{args:n.map(t=>e[t]),keys:n}}}return{args:r,keys:null}}function JF(r){return r&&typeof r=="object"&&XF(r)===KF}function gd(r,e){return r.reduce((n,t,i)=>(n[t]=e[i],n),{})}function Rl(...r){let e=Si(r),n=ed(r),{args:t,keys:i}=pd(r);if(t.length===0)return Xe([],e);let o=new Ie(QF(t,e,i?s=>gd(i,s):Sn));return n?o.pipe(fd(n)):o}function QF(r,e,n=Sn){return t=>{KT(e,()=>{let{length:i}=r,o=new Array(i),s=i,l=i;for(let c=0;c<i;c++)KT(e,()=>{let a=Xe(r[c],e),u=!1;a.subscribe(ye(t,d=>{o[c]=d,u||(u=!0,l--),l||t.next(n(o.slice()))},()=>{--s||t.complete()}))},t)},t)}}function KT(r,e,n){r?pn(n,r,e):e()}function ZT(r,e,n,t,i,o,s,l){let c=[],a=0,u=0,d=!1,h=()=>{d&&!c.length&&!a&&e.complete()},f=g=>a<t?p(g):c.push(g),p=g=>{o&&e.next(g),a++;let y=!1;vt(n(g,u++)).subscribe(ye(e,w=>{i?.(w),o?f(w):e.next(w)},()=>{y=!0},void 0,()=>{if(y)try{for(a--;c.length&&a<t;){let w=c.shift();s?pn(e,s,()=>p(w)):p(w)}h()}catch(w){e.error(w)}}))};return r.subscribe(ye(e,f,()=>{d=!0,h()})),()=>{l?.()}}function bt(r,e,n=1/0){return le(e)?bt((t,i)=>ue((o,s)=>e(t,o,i,s))(vt(r(t,i))),n):(typeof e=="number"&&(n=e),Te((t,i)=>ZT(t,i,r,n)))}function Ws(r=1/0){return bt(Sn,r)}function JT(){return Ws(1)}function qs(...r){return JT()(Xe(r,Si(r)))}function md(r){return new Ie(e=>{vt(r()).subscribe(e)})}function Cg(...r){let e=ed(r),{args:n,keys:t}=pd(r),i=new Ie(o=>{let{length:s}=n;if(!s){o.complete();return}let l=new Array(s),c=s,a=s;for(let u=0;u<s;u++){let d=!1;vt(n[u]).subscribe(ye(o,h=>{d||(d=!0,a--),l[u]=h},()=>c--,void 0,()=>{(!c||!d)&&(a||o.next(t?gd(t,l):l),o.complete())}))}});return e?i.pipe(fd(e)):i}function Vt(r,e){return Te((n,t)=>{let i=0;n.subscribe(ye(t,o=>r.call(e,o,i++)&&t.next(o)))})}function Ei(r){return Te((e,n)=>{let t=null,i=!1,o;t=e.subscribe(ye(n,void 0,void 0,s=>{o=vt(r(s,Ei(r)(e))),t?(t.unsubscribe(),t=null,o.subscribe(n)):i=!0})),i&&(t.unsubscribe(),t=null,o.subscribe(n))})}function QT(r,e,n,t,i){return(o,s)=>{let l=n,c=e,a=0;o.subscribe(ye(s,u=>{let d=a++;c=l?r(c,u,d):(l=!0,u),t&&s.next(c)},i&&(()=>{l&&s.next(c),s.complete()})))}}function Xr(r,e){return le(e)?bt(r,e,1):bt(r,1)}function Ig(r,e=FT){return Te((n,t)=>{let i=null,o=null,s=null,l=()=>{if(i){i.unsubscribe(),i=null;let a=o;o=null,t.next(a)}};function c(){let a=s+r,u=e.now();if(u<a){i=this.schedule(void 0,a-u),t.add(i);return}l()}n.subscribe(ye(t,a=>{o=a,s=e.now(),i||(i=e.schedule(c,r),t.add(i))},()=>{l(),t.complete()},void 0,()=>{o=i=null}))})}function Di(r){return Te((e,n)=>{let t=!1;e.subscribe(ye(n,i=>{t=!0,n.next(i)},()=>{t||n.next(r),n.complete()}))})}function Kr(r){return r<=0?()=>En:Te((e,n)=>{let t=0;e.subscribe(ye(n,i=>{++t<=r&&(n.next(i),r<=t&&n.complete())}))})}function yd(r=eL){return Te((e,n)=>{let t=!1;e.subscribe(ye(n,i=>{t=!0,n.next(i)},()=>t?n.complete():n.error(r())))})}function eL(){return new Yr}function Co(r){return Te((e,n)=>{try{e.subscribe(n)}finally{n.add(r)}})}function Zr(r,e){let n=arguments.length>=2;return t=>t.pipe(r?Vt((i,o)=>r(i,o,t)):Sn,Kr(1),n?Di(e):yd(()=>new Yr))}function Ys(r){return r<=0?()=>En:Te((e,n)=>{let t=[];e.subscribe(ye(n,i=>{t.push(i),r<t.length&&t.shift()},()=>{for(let i of t)n.next(i);n.complete()},void 0,()=>{t=null}))})}function Og(r,e){let n=arguments.length>=2;return t=>t.pipe(r?Vt((i,o)=>r(i,o,t)):Sn,Ys(1),n?Di(e):yd(()=>new Yr))}function Ag(r,e){return Te(QT(r,e,arguments.length>=2,!0))}function Pg(...r){let e=Si(r);return Te((n,t)=>{(e?qs(r,n,e):qs(r,n)).subscribe(t)})}function gn(r,e){return Te((n,t)=>{let i=null,o=0,s=!1,l=()=>s&&!i&&t.complete();n.subscribe(ye(t,c=>{i?.unsubscribe();let a=0,u=o++;vt(r(c,u)).subscribe(i=ye(t,d=>t.next(e?e(c,d,u,a++):d),()=>{i=null,l()}))},()=>{s=!0,l()}))})}function Mg(r){return Te((e,n)=>{vt(r).subscribe(ye(n,()=>n.complete(),Ml)),!n.closed&&e.subscribe(n)})}function Pt(r,e,n){let t=le(r)||e||n?{next:r,error:e,complete:n}:r;return t?Te((i,o)=>{var s;(s=t.subscribe)===null||s===void 0||s.call(t);let l=!0;i.subscribe(ye(o,c=>{var a;(a=t.next)===null||a===void 0||a.call(t,c),o.next(c)},()=>{var c;l=!1,(c=t.complete)===null||c===void 0||c.call(t),o.complete()},c=>{var a;l=!1,(a=t.error)===null||a===void 0||a.call(t,c),o.error(c)},()=>{var c,a;l&&((c=t.unsubscribe)===null||c===void 0||c.call(t)),(a=t.finalize)===null||a===void 0||a.call(t)}))}):Sn}var Vx="https://g.co/ng/security#xss",X=class extends Error{code;constructor(e,n){super(Jd(e,n)),this.code=e}};function Jd(r,e){return`${`NG0${Math.abs(r)}`}${e?": "+e:""}`}var $x=Symbol("InputSignalNode#UNSET"),tL=k(C({},gg),{transformFn:void 0,applyValueToInputSignal(r,e){Gu(r,e)}});function Ux(r,e){let n=Object.create(tL);n.value=r,n.transformFn=e?.transform;function t(){if($u(n),n.value===$x)throw new X(-950,!1);return n.value}return t[xn]=n,t}function zl(r){return{toString:r}.toString()}var vd="__parameters__";function nL(r){return function(...n){if(r){let t=r(...n);for(let i in t)this[i]=t[i]}}}function Hx(r,e,n){return zl(()=>{let t=nL(e);function i(...o){if(this instanceof i)return t.apply(this,o),this;let s=new i(...o);return l.annotation=s,l;function l(c,a,u){let d=c.hasOwnProperty(vd)?c[vd]:Object.defineProperty(c,vd,{value:[]})[vd];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(s),c}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=r,i.annotationCls=i,i})}var Gg=globalThis;function Ue(r){for(let e in r)if(r[e]===Ue)return e;throw Error("Could not find renamed property on target object.")}function rL(r,e){for(let n in e)e.hasOwnProperty(n)&&!r.hasOwnProperty(n)&&(r[n]=e[n])}function rn(r){if(typeof r=="string")return r;if(Array.isArray(r))return"["+r.map(rn).join(", ")+"]";if(r==null)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;let e=r.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function ex(r,e){return r==null||r===""?e===null?"":e:e==null||e===""?r:r+" "+e}var iL=Ue({__forward_ref__:Ue});function ki(r){return r.__forward_ref__=ki,r.toString=function(){return rn(this())},r}function nn(r){return zx(r)?r():r}function zx(r){return typeof r=="function"&&r.hasOwnProperty(iL)&&r.__forward_ref__===ki}function W(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function ni(r){return{providers:r.providers||[],imports:r.imports||[]}}function Qd(r){return tx(r,Wx)||tx(r,qx)}function Gx(r){return Qd(r)!==null}function tx(r,e){return r.hasOwnProperty(e)?r[e]:null}function oL(r){let e=r&&(r[Wx]||r[qx]);return e||null}function nx(r){return r&&(r.hasOwnProperty(rx)||r.hasOwnProperty(sL))?r[rx]:null}var Wx=Ue({\u0275prov:Ue}),rx=Ue({\u0275inj:Ue}),qx=Ue({ngInjectableDef:Ue}),sL=Ue({ngInjectorDef:Ue}),Y=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,n){this._desc=e,this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=W({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Yx(r){return r&&!!r.\u0275providers}var aL=Ue({\u0275cmp:Ue}),lL=Ue({\u0275dir:Ue}),cL=Ue({\u0275pipe:Ue}),uL=Ue({\u0275mod:Ue}),Cd=Ue({\u0275fac:Ue}),Bl=Ue({__NG_ELEMENT_ID__:Ue}),ix=Ue({__NG_ENV_ID__:Ue});function eh(r){return typeof r=="string"?r:r==null?"":String(r)}function dL(r){return typeof r=="function"?r.name||r.toString():typeof r=="object"&&r!=null&&typeof r.type=="function"?r.type.name||r.type.toString():eh(r)}function hL(r,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${r}`:"";throw new X(-200,r)}function km(r,e){throw new X(-201,!1)}var pe=function(r){return r[r.Default=0]="Default",r[r.Host=1]="Host",r[r.Self=2]="Self",r[r.SkipSelf=4]="SkipSelf",r[r.Optional=8]="Optional",r}(pe||{}),Wg;function Xx(){return Wg}function mn(r){let e=Wg;return Wg=r,e}function Kx(r,e,n){let t=Qd(r);if(t&&t.providedIn=="root")return t.value===void 0?t.value=t.factory():t.value;if(n&pe.Optional)return null;if(e!==void 0)return e;km(r,"Injector")}var fL={},jl=fL,qg="__NG_DI_FLAG__",Id="ngTempTokenPath",pL="ngTokenPath",gL=/\n/gm,mL="\u0275",ox="__source",Qs;function yL(){return Qs}function Ci(r){let e=Qs;return Qs=r,e}function vL(r,e=pe.Default){if(Qs===void 0)throw new X(-203,!1);return Qs===null?Kx(r,void 0,e):Qs.get(r,e&pe.Optional?null:void 0,e)}function J(r,e=pe.Default){return(Xx()||vL)(nn(r),e)}function V(r,e=pe.Default){return J(r,th(e))}function th(r){return typeof r>"u"||typeof r=="number"?r:0|(r.optional&&8)|(r.host&&1)|(r.self&&2)|(r.skipSelf&&4)}function Yg(r){let e=[];for(let n=0;n<r.length;n++){let t=nn(r[n]);if(Array.isArray(t)){if(t.length===0)throw new X(900,!1);let i,o=pe.Default;for(let s=0;s<t.length;s++){let l=t[s],c=bL(l);typeof c=="number"?c===-1?i=l.token:o|=c:i=l}e.push(J(i,o))}else e.push(J(t))}return e}function Zx(r,e){return r[qg]=e,r.prototype[qg]=e,r}function bL(r){return r[qg]}function wL(r,e,n,t){let i=r[Id];throw e[ox]&&i.unshift(e[ox]),r.message=_L(`
`+r.message,i,n,t),r[pL]=i,r[Id]=null,r}function _L(r,e,n,t=null){r=r&&r.charAt(0)===`
`&&r.charAt(1)==mL?r.slice(2):r;let i=rn(e);if(Array.isArray(e))i=e.map(rn).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let l=e[s];o.push(s+":"+(typeof l=="string"?JSON.stringify(l):rn(l)))}i=`{${o.join(", ")}}`}return`${n}${t?"("+t+")":""}[${i}]: ${r.replace(gL,`
  `)}`}var Jx=Zx(Hx("Optional"),8);var TL=Zx(Hx("SkipSelf"),4);function Oo(r,e){let n=r.hasOwnProperty(Cd);return n?r[Cd]:null}function Fm(r,e){r.forEach(n=>Array.isArray(n)?Fm(n,e):e(n))}function Qx(r,e,n){e>=r.length?r.push(n):r.splice(e,0,n)}function Od(r,e){return e>=r.length-1?r.pop():r.splice(e,1)[0]}function xL(r,e,n,t){let i=r.length;if(i==e)r.push(n,t);else if(i===1)r.push(t,r[0]),r[0]=n;else{for(i--,r.push(r[i-1],r[i]);i>e;){let o=i-2;r[i]=r[o],i--}r[e]=n,r[e+1]=t}}function SL(r,e,n){let t=Gl(r,e);return t>=0?r[t|1]=n:(t=~t,xL(r,t,e,n)),t}function Ng(r,e){let n=Gl(r,e);if(n>=0)return r[n|1]}function Gl(r,e){return EL(r,e,1)}function EL(r,e,n){let t=0,i=r.length>>n;for(;i!==t;){let o=t+(i-t>>1),s=r[o<<n];if(e===s)return o<<n;s>e?i=o:t=o+1}return~(i<<n)}var ta={},Un=[],na=new Y(""),eS=new Y("",-1),tS=new Y(""),Ad=class{get(e,n=jl){if(n===jl){let t=new Error(`NullInjectorError: No provider for ${rn(e)}!`);throw t.name="NullInjectorError",t}return n}};function nS(r,e){let n=r[uL]||null;if(!n&&e===!0)throw new Error(`Type ${rn(r)} does not have '\u0275mod' property.`);return n}function Ai(r){return r[aL]||null}function rS(r){return r[lL]||null}function iS(r){return r[cL]||null}function oS(r){let e=Ai(r)||rS(r)||iS(r);return e!==null&&e.standalone}function ga(r){return{\u0275providers:r}}function DL(...r){return{\u0275providers:sS(!0,r),\u0275fromNgModule:!0}}function sS(r,...e){let n=[],t=new Set,i,o=s=>{n.push(s)};return Fm(e,s=>{let l=s;Xg(l,o,[],t)&&(i||=[],i.push(l))}),i!==void 0&&aS(i,o),n}function aS(r,e){for(let n=0;n<r.length;n++){let{ngModule:t,providers:i}=r[n];Lm(i,o=>{e(o,t)})}}function Xg(r,e,n,t){if(r=nn(r),!r)return!1;let i=null,o=nx(r),s=!o&&Ai(r);if(!o&&!s){let c=r.ngModule;if(o=nx(c),o)i=c;else return!1}else{if(s&&!s.standalone)return!1;i=r}let l=t.has(i);if(s){if(l)return!1;if(t.add(i),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let a of c)Xg(a,e,n,t)}}else if(o){if(o.imports!=null&&!l){t.add(i);let a;try{Fm(o.imports,u=>{Xg(u,e,n,t)&&(a||=[],a.push(u))})}finally{}a!==void 0&&aS(a,e)}if(!l){let a=Oo(i)||(()=>new i);e({provide:i,useFactory:a,deps:Un},i),e({provide:tS,useValue:i,multi:!0},i),e({provide:na,useValue:()=>J(i),multi:!0},i)}let c=o.providers;if(c!=null&&!l){let a=r;Lm(c,u=>{e(u,a)})}}else return!1;return i!==r&&r.providers!==void 0}function Lm(r,e){for(let n of r)Yx(n)&&(n=n.\u0275providers),Array.isArray(n)?Lm(n,e):e(n)}var CL=Ue({provide:String,useValue:Ue});function lS(r){return r!==null&&typeof r=="object"&&CL in r}function IL(r){return!!(r&&r.useExisting)}function OL(r){return!!(r&&r.useFactory)}function ra(r){return typeof r=="function"}function AL(r){return!!r.useClass}var nh=new Y(""),Td={},PL={},Rg;function Bm(){return Rg===void 0&&(Rg=new Ad),Rg}var on=class{},Vl=class extends on{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,n,t,i){super(),this.parent=n,this.source=t,this.scopes=i,Zg(e,s=>this.processProvider(s)),this.records.set(eS,Xs(void 0,this)),i.has("environment")&&this.records.set(on,Xs(void 0,this));let o=this.records.get(nh);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(tS,Un,pe.Self))}destroy(){Fl(this),this._destroyed=!0;let e=De(null);try{for(let t of this._ngOnDestroyHooks)t.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let t of n)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),De(e)}}onDestroy(e){return Fl(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Fl(this);let n=Ci(this),t=mn(void 0),i;try{return e()}finally{Ci(n),mn(t)}}get(e,n=jl,t=pe.Default){if(Fl(this),e.hasOwnProperty(ix))return e[ix](this);t=th(t);let i,o=Ci(this),s=mn(void 0);try{if(!(t&pe.SkipSelf)){let c=this.records.get(e);if(c===void 0){let a=FL(e)&&Qd(e);a&&this.injectableDefInScope(a)?c=Xs(Kg(e),Td):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let l=t&pe.Self?Bm():this.parent;return n=t&pe.Optional&&n===jl?null:n,l.get(e,n)}catch(l){if(l.name==="NullInjectorError"){if((l[Id]=l[Id]||[]).unshift(rn(e)),o)throw l;return wL(l,e,"R3InjectorError",this.source)}else throw l}finally{mn(s),Ci(o)}}resolveInjectorInitializers(){let e=De(null),n=Ci(this),t=mn(void 0),i;try{let o=this.get(na,Un,pe.Self);for(let s of o)s()}finally{Ci(n),mn(t),De(e)}}toString(){let e=[],n=this.records;for(let t of n.keys())e.push(rn(t));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=nn(e);let n=ra(e)?e:nn(e&&e.provide),t=NL(e);if(!ra(e)&&e.multi===!0){let i=this.records.get(n);i||(i=Xs(void 0,Td,!0),i.factory=()=>Yg(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,t)}hydrate(e,n){let t=De(null);try{return n.value===Td&&(n.value=PL,n.value=n.factory()),typeof n.value=="object"&&n.value&&kL(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{De(t)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=nn(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function Kg(r){let e=Qd(r),n=e!==null?e.factory:Oo(r);if(n!==null)return n;if(r instanceof Y)throw new X(204,!1);if(r instanceof Function)return ML(r);throw new X(204,!1)}function ML(r){if(r.length>0)throw new X(204,!1);let n=oL(r);return n!==null?()=>n.factory(r):()=>new r}function NL(r){if(lS(r))return Xs(void 0,r.useValue);{let e=cS(r);return Xs(e,Td)}}function cS(r,e,n){let t;if(ra(r)){let i=nn(r);return Oo(i)||Kg(i)}else if(lS(r))t=()=>nn(r.useValue);else if(OL(r))t=()=>r.useFactory(...Yg(r.deps||[]));else if(IL(r))t=()=>J(nn(r.useExisting));else{let i=nn(r&&(r.useClass||r.provide));if(RL(r))t=()=>new i(...Yg(r.deps));else return Oo(i)||Kg(i)}return t}function Fl(r){if(r.destroyed)throw new X(205,!1)}function Xs(r,e,n=!1){return{factory:r,value:e,multi:n?[]:void 0}}function RL(r){return!!r.deps}function kL(r){return r!==null&&typeof r=="object"&&typeof r.ngOnDestroy=="function"}function FL(r){return typeof r=="function"||typeof r=="object"&&r instanceof Y}function Zg(r,e){for(let n of r)Array.isArray(n)?Zg(n,e):n&&Yx(n)?Zg(n.\u0275providers,e):e(n)}function yn(r,e){r instanceof Vl&&Fl(r);let n,t=Ci(r),i=mn(void 0);try{return e()}finally{Ci(t),mn(i)}}function uS(){return Xx()!==void 0||yL()!=null}function LL(r){if(!uS())throw new X(-203,!1)}function BL(r){return typeof r=="function"}var ri=0,xe=1,ae=2,sn=3,ur=4,hr=5,Pd=6,Md=7,dr=8,ia=9,Jr=10,wt=11,$l=12,sx=13,ma=14,Ar=15,oa=16,Ks=17,sa=18,rh=19,dS=20,Ii=21,kg=22,Nd=23,Dn=24,Cn=25,hS=1;var Ao=7,Rd=8,kd=9,zn=10;function Oi(r){return Array.isArray(r)&&typeof r[hS]=="object"}function ii(r){return Array.isArray(r)&&r[hS]===!0}function jm(r){return(r.flags&4)!==0}function ih(r){return r.componentOffset>-1}function oh(r){return(r.flags&1)===1}function Pi(r){return!!r.template}function Jg(r){return(r[ae]&512)!==0}function Wl(r){return(r[ae]&256)===256}var Qg=class{previousValue;currentValue;firstChange;constructor(e,n,t){this.previousValue=e,this.currentValue=n,this.firstChange=t}isFirstChange(){return this.firstChange}};function fS(r,e,n,t){e!==null?e.applyValueToInputSignal(e,t):r[n]=t}var Fo=(()=>{let r=()=>pS;return r.ngInherit=!0,r})();function pS(r){return r.type.prototype.ngOnChanges&&(r.setInput=VL),jL}function jL(){let r=mS(this),e=r?.current;if(e){let n=r.previous;if(n===ta)r.previous=e;else for(let t in e)n[t]=e[t];r.current=null,this.ngOnChanges(e)}}function VL(r,e,n,t,i){let o=this.declaredInputs[t],s=mS(r)||$L(r,{previous:ta,current:null}),l=s.current||(s.current={}),c=s.previous,a=c[o];l[o]=new Qg(a&&a.currentValue,n,c===ta),fS(r,e,i,n)}var gS="__ngSimpleChanges__";function mS(r){return r[gS]||null}function $L(r,e){return r[gS]=e}var ax=null;var Hn=function(r,e,n){ax?.(r,e,n)},UL="svg",HL="math";function Pr(r){for(;Array.isArray(r);)r=r[ri];return r}function yS(r,e){return Pr(e[r])}function Gn(r,e){return Pr(e[r.index])}function vS(r,e){return r.data[e]}function bS(r,e){return r[e]}function Fi(r,e){let n=e[r];return Oi(n)?n:n[ri]}function Vm(r){return(r[ae]&128)===128}function zL(r){return ii(r[sn])}function aa(r,e){return e==null?null:r[e]}function wS(r){r[Ks]=0}function $m(r){r[ae]&1024||(r[ae]|=1024,Vm(r)&&ah(r))}function GL(r,e){for(;r>0;)e=e[ma],r--;return e}function sh(r){return!!(r[ae]&9216||r[Dn]?.dirty)}function em(r){r[Jr].changeDetectionScheduler?.notify(9),r[ae]&64&&(r[ae]|=1024),sh(r)&&ah(r)}function ah(r){r[Jr].changeDetectionScheduler?.notify(0);let e=Po(r);for(;e!==null&&!(e[ae]&8192||(e[ae]|=8192,!Vm(e)));)e=Po(e)}function _S(r,e){if(Wl(r))throw new X(911,!1);r[Ii]===null&&(r[Ii]=[]),r[Ii].push(e)}function WL(r,e){if(r[Ii]===null)return;let n=r[Ii].indexOf(e);n!==-1&&r[Ii].splice(n,1)}function Po(r){let e=r[sn];return ii(e)?e[sn]:e}function qL(r){return r[Md]??=[]}function YL(r){return r.cleanup??=[]}var ve={lFrame:AS(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var tm=!1;function XL(){return ve.lFrame.elementDepthCount}function KL(){ve.lFrame.elementDepthCount++}function ZL(){ve.lFrame.elementDepthCount--}function TS(){return ve.bindingsEnabled}function JL(){return ve.skipHydrationRootTNode!==null}function QL(r){return ve.skipHydrationRootTNode===r}function eB(){ve.skipHydrationRootTNode=null}function je(){return ve.lFrame.lView}function qt(){return ve.lFrame.tView}function fr(r){return ve.lFrame.contextLView=r,r[dr]}function pr(r){return ve.lFrame.contextLView=null,r}function Yt(){let r=xS();for(;r!==null&&r.type===64;)r=r.parent;return r}function xS(){return ve.lFrame.currentTNode}function tB(){let r=ve.lFrame,e=r.currentTNode;return r.isParent?e:e.parent}function Lo(r,e){let n=ve.lFrame;n.currentTNode=r,n.isParent=e}function Um(){return ve.lFrame.isParent}function SS(){ve.lFrame.isParent=!1}function nB(){return ve.lFrame.contextLView}function ES(){return tm}function lx(r){let e=tm;return tm=r,e}function DS(){let r=ve.lFrame,e=r.bindingRootIndex;return e===-1&&(e=r.bindingRootIndex=r.tView.bindingStartIndex),e}function rB(r){return ve.lFrame.bindingIndex=r}function lh(){return ve.lFrame.bindingIndex++}function iB(r){let e=ve.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+r,n}function oB(){return ve.lFrame.inI18n}function sB(r,e){let n=ve.lFrame;n.bindingIndex=n.bindingRootIndex=r,nm(e)}function aB(){return ve.lFrame.currentDirectiveIndex}function nm(r){ve.lFrame.currentDirectiveIndex=r}function lB(r){let e=ve.lFrame.currentDirectiveIndex;return e===-1?null:r[e]}function CS(r){ve.lFrame.currentQueryIndex=r}function cB(r){let e=r[xe];return e.type===2?e.declTNode:e.type===1?r[hr]:null}function IS(r,e,n){if(n&pe.SkipSelf){let i=e,o=r;for(;i=i.parent,i===null&&!(n&pe.Host);)if(i=cB(o),i===null||(o=o[ma],i.type&10))break;if(i===null)return!1;e=i,r=o}let t=ve.lFrame=OS();return t.currentTNode=e,t.lView=r,!0}function Hm(r){let e=OS(),n=r[xe];ve.lFrame=e,e.currentTNode=n.firstChild,e.lView=r,e.tView=n,e.contextLView=r,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function OS(){let r=ve.lFrame,e=r===null?null:r.child;return e===null?AS(r):e}function AS(r){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return r!==null&&(r.child=e),e}function PS(){let r=ve.lFrame;return ve.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}var MS=PS;function zm(){let r=PS();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function uB(r){return(ve.lFrame.contextLView=GL(r,ve.lFrame.contextLView))[dr]}function ya(){return ve.lFrame.selectedIndex}function Mo(r){ve.lFrame.selectedIndex=r}function Gm(){let r=ve.lFrame;return vS(r.tView,r.selectedIndex)}function dB(){return ve.lFrame.currentNamespace}var NS=!0;function ch(){return NS}function uh(r){NS=r}function hB(r,e,n){let{ngOnChanges:t,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(t){let s=pS(e);(n.preOrderHooks??=[]).push(r,s),(n.preOrderCheckHooks??=[]).push(r,s)}i&&(n.preOrderHooks??=[]).push(0-r,i),o&&((n.preOrderHooks??=[]).push(r,o),(n.preOrderCheckHooks??=[]).push(r,o))}function dh(r,e){for(let n=e.directiveStart,t=e.directiveEnd;n<t;n++){let o=r.data[n].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:l,ngAfterViewInit:c,ngAfterViewChecked:a,ngOnDestroy:u}=o;s&&(r.contentHooks??=[]).push(-n,s),l&&((r.contentHooks??=[]).push(n,l),(r.contentCheckHooks??=[]).push(n,l)),c&&(r.viewHooks??=[]).push(-n,c),a&&((r.viewHooks??=[]).push(n,a),(r.viewCheckHooks??=[]).push(n,a)),u!=null&&(r.destroyHooks??=[]).push(n,u)}}function xd(r,e,n){RS(r,e,3,n)}function Sd(r,e,n,t){(r[ae]&3)===n&&RS(r,e,n,t)}function Fg(r,e){let n=r[ae];(n&3)===e&&(n&=16383,n+=1,r[ae]=n)}function RS(r,e,n,t){let i=t!==void 0?r[Ks]&65535:0,o=t??-1,s=e.length-1,l=0;for(let c=i;c<s;c++)if(typeof e[c+1]=="number"){if(l=e[c],t!=null&&l>=t)break}else e[c]<0&&(r[Ks]+=65536),(l<o||o==-1)&&(fB(r,n,e,c),r[Ks]=(r[Ks]&4294901760)+c+2),c++}function cx(r,e){Hn(4,r,e);let n=De(null);try{e.call(r)}finally{De(n),Hn(5,r,e)}}function fB(r,e,n,t){let i=n[t]<0,o=n[t+1],s=i?-n[t]:n[t],l=r[s];i?r[ae]>>14<r[Ks]>>16&&(r[ae]&3)===e&&(r[ae]+=16384,cx(l,o)):cx(l,o)}var ea=-1,No=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,n,t){this.factory=e,this.canSeeViewProviders=n,this.injectImpl=t}};function pB(r){return r instanceof No}function gB(r){return(r.flags&8)!==0}function mB(r){return(r.flags&16)!==0}function yB(r,e,n){let t=0;for(;t<n.length;){let i=n[t];if(typeof i=="number"){if(i!==0)break;t++;let o=n[t++],s=n[t++],l=n[t++];r.setAttribute(e,s,l,o)}else{let o=i,s=n[++t];vB(o)?r.setProperty(e,o,s):r.setAttribute(e,o,s),t++}}return t}function kS(r){return r===3||r===4||r===6}function vB(r){return r.charCodeAt(0)===64}function la(r,e){if(!(e===null||e.length===0))if(r===null||r.length===0)r=e.slice();else{let n=-1;for(let t=0;t<e.length;t++){let i=e[t];typeof i=="number"?n=i:n===0||(n===-1||n===2?ux(r,n,i,null,e[++t]):ux(r,n,i,null,null))}}return r}function ux(r,e,n,t,i){let o=0,s=r.length;if(e===-1)s=-1;else for(;o<r.length;){let l=r[o++];if(typeof l=="number"){if(l===e){s=-1;break}else if(l>e){s=o-1;break}}}for(;o<r.length;){let l=r[o];if(typeof l=="number")break;if(l===n){if(t===null){i!==null&&(r[o+1]=i);return}else if(t===r[o+1]){r[o+2]=i;return}}o++,t!==null&&o++,i!==null&&o++}s!==-1&&(r.splice(s,0,e),o=s+1),r.splice(o++,0,n),t!==null&&r.splice(o++,0,t),i!==null&&r.splice(o++,0,i)}var Lg={},rm=class{injector;parentInjector;constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,t){t=th(t);let i=this.injector.get(e,Lg,t);return i!==Lg||n===Lg?i:this.parentInjector.get(e,n,t)}};function FS(r){return r!==ea}function Fd(r){return r&32767}function bB(r){return r>>16}function Ld(r,e){let n=bB(r),t=e;for(;n>0;)t=t[ma],n--;return t}var im=!0;function Bd(r){let e=im;return im=r,e}var wB=256,LS=wB-1,BS=5,_B=0,Or={};function TB(r,e,n){let t;typeof n=="string"?t=n.charCodeAt(0)||0:n.hasOwnProperty(Bl)&&(t=n[Bl]),t==null&&(t=n[Bl]=_B++);let i=t&LS,o=1<<i;e.data[r+(i>>BS)]|=o}function jd(r,e){let n=jS(r,e);if(n!==-1)return n;let t=e[xe];t.firstCreatePass&&(r.injectorIndex=e.length,Bg(t.data,r),Bg(e,null),Bg(t.blueprint,null));let i=Wm(r,e),o=r.injectorIndex;if(FS(i)){let s=Fd(i),l=Ld(i,e),c=l[xe].data;for(let a=0;a<8;a++)e[o+a]=l[s+a]|c[s+a]}return e[o+8]=i,o}function Bg(r,e){r.push(0,0,0,0,0,0,0,0,e)}function jS(r,e){return r.injectorIndex===-1||r.parent&&r.parent.injectorIndex===r.injectorIndex||e[r.injectorIndex+8]===null?-1:r.injectorIndex}function Wm(r,e){if(r.parent&&r.parent.injectorIndex!==-1)return r.parent.injectorIndex;let n=0,t=null,i=e;for(;i!==null;){if(t=zS(i),t===null)return ea;if(n++,i=i[ma],t.injectorIndex!==-1)return t.injectorIndex|n<<16}return ea}function om(r,e,n){TB(r,e,n)}function xB(r,e){if(e==="class")return r.classes;if(e==="style")return r.styles;let n=r.attrs;if(n){let t=n.length,i=0;for(;i<t;){let o=n[i];if(kS(o))break;if(o===0)i=i+2;else if(typeof o=="number")for(i++;i<t&&typeof n[i]=="string";)i++;else{if(o===e)return n[i+1];i=i+2}}}return null}function VS(r,e,n){if(n&pe.Optional||r!==void 0)return r;km(e,"NodeInjector")}function $S(r,e,n,t){if(n&pe.Optional&&t===void 0&&(t=null),!(n&(pe.Self|pe.Host))){let i=r[ia],o=mn(void 0);try{return i?i.get(e,t,n&pe.Optional):Kx(e,t,n&pe.Optional)}finally{mn(o)}}return VS(t,e,n)}function US(r,e,n,t=pe.Default,i){if(r!==null){if(e[ae]&2048&&!(t&pe.Self)){let s=IB(r,e,n,t,Or);if(s!==Or)return s}let o=HS(r,e,n,t,Or);if(o!==Or)return o}return $S(e,n,t,i)}function HS(r,e,n,t,i){let o=DB(n);if(typeof o=="function"){if(!IS(e,r,t))return t&pe.Host?VS(i,n,t):$S(e,n,t,i);try{let s;if(s=o(t),s==null&&!(t&pe.Optional))km(n);else return s}finally{MS()}}else if(typeof o=="number"){let s=null,l=jS(r,e),c=ea,a=t&pe.Host?e[Ar][hr]:null;for((l===-1||t&pe.SkipSelf)&&(c=l===-1?Wm(r,e):e[l+8],c===ea||!hx(t,!1)?l=-1:(s=e[xe],l=Fd(c),e=Ld(c,e)));l!==-1;){let u=e[xe];if(dx(o,l,u.data)){let d=SB(l,e,n,s,t,a);if(d!==Or)return d}c=e[l+8],c!==ea&&hx(t,e[xe].data[l+8]===a)&&dx(o,l,e)?(s=u,l=Fd(c),e=Ld(c,e)):l=-1}}return i}function SB(r,e,n,t,i,o){let s=e[xe],l=s.data[r+8],c=t==null?ih(l)&&im:t!=s&&(l.type&3)!==0,a=i&pe.Host&&o===l,u=EB(l,s,n,c,a);return u!==null?ca(e,s,u,l):Or}function EB(r,e,n,t,i){let o=r.providerIndexes,s=e.data,l=o&1048575,c=r.directiveStart,a=r.directiveEnd,u=o>>20,d=t?l:l+u,h=i?l+u:a;for(let f=d;f<h;f++){let p=s[f];if(f<c&&n===p||f>=c&&p.type===n)return f}if(i){let f=s[c];if(f&&Pi(f)&&f.type===n)return c}return null}function ca(r,e,n,t){let i=r[n],o=e.data;if(pB(i)){let s=i;s.resolving&&hL(dL(o[n]));let l=Bd(s.canSeeViewProviders);s.resolving=!0;let c,a=s.injectImpl?mn(s.injectImpl):null,u=IS(r,t,pe.Default);try{i=r[n]=s.factory(void 0,o,r,t),e.firstCreatePass&&n>=t.directiveStart&&hB(n,o[n],e)}finally{a!==null&&mn(a),Bd(l),s.resolving=!1,MS()}}return i}function DB(r){if(typeof r=="string")return r.charCodeAt(0)||0;let e=r.hasOwnProperty(Bl)?r[Bl]:void 0;return typeof e=="number"?e>=0?e&LS:CB:e}function dx(r,e,n){let t=1<<r;return!!(n[e+(r>>BS)]&t)}function hx(r,e){return!(r&pe.Self)&&!(r&pe.Host&&e)}var Io=class{_tNode;_lView;constructor(e,n){this._tNode=e,this._lView=n}get(e,n,t){return US(this._tNode,this._lView,e,th(t),n)}};function CB(){return new Io(Yt(),je())}function Li(r){return zl(()=>{let e=r.prototype.constructor,n=e[Cd]||sm(e),t=Object.prototype,i=Object.getPrototypeOf(r.prototype).constructor;for(;i&&i!==t;){let o=i[Cd]||sm(i);if(o&&o!==n)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function sm(r){return zx(r)?()=>{let e=sm(nn(r));return e&&e()}:Oo(r)}function IB(r,e,n,t,i){let o=r,s=e;for(;o!==null&&s!==null&&s[ae]&2048&&!(s[ae]&512);){let l=HS(o,s,n,t|pe.Self,Or);if(l!==Or)return l;let c=o.parent;if(!c){let a=s[dS];if(a){let u=a.get(n,Or,t);if(u!==Or)return u}c=zS(s),s=s[ma]}o=c}return i}function zS(r){let e=r[xe],n=e.type;return n===2?e.declTNode:n===1?r[hr]:null}function qm(r){return xB(Yt(),r)}function fx(r,e=null,n=null,t){let i=GS(r,e,n,t);return i.resolveInjectorInitializers(),i}function GS(r,e=null,n=null,t,i=new Set){let o=[n||Un,DL(r)];return t=t||(typeof r=="object"?void 0:rn(r)),new Vl(o,e||Bm(),t||null,i)}var In=class r{static THROW_IF_NOT_FOUND=jl;static NULL=new Ad;static create(e,n){if(Array.isArray(e))return fx({name:""},n,e,"");{let t=e.name??"";return fx({name:t},e.parent,e.providers,t)}}static \u0275prov=W({token:r,providedIn:"any",factory:()=>J(eS)});static __NG_ELEMENT_ID__=-1};var OB=new Y("");OB.__NG_ELEMENT_ID__=r=>{let e=Yt();if(e===null)throw new X(204,!1);if(e.type&2)return e.value;if(r&pe.Optional)return null;throw new X(204,!1)};var WS=!1,Ym=(()=>{class r{static __NG_ELEMENT_ID__=AB;static __NG_ENV_ID__=n=>n}return r})(),am=class extends Ym{_lView;constructor(e){super(),this._lView=e}onDestroy(e){return _S(this._lView,e),()=>WL(this._lView,e)}};function AB(){return new am(je())}var ua=class{},hh=new Y("",{providedIn:"root",factory:()=>!1});var qS=new Y(""),YS=new Y(""),Bi=(()=>{class r{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new st(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let n=this.taskId++;return this.pendingTasks.add(n),n}has(n){return this.pendingTasks.has(n)}remove(n){this.pendingTasks.delete(n),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=W({token:r,providedIn:"root",factory:()=>new r})}return r})();var lm=class extends Dt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,uS()&&(this.destroyRef=V(Ym,{optional:!0})??void 0,this.pendingTasks=V(Bi,{optional:!0})??void 0)}emit(e){let n=De(null);try{super.next(e)}finally{De(n)}}subscribe(e,n,t){let i=e,o=n||(()=>null),s=t;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let l=super.subscribe({next:i,error:o,complete:s});return e instanceof ot&&e.add(l),l}wrapInTimeout(e){return n=>{let t=this.pendingTasks?.add();setTimeout(()=>{e(n),t!==void 0&&this.pendingTasks?.remove(t)})}}},$t=lm;function Vd(...r){}function XS(r){let e,n;function t(){r=Vd;try{n!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(n),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{r(),t()}),typeof requestAnimationFrame=="function"&&(n=requestAnimationFrame(()=>{r(),t()})),()=>t()}function px(r){return queueMicrotask(()=>r()),()=>{r=Vd}}var Xm="isAngularZone",$d=Xm+"_ID",PB=0,at=class r{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new $t(!1);onMicrotaskEmpty=new $t(!1);onStable=new $t(!1);onError=new $t(!1);constructor(e){let{enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=WS}=e;if(typeof Zone>"u")throw new X(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&t,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,RB(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Xm)===!0}static assertInAngularZone(){if(!r.isInAngularZone())throw new X(909,!1)}static assertNotInAngularZone(){if(r.isInAngularZone())throw new X(909,!1)}run(e,n,t){return this._inner.run(e,n,t)}runTask(e,n,t,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,MB,Vd,Vd);try{return o.runTask(s,n,t)}finally{o.cancelTask(s)}}runGuarded(e,n,t){return this._inner.runGuarded(e,n,t)}runOutsideAngular(e){return this._outer.run(e)}},MB={};function Km(r){if(r._nesting==0&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function NB(r){if(r.isCheckStableRunning||r.callbackScheduled)return;r.callbackScheduled=!0;function e(){XS(()=>{r.callbackScheduled=!1,cm(r),r.isCheckStableRunning=!0,Km(r),r.isCheckStableRunning=!1})}r.scheduleInRootZone?Zone.root.run(()=>{e()}):r._outer.run(()=>{e()}),cm(r)}function RB(r){let e=()=>{NB(r)},n=PB++;r._inner=r._inner.fork({name:"angular",properties:{[Xm]:!0,[$d]:n,[$d+n]:!0},onInvokeTask:(t,i,o,s,l,c)=>{if(kB(c))return t.invokeTask(o,s,l,c);try{return gx(r),t.invokeTask(o,s,l,c)}finally{(r.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||r.shouldCoalesceRunChangeDetection)&&e(),mx(r)}},onInvoke:(t,i,o,s,l,c,a)=>{try{return gx(r),t.invoke(o,s,l,c,a)}finally{r.shouldCoalesceRunChangeDetection&&!r.callbackScheduled&&!FB(c)&&e(),mx(r)}},onHasTask:(t,i,o,s)=>{t.hasTask(o,s),i===o&&(s.change=="microTask"?(r._hasPendingMicrotasks=s.microTask,cm(r),Km(r)):s.change=="macroTask"&&(r.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,o,s)=>(t.handleError(o,s),r.runOutsideAngular(()=>r.onError.emit(s)),!1)})}function cm(r){r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&r.callbackScheduled===!0?r.hasPendingMicrotasks=!0:r.hasPendingMicrotasks=!1}function gx(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function mx(r){r._nesting--,Km(r)}var um=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new $t;onMicrotaskEmpty=new $t;onStable=new $t;onError=new $t;run(e,n,t){return e.apply(n,t)}runGuarded(e,n,t){return e.apply(n,t)}runOutsideAngular(e){return e()}runTask(e,n,t,i){return e.apply(n,t)}};function kB(r){return KS(r,"__ignore_ng_zone__")}function FB(r){return KS(r,"__scheduler_tick__")}function KS(r,e){return!Array.isArray(r)||r.length!==1?!1:r[0]?.data?.[e]===!0}var Qr=class{_console=console;handleError(e){this._console.error("ERROR",e)}},LB=new Y("",{providedIn:"root",factory:()=>{let r=V(at),e=V(Qr);return n=>r.runOutsideAngular(()=>e.handleError(n))}});function yx(r,e){return Ux(r,e)}function BB(r){return Ux($x,r)}var ZS=(yx.required=BB,yx);function jB(){return fh(Yt(),je())}function fh(r,e){return new oi(Gn(r,e))}var oi=(()=>{class r{nativeElement;constructor(n){this.nativeElement=n}static __NG_ELEMENT_ID__=jB}return r})();var vx=new Set;function Bo(r){vx.has(r)||(vx.add(r),performance?.mark?.("mark_feature_usage",{detail:{feature:r}}))}function VB(r){return typeof r=="function"&&r[xn]!==void 0}function ph(r,e){Bo("NgSignals");let n=CT(r),t=n[xn];return e?.equal&&(t.equal=e.equal),n.set=i=>Gu(t,i),n.update=i=>IT(t,i),n.asReadonly=$B.bind(n),n}function $B(){let r=this[xn];if(r.readonlyFn===void 0){let e=()=>this();e[xn]=r,r.readonlyFn=e}return r.readonlyFn}function JS(r){return VB(r)&&typeof r.set=="function"}function QS(r){return(r.flags&128)===128}var eE=function(r){return r[r.OnPush=0]="OnPush",r[r.Default=1]="Default",r}(eE||{}),tE=new Map,UB=0;function HB(){return UB++}function zB(r){tE.set(r[rh],r)}function dm(r){tE.delete(r[rh])}var bx="__ngContext__";function Mi(r,e){Oi(e)?(r[bx]=e[rh],zB(e)):r[bx]=e}function nE(r){return iE(r[$l])}function rE(r){return iE(r[ur])}function iE(r){for(;r!==null&&!ii(r);)r=r[ur];return r}var hm;function oE(r){hm=r}function GB(){if(hm!==void 0)return hm;if(typeof document<"u")return document;throw new X(210,!1)}var Zm=new Y("",{providedIn:"root",factory:()=>WB}),WB="ng",Jm=new Y(""),ji=new Y("",{providedIn:"platform",factory:()=>"unknown"});var Qm=new Y("",{providedIn:"root",factory:()=>GB().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var qB="h",YB="b";var sE=!1,XB=new Y("",{providedIn:"root",factory:()=>sE});var ey=function(r){return r[r.CHANGE_DETECTION=0]="CHANGE_DETECTION",r[r.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",r}(ey||{}),va=new Y("");var Zs=function(r){return r[r.EarlyRead=0]="EarlyRead",r[r.Write=1]="Write",r[r.MixedReadWrite=2]="MixedReadWrite",r[r.Read=3]="Read",r}(Zs||{}),aE=(()=>{class r{impl=null;execute(){this.impl?.execute()}static \u0275prov=W({token:r,providedIn:"root",factory:()=>new r})}return r})(),KB=[Zs.EarlyRead,Zs.Write,Zs.MixedReadWrite,Zs.Read],ZB=(()=>{class r{ngZone=V(at);scheduler=V(ua);errorHandler=V(Qr,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){V(va,{optional:!0})}execute(){this.executing=!0;for(let n of KB)for(let t of this.sequences)if(!(t.erroredOrDestroyed||!t.hooks[n]))try{t.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>t.hooks[n](t.pipelinedValue),t.snapshot))}catch(i){t.erroredOrDestroyed=!0,this.errorHandler?.handleError(i)}this.executing=!1;for(let n of this.sequences)n.afterRun(),n.once&&(this.sequences.delete(n),n.destroy());for(let n of this.deferredRegistrations)this.sequences.add(n);this.deferredRegistrations.size>0&&this.scheduler.notify(8),this.deferredRegistrations.clear()}register(n){this.executing?this.deferredRegistrations.add(n):(this.sequences.add(n),this.scheduler.notify(7))}unregister(n){this.executing&&this.sequences.has(n)?(n.erroredOrDestroyed=!0,n.pipelinedValue=void 0,n.once=!0):(this.sequences.delete(n),this.deferredRegistrations.delete(n))}maybeTrace(n,t){return t?t.run(ey.AFTER_NEXT_RENDER,n):n()}static \u0275prov=W({token:r,providedIn:"root",factory:()=>new r})}return r})(),fm=class{impl;hooks;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,n,t,i,o=null){this.impl=e,this.hooks=n,this.once=t,this.snapshot=o,this.unregisterOnDestroy=i?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.()}};function ty(r,e){!e?.injector&&LL(ty);let n=e?.injector??V(In);return Bo("NgAfterNextRender"),QB(r,n,e,!0)}function JB(r,e){if(r instanceof Function){let n=[void 0,void 0,void 0,void 0];return n[e]=r,n}else return[r.earlyRead,r.write,r.mixedReadWrite,r.read]}function QB(r,e,n,t){let i=e.get(aE);i.impl??=e.get(ZB);let o=e.get(va,null,{optional:!0}),s=n?.phase??Zs.MixedReadWrite,l=n?.manualCleanup!==!0?e.get(Ym):null,c=new fm(i.impl,JB(r,s),t,l,o?.snapshot(null));return i.impl.register(c),c}var e3=()=>null;function ny(r,e,n=!1){return e3(r,e,n)}function lE(r,e){let n=r.contentQueries;if(n!==null){let t=De(null);try{for(let i=0;i<n.length;i+=2){let o=n[i],s=n[i+1];if(s!==-1){let l=r.data[s];CS(o),l.contentQueries(2,e[s],s)}}}finally{De(t)}}}function pm(r,e,n){CS(0);let t=De(null);try{e(r,n)}finally{De(t)}}function ry(r,e,n){if(jm(e)){let t=De(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let l=r.data[s];if(l.contentQueries){let c=n[s];l.contentQueries(1,c,s)}}}finally{De(t)}}}var Mr=function(r){return r[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",r}(Mr||{});var bd;function t3(){if(bd===void 0&&(bd=null,Gg.trustedTypes))try{bd=Gg.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return bd}function wx(r){return t3()?.createScriptURL(r)||r}var Ud=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Vx})`}};function ql(r){return r instanceof Ud?r.changingThisBreaksApplicationSecurity:r}function iy(r,e){let n=n3(r);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${Vx})`)}return n===e}function n3(r){return r instanceof Ud&&r.getTypeName()||null}var r3=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function cE(r){return r=String(r),r.match(r3)?r:"unsafe:"+r}var gh=function(r){return r[r.NONE=0]="NONE",r[r.HTML=1]="HTML",r[r.STYLE=2]="STYLE",r[r.SCRIPT=3]="SCRIPT",r[r.URL=4]="URL",r[r.RESOURCE_URL=5]="RESOURCE_URL",r}(gh||{});function oy(r){let e=dE();return e?e.sanitize(gh.URL,r)||"":iy(r,"URL")?ql(r):cE(eh(r))}function i3(r){let e=dE();if(e)return wx(e.sanitize(gh.RESOURCE_URL,r)||"");if(iy(r,"ResourceURL"))return wx(ql(r));throw new X(904,!1)}function o3(r,e){return e==="src"&&(r==="embed"||r==="frame"||r==="iframe"||r==="media"||r==="script")||e==="href"&&(r==="base"||r==="link")?i3:oy}function uE(r,e,n){return o3(e,n)(r)}function dE(){let r=je();return r&&r[Jr].sanitizer}var s3=/^>|^->|<!--|-->|--!>|<!-$/g,a3=/(<|>)/g,l3="\u200B$1\u200B";function c3(r){return r.replace(s3,e=>e.replace(a3,l3))}function hE(r){return r.ownerDocument.defaultView}function fE(r){return r instanceof Function?r():r}var Ni=function(r){return r[r.None=0]="None",r[r.SignalBased=1]="SignalBased",r[r.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",r}(Ni||{});function u3(r,e,n){let t=r.length;for(;;){let i=r.indexOf(e,n);if(i===-1)return i;if(i===0||r.charCodeAt(i-1)<=32){let o=e.length;if(i+o===t||r.charCodeAt(i+o)<=32)return i}n=i+1}}var pE="ng-template";function d3(r,e,n,t){let i=0;if(t){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&u3(e[i+1].toLowerCase(),n,0)!==-1)return!0}else if(sy(r))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===n)return!0}return!1}function sy(r){return r.type===4&&r.value!==pE}function h3(r,e,n){let t=r.type===4&&!n?pE:r.value;return e===t}function f3(r,e,n){let t=4,i=r.attrs,o=i!==null?m3(i):0,s=!1;for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="number"){if(!s&&!cr(t)&&!cr(c))return!1;if(s&&cr(c))continue;s=!1,t=c|t&1;continue}if(!s)if(t&4){if(t=2|t&1,c!==""&&!h3(r,c,n)||c===""&&e.length===1){if(cr(t))return!1;s=!0}}else if(t&8){if(i===null||!d3(r,i,c,n)){if(cr(t))return!1;s=!0}}else{let a=e[++l],u=p3(c,i,sy(r),n);if(u===-1){if(cr(t))return!1;s=!0;continue}if(a!==""){let d;if(u>o?d="":d=i[u+1].toLowerCase(),t&2&&a!==d){if(cr(t))return!1;s=!0}}}}return cr(t)||s}function cr(r){return(r&1)===0}function p3(r,e,n,t){if(e===null)return-1;let i=0;if(t||!n){let o=!1;for(;i<e.length;){let s=e[i];if(s===r)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let l=e[++i];for(;typeof l=="string";)l=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return y3(e,r)}function g3(r,e,n=!1){for(let t=0;t<e.length;t++)if(f3(r,e[t],n))return!0;return!1}function m3(r){for(let e=0;e<r.length;e++){let n=r[e];if(kS(n))return e}return r.length}function y3(r,e){let n=r.indexOf(4);if(n>-1)for(n++;n<r.length;){let t=r[n];if(typeof t=="number")return-1;if(t===e)return n;n++}return-1}function _x(r,e){return r?":not("+e.trim()+")":e}function v3(r){let e=r[0],n=1,t=2,i="",o=!1;for(;n<r.length;){let s=r[n];if(typeof s=="string")if(t&2){let l=r[++n];i+="["+s+(l.length>0?'="'+l+'"':"")+"]"}else t&8?i+="."+s:t&4&&(i+=" "+s);else i!==""&&!cr(s)&&(e+=_x(o,i),i=""),t=s,o=o||!cr(t);n++}return i!==""&&(e+=_x(o,i)),e}function b3(r){return r.map(v3).join(",")}function w3(r){let e=[],n=[],t=1,i=2;for(;t<r.length;){let o=r[t];if(typeof o=="string")i===2?o!==""&&e.push(o,r[++t]):i===8&&n.push(o);else{if(!cr(i))break;i=o}t++}return{attrs:e,classes:n}}var jo={};function ie(r=1){gE(qt(),je(),ya()+r,!1)}function gE(r,e,n,t){if(!t)if((e[ae]&3)===3){let o=r.preOrderCheckHooks;o!==null&&xd(e,o,n)}else{let o=r.preOrderHooks;o!==null&&Sd(e,o,0,n)}Mo(n)}function se(r,e=pe.Default){let n=je();if(n===null)return J(r,e);let t=Yt();return US(t,n,nn(r),e)}function mE(){let r="invalid";throw new Error(r)}function yE(r,e,n,t,i,o){let s=De(null);try{let l=null;i&Ni.SignalBased&&(l=e[t][xn]),l!==null&&l.transformFn!==void 0&&(o=l.transformFn(o)),i&Ni.HasDecoratorInputTransform&&(o=r.inputTransforms[t].call(e,o)),r.setInput!==null?r.setInput(e,l,o,n,t):fS(e,l,t,o)}finally{De(s)}}function _3(r,e){return r.createText(e)}function T3(r,e,n){r.setValue(e,n)}function x3(r,e){return r.createComment(c3(e))}function vE(r,e,n){return r.createElement(e,n)}function Hd(r,e,n,t,i){r.insertBefore(e,n,t,i)}function bE(r,e,n){r.appendChild(e,n)}function Tx(r,e,n,t,i){t!==null?Hd(r,e,n,t,i):bE(r,e,n)}function S3(r,e,n){r.removeChild(null,e,n)}function E3(r,e,n){r.setAttribute(e,"style",n)}function D3(r,e,n){n===""?r.removeAttribute(e,"class"):r.setAttribute(e,"class",n)}function wE(r,e,n){let{mergedAttrs:t,classes:i,styles:o}=n;t!==null&&yB(r,e,t),i!==null&&D3(r,e,i),o!==null&&E3(r,e,o)}function mh(r,e,n,t,i,o,s,l,c,a,u){let d=e.blueprint.slice();return d[ri]=i,d[ae]=t|4|128|8|64|1024,(a!==null||r&&r[ae]&2048)&&(d[ae]|=2048),wS(d),d[sn]=d[ma]=r,d[dr]=n,d[Jr]=s||r&&r[Jr],d[wt]=l||r&&r[wt],d[ia]=c||r&&r[ia]||null,d[hr]=o,d[rh]=HB(),d[Pd]=u,d[dS]=a,d[Ar]=e.type==2?r[Ar]:d,d}function _E(r,e,n,t){if(n===0)return-1;let i=e.length;for(let o=0;o<n;o++)e.push(t),r.blueprint.push(t),r.data.push(null);return i}function TE(r,e,n,t,i){let o=ya(),s=t&2;try{Mo(-1),s&&e.length>Cn&&gE(r,e,Cn,!1),Hn(s?2:0,i),n(t,i)}finally{Mo(o),Hn(s?3:1,i)}}function ay(r,e,n){TS()&&(F3(r,e,n,Gn(n,e)),(n.flags&64)===64&&DE(r,e,n))}function ly(r,e,n=Gn){let t=e.localNames;if(t!==null){let i=e.index+1;for(let o=0;o<t.length;o+=2){let s=t[o+1],l=s===-1?n(e,r):r[s];r[i++]=l}}}function xE(r){let e=r.tView;return e===null||e.incompleteFirstPass?r.tView=cy(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts,r.id):e}function cy(r,e,n,t,i,o,s,l,c,a,u){let d=Cn+t,h=d+i,f=C3(d,h),p=typeof a=="function"?a():a;return f[xe]={type:r,blueprint:f,template:n,queries:null,viewQuery:l,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}function C3(r,e){let n=[];for(let t=0;t<e;t++)n.push(t<r?null:jo);return n}function I3(r,e,n,t){let o=t.get(XB,sE)||n===Mr.ShadowDom,s=r.selectRootElement(e,o);return O3(s),s}function O3(r){A3(r)}var A3=()=>null;function xx(r,e,n,t,i){for(let o in e){if(!e.hasOwnProperty(o))continue;let s=e[o];if(s===void 0)continue;t??={};let l,c=Ni.None;Array.isArray(s)?(l=s[0],c=s[1]):l=s;let a=o;if(i!==null){if(!i.hasOwnProperty(o))continue;a=i[o]}r===0?Sx(t,n,a,l,c):Sx(t,n,a,l)}return t}function Sx(r,e,n,t,i){let o;r.hasOwnProperty(n)?(o=r[n]).push(e,t):o=r[n]=[e,t],i!==void 0&&o.push(i)}function P3(r,e,n){let t=e.directiveStart,i=e.directiveEnd,o=r.data,s=e.attrs,l=[],c=null,a=null;for(let u=t;u<i;u++){let d=o[u],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;c=xx(0,d.inputs,u,c,f),a=xx(1,d.outputs,u,a,p);let g=c!==null&&s!==null&&!sy(e)?q3(c,u,s):null;l.push(g)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=l,e.inputs=c,e.outputs=a}function M3(r){return r==="class"?"className":r==="for"?"htmlFor":r==="formaction"?"formAction":r==="innerHtml"?"innerHTML":r==="readonly"?"readOnly":r==="tabindex"?"tabIndex":r}function SE(r,e,n,t,i,o,s,l){let c=Gn(e,n),a=e.inputs,u;!l&&a!=null&&(u=a[t])?(dy(r,n,u,t,i),ih(e)&&N3(n,e.index)):e.type&3?(t=M3(t),i=s!=null?s(i,e.value||"",t):i,o.setProperty(c,t,i)):e.type&12}function N3(r,e){let n=Fi(e,r);n[ae]&16||(n[ae]|=64)}function uy(r,e,n,t){if(TS()){let i=t===null?null:{"":-1},o=B3(r,n),s,l;o===null?s=l=null:[s,l]=o,s!==null&&EE(r,e,n,s,i,l),i&&j3(n,t,i)}n.mergedAttrs=la(n.mergedAttrs,n.attrs)}function EE(r,e,n,t,i,o){for(let a=0;a<t.length;a++)om(jd(n,e),r,t[a].type);$3(n,r.data.length,t.length);for(let a=0;a<t.length;a++){let u=t[a];u.providersResolver&&u.providersResolver(u)}let s=!1,l=!1,c=_E(r,e,t.length,null);for(let a=0;a<t.length;a++){let u=t[a];n.mergedAttrs=la(n.mergedAttrs,u.hostAttrs),U3(r,n,e,c,u),V3(c,u,i),u.contentQueries!==null&&(n.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(n.flags|=64);let d=u.type.prototype;!s&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((r.preOrderHooks??=[]).push(n.index),s=!0),!l&&(d.ngOnChanges||d.ngDoCheck)&&((r.preOrderCheckHooks??=[]).push(n.index),l=!0),c++}P3(r,n,o)}function R3(r,e,n,t,i){let o=i.hostBindings;if(o){let s=r.hostBindingOpCodes;s===null&&(s=r.hostBindingOpCodes=[]);let l=~e.index;k3(s)!=l&&s.push(l),s.push(n,t,o)}}function k3(r){let e=r.length;for(;e>0;){let n=r[--e];if(typeof n=="number"&&n<0)return n}return 0}function F3(r,e,n,t){let i=n.directiveStart,o=n.directiveEnd;ih(n)&&H3(e,n,r.data[i+n.componentOffset]),r.firstCreatePass||jd(n,e),Mi(t,e);let s=n.initialInputs;for(let l=i;l<o;l++){let c=r.data[l],a=ca(e,r,l,n);if(Mi(a,e),s!==null&&W3(e,l-i,a,c,n,s),Pi(c)){let u=Fi(n.index,e);u[dr]=ca(e,r,l,n)}}}function DE(r,e,n){let t=n.directiveStart,i=n.directiveEnd,o=n.index,s=aB();try{Mo(o);for(let l=t;l<i;l++){let c=r.data[l],a=e[l];nm(l),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&L3(c,a)}}finally{Mo(-1),nm(s)}}function L3(r,e){r.hostBindings!==null&&r.hostBindings(1,e)}function B3(r,e){let n=r.directiveRegistry,t=null,i=null;if(n)for(let o=0;o<n.length;o++){let s=n[o];if(g3(e,s.selectors,!1))if(t||(t=[]),Pi(s))if(s.findHostDirectiveDefs!==null){let l=[];i=i||new Map,s.findHostDirectiveDefs(s,l,i),t.unshift(...l,s);let c=l.length;gm(r,e,c)}else t.unshift(s),gm(r,e,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,t,i),t.push(s)}return t===null?null:[t,i]}function gm(r,e,n){e.componentOffset=n,(r.components??=[]).push(e.index)}function j3(r,e,n){if(e){let t=r.localNames=[];for(let i=0;i<e.length;i+=2){let o=n[e[i+1]];if(o==null)throw new X(-301,!1);t.push(e[i],o)}}}function V3(r,e,n){if(n){if(e.exportAs)for(let t=0;t<e.exportAs.length;t++)n[e.exportAs[t]]=r;Pi(e)&&(n[""]=r)}}function $3(r,e,n){r.flags|=1,r.directiveStart=e,r.directiveEnd=e+n,r.providerIndexes=e}function U3(r,e,n,t,i){r.data[t]=i;let o=i.factory||(i.factory=Oo(i.type,!0)),s=new No(o,Pi(i),se);r.blueprint[t]=s,n[t]=s,R3(r,e,t,_E(r,n,i.hostVars,jo),i)}function CE(r){let e=16;return r.signals?e=4096:r.onPush&&(e=64),e}function H3(r,e,n){let t=Gn(e,r),i=xE(n),o=r[Jr].rendererFactory,s=yh(r,mh(r,i,null,CE(n),t,e,null,o.createRenderer(t,n),null,null,null));r[e.index]=s}function z3(r,e,n,t,i,o){let s=Gn(r,e);G3(e[wt],s,o,r.value,n,t,i)}function G3(r,e,n,t,i,o,s){if(o==null)r.removeAttribute(e,i,n);else{let l=s==null?eh(o):s(o,t||"",i);r.setAttribute(e,i,l,n)}}function W3(r,e,n,t,i,o){let s=o[e];if(s!==null)for(let l=0;l<s.length;){let c=s[l++],a=s[l++],u=s[l++],d=s[l++];yE(t,n,c,a,u,d)}}function q3(r,e,n){let t=null,i=0;for(;i<n.length;){let o=n[i];if(o===0){i+=4;continue}else if(o===5){i+=2;continue}if(typeof o=="number")break;if(r.hasOwnProperty(o)){t===null&&(t=[]);let s=r[o];for(let l=0;l<s.length;l+=3)if(s[l]===e){t.push(o,s[l+1],s[l+2],n[i+1]);break}}i+=2}return t}function IE(r,e,n,t){return[r,!0,0,e,null,t,null,n,null,null]}function yh(r,e){return r[$l]?r[sx][ur]=e:r[$l]=e,r[sx]=e,e}function OE(r,e){let n=r[ia],t=n?n.get(Qr,null):null;t&&t.handleError(e)}function dy(r,e,n,t,i){for(let o=0;o<n.length;){let s=n[o++],l=n[o++],c=n[o++],a=e[s],u=r.data[s];yE(u,a,t,l,c,i)}}function Y3(r,e){let n=Fi(e,r),t=n[xe];X3(t,n);let i=n[ri];i!==null&&n[Pd]===null&&(n[Pd]=ny(i,n[ia])),hy(t,n,n[dr])}function X3(r,e){for(let n=e.length;n<r.blueprint.length;n++)e.push(r.blueprint[n])}function hy(r,e,n){Hm(e);try{let t=r.viewQuery;t!==null&&pm(1,t,n);let i=r.template;i!==null&&TE(r,e,i,1,n),r.firstCreatePass&&(r.firstCreatePass=!1),e[sa]?.finishViewCreation(r),r.staticContentQueries&&lE(r,e),r.staticViewQueries&&pm(2,r.viewQuery,n);let o=r.components;o!==null&&K3(e,o)}catch(t){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),t}finally{e[ae]&=-5,zm()}}function K3(r,e){for(let n=0;n<e.length;n++)Y3(r,e[n])}var ei=function(r){return r[r.Important=1]="Important",r[r.DashCase=2]="DashCase",r}(ei||{}),Z3;function fy(r,e){return Z3(r,e)}function Js(r,e,n,t,i){if(t!=null){let o,s=!1;ii(t)?o=t:Oi(t)&&(s=!0,t=t[ri]);let l=Pr(t);r===0&&n!==null?i==null?bE(e,n,l):Hd(e,n,l,i||null,!0):r===1&&n!==null?Hd(e,n,l,i||null,!0):r===2?S3(e,l,s):r===3&&e.destroyNode(l),o!=null&&uj(e,r,o,n,i)}}function J3(r,e){AE(r,e),e[ri]=null,e[hr]=null}function Q3(r,e,n,t,i,o){t[ri]=i,t[hr]=e,bh(r,t,n,1,i,o)}function AE(r,e){e[Jr].changeDetectionScheduler?.notify(10),bh(r,e,e[wt],2,null,null)}function ej(r){let e=r[$l];if(!e)return jg(r[xe],r);for(;e;){let n=null;if(Oi(e))n=e[$l];else{let t=e[zn];t&&(n=t)}if(!n){for(;e&&!e[ur]&&e!==r;)Oi(e)&&jg(e[xe],e),e=e[sn];e===null&&(e=r),Oi(e)&&jg(e[xe],e),n=e&&e[ur]}e=n}}function tj(r,e,n,t){let i=zn+t,o=n.length;t>0&&(n[i-1][ur]=e),t<o-zn?(e[ur]=n[i],Qx(n,zn+t,e)):(n.push(e),e[ur]=null),e[sn]=n;let s=e[oa];s!==null&&n!==s&&PE(s,e);let l=e[sa];l!==null&&l.insertView(r),em(e),e[ae]|=128}function PE(r,e){let n=r[kd],t=e[sn];if(Oi(t))r[ae]|=2;else{let i=t[sn][Ar];e[Ar]!==i&&(r[ae]|=2)}n===null?r[kd]=[e]:n.push(e)}function py(r,e){let n=r[kd],t=n.indexOf(e);n.splice(t,1)}function mm(r,e){if(r.length<=zn)return;let n=zn+e,t=r[n];if(t){let i=t[oa];i!==null&&i!==r&&py(i,t),e>0&&(r[n-1][ur]=t[ur]);let o=Od(r,zn+e);J3(t[xe],t);let s=o[sa];s!==null&&s.detachView(o[xe]),t[sn]=null,t[ur]=null,t[ae]&=-129}return t}function ME(r,e){if(Wl(e))return;let n=e[wt];n.destroyNode&&bh(r,e,n,3,null,null),ej(e)}function jg(r,e){if(Wl(e))return;let n=De(null);try{e[ae]&=-129,e[ae]|=256,e[Dn]&&pg(e[Dn]),rj(r,e),nj(r,e),e[xe].type===1&&e[wt].destroy();let t=e[oa];if(t!==null&&ii(e[sn])){t!==e[sn]&&py(t,e);let i=e[sa];i!==null&&i.detachView(r)}dm(e)}finally{De(n)}}function nj(r,e){let n=r.cleanup,t=e[Md];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let l=n[s+3];l>=0?t[l]():t[-l].unsubscribe(),s+=2}else{let l=t[n[s+1]];n[s].call(l)}t!==null&&(e[Md]=null);let i=e[Ii];if(i!==null){e[Ii]=null;for(let s=0;s<i.length;s++){let l=i[s];l()}}let o=e[Nd];if(o!==null){e[Nd]=null;for(let s of o)s.destroy()}}function rj(r,e){let n;if(r!=null&&(n=r.destroyHooks)!=null)for(let t=0;t<n.length;t+=2){let i=e[n[t]];if(!(i instanceof No)){let o=n[t+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let l=i[o[s]],c=o[s+1];Hn(4,l,c);try{c.call(l)}finally{Hn(5,l,c)}}else{Hn(4,i,o);try{o.call(i)}finally{Hn(5,i,o)}}}}}function ij(r,e,n){return oj(r,e.parent,n)}function oj(r,e,n){let t=e;for(;t!==null&&t.type&168;)e=t,t=e.parent;if(t===null)return n[ri];{let{componentOffset:i}=t;if(i>-1){let{encapsulation:o}=r.data[t.directiveStart+i];if(o===Mr.None||o===Mr.Emulated)return null}return Gn(t,n)}}function sj(r,e,n){return lj(r,e,n)}function aj(r,e,n){return r.type&40?Gn(r,n):null}var lj=aj,Ex;function vh(r,e,n,t){let i=ij(r,t,e),o=e[wt],s=t.parent||e[hr],l=sj(s,t,e);if(i!=null)if(Array.isArray(n))for(let c=0;c<n.length;c++)Tx(o,i,n[c],l,!1);else Tx(o,i,n,l,!1);Ex!==void 0&&Ex(o,t,e,n,i)}function Ll(r,e){if(e!==null){let n=e.type;if(n&3)return Gn(e,r);if(n&4)return ym(-1,r[e.index]);if(n&8){let t=e.child;if(t!==null)return Ll(r,t);{let i=r[e.index];return ii(i)?ym(-1,i):Pr(i)}}else{if(n&128)return Ll(r,e.next);if(n&32)return fy(e,r)()||Pr(r[e.index]);{let t=NE(r,e);if(t!==null){if(Array.isArray(t))return t[0];let i=Po(r[Ar]);return Ll(i,t)}else return Ll(r,e.next)}}}return null}function NE(r,e){if(e!==null){let t=r[Ar][hr],i=e.projection;return t.projection[i]}return null}function ym(r,e){let n=zn+r+1;if(n<e.length){let t=e[n],i=t[xe].firstChild;if(i!==null)return Ll(t,i)}return e[Ao]}function gy(r,e,n,t,i,o,s){for(;n!=null;){if(n.type===128){n=n.next;continue}let l=t[n.index],c=n.type;if(s&&e===0&&(l&&Mi(Pr(l),t),n.flags|=2),(n.flags&32)!==32)if(c&8)gy(r,e,n.child,t,i,o,!1),Js(e,r,i,l,o);else if(c&32){let a=fy(n,t),u;for(;u=a();)Js(e,r,i,u,o);Js(e,r,i,l,o)}else c&16?cj(r,e,t,n,i,o):Js(e,r,i,l,o);n=s?n.projectionNext:n.next}}function bh(r,e,n,t,i,o){gy(n,t,r.firstChild,e,i,o,!1)}function cj(r,e,n,t,i,o){let s=n[Ar],c=s[hr].projection[t.projection];if(Array.isArray(c))for(let a=0;a<c.length;a++){let u=c[a];Js(e,r,i,u,o)}else{let a=c,u=s[sn];QS(t)&&(a.flags|=128),gy(r,e,a,u,i,o,!0)}}function uj(r,e,n,t,i){let o=n[Ao],s=Pr(n);o!==s&&Js(e,r,t,o,i);for(let l=zn;l<n.length;l++){let c=n[l];bh(c[xe],c,r,e,t,o)}}function dj(r,e,n,t,i){if(e)i?r.addClass(n,t):r.removeClass(n,t);else{let o=t.indexOf("-")===-1?void 0:ei.DashCase;i==null?r.removeStyle(n,t,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=ei.Important),r.setStyle(n,t,i,o))}}function hj(r,e,n,t){let i=De(null);try{let o=e.tView,l=r[ae]&4096?4096:16,c=mh(r,o,n,l,null,e,null,null,t?.injector??null,t?.embeddedViewInjector??null,t?.dehydratedView??null),a=r[e.index];c[oa]=a;let u=r[sa];return u!==null&&(c[sa]=u.createEmbeddedView(o)),hy(o,c,n),c}finally{De(i)}}function Dx(r,e){return!e||e.firstChild===null||QS(r)}function fj(r,e,n,t=!0){let i=e[xe];if(tj(i,e,r,n),t){let s=ym(n,r),l=e[wt],c=l.parentNode(r[Ao]);c!==null&&Q3(i,r[hr],l,e,c,s)}let o=e[Pd];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function zd(r,e,n,t,i=!1){for(;n!==null;){if(n.type===128){n=i?n.projectionNext:n.next;continue}let o=e[n.index];o!==null&&t.push(Pr(o)),ii(o)&&pj(o,t);let s=n.type;if(s&8)zd(r,e,n.child,t);else if(s&32){let l=fy(n,e),c;for(;c=l();)t.push(c)}else if(s&16){let l=NE(e,n);if(Array.isArray(l))t.push(...l);else{let c=Po(e[Ar]);zd(c[xe],c,l,t,!0)}}n=i?n.projectionNext:n.next}return t}function pj(r,e){for(let n=zn;n<r.length;n++){let t=r[n],i=t[xe].firstChild;i!==null&&zd(t[xe],t,i,e)}r[Ao]!==r[ri]&&e.push(r[Ao])}var RE=[];function gj(r){return r[Dn]??mj(r)}function mj(r){let e=RE.pop()??Object.create(vj);return e.lView=r,e}function yj(r){r.lView[Dn]!==r&&(r.lView=null,RE.push(r))}var vj=k(C({},Pl),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:r=>{ah(r.lView)},consumerOnSignalRead(){this.lView[Dn]=this}});function bj(r){let e=r[Dn]??Object.create(wj);return e.lView=r,e}var wj=k(C({},Pl),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:r=>{let e=Po(r.lView);for(;e&&!kE(e[xe]);)e=Po(e);e&&$m(e)},consumerOnSignalRead(){this.lView[Dn]=this}});function kE(r){return r.type!==2}function FE(r){if(r[Nd]===null)return;let e=!0;for(;e;){let n=!1;for(let t of r[Nd])t.dirty&&(n=!0,t.zone===null||Zone.current===t.zone?t.run():t.zone.run(()=>t.run()));e=n&&!!(r[ae]&8192)}}var _j=100;function LE(r,e=!0,n=0){let i=r[Jr].rendererFactory,o=!1;o||i.begin?.();try{Tj(r,n)}catch(s){throw e&&OE(r,s),s}finally{o||i.end?.()}}function Tj(r,e){let n=ES();try{lx(!0),vm(r,e);let t=0;for(;sh(r);){if(t===_j)throw new X(103,!1);t++,vm(r,1)}}finally{lx(n)}}function xj(r,e,n,t){if(Wl(e))return;let i=e[ae],o=!1,s=!1;Hm(e);let l=!0,c=null,a=null;o||(kE(r)?(a=gj(e),c=Uu(a)):yT()===null?(l=!1,a=bj(e),c=Uu(a)):e[Dn]&&(pg(e[Dn]),e[Dn]=null));try{wS(e),rB(r.bindingStartIndex),n!==null&&TE(r,e,n,2,t);let u=(i&3)===3;if(!o)if(u){let f=r.preOrderCheckHooks;f!==null&&xd(e,f,null)}else{let f=r.preOrderHooks;f!==null&&Sd(e,f,0,null),Fg(e,0)}if(s||Sj(e),FE(e),BE(e,0),r.contentQueries!==null&&lE(r,e),!o)if(u){let f=r.contentCheckHooks;f!==null&&xd(e,f)}else{let f=r.contentHooks;f!==null&&Sd(e,f,1),Fg(e,1)}Dj(r,e);let d=r.components;d!==null&&VE(e,d,0);let h=r.viewQuery;if(h!==null&&pm(2,h,t),!o)if(u){let f=r.viewCheckHooks;f!==null&&xd(e,f)}else{let f=r.viewHooks;f!==null&&Sd(e,f,2),Fg(e,2)}if(r.firstUpdatePass===!0&&(r.firstUpdatePass=!1),e[kg]){for(let f of e[kg])f();e[kg]=null}o||(e[ae]&=-73)}catch(u){throw o||ah(e),u}finally{a!==null&&(hg(a,c),l&&yj(a)),zm()}}function BE(r,e){for(let n=nE(r);n!==null;n=rE(n))for(let t=zn;t<n.length;t++){let i=n[t];jE(i,e)}}function Sj(r){for(let e=nE(r);e!==null;e=rE(e)){if(!(e[ae]&2))continue;let n=e[kd];for(let t=0;t<n.length;t++){let i=n[t];$m(i)}}}function Ej(r,e,n){let t=Fi(e,r);jE(t,n)}function jE(r,e){Vm(r)&&vm(r,e)}function vm(r,e){let t=r[xe],i=r[ae],o=r[Dn],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&fg(o)),s||=!1,o&&(o.dirty=!1),r[ae]&=-9217,s)xj(t,r,t.template,r[dr]);else if(i&8192){FE(r),BE(r,1);let l=t.components;l!==null&&VE(r,l,1)}}function VE(r,e,n){for(let t=0;t<e.length;t++)Ej(r,e[t],n)}function Dj(r,e){let n=r.hostBindingOpCodes;if(n!==null)try{for(let t=0;t<n.length;t++){let i=n[t];if(i<0)Mo(~i);else{let o=i,s=n[++t],l=n[++t];sB(s,o);let c=e[o];Hn(24,c),l(2,c),Hn(25,c)}}}finally{Mo(-1)}}function my(r,e){let n=ES()?64:1088;for(r[Jr].changeDetectionScheduler?.notify(e);r;){r[ae]|=n;let t=Po(r);if(Jg(r)&&!t)return r;r=t}return null}var Ro=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let e=this._lView,n=e[xe];return zd(n,e,n.firstChild,[])}constructor(e,n,t=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=t}get context(){return this._lView[dr]}get dirty(){return!!(this._lView[ae]&9280)||!!this._lView[Dn]?.dirty}set context(e){this._lView[dr]=e}get destroyed(){return Wl(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[sn];if(ii(e)){let n=e[Rd],t=n?n.indexOf(this):-1;t>-1&&(mm(e,t),Od(n,t))}this._attachedToViewContainer=!1}ME(this._lView[xe],this._lView)}onDestroy(e){_S(this._lView,e)}markForCheck(){my(this._cdRefInjectingView||this._lView,4)}markForRefresh(){$m(this._cdRefInjectingView||this._lView)}detach(){this._lView[ae]&=-129}reattach(){em(this._lView),this._lView[ae]|=128}detectChanges(){this._lView[ae]|=1024,LE(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new X(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Jg(this._lView),n=this._lView[oa];n!==null&&!e&&py(n,this._lView),AE(this._lView[xe],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new X(902,!1);this._appRef=e;let n=Jg(this._lView),t=this._lView[oa];t!==null&&!n&&PE(t,this._lView),em(this._lView)}},wh=(()=>{class r{static __NG_ELEMENT_ID__=Oj}return r})(),Cj=wh,Ij=class extends Cj{_declarationLView;_declarationTContainer;elementRef;constructor(e,n,t){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=t}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,t){let i=hj(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:n,dehydratedView:t});return new Ro(i)}};function Oj(){return Aj(Yt(),je())}function Aj(r,e){return r.type&4?new Ij(e,r,fh(r,e)):null}function Yl(r,e,n,t,i){let o=r.data[e];if(o===null)o=Pj(r,e,n,t,i),oB()&&(o.flags|=32);else if(o.type&64){o.type=n,o.value=t,o.attrs=i;let s=tB();o.injectorIndex=s===null?-1:s.injectorIndex}return Lo(o,!0),o}function Pj(r,e,n,t,i){let o=xS(),s=Um(),l=s?o:o&&o.parent,c=r.data[e]=Nj(r,l,n,e,t,i);return Mj(r,c,o,s),c}function Mj(r,e,n,t){r.firstChild===null&&(r.firstChild=e),n!==null&&(t?n.child==null&&e.parent!==null&&(n.child=e):n.next===null&&(n.next=e,e.prev=n))}function Nj(r,e,n,t,i,o){let s=e?e.injectorIndex:-1,l=0;return JL()&&(l|=128),{type:n,index:t,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:l,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var UJ=new RegExp(`^(\\d+)*(${YB}|${qB})*(.*)`);var Rj=()=>null;function Cx(r,e){return Rj(r,e)}var bm=class{},Gd=class{},wm=class{resolveComponentFactory(e){throw Error(`No component factory found for ${rn(e)}.`)}},da=class{static NULL=new wm},ha=class{},Vi=(()=>{class r{destroyNode=null;static __NG_ELEMENT_ID__=()=>kj()}return r})();function kj(){let r=je(),e=Yt(),n=Fi(e.index,r);return(Oi(n)?n:r)[wt]}var Fj=(()=>{class r{static \u0275prov=W({token:r,providedIn:"root",factory:()=>null})}return r})();function Wd(r,e,n){let t=n?r.styles:null,i=n?r.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let l=e[s];if(typeof l=="number")o=l;else if(o==1)i=ex(i,l);else if(o==2){let c=l,a=e[++s];t=ex(t,c+": "+a+";")}}n?r.styles=t:r.stylesWithoutHost=t,n?r.classes=i:r.classesWithoutHost=i}var qd=class extends da{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=Ai(e);return new fa(n,this.ngModule)}};function Ix(r,e){let n=[];for(let t in r){if(!r.hasOwnProperty(t))continue;let i=r[t];if(i===void 0)continue;let o=Array.isArray(i),s=o?i[0]:i,l=o?i[1]:Ni.None;e?n.push({propName:s,templateName:t,isSignal:(l&Ni.SignalBased)!==0}):n.push({propName:s,templateName:t})}return n}function Lj(r){let e=r.toLowerCase();return e==="svg"?UL:e==="math"?HL:null}function Bj(r){let{attrs:e,classes:n}=w3(r),t=e;return n.length&&t.push(1,...n),t}var fa=class extends Gd{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;get inputs(){let e=this.componentDef,n=e.inputTransforms,t=Ix(e.inputs,!0);if(n!==null)for(let i of t)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return t}get outputs(){return Ix(this.componentDef.outputs,!1)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=b3(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,t,i){let o=De(null);try{i=i||this.ngModule;let s=i instanceof on?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let l=s?new rm(e,s):e,c=l.get(ha,null);if(c===null)throw new X(407,!1);let a=l.get(Fj,null),u=l.get(ua,null),d={rendererFactory:c,sanitizer:a,changeDetectionScheduler:u},h=c.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",p=t?I3(h,t,this.componentDef.encapsulation,l):vE(h,f,Lj(f)),g=512;this.componentDef.signals?g|=4096:this.componentDef.onPush||(g|=16);let y=null;p!==null&&(y=ny(p,l,!0));let w=cy(0,null,null,1,0,null,null,null,null,null,null),v=mh(null,w,null,g,null,null,d,h,l,null,y);v[Cn]=p,Hm(v);let x,A=null;try{let H=this.componentDef,q,$=null;H.findHostDirectiveDefs?(q=[],$=new Map,H.findHostDirectiveDefs(H,q,$),q.push(H)):q=[H];let we=t?["ng-version","19.1.3"]:Bj(this.componentDef.selectors[0]),ne=Yl(w,Cn,2,"#host",we);for(let He of q)ne.mergedAttrs=la(ne.mergedAttrs,He.hostAttrs);ne.mergedAttrs=la(ne.mergedAttrs,we),Wd(ne,ne.mergedAttrs,!0),p&&wE(h,p,ne),A=jj(ne,p,H,q,v,d),n!==void 0&&$j(ne,this.ngContentSelectors,n),x=Vj(A,H,q,$,v,[Uj]),hy(w,v,null)}catch(H){throw A!==null&&dm(A),dm(v),H}finally{zm()}let L=vS(w,Cn);return new _m(this.componentType,x,fh(L,v),v,L)}finally{De(o)}}},_m=class extends bm{location;_rootLView;_tNode;instance;hostView;changeDetectorRef;componentType;previousInputValues=null;constructor(e,n,t,i,o){super(),this.location=t,this._rootLView=i,this._tNode=o,this.instance=n,this.hostView=this.changeDetectorRef=new Ro(i,void 0,!1),this.componentType=e}setInput(e,n){let t=this._tNode.inputs,i;if(t!==null&&(i=t[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let o=this._rootLView;dy(o[xe],o,i,e,n),this.previousInputValues.set(e,n);let s=Fi(this._tNode.index,o);my(s,1)}}get injector(){return new Io(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function jj(r,e,n,t,i,o){let s=i[xe],l=null;e!==null&&(l=ny(e,i[ia]));let c=o.rendererFactory.createRenderer(e,n),a=mh(i,xE(n),null,CE(n),i[r.index],r,o,c,null,null,l);return s.firstCreatePass&&gm(s,r,t.length-1),yh(i,a),i[r.index]=a}function Vj(r,e,n,t,i,o){let s=Yt(),l=i[xe],c=Gn(s,i);EE(l,i,s,n,null,t);for(let u=0;u<n.length;u++){let d=s.directiveStart+u,h=ca(i,l,d,s);Mi(h,i)}DE(l,i,s),c&&Mi(c,i);let a=ca(i,l,s.directiveStart+s.componentOffset,s);if(r[dr]=i[dr]=a,o!==null)for(let u of o)u(a,e);return ry(l,s,i),a}function $j(r,e,n){let t=r.projection=[];for(let i=0;i<e.length;i++){let o=n[i];t.push(o!=null&&o.length?Array.from(o):null)}}function Uj(){let r=Yt();dh(je()[xe],r)}var ba=(()=>{class r{static __NG_ELEMENT_ID__=Hj}return r})();function Hj(){let r=Yt();return Gj(r,je())}var zj=ba,$E=class extends zj{_lContainer;_hostTNode;_hostLView;constructor(e,n,t){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=t}get element(){return fh(this._hostTNode,this._hostLView)}get injector(){return new Io(this._hostTNode,this._hostLView)}get parentInjector(){let e=Wm(this._hostTNode,this._hostLView);if(FS(e)){let n=Ld(e,this._hostLView),t=Fd(e),i=n[xe].data[t+8];return new Io(i,n)}else return new Io(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=Ox(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-zn}createEmbeddedView(e,n,t){let i,o;typeof t=="number"?i=t:t!=null&&(i=t.index,o=t.injector);let s=Cx(this._lContainer,e.ssrId),l=e.createEmbeddedViewImpl(n||{},o,s);return this.insertImpl(l,i,Dx(this._hostTNode,s)),l}createComponent(e,n,t,i,o){let s=e&&!BL(e),l;if(s)l=n;else{let p=n||{};l=p.index,t=p.injector,i=p.projectableNodes,o=p.environmentInjector||p.ngModuleRef}let c=s?e:new fa(Ai(e)),a=t||this.parentInjector;if(!o&&c.ngModule==null){let g=(s?a:this.parentInjector).get(on,null);g&&(o=g)}let u=Ai(c.componentType??{}),d=Cx(this._lContainer,u?.id??null),h=d?.firstChild??null,f=c.create(a,i,h,o);return this.insertImpl(f.hostView,l,Dx(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,t){let i=e._lView;if(zL(i)){let l=this.indexOf(e);if(l!==-1)this.detach(l);else{let c=i[sn],a=new $E(c,c[hr],c[sn]);a.detach(a.indexOf(e))}}let o=this._adjustIndex(n),s=this._lContainer;return fj(s,i,o,t),e.attachToViewContainerRef(),Qx(Vg(s),o,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=Ox(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),t=mm(this._lContainer,n);t&&(Od(Vg(this._lContainer),n),ME(t[xe],t))}detach(e){let n=this._adjustIndex(e,-1),t=mm(this._lContainer,n);return t&&Od(Vg(this._lContainer),n)!=null?new Ro(t):null}_adjustIndex(e,n=0){return e??this.length+n}};function Ox(r){return r[Rd]}function Vg(r){return r[Rd]||(r[Rd]=[])}function Gj(r,e){let n,t=e[r.index];return ii(t)?n=t:(n=IE(t,e,null,r),e[r.index]=n,yh(e,n)),qj(n,e,r,t),new $E(n,r,e)}function Wj(r,e){let n=r[wt],t=n.createComment(""),i=Gn(e,r),o=n.parentNode(i);return Hd(n,o,t,n.nextSibling(i),!1),t}var qj=Kj,Yj=()=>!1;function Xj(r,e,n){return Yj(r,e,n)}function Kj(r,e,n,t){if(r[Ao])return;let i;n.type&8?i=Pr(t):i=Wj(e,n),r[Ao]=i}var Ri=class{},Ul=class{};var Tm=class extends Ri{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new qd(this);constructor(e,n,t,i=!0){super(),this.ngModuleType=e,this._parent=n;let o=nS(e);this._bootstrapComponents=fE(o.bootstrap),this._r3Injector=GS(e,n,[{provide:Ri,useValue:this},{provide:da,useValue:this.componentFactoryResolver},...t],rn(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},xm=class extends Ul{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new Tm(this.moduleType,e,[])}};var Yd=class extends Ri{injector;componentFactoryResolver=new qd(this);instance=null;constructor(e){super();let n=new Vl([...e.providers,{provide:Ri,useValue:this},{provide:da,useValue:this.componentFactoryResolver}],e.parent||Bm(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function _h(r,e,n=null){return new Yd({providers:r,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var Zj=(()=>{class r{_injector;cachedInjectors=new Map;constructor(n){this._injector=n}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){let t=sS(!1,n.type),i=t.length>0?_h([t],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,i)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(let n of this.cachedInjectors.values())n!==null&&n.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=W({token:r,providedIn:"environment",factory:()=>new r(J(on))})}return r})();function Nr(r){return zl(()=>{let e=HE(r),n=k(C({},e),{decls:r.decls,vars:r.vars,template:r.template,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,onPush:r.changeDetection===eE.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&r.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(Zj).getOrCreateStandaloneInjector(n):null,getExternalStyles:null,signals:r.signals??!1,data:r.data||{},encapsulation:r.encapsulation||Mr.Emulated,styles:r.styles||Un,_:null,schemas:r.schemas||null,tView:null,id:""});e.standalone&&Bo("NgStandalone"),zE(n);let t=r.dependencies;return n.directiveDefs=Px(t,!1),n.pipeDefs=Px(t,!0),n.id=eV(n),n})}function Jj(r){return Ai(r)||rS(r)}function Qj(r){return r!==null}function si(r){return zl(()=>({type:r.type,bootstrap:r.bootstrap||Un,declarations:r.declarations||Un,imports:r.imports||Un,exports:r.exports||Un,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null}))}function Ax(r,e){if(r==null)return ta;let n={};for(let t in r)if(r.hasOwnProperty(t)){let i=r[t],o,s,l=Ni.None;Array.isArray(i)?(l=i[0],o=i[1],s=i[2]??o):(o=i,s=i),e?(n[o]=l!==Ni.None?[t,l]:t,e[o]=s):n[o]=t}return n}function Ut(r){return zl(()=>{let e=HE(r);return zE(e),e})}function UE(r){return{type:r.type,name:r.name,factory:null,pure:r.pure!==!1,standalone:r.standalone??!0,onDestroy:r.type.prototype.ngOnDestroy||null}}function HE(r){let e={};return{type:r.type,providersResolver:null,factory:null,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:r.inputs||ta,exportAs:r.exportAs||null,standalone:r.standalone??!0,signals:r.signals===!0,selectors:r.selectors||Un,viewQuery:r.viewQuery||null,features:r.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Ax(r.inputs,e),outputs:Ax(r.outputs),debugInfo:null}}function zE(r){r.features?.forEach(e=>e(r))}function Px(r,e){if(!r)return null;let n=e?iS:Jj;return()=>(typeof r=="function"?r():r).map(t=>n(t)).filter(Qj)}function eV(r){let e=0,n=typeof r.consts=="function"?"":r.consts,t=[r.selectors,r.ngContentSelectors,r.hostVars,r.hostAttrs,n,r.vars,r.decls,r.encapsulation,r.standalone,r.signals,r.exportAs,JSON.stringify(r.inputs),JSON.stringify(r.outputs),Object.getOwnPropertyNames(r.type.prototype),!!r.contentQueries,!!r.viewQuery];for(let o of t.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function tV(r){return Object.getPrototypeOf(r.prototype).constructor}function ai(r){let e=tV(r.type),n=!0,t=[r];for(;e;){let i;if(Pi(r))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new X(903,!1);i=e.\u0275dir}if(i){if(n){t.push(i);let s=r;s.inputs=wd(r.inputs),s.inputTransforms=wd(r.inputTransforms),s.declaredInputs=wd(r.declaredInputs),s.outputs=wd(r.outputs);let l=i.hostBindings;l&&sV(r,l);let c=i.viewQuery,a=i.contentQueries;if(c&&iV(r,c),a&&oV(r,a),nV(r,i),rL(r.outputs,i.outputs),Pi(i)&&i.data.animation){let u=r.data;u.animation=(u.animation||[]).concat(i.data.animation)}}let o=i.features;if(o)for(let s=0;s<o.length;s++){let l=o[s];l&&l.ngInherit&&l(r),l===ai&&(n=!1)}}e=Object.getPrototypeOf(e)}rV(t)}function nV(r,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||r.inputs.hasOwnProperty(n))continue;let t=e.inputs[n];if(t!==void 0&&(r.inputs[n]=t,r.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(t)?t[0]:t;if(!e.inputTransforms.hasOwnProperty(i))continue;r.inputTransforms??={},r.inputTransforms[i]=e.inputTransforms[i]}}}function rV(r){let e=0,n=null;for(let t=r.length-1;t>=0;t--){let i=r[t];i.hostVars=e+=i.hostVars,i.hostAttrs=la(i.hostAttrs,n=la(n,i.hostAttrs))}}function wd(r){return r===ta?{}:r===Un?[]:r}function iV(r,e){let n=r.viewQuery;n?r.viewQuery=(t,i)=>{e(t,i),n(t,i)}:r.viewQuery=e}function oV(r,e){let n=r.contentQueries;n?r.contentQueries=(t,i,o)=>{e(t,i,o),n(t,i,o)}:r.contentQueries=e}function sV(r,e){let n=r.hostBindings;n?r.hostBindings=(t,i)=>{e(t,i),n(t,i)}:r.hostBindings=e}function yy(r){let e=r.inputConfig,n={};for(let t in e)if(e.hasOwnProperty(t)){let i=e[t];Array.isArray(i)&&i[3]&&(n[t]=i[3])}r.inputTransforms=n}function GE(r){return lV(r)?Array.isArray(r)||!(r instanceof Map)&&Symbol.iterator in r:!1}function aV(r,e){if(Array.isArray(r))for(let n=0;n<r.length;n++)e(r[n]);else{let n=r[Symbol.iterator](),t;for(;!(t=n.next()).done;)e(t.value)}}function lV(r){return r!==null&&(typeof r=="function"||typeof r=="object")}function cV(r,e,n){return r[e]=n}function wa(r,e,n){let t=r[e];return Object.is(t,n)?!1:(r[e]=n,!0)}function uV(r){return(r.flags&32)===32}function dV(r,e,n,t,i,o,s,l,c){let a=e.consts,u=Yl(e,r,4,s||null,l||null);uy(e,n,u,aa(a,c)),dh(e,u);let d=u.tView=cy(2,u,t,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,a,null);return e.queries!==null&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}function hV(r,e,n,t,i,o,s,l,c,a){let u=n+Cn,d=e.firstCreatePass?dV(u,e,r,t,i,o,s,l,c):e.data[u];Lo(d,!1);let h=fV(e,r,d,n);ch()&&vh(e,r,h,d),Mi(h,r);let f=IE(h,r,h,d);return r[u]=f,yh(r,f),Xj(f,d,r),oh(d)&&ay(e,r,d),c!=null&&ly(r,d,a),d}function Ke(r,e,n,t,i,o,s,l){let c=je(),a=qt(),u=aa(a.consts,o);return hV(c,a,r,e,n,t,i,u,s,l),Ke}var fV=pV;function pV(r,e,n,t){return uh(!0),e[wt].createComment("")}var vy=(()=>{class r{log(n){console.log(n)}warn(n){console.warn(n)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"platform"})}return r})();var WE=new Y("");function $i(r){return!!r&&typeof r.then=="function"}function by(r){return!!r&&typeof r.subscribe=="function"}var Th=new Y("");var qE=(()=>{class r{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((n,t)=>{this.resolve=n,this.reject=t});appInits=V(Th,{optional:!0})??[];injector=V(In);constructor(){}runInitializers(){if(this.initialized)return;let n=[];for(let i of this.appInits){let o=yn(this.injector,i);if($i(o))n.push(o);else if(by(o)){let s=new Promise((l,c)=>{o.subscribe({complete:l,error:c})});n.push(s)}}let t=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{t()}).catch(i=>{this.reject(i)}),n.length===0&&t(),this.initialized=!0}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),gV=(()=>{class r{static \u0275prov=W({token:r,providedIn:"root",factory:()=>new Sm})}return r})(),Sm=class{queuedEffectCount=0;queues=new Map;schedule(e){this.enqueue(e)}remove(e){let n=e.zone,t=this.queues.get(n);t.has(e)&&(t.delete(e),this.queuedEffectCount--)}enqueue(e){let n=e.zone;this.queues.has(n)||this.queues.set(n,new Set);let t=this.queues.get(n);t.has(e)||(this.queuedEffectCount++,t.add(e))}flush(){for(;this.queuedEffectCount>0;)for(let[e,n]of this.queues)e===null?this.flushQueue(n):e.run(()=>this.flushQueue(n))}flushQueue(e){for(let n of e)e.delete(n),this.queuedEffectCount--,n.run()}},Xl=new Y("");function mV(){DT(()=>{throw new X(600,!1)})}function yV(r){return r.isBoundToModule}var vV=10;function bV(r,e,n){try{let t=n();return $i(t)?t.catch(i=>{throw e.runOutsideAngular(()=>r.handleError(i)),i}):t}catch(t){throw e.runOutsideAngular(()=>r.handleError(t)),t}}var ti=(()=>{class r{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=V(LB);afterRenderManager=V(aE);zonelessEnabled=V(hh);rootEffectScheduler=V(gV);dirtyFlags=0;deferredDirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new Dt;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=V(Bi).hasPendingTasks.pipe(ue(n=>!n));constructor(){V(va,{optional:!0})}whenStable(){let n;return new Promise(t=>{n=this.isStable.subscribe({next:i=>{i&&t()}})}).finally(()=>{n.unsubscribe()})}_injector=V(on);_rendererFactory=null;get injector(){return this._injector}bootstrap(n,t){let i=n instanceof Gd;if(!this._injector.get(qE).done){let h=!i&&oS(n),f=!1;throw new X(405,f)}let s;i?s=n:s=this._injector.get(da).resolveComponentFactory(n),this.componentTypes.push(s.componentType);let l=yV(s)?void 0:this._injector.get(Ri),c=t||s.selector,a=s.create(In.NULL,[],c,l),u=a.location.nativeElement,d=a.injector.get(WE,null);return d?.registerApplication(u),a.onDestroy(()=>{this.detachView(a.hostView),Ed(this.components,a),d?.unregisterApplication(u)}),this._loadComponent(a),a}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick=()=>{if(this.tracingSnapshot!==null){let t=this.tracingSnapshot;this.tracingSnapshot=null,t.run(ey.CHANGE_DETECTION,this._tick),t.dispose();return}if(this._runningTick)throw new X(101,!1);let n=De(null);try{this._runningTick=!0,this.synchronize()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1,De(n),this.afterTick.next()}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(ha,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let n=0;for(;this.dirtyFlags!==0&&n++<vV;)this.synchronizeOnce()}synchronizeOnce(){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let n=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:t,notifyErrorHandler:i}of this.allViews)wV(t,i,n,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:n})=>sh(n))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(n){let t=n;this._views.push(t),t.attachToAppRef(this)}detachView(n){let t=n;Ed(this._views,t),t.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(Xl,[]).forEach(i=>i(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>Ed(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new X(406,!1);let n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Ed(r,e){let n=r.indexOf(e);n>-1&&r.splice(n,1)}function wV(r,e,n,t){if(!n&&!sh(r))return;LE(r,e,n&&!t?0:1)}function Kl(r,e,n,t){let i=je(),o=lh();if(wa(i,o,e)){let s=qt(),l=Gm();z3(l,i,r,e,n,t)}return Kl}function _V(r,e,n,t){return wa(r,lh(),n)?e+eh(n)+t:jo}function _d(r,e){return r<<17|e<<2}function ko(r){return r>>17&32767}function TV(r){return(r&2)==2}function xV(r,e){return r&131071|e<<17}function Em(r){return r|2}function pa(r){return(r&131068)>>2}function $g(r,e){return r&-131069|e<<2}function SV(r){return(r&1)===1}function Dm(r){return r|1}function EV(r,e,n,t,i,o){let s=o?e.classBindings:e.styleBindings,l=ko(s),c=pa(s);r[t]=n;let a=!1,u;if(Array.isArray(n)){let d=n;u=d[1],(u===null||Gl(d,u)>0)&&(a=!0)}else u=n;if(i)if(c!==0){let h=ko(r[l+1]);r[t+1]=_d(h,l),h!==0&&(r[h+1]=$g(r[h+1],t)),r[l+1]=xV(r[l+1],t)}else r[t+1]=_d(l,0),l!==0&&(r[l+1]=$g(r[l+1],t)),l=t;else r[t+1]=_d(c,0),l===0?l=t:r[c+1]=$g(r[c+1],t),c=t;a&&(r[t+1]=Em(r[t+1])),Mx(r,u,t,!0),Mx(r,u,t,!1),DV(e,u,r,t,o),s=_d(l,c),o?e.classBindings=s:e.styleBindings=s}function DV(r,e,n,t,i){let o=i?r.residualClasses:r.residualStyles;o!=null&&typeof e=="string"&&Gl(o,e)>=0&&(n[t+1]=Dm(n[t+1]))}function Mx(r,e,n,t){let i=r[n+1],o=e===null,s=t?ko(i):pa(i),l=!1;for(;s!==0&&(l===!1||o);){let c=r[s],a=r[s+1];CV(c,e)&&(l=!0,r[s+1]=t?Dm(a):Em(a)),s=t?ko(a):pa(a)}l&&(r[n+1]=t?Em(i):Dm(i))}function CV(r,e){return r===null||e==null||(Array.isArray(r)?r[1]:r)===e?!0:Array.isArray(r)&&typeof e=="string"?Gl(r,e)>=0:!1}function ge(r,e,n){let t=je(),i=lh();if(wa(t,i,e)){let o=qt(),s=Gm();SE(o,s,t,r,e,t[wt],n,!1)}return ge}function Nx(r,e,n,t,i){let o=e.inputs,s=i?"class":"style";dy(r,n,o[s],s,t)}function _a(r,e,n){return YE(r,e,n,!1),_a}function wy(r,e){return YE(r,e,null,!0),wy}function YE(r,e,n,t){let i=je(),o=qt(),s=iB(2);if(o.firstUpdatePass&&OV(o,r,s,t),e!==jo&&wa(i,s,e)){let l=o.data[ya()];RV(o,l,i,i[wt],r,i[s+1]=kV(e,n),t,s)}}function IV(r,e){return e>=r.expandoStartIndex}function OV(r,e,n,t){let i=r.data;if(i[n+1]===null){let o=i[ya()],s=IV(r,n);FV(o,t)&&e===null&&!s&&(e=!1),e=AV(i,o,e,t),EV(i,o,e,n,s,t)}}function AV(r,e,n,t){let i=lB(r),o=t?e.residualClasses:e.residualStyles;if(i===null)(t?e.classBindings:e.styleBindings)===0&&(n=Ug(null,r,e,n,t),n=Hl(n,e.attrs,t),o=null);else{let s=e.directiveStylingLast;if(s===-1||r[s]!==i)if(n=Ug(i,r,e,n,t),o===null){let c=PV(r,e,t);c!==void 0&&Array.isArray(c)&&(c=Ug(null,r,e,c[1],t),c=Hl(c,e.attrs,t),MV(r,e,t,c))}else o=NV(r,e,t)}return o!==void 0&&(t?e.residualClasses=o:e.residualStyles=o),n}function PV(r,e,n){let t=n?e.classBindings:e.styleBindings;if(pa(t)!==0)return r[ko(t)]}function MV(r,e,n,t){let i=n?e.classBindings:e.styleBindings;r[ko(i)]=t}function NV(r,e,n){let t,i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++){let s=r[o].hostAttrs;t=Hl(t,s,n)}return Hl(t,e.attrs,n)}function Ug(r,e,n,t,i){let o=null,s=n.directiveEnd,l=n.directiveStylingLast;for(l===-1?l=n.directiveStart:l++;l<s&&(o=e[l],t=Hl(t,o.hostAttrs,i),o!==r);)l++;return r!==null&&(n.directiveStylingLast=l),t}function Hl(r,e,n){let t=n?1:2,i=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?i=s:i===t&&(Array.isArray(r)||(r=r===void 0?[]:["",r]),SL(r,s,n?!0:e[++o]))}return r===void 0?null:r}function RV(r,e,n,t,i,o,s,l){if(!(e.type&3))return;let c=r.data,a=c[l+1],u=SV(a)?Rx(c,e,n,i,pa(a),s):void 0;if(!Xd(u)){Xd(o)||TV(a)&&(o=Rx(c,null,n,i,l,s));let d=yS(ya(),n);dj(t,s,d,i,o)}}function Rx(r,e,n,t,i,o){let s=e===null,l;for(;i>0;){let c=r[i],a=Array.isArray(c),u=a?c[1]:c,d=u===null,h=n[i+1];h===jo&&(h=d?Un:void 0);let f=d?Ng(h,t):u===t?h:void 0;if(a&&!Xd(f)&&(f=Ng(c,t)),Xd(f)&&(l=f,s))return l;let p=r[i+1];i=s?ko(p):pa(p)}if(e!==null){let c=o?e.residualClasses:e.residualStyles;c!=null&&(l=Ng(c,t))}return l}function Xd(r){return r!==void 0}function kV(r,e){return r==null||r===""||(typeof e=="string"?r=r+e:typeof r=="object"&&(r=rn(ql(r)))),r}function FV(r,e){return(r.flags&(e?8:16))!==0}function LV(r,e,n,t,i,o){let s=e.consts,l=aa(s,i),c=Yl(e,r,2,t,l);return uy(e,n,c,aa(s,o)),c.attrs!==null&&Wd(c,c.attrs,!1),c.mergedAttrs!==null&&Wd(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function te(r,e,n,t){let i=je(),o=qt(),s=Cn+r,l=i[wt],c=o.firstCreatePass?LV(s,o,i,e,n,t):o.data[s],a=BV(o,i,c,l,e,r);i[s]=a;let u=oh(c);return Lo(c,!0),wE(l,a,c),!uV(c)&&ch()&&vh(o,i,a,c),XL()===0&&Mi(a,i),KL(),u&&(ay(o,i,c),ry(o,c,i)),t!==null&&ly(i,c),te}function Q(){let r=Yt();Um()?SS():(r=r.parent,Lo(r,!1));let e=r;QL(e)&&eB(),ZL();let n=qt();return n.firstCreatePass&&(dh(n,r),jm(r)&&n.queries.elementEnd(r)),e.classesWithoutHost!=null&&gB(e)&&Nx(n,e,je(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&mB(e)&&Nx(n,e,je(),e.stylesWithoutHost,!1),Q}function et(r,e,n,t){return te(r,e,n,t),Q(),et}var BV=(r,e,n,t,i,o)=>(uh(!0),vE(t,i,dB()));function jV(r,e,n,t,i){let o=e.consts,s=aa(o,t),l=Yl(e,r,8,"ng-container",s);s!==null&&Wd(l,s,!0);let c=aa(o,i);return uy(e,n,l,c),e.queries!==null&&e.queries.elementStart(e,l),l}function _y(r,e,n){let t=je(),i=qt(),o=r+Cn,s=i.firstCreatePass?jV(o,i,t,e,n):i.data[o];Lo(s,!0);let l=VV(i,t,s,r);return t[o]=l,ch()&&vh(i,t,l,s),Mi(l,t),oh(s)&&(ay(i,t,s),ry(i,s,t)),n!=null&&ly(t,s),_y}function Ty(){let r=Yt(),e=qt();return Um()?SS():(r=r.parent,Lo(r,!1)),e.firstCreatePass&&(dh(e,r),jm(r)&&e.queries.elementEnd(r)),Ty}var VV=(r,e,n,t)=>(uh(!0),x3(e[wt],""));function Ta(){return je()}var Kd="en-US";var $V=Kd;function UV(r){typeof r=="string"&&($V=r.toLowerCase().replace(/_/g,"-"))}var HV=(r,e,n)=>{};function Mt(r,e,n,t){let i=je(),o=qt(),s=Yt();return XE(o,i,i[wt],s,r,e,t),Mt}function zV(r,e,n,t){let i=r.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===n&&i[o+1]===t){let l=e[Md],c=i[o+2];return l.length>c?l[c]:null}typeof s=="string"&&(o+=2)}return null}function XE(r,e,n,t,i,o,s){let l=oh(t),a=r.firstCreatePass&&YL(r),u=e[dr],d=qL(e),h=!0;if(t.type&3||s){let g=Gn(t,e),y=s?s(g):g,w=d.length,v=s?A=>s(Pr(A[t.index])):t.index,x=null;if(!s&&l&&(x=zV(r,e,i,t.index)),x!==null){let A=x.__ngLastListenerFn__||x;A.__ngNextListenerFn__=o,x.__ngLastListenerFn__=o,h=!1}else{o=Fx(t,e,u,o),HV(g,i,o);let A=n.listen(y,i,o);d.push(o,A),a&&a.push(i,v,w,w+1)}}else o=Fx(t,e,u,o);let f=t.outputs,p;if(h&&f!==null&&(p=f[i])){let g=p.length;if(g)for(let y=0;y<g;y+=2){let w=p[y],v=p[y+1],L=e[w][v].subscribe(o),H=d.length;d.push(o,L),a&&a.push(i,t.index,H,-(H+1))}}}function kx(r,e,n,t){let i=De(null);try{return Hn(6,e,n),n(t)!==!1}catch(o){return OE(r,o),!1}finally{Hn(7,e,n),De(i)}}function Fx(r,e,n,t){return function i(o){if(o===Function)return t;let s=r.componentOffset>-1?Fi(r.index,e):e;my(s,5);let l=kx(e,n,t,o),c=i.__ngNextListenerFn__;for(;c;)l=kx(e,n,c,o)&&l,c=c.__ngNextListenerFn__;return l}}function Ct(r=1){return uB(r)}function GV(r,e,n,t){n>=r.data.length&&(r.data[n]=null,r.blueprint[n]=null),e[n]=t}function xy(r){let e=nB();return bS(e,Cn+r)}function It(r,e=""){let n=je(),t=qt(),i=r+Cn,o=t.firstCreatePass?Yl(t,i,1,e,null):t.data[i],s=WV(t,n,o,e,r);n[i]=s,ch()&&vh(t,n,s,o),Lo(o,!1)}var WV=(r,e,n,t,i)=>(uh(!0),_3(e[wt],t));function On(r,e,n){let t=je(),i=_V(t,r,e,n);return i!==jo&&qV(t,ya(),i),On}function qV(r,e,n){let t=yS(e,r);T3(r[wt],t,n)}function Zl(r,e,n){JS(e)&&(e=e());let t=je(),i=lh();if(wa(t,i,e)){let o=qt(),s=Gm();SE(o,s,t,r,e,t[wt],n,!1)}return Zl}function xh(r,e){let n=JS(r);return n&&r.set(e),n}function Jl(r,e){let n=je(),t=qt(),i=Yt();return XE(t,n,n[wt],i,r,e),Jl}function YV(r,e,n){let t=qt();if(t.firstCreatePass){let i=Pi(r);Cm(n,t.data,t.blueprint,i,!0),Cm(e,t.data,t.blueprint,i,!1)}}function Cm(r,e,n,t,i){if(r=nn(r),Array.isArray(r))for(let o=0;o<r.length;o++)Cm(r[o],e,n,t,i);else{let o=qt(),s=je(),l=Yt(),c=ra(r)?r:nn(r.provide),a=cS(r),u=l.providerIndexes&1048575,d=l.directiveStart,h=l.providerIndexes>>20;if(ra(r)||!r.multi){let f=new No(a,i,se),p=zg(c,e,i?u:u+h,d);p===-1?(om(jd(l,s),o,c),Hg(o,r,e.length),e.push(c),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(f),s.push(f)):(n[p]=f,s[p]=f)}else{let f=zg(c,e,u+h,d),p=zg(c,e,u,u+h),g=f>=0&&n[f],y=p>=0&&n[p];if(i&&!y||!i&&!g){om(jd(l,s),o,c);let w=ZV(i?KV:XV,n.length,i,t,a);!i&&y&&(n[p].providerFactory=w),Hg(o,r,e.length,0),e.push(c),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(w),s.push(w)}else{let w=KE(n[i?p:f],a,!i&&t);Hg(o,r,f>-1?f:p,w)}!i&&t&&y&&n[p].componentProviders++}}}function Hg(r,e,n,t){let i=ra(e),o=AL(e);if(i||o){let c=(o?nn(e.useClass):e).prototype.ngOnDestroy;if(c){let a=r.destroyHooks||(r.destroyHooks=[]);if(!i&&e.multi){let u=a.indexOf(n);u===-1?a.push(n,[t,c]):a[u+1].push(t,c)}else a.push(n,c)}}}function KE(r,e,n){return n&&r.componentProviders++,r.multi.push(e)-1}function zg(r,e,n,t){for(let i=n;i<t;i++)if(e[i]===r)return i;return-1}function XV(r,e,n,t){return Im(this.multi,[])}function KV(r,e,n,t){let i=this.multi,o;if(this.providerFactory){let s=this.providerFactory.componentProviders,l=ca(n,n[xe],this.providerFactory.index,t);o=l.slice(0,s),Im(i,o);for(let c=s;c<l.length;c++)o.push(l[c])}else o=[],Im(i,o);return o}function Im(r,e){for(let n=0;n<r.length;n++){let t=r[n];e.push(t())}return e}function ZV(r,e,n,t,i){let o=new No(r,n,se);return o.multi=[],o.index=e,o.componentProviders=0,KE(o,i,t&&!n),o}function xa(r,e=[]){return n=>{n.providersResolver=(t,i)=>YV(t,i?i(r):r,e)}}function ZE(r,e,n,t){return JE(je(),DS(),r,e,n,t)}function JV(r,e){let n=r[e];return n===jo?void 0:n}function JE(r,e,n,t,i,o){let s=e+n;return wa(r,s,i)?cV(r,s+1,o?t.call(o,i):t(i)):JV(r,s+1)}function Sa(r,e){let n=qt(),t,i=r+Cn;n.firstCreatePass?(t=QV(e,n.pipeRegistry),n.data[i]=t,t.onDestroy&&(n.destroyHooks??=[]).push(i,t.onDestroy)):t=n.data[i];let o=t.factory||(t.factory=Oo(t.type,!0)),s,l=mn(se);try{let c=Bd(!1),a=o();return Bd(c),GV(n,je(),i,a),a}finally{mn(l)}}function QV(r,e){if(e)for(let n=e.length-1;n>=0;n--){let t=e[n];if(r===t.name)return t}}function Ea(r,e,n){let t=r+Cn,i=je(),o=bS(i,t);return e4(i,t)?JE(i,DS(),e,o.transform,n,o):o.transform(n)}function e4(r,e){return r[xe].data[e].pure}var Om=class{ngModuleFactory;componentFactories;constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},Sh=(()=>{class r{compileModuleSync(n){return new xm(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){let t=this.compileModuleSync(n),i=nS(n),o=fE(i.declarations).reduce((s,l)=>{let c=Ai(l);return c&&s.push(new fa(c)),s},[]);return new Om(t,o)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var t4=(()=>{class r{zone=V(at);changeDetectionScheduler=V(ua);applicationRef=V(ti);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),n4=new Y("",{factory:()=>!1});function QE({ngZoneFactory:r,ignoreChangesOutsideZone:e,scheduleInRootZone:n}){return r??=()=>new at(k(C({},tD()),{scheduleInRootZone:n})),[{provide:at,useFactory:r},{provide:na,multi:!0,useFactory:()=>{let t=V(t4,{optional:!0});return()=>t.initialize()}},{provide:na,multi:!0,useFactory:()=>{let t=V(r4);return()=>{t.initialize()}}},e===!0?{provide:qS,useValue:!0}:[],{provide:YS,useValue:n??WS}]}function eD(r){let e=r?.ignoreChangesOutsideZone,n=r?.scheduleInRootZone,t=QE({ngZoneFactory:()=>{let i=tD(r);return i.scheduleInRootZone=n,i.shouldCoalesceEventChangeDetection&&Bo("NgZone_CoalesceEvent"),new at(i)},ignoreChangesOutsideZone:e,scheduleInRootZone:n});return ga([{provide:n4,useValue:!0},{provide:hh,useValue:!1},t])}function tD(r){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:r?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:r?.runCoalescing??!1}}var r4=(()=>{class r{subscription=new ot;initialized=!1;zone=V(at);pendingTasks=V(Bi);initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{at.assertNotInAngularZone(),queueMicrotask(()=>{n!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{at.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var i4=(()=>{class r{appRef=V(ti);taskService=V(Bi);ngZone=V(at);zonelessEnabled=V(hh);tracing=V(va,{optional:!0});disableScheduling=V(qS,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new ot;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get($d):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(V(YS,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof um||!this.zoneIsDefined)}notify(n){if(!this.zonelessEnabled&&n===5)return;let t=!1;switch(n){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 8:{this.appRef.deferredDirtyFlags|=8;break}case 6:{this.appRef.dirtyFlags|=2,t=!0;break}case 13:{this.appRef.dirtyFlags|=16,t=!0;break}case 14:{this.appRef.dirtyFlags|=2,t=!0;break}case 12:{t=!0;break}case 10:case 9:case 7:case 11:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(t))return;let i=this.useMicrotaskScheduler?px:XS;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(n){return!(this.disableScheduling&&!n||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get($d+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let n=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(t){throw this.taskService.remove(n),t}finally{this.cleanup()}this.useMicrotaskScheduler=!0,px(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(n)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let n=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(n)}}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function o4(){return typeof $localize<"u"&&$localize.locale||Kd}var Sy=new Y("",{providedIn:"root",factory:()=>V(Sy,pe.Optional|pe.SkipSelf)||o4()});var Am=new Y(""),s4=new Y("");function kl(r){return!r.moduleRef}function a4(r){let e=kl(r)?r.r3Injector:r.moduleRef.injector,n=e.get(at);return n.run(()=>{kl(r)?r.r3Injector.resolveInjectorInitializers():r.moduleRef.resolveInjectorInitializers();let t=e.get(Qr,null),i;if(n.runOutsideAngular(()=>{i=n.onError.subscribe({next:o=>{t.handleError(o)}})}),kl(r)){let o=()=>e.destroy(),s=r.platformInjector.get(Am);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>r.moduleRef.destroy(),s=r.platformInjector.get(Am);s.add(o),r.moduleRef.onDestroy(()=>{Ed(r.allPlatformModules,r.moduleRef),i.unsubscribe(),s.delete(o)})}return bV(t,n,()=>{let o=e.get(qE);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(Sy,Kd);if(UV(s||Kd),!e.get(s4,!0))return kl(r)?e.get(ti):(r.allPlatformModules.push(r.moduleRef),r.moduleRef);if(kl(r)){let c=e.get(ti);return r.rootComponent!==void 0&&c.bootstrap(r.rootComponent),c}else return l4(r.moduleRef,r.allPlatformModules),r.moduleRef})})})}function l4(r,e){let n=r.injector.get(ti);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(t=>n.bootstrap(t));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(n);else throw new X(-403,!1);e.push(r)}var Dd=null;function c4(r=[],e){return In.create({name:e,providers:[{provide:nh,useValue:"platform"},{provide:Am,useValue:new Set([()=>Dd=null])},...r]})}function u4(r=[]){if(Dd)return Dd;let e=c4(r);return Dd=e,mV(),d4(e),e}function d4(r){let e=r.get(Jm,null);yn(r,()=>{e?.forEach(n=>n())})}var Ui=(()=>{class r{static __NG_ELEMENT_ID__=h4}return r})();function h4(r){return f4(Yt(),je(),(r&16)===16)}function f4(r,e,n){if(ih(r)&&!n){let t=Fi(r.index,e);return new Ro(t,t)}else if(r.type&175){let t=e[Ar];return new Ro(t,e)}return null}var Pm=class{constructor(){}supports(e){return GE(e)}create(e){return new Mm(e)}},p4=(r,e)=>e,Mm=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||p4}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,t=this._removalsHead,i=0,o=null;for(;n||t;){let s=!t||n&&n.currentIndex<Lx(t,i,o)?n:t,l=Lx(s,i,o),c=s.currentIndex;if(s===t)i--,t=t._nextRemoved;else if(n=n._next,s.previousIndex==null)i++;else{o||(o=[]);let a=l-i,u=c-i;if(a!=u){for(let h=0;h<a;h++){let f=h<o.length?o[h]:o[h]=0,p=f+h;u<=p&&p<a&&(o[h]=f+1)}let d=s.previousIndex;o[d]=u-a}}l!==c&&e(s,l,c)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!GE(e))throw new X(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,t=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let l=0;l<this.length;l++)o=e[l],s=this._trackByFn(l,o),n===null||!Object.is(n.trackById,s)?(n=this._mismatch(n,o,s,l),t=!0):(t&&(n=this._verifyReinsertion(n,o,s,l)),Object.is(n.item,o)||this._addIdentityChange(n,o)),n=n._next}else i=0,aV(e,l=>{s=this._trackByFn(i,l),n===null||!Object.is(n.trackById,s)?(n=this._mismatch(n,l,s,i),t=!0):(t&&(n=this._verifyReinsertion(n,l,s,i)),Object.is(n.item,l)||this._addIdentityChange(n,l)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,t,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(t,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(t,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,o,i)):e=this._addAfter(new Nm(n,t),o,i)),e}_verifyReinsertion(e,n,t,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(t,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,t){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,n,t),this._addToMoves(e,t),e}_moveAfter(e,n,t){return this._unlink(e),this._insertAfter(e,n,t),this._addToMoves(e,t),e}_addAfter(e,n,t){return this._insertAfter(e,n,t),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,t){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new Zd),this._linkedRecords.put(e),e.currentIndex=t,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,t=e._next;return n===null?this._itHead=t:n._next=t,t===null?this._itTail=n:t._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Zd),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Nm=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,n){this.item=e,this.trackById=n}},Rm=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let t;for(t=this._head;t!==null;t=t._nextDup)if((n===null||n<=t.currentIndex)&&Object.is(t.trackById,e))return t;return null}remove(e){let n=e._prevDup,t=e._nextDup;return n===null?this._head=t:n._nextDup=t,t===null?this._tail=n:t._prevDup=n,this._head===null}},Zd=class{map=new Map;put(e){let n=e.trackById,t=this.map.get(n);t||(t=new Rm,this.map.set(n,t)),t.add(e)}get(e,n){let t=e,i=this.map.get(t);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function Lx(r,e,n){let t=r.previousIndex;if(t===null)return t;let i=0;return n&&t<n.length&&(i=n[t]),t+e+i}function Bx(){return new Ey([new Pm])}var Ey=(()=>{class r{factories;static \u0275prov=W({token:r,providedIn:"root",factory:Bx});constructor(n){this.factories=n}static create(n,t){if(t!=null){let i=t.factories.slice();n=n.concat(i)}return new r(n)}static extend(n){return{provide:r,useFactory:t=>r.create(n,t||Bx()),deps:[[r,new TL,new Jx]]}}find(n){let t=this.factories.find(i=>i.supports(n));if(t!=null)return t;throw new X(901,!1)}}return r})();function nD(r){try{let{rootComponent:e,appProviders:n,platformProviders:t}=r,i=u4(t),o=[QE({}),{provide:ua,useExisting:i4},...n||[]],s=new Yd({providers:o,parent:i,debugName:"",runEnvironmentInitializers:!1});return a4({r3Injector:s.injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}}function Vo(r){return typeof r=="boolean"?r:r!=null&&r!=="false"}function Eh(r,e){Bo("NgSignals");let n=xT(r);return e?.equal&&(n[xn].equal=e.equal),n}function Rr(r){let e=De(null);try{return r()}finally{De(e)}}var jx=class{[xn];constructor(e){this[xn]=e}destroy(){this[xn].destroy()}};function rD(r){let e=Ai(r);if(!e)return null;let n=new fa(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var cD=null;function ci(){return cD}function uD(r){cD??=r}var Dh=class{};var Xt=new Y(""),Ny=(()=>{class r{historyGo(n){throw new Error("")}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:()=>V(g4),providedIn:"platform"})}return r})(),dD=new Y(""),g4=(()=>{class r extends Ny{_location;_history;_doc=V(Xt);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ci().getBaseHref(this._doc)}onPopState(n){let t=ci().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",n,!1),()=>t.removeEventListener("popstate",n)}onHashChange(n){let t=ci().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",n,!1),()=>t.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,t,i){this._history.pushState(n,t,i)}replaceState(n,t,i){this._history.replaceState(n,t,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:()=>new r,providedIn:"platform"})}return r})();function Ry(r,e){if(r.length==0)return e;if(e.length==0)return r;let n=0;return r.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?r+e.substring(1):n==1?r+e:r+"/"+e}function iD(r){let e=r.match(/#|\?|$/),n=e&&e.index||r.length,t=n-(r[n-1]==="/"?1:0);return r.slice(0,t)+r.slice(n)}function li(r){return r&&r[0]!=="?"?"?"+r:r}var ui=(()=>{class r{historyGo(n){throw new Error("")}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:()=>V(ky),providedIn:"root"})}return r})(),hD=new Y(""),ky=(()=>{class r extends ui{_platformLocation;_baseHref;_removeListenerFns=[];constructor(n,t){super(),this._platformLocation=n,this._baseHref=t??this._platformLocation.getBaseHrefFromDOM()??V(Xt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return Ry(this._baseHref,n)}path(n=!1){let t=this._platformLocation.pathname+li(this._platformLocation.search),i=this._platformLocation.hash;return i&&n?`${t}${i}`:t}pushState(n,t,i,o){let s=this.prepareExternalUrl(i+li(o));this._platformLocation.pushState(n,t,s)}replaceState(n,t,i,o){let s=this.prepareExternalUrl(i+li(o));this._platformLocation.replaceState(n,t,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static \u0275fac=function(t){return new(t||r)(J(Ny),J(hD,8))};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),fD=(()=>{class r extends ui{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(n,t){super(),this._platformLocation=n,t!=null&&(this._baseHref=t)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let t=this._platformLocation.hash??"#";return t.length>0?t.substring(1):t}prepareExternalUrl(n){let t=Ry(this._baseHref,n);return t.length>0?"#"+t:t}pushState(n,t,i,o){let s=this.prepareExternalUrl(i+li(o));s.length==0&&(s=this._platformLocation.pathname),this._platformLocation.pushState(n,t,s)}replaceState(n,t,i,o){let s=this.prepareExternalUrl(i+li(o));s.length==0&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(n,t,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static \u0275fac=function(t){return new(t||r)(J(Ny),J(hD,8))};static \u0275prov=W({token:r,factory:r.\u0275fac})}return r})(),Hi=(()=>{class r{_subject=new Dt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(n){this._locationStrategy=n;let t=this._locationStrategy.getBaseHref();this._basePath=v4(iD(oD(t))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,t=""){return this.path()==this.normalize(n+li(t))}normalize(n){return r.stripTrailingSlash(y4(this._basePath,oD(n)))}prepareExternalUrl(n){return n&&n[0]!=="/"&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,t="",i=null){this._locationStrategy.pushState(i,"",n,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+li(t)),i)}replaceState(n,t="",i=null){this._locationStrategy.replaceState(i,"",n,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+li(t)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription??=this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)}),()=>{let t=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(t,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",t){this._urlChangeListeners.forEach(i=>i(n,t))}subscribe(n,t,i){return this._subject.subscribe({next:n,error:t??void 0,complete:i??void 0})}static normalizeQueryParams=li;static joinWithSlash=Ry;static stripTrailingSlash=iD;static \u0275fac=function(t){return new(t||r)(J(ui))};static \u0275prov=W({token:r,factory:()=>m4(),providedIn:"root"})}return r})();function m4(){return new Hi(J(ui))}function y4(r,e){if(!r||!e.startsWith(r))return e;let n=e.substring(r.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function oD(r){return r.replace(/\/index.html$/,"")}function v4(r){if(new RegExp("^(https?:)?//").test(r)){let[,n]=r.split(/\/\/[^\/]+/);return n}return r}function Ch(r,e){e=encodeURIComponent(e);for(let n of r.split(";")){let t=n.indexOf("="),[i,o]=t==-1?[n,""]:[n.slice(0,t),n.slice(t+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var Dy=/\s+/,sD=[],pD=(()=>{class r{_ngEl;_renderer;initialClasses=sD;rawClass;stateMap=new Map;constructor(n,t){this._ngEl=n,this._renderer=t}set klass(n){this.initialClasses=n!=null?n.trim().split(Dy):sD}set ngClass(n){this.rawClass=typeof n=="string"?n.trim().split(Dy):n}ngDoCheck(){for(let t of this.initialClasses)this._updateState(t,!0);let n=this.rawClass;if(Array.isArray(n)||n instanceof Set)for(let t of n)this._updateState(t,!0);else if(n!=null)for(let t of Object.keys(n))this._updateState(t,!!n[t]);this._applyStateDiff()}_updateState(n,t){let i=this.stateMap.get(n);i!==void 0?(i.enabled!==t&&(i.changed=!0,i.enabled=t),i.touched=!0):this.stateMap.set(n,{enabled:t,changed:!0,touched:!0})}_applyStateDiff(){for(let n of this.stateMap){let t=n[0],i=n[1];i.changed?(this._toggleClass(t,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(t,!1),this.stateMap.delete(t)),i.touched=!1}}_toggleClass(n,t){n=n.trim(),n.length>0&&n.split(Dy).forEach(i=>{t?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static \u0275fac=function(t){return new(t||r)(se(oi),se(Vi))};static \u0275dir=Ut({type:r,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return r})();var Cy=class{$implicit;ngForOf;index;count;constructor(e,n,t,i){this.$implicit=e,this.ngForOf=n,this.index=t,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Ih=(()=>{class r{_viewContainer;_template;_differs;set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(n,t,i){this._viewContainer=n,this._template=t,this._differs=i}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){let n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){let t=this._viewContainer;n.forEachOperation((i,o,s)=>{if(i.previousIndex==null)t.createEmbeddedView(this._template,new Cy(i.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)t.remove(o===null?void 0:o);else if(o!==null){let l=t.get(o);t.move(l,s),aD(l,i)}});for(let i=0,o=t.length;i<o;i++){let l=t.get(i).context;l.index=i,l.count=o,l.ngForOf=this._ngForOf}n.forEachIdentityChange(i=>{let o=t.get(i.currentIndex);aD(o,i)})}static ngTemplateContextGuard(n,t){return!0}static \u0275fac=function(t){return new(t||r)(se(ba),se(wh),se(Ey))};static \u0275dir=Ut({type:r,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return r})();function aD(r,e){r.context.$implicit=e.item}var Ca=(()=>{class r{_viewContainer;_context=new Iy;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(n,t){this._viewContainer=n,this._thenTemplateRef=t}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){lD("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){lD("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(n,t){return!0}static \u0275fac=function(t){return new(t||r)(se(ba),se(wh))};static \u0275dir=Ut({type:r,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return r})(),Iy=class{$implicit=null;ngIf=null};function lD(r,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${r} must be a TemplateRef, but received '${rn(e)}'.`)}function b4(r,e){return new X(2100,!1)}var Oy=class{createSubscription(e,n){return Rr(()=>e.subscribe({next:n,error:t=>{throw t}}))}dispose(e){Rr(()=>e.unsubscribe())}},Ay=class{createSubscription(e,n){return e.then(n,t=>{throw t})}dispose(e){}},w4=new Ay,_4=new Oy,Oh=(()=>{class r{_ref;_latestValue=null;markForCheckOnValueUpdate=!0;_subscription=null;_obj=null;_strategy=null;constructor(n){this._ref=n}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(n){if(!this._obj){if(n)try{this.markForCheckOnValueUpdate=!1,this._subscribe(n)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return n!==this._obj?(this._dispose(),this.transform(n)):this._latestValue}_subscribe(n){this._obj=n,this._strategy=this._selectStrategy(n),this._subscription=this._strategy.createSubscription(n,t=>this._updateLatestValue(n,t))}_selectStrategy(n){if($i(n))return w4;if(by(n))return _4;throw b4(r,n)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(n,t){n===this._obj&&(this._latestValue=t,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static \u0275fac=function(t){return new(t||r)(se(Ui,16))};static \u0275pipe=UE({name:"async",type:r,pure:!1})}return r})();var di=(()=>{class r{static \u0275fac=function(t){return new(t||r)};static \u0275mod=si({type:r});static \u0275inj=ni({})}return r})(),gD="browser",T4="server";function Fy(r){return r===T4}var mD=(()=>{class r{static \u0275prov=W({token:r,providedIn:"root",factory:()=>new Py(V(Xt),window)})}return r})(),Py=class{document;window;offset=()=>[0,0];constructor(e,n){this.document=e,this.window=n}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=x4(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),t=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(t-o[0],i-o[1])}};function x4(r,e){let n=r.getElementById(e)||r.getElementsByName(e)[0];if(n)return n;if(typeof r.createTreeWalker=="function"&&r.body&&typeof r.body.attachShadow=="function"){let t=r.createTreeWalker(r.body,NodeFilter.SHOW_ELEMENT),i=t.currentNode;for(;i;){let o=i.shadowRoot;if(o){let s=o.getElementById(e)||o.querySelector(`[name="${e}"]`);if(s)return s}i=t.nextNode()}}return null}var Da=class{};var ec=class{},Ph=class{},$o=class r{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(n=>{let t=n.indexOf(":");if(t>0){let i=n.slice(0,t),o=n.slice(t+1).trim();this.addHeaderEntry(i,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((n,t)=>{this.addHeaderEntry(t,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([n,t])=>{this.setHeaderEntries(n,t)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof r?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){let n=new r;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof r?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){let n=e.name.toLowerCase();switch(e.op){case"a":case"s":let t=e.value;if(typeof t=="string"&&(t=[t]),t.length===0)return;this.maybeSetNormalizedName(e.name,n);let i=(e.op==="a"?this.headers.get(n):void 0)||[];i.push(...t),this.headers.set(n,i);break;case"d":let o=e.value;if(!o)this.headers.delete(n),this.normalizedNames.delete(n);else{let s=this.headers.get(n);if(!s)return;s=s.filter(l=>o.indexOf(l)===-1),s.length===0?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,s)}break}}addHeaderEntry(e,n){let t=e.toLowerCase();this.maybeSetNormalizedName(e,t),this.headers.has(t)?this.headers.get(t).push(n):this.headers.set(t,[n])}setHeaderEntries(e,n){let t=(Array.isArray(n)?n:[n]).map(o=>o.toString()),i=e.toLowerCase();this.headers.set(i,t),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}};var By=class{encodeKey(e){return yD(e)}encodeValue(e){return yD(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function S4(r,e){let n=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(i=>{let o=i.indexOf("="),[s,l]=o==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,o)),e.decodeValue(i.slice(o+1))],c=n.get(s)||[];c.push(l),n.set(s,c)}),n}var E4=/%(\d[a-f0-9])/gi,D4={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function yD(r){return encodeURIComponent(r).replace(E4,(e,n)=>D4[n]??e)}function Ah(r){return`${r}`}var zi=class r{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new By,e.fromString){if(e.fromObject)throw new X(2805,!1);this.map=S4(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(n=>{let t=e.fromObject[n],i=Array.isArray(t)?t.map(Ah):[Ah(t)];this.map.set(n,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let n=this.map.get(e);return n?n[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,n){return this.clone({param:e,value:n,op:"a"})}appendAll(e){let n=[];return Object.keys(e).forEach(t=>{let i=e[t];Array.isArray(i)?i.forEach(o=>{n.push({param:t,value:o,op:"a"})}):n.push({param:t,value:i,op:"a"})}),this.clone(n)}set(e,n){return this.clone({param:e,value:n,op:"s"})}delete(e,n){return this.clone({param:e,value:n,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let n=this.encoder.encodeKey(e);return this.map.get(e).map(t=>n+"="+this.encoder.encodeValue(t)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let n=new r({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(e),n}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let n=(e.op==="a"?this.map.get(e.param):void 0)||[];n.push(Ah(e.value)),this.map.set(e.param,n);break;case"d":if(e.value!==void 0){let t=this.map.get(e.param)||[],i=t.indexOf(Ah(e.value));i!==-1&&t.splice(i,1),t.length>0?this.map.set(e.param,t):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var jy=class{map=new Map;set(e,n){return this.map.set(e,n),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function C4(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function vD(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function bD(r){return typeof Blob<"u"&&r instanceof Blob}function wD(r){return typeof FormData<"u"&&r instanceof FormData}function I4(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}var _D="Content-Type",SD="X-Request-URL",ED="text/plain",DD="application/json",O4=`${DD}, ${ED}, */*`,Ql=class r{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(e,n,t,i){this.url=n,this.method=e.toUpperCase();let o;if(C4(this.method)||i?(this.body=t!==void 0?t:null,o=i):o=t,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),this.transferCache=o.transferCache),this.headers??=new $o,this.context??=new jy,!this.params)this.params=new zi,this.urlWithParams=n;else{let s=this.params.toString();if(s.length===0)this.urlWithParams=n;else{let l=n.indexOf("?"),c=l===-1?"?":l<n.length-1?"&":"";this.urlWithParams=n+c+s}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||vD(this.body)||bD(this.body)||wD(this.body)||I4(this.body)?this.body:this.body instanceof zi?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||wD(this.body)?null:bD(this.body)?this.body.type||null:vD(this.body)?null:typeof this.body=="string"?ED:this.body instanceof zi?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?DD:null}clone(e={}){let n=e.method||this.method,t=e.url||this.url,i=e.responseType||this.responseType,o=e.transferCache??this.transferCache,s=e.body!==void 0?e.body:this.body,l=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress,a=e.headers||this.headers,u=e.params||this.params,d=e.context??this.context;return e.setHeaders!==void 0&&(a=Object.keys(e.setHeaders).reduce((h,f)=>h.set(f,e.setHeaders[f]),a)),e.setParams&&(u=Object.keys(e.setParams).reduce((h,f)=>h.set(f,e.setParams[f]),u)),new r(n,t,s,{params:u,headers:a,context:d,reportProgress:c,responseType:i,withCredentials:l,transferCache:o})}},Oa=function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r}(Oa||{}),tc=class{headers;status;statusText;url;ok;type;constructor(e,n=200,t="OK"){this.headers=e.headers||new $o,this.status=e.status!==void 0?e.status:n,this.statusText=e.statusText||t,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},Vy=class r extends tc{constructor(e={}){super(e)}type=Oa.ResponseHeader;clone(e={}){return new r({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Mh=class r extends tc{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=Oa.Response;clone(e={}){return new r({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Nh=class extends tc{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},A4=200,P4=204;function Ly(r,e){return{body:e,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials,transferCache:r.transferCache}}var M4=(()=>{class r{handler;constructor(n){this.handler=n}request(n,t,i={}){let o;if(n instanceof Ql)o=n;else{let c;i.headers instanceof $o?c=i.headers:c=new $o(i.headers);let a;i.params&&(i.params instanceof zi?a=i.params:a=new zi({fromObject:i.params})),o=new Ql(n,t,i.body!==void 0?i.body:null,{headers:c,context:i.context,params:a,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache})}let s=ee(o).pipe(Xr(c=>this.handler.handle(c)));if(n instanceof Ql||i.observe==="events")return s;let l=s.pipe(Vt(c=>c instanceof Mh));switch(i.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return l.pipe(ue(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return l.pipe(ue(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return l.pipe(ue(c=>{if(c.body!==null&&typeof c.body!="string")throw new Error("Response is not a string.");return c.body}));case"json":default:return l.pipe(ue(c=>c.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(n,t={}){return this.request("DELETE",n,t)}get(n,t={}){return this.request("GET",n,t)}head(n,t={}){return this.request("HEAD",n,t)}jsonp(n,t){return this.request("JSONP",n,{params:new zi().append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,t={}){return this.request("OPTIONS",n,t)}patch(n,t,i={}){return this.request("PATCH",n,Ly(i,t))}post(n,t,i={}){return this.request("POST",n,Ly(i,t))}put(n,t,i={}){return this.request("PUT",n,Ly(i,t))}static \u0275fac=function(t){return new(t||r)(J(ec))};static \u0275prov=W({token:r,factory:r.\u0275fac})}return r})();var N4=new Y("");function R4(r,e){return e(r)}function k4(r,e,n){return(t,i)=>yn(n,()=>e(t,o=>r(o,i)))}var CD=new Y(""),F4=new Y(""),L4=new Y("",{providedIn:"root",factory:()=>!0});var TD=(()=>{class r extends ec{backend;injector;chain=null;pendingTasks=V(Bi);contributeToStability=V(L4);constructor(n,t){super(),this.backend=n,this.injector=t}handle(n){if(this.chain===null){let t=Array.from(new Set([...this.injector.get(CD),...this.injector.get(F4,[])]));this.chain=t.reduceRight((i,o)=>k4(i,o,this.injector),R4)}if(this.contributeToStability){let t=this.pendingTasks.add();return this.chain(n,i=>this.backend.handle(i)).pipe(Co(()=>this.pendingTasks.remove(t)))}else return this.chain(n,t=>this.backend.handle(t))}static \u0275fac=function(t){return new(t||r)(J(Ph),J(on))};static \u0275prov=W({token:r,factory:r.\u0275fac})}return r})();var B4=/^\)\]\}',?\n/,j4=RegExp(`^${SD}:`,"m");function V4(r){return"responseURL"in r&&r.responseURL?r.responseURL:j4.test(r.getAllResponseHeaders())?r.getResponseHeader(SD):null}var xD=(()=>{class r{xhrFactory;constructor(n){this.xhrFactory=n}handle(n){if(n.method==="JSONP")throw new X(-2800,!1);let t=this.xhrFactory;return(t.\u0275loadImpl?Xe(t.\u0275loadImpl()):ee(null)).pipe(gn(()=>new Ie(o=>{let s=t.build();if(s.open(n.method,n.urlWithParams),n.withCredentials&&(s.withCredentials=!0),n.headers.forEach((g,y)=>s.setRequestHeader(g,y.join(","))),n.headers.has("Accept")||s.setRequestHeader("Accept",O4),!n.headers.has(_D)){let g=n.detectContentTypeHeader();g!==null&&s.setRequestHeader(_D,g)}if(n.responseType){let g=n.responseType.toLowerCase();s.responseType=g!=="json"?g:"text"}let l=n.serializeBody(),c=null,a=()=>{if(c!==null)return c;let g=s.statusText||"OK",y=new $o(s.getAllResponseHeaders()),w=V4(s)||n.url;return c=new Vy({headers:y,status:s.status,statusText:g,url:w}),c},u=()=>{let{headers:g,status:y,statusText:w,url:v}=a(),x=null;y!==P4&&(x=typeof s.response>"u"?s.responseText:s.response),y===0&&(y=x?A4:0);let A=y>=200&&y<300;if(n.responseType==="json"&&typeof x=="string"){let L=x;x=x.replace(B4,"");try{x=x!==""?JSON.parse(x):null}catch(H){x=L,A&&(A=!1,x={error:H,text:x})}}A?(o.next(new Mh({body:x,headers:g,status:y,statusText:w,url:v||void 0})),o.complete()):o.error(new Nh({error:x,headers:g,status:y,statusText:w,url:v||void 0}))},d=g=>{let{url:y}=a(),w=new Nh({error:g,status:s.status||0,statusText:s.statusText||"Unknown Error",url:y||void 0});o.error(w)},h=!1,f=g=>{h||(o.next(a()),h=!0);let y={type:Oa.DownloadProgress,loaded:g.loaded};g.lengthComputable&&(y.total=g.total),n.responseType==="text"&&s.responseText&&(y.partialText=s.responseText),o.next(y)},p=g=>{let y={type:Oa.UploadProgress,loaded:g.loaded};g.lengthComputable&&(y.total=g.total),o.next(y)};return s.addEventListener("load",u),s.addEventListener("error",d),s.addEventListener("timeout",d),s.addEventListener("abort",d),n.reportProgress&&(s.addEventListener("progress",f),l!==null&&s.upload&&s.upload.addEventListener("progress",p)),s.send(l),o.next({type:Oa.Sent}),()=>{s.removeEventListener("error",d),s.removeEventListener("abort",d),s.removeEventListener("load",u),s.removeEventListener("timeout",d),n.reportProgress&&(s.removeEventListener("progress",f),l!==null&&s.upload&&s.upload.removeEventListener("progress",p)),s.readyState!==s.DONE&&s.abort()}})))}static \u0275fac=function(t){return new(t||r)(J(Da))};static \u0275prov=W({token:r,factory:r.\u0275fac})}return r})(),ID=new Y(""),$4="XSRF-TOKEN",U4=new Y("",{providedIn:"root",factory:()=>$4}),H4="X-XSRF-TOKEN",z4=new Y("",{providedIn:"root",factory:()=>H4}),Rh=class{},G4=(()=>{class r{doc;platform;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(n,t,i){this.doc=n,this.platform=t,this.cookieName=i}getToken(){if(this.platform==="server")return null;let n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=Ch(n,this.cookieName),this.lastCookieString=n),this.lastToken}static \u0275fac=function(t){return new(t||r)(J(Xt),J(ji),J(U4))};static \u0275prov=W({token:r,factory:r.\u0275fac})}return r})();function W4(r,e){let n=r.url.toLowerCase();if(!V(ID)||r.method==="GET"||r.method==="HEAD"||n.startsWith("http://")||n.startsWith("https://"))return e(r);let t=V(Rh).getToken(),i=V(z4);return t!=null&&!r.headers.has(i)&&(r=r.clone({headers:r.headers.set(i,t)})),e(r)}function OD(...r){let e=[M4,xD,TD,{provide:ec,useExisting:TD},{provide:Ph,useFactory:()=>V(N4,{optional:!0})??V(xD)},{provide:CD,useValue:W4,multi:!0},{provide:ID,useValue:!0},{provide:Rh,useClass:G4}];for(let n of r)e.push(...n.\u0275providers);return ga(e)}var Uy=class extends Dh{supportsDOMEvents=!0},Hy=class r extends Uy{static makeCurrent(){uD(new r)}onAndCancel(e,n,t,i){return e.addEventListener(n,t,i),()=>{e.removeEventListener(n,t,i)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.remove()}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=q4();return n==null?null:Y4(n)}resetBaseElement(){nc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Ch(document.cookie,e)}},nc=null;function q4(){return nc=nc||document.querySelector("base"),nc?nc.getAttribute("href"):null}function Y4(r){return new URL(r,document.baseURI).pathname}var X4=(()=>{class r{build(){return new XMLHttpRequest}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:r.\u0275fac})}return r})(),zy=new Y(""),kD=(()=>{class r{_zone;_plugins;_eventNameToPlugin=new Map;constructor(n,t){this._zone=t,n.forEach(i=>{i.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,t,i,o){return this._findPluginFor(t).addEventListener(n,t,i,o)}getZone(){return this._zone}_findPluginFor(n){let t=this._eventNameToPlugin.get(n);if(t)return t;if(t=this._plugins.find(o=>o.supports(n)),!t)throw new X(5101,!1);return this._eventNameToPlugin.set(n,t),t}static \u0275fac=function(t){return new(t||r)(J(zy),J(at))};static \u0275prov=W({token:r,factory:r.\u0275fac})}return r})(),Fh=class{_doc;constructor(e){this._doc=e}manager},kh="ng-app-id";function AD(r){for(let e of r)e.remove()}function PD(r,e){let n=e.createElement("style");return n.textContent=r,n}function K4(r,e,n,t){let i=r.head?.querySelectorAll(`style[${kh}="${e}"],link[${kh}="${e}"]`);if(i)for(let o of i)o.removeAttribute(kh),o instanceof HTMLLinkElement?t.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&n.set(o.textContent,{usage:0,elements:[o]})}function Gy(r,e){let n=e.createElement("link");return n.setAttribute("rel","stylesheet"),n.setAttribute("href",r),n}var FD=(()=>{class r{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(n,t,i,o={}){this.doc=n,this.appId=t,this.nonce=i,this.isServer=Fy(o),K4(n,t,this.inline,this.external),this.hosts.add(n.head)}addStyles(n,t){for(let i of n)this.addUsage(i,this.inline,PD);t?.forEach(i=>this.addUsage(i,this.external,Gy))}removeStyles(n,t){for(let i of n)this.removeUsage(i,this.inline);t?.forEach(i=>this.removeUsage(i,this.external))}addUsage(n,t,i){let o=t.get(n);o?o.usage++:t.set(n,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,i(n,this.doc)))})}removeUsage(n,t){let i=t.get(n);i&&(i.usage--,i.usage<=0&&(AD(i.elements),t.delete(n)))}ngOnDestroy(){for(let[,{elements:n}]of[...this.inline,...this.external])AD(n);this.hosts.clear()}addHost(n){this.hosts.add(n);for(let[t,{elements:i}]of this.inline)i.push(this.addElement(n,PD(t,this.doc)));for(let[t,{elements:i}]of this.external)i.push(this.addElement(n,Gy(t,this.doc)))}removeHost(n){this.hosts.delete(n)}addElement(n,t){return this.nonce&&t.setAttribute("nonce",this.nonce),this.isServer&&t.setAttribute(kh,this.appId),n.appendChild(t)}static \u0275fac=function(t){return new(t||r)(J(Xt),J(Zm),J(Qm,8),J(ji))};static \u0275prov=W({token:r,factory:r.\u0275fac})}return r})(),$y={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},qy=/%COMP%/g,LD="%COMP%",Z4=`_nghost-${LD}`,J4=`_ngcontent-${LD}`,Q4=!0,e$=new Y("",{providedIn:"root",factory:()=>Q4});function t$(r){return J4.replace(qy,r)}function n$(r){return Z4.replace(qy,r)}function BD(r,e){return e.map(n=>n.replace(qy,r))}var MD=(()=>{class r{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(n,t,i,o,s,l,c,a=null,u=null){this.eventManager=n,this.sharedStylesHost=t,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=l,this.ngZone=c,this.nonce=a,this.tracingService=u,this.platformIsServer=Fy(l),this.defaultRenderer=new rc(n,s,c,this.platformIsServer,this.tracingService)}createRenderer(n,t){if(!n||!t)return this.defaultRenderer;this.platformIsServer&&t.encapsulation===Mr.ShadowDom&&(t=k(C({},t),{encapsulation:Mr.Emulated}));let i=this.getOrCreateRenderer(n,t);return i instanceof Lh?i.applyToHost(n):i instanceof ic&&i.applyStyles(),i}getOrCreateRenderer(n,t){let i=this.rendererByCompId,o=i.get(t.id);if(!o){let s=this.doc,l=this.ngZone,c=this.eventManager,a=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(t.encapsulation){case Mr.Emulated:o=new Lh(c,a,t,this.appId,u,s,l,d,this.tracingService);break;case Mr.ShadowDom:return new Wy(c,a,n,t,s,l,this.nonce,d,this.tracingService);default:o=new ic(c,a,t,u,s,l,d,this.tracingService);break}i.set(t.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(n){this.rendererByCompId.delete(n)}static \u0275fac=function(t){return new(t||r)(J(kD),J(FD),J(Zm),J(e$),J(Xt),J(ji),J(at),J(Qm),J(va,8))};static \u0275prov=W({token:r,factory:r.\u0275fac})}return r})(),rc=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,n,t,i,o){this.eventManager=e,this.doc=n,this.ngZone=t,this.platformIsServer=i,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,n){return n?this.doc.createElementNS($y[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(ND(e)?e.content:e).appendChild(n)}insertBefore(e,n,t){e&&(ND(e)?e.content:e).insertBefore(n,t)}removeChild(e,n){n.remove()}selectRootElement(e,n){let t=typeof e=="string"?this.doc.querySelector(e):e;if(!t)throw new X(-5104,!1);return n||(t.textContent=""),t}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,t,i){if(i){n=i+":"+n;let o=$y[i];o?e.setAttributeNS(o,n,t):e.setAttribute(n,t)}else e.setAttribute(n,t)}removeAttribute(e,n,t){if(t){let i=$y[t];i?e.removeAttributeNS(i,n):e.removeAttribute(`${t}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,t,i){i&(ei.DashCase|ei.Important)?e.style.setProperty(n,t,i&ei.Important?"important":""):e.style[n]=t}removeStyle(e,n,t){t&ei.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,t){e!=null&&(e[n]=t)}setValue(e,n){e.nodeValue=n}listen(e,n,t,i){if(typeof e=="string"&&(e=ci().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);let o=this.decoratePreventDefault(t);return this.tracingService!==null&&this.tracingService.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,n,o)),this.eventManager.addEventListener(e,n,o,i)}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function ND(r){return r.tagName==="TEMPLATE"&&r.content!==void 0}var Wy=class extends rc{sharedStylesHost;hostEl;shadowRoot;constructor(e,n,t,i,o,s,l,c,a){super(e,o,s,c,a),this.sharedStylesHost=n,this.hostEl=t,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=BD(i.id,i.styles);for(let h of u){let f=document.createElement("style");l&&f.setAttribute("nonce",l),f.textContent=h,this.shadowRoot.appendChild(f)}let d=i.getExternalStyles?.();if(d)for(let h of d){let f=Gy(h,o);l&&f.setAttribute("nonce",l),this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,t){return super.insertBefore(this.nodeOrShadowRoot(e),n,t)}removeChild(e,n){return super.removeChild(null,n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},ic=class extends rc{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,n,t,i,o,s,l,c,a){super(e,o,s,l,c),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=a?BD(a,t.styles):t.styles,this.styleUrls=t.getExternalStyles?.(a)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Lh=class extends ic{contentAttr;hostAttr;constructor(e,n,t,i,o,s,l,c,a){let u=i+"-"+t.id;super(e,n,t,o,s,l,c,a,u),this.contentAttr=t$(u),this.hostAttr=n$(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let t=super.createElement(e,n);return super.setAttribute(t,this.contentAttr,""),t}},r$=(()=>{class r extends Fh{constructor(n){super(n)}supports(n){return!0}addEventListener(n,t,i,o){return n.addEventListener(t,i,o),()=>this.removeEventListener(n,t,i,o)}removeEventListener(n,t,i,o){return n.removeEventListener(t,i,o)}static \u0275fac=function(t){return new(t||r)(J(Xt))};static \u0275prov=W({token:r,factory:r.\u0275fac})}return r})(),RD=["alt","control","meta","shift"],i$={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},o$={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey},s$=(()=>{class r extends Fh{constructor(n){super(n)}supports(n){return r.parseEventName(n)!=null}addEventListener(n,t,i,o){let s=r.parseEventName(t),l=r.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ci().onAndCancel(n,s.domEventName,l,o))}static parseEventName(n){let t=n.toLowerCase().split("."),i=t.shift();if(t.length===0||!(i==="keydown"||i==="keyup"))return null;let o=r._normalizeKey(t.pop()),s="",l=t.indexOf("code");if(l>-1&&(t.splice(l,1),s="code."),RD.forEach(a=>{let u=t.indexOf(a);u>-1&&(t.splice(u,1),s+=a+".")}),s+=o,t.length!=0||o.length===0)return null;let c={};return c.domEventName=i,c.fullKey=s,c}static matchEventFullKeyCode(n,t){let i=i$[n.key]||n.key,o="";return t.indexOf("code.")>-1&&(i=n.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),RD.forEach(s=>{if(s!==i){let l=o$[s];l(n)&&(o+=s+".")}}),o+=i,o===t)}static eventCallback(n,t,i){return o=>{r.matchEventFullKeyCode(o,n)&&i.runGuarded(()=>t(o))}}static _normalizeKey(n){return n==="esc"?"escape":n}static \u0275fac=function(t){return new(t||r)(J(Xt))};static \u0275prov=W({token:r,factory:r.\u0275fac})}return r})();function jD(r,e){return nD(C({rootComponent:r},a$(e)))}function a$(r){return{appProviders:[...h$,...r?.providers??[]],platformProviders:d$}}function l$(){Hy.makeCurrent()}function c$(){return new Qr}function u$(){return oE(document),document}var d$=[{provide:ji,useValue:gD},{provide:Jm,useValue:l$,multi:!0},{provide:Xt,useFactory:u$,deps:[]}];var h$=[{provide:nh,useValue:"root"},{provide:Qr,useFactory:c$,deps:[]},{provide:zy,useClass:r$,multi:!0,deps:[Xt,at,ji]},{provide:zy,useClass:s$,multi:!0,deps:[Xt]},MD,FD,kD,{provide:ha,useExisting:MD},{provide:Da,useClass:X4,deps:[]},[]];var VD=(()=>{class r{_doc;constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static \u0275fac=function(t){return new(t||r)(J(Xt))};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var de="primary",vc=Symbol("RouteTitle"),Jy=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function ka(r){return new Jy(r)}function p$(r,e,n){let t=n.path.split("/");if(t.length>r.length||n.pathMatch==="full"&&(e.hasChildren()||t.length<r.length))return null;let i={};for(let o=0;o<t.length;o++){let s=t[o],l=r[o];if(s[0]===":")i[s.substring(1)]=l;else if(s!==l.path)return null}return{consumed:r.slice(0,t.length),posParams:i}}function g$(r,e){if(r.length!==e.length)return!1;for(let n=0;n<r.length;++n)if(!kr(r[n],e[n]))return!1;return!0}function kr(r,e){let n=r?Qy(r):void 0,t=e?Qy(e):void 0;if(!n||!t||n.length!=t.length)return!1;let i;for(let o=0;o<n.length;o++)if(i=n[o],!KD(r[i],e[i]))return!1;return!0}function Qy(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}function KD(r,e){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;let n=[...r].sort(),t=[...e].sort();return n.every((i,o)=>t[o]===i)}else return r===e}function ZD(r){return r.length>0?r[r.length-1]:null}function qi(r){return Dg(r)?r:$i(r)?Xe(Promise.resolve(r)):ee(r)}var m$={exact:QD,subset:eC},JD={exact:y$,subset:v$,ignored:()=>!0};function $D(r,e,n){return m$[n.paths](r.root,e.root,n.matrixParams)&&JD[n.queryParams](r.queryParams,e.queryParams)&&!(n.fragment==="exact"&&r.fragment!==e.fragment)}function y$(r,e){return kr(r,e)}function QD(r,e,n){if(!Ho(r.segments,e.segments)||!Vh(r.segments,e.segments,n)||r.numberOfChildren!==e.numberOfChildren)return!1;for(let t in e.children)if(!r.children[t]||!QD(r.children[t],e.children[t],n))return!1;return!0}function v$(r,e){return Object.keys(e).length<=Object.keys(r).length&&Object.keys(e).every(n=>KD(r[n],e[n]))}function eC(r,e,n){return tC(r,e,e.segments,n)}function tC(r,e,n,t){if(r.segments.length>n.length){let i=r.segments.slice(0,n.length);return!(!Ho(i,n)||e.hasChildren()||!Vh(i,n,t))}else if(r.segments.length===n.length){if(!Ho(r.segments,n)||!Vh(r.segments,n,t))return!1;for(let i in e.children)if(!r.children[i]||!eC(r.children[i],e.children[i],t))return!1;return!0}else{let i=n.slice(0,r.segments.length),o=n.slice(r.segments.length);return!Ho(r.segments,i)||!Vh(r.segments,i,t)||!r.children[de]?!1:tC(r.children[de],e,o,t)}}function Vh(r,e,n){return e.every((t,i)=>JD[n](r[i].parameters,t.parameters))}var fi=class{root;queryParams;fragment;_queryParamMap;constructor(e=new Fe([],{}),n={},t=null){this.root=e,this.queryParams=n,this.fragment=t}get queryParamMap(){return this._queryParamMap??=ka(this.queryParams),this._queryParamMap}toString(){return _$.serialize(this)}},Fe=class{segments;children;parent=null;constructor(e,n){this.segments=e,this.children=n,Object.values(n).forEach(t=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return $h(this)}},Uo=class{path;parameters;_parameterMap;constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=ka(this.parameters),this._parameterMap}toString(){return rC(this)}};function b$(r,e){return Ho(r,e)&&r.every((n,t)=>kr(n.parameters,e[t].parameters))}function Ho(r,e){return r.length!==e.length?!1:r.every((n,t)=>n.path===e[t].path)}function w$(r,e){let n=[];return Object.entries(r.children).forEach(([t,i])=>{t===de&&(n=n.concat(e(i,t)))}),Object.entries(r.children).forEach(([t,i])=>{t!==de&&(n=n.concat(e(i,t)))}),n}var bc=(()=>{class r{static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:()=>new Fa,providedIn:"root"})}return r})(),Fa=class{parse(e){let n=new tv(e);return new fi(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${oc(e.root,!0)}`,t=S$(e.queryParams),i=typeof e.fragment=="string"?`#${T$(e.fragment)}`:"";return`${n}${t}${i}`}},_$=new Fa;function $h(r){return r.segments.map(e=>rC(e)).join("/")}function oc(r,e){if(!r.hasChildren())return $h(r);if(e){let n=r.children[de]?oc(r.children[de],!1):"",t=[];return Object.entries(r.children).forEach(([i,o])=>{i!==de&&t.push(`${i}:${oc(o,!1)}`)}),t.length>0?`${n}(${t.join("//")})`:n}else{let n=w$(r,(t,i)=>i===de?[oc(r.children[de],!1)]:[`${i}:${oc(t,!1)}`]);return Object.keys(r.children).length===1&&r.children[de]!=null?`${$h(r)}/${n[0]}`:`${$h(r)}/(${n.join("//")})`}}function nC(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Bh(r){return nC(r).replace(/%3B/gi,";")}function T$(r){return encodeURI(r)}function ev(r){return nC(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Uh(r){return decodeURIComponent(r)}function UD(r){return Uh(r.replace(/\+/g,"%20"))}function rC(r){return`${ev(r.path)}${x$(r.parameters)}`}function x$(r){return Object.entries(r).map(([e,n])=>`;${ev(e)}=${ev(n)}`).join("")}function S$(r){let e=Object.entries(r).map(([n,t])=>Array.isArray(t)?t.map(i=>`${Bh(n)}=${Bh(i)}`).join("&"):`${Bh(n)}=${Bh(t)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var E$=/^[^\/()?;#]+/;function Yy(r){let e=r.match(E$);return e?e[0]:""}var D$=/^[^\/()?;=#]+/;function C$(r){let e=r.match(D$);return e?e[0]:""}var I$=/^[^=?&#]+/;function O$(r){let e=r.match(I$);return e?e[0]:""}var A$=/^[^&#]+/;function P$(r){let e=r.match(A$);return e?e[0]:""}var tv=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Fe([],{}):new Fe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let t={};return this.peekStartsWith("(")&&(t=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(t[de]=new Fe(e,n)),t}parseSegment(){let e=Yy(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new X(4009,!1);return this.capture(e),new Uo(Uh(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=C$(this.remaining);if(!n)return;this.capture(n);let t="";if(this.consumeOptional("=")){let i=Yy(this.remaining);i&&(t=i,this.capture(t))}e[Uh(n)]=Uh(t)}parseQueryParam(e){let n=O$(this.remaining);if(!n)return;this.capture(n);let t="";if(this.consumeOptional("=")){let s=P$(this.remaining);s&&(t=s,this.capture(t))}let i=UD(n),o=UD(t);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let t=Yy(this.remaining),i=this.remaining[t.length];if(i!=="/"&&i!==")"&&i!==";")throw new X(4010,!1);let o;t.indexOf(":")>-1?(o=t.slice(0,t.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=de);let s=this.parseChildren();n[o]=Object.keys(s).length===1?s[de]:new Fe([],s),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new X(4011,!1)}};function iC(r){return r.segments.length>0?new Fe([],{[de]:r}):r}function oC(r){let e={};for(let[t,i]of Object.entries(r.children)){let o=oC(i);if(t===de&&o.segments.length===0&&o.hasChildren())for(let[s,l]of Object.entries(o.children))e[s]=l;else(o.segments.length>0||o.hasChildren())&&(e[t]=o)}let n=new Fe(r.segments,e);return M$(n)}function M$(r){if(r.numberOfChildren===1&&r.children[de]){let e=r.children[de];return new Fe(r.segments.concat(e.segments),e.children)}return r}function zo(r){return r instanceof fi}function N$(r,e,n=null,t=null){let i=sC(r);return aC(i,e,n,t)}function sC(r){let e;function n(o){let s={};for(let c of o.children){let a=n(c);s[c.outlet]=a}let l=new Fe(o.url,s);return o===r&&(e=l),l}let t=n(r.root),i=iC(t);return e??i}function aC(r,e,n,t){let i=r;for(;i.parent;)i=i.parent;if(e.length===0)return Xy(i,i,i,n,t);let o=R$(e);if(o.toRoot())return Xy(i,i,new Fe([],{}),n,t);let s=k$(o,i,r),l=s.processChildren?ac(s.segmentGroup,s.index,o.commands):cC(s.segmentGroup,s.index,o.commands);return Xy(i,s.segmentGroup,l,n,t)}function Hh(r){return typeof r=="object"&&r!=null&&!r.outlets&&!r.segmentPath}function uc(r){return typeof r=="object"&&r!=null&&r.outlets}function Xy(r,e,n,t,i){let o={};t&&Object.entries(t).forEach(([c,a])=>{o[c]=Array.isArray(a)?a.map(u=>`${u}`):`${a}`});let s;r===e?s=n:s=lC(r,e,n);let l=iC(oC(s));return new fi(l,o,i)}function lC(r,e,n){let t={};return Object.entries(r.children).forEach(([i,o])=>{o===e?t[i]=n:t[i]=lC(o,e,n)}),new Fe(r.segments,t)}var zh=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,n,t){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=t,e&&t.length>0&&Hh(t[0]))throw new X(4003,!1);let i=t.find(uc);if(i&&i!==ZD(t))throw new X(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function R$(r){if(typeof r[0]=="string"&&r.length===1&&r[0]==="/")return new zh(!0,0,r);let e=0,n=!1,t=r.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let l={};return Object.entries(o.outlets).forEach(([c,a])=>{l[c]=typeof a=="string"?a.split("/"):a}),[...i,{outlets:l}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((l,c)=>{c==0&&l==="."||(c==0&&l===""?n=!0:l===".."?e++:l!=""&&i.push(l))}),i):[...i,o]},[]);return new zh(n,e,t)}var Ma=class{segmentGroup;processChildren;index;constructor(e,n,t){this.segmentGroup=e,this.processChildren=n,this.index=t}};function k$(r,e,n){if(r.isAbsolute)return new Ma(e,!0,0);if(!n)return new Ma(e,!1,NaN);if(n.parent===null)return new Ma(n,!0,0);let t=Hh(r.commands[0])?0:1,i=n.segments.length-1+t;return F$(n,i,r.numberOfDoubleDots)}function F$(r,e,n){let t=r,i=e,o=n;for(;o>i;){if(o-=i,t=t.parent,!t)throw new X(4005,!1);i=t.segments.length}return new Ma(t,!1,i-o)}function L$(r){return uc(r[0])?r[0].outlets:{[de]:r}}function cC(r,e,n){if(r??=new Fe([],{}),r.segments.length===0&&r.hasChildren())return ac(r,e,n);let t=B$(r,e,n),i=n.slice(t.commandIndex);if(t.match&&t.pathIndex<r.segments.length){let o=new Fe(r.segments.slice(0,t.pathIndex),{});return o.children[de]=new Fe(r.segments.slice(t.pathIndex),r.children),ac(o,0,i)}else return t.match&&i.length===0?new Fe(r.segments,{}):t.match&&!r.hasChildren()?nv(r,e,n):t.match?ac(r,0,i):nv(r,e,n)}function ac(r,e,n){if(n.length===0)return new Fe(r.segments,{});{let t=L$(n),i={};if(Object.keys(t).some(o=>o!==de)&&r.children[de]&&r.numberOfChildren===1&&r.children[de].segments.length===0){let o=ac(r.children[de],e,n);return new Fe(r.segments,o.children)}return Object.entries(t).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=cC(r.children[o],e,s))}),Object.entries(r.children).forEach(([o,s])=>{t[o]===void 0&&(i[o]=s)}),new Fe(r.segments,i)}}function B$(r,e,n){let t=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<r.segments.length;){if(t>=n.length)return o;let s=r.segments[i],l=n[t];if(uc(l))break;let c=`${l}`,a=t<n.length-1?n[t+1]:null;if(i>0&&c===void 0)break;if(c&&a&&typeof a=="object"&&a.outlets===void 0){if(!zD(c,a,s))return o;t+=2}else{if(!zD(c,{},s))return o;t++}i++}return{match:!0,pathIndex:i,commandIndex:t}}function nv(r,e,n){let t=r.segments.slice(0,e),i=0;for(;i<n.length;){let o=n[i];if(uc(o)){let c=j$(o.outlets);return new Fe(t,c)}if(i===0&&Hh(n[0])){let c=r.segments[e];t.push(new Uo(c.path,HD(n[0]))),i++;continue}let s=uc(o)?o.outlets[de]:`${o}`,l=i<n.length-1?n[i+1]:null;s&&l&&Hh(l)?(t.push(new Uo(s,HD(l))),i+=2):(t.push(new Uo(s,{})),i++)}return new Fe(t,{})}function j$(r){let e={};return Object.entries(r).forEach(([n,t])=>{typeof t=="string"&&(t=[t]),t!==null&&(e[n]=nv(new Fe([],{}),0,t))}),e}function HD(r){let e={};return Object.entries(r).forEach(([n,t])=>e[n]=`${t}`),e}function zD(r,e,n){return r==n.path&&kr(e,n.parameters)}var lc="imperative",Nt=function(r){return r[r.NavigationStart=0]="NavigationStart",r[r.NavigationEnd=1]="NavigationEnd",r[r.NavigationCancel=2]="NavigationCancel",r[r.NavigationError=3]="NavigationError",r[r.RoutesRecognized=4]="RoutesRecognized",r[r.ResolveStart=5]="ResolveStart",r[r.ResolveEnd=6]="ResolveEnd",r[r.GuardsCheckStart=7]="GuardsCheckStart",r[r.GuardsCheckEnd=8]="GuardsCheckEnd",r[r.RouteConfigLoadStart=9]="RouteConfigLoadStart",r[r.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",r[r.ChildActivationStart=11]="ChildActivationStart",r[r.ChildActivationEnd=12]="ChildActivationEnd",r[r.ActivationStart=13]="ActivationStart",r[r.ActivationEnd=14]="ActivationEnd",r[r.Scroll=15]="Scroll",r[r.NavigationSkipped=16]="NavigationSkipped",r}(Nt||{}),Wn=class{id;url;constructor(e,n){this.id=e,this.url=n}},La=class extends Wn{type=Nt.NavigationStart;navigationTrigger;restoredState;constructor(e,n,t="imperative",i=null){super(e,n),this.navigationTrigger=t,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},qn=class extends Wn{urlAfterRedirects;type=Nt.NavigationEnd;constructor(e,n,t){super(e,n),this.urlAfterRedirects=t}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Mn=function(r){return r[r.Redirect=0]="Redirect",r[r.SupersededByNewNavigation=1]="SupersededByNewNavigation",r[r.NoDataFromResolver=2]="NoDataFromResolver",r[r.GuardRejected=3]="GuardRejected",r}(Mn||{}),Gh=function(r){return r[r.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",r[r.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",r}(Gh||{}),hi=class extends Wn{reason;code;type=Nt.NavigationCancel;constructor(e,n,t,i){super(e,n),this.reason=t,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Gi=class extends Wn{reason;code;type=Nt.NavigationSkipped;constructor(e,n,t,i){super(e,n),this.reason=t,this.code=i}},dc=class extends Wn{error;target;type=Nt.NavigationError;constructor(e,n,t,i){super(e,n),this.error=t,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Wh=class extends Wn{urlAfterRedirects;state;type=Nt.RoutesRecognized;constructor(e,n,t,i){super(e,n),this.urlAfterRedirects=t,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},rv=class extends Wn{urlAfterRedirects;state;type=Nt.GuardsCheckStart;constructor(e,n,t,i){super(e,n),this.urlAfterRedirects=t,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},iv=class extends Wn{urlAfterRedirects;state;shouldActivate;type=Nt.GuardsCheckEnd;constructor(e,n,t,i,o){super(e,n),this.urlAfterRedirects=t,this.state=i,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},ov=class extends Wn{urlAfterRedirects;state;type=Nt.ResolveStart;constructor(e,n,t,i){super(e,n),this.urlAfterRedirects=t,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},sv=class extends Wn{urlAfterRedirects;state;type=Nt.ResolveEnd;constructor(e,n,t,i){super(e,n),this.urlAfterRedirects=t,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},av=class{route;type=Nt.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},lv=class{route;type=Nt.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},cv=class{snapshot;type=Nt.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},uv=class{snapshot;type=Nt.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},dv=class{snapshot;type=Nt.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},hv=class{snapshot;type=Nt.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},qh=class{routerEvent;position;anchor;type=Nt.Scroll;constructor(e,n,t){this.routerEvent=e,this.position=n,this.anchor=t}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},hc=class{},Ba=class{url;navigationBehaviorOptions;constructor(e,n){this.url=e,this.navigationBehaviorOptions=n}};function V$(r,e){return r.providers&&!r._injector&&(r._injector=_h(r.providers,e,`Route: ${r.path}`)),r._injector??e}function gr(r){return r.outlet||de}function $$(r,e){let n=r.filter(t=>gr(t)===e);return n.push(...r.filter(t=>gr(t)!==e)),n}function wc(r){if(!r)return null;if(r.routeConfig?._injector)return r.routeConfig._injector;for(let e=r.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var fv=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return wc(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new _c(this.rootInjector)}},_c=(()=>{class r{rootInjector;contexts=new Map;constructor(n){this.rootInjector=n}onChildOutletCreated(n,t){let i=this.getOrCreateContext(n);i.outlet=t,this.contexts.set(n,i)}onChildOutletDestroyed(n){let t=this.getContext(n);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let t=this.getContext(n);return t||(t=new fv(this.rootInjector),this.contexts.set(n,t)),t}getContext(n){return this.contexts.get(n)||null}static \u0275fac=function(t){return new(t||r)(J(on))};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Yh=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=pv(e,this._root);return n?n.children.map(t=>t.value):[]}firstChild(e){let n=pv(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=gv(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return gv(e,this._root).map(n=>n.value)}};function pv(r,e){if(r===e.value)return e;for(let n of e.children){let t=pv(r,n);if(t)return t}return null}function gv(r,e){if(r===e.value)return[e];for(let n of e.children){let t=gv(r,n);if(t.length)return t.unshift(e),t}return[]}var Pn=class{value;children;constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function Pa(r){let e={};return r&&r.children.forEach(n=>e[n.value.outlet]=n),e}var Xh=class extends Yh{snapshot;constructor(e,n){super(e),this.snapshot=n,Sv(this,e)}toString(){return this.snapshot.toString()}};function uC(r){let e=U$(r),n=new st([new Uo("",{})]),t=new st({}),i=new st({}),o=new st({}),s=new st(""),l=new Wi(n,t,o,s,i,de,r,e.root);return l.snapshot=e.root,new Xh(new Pn(l,[]),e)}function U$(r){let e={},n={},t={},i="",o=new Na([],e,t,i,n,de,r,null,{});return new Zh("",new Pn(o,[]))}var Wi=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,n,t,i,o,s,l,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=t,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=l,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(ue(a=>a[vc]))??ee(void 0),this.url=e,this.params=n,this.queryParams=t,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ue(e=>ka(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ue(e=>ka(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Kh(r,e,n="emptyOnly"){let t,{routeConfig:i}=r;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?t={params:C(C({},e.params),r.params),data:C(C({},e.data),r.data),resolve:C(C(C(C({},r.data),e.data),i?.data),r._resolvedData)}:t={params:C({},r.params),data:C({},r.data),resolve:C(C({},r.data),r._resolvedData??{})},i&&hC(i)&&(t.resolve[vc]=i.title),t}var Na=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[vc]}constructor(e,n,t,i,o,s,l,c,a){this.url=e,this.params=n,this.queryParams=t,this.fragment=i,this.data=o,this.outlet=s,this.component=l,this.routeConfig=c,this._resolve=a}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ka(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ka(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(t=>t.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},Zh=class extends Yh{url;constructor(e,n){super(n),this.url=e,Sv(this,n)}toString(){return dC(this._root)}};function Sv(r,e){e.value._routerState=r,e.children.forEach(n=>Sv(r,n))}function dC(r){let e=r.children.length>0?` { ${r.children.map(dC).join(", ")} } `:"";return`${r.value}${e}`}function Ky(r){if(r.snapshot){let e=r.snapshot,n=r._futureSnapshot;r.snapshot=n,kr(e.queryParams,n.queryParams)||r.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&r.fragmentSubject.next(n.fragment),kr(e.params,n.params)||r.paramsSubject.next(n.params),g$(e.url,n.url)||r.urlSubject.next(n.url),kr(e.data,n.data)||r.dataSubject.next(n.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function mv(r,e){let n=kr(r.params,e.params)&&b$(r.url,e.url),t=!r.parent!=!e.parent;return n&&!t&&(!r.parent||mv(r.parent,e.parent))}function hC(r){return typeof r.title=="string"||r.title===null}var H$=new Y(""),Ev=(()=>{class r{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=de;activateEvents=new $t;deactivateEvents=new $t;attachEvents=new $t;detachEvents=new $t;routerOutletData=ZS(void 0);parentContexts=V(_c);location=V(ba);changeDetector=V(Ui);inputBinder=V(tf,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(n){if(n.name){let{firstChange:t,previousValue:i}=n.name;if(t)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new X(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new X(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new X(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,t){this.activated=n,this._activatedRoute=t,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,t){if(this.isActivated)throw new X(4013,!1);this._activatedRoute=n;let i=this.location,s=n.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,c=new yv(n,l,i.injector,this.routerOutletData);this.activated=i.createComponent(s,{index:i.length,injector:c,environmentInjector:t}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(t){return new(t||r)};static \u0275dir=Ut({type:r,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Fo]})}return r})(),yv=class r{route;childContexts;parent;outletData;__ngOutletInjector(e){return new r(this.route,this.childContexts,e,this.outletData)}constructor(e,n,t,i){this.route=e,this.childContexts=n,this.parent=t,this.outletData=i}get(e,n){return e===Wi?this.route:e===_c?this.childContexts:e===H$?this.outletData:this.parent.get(e,n)}},tf=new Y(""),GD=(()=>{class r{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){let{activatedRoute:t}=n,i=Rl([t.queryParams,t.params,t.data]).pipe(gn(([o,s,l],c)=>(l=C(C(C({},o),s),l),c===0?ee(l):Promise.resolve(l)))).subscribe(o=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==t||t.component===null){this.unsubscribeFromRouteData(n);return}let s=rD(t.component);if(!s){this.unsubscribeFromRouteData(n);return}for(let{templateName:l}of s.inputs)n.activatedComponentRef.setInput(l,o[l])});this.outletDataSubscriptions.set(n,i)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:r.\u0275fac})}return r})();function z$(r,e,n){let t=fc(r,e._root,n?n._root:void 0);return new Xh(t,e)}function fc(r,e,n){if(n&&r.shouldReuseRoute(e.value,n.value.snapshot)){let t=n.value;t._futureSnapshot=e.value;let i=G$(r,e,n);return new Pn(t,i)}else{if(r.shouldAttach(e.value)){let o=r.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(l=>fc(r,l)),s}}let t=W$(e.value),i=e.children.map(o=>fc(r,o));return new Pn(t,i)}}function G$(r,e,n){return e.children.map(t=>{for(let i of n.children)if(r.shouldReuseRoute(t.value,i.value.snapshot))return fc(r,t,i);return fc(r,t)})}function W$(r){return new Wi(new st(r.url),new st(r.params),new st(r.queryParams),new st(r.fragment),new st(r.data),r.outlet,r.component,r)}var pc=class{redirectTo;navigationBehaviorOptions;constructor(e,n){this.redirectTo=e,this.navigationBehaviorOptions=n}},fC="ngNavigationCancelingError";function Jh(r,e){let{redirectTo:n,navigationBehaviorOptions:t}=zo(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=pC(!1,Mn.Redirect);return i.url=n,i.navigationBehaviorOptions=t,i}function pC(r,e){let n=new Error(`NavigationCancelingError: ${r||""}`);return n[fC]=!0,n.cancellationCode=e,n}function q$(r){return gC(r)&&zo(r.url)}function gC(r){return!!r&&r[fC]}var Y$=(r,e,n,t)=>ue(i=>(new vv(e,i.targetRouterState,i.currentRouterState,n,t).activate(r),i)),vv=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,n,t,i,o){this.routeReuseStrategy=e,this.futureState=n,this.currState=t,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let n=this.futureState._root,t=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,t,e),Ky(this.futureState.root),this.activateChildRoutes(n,t,e)}deactivateChildRoutes(e,n,t){let i=Pa(n);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],t),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,t)})}deactivateRoutes(e,n,t){let i=e.value,o=n?n.value:null;if(i===o)if(i.component){let s=t.getContext(i.outlet);s&&this.deactivateChildRoutes(e,n,s.children)}else this.deactivateChildRoutes(e,n,t);else o&&this.deactivateRouteAndItsChildren(n,t)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let t=n.getContext(e.value.outlet),i=t&&e.value.component?t.children:n,o=Pa(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(t&&t.outlet){let s=t.outlet.detach(),l=t.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:l})}}deactivateRouteAndOutlet(e,n){let t=n.getContext(e.value.outlet),i=t&&e.value.component?t.children:n,o=Pa(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);t&&(t.outlet&&(t.outlet.deactivate(),t.children.onOutletDeactivated()),t.attachRef=null,t.route=null)}activateChildRoutes(e,n,t){let i=Pa(n);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],t),this.forwardEvent(new hv(o.value.snapshot))}),e.children.length&&this.forwardEvent(new uv(e.value.snapshot))}activateRoutes(e,n,t){let i=e.value,o=n?n.value:null;if(Ky(i),i===o)if(i.component){let s=t.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,s.children)}else this.activateChildRoutes(e,n,t);else if(i.component){let s=t.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let l=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(l.contexts),s.attachRef=l.componentRef,s.route=l.route.value,s.outlet&&s.outlet.attach(l.componentRef,l.route.value),Ky(l.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,t)}},Qh=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ra=class{component;route;constructor(e,n){this.component=e,this.route=n}};function X$(r,e,n){let t=r._root,i=e?e._root:null;return sc(t,i,n,[t.value])}function K$(r){let e=r.routeConfig?r.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:r,guards:e}}function Va(r,e){let n=Symbol(),t=e.get(r,n);return t===n?typeof r=="function"&&!Gx(r)?r:e.get(r):t}function sc(r,e,n,t,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=Pa(e);return r.children.forEach(s=>{Z$(s,o[s.value.outlet],n,t.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,l])=>cc(l,n.getContext(s),i)),i}function Z$(r,e,n,t,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=r.value,s=e?e.value:null,l=n?n.getContext(r.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let c=J$(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Qh(t)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?sc(r,e,l?l.children:null,t,i):sc(r,e,n,t,i),c&&l&&l.outlet&&l.outlet.isActivated&&i.canDeactivateChecks.push(new Ra(l.outlet.component,s))}else s&&cc(e,l,i),i.canActivateChecks.push(new Qh(t)),o.component?sc(r,null,l?l.children:null,t,i):sc(r,null,n,t,i);return i}function J$(r,e,n){if(typeof n=="function")return n(r,e);switch(n){case"pathParamsChange":return!Ho(r.url,e.url);case"pathParamsOrQueryParamsChange":return!Ho(r.url,e.url)||!kr(r.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!mv(r,e)||!kr(r.queryParams,e.queryParams);case"paramsChange":default:return!mv(r,e)}}function cc(r,e,n){let t=Pa(r),i=r.value;Object.entries(t).forEach(([o,s])=>{i.component?e?cc(s,e.children.getContext(o),n):cc(s,null,n):cc(s,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new Ra(e.outlet.component,i)):n.canDeactivateChecks.push(new Ra(null,i)):n.canDeactivateChecks.push(new Ra(null,i))}function Tc(r){return typeof r=="function"}function Q$(r){return typeof r=="boolean"}function eU(r){return r&&Tc(r.canLoad)}function tU(r){return r&&Tc(r.canActivate)}function nU(r){return r&&Tc(r.canActivateChild)}function rU(r){return r&&Tc(r.canDeactivate)}function iU(r){return r&&Tc(r.canMatch)}function mC(r){return r instanceof Yr||r?.name==="EmptyError"}var jh=Symbol("INITIAL_VALUE");function ja(){return gn(r=>Rl(r.map(e=>e.pipe(Kr(1),Pg(jh)))).pipe(ue(e=>{for(let n of e)if(n!==!0){if(n===jh)return jh;if(n===!1||oU(n))return n}return!0}),Vt(e=>e!==jh),Kr(1)))}function oU(r){return zo(r)||r instanceof pc}function sU(r,e){return bt(n=>{let{targetSnapshot:t,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=n;return s.length===0&&o.length===0?ee(k(C({},n),{guardsResult:!0})):aU(s,t,i,r).pipe(bt(l=>l&&Q$(l)?lU(t,o,r,e):ee(l)),ue(l=>k(C({},n),{guardsResult:l})))})}function aU(r,e,n,t){return Xe(r).pipe(bt(i=>fU(i.component,i.route,n,e,t)),Zr(i=>i!==!0,!0))}function lU(r,e,n,t){return Xe(e).pipe(Xr(i=>qs(uU(i.route.parent,t),cU(i.route,t),hU(r,i.path,n),dU(r,i.route,n))),Zr(i=>i!==!0,!0))}function cU(r,e){return r!==null&&e&&e(new dv(r)),ee(!0)}function uU(r,e){return r!==null&&e&&e(new cv(r)),ee(!0)}function dU(r,e,n){let t=e.routeConfig?e.routeConfig.canActivate:null;if(!t||t.length===0)return ee(!0);let i=t.map(o=>md(()=>{let s=wc(e)??n,l=Va(o,s),c=tU(l)?l.canActivate(e,r):yn(s,()=>l(e,r));return qi(c).pipe(Zr())}));return ee(i).pipe(ja())}function hU(r,e,n){let t=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>K$(s)).filter(s=>s!==null).map(s=>md(()=>{let l=s.guards.map(c=>{let a=wc(s.node)??n,u=Va(c,a),d=nU(u)?u.canActivateChild(t,r):yn(a,()=>u(t,r));return qi(d).pipe(Zr())});return ee(l).pipe(ja())}));return ee(o).pipe(ja())}function fU(r,e,n,t,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return ee(!0);let s=o.map(l=>{let c=wc(e)??i,a=Va(l,c),u=rU(a)?a.canDeactivate(r,e,n,t):yn(c,()=>a(r,e,n,t));return qi(u).pipe(Zr())});return ee(s).pipe(ja())}function pU(r,e,n,t){let i=e.canLoad;if(i===void 0||i.length===0)return ee(!0);let o=i.map(s=>{let l=Va(s,r),c=eU(l)?l.canLoad(e,n):yn(r,()=>l(e,n));return qi(c)});return ee(o).pipe(ja(),yC(t))}function yC(r){return _g(Pt(e=>{if(typeof e!="boolean")throw Jh(r,e)}),ue(e=>e===!0))}function gU(r,e,n,t){let i=e.canMatch;if(!i||i.length===0)return ee(!0);let o=i.map(s=>{let l=Va(s,r),c=iU(l)?l.canMatch(e,n):yn(r,()=>l(e,n));return qi(c)});return ee(o).pipe(ja(),yC(t))}var gc=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},mc=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function Aa(r){return Gs(new gc(r))}function mU(r){return Gs(new X(4e3,!1))}function yU(r){return Gs(pC(!1,Mn.GuardRejected))}var bv=class{urlSerializer;urlTree;constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let t=[],i=n.root;for(;;){if(t=t.concat(i.segments),i.numberOfChildren===0)return ee(t);if(i.numberOfChildren>1||!i.children[de])return mU(`${e.redirectTo}`);i=i.children[de]}}applyRedirectCommands(e,n,t,i,o){if(typeof n!="string"){let l=n,{queryParams:c,fragment:a,routeConfig:u,url:d,outlet:h,params:f,data:p,title:g}=i,y=yn(o,()=>l({params:f,data:p,queryParams:c,fragment:a,routeConfig:u,url:d,outlet:h,title:g}));if(y instanceof fi)throw new mc(y);n=y}let s=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,t);if(n[0]==="/")throw new mc(s);return s}applyRedirectCreateUrlTree(e,n,t,i){let o=this.createSegmentGroup(e,n.root,t,i);return new fi(o,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let t={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let l=o.substring(1);t[i]=n[l]}else t[i]=o}),t}createSegmentGroup(e,n,t,i){let o=this.createSegments(e,n.segments,t,i),s={};return Object.entries(n.children).forEach(([l,c])=>{s[l]=this.createSegmentGroup(e,c,t,i)}),new Fe(o,s)}createSegments(e,n,t,i){return n.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,t))}findPosParam(e,n,t){let i=t[n.path.substring(1)];if(!i)throw new X(4001,!1);return i}findOrReturn(e,n){let t=0;for(let i of n){if(i.path===e.path)return n.splice(t),i;t++}return e}},wv={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function vU(r,e,n,t,i){let o=vC(r,e,n);return o.matched?(t=V$(e,t),gU(t,e,n,i).pipe(ue(s=>s===!0?o:C({},wv)))):ee(o)}function vC(r,e,n){if(e.path==="**")return bU(n);if(e.path==="")return e.pathMatch==="full"&&(r.hasChildren()||n.length>0)?C({},wv):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||p$)(n,r,e);if(!i)return C({},wv);let o={};Object.entries(i.posParams??{}).forEach(([l,c])=>{o[l]=c.path});let s=i.consumed.length>0?C(C({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function bU(r){return{matched:!0,parameters:r.length>0?ZD(r).parameters:{},consumedSegments:r,remainingSegments:[],positionalParamSegments:{}}}function WD(r,e,n,t){return n.length>0&&TU(r,n,t)?{segmentGroup:new Fe(e,_U(t,new Fe(n,r.children))),slicedSegments:[]}:n.length===0&&xU(r,n,t)?{segmentGroup:new Fe(r.segments,wU(r,n,t,r.children)),slicedSegments:n}:{segmentGroup:new Fe(r.segments,r.children),slicedSegments:n}}function wU(r,e,n,t){let i={};for(let o of n)if(nf(r,e,o)&&!t[gr(o)]){let s=new Fe([],{});i[gr(o)]=s}return C(C({},t),i)}function _U(r,e){let n={};n[de]=e;for(let t of r)if(t.path===""&&gr(t)!==de){let i=new Fe([],{});n[gr(t)]=i}return n}function TU(r,e,n){return n.some(t=>nf(r,e,t)&&gr(t)!==de)}function xU(r,e,n){return n.some(t=>nf(r,e,t))}function nf(r,e,n){return(r.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function SU(r,e,n){return e.length===0&&!r.children[n]}var _v=class{};function EU(r,e,n,t,i,o,s="emptyOnly"){return new Tv(r,e,n,t,i,s,o).recognize()}var DU=31,Tv=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,n,t,i,o,s,l){this.injector=e,this.configLoader=n,this.rootComponentType=t,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=l,this.applyRedirects=new bv(this.urlSerializer,this.urlTree)}noMatchError(e){return new X(4002,`'${e.segmentGroup}'`)}recognize(){let e=WD(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(ue(({children:n,rootSnapshot:t})=>{let i=new Pn(t,n),o=new Zh("",i),s=N$(t,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let n=new Na([],Object.freeze({}),Object.freeze(C({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),de,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,de,n).pipe(ue(t=>({children:t,rootSnapshot:n})),Ei(t=>{if(t instanceof mc)return this.urlTree=t.urlTree,this.match(t.urlTree.root);throw t instanceof gc?this.noMatchError(t):t}))}processSegmentGroup(e,n,t,i,o){return t.segments.length===0&&t.hasChildren()?this.processChildren(e,n,t,o):this.processSegment(e,n,t,t.segments,i,!0,o).pipe(ue(s=>s instanceof Pn?[s]:[]))}processChildren(e,n,t,i){let o=[];for(let s of Object.keys(t.children))s==="primary"?o.unshift(s):o.push(s);return Xe(o).pipe(Xr(s=>{let l=t.children[s],c=$$(n,s);return this.processSegmentGroup(e,c,l,s,i)}),Ag((s,l)=>(s.push(...l),s)),Di(null),Og(),bt(s=>{if(s===null)return Aa(t);let l=bC(s);return CU(l),ee(l)}))}processSegment(e,n,t,i,o,s,l){return Xe(n).pipe(Xr(c=>this.processSegmentAgainstRoute(c._injector??e,n,c,t,i,o,s,l).pipe(Ei(a=>{if(a instanceof gc)return ee(null);throw a}))),Zr(c=>!!c),Ei(c=>{if(mC(c))return SU(t,i,o)?ee(new _v):Aa(t);throw c}))}processSegmentAgainstRoute(e,n,t,i,o,s,l,c){return gr(t)!==s&&(s===de||!nf(i,o,t))?Aa(i):t.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,t,o,s,c):this.allowRedirects&&l?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,t,o,s,c):Aa(i)}expandSegmentAgainstRouteUsingRedirect(e,n,t,i,o,s,l){let{matched:c,parameters:a,consumedSegments:u,positionalParamSegments:d,remainingSegments:h}=vC(n,i,o);if(!c)return Aa(n);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>DU&&(this.allowRedirects=!1));let f=new Na(o,a,Object.freeze(C({},this.urlTree.queryParams)),this.urlTree.fragment,qD(i),gr(i),i.component??i._loadedComponent??null,i,YD(i)),p=Kh(f,l,this.paramsInheritanceStrategy);f.params=Object.freeze(p.params),f.data=Object.freeze(p.data);let g=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,d,f,e);return this.applyRedirects.lineralizeSegments(i,g).pipe(bt(y=>this.processSegment(e,t,n,y.concat(h),s,!1,l)))}matchSegmentAgainstRoute(e,n,t,i,o,s){let l=vU(n,t,i,e,this.urlSerializer);return t.path==="**"&&(n.children={}),l.pipe(gn(c=>c.matched?(e=t._injector??e,this.getChildConfig(e,t,i).pipe(gn(({routes:a})=>{let u=t._loadedInjector??e,{parameters:d,consumedSegments:h,remainingSegments:f}=c,p=new Na(h,d,Object.freeze(C({},this.urlTree.queryParams)),this.urlTree.fragment,qD(t),gr(t),t.component??t._loadedComponent??null,t,YD(t)),g=Kh(p,s,this.paramsInheritanceStrategy);p.params=Object.freeze(g.params),p.data=Object.freeze(g.data);let{segmentGroup:y,slicedSegments:w}=WD(n,h,f,a);if(w.length===0&&y.hasChildren())return this.processChildren(u,a,y,p).pipe(ue(x=>new Pn(p,x)));if(a.length===0&&w.length===0)return ee(new Pn(p,[]));let v=gr(t)===o;return this.processSegment(u,a,y,w,v?de:o,!0,p).pipe(ue(x=>new Pn(p,x instanceof Pn?[x]:[])))}))):Aa(n)))}getChildConfig(e,n,t){return n.children?ee({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?ee({routes:n._loadedRoutes,injector:n._loadedInjector}):pU(e,n,t,this.urlSerializer).pipe(bt(i=>i?this.configLoader.loadChildren(e,n).pipe(Pt(o=>{n._loadedRoutes=o.routes,n._loadedInjector=o.injector})):yU(n))):ee({routes:[],injector:e})}};function CU(r){r.sort((e,n)=>e.value.outlet===de?-1:n.value.outlet===de?1:e.value.outlet.localeCompare(n.value.outlet))}function IU(r){let e=r.value.routeConfig;return e&&e.path===""}function bC(r){let e=[],n=new Set;for(let t of r){if(!IU(t)){e.push(t);continue}let i=e.find(o=>t.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...t.children),n.add(i)):e.push(t)}for(let t of n){let i=bC(t.children);e.push(new Pn(t.value,i))}return e.filter(t=>!n.has(t))}function qD(r){return r.data||{}}function YD(r){return r.resolve||{}}function OU(r,e,n,t,i,o){return bt(s=>EU(r,e,n,t,s.extractedUrl,i,o).pipe(ue(({state:l,tree:c})=>k(C({},s),{targetSnapshot:l,urlAfterRedirects:c}))))}function AU(r,e){return bt(n=>{let{targetSnapshot:t,guards:{canActivateChecks:i}}=n;if(!i.length)return ee(n);let o=new Set(i.map(c=>c.route)),s=new Set;for(let c of o)if(!s.has(c))for(let a of wC(c))s.add(a);let l=0;return Xe(s).pipe(Xr(c=>o.has(c)?PU(c,t,r,e):(c.data=Kh(c,c.parent,r).resolve,ee(void 0))),Pt(()=>l++),Ys(1),bt(c=>l===s.size?ee(n):En))})}function wC(r){let e=r.children.map(n=>wC(n)).flat();return[r,...e]}function PU(r,e,n,t){let i=r.routeConfig,o=r._resolve;return i?.title!==void 0&&!hC(i)&&(o[vc]=i.title),MU(o,r,e,t).pipe(ue(s=>(r._resolvedData=s,r.data=Kh(r,r.parent,n).resolve,null)))}function MU(r,e,n,t){let i=Qy(r);if(i.length===0)return ee({});let o={};return Xe(i).pipe(bt(s=>NU(r[s],e,n,t).pipe(Zr(),Pt(l=>{if(l instanceof pc)throw Jh(new Fa,l);o[s]=l}))),Ys(1),ue(()=>o),Ei(s=>mC(s)?En:Gs(s)))}function NU(r,e,n,t){let i=wc(e)??t,o=Va(r,i),s=o.resolve?o.resolve(e,n):yn(i,()=>o(e,n));return qi(s)}function Zy(r){return gn(e=>{let n=r(e);return n?Xe(n).pipe(ue(()=>e)):ee(e)})}var _C=(()=>{class r{buildTitle(n){let t,i=n.root;for(;i!==void 0;)t=this.getResolvedTitleForRoute(i)??t,i=i.children.find(o=>o.outlet===de);return t}getResolvedTitleForRoute(n){return n.data[vc]}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:()=>V(RU),providedIn:"root"})}return r})(),RU=(()=>{class r extends _C{title;constructor(n){super(),this.title=n}updateTitle(n){let t=this.buildTitle(n);t!==void 0&&this.title.setTitle(t)}static \u0275fac=function(t){return new(t||r)(J(VD))};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),xc=new Y("",{providedIn:"root",factory:()=>({})}),kU=(()=>{class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=Nr({type:r,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(t,i){t&1&&et(0,"router-outlet")},dependencies:[Ev],encapsulation:2})}return r})();function Dv(r){let e=r.children&&r.children.map(Dv),n=e?k(C({},r),{children:e}):C({},r);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==de&&(n.component=kU),n}var yc=new Y(""),Cv=(()=>{class r{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=V(Sh);loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return ee(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);let t=qi(n.loadComponent()).pipe(ue(TC),Pt(o=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=o}),Co(()=>{this.componentLoaders.delete(n)})),i=new Hs(t,()=>new Dt).pipe(Us());return this.componentLoaders.set(n,i),i}loadChildren(n,t){if(this.childrenLoaders.get(t))return this.childrenLoaders.get(t);if(t._loadedRoutes)return ee({routes:t._loadedRoutes,injector:t._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(t);let o=FU(t,this.compiler,n,this.onLoadEndListener).pipe(Co(()=>{this.childrenLoaders.delete(t)})),s=new Hs(o,()=>new Dt).pipe(Us());return this.childrenLoaders.set(t,s),s}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function FU(r,e,n,t){return qi(r.loadChildren()).pipe(ue(TC),bt(i=>i instanceof Ul||Array.isArray(i)?ee(i):Xe(e.compileModuleAsync(i))),ue(i=>{t&&t(r);let o,s,l=!1;return Array.isArray(i)?(s=i,l=!0):(o=i.create(n).injector,s=o.get(yc,[],{optional:!0,self:!0}).flat()),{routes:s.map(Dv),injector:o}}))}function LU(r){return r&&typeof r=="object"&&"default"in r}function TC(r){return LU(r)?r.default:r}var Iv=(()=>{class r{static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:()=>V(BU),providedIn:"root"})}return r})(),BU=(()=>{class r{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,t){return n}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),xC=new Y(""),SC=new Y("");function jU(r,e,n){let t=r.get(SC),i=r.get(Xt);return r.get(at).runOutsideAngular(()=>{if(!i.startViewTransition||t.skipNextTransition)return t.skipNextTransition=!1,new Promise(a=>setTimeout(a));let o,s=new Promise(a=>{o=a}),l=i.startViewTransition(()=>(o(),VU(r))),{onViewTransitionCreated:c}=t;return c&&yn(r,()=>c({transition:l,from:e,to:n})),s})}function VU(r){return new Promise(e=>{ty({read:()=>setTimeout(e)},{injector:r})})}var EC=new Y(""),Ov=(()=>{class r{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new Dt;transitionAbortSubject=new Dt;configLoader=V(Cv);environmentInjector=V(on);urlSerializer=V(bc);rootContexts=V(_c);location=V(Hi);inputBindingEnabled=V(tf,{optional:!0})!==null;titleStrategy=V(_C);options=V(xc,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=V(Iv);createViewTransition=V(xC,{optional:!0});navigationErrorHandler=V(EC,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>ee(void 0);rootComponentType=null;constructor(){let n=i=>this.events.next(new av(i)),t=i=>this.events.next(new lv(i));this.configLoader.onLoadEndListener=t,this.configLoader.onLoadStartListener=n}complete(){this.transitions?.complete()}handleNavigationRequest(n){let t=++this.navigationId;this.transitions?.next(k(C(C({},this.transitions.value),n),{id:t}))}setupNavigations(n,t,i){return this.transitions=new st({id:0,currentUrlTree:t,currentRawUrl:t,extractedUrl:this.urlHandlingStrategy.extract(t),urlAfterRedirects:this.urlHandlingStrategy.extract(t),rawUrl:t,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:lc,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Vt(o=>o.id!==0),ue(o=>k(C({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),gn(o=>{let s=!1,l=!1;return ee(o).pipe(gn(c=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Mn.SupersededByNewNavigation),En;this.currentTransition=o,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:typeof c.extras.browserUrl=="string"?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?k(C({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let a=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),u=c.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!a&&u!=="reload"){let d="";return this.events.next(new Gi(c.id,this.urlSerializer.serialize(c.rawUrl),d,Gh.IgnoredSameUrlNavigation)),c.resolve(!1),En}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return ee(c).pipe(gn(d=>{let h=this.transitions?.getValue();return this.events.next(new La(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),h!==this.transitions?.getValue()?En:Promise.resolve(d)}),OU(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),Pt(d=>{o.targetSnapshot=d.targetSnapshot,o.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation=k(C({},this.currentNavigation),{finalUrl:d.urlAfterRedirects});let h=new Wh(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}));if(a&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:d,extractedUrl:h,source:f,restoredState:p,extras:g}=c,y=new La(d,this.urlSerializer.serialize(h),f,p);this.events.next(y);let w=uC(this.rootComponentType).snapshot;return this.currentTransition=o=k(C({},c),{targetSnapshot:w,urlAfterRedirects:h,extras:k(C({},g),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=h,ee(o)}else{let d="";return this.events.next(new Gi(c.id,this.urlSerializer.serialize(c.extractedUrl),d,Gh.IgnoredByUrlHandlingStrategy)),c.resolve(!1),En}}),Pt(c=>{let a=new rv(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(a)}),ue(c=>(this.currentTransition=o=k(C({},c),{guards:X$(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),sU(this.environmentInjector,c=>this.events.next(c)),Pt(c=>{if(o.guardsResult=c.guardsResult,c.guardsResult&&typeof c.guardsResult!="boolean")throw Jh(this.urlSerializer,c.guardsResult);let a=new iv(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(a)}),Vt(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",Mn.GuardRejected),!1)),Zy(c=>{if(c.guards.canActivateChecks.length)return ee(c).pipe(Pt(a=>{let u=new ov(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(u)}),gn(a=>{let u=!1;return ee(a).pipe(AU(this.paramsInheritanceStrategy,this.environmentInjector),Pt({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(a,"",Mn.NoDataFromResolver)}}))}),Pt(a=>{let u=new sv(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(u)}))}),Zy(c=>{let a=u=>{let d=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(u.routeConfig).pipe(Pt(h=>{u.component=h}),ue(()=>{})));for(let h of u.children)d.push(...a(h));return d};return Rl(a(c.targetSnapshot.root)).pipe(Di(null),Kr(1))}),Zy(()=>this.afterPreactivation()),gn(()=>{let{currentSnapshot:c,targetSnapshot:a}=o,u=this.createViewTransition?.(this.environmentInjector,c.root,a.root);return u?Xe(u).pipe(ue(()=>o)):ee(o)}),ue(c=>{let a=z$(n.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=k(C({},c),{targetRouterState:a}),this.currentNavigation.targetRouterState=a,o}),Pt(()=>{this.events.next(new hc)}),Y$(this.rootContexts,n.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Kr(1),Pt({next:c=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new qn(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{s=!0}}),Mg(this.transitionAbortSubject.pipe(Pt(c=>{throw c}))),Co(()=>{!s&&!l&&this.cancelNavigationTransition(o,"",Mn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Ei(c=>{if(l=!0,gC(c))this.events.next(new hi(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),q$(c)?this.events.next(new Ba(c.url,c.navigationBehaviorOptions)):o.resolve(!1);else{let a=new dc(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0);try{let u=yn(this.environmentInjector,()=>this.navigationErrorHandler?.(a));if(u instanceof pc){let{message:d,cancellationCode:h}=Jh(this.urlSerializer,u);this.events.next(new hi(o.id,this.urlSerializer.serialize(o.extractedUrl),d,h)),this.events.next(new Ba(u.redirectTo,u.navigationBehaviorOptions))}else throw this.events.next(a),c}catch(u){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(u)}}return En}))}))}cancelNavigationTransition(n,t,i){let o=new hi(n.id,this.urlSerializer.serialize(n.extractedUrl),t,i);this.events.next(o),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let n=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),t=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return n.toString()!==t?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function $U(r){return r!==lc}var UU=(()=>{class r{static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:()=>V(HU),providedIn:"root"})}return r})(),xv=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},HU=(()=>{class r extends xv{static \u0275fac=(()=>{let n;return function(i){return(n||(n=Li(r)))(i||r)}})();static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),DC=(()=>{class r{static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:()=>V(zU),providedIn:"root"})}return r})(),zU=(()=>{class r extends DC{location=V(Hi);urlSerializer=V(bc);options=V(xc,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";urlHandlingStrategy=V(Iv);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new fi;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}routerState=uC(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(t=>{t.type==="popstate"&&n(t.url,t.state)})}handleRouterEvent(n,t){if(n instanceof La)this.stateMemento=this.createStateMemento();else if(n instanceof Gi)this.rawUrlTree=t.initialUrl;else if(n instanceof Wh){if(this.urlUpdateStrategy==="eager"&&!t.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(t.finalUrl,t.initialUrl);this.setBrowserUrl(t.targetBrowserUrl??i,t)}}else n instanceof hc?(this.currentUrlTree=t.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(t.finalUrl,t.initialUrl),this.routerState=t.targetRouterState,this.urlUpdateStrategy==="deferred"&&!t.extras.skipLocationChange&&this.setBrowserUrl(t.targetBrowserUrl??this.rawUrlTree,t)):n instanceof hi&&(n.code===Mn.GuardRejected||n.code===Mn.NoDataFromResolver)?this.restoreHistory(t):n instanceof dc?this.restoreHistory(t,!0):n instanceof qn&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,t){let i=n instanceof fi?this.urlSerializer.serialize(n):n;if(this.location.isCurrentPathEqualTo(i)||t.extras.replaceUrl){let o=this.browserPageId,s=C(C({},t.extras.state),this.generateNgRouterState(t.id,o));this.location.replaceState(i,"",s)}else{let o=C(C({},t.extras.state),this.generateNgRouterState(t.id,this.browserPageId+1));this.location.go(i,"",o)}}restoreHistory(n,t=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.currentUrlTree===n.finalUrl&&o===0&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(t&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,t){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:t}:{navigationId:n}}static \u0275fac=(()=>{let n;return function(i){return(n||(n=Li(r)))(i||r)}})();static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function CC(r,e){r.events.pipe(Vt(n=>n instanceof qn||n instanceof hi||n instanceof dc||n instanceof Gi),ue(n=>n instanceof qn||n instanceof Gi?0:(n instanceof hi?n.code===Mn.Redirect||n.code===Mn.SupersededByNewNavigation:!1)?2:1),Vt(n=>n!==2),Kr(1)).subscribe(()=>{e()})}var GU={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},WU={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Yn=(()=>{class r{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=V(vy);stateManager=V(DC);options=V(xc,{optional:!0})||{};pendingTasks=V(Bi);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=V(Ov);urlSerializer=V(bc);location=V(Hi);urlHandlingStrategy=V(Iv);_events=new Dt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=V(UU);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=V(yc,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!V(tf,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}eventsSubscription=new ot;subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(t=>{try{let i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(t,o),t instanceof hi&&t.code!==Mn.Redirect&&t.code!==Mn.SupersededByNewNavigation)this.navigated=!0;else if(t instanceof qn)this.navigated=!0;else if(t instanceof Ba){let s=t.navigationBehaviorOptions,l=this.urlHandlingStrategy.merge(t.url,i.currentRawUrl),c=C({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||$U(i.source)},s);this.scheduleNavigation(l,lc,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}YU(t)&&this._events.next(t)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),lc,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,t)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",t)},0)})}navigateToSyncWithBrowser(n,t,i){let o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){let c=C({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let l=this.parseUrl(n);this.scheduleNavigation(l,t,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(Dv),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,t={}){let{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:l,preserveFragment:c}=t,a=c?this.currentUrlTree.fragment:s,u=null;switch(l??this.options.defaultQueryParamsHandling){case"merge":u=C(C({},this.currentUrlTree.queryParams),o);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=o||null}u!==null&&(u=this.removeEmptyProps(u));let d;try{let h=i?i.snapshot:this.routerState.snapshot.root;d=sC(h)}catch{(typeof n[0]!="string"||n[0][0]!=="/")&&(n=[]),d=this.currentUrlTree.root}return aC(d,n,u,a??null)}navigateByUrl(n,t={skipLocationChange:!1}){let i=zo(n)?n:this.parseUrl(n),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,lc,null,t)}navigate(n,t={skipLocationChange:!1}){return qU(n),this.navigateByUrl(this.createUrlTree(n,t),t)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,t){let i;if(t===!0?i=C({},GU):t===!1?i=C({},WU):i=t,zo(n))return $D(this.currentUrlTree,n,i);let o=this.parseUrl(n);return $D(this.currentUrlTree,o,i)}removeEmptyProps(n){return Object.entries(n).reduce((t,[i,o])=>(o!=null&&(t[i]=o),t),{})}scheduleNavigation(n,t,i,o,s){if(this.disposed)return Promise.resolve(!1);let l,c,a;s?(l=s.resolve,c=s.reject,a=s.promise):a=new Promise((d,h)=>{l=d,c=h});let u=this.pendingTasks.add();return CC(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:t,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:o,resolve:l,reject:c,promise:a,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),a.catch(d=>Promise.reject(d))}static \u0275fac=function(t){return new(t||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function qU(r){for(let e=0;e<r.length;e++)if(r[e]==null)throw new X(4008,!1)}function YU(r){return!(r instanceof hc)&&!(r instanceof Ba)}var IC=(()=>{class r{router;route;tabIndexAttribute;renderer;el;locationStrategy;href=null;target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new Dt;constructor(n,t,i,o,s,l){this.router=n,this.route=t,this.tabIndexAttribute=i,this.renderer=o,this.el=s,this.locationStrategy=l;let c=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area",this.isAnchorElement?this.subscription=n.events.subscribe(a=>{a instanceof qn&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(n){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(n){n==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(zo(n)?this.routerLinkInput=n:this.routerLinkInput=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0"))}onClick(n,t,i,o,s){let l=this.urlTree;if(l===null||this.isAnchorElement&&(n!==0||t||i||o||s||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(l,c),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let n=this.urlTree;this.href=n!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(n)):null;let t=this.href===null?null:uE(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(n,t){let i=this.renderer,o=this.el.nativeElement;t!==null?i.setAttribute(o,n,t):i.removeAttribute(o,n)}get urlTree(){return this.routerLinkInput===null?null:zo(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(t){return new(t||r)(se(Yn),se(Wi),qm("tabindex"),se(Vi),se(oi),se(ui))};static \u0275dir=Ut({type:r,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(t,i){t&1&&Mt("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),t&2&&Kl("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Vo],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Vo],replaceUrl:[2,"replaceUrl","replaceUrl",Vo],routerLink:"routerLink"},features:[yy,Fo]})}return r})();var ef=class{};var XU=(()=>{class r{router;injector;preloadingStrategy;loader;subscription;constructor(n,t,i,o,s){this.router=n,this.injector=i,this.preloadingStrategy=o,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(Vt(n=>n instanceof qn),Xr(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,t){let i=[];for(let o of t){o.providers&&!o._injector&&(o._injector=_h(o.providers,n,`Route: ${o.path}`));let s=o._injector??n,l=o._loadedInjector??s;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&i.push(this.preloadConfig(s,o)),(o.children||o._loadedRoutes)&&i.push(this.processRoutes(l,o.children??o._loadedRoutes))}return Xe(i).pipe(Ws())}preloadConfig(n,t){return this.preloadingStrategy.preload(t,()=>{let i;t.loadChildren&&t.canLoad===void 0?i=this.loader.loadChildren(n,t):i=ee(null);let o=i.pipe(bt(s=>s===null?ee(void 0):(t._loadedRoutes=s.routes,t._loadedInjector=s.injector,this.processRoutes(s.injector??n,s.routes))));if(t.loadComponent&&!t._loadedComponent){let s=this.loader.loadComponent(t);return Xe([o,s]).pipe(Ws())}else return o})}static \u0275fac=function(t){return new(t||r)(J(Yn),J(Sh),J(on),J(ef),J(Cv))};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),OC=new Y(""),KU=(()=>{class r{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(n,t,i,o,s={}){this.urlSerializer=n,this.transitions=t,this.viewportScroller=i,this.zone=o,this.options=s,s.scrollPositionRestoration||="disabled",s.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof La?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof qn?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof Gi&&n.code===Gh.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof qh&&(n.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(n.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,t){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new qh(n,this.lastSource==="popstate"?this.store[this.restoredId]:null,t))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(t){mE()};static \u0275prov=W({token:r,factory:r.\u0275fac})}return r})();function AC(r,...e){return ga([{provide:yc,multi:!0,useValue:r},[],{provide:Wi,useFactory:PC,deps:[Yn]},{provide:Xl,multi:!0,useFactory:MC},e.map(n=>n.\u0275providers)])}function PC(r){return r.routerState.root}function Sc(r,e){return{\u0275kind:r,\u0275providers:e}}function MC(){let r=V(In);return e=>{let n=r.get(ti);if(e!==n.components[0])return;let t=r.get(Yn),i=r.get(NC);r.get(Av)===1&&t.initialNavigation(),r.get(RC,null,pe.Optional)?.setUpPreloading(),r.get(OC,null,pe.Optional)?.init(),t.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var NC=new Y("",{factory:()=>new Dt}),Av=new Y("",{providedIn:"root",factory:()=>1});function ZU(){return Sc(2,[{provide:Av,useValue:0},{provide:Th,multi:!0,deps:[In],useFactory:e=>{let n=e.get(dD,Promise.resolve());return()=>n.then(()=>new Promise(t=>{let i=e.get(Yn),o=e.get(NC);CC(i,()=>{t(!0)}),e.get(Ov).afterPreactivation=()=>(t(!0),o.closed?ee(void 0):o),i.initialNavigation()}))}}])}function JU(){return Sc(3,[{provide:Th,multi:!0,useFactory:()=>{let e=V(Yn);return()=>{e.setUpLocationChangeListener()}}},{provide:Av,useValue:2}])}var RC=new Y("");function QU(r){return Sc(0,[{provide:RC,useExisting:XU},{provide:ef,useExisting:r}])}function Pv(){return Sc(8,[GD,{provide:tf,useExisting:GD}])}function eH(r){let e=[{provide:xC,useValue:jU},{provide:SC,useValue:C({skipNextTransition:!!r?.skipInitialTransition},r)}];return Sc(9,e)}var tH=[Hi,{provide:bc,useClass:Fa},Yn,_c,{provide:Wi,useFactory:PC,deps:[Yn]},Cv,[]],rf=(()=>{class r{constructor(){}static forRoot(n,t){return{ngModule:r,providers:[tH,[],{provide:yc,multi:!0,useValue:n},[],t?.errorHandler?{provide:EC,useValue:t.errorHandler}:[],{provide:xc,useValue:t||{}},t?.useHash?rH():iH(),nH(),t?.preloadingStrategy?QU(t.preloadingStrategy).\u0275providers:[],t?.initialNavigation?oH(t):[],t?.bindToComponentInputs?Pv().\u0275providers:[],t?.enableViewTransitions?eH().\u0275providers:[],sH()]}}static forChild(n){return{ngModule:r,providers:[{provide:yc,multi:!0,useValue:n}]}}static \u0275fac=function(t){return new(t||r)};static \u0275mod=si({type:r});static \u0275inj=ni({})}return r})();function nH(){return{provide:OC,useFactory:()=>{let r=V(mD),e=V(at),n=V(xc),t=V(Ov),i=V(bc);return n.scrollOffset&&r.setOffset(n.scrollOffset),new KU(i,t,r,e,n)}}}function rH(){return{provide:ui,useClass:fD}}function iH(){return{provide:ui,useClass:ky}}function oH(r){return[r.initialNavigation==="disabled"?JU().\u0275providers:[],r.initialNavigation==="enabledBlocking"?ZU().\u0275providers:[]]}var XD=new Y("");function sH(){return[{provide:XD,useFactory:MC},{provide:Xl,multi:!0,useExisting:XD}]}function D(r,e,n){return(e=function(t){var i=function(o,s){if(typeof o!="object"||!o)return o;var l=o[Symbol.toPrimitive];if(l!==void 0){var c=l.call(o,s||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(o)}(t,"string");return typeof i=="symbol"?i:i+""}(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function kC(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),n.push.apply(n,t)}return n}function E(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?kC(Object(n),!0).forEach(function(t){D(r,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):kC(Object(n)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(n,t))})}return r}function nt(r,e){if(r==null)return{};var n,t,i=function(s,l){if(s==null)return{};var c={};for(var a in s)if({}.hasOwnProperty.call(s,a)){if(l.indexOf(a)>=0)continue;c[a]=s[a]}return c}(r,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(t=0;t<o.length;t++)n=o[t],e.indexOf(n)>=0||{}.propertyIsEnumerable.call(r,n)&&(i[n]=r[n])}return i}function io(r,e){return e||(e=r.slice(0)),Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(e)}}))}var pf=class{constructor(){D(this,"browserShadowBlurConstant",1),D(this,"DPI",96),D(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),D(this,"perfLimitSizeTotal",2097152),D(this,"maxCacheSideLimit",4096),D(this,"minCacheSideLimit",256),D(this,"disableStyleCopyPaste",!1),D(this,"enableGLFiltering",!0),D(this,"textureSize",4096),D(this,"forceGLPutImageData",!1),D(this,"cachesBoundsOfCurve",!1),D(this,"fontPaths",{}),D(this,"NUM_FRACTION_DIGITS",4)}},Oe=new class extends pf{constructor(r){super(),this.configure(r)}configure(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,r)}addFonts(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=E(E({},this.fontPaths),r)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(r=>{delete this.fontPaths[r]})}clearFonts(){this.fontPaths={}}restoreDefaults(r){let e=new pf,n=r?.reduce((t,i)=>(t[i]=e[i],t),{})||e;this.configure(n)}},eo=function(r){for(var e=arguments.length,n=new Array(e>1?e-1:0),t=1;t<e;t++)n[t-1]=arguments[t];return console[r]("fabric",...n)},Qn=class extends Error{constructor(e,n){super("fabric: ".concat(e),n)}},gf=class extends Qn{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}},Gv=class{},Wv=class extends Gv{testPrecision(e,n){let t="precision ".concat(n,` float;
void main(){}`),i=e.createShader(e.FRAGMENT_SHADER);return!!i&&(e.shaderSource(i,t),e.compileShader(i),!!e.getShaderParameter(i,e.COMPILE_STATUS))}queryWebGL(e){let n=e.getContext("webgl");n&&(this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(t=>this.testPrecision(n,t)),n.getExtension("WEBGL_lose_context").loseContext(),eo("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}},aH={},FC;var jr=()=>FC||(FC={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new Wv,dispose(){},copyPasteData:aH}),rl=()=>jr().document,Uf=()=>jr().window,d1=()=>{var r;return Math.max((r=Oe.devicePixelRatio)!==null&&r!==void 0?r:Uf().devicePixelRatio,1)},Ic=new class{constructor(){D(this,"charWidthsCache",{}),D(this,"boundsOfCurveCache",{})}getFontCache(r){let{fontFamily:e,fontStyle:n,fontWeight:t}=r;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});let i=this.charWidthsCache[e],o="".concat(n.toLowerCase(),"_").concat((t+"").toLowerCase());return i[o]||(i[o]={}),i[o]}clearFontCache(r){(r=(r||"").toLowerCase())?this.charWidthsCache[r]&&delete this.charWidthsCache[r]:this.charWidthsCache={}}limitDimsByArea(r){let{perfLimitSizeTotal:e}=Oe,n=Math.sqrt(e*r);return[Math.floor(n),Math.floor(e/n)]}},qv="6.5.4";function ds(){}var to=Math.PI/2,vi=2*Math.PI,xb=Math.PI/180,cn=Object.freeze([1,0,0,1,0,0]),Sb=16,Yi=.4477152502,he="center",Le="left",vn="top",Yv="bottom",pt="right",bn="none",Eb=/\r?\n/,h1="moving",Hf="scaling",f1="rotating",Db="rotate",p1="skewing",Rc="resizing",g1="modifyPoly",lH="modifyPath",mf="changed",zf="scale",un="scaleX",kn="scaleY",il="skewX",ol="skewY",Ot="fill",wn="stroke",yf="modified",$a="json",Nv="svg",G=new class{constructor(){this[$a]=new Map,this[Nv]=new Map}has(r){return this[$a].has(r)}getClass(r){let e=this[$a].get(r);if(!e)throw new Qn("No class registered for ".concat(r));return e}setClass(r,e){e?this[$a].set(e,r):(this[$a].set(r.type,r),this[$a].set(r.type.toLowerCase(),r))}getSVGClass(r){return this[Nv].get(r)}setSVGClass(r,e){this[Nv].set(e??r.type.toLowerCase(),r)}},vf=new class extends Array{remove(r){let e=this.indexOf(r);e>-1&&this.splice(e,1)}cancelAll(){let r=this.splice(0);return r.forEach(e=>e.abort()),r}cancelByCanvas(r){if(!r)return[];let e=this.filter(n=>{var t;return n.target===r||typeof n.target=="object"&&((t=n.target)===null||t===void 0?void 0:t.canvas)===r});return e.forEach(n=>n.abort()),e}cancelByTarget(r){if(!r)return[];let e=this.filter(n=>n.target===r);return e.forEach(n=>n.abort()),e}},Xv=class{constructor(){D(this,"__eventListeners",{})}on(e,n){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(t=>{let[i,o]=t;this.on(i,o)}),()=>this.off(e);if(n){let t=e;return this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(n),()=>this.off(t,n)}return()=>!1}once(e,n){if(typeof e=="object"){let t=[];return Object.entries(e).forEach(i=>{let[o,s]=i;t.push(this.once(o,s))}),()=>t.forEach(i=>i())}if(n){let t=this.on(e,function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];n.call(this,...o),t()});return t}return()=>!1}_removeEventListener(e,n){if(this.__eventListeners[e])if(n){let t=this.__eventListeners[e],i=t.indexOf(n);i>-1&&t.splice(i,1)}else this.__eventListeners[e]=[]}off(e,n){if(this.__eventListeners)if(e===void 0)for(let t in this.__eventListeners)this._removeEventListener(t);else typeof e=="object"?Object.entries(e).forEach(t=>{let[i,o]=t;this._removeEventListener(i,o)}):this._removeEventListener(e,n)}fire(e,n){var t;if(!this.__eventListeners)return;let i=(t=this.__eventListeners[e])===null||t===void 0?void 0:t.concat();if(i)for(let o=0;o<i.length;o++)i[o].call(this,n||{})}},Go=(r,e)=>{let n=r.indexOf(e);return n!==-1&&r.splice(n,1),r},_r=r=>{if(r===0)return 1;switch(Math.abs(r)/to){case 1:case 3:return 0;case 2:return-1}return Math.cos(r)},Tr=r=>{if(r===0)return 0;let e=r/to,n=Math.sign(r);switch(e){case 1:return n;case 2:return 0;case 3:return-n}return Math.sin(r)},M=class r{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=n)}add(e){return new r(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new r(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new r(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new r(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new r(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new r(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new r(this.x/e.x,this.y/e.y)}scalarDivide(e){return new r(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return n=Math.max(Math.min(1,n),0),new r(this.x+(e.x-this.x)*n,this.y+(e.y-this.y)*n)}distanceFrom(e){let n=this.x-e.x,t=this.y-e.y;return Math.sqrt(n*n+t*t)}midPointFrom(e){return this.lerp(e)}min(e){return new r(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new r(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,n){return this.x=e,this.y=n,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){let n=this.x,t=this.y;this.x=e.x,this.y=e.y,e.x=n,e.y=t}clone(){return new r(this.x,this.y)}rotate(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cb,t=Tr(e),i=_r(e),o=this.subtract(n);return new r(o.x*i-o.y*t,o.x*t+o.y*i).add(n)}transform(e){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new r(e[0]*this.x+e[2]*this.y+(n?0:e[4]),e[1]*this.x+e[3]*this.y+(n?0:e[5]))}},Cb=new M(0,0),hf=r=>!!r&&Array.isArray(r._objects);function m1(r){class e extends r{constructor(){super(...arguments),D(this,"_objects",[])}_onObjectAdded(t){}_onObjectRemoved(t){}_onStackOrderChanged(t){}add(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];let s=this._objects.push(...i);return i.forEach(l=>this._onObjectAdded(l)),s}insertAt(t){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return this._objects.splice(t,0,...o),o.forEach(l=>this._onObjectAdded(l)),this._objects.length}remove(){let t=this._objects,i=[];for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return s.forEach(c=>{let a=t.indexOf(c);a!==-1&&(t.splice(a,1),i.push(c),this._onObjectRemoved(c))}),i}forEachObject(t){this.getObjects().forEach((i,o,s)=>t(i,o,s))}getObjects(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return i.length===0?[...this._objects]:this._objects.filter(s=>s.isType(...i))}item(t){return this._objects[t]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(t,i){return!!this._objects.includes(t)||!!i&&this._objects.some(o=>o instanceof e&&o.contains(t,!0))}complexity(){return this._objects.reduce((t,i)=>t+=i.complexity?i.complexity():0,0)}sendObjectToBack(t){return!(!t||t===this._objects[0])&&(Go(this._objects,t),this._objects.unshift(t),this._onStackOrderChanged(t),!0)}bringObjectToFront(t){return!(!t||t===this._objects[this._objects.length-1])&&(Go(this._objects,t),this._objects.push(t),this._onStackOrderChanged(t),!0)}sendObjectBackwards(t,i){if(!t)return!1;let o=this._objects.indexOf(t);if(o!==0){let s=this.findNewLowerIndex(t,o,i);return Go(this._objects,t),this._objects.splice(s,0,t),this._onStackOrderChanged(t),!0}return!1}bringObjectForward(t,i){if(!t)return!1;let o=this._objects.indexOf(t);if(o!==this._objects.length-1){let s=this.findNewUpperIndex(t,o,i);return Go(this._objects,t),this._objects.splice(s,0,t),this._onStackOrderChanged(t),!0}return!1}moveObjectTo(t,i){return t!==this._objects[i]&&(Go(this._objects,t),this._objects.splice(i,0,t),this._onStackOrderChanged(t),!0)}findNewLowerIndex(t,i,o){let s;if(o){s=i;for(let l=i-1;l>=0;--l)if(t.isOverlapping(this._objects[l])){s=l;break}}else s=i-1;return s}findNewUpperIndex(t,i,o){let s;if(o){s=i;for(let l=i+1;l<this._objects.length;++l)if(t.isOverlapping(this._objects[l])){s=l;break}}else s=i+1;return s}collectObjects(t){let{left:i,top:o,width:s,height:l}=t,{includeIntersecting:c=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=[],u=new M(i,o),d=u.add(new M(s,l));for(let h=this._objects.length-1;h>=0;h--){let f=this._objects[h];f.selectable&&f.visible&&(c&&f.intersectsWithRect(u,d)||f.isContainedWithinRect(u,d)||c&&f.containsPoint(u)||c&&f.containsPoint(d))&&a.push(f)}return a}}return e}var bf=class extends Xv{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(let n in e)this.set(n,e[n])}_setObject(e){for(let n in e)this._set(n,e[n])}set(e,n){return typeof e=="object"?this._setObject(e):this._set(e,n),this}_set(e,n){this[e]=n}toggle(e){let n=this.get(e);return typeof n=="boolean"&&this.set(e,!n),this}get(e){return this[e]}};function Oc(r){return Uf().requestAnimationFrame(r)}function y1(r){return Uf().cancelAnimationFrame(r)}var cH=0,no=()=>cH++,er=()=>{let r=rl().createElement("canvas");if(!r||r.getContext===void 0)throw new Qn("Failed to create `canvas` element");return r},v1=()=>rl().createElement("img"),xr=r=>{let e=er();return e.width=r.width,e.height=r.height,e},Ib=(r,e,n)=>r.toDataURL("image/".concat(e),n),lt=r=>r*xb,ro=r=>r/xb,b1=r=>r.every((e,n)=>e===cn[n]),Kt=(r,e,n)=>new M(r).transform(e,n),Rn=r=>{let e=1/(r[0]*r[3]-r[1]*r[2]),n=[e*r[3],-e*r[1],-e*r[2],e*r[0],0,0],{x:t,y:i}=new M(r[4],r[5]).transform(n,!0);return n[4]=-t,n[5]=-i,n},ct=(r,e,n)=>[r[0]*e[0]+r[2]*e[1],r[1]*e[0]+r[3]*e[1],r[0]*e[2]+r[2]*e[3],r[1]*e[2]+r[3]*e[3],n?0:r[0]*e[4]+r[2]*e[5]+r[4],n?0:r[1]*e[4]+r[3]*e[5]+r[5]],Gf=(r,e)=>r.reduceRight((n,t)=>t&&n?ct(t,n,e):t||n,void 0)||cn.concat(),w1=r=>{let[e,n]=r;return Math.atan2(n,e)},Ja=r=>{let e=w1(r),n=Math.pow(r[0],2)+Math.pow(r[1],2),t=Math.sqrt(n),i=(r[0]*r[3]-r[2]*r[1])/t,o=Math.atan2(r[0]*r[2]+r[1]*r[3],n);return{angle:ro(e),scaleX:t,scaleY:i,skewX:ro(o),skewY:0,translateX:r[4]||0,translateY:r[5]||0}},sl=function(r){return[1,0,0,1,r,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function al(){let{angle:r=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:n=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=lt(r),i=_r(t),o=Tr(t);return[i,o,-o,i,e?e-(i*e-o*n):0,n?n-(o*e+i*n):0]}var Wf=function(r){return[r,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,0,0]},_1=r=>Math.tan(lt(r)),Ob=r=>[1,0,_1(r),1,0,0],Ab=r=>[1,_1(r),0,1,0,0],$c=r=>{let{scaleX:e=1,scaleY:n=1,flipX:t=!1,flipY:i=!1,skewX:o=0,skewY:s=0}=r,l=Wf(t?-e:e,i?-n:n);return o&&(l=ct(l,Ob(o),!0)),s&&(l=ct(l,Ab(s),!0)),l},T1=r=>{let{translateX:e=0,translateY:n=0,angle:t=0}=r,i=sl(e,n);t&&(i=ct(i,al({angle:t})));let o=$c(r);return b1(o)||(i=ct(i,o)),i},Ac=function(r){let{signal:e,crossOrigin:n=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(t,i){if(e&&e.aborted)return i(new gf("loadImage"));let o=v1(),s;e&&(s=function(c){o.src="",i(c)},e.addEventListener("abort",s,{once:!0}));let l=function(){o.onload=o.onerror=null,s&&e?.removeEventListener("abort",s),t(o)};r?(o.onload=l,o.onerror=function(){s&&e?.removeEventListener("abort",s),i(new Qn("Error loading ".concat(o.src)))},n&&(o.crossOrigin=n),o.src=r):l()})},Qa=function(r){let{signal:e,reviver:n=ds}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((t,i)=>{let o=[];e&&e.addEventListener("abort",i,{once:!0}),Promise.all(r.map(s=>G.getClass(s.type).fromObject(s,{signal:e}).then(l=>(n(s,l),o.push(l),l)))).then(t).catch(s=>{o.forEach(l=>{l.dispose&&l.dispose()}),i(s)}).finally(()=>{e&&e.removeEventListener("abort",i)})})},Uc=function(r){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((n,t)=>{let i=[];e&&e.addEventListener("abort",t,{once:!0});let o=Object.values(r).map(l=>l&&l.type&&G.has(l.type)?Qa([l],{signal:e}).then(c=>{let[a]=c;return i.push(a),a}):l),s=Object.keys(r);Promise.all(o).then(l=>l.reduce((c,a,u)=>(c[s[u]]=a,c),{})).then(n).catch(l=>{i.forEach(c=>{c.dispose&&c.dispose()}),t(l)}).finally(()=>{e&&e.removeEventListener("abort",t)})})},ys=function(r){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,n)=>(n in r&&(e[n]=r[n]),e),{})},Pb=(r,e)=>Object.keys(r).reduce((n,t)=>(e(r[t],t,r)&&(n[t]=r[t]),n),{}),LC={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},Rv=(r,e,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?r+6*(e-r)*n:n<.5?e:n<2/3?r+(e-r)*(2/3-n)*6:r),BC=(r,e,n,t)=>{r/=255,e/=255,n/=255;let i=Math.max(r,e,n),o=Math.min(r,e,n),s,l,c=(i+o)/2;if(i===o)s=l=0;else{let a=i-o;switch(l=c>.5?a/(2-i-o):a/(i+o),i){case r:s=(e-n)/a+(e<n?6:0);break;case e:s=(n-r)/a+2;break;case n:s=(r-e)/a+4}s/=6}return[Math.round(360*s),Math.round(100*l),Math.round(100*c),t]},jC=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(r)/(r.endsWith("%")?100:1)},of=r=>Math.min(Math.round(r),255).toString(16).toUpperCase().padStart(2,"0"),VC=r=>{let[e,n,t,i=1]=r,o=Math.round(.3*e+.59*n+.11*t);return[o,o,o,i]},dn=class r{constructor(e){if(D(this,"isUnrecognised",!1),e)if(e instanceof r)this.setSource([...e._source]);else if(Array.isArray(e)){let[n,t,i,o=1]=e;this.setSource([n,t,i,o])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in LC&&(e=LC[e]),e==="transparent"?[255,255,255,0]:r.sourceFromHex(e)||r.sourceFromRgb(e)||r.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){let[e,n,t]=this.getSource();return"rgb(".concat(e,",").concat(n,",").concat(t,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){let[e,n,t]=BC(...this.getSource());return"hsl(".concat(e,",").concat(n,"%,").concat(t,"%)")}toHsla(){let[e,n,t,i]=BC(...this.getSource());return"hsla(".concat(e,",").concat(n,"%,").concat(t,"%,").concat(i,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){let[e,n,t,i]=this.getSource();return"".concat(of(e)).concat(of(n)).concat(of(t)).concat(of(Math.round(255*i)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(VC(this.getSource())),this}toBlackWhite(e){let[n,,,t]=VC(this.getSource()),i=n<(e||127)?0:255;return this.setSource([i,i,i,t]),this}overlayWith(e){e instanceof r||(e=new r(e));let n=this.getSource(),t=e.getSource(),[i,o,s]=n.map((l,c)=>Math.round(.5*l+.5*t[c]));return this.setSource([i,o,s,n[3]]),this}static fromRgb(e){return r.fromRgba(e)}static fromRgba(e){return new r(r.sourceFromRgb(e))}static sourceFromRgb(e){let n=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(n){let[t,i,o]=n.slice(1,4).map(s=>{let l=parseFloat(s);return s.endsWith("%")?Math.round(2.55*l):l});return[t,i,o,jC(n[4])]}}static fromHsl(e){return r.fromHsla(e)}static fromHsla(e){return new r(r.sourceFromHsl(e))}static sourceFromHsl(e){let n=e.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!n)return;let t=(r.parseAngletoDegrees(n[1])%360+360)%360/360,i=parseFloat(n[2])/100,o=parseFloat(n[3])/100,s,l,c;if(i===0)s=l=c=o;else{let a=o<=.5?o*(i+1):o+i-o*i,u=2*o-a;s=Rv(u,a,t+1/3),l=Rv(u,a,t),c=Rv(u,a,t-1/3)}return[Math.round(255*s),Math.round(255*l),Math.round(255*c),jC(n[4])]}static fromHex(e){return new r(r.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){let n=e.slice(e.indexOf("#")+1),t;t=n.length<=4?n.split("").map(c=>c+c):n.match(/.{2}/g);let[i,o,s,l=255]=t.map(c=>parseInt(c,16));return[i,o,s,l/255]}}static parseAngletoDegrees(e){let n=e.toLowerCase(),t=parseFloat(n);return n.includes("rad")?ro(t):n.includes("turn")?360*t:t}},tt=(r,e)=>parseFloat(Number(r).toFixed(e)),hs=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Sb,n=/\D{0,2}$/.exec(r),t=parseFloat(r),i=Oe.DPI;switch(n?.[0]){case"mm":return t*i/25.4;case"cm":return t*i/2.54;case"in":return t*i;case"pt":return t*i/72;case"pc":return t*i/72*12;case"em":return t*e;default:return t}},x1=r=>{let[e,n]=r.trim().split(" "),[t,i]=(o=e)&&o!==bn?[o.slice(1,4),o.slice(5,8)]:o===bn?[o,o]:["Mid","Mid"];var o;return{meetOrSlice:n||"meet",alignX:t,alignY:i}},kc=r=>"matrix("+r.map(e=>tt(e,Oe.NUM_FRACTION_DIGITS)).join(" ")+")",Fc=function(r,e){let n,t,i=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)n="url(#SVGID_".concat(e.id,")");else{let o=new dn(e),s=o.getAlpha();n=o.toRgb(),s!==1&&(t=s.toString())}else n="none";return i?"".concat(r,": ").concat(n,"; ").concat(t?"".concat(r,"-opacity: ").concat(t,"; "):""):"".concat(r,'="').concat(n,'" ').concat(t?"".concat(r,'-opacity="').concat(t,'" '):"")},Jn=r=>!!r&&r.toLive!==void 0,$C=r=>!!r&&typeof r.toObject=="function",UC=r=>!!r&&r.offsetX!==void 0&&"source"in r,Wo=r=>!!r&&"multiSelectionStacking"in r;function S1(r){let e=r&&vr(r),n=0,t=0;if(!r||!e)return{left:n,top:t};let i=r,o=e.documentElement,s=e.body||{scrollLeft:0,scrollTop:0};for(;i&&(i.parentNode||i.host)&&(i=i.parentNode||i.host,i===e?(n=s.scrollLeft||o.scrollLeft||0,t=s.scrollTop||o.scrollTop||0):(n+=i.scrollLeft||0,t+=i.scrollTop||0),i.nodeType!==1||i.style.position!=="fixed"););return{left:n,top:t}}var vr=r=>r.ownerDocument||null,E1=r=>{var e;return((e=r.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},D1=function(r,e,n){let{width:t,height:i}=n,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;r.width=t,r.height=i,o>1&&(r.setAttribute("width",(t*o).toString()),r.setAttribute("height",(i*o).toString()),e.scale(o,o))},Kv=(r,e)=>{let{width:n,height:t}=e;n&&(r.style.width=typeof n=="number"?"".concat(n,"px"):n),t&&(r.style.height=typeof t=="number"?"".concat(t,"px"):t)};function HC(r){return r.onselectstart!==void 0&&(r.onselectstart=()=>!1),r.style.userSelect=bn,r}var wf=class{constructor(e){D(this,"_originalCanvasStyle",void 0),D(this,"lower",void 0);let n=this.createLowerCanvas(e);this.lower={el:n,ctx:n.getContext("2d")}}createLowerCanvas(e){let n=(t=e)&&t.getContext!==void 0?e:e&&rl().getElementById(e)||er();var t;if(n.hasAttribute("data-fabric"))throw new Qn("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=n.style.cssText,n.setAttribute("data-fabric","main"),n.classList.add("lower-canvas"),n}cleanupDOM(e){let{width:n,height:t}=e,{el:i}=this.lower;i.classList.remove("lower-canvas"),i.removeAttribute("data-fabric"),i.setAttribute("width","".concat(n)),i.setAttribute("height","".concat(t)),i.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,n){let{el:t,ctx:i}=this.lower;D1(t,i,e,n)}setCSSDimensions(e){Kv(this.lower.el,e)}calcOffset(){return function(e){var n;let t=e&&vr(e),i={left:0,top:0};if(!t)return i;let o=((n=E1(e))===null||n===void 0?void 0:n.getComputedStyle(e,null))||{};i.left+=parseInt(o.borderLeftWidth,10)||0,i.top+=parseInt(o.borderTopWidth,10)||0,i.left+=parseInt(o.paddingLeft,10)||0,i.top+=parseInt(o.paddingTop,10)||0;let s={left:0,top:0},l=t.documentElement;e.getBoundingClientRect!==void 0&&(s=e.getBoundingClientRect());let c=S1(e);return{left:s.left+c.left-(l.clientLeft||0)+i.left,top:s.top+c.top-(l.clientTop||0)+i.top}}(this.lower.el)}dispose(){jr().dispose(this.lower.el),delete this.lower}},uH={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...cn]},Lc=class r extends m1(bf){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return r.ownDefaults}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(n),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new wf(e)}add(){let e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),i=1;i<n;i++)t[i-1]=arguments[i];let o=super.insertAt(e,...t);return t.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),o}remove(){let e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(eo("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?d1():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,n){return this.setDimensions({width:e},n)}setHeight(e,n){return this.setDimensions({height:e},n)}_setDimensionsImpl(e){let{cssOnly:n=!1,backstoreOnly:t=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!n){let i=E({width:this.width,height:this.height},e);this.elements.setDimensions(i,this.getRetinaScaling()),this.hasLostContext=!0,this.width=i.width,this.height=i.height}t||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,n){this._setDimensionsImpl(e,n),n&&n.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,n){let t=e,i=[...this.viewportTransform],o=Kt(e,Rn(i));i[0]=n,i[3]=n;let s=Kt(o,i);i[4]+=t.x-s.x,i[5]+=t.y-s.y,this.setViewportTransform(i)}setZoom(e){this.zoomToPoint(new M(0,0),e)}absolutePan(e){let n=[...this.viewportTransform];return n[4]=-e.x,n[5]=-e.y,this.setViewportTransform(n)}relativePan(e){return this.absolutePan(new M(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=Oc(()=>this.renderAndReset()))}calcViewportBoundaries(){let e=this.width,n=this.height,t=Rn(this.viewportTransform),i=Kt({x:0,y:0},t),o=Kt({x:e,y:n},t),s=i.min(o),l=i.max(o);return this.vptCoords={tl:s,tr:new M(l.x,s.y),bl:new M(s.x,l.y),br:l}}cancelRequestedRender(){this.nextRenderHandle&&(y1(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,n){if(this.destroyed)return;let t=this.viewportTransform,i=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5]),this._renderObjects(e,n),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),i&&(i._set("canvas",this),i.shouldCache(),i._transformDone=!0,i.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,i)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,n){let t=this.viewportTransform;e.save(),e.transform(...t),e.globalCompositeOperation="destination-in",n.transform(e),e.scale(1/n.zoomX,1/n.zoomY),e.drawImage(n._cacheCanvas,-n.cacheTranslationX,-n.cacheTranslationY),e.restore()}_renderObjects(e,n){for(let t=0,i=n.length;t<i;++t)n[t]&&n[t].render(e)}_renderBackgroundOrOverlay(e,n){let t=this["".concat(n,"Color")],i=this["".concat(n,"Image")],o=this.viewportTransform,s=this["".concat(n,"Vpt")];if(!t&&!i)return;let l=Jn(t);if(t){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=l?t.toLive(e):t,s&&e.transform(...o),l){e.transform(1,0,0,1,t.offsetX||0,t.offsetY||0);let c=t.gradientTransform||t.patternTransform;c&&e.transform(...c)}e.fill(),e.restore()}if(i){e.save();let{skipOffscreen:c}=this;this.skipOffscreen=s,s&&e.transform(...o),i.render(e),this.skipOffscreen=c,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new M(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new M(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new M(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new M(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new M(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return Kt(this.getCenterPoint(),Rn(this.viewportTransform))}_centerObject(e,n){e.setXY(n,he,he),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,n){let t=this.clipPath,i=t&&!t.excludeFromExport?this._toObject(t,e,n):null;return E(E(E({version:qv},ys(this,n)),{},{objects:this._objects.filter(o=>!o.excludeFromExport).map(o=>this._toObject(o,e,n))},this.__serializeBgOverlay(e,n)),i?{clipPath:i}:null)}_toObject(e,n,t){let i;this.includeDefaultValues||(i=e.includeDefaultValues,e.includeDefaultValues=!1);let o=e[n](t);return this.includeDefaultValues||(e.includeDefaultValues=!!i),o}__serializeBgOverlay(e,n){let t={},i=this.backgroundImage,o=this.overlayImage,s=this.backgroundColor,l=this.overlayColor;return Jn(s)?s.excludeFromExport||(t.background=s.toObject(n)):s&&(t.background=s),Jn(l)?l.excludeFromExport||(t.overlay=l.toObject(n)):l&&(t.overlay=l),i&&!i.excludeFromExport&&(t.backgroundImage=this._toObject(i,e,n)),o&&!o.excludeFromExport&&(t.overlayImage=this._toObject(o,e,n)),t}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;e.reviver=n;let t=[];return this._setSVGPreamble(t,e),this._setSVGHeader(t,e),this.clipPath&&t.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(t,"background"),this._setSVGBgOverlayImage(t,"backgroundImage",n),this._setSVGObjects(t,n),this.clipPath&&t.push(`</g>
`),this._setSVGBgOverlayColor(t,"overlay"),this._setSVGBgOverlayImage(t,"overlayImage",n),t.push("</svg>"),t.join("")}_setSVGPreamble(e,n){n.suppressPreamble||e.push('<?xml version="1.0" encoding="',n.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,n){let t=n.width||"".concat(this.width),i=n.height||"".concat(this.height),o=Oe.NUM_FRACTION_DIGITS,s=n.viewBox,l;if(s)l='viewBox="'.concat(s.x," ").concat(s.y," ").concat(s.width," ").concat(s.height,'" ');else if(this.svgViewportTransformation){let c=this.viewportTransform;l='viewBox="'.concat(tt(-c[4]/c[0],o)," ").concat(tt(-c[5]/c[3],o)," ").concat(tt(this.width/c[0],o)," ").concat(tt(this.height/c[3],o),'" ')}else l='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',t,'" ','height="',i,'" ',l,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",qv,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(n),`</defs>
`)}createSVGClipPathMarkup(e){let n=this.clipPath;return n?(n.clipPathId="CLIPPATH_".concat(no()),'<clipPath id="'.concat(n.clipPathId,`" >
`).concat(n.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{let n=this["".concat(e,"Color")];if(Jn(n)){let t=this["".concat(e,"Vpt")],i=this.viewportTransform,o={isType:()=>!1,width:this.width/(t?i[0]:1),height:this.height/(t?i[3]:1)};return n.toSVG(o,{additionalTransform:t?kc(i):""})}}).join("")}createSVGFontFacesMarkup(){let e=[],n={},t=Oe.fontPaths;this._objects.forEach(function o(s){e.push(s),hf(s)&&s._objects.forEach(o)}),e.forEach(o=>{if(!(s=o)||typeof s._renderText!="function")return;var s;let{styles:l,fontFamily:c}=o;!n[c]&&t[c]&&(n[c]=!0,l&&Object.values(l).forEach(a=>{Object.values(a).forEach(u=>{let{fontFamily:d=""}=u;!n[d]&&t[d]&&(n[d]=!0)})}))});let i=Object.keys(n).map(o=>`		@font-face {
			font-family: '`.concat(o,`';
			src: url('`).concat(t[o],`');
		}
`)).join("");return i?`	<style type="text/css"><![CDATA[
`.concat(i,`]]></style>
`):""}_setSVGObjects(e,n){this.forEachObject(t=>{t.excludeFromExport||this._setSVGObject(e,t,n)})}_setSVGObject(e,n,t){e.push(n.toSVG(t))}_setSVGBgOverlayImage(e,n,t){let i=this[n];i&&!i.excludeFromExport&&i.toSVG&&e.push(i.toSVG(t))}_setSVGBgOverlayColor(e,n){let t=this["".concat(n,"Color")];if(t)if(Jn(t)){let i=t.repeat||"",o=this.width,s=this.height,l=this["".concat(n,"Vpt")]?kc(Rn(this.viewportTransform)):"";e.push('<rect transform="'.concat(l," translate(").concat(o/2,",").concat(s/2,')" x="').concat(t.offsetX-o/2,'" y="').concat(t.offsetY-s/2,'" width="').concat(i!=="repeat-y"&&i!=="no-repeat"||!UC(t)?o:t.source.width,'" height="').concat(i!=="repeat-x"&&i!=="no-repeat"||!UC(t)?s:t.source.height,'" fill="url(#SVGID_').concat(t.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',t,'"',`></rect>
`)}loadFromJSON(e,n){let{signal:t}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new Qn("`json` is undefined"));let i=typeof e=="string"?JSON.parse(e):e,{objects:o=[],backgroundImage:s,background:l,overlayImage:c,overlay:a,clipPath:u}=i,d=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Qa(o,{reviver:n,signal:t}),Uc({backgroundImage:s,backgroundColor:l,overlayImage:c,overlayColor:a,clipPath:u},{signal:t})]).then(h=>{let[f,p]=h;return this.clear(),this.add(...f),this.set(i),this.set(p),this.renderOnAddRemove=d,this})}clone(e){let n=this.toObject(e);return this.cloneWithoutData().loadFromJSON(n)}cloneWithoutData(){let e=xr(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{format:n="png",quality:t=1,multiplier:i=1,enableRetinaScaling:o=!1}=e,s=i*(o?this.getRetinaScaling():1);return Ib(this.toCanvasElement(s,e),n,t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:n,height:t,left:i,top:o,filter:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=(n||this.width)*e,c=(t||this.height)*e,a=this.getZoom(),u=this.width,d=this.height,h=this.skipControlsDrawing,f=a*e,p=this.viewportTransform,g=[f,0,0,f,(p[4]-(i||0))*e,(p[5]-(o||0))*e],y=this.enableRetinaScaling,w=xr({width:l,height:c}),v=s?this._objects.filter(x=>s(x)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=g,this.width=l,this.height=c,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(w.getContext("2d"),v),this.viewportTransform=p,this.width=u,this.height=d,this.calcViewportBoundaries(),this.enableRetinaScaling=y,this.skipControlsDrawing=h,w}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),vf.cancelByCanvas(this),this.disposed=!0,new Promise((e,n)=>{let t=()=>{this.destroy(),e(!0)};t.kill=n,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=t:t()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}};D(Lc,"ownDefaults",uH);var dH=["touchstart","touchmove","touchend"],C1=r=>{let e=S1(r.target),n=function(t){let i=t.changedTouches;return i&&i[0]?i[0]:t}(r);return new M(n.clientX+e.left,n.clientY+e.top)},_f=r=>dH.includes(r.type)||r.pointerType==="touch",Zv=r=>{r.preventDefault(),r.stopPropagation()},Br=r=>{let e=0,n=0,t=0,i=0;for(let o=0,s=r.length;o<s;o++){let{x:l,y:c}=r[o];(l>t||!o)&&(t=l),(l<e||!o)&&(e=l),(c>i||!o)&&(i=c),(c<n||!o)&&(n=c)}return{left:e,top:n,width:t-e,height:i-n}},hH=["translateX","translateY","scaleX","scaleY"],I1=(r,e)=>el(r,ct(e,r.calcOwnMatrix())),el=(r,e)=>{let n=Ja(e),{translateX:t,translateY:i,scaleX:o,scaleY:s}=n,l=nt(n,hH),c=new M(t,i);r.flipX=!1,r.flipY=!1,Object.assign(r,l),r.set({scaleX:o,scaleY:s}),r.setPositionByOrigin(c,he,he)},O1=r=>{r.scaleX=1,r.scaleY=1,r.skewX=0,r.skewY=0,r.flipX=!1,r.flipY=!1,r.rotate(0)},Mb=r=>({scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,angle:r.angle,left:r.left,flipX:r.flipX,flipY:r.flipY,top:r.top}),qf=(r,e,n)=>{let t=r/2,i=e/2,o=[new M(-t,-i),new M(t,-i),new M(-t,i),new M(t,i)].map(l=>l.transform(n)),s=Br(o);return new M(s.width,s.height)},Hc=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:cn;return ct(Rn(arguments.length>1&&arguments[1]!==void 0?arguments[1]:cn),r)},yi=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cn,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:cn;return r.transform(Hc(e,n))},A1=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cn,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:cn;return r.transform(Hc(e,n),!0)},Jv=(r,e,n)=>{let t=Hc(e,n);return el(r,ct(t,r.calcOwnMatrix())),t},Nb=(r,e)=>{var n;let{transform:{target:t}}=e;(n=t.canvas)===null||n===void 0||n.fire("object:".concat(r),E(E({},e),{},{target:t})),t.fire(r,e)},fH={left:-.5,top:-.5,center:0,bottom:.5,right:.5},_t=r=>typeof r=="string"?fH[r]:r-.5,Tf="not-allowed";function P1(r){return _t(r.originX)===_t(he)&&_t(r.originY)===_t(he)}function zC(r){return .5-_t(r)}var wr=(r,e)=>r[e],Rb=(r,e,n,t)=>({e:r,transform:e,pointer:new M(n,t)});function M1(r,e){let n=r.getTotalAngle()+ro(Math.atan2(e.y,e.x))+360;return Math.round(n%360/45)}function Yf(r,e,n,t,i){var o;let{target:s,corner:l}=r,c=s.controls[l],a=((o=s.canvas)===null||o===void 0?void 0:o.getZoom())||1,u=s.padding/a,d=function(h,f,p,g){let y=h.getRelativeCenterPoint(),w=p!==void 0&&g!==void 0?h.translateToGivenOrigin(y,he,he,p,g):new M(h.left,h.top);return(h.angle?f.rotate(-lt(h.angle),y):f).subtract(w)}(s,new M(t,i),e,n);return d.x>=u&&(d.x-=u),d.x<=-u&&(d.x+=u),d.y>=u&&(d.y-=u),d.y<=u&&(d.y+=u),d.x-=c.offsetX,d.y-=c.offsetY,d}var N1=(r,e,n,t)=>{let{target:i,offsetX:o,offsetY:s}=e,l=n-o,c=t-s,a=!wr(i,"lockMovementX")&&i.left!==l,u=!wr(i,"lockMovementY")&&i.top!==c;return a&&i.set(Le,l),u&&i.set(vn,c),(a||u)&&Nb(h1,Rb(r,e,n,t)),a||u},xf=class{getSvgStyles(e){let n=this.fillRule?this.fillRule:"nonzero",t=this.strokeWidth?this.strokeWidth:"0",i=this.strokeDashArray?this.strokeDashArray.join(" "):bn,o=this.strokeDashOffset?this.strokeDashOffset:"0",s=this.strokeLineCap?this.strokeLineCap:"butt",l=this.strokeLineJoin?this.strokeLineJoin:"miter",c=this.strokeMiterLimit?this.strokeMiterLimit:"4",a=this.opacity!==void 0?this.opacity:"1",u=this.visible?"":" visibility: hidden;",d=e?"":this.getSvgFilter(),h=Fc(Ot,this.fill);return[Fc(wn,this.stroke),"stroke-width: ",t,"; ","stroke-dasharray: ",i,"; ","stroke-linecap: ",s,"; ","stroke-dashoffset: ",o,"; ","stroke-linejoin: ",l,"; ","stroke-miterlimit: ",c,"; ",h,"fill-rule: ",n,"; ","opacity: ",a,";",d,u].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",t=e?this.calcTransformMatrix():this.calcOwnMatrix(),i='transform="'.concat(kc(t));return"".concat(i).concat(n,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:n,additionalTransform:t=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=[this.getSvgTransform(!0,t),this.getSvgCommons()].join(""),o=e.indexOf("COMMON_PARTS");return e[o]=i,n?n(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:n,reviver:t,withShadow:i,additionalTransform:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=n?"":'style="'.concat(this.getSvgStyles(),'" '),l=i?'style="'.concat(this.getSvgFilter(),'" '):"",c=this.clipPath,a=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=c&&c.absolutePositioned,d=this.stroke,h=this.fill,f=this.shadow,p=[],g=e.indexOf("COMMON_PARTS"),y;c&&(c.clipPathId="CLIPPATH_".concat(no()),y='<clipPath id="'.concat(c.clipPathId,`" >
`).concat(c.toClipPathSVG(t),`</clipPath>
`)),u&&p.push("<g ",l,this.getSvgCommons(),` >
`),p.push("<g ",this.getSvgTransform(!1),u?"":l+this.getSvgCommons(),` >
`);let w=[s,a,n?"":this.addPaintOrder()," ",o?'transform="'.concat(o,'" '):""].join("");return e[g]=w,Jn(h)&&p.push(h.toSVG(this)),Jn(d)&&p.push(d.toSVG(this)),f&&p.push(f.toSVG(this)),c&&p.push(y),p.push(e.join("")),p.push(`</g>
`),u&&p.push(`</g>
`),t?t(p.join("")):p.join("")}addPaintOrder(){return this.paintFirst!==Ot?' paint-order="'.concat(this.paintFirst,'" '):""}};function Xf(r){return new RegExp("^("+r.join("|")+")\\b","i")}var GC,br=String.raw(GC||(GC=io(["(?:[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?)"],["(?:[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?)"])));var pH=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+br+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+br+"))?\\s+(.*)"),gH={cx:Le,x:Le,r:"radius",cy:vn,y:vn,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},kv="font-size",Fv="clip-path",See=Xf(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),Eee=Xf(["symbol","image","marker","pattern","view","svg"]),WC=Xf(["symbol","g","a","svg","clipPath","defs"]),Dee=new RegExp("^\\s*("+br+"+)\\s*,?\\s*("+br+"+)\\s*,?\\s*("+br+"+)\\s*,?\\s*("+br+"+)\\s*$"),mH=new M(1,0),R1=new M,kb=(r,e)=>r.rotate(e),Sf=(r,e)=>new M(e).subtract(r),Ef=r=>r.distanceFrom(R1),Df=(r,e)=>Math.atan2(Ka(r,e),F1(r,e)),k1=r=>Df(mH,r),Kf=r=>r.eq(R1)?r:r.scalarDivide(Ef(r)),Fb=function(r){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return Kf(new M(-r.y,r.x).scalarMultiply(e?1:-1))},Ka=(r,e)=>r.x*e.y-r.y*e.x,F1=(r,e)=>r.x*e.x+r.y*e.y,Qv=(r,e,n)=>{if(r.eq(e)||r.eq(n))return!0;let t=Ka(e,n),i=Ka(e,r),o=Ka(n,r);return t>=0?i>=0&&o<=0:!(i<=0&&o>=0)},qC="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",YC=new RegExp("(?:\\s|^)"+qC+qC+"("+br+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)"),fs=class r{constructor(e){let n=typeof e=="string"?r.parseShadow(e):e;Object.assign(this,r.ownDefaults,n),this.id=no()}static parseShadow(e){let n=e.trim(),[,t=0,i=0,o=0]=(YC.exec(n)||[]).map(s=>parseFloat(s)||0);return{color:(n.replace(YC,"")||"rgb(0,0,0)").trim(),offsetX:t,offsetY:i,blur:o}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){let n=kb(new M(this.offsetX,this.offsetY),lt(-e.angle)),t=new dn(this.color),i=40,o=40;return e.width&&e.height&&(i=100*tt((Math.abs(n.x)+this.blur)/e.width,Oe.NUM_FRACTION_DIGITS)+20,o=100*tt((Math.abs(n.y)+this.blur)/e.height,Oe.NUM_FRACTION_DIGITS)+20),e.flipX&&(n.x*=-1),e.flipY&&(n.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(o,'%" height="').concat(100+2*o,'%" x="-').concat(i,'%" width="').concat(100+2*i,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(tt(this.blur?this.blur/2:0,Oe.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(tt(n.x,Oe.NUM_FRACTION_DIGITS),'" dy="').concat(tt(n.y,Oe.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(t.toRgb(),'" flood-opacity="').concat(t.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){let e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},n=r.ownDefaults;return this.includeDefaultValues?e:Pb(e,(t,i)=>t!==n[i])}static fromObject(e){return F(this,null,function*(){return new this(e)})}};D(fs,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),D(fs,"type","shadow"),G.setClass(fs,"shadow");var gs=(r,e,n)=>Math.max(r,Math.min(e,n)),yH=[vn,Le,un,kn,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",il,ol],bi=[Ot,wn,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],vH={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:Le,originY:vn,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Ot,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},Lv=(r,e,n,t)=>(r<Math.abs(e)?(r=e,t=n/4):t=e===0&&r===0?n/vi*Math.asin(1):n/vi*Math.asin(e/r),{a:r,c:e,p:n,s:t}),XC=(r,e,n,t,i)=>r*Math.pow(2,10*(t-=1))*Math.sin((t*i-e)*vi/n),L1=(r,e,n,t)=>-n*Math.cos(r/t*to)+n+e,eb=(r,e,n,t)=>(r/=t)<1/2.75?n*(7.5625*r*r)+e:r<2/2.75?n*(7.5625*(r-=1.5/2.75)*r+.75)+e:r<2.5/2.75?n*(7.5625*(r-=2.25/2.75)*r+.9375)+e:n*(7.5625*(r-=2.625/2.75)*r+.984375)+e,KC=(r,e,n,t)=>n-eb(t-r,0,n,t)+e,bH=Object.freeze({__proto__:null,defaultEasing:L1,easeInBack:function(r,e,n,t){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return n*(r/=t)*r*((i+1)*r-i)+e},easeInBounce:KC,easeInCirc:(r,e,n,t)=>-n*(Math.sqrt(1-(r/=t)*r)-1)+e,easeInCubic:(r,e,n,t)=>n*(r/t)**3+e,easeInElastic:(r,e,n,t)=>{let i=n,o=0;if(r===0)return e;if((r/=t)===1)return e+n;o||(o=.3*t);let{a:s,s:l,p:c}=Lv(i,n,o,1.70158);return-XC(s,l,c,r,t)+e},easeInExpo:(r,e,n,t)=>r===0?e:n*2**(10*(r/t-1))+e,easeInOutBack:function(r,e,n,t){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(r/=t/2)<1?n/2*(r*r*((1+(i*=1.525))*r-i))+e:n/2*((r-=2)*r*((1+(i*=1.525))*r+i)+2)+e},easeInOutBounce:(r,e,n,t)=>r<t/2?.5*KC(2*r,0,n,t)+e:.5*eb(2*r-t,0,n,t)+.5*n+e,easeInOutCirc:(r,e,n,t)=>(r/=t/2)<1?-n/2*(Math.sqrt(1-r**2)-1)+e:n/2*(Math.sqrt(1-(r-=2)*r)+1)+e,easeInOutCubic:(r,e,n,t)=>(r/=t/2)<1?n/2*r**3+e:n/2*((r-2)**3+2)+e,easeInOutElastic:(r,e,n,t)=>{let i=n,o=0;if(r===0)return e;if((r/=t/2)===2)return e+n;o||(o=t*(.3*1.5));let{a:s,s:l,p:c,c:a}=Lv(i,n,o,1.70158);return r<1?-.5*XC(s,l,c,r,t)+e:s*Math.pow(2,-10*(r-=1))*Math.sin((r*t-l)*vi/c)*.5+a+e},easeInOutExpo:(r,e,n,t)=>r===0?e:r===t?e+n:(r/=t/2)<1?n/2*2**(10*(r-1))+e:n/2*-(2**(-10*--r)+2)+e,easeInOutQuad:(r,e,n,t)=>(r/=t/2)<1?n/2*r**2+e:-n/2*(--r*(r-2)-1)+e,easeInOutQuart:(r,e,n,t)=>(r/=t/2)<1?n/2*r**4+e:-n/2*((r-=2)*r**3-2)+e,easeInOutQuint:(r,e,n,t)=>(r/=t/2)<1?n/2*r**5+e:n/2*((r-2)**5+2)+e,easeInOutSine:(r,e,n,t)=>-n/2*(Math.cos(Math.PI*r/t)-1)+e,easeInQuad:(r,e,n,t)=>n*(r/=t)*r+e,easeInQuart:(r,e,n,t)=>n*(r/=t)*r**3+e,easeInQuint:(r,e,n,t)=>n*(r/t)**5+e,easeInSine:(r,e,n,t)=>-n*Math.cos(r/t*to)+n+e,easeOutBack:function(r,e,n,t){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return n*((r=r/t-1)*r*((i+1)*r+i)+1)+e},easeOutBounce:eb,easeOutCirc:(r,e,n,t)=>n*Math.sqrt(1-(r=r/t-1)*r)+e,easeOutCubic:(r,e,n,t)=>n*((r/t-1)**3+1)+e,easeOutElastic:(r,e,n,t)=>{let i=n,o=0;if(r===0)return e;if((r/=t)===1)return e+n;o||(o=.3*t);let{a:s,s:l,p:c,c:a}=Lv(i,n,o,1.70158);return s*2**(-10*r)*Math.sin((r*t-l)*vi/c)+a+e},easeOutExpo:(r,e,n,t)=>r===t?e+n:n*-(2**(-10*r/t)+1)+e,easeOutQuad:(r,e,n,t)=>-n*(r/=t)*(r-2)+e,easeOutQuart:(r,e,n,t)=>-n*((r=r/t-1)*r**3-1)+e,easeOutQuint:(r,e,n,t)=>n*((r/t-1)**5+1)+e,easeOutSine:(r,e,n,t)=>n*Math.sin(r/t*to)+e}),wH=()=>!1,Bc=class{constructor(e){let{startValue:n,byValue:t,duration:i=500,delay:o=0,easing:s=L1,onStart:l=ds,onChange:c=ds,onComplete:a=ds,abort:u=wH,target:d}=e;D(this,"_state","pending"),D(this,"durationProgress",0),D(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=i,this.delay=o,this.easing=s,this._onStart=l,this._onChange=c,this._onComplete=a,this._abort=u,this.target=d,this.startValue=n,this.byValue=t,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){let e=n=>{this._state==="pending"&&(this.startTime=n||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>Oc(e),this.delay):Oc(e)}tick(e){let n=(e||+new Date)-this.startTime,t=Math.min(n,this.duration);this.durationProgress=t/this.duration;let{value:i,valueProgress:o}=this.calculate(t);this.value=Object.freeze(i),this.valueProgress=o,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):n>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),Oc(this.tick)))}register(){vf.push(this)}unregister(){vf.remove(this)}abort(){this._state="aborted",this.unregister()}},_H=["startValue","endValue"],tb=class extends Bc{constructor(e){let{startValue:n=0,endValue:t=100}=e;super(E(E({},nt(e,_H)),{},{startValue:n,byValue:t-n}))}calculate(e){let n=this.easing(e,this.startValue,this.byValue,this.duration);return{value:n,valueProgress:Math.abs((n-this.startValue)/this.byValue)}}},TH=["startValue","endValue"],nb=class extends Bc{constructor(e){let{startValue:n=[0],endValue:t=[100]}=e;super(E(E({},nt(e,TH)),{},{startValue:n,byValue:t.map((i,o)=>i-n[o])}))}calculate(e){let n=this.startValue.map((t,i)=>this.easing(e,t,this.byValue[i],this.duration,i));return{value:n,valueProgress:Math.abs((n[0]-this.startValue[0])/this.byValue[0])}}},xH=["startValue","endValue","easing","onChange","onComplete","abort"],SH=(r,e,n,t)=>e+n*(1-Math.cos(r/t*to)),Bv=r=>r&&((e,n,t)=>r(new dn(e).toRgba(),n,t)),rb=class extends Bc{constructor(e){let{startValue:n,endValue:t,easing:i=SH,onChange:o,onComplete:s,abort:l}=e,c=nt(e,xH),a=new dn(n).getSource(),u=new dn(t).getSource();super(E(E({},c),{},{startValue:a,byValue:u.map((d,h)=>d-a[h]),easing:i,onChange:Bv(o),onComplete:Bv(s),abort:Bv(l)}))}calculate(e){let[n,t,i,o]=this.startValue.map((l,c)=>this.easing(e,l,this.byValue[c],this.duration,c)),s=[...[n,t,i].map(Math.round),gs(0,o,1)];return{value:s,valueProgress:s.map((l,c)=>this.byValue[c]!==0?Math.abs((l-this.startValue[c])/this.byValue[c]):0).find(l=>l!==0)||0}}};function Lb(r){let e=(n=>Array.isArray(n.startValue)||Array.isArray(n.endValue))(r)?new nb(r):new tb(r);return e.start(),e}function B1(r){let e=new rb(r);return e.start(),e}var ps=class r{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(n=>n.eq(e))}append(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return this.points=this.points.concat(n.filter(i=>!this.includes(i))),this}static isPointContained(e,n,t){let i=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(n.eq(t))return e.eq(n);if(n.x===t.x)return e.x===n.x&&(i||e.y>=Math.min(n.y,t.y)&&e.y<=Math.max(n.y,t.y));if(n.y===t.y)return e.y===n.y&&(i||e.x>=Math.min(n.x,t.x)&&e.x<=Math.max(n.x,t.x));{let o=Sf(n,t),s=Sf(n,e).divide(o);return i?Math.abs(s.x)===Math.abs(s.y):s.x===s.y&&s.x>=0&&s.x<=1}}static isPointInPolygon(e,n){let t=new M(e).setX(Math.min(e.x-1,...n.map(o=>o.x))),i=0;for(let o=0;o<n.length;o++){let s=this.intersectSegmentSegment(n[o],n[(o+1)%n.length],e,t);if(s.includes(e))return!0;i+=+(s.status==="Intersection")}return i%2==1}static intersectLineLine(e,n,t,i){let o=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],s=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],l=n.x-e.x,c=n.y-e.y,a=i.x-t.x,u=i.y-t.y,d=e.x-t.x,h=e.y-t.y,f=a*h-u*d,p=l*h-c*d,g=u*l-a*c;if(g!==0){let y=f/g,w=p/g;return(o||0<=y&&y<=1)&&(s||0<=w&&w<=1)?new r("Intersection").append(new M(e.x+y*l,e.y+y*c)):new r}if(f===0||p===0){let y=o||s||r.isPointContained(e,t,i)||r.isPointContained(n,t,i)||r.isPointContained(t,e,n)||r.isPointContained(i,e,n);return new r(y?"Coincident":void 0)}return new r("Parallel")}static intersectSegmentLine(e,n,t,i){return r.intersectLineLine(e,n,t,i,!1,!0)}static intersectSegmentSegment(e,n,t,i){return r.intersectLineLine(e,n,t,i,!1,!1)}static intersectLinePolygon(e,n,t){let i=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],o=new r,s=t.length;for(let l,c,a,u=0;u<s;u++){if(l=t[u],c=t[(u+1)%s],a=r.intersectLineLine(e,n,l,c,i,!1),a.status==="Coincident")return a;o.append(...a.points)}return o.points.length>0&&(o.status="Intersection"),o}static intersectSegmentPolygon(e,n,t){return r.intersectLinePolygon(e,n,t,!1)}static intersectPolygonPolygon(e,n){let t=new r,i=e.length,o=[];for(let s=0;s<i;s++){let l=e[s],c=e[(s+1)%i],a=r.intersectSegmentPolygon(l,c,n);a.status==="Coincident"?(o.push(a),t.append(l,c)):t.append(...a.points)}return o.length>0&&o.length===e.length?new r("Coincident"):(t.points.length>0&&(t.status="Intersection"),t)}static intersectPolygonRectangle(e,n,t){let i=n.min(t),o=n.max(t),s=new M(o.x,i.y),l=new M(i.x,o.y);return r.intersectPolygonPolygon(e,[i,s,o,l])}},ib=class extends bf{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){let e=this.getRelativeXY();return this.group?Kt(e,this.group.calcTransformMatrix()):e}setXY(e,n,t){this.group&&(e=Kt(e,Rn(this.group.calcTransformMatrix()))),this.setRelativeXY(e,n,t)}getRelativeXY(){return new M(this.left,this.top)}setRelativeXY(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,n,t)}isStrokeAccountedForInDimensions(){return!1}getCoords(){let{tl:e,tr:n,br:t,bl:i}=this.aCoords||(this.aCoords=this.calcACoords()),o=[e,n,t,i];if(this.group){let s=this.group.calcTransformMatrix();return o.map(l=>Kt(l,s))}return o}intersectsWithRect(e,n){return ps.intersectPolygonRectangle(this.getCoords(),e,n).status==="Intersection"}intersectsWithObject(e){let n=ps.intersectPolygonPolygon(this.getCoords(),e.getCoords());return n.status==="Intersection"||n.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(n=>e.containsPoint(n))}isContainedWithinRect(e,n){let{left:t,top:i,width:o,height:s}=this.getBoundingRect();return t>=e.x&&t+o<=n.x&&i>=e.y&&i+s<=n.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return ps.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;let{tl:e,br:n}=this.canvas.vptCoords;return!!this.getCoords().some(t=>t.x<=n.x&&t.x>=e.x&&t.y<=n.y&&t.y>=e.y)||!!this.intersectsWithRect(e,n)||this.containsPoint(e.midPointFrom(n))}isPartiallyOnScreen(){if(!this.canvas)return!1;let{tl:e,br:n}=this.canvas.vptCoords;return this.intersectsWithRect(e,n)?!0:this.getCoords().every(t=>(t.x>=n.x||t.x<=e.x)&&(t.y>=n.y||t.y<=e.y))&&this.containsPoint(e.midPointFrom(n))}getBoundingRect(){return Br(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(un,e),this._set(kn,e),this.setCoords()}scaleToWidth(e){let n=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/n)}scaleToHeight(e){let n=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/n)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?ro(w1(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||cn.concat()}calcACoords(){let e=al({angle:this.angle}),{x:n,y:t}=this.getRelativeCenterPoint(),i=sl(n,t),o=ct(i,e),s=this._getTransformedDimensions(),l=s.x/2,c=s.y/2;return{tl:Kt({x:-l,y:-c},o),tr:Kt({x:l,y:-c},o),bl:Kt({x:-l,y:c},o),br:Kt({x:l,y:c},o)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],n=[];return!e&&this.group&&(n=this.group.transformMatrixKey(e)),n.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,_t(this.originX),_t(this.originY)),n}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],n=this.calcOwnMatrix();if(e||!this.group)return n;let t=this.transformMatrixKey(e),i=this.matrixCache;return i&&i.key.every((o,s)=>o===t[s])?i.value:(this.group&&(n=ct(this.group.calcTransformMatrix(!1),n)),this.matrixCache={key:t,value:n},n)}calcOwnMatrix(){let e=this.transformMatrixKey(!0),n=this.ownMatrixCache;if(n&&n.key===e)return n.value;let t=this.getRelativeCenterPoint(),i={angle:this.angle,translateX:t.x,translateY:t.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},o=T1(i);return this.ownMatrixCache={key:e,value:o},o}_getNonTransformedDimensions(){return new M(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=E({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),t=n.strokeWidth,i=t,o=0;this.strokeUniform&&(i=0,o=t);let s=n.width+i,l=n.height+i,c;return c=n.skewX===0&&n.skewY===0?new M(s*n.scaleX,l*n.scaleY):qf(s,l,$c(n)),c.scalarAdd(o)}translateToGivenOrigin(e,n,t,i,o){let s=e.x,l=e.y,c=_t(i)-_t(n),a=_t(o)-_t(t);if(c||a){let u=this._getTransformedDimensions();s+=c*u.x,l+=a*u.y}return new M(s,l)}translateToCenterPoint(e,n,t){if(n===he&&t===he)return e;let i=this.translateToGivenOrigin(e,n,t,he,he);return this.angle?i.rotate(lt(this.angle),e):i}translateToOriginPoint(e,n,t){let i=this.translateToGivenOrigin(e,he,he,n,t);return this.angle?i.rotate(lt(this.angle),e):i}getCenterPoint(){let e=this.getRelativeCenterPoint();return this.group?Kt(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new M(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,n){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,n)}setPositionByOrigin(e,n,t){let i=this.translateToCenterPoint(e,n,t),o=this.translateToOriginPoint(i,this.originX,this.originY);this.set({left:o.x,top:o.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),Le,vn)}},EH=["type"],DH=["extraParam"],pi=class ff extends ib{static getDefaults(){return ff.ownDefaults}get type(){let e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){eo("warn","Setting type has no effect",e)}constructor(e){super(),D(this,"_cacheContext",null),Object.assign(this,ff.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=er(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){let n=e.width,t=e.height,i=Oe.maxCacheSideLimit,o=Oe.minCacheSideLimit;if(n<=i&&t<=i&&n*t<=Oe.perfLimitSizeTotal)return n<o&&(e.width=o),t<o&&(e.height=o),e;let s=n/t,[l,c]=Ic.limitDimsByArea(s),a=gs(o,l,i),u=gs(o,c,i);return n>a&&(e.zoomX/=n/a,e.width=a,e.capped=!0),t>u&&(e.zoomY/=t/u,e.height=u,e.capped=!0),e}_getCacheCanvasDimensions(){let e=this.getTotalObjectScaling(),n=this._getTransformedDimensions({skewX:0,skewY:0}),t=n.x*e.x/this.scaleX,i=n.y*e.y/this.scaleY;return{width:Math.ceil(t+2),height:Math.ceil(i+2),zoomX:e.x,zoomY:e.y,x:t,y:i}}_updateCacheCanvas(){let e=this._cacheCanvas,n=this._cacheContext,{width:t,height:i,zoomX:o,zoomY:s,x:l,y:c}=this._limitCacheSize(this._getCacheCanvasDimensions()),a=t!==e.width||i!==e.height,u=this.zoomX!==o||this.zoomY!==s;if(!e||!n)return!1;if(a||u){t!==e.width||i!==e.height?(e.width=t,e.height=i):(n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,e.width,e.height));let d=l/2,h=c/2;return this.cacheTranslationX=Math.round(e.width/2-d)+d,this.cacheTranslationY=Math.round(e.height/2-h)+h,n.translate(this.cacheTranslationX,this.cacheTranslationY),n.scale(o,s),this.zoomX=o,this.zoomY=s,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){let n=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,t=this.calcTransformMatrix(!n);e.transform(t[0],t[1],t[2],t[3],t[4],t[5])}getObjectScaling(){if(!this.group)return new M(Math.abs(this.scaleX),Math.abs(this.scaleY));let e=Ja(this.calcTransformMatrix());return new M(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){let e=this.getObjectScaling();if(this.canvas){let n=this.canvas.getZoom(),t=this.getCanvasRetinaScaling();return e.scalarMultiply(n*t)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,n){e!==un&&e!==kn||(n=this._constrainScale(n)),e===un&&n<0?(this.flipX=!this.flipX,n*=-1):e==="scaleY"&&n<0?(this.flipY=!this.flipY,n*=-1):e!=="shadow"||!n||n instanceof fs||(n=new fs(n));let t=this[e]!==n;return this[e]=n,t&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||t&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){let{zoomX:n,zoomY:t,cacheTranslationX:i,cacheTranslationY:o}=this,{width:s,height:l}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:n,zoomY:t,cacheTranslationX:i,cacheTranslationY:o,width:s,height:l,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===wn&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,n,t){e.save(),n.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(t,0,0),e.restore()}drawObject(e,n,t){let i=this.fill,o=this.stroke;n?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,t),this.fill=i,this.stroke=o}createClipPathLayer(e,n){let t=xr(n),i=t.getContext("2d");if(i.translate(n.cacheTranslationX,n.cacheTranslationY),i.scale(n.zoomX,n.zoomY),e._cacheCanvas=t,n.parentClipPaths.forEach(o=>{o.transform(i)}),n.parentClipPaths.push(e),e.absolutePositioned){let o=Rn(this.calcTransformMatrix());i.transform(o[0],o[1],o[2],o[3],o[4],o[5])}return e.transform(i),e.drawObject(i,!0,n),t}_drawClipPath(e,n,t){if(!n)return;n._transformDone=!0;let i=this.createClipPathLayer(n,t);this.drawClipPathOnCache(e,n,i)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;let n=this._cacheCanvas,t=this._cacheContext;return!(!n||!t||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(n&&t&&!e&&(t.save(),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,n.width,n.height),t.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;let n=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,n){let t=n.stroke;t&&(e.lineWidth=n.strokeWidth,e.lineCap=n.strokeLineCap,e.lineDashOffset=n.strokeDashOffset,e.lineJoin=n.strokeLineJoin,e.miterLimit=n.strokeMiterLimit,Jn(t)?t.gradientUnits==="percentage"||t.gradientTransform||t.patternTransform?this._applyPatternForTransformedGradient(e,t):(e.strokeStyle=t.toLive(e),this._applyPatternGradientTransform(e,t)):e.strokeStyle=n.stroke)}_setFillStyles(e,n){let{fill:t}=n;t&&(Jn(t)?(e.fillStyle=t.toLive(e),this._applyPatternGradientTransform(e,t)):e.fillStyle=t)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,n){n&&n.length!==0&&e.setLineDash(n)}_setShadow(e){if(!this.shadow)return;let n=this.shadow,t=this.canvas,i=this.getCanvasRetinaScaling(),[o,,,s]=t?.viewportTransform||cn,l=o*i,c=s*i,a=n.nonScaling?new M(1,1):this.getObjectScaling();e.shadowColor=n.color,e.shadowBlur=n.blur*Oe.browserShadowBlurConstant*(l+c)*(a.x+a.y)/4,e.shadowOffsetX=n.offsetX*l*a.x,e.shadowOffsetY=n.offsetY*c*a.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,n){if(!Jn(n))return{offsetX:0,offsetY:0};let t=n.gradientTransform||n.patternTransform,i=-this.width/2+n.offsetX||0,o=-this.height/2+n.offsetY||0;return n.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,i,o):e.transform(1,0,0,1,i,o),t&&e.transform(t[0],t[1],t[2],t[3],t[4],t[5]),{offsetX:i,offsetY:o}}_renderPaintInOrder(e){this.paintFirst===wn?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){let n=this.getObjectScaling();e.scale(1/n.x,1/n.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,n){var t;let i=this._limitCacheSize(this._getCacheCanvasDimensions()),o=this.getCanvasRetinaScaling(),s=i.x/this.scaleX/o,l=i.y/this.scaleY/o,c=xr({width:Math.ceil(s),height:Math.ceil(l)}),a=c.getContext("2d");a&&(a.beginPath(),a.moveTo(0,0),a.lineTo(s,0),a.lineTo(s,l),a.lineTo(0,l),a.closePath(),a.translate(s/2,l/2),a.scale(i.zoomX/this.scaleX/o,i.zoomY/this.scaleY/o),this._applyPatternGradientTransform(a,n),a.fillStyle=n.toLive(e),a.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(o*this.scaleX/i.zoomX,o*this.scaleY/i.zoomY),e.strokeStyle=(t=a.createPattern(c,"no-repeat"))!==null&&t!==void 0?t:"")}_findCenterFromElement(){return new M(this.left+this.width/2,this.top+this.height/2)}clone(e){let n=this.toObject(e);return this.constructor.fromObject(n)}cloneAsImage(e){let n=this.toCanvasElement(e);return new(G.getClass("image"))(n)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Mb(this),t=this.group,i=this.shadow,o=Math.abs,s=e.enableRetinaScaling?d1():1,l=(e.multiplier||1)*s,c=e.canvasProvider||(v=>new Lc(v,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&O1(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&Jv(this,this.getViewportTransform()),this.setCoords();let a=er(),u=this.getBoundingRect(),d=this.shadow,h=new M;if(d){let v=d.blur,x=d.nonScaling?new M(1,1):this.getObjectScaling();h.x=2*Math.round(o(d.offsetX)+v)*o(x.x),h.y=2*Math.round(o(d.offsetY)+v)*o(x.y)}let f=u.width+h.x,p=u.height+h.y;a.width=Math.ceil(f),a.height=Math.ceil(p);let g=c(a);e.format==="jpeg"&&(g.backgroundColor="#fff"),this.setPositionByOrigin(new M(g.width/2,g.height/2),he,he);let y=this.canvas;g._objects=[this],this.set("canvas",g),this.setCoords();let w=g.toCanvasElement(l||1,e);return this.set("canvas",y),this.shadow=i,t&&(this.group=t),this.set(n),this.setCoords(),g._objects=[],g.destroy(),w}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Ib(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return n.includes(this.constructor.type)||n.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){let{centeredRotation:n,originX:t,originY:i}=this;if(n){let{x:o,y:s}=this.getRelativeCenterPoint();this.originX=he,this.originY=he,this.left=o,this.top=s}if(this.set("angle",e),n){let{x:o,y:s}=this.translateToOriginPoint(this.getRelativeCenterPoint(),t,i);this.left=o,this.top=s,this.originX=t,this.originY=i}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){vf.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&jr().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,n){return Object.entries(e).reduce((t,i)=>{let[o,s]=i;return t[o]=this._animate(o,s,n),t},{})}_animate(e,n){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=e.split("."),o=this.constructor.colorProperties.includes(i[i.length-1]),{abort:s,startValue:l,onChange:c,onComplete:a}=t,u=E(E({},t),{},{target:this,startValue:l??i.reduce((d,h)=>d[h],this),endValue:n,abort:s?.bind(this),onChange:(d,h,f)=>{i.reduce((p,g,y)=>(y===i.length-1&&(p[g]=d),p[g]),this),c&&c(d,h,f)},onComplete:(d,h,f)=>{this.setCoords(),a&&a(d,h,f)}});return o?B1(u):Lb(u)}isDescendantOf(e){let{parent:n,group:t}=this;return n===e||t===e||!!n&&n.isDescendantOf(e)||!!t&&t!==n&&t.isDescendantOf(e)}getAncestors(){let e=[],n=this;do n=n.parent,n&&e.push(n);while(n);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};let n=this.getAncestors(),t=e.getAncestors();if(n.length===0&&t.length>0&&this===t[t.length-1])return{fork:[],otherFork:[e,...t.slice(0,t.length-1)],common:[this]};for(let i,o=0;o<n.length;o++){if(i=n[o],i===e)return{fork:[this,...n.slice(0,o)],otherFork:[],common:n.slice(o)};for(let s=0;s<t.length;s++){if(this===t[s])return{fork:[],otherFork:[e,...t.slice(0,s)],common:[this,...n]};if(i===t[s])return{fork:[this,...n.slice(0,o)],otherFork:[e,...t.slice(0,s)],common:n.slice(o)}}}return{fork:[this,...n],otherFork:[e,...t],common:[]}}hasCommonAncestors(e){let n=this.findCommonAncestors(e);return n&&!!n.common.length}isInFrontOf(e){if(this===e)return;let n=this.findCommonAncestors(e);if(n.fork.includes(e))return!0;if(n.otherFork.includes(this))return!1;let t=n.common[0]||this.canvas;if(!t)return;let i=n.fork.pop(),o=n.otherFork.pop(),s=t._objects.indexOf(i),l=t._objects.indexOf(o);return s>-1&&s>l}toObject(){let e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(ff.customProperties,this.constructor.customProperties||[]),n,t=Oe.NUM_FRACTION_DIGITS,{clipPath:i,fill:o,stroke:s,shadow:l,strokeDashArray:c,left:a,top:u,originX:d,originY:h,width:f,height:p,strokeWidth:g,strokeLineCap:y,strokeDashOffset:w,strokeLineJoin:v,strokeUniform:x,strokeMiterLimit:A,scaleX:L,scaleY:H,angle:q,flipX:$,flipY:we,opacity:ne,visible:He,backgroundColor:_e,fillRule:Ee,paintFirst:Pe,globalCompositeOperation:Ve,skewX:oe,skewY:yt}=this;i&&!i.excludeFromExport&&(n=i.toObject(e.concat("inverted","absolutePositioned")));let $e=Gt=>tt(Gt,t),Ze=E(E({},ys(this,e)),{},{type:this.constructor.type,version:qv,originX:d,originY:h,left:$e(a),top:$e(u),width:$e(f),height:$e(p),fill:$C(o)?o.toObject():o,stroke:$C(s)?s.toObject():s,strokeWidth:$e(g),strokeDashArray:c&&c.concat(),strokeLineCap:y,strokeDashOffset:w,strokeLineJoin:v,strokeUniform:x,strokeMiterLimit:$e(A),scaleX:$e(L),scaleY:$e(H),angle:$e(q),flipX:$,flipY:we,opacity:$e(ne),shadow:l&&l.toObject(),visible:He,backgroundColor:_e,fillRule:Ee,paintFirst:Pe,globalCompositeOperation:Ve,skewX:$e(oe),skewY:$e(yt)},n?{clipPath:n}:null);return this.includeDefaultValues?Ze:this._removeDefaultValues(Ze)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){let n=this.constructor.getDefaults(),t=Object.keys(n).length>0?n:Object.getPrototypeOf(this);return Pb(e,(i,o)=>{if(o===Le||o===vn||o==="type")return!0;let s=t[o];return i!==s&&!(Array.isArray(i)&&Array.isArray(s)&&i.length===0&&s.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let n=nt(e,EH),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:i}=t,o=nt(t,DH);return Uc(n,o).then(s=>i?(delete s[i],new this(n[i],s)):new this(s))}static fromObject(e,n){return this._fromObject(e,n)}};D(pi,"stateProperties",yH),D(pi,"cacheProperties",bi),D(pi,"ownDefaults",vH),D(pi,"type","FabricObject"),D(pi,"colorProperties",[Ot,wn,"backgroundColor"]),D(pi,"customProperties",[]),G.setClass(pi),G.setClass(pi,"object");var oo=(r,e,n)=>(t,i,o,s)=>{let l=e(t,i,o,s);return l&&Nb(r,E(E({},Rb(t,i,o,s)),n)),l};function vs(r){return(e,n,t,i)=>{let{target:o,originX:s,originY:l}=n,c=o.getRelativeCenterPoint(),a=o.translateToOriginPoint(c,s,l),u=r(e,n,t,i);return o.setPositionByOrigin(a,n.originX,n.originY),u}}var ob=oo(Rc,vs((r,e,n,t)=>{let i=Yf(e,e.originX,e.originY,n,t);if(_t(e.originX)===_t(he)||_t(e.originX)===_t(pt)&&i.x<0||_t(e.originX)===_t(Le)&&i.x>0){let{target:o}=e,s=o.strokeWidth/(o.strokeUniform?o.scaleX:1),l=P1(e)?2:1,c=o.width,a=Math.abs(i.x*l/o.scaleX)-s;return o.set("width",Math.max(a,1)),c!==o.width}return!1}));function j1(r,e,n,t,i){t=t||{};let o=this.sizeX||t.cornerSize||i.cornerSize,s=this.sizeY||t.cornerSize||i.cornerSize,l=t.transparentCorners!==void 0?t.transparentCorners:i.transparentCorners,c=l?wn:Ot,a=!l&&(t.cornerStrokeColor||i.cornerStrokeColor),u,d=e,h=n;r.save(),r.fillStyle=t.cornerColor||i.cornerColor||"",r.strokeStyle=t.cornerStrokeColor||i.cornerStrokeColor||"",o>s?(u=o,r.scale(1,s/o),h=n*o/s):s>o?(u=s,r.scale(o/s,1),d=e*s/o):u=o,r.beginPath(),r.arc(d,h,u/2,0,vi,!1),r[c](),a&&r.stroke(),r.restore()}function V1(r,e,n,t,i){t=t||{};let o=this.sizeX||t.cornerSize||i.cornerSize,s=this.sizeY||t.cornerSize||i.cornerSize,l=t.transparentCorners!==void 0?t.transparentCorners:i.transparentCorners,c=l?wn:Ot,a=!l&&(t.cornerStrokeColor||i.cornerStrokeColor),u=o/2,d=s/2;r.save(),r.fillStyle=t.cornerColor||i.cornerColor||"",r.strokeStyle=t.cornerStrokeColor||i.cornerStrokeColor||"",r.translate(e,n);let h=i.getTotalAngle();r.rotate(lt(h)),r["".concat(c,"Rect")](-u,-d,o,s),a&&r.strokeRect(-u,-d,o,s),r.restore()}var an=class{constructor(e){D(this,"visible",!0),D(this,"actionName",zf),D(this,"angle",0),D(this,"x",0),D(this,"y",0),D(this,"offsetX",0),D(this,"offsetY",0),D(this,"sizeX",0),D(this,"sizeY",0),D(this,"touchSizeX",0),D(this,"touchSizeY",0),D(this,"cursorStyle","crosshair"),D(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,n,t,i){var o;let{tl:s,tr:l,br:c,bl:a}=i;return((o=n.canvas)===null||o===void 0?void 0:o.getActiveObject())===n&&n.isControlVisible(e)&&ps.isPointInPolygon(t,[s,l,c,a])}getActionHandler(e,n,t){return this.actionHandler}getMouseDownHandler(e,n,t){return this.mouseDownHandler}getMouseUpHandler(e,n,t){return this.mouseUpHandler}cursorStyleHandler(e,n,t){return n.cursorStyle}getActionName(e,n,t){return n.actionName}getVisibility(e,n){var t,i;return(t=(i=e._controlsVisibility)===null||i===void 0?void 0:i[n])!==null&&t!==void 0?t:this.visible}setVisibility(e,n,t){this.visible=e}positionHandler(e,n,t,i){return new M(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(n)}calcCornerCoords(e,n,t,i,o,s){let l=Gf([sl(t,i),al({angle:e}),Wf((o?this.touchSizeX:this.sizeX)||n,(o?this.touchSizeY:this.sizeY)||n)]);return{tl:new M(-.5,-.5).transform(l),tr:new M(.5,-.5).transform(l),br:new M(.5,.5).transform(l),bl:new M(-.5,.5).transform(l)}}render(e,n,t,i,o){((i=i||{}).cornerStyle||o.cornerStyle)==="circle"?j1.call(this,e,n,t,i,o):V1.call(this,e,n,t,i,o)}},$1=(r,e,n)=>n.lockRotation?Tf:e.cursorStyle,U1=oo(f1,vs((r,e,n,t)=>{let{target:i,ex:o,ey:s,theta:l,originX:c,originY:a}=e,u=i.translateToOriginPoint(i.getRelativeCenterPoint(),c,a);if(wr(i,"lockRotation"))return!1;let d=Math.atan2(s-u.y,o-u.x),h=Math.atan2(t-u.y,n-u.x),f=ro(h-d+l);if(i.snapAngle&&i.snapAngle>0){let g=i.snapAngle,y=i.snapThreshold||g,w=Math.ceil(f/g)*g,v=Math.floor(f/g)*g;Math.abs(f-v)<y?f=v:Math.abs(f-w)<y&&(f=w)}f<0&&(f=360+f),f%=360;let p=i.angle!==f;return i.angle=f,p}));function H1(r,e){let n=e.canvas,t=r[n.uniScaleKey];return n.uniformScaling&&!t||!n.uniformScaling&&t}function z1(r,e,n){let t=wr(r,"lockScalingX"),i=wr(r,"lockScalingY");if(t&&i||!e&&(t||i)&&n||t&&e==="x"||i&&e==="y")return!0;let{width:o,height:s,strokeWidth:l}=r;return o===0&&l===0&&e!=="y"||s===0&&l===0&&e!=="x"}var CH=["e","se","s","sw","w","nw","n","ne","e"],Ha=(r,e,n)=>{let t=H1(r,n);if(z1(n,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",t))return Tf;let i=M1(n,e);return"".concat(CH[i],"-resize")};function Bb(r,e,n,t){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},o=e.target,s=i.by,l=H1(r,o),c,a,u,d,h,f;if(z1(o,s,l))return!1;if(e.gestureScale)a=e.scaleX*e.gestureScale,u=e.scaleY*e.gestureScale;else{if(c=Yf(e,e.originX,e.originY,n,t),h=s!=="y"?Math.sign(c.x||e.signX||1):1,f=s!=="x"?Math.sign(c.y||e.signY||1):1,e.signX||(e.signX=h),e.signY||(e.signY=f),wr(o,"lockScalingFlip")&&(e.signX!==h||e.signY!==f))return!1;if(d=o._getTransformedDimensions(),l&&!s){let y=Math.abs(c.x)+Math.abs(c.y),{original:w}=e,v=y/(Math.abs(d.x*w.scaleX/o.scaleX)+Math.abs(d.y*w.scaleY/o.scaleY));a=w.scaleX*v,u=w.scaleY*v}else a=Math.abs(c.x*o.scaleX/d.x),u=Math.abs(c.y*o.scaleY/d.y);P1(e)&&(a*=2,u*=2),e.signX!==h&&s!=="y"&&(e.originX=zC(e.originX),a*=-1,e.signX=h),e.signY!==f&&s!=="x"&&(e.originY=zC(e.originY),u*=-1,e.signY=f)}let p=o.scaleX,g=o.scaleY;return s?(s==="x"&&o.set(un,a),s==="y"&&o.set(kn,u)):(!wr(o,"lockScalingX")&&o.set(un,a),!wr(o,"lockScalingY")&&o.set(kn,u)),p!==o.scaleX||g!==o.scaleY}var Dc=oo(Hf,vs((r,e,n,t)=>Bb(r,e,n,t))),G1=oo(Hf,vs((r,e,n,t)=>Bb(r,e,n,t,{by:"x"}))),W1=oo(Hf,vs((r,e,n,t)=>Bb(r,e,n,t,{by:"y"}))),IH=["target","ex","ey","skewingSide"],jv={x:{counterAxis:"y",scale:un,skew:il,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:kn,skew:ol,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},OH=["ns","nesw","ew","nwse"],q1=(r,e,n)=>{if(e.x!==0&&wr(n,"lockSkewingY")||e.y!==0&&wr(n,"lockSkewingX"))return Tf;let t=M1(n,e)%4;return"".concat(OH[t],"-resize")};function Y1(r,e,n,t,i){let{target:o}=n,{counterAxis:s,origin:l,lockSkewing:c,skew:a,flip:u}=jv[r];if(wr(o,c))return!1;let{origin:d,flip:h}=jv[s],f=_t(n[d])*(o[h]?-1:1),p=-Math.sign(f)*(o[u]?-1:1),g=.5*-((o[a]===0&&Yf(n,he,he,t,i)[r]>0||o[a]>0?1:-1)*p)+.5;return oo(p1,vs((w,v,x,A)=>function(L,H,q){let{target:$,ex:we,ey:ne,skewingSide:He}=H,_e=nt(H,IH),{skew:Ee}=jv[L],Pe=q.subtract(new M(we,ne)).divide(new M($.scaleX,$.scaleY))[L],Ve=$[Ee],oe=_e[Ee],yt=Math.tan(lt(oe)),$e=L==="y"?$._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:$._getTransformedDimensions({scaleX:1,scaleY:1}).y,Ze=2*Pe*He/Math.max($e,1)+yt,Gt=ro(Math.atan(Ze));$.set(Ee,Gt);let Je=Ve!==$[Ee];if(Je&&L==="y"){let{skewX:rt,scaleX:Tn}=$,Bt=$._getTransformedDimensions({skewY:Ve}),Wr=$._getTransformedDimensions(),Qt=rt!==0?Bt.x/Wr.x:1;Qt!==1&&$.set(un,Qt*Tn)}return Je}(r,v,new M(x,A))))(e,E(E({},n),{},{[l]:g,skewingSide:p}),t,i)}var X1=(r,e,n,t)=>Y1("x",r,e,n,t),K1=(r,e,n,t)=>Y1("y",r,e,n,t);function Zf(r,e){return r[e.canvas.altActionKey]}var Cc=(r,e,n)=>{let t=Zf(r,n);return e.x===0?t?il:kn:e.y===0?t?ol:un:""},Xo=(r,e,n)=>Zf(r,n)?q1(0,e,n):Ha(r,e,n),sb=(r,e,n,t)=>Zf(r,e.target)?K1(r,e,n,t):G1(r,e,n,t),ab=(r,e,n,t)=>Zf(r,e.target)?X1(r,e,n,t):W1(r,e,n,t),jb=()=>({ml:new an({x:-.5,y:0,cursorStyleHandler:Xo,actionHandler:sb,getActionName:Cc}),mr:new an({x:.5,y:0,cursorStyleHandler:Xo,actionHandler:sb,getActionName:Cc}),mb:new an({x:0,y:.5,cursorStyleHandler:Xo,actionHandler:ab,getActionName:Cc}),mt:new an({x:0,y:-.5,cursorStyleHandler:Xo,actionHandler:ab,getActionName:Cc}),tl:new an({x:-.5,y:-.5,cursorStyleHandler:Ha,actionHandler:Dc}),tr:new an({x:.5,y:-.5,cursorStyleHandler:Ha,actionHandler:Dc}),bl:new an({x:-.5,y:.5,cursorStyleHandler:Ha,actionHandler:Dc}),br:new an({x:.5,y:.5,cursorStyleHandler:Ha,actionHandler:Dc}),mtr:new an({x:0,y:-.5,actionHandler:U1,cursorStyleHandler:$1,offsetY:-40,withConnection:!0,actionName:Db})}),Z1=()=>({mr:new an({x:.5,y:0,actionHandler:ob,cursorStyleHandler:Xo,actionName:Rc}),ml:new an({x:-.5,y:0,actionHandler:ob,cursorStyleHandler:Xo,actionName:Rc})}),J1=()=>E(E({},jb()),Z1()),Cf=class r extends pi{static getDefaults(){return E(E({},super.getDefaults()),r.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),r.ownDefaults),this.setOptions(e)}static createControls(){return{controls:jb()}}_updateCacheCanvas(){let e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){let n=e._currentTransform,t=n.target,i=n.action;if(this===t&&i&&i.startsWith(zf))return!1}return super._updateCacheCanvas()}getActiveControl(){let e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;let t=Object.entries(this.oCoords);for(let i=t.length-1;i>=0;i--){let[o,s]=t[i],l=this.controls[o];if(l.shouldActivate(o,this,e,n?s.touchCorner:s.corner))return this.__corner=o,{key:o,control:l,coord:this.oCoords[o]}}}calcOCoords(){let e=this.getViewportTransform(),n=this.getCenterPoint(),t=sl(n.x,n.y),i=al({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),o=ct(t,i),s=ct(e,o),l=ct(s,[1/e[0],0,0,1/e[3],0,0]),c=this.group?Ja(this.calcTransformMatrix()):void 0;c&&(c.scaleX=Math.abs(c.scaleX),c.scaleY=Math.abs(c.scaleY));let a=this._calculateCurrentDimensions(c),u={};return this.forEachControl((d,h)=>{let f=d.positionHandler(a,l,this,d);u[h]=Object.assign(f,this._calcCornerCoords(d,f))}),u}_calcCornerCoords(e,n){let t=this.getTotalAngle();return{corner:e.calcCornerCoords(t,this.cornerSize,n.x,n.y,!1,this),touchCorner:e.calcCornerCoords(t,this.touchCornerSize,n.x,n.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(let n in this.controls)e(this.controls[n],n,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();let n=this.getRelativeCenterPoint(),t=this._calculateCurrentDimensions(),i=this.getViewportTransform();e.translate(n.x,n.y),e.scale(1/i[0],1/i[3]),e.rotate(lt(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),e.restore()}strokeBorders(e,n){e.strokeRect(-n.x/2,-n.y/2,n.x,n.y)}_drawBorders(e,n){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=E({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},t);e.save(),e.strokeStyle=i.borderColor,this._setLineDash(e,i.borderDashArray),this.strokeBorders(e,n),i.hasControls&&this.drawControlsConnectingLines(e,n),e.restore()}_renderControls(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{hasBorders:t,hasControls:i}=this,o=E({hasBorders:t,hasControls:i},n),s=this.getViewportTransform(),l=o.hasBorders,c=o.hasControls,a=ct(s,this.calcTransformMatrix()),u=Ja(a);e.save(),e.translate(u.translateX,u.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(u.angle-=180),e.rotate(lt(this.group?u.angle:this.angle)),l&&this.drawBorders(e,u,n),c&&this.drawControls(e,n),e.restore()}drawBorders(e,n,t){let i;if(t&&t.forActiveSelection||this.group){let o=qf(this.width,this.height,$c(n)),s=this.isStrokeAccountedForInDimensions()?Cb:(this.strokeUniform?new M().scalarAdd(this.canvas?this.canvas.getZoom():1):new M(n.scaleX,n.scaleY)).scalarMultiply(this.strokeWidth);i=o.add(s).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else i=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,i,t)}drawControlsConnectingLines(e,n){let t=!1;e.beginPath(),this.forEachControl((i,o)=>{i.withConnection&&i.getVisibility(this,o)&&(t=!0,e.moveTo(i.x*n.x,i.y*n.y),e.lineTo(i.x*n.x+i.offsetX,i.y*n.y+i.offsetY))}),t&&e.stroke()}drawControls(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();let t=this.getCanvasRetinaScaling(),{cornerStrokeColor:i,cornerDashArray:o,cornerColor:s}=this,l=E({cornerStrokeColor:i,cornerDashArray:o,cornerColor:s},n);e.setTransform(t,0,0,t,0,0),e.strokeStyle=e.fillStyle=l.cornerColor,this.transparentCorners||(e.strokeStyle=l.cornerStrokeColor),this._setLineDash(e,l.cornerDashArray),this.forEachControl((c,a)=>{if(c.getVisibility(this,a)){let u=this.oCoords[a];c.render(e,u.x,u.y,l,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,n){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=n}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(n=>{let[t,i]=n;return this.setControlVisible(t,i)})}clearContextTop(e){if(!this.canvas)return;let n=this.canvas.contextTop;if(!n)return;let t=this.canvas.viewportTransform;n.save(),n.transform(t[0],t[1],t[2],t[3],t[4],t[5]),this.transform(n);let i=this.width+4,o=this.height+4;return n.clearRect(-i/2,-o/2,i,o),e||n.restore(),n}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}};function Q1(r,e){return e.forEach(n=>{Object.getOwnPropertyNames(n.prototype).forEach(t=>{t!=="constructor"&&Object.defineProperty(r.prototype,t,Object.getOwnPropertyDescriptor(n.prototype,t)||Object.create(null))})}),r}D(Cf,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});var Rt=class extends Cf{};Q1(Rt,[xf]),G.setClass(Rt),G.setClass(Rt,"object");var eI=(r,e,n,t)=>{let i=2*(t=Math.round(t))+1,{data:o}=r.getImageData(e-t,n-t,i,i);for(let s=3;s<o.length;s+=4)if(o[s]>0)return!1;return!0},If=class{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new M(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new M(1/this.options.scaleX,1/this.options.scaleY):new M(1,1)}createSideVector(e,n){let t=Sf(e,n);return this.options.strokeUniform?t.multiply(this.scale):t}projectOrthogonally(e,n,t){return this.applySkew(e.add(this.calcOrthogonalProjection(e,n,t)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){let n=new M(e);return n.y+=n.x*Math.tan(lt(this.options.skewY)),n.x+=n.y*Math.tan(lt(this.options.skewX)),n}scaleUnitVector(e,n){return e.multiply(this.strokeUniformScalar).scalarMultiply(n)}},AH=new M,Of=class r extends If{static getOrthogonalRotationFactor(e,n){let t=n?Df(e,n):k1(e);return Math.abs(t)<to?-1:1}constructor(e,n,t,i){super(i),D(this,"AB",void 0),D(this,"AC",void 0),D(this,"alpha",void 0),D(this,"bisector",void 0),this.A=new M(e),this.B=new M(n),this.C=new M(t),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=Df(this.AB,this.AC),this.bisector=Kf(kb(this.AB.eq(AH)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,n){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude,i=this.createSideVector(e,n),o=Fb(i),s=r.getOrthogonalRotationFactor(o,this.bisector);return this.scaleUnitVector(o,t*s)}projectBevel(){let e=[];return(this.alpha%vi==0?[this.B]:[this.B,this.C]).forEach(n=>{e.push(this.projectOrthogonally(this.A,n)),e.push(this.projectOrthogonally(this.A,n,-this.strokeProjectionMagnitude))}),e}projectMiter(){let e=[],n=Math.abs(this.alpha),t=1/Math.sin(n/2),i=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*t),o=this.options.strokeUniform?Ef(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return Ef(i)/this.strokeProjectionMagnitude<=o&&e.push(this.applySkew(this.A.add(i))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,n){let t=[],i=new M(r.getOrthogonalRotationFactor(this.bisector),r.getOrthogonalRotationFactor(new M(this.bisector.y,this.bisector.x)));return[new M(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(i),new M(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(i)].forEach(o=>{Qv(o,e,n)&&t.push(this.A.add(o))}),t}projectRoundWithSkew(e,n){let t=[],{skewX:i,skewY:o,scaleX:s,scaleY:l,strokeUniform:c}=this.options,a=new M(Math.tan(lt(i)),Math.tan(lt(o))),u=this.strokeProjectionMagnitude,d=c?u/l/Math.sqrt(1/l**2+1/s**2*a.y**2):u/Math.sqrt(1+a.y**2),h=new M(Math.sqrt(Math.max(u**2-d**2,0)),d),f=c?u/Math.sqrt(1+a.x**2*(1/l)**2/(1/s+1/s*a.x*a.y)**2):u/Math.sqrt(1+a.x**2/(1+a.x*a.y)**2),p=new M(f,Math.sqrt(Math.max(u**2-f**2,0)));return[p,p.scalarMultiply(-1),h,h.scalarMultiply(-1)].map(g=>this.applySkew(c?g.multiply(this.strokeUniformScalar):g)).forEach(g=>{Qv(g,e,n)&&t.push(this.applySkew(this.A).add(g))}),t}projectRound(){let e=[];e.push(...this.projectBevel());let n=this.alpha%vi==0,t=this.applySkew(this.A),i=e[n?0:2].subtract(t),o=e[n?1:0].subtract(t),s=n?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),l=Ka(i,s)>0,c=l?i:o,a=l?o:i;return this.isSkewed()?e.push(...this.projectRoundWithSkew(c,a)):e.push(...this.projectRoundNoSkew(c,a)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}},Af=class extends If{constructor(e,n,t){super(t),this.A=new M(e),this.T=new M(n)}calcOrthogonalProjection(e,n){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude,i=this.createSideVector(e,n);return this.scaleUnitVector(Fb(i),t)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){let e=[];if(!this.isSkewed()&&this.A.eq(this.T)){let n=new M(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(n)),this.applySkew(this.A.subtract(n)))}else e.push(...new Of(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){let e=[];if(this.A.eq(this.T)){let n=new M(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(n),this.A.subtract(n))}else{let n=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),t=this.scaleUnitVector(Kf(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),i=this.A.add(t);e.push(i.add(n),i.subtract(n))}return e.map(n=>this.applySkew(n))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}},tI=function(r,e){let n=arguments.length>2&&arguments[2]!==void 0&&arguments[2],t=[];if(r.length===0)return t;let i=r.reduce((o,s)=>(o[o.length-1].eq(s)||o.push(new M(s)),o),[new M(r[0])]);if(i.length===1)n=!0;else if(!n){let o=i[0],s=((l,c)=>{for(let a=l.length-1;a>=0;a--)if(c(l[a],a,l))return a;return-1})(i,l=>!l.eq(o));i.splice(s+1)}return i.forEach((o,s,l)=>{let c,a;s===0?(a=l[1],c=n?o:l[l.length-1]):s===l.length-1?(c=l[s-1],a=n?o:l[0]):(c=l[s-1],a=l[s+1]),n&&l.length===1?t.push(...new Af(o,o,e).project()):!n||s!==0&&s!==l.length-1?t.push(...new Of(o,c,a,e).project()):t.push(...new Af(o,s===0?a:c,e).project())}),t},Vb=r=>{let e={};return Object.keys(r).forEach(n=>{e[n]={},Object.keys(r[n]).forEach(t=>{e[n][t]=E({},r[n][t])})}),e},nI=r=>r.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Jf=r=>{let e=[];for(let n,t=0;t<r.length;t++)(n=PH(r,t))!==!1&&e.push(n);return e},PH=(r,e)=>{let n=r.charCodeAt(e);if(isNaN(n))return"";if(n<55296||n>57343)return r.charAt(e);if(55296<=n&&n<=56319){if(r.length<=e+1)throw"High surrogate without following low surrogate";let i=r.charCodeAt(e+1);if(56320>i||i>57343)throw"High surrogate without following low surrogate";return r.charAt(e)+r.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";let t=r.charCodeAt(e-1);if(55296>t||t>56319)throw"Low surrogate without preceding high surrogate";return!1},MH=Object.freeze({__proto__:null,capitalize:function(r){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(r.charAt(0).toUpperCase()).concat(e?r.slice(1):r.slice(1).toLowerCase())},escapeXml:nI,graphemeSplit:Jf}),Qf=function(r,e){let n=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return r.fill!==e.fill||r.stroke!==e.stroke||r.strokeWidth!==e.strokeWidth||r.fontSize!==e.fontSize||r.fontFamily!==e.fontFamily||r.fontWeight!==e.fontWeight||r.fontStyle!==e.fontStyle||r.textBackgroundColor!==e.textBackgroundColor||r.deltaY!==e.deltaY||n&&(r.overline!==e.overline||r.underline!==e.underline||r.linethrough!==e.linethrough)},rI=(r,e)=>{let n=e.split(`
`),t=[],i=-1,o={};r=Vb(r);for(let s=0;s<n.length;s++){let l=Jf(n[s]);if(r[s])for(let c=0;c<l.length;c++){i++;let a=r[s][c];a&&Object.keys(a).length>0&&(Qf(o,a,!0)?t.push({start:i,end:i+1,style:a}):t[t.length-1].end++),o=a||{}}else i+=l.length,o={}}return t},iI=(r,e)=>{if(!Array.isArray(r))return Vb(r);let n=e.split(Eb),t={},i=-1,o=0;for(let s=0;s<n.length;s++){let l=Jf(n[s]);for(let c=0;c<l.length;c++)i++,r[o]&&r[o].start<=i&&i<r[o].end&&(t[s]=t[s]||{},t[s][c]=E({},r[o].style),i===r[o].end-1&&o++)}return t},so=["display","transform",Ot,"fill-opacity","fill-rule","opacity",wn,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function ZC(r,e){let n=r.nodeName,t=r.getAttribute("class"),i=r.getAttribute("id"),o="(?![a-zA-Z\\-]+)",s;if(s=new RegExp("^"+n,"i"),e=e.replace(s,""),i&&e.length&&(s=new RegExp("#"+i+o,"i"),e=e.replace(s,"")),t&&e.length){let l=t.split(" ");for(let c=l.length;c--;)s=new RegExp("\\."+l[c]+o,"i"),e=e.replace(s,"")}return e.length===0}function NH(r,e){let n=!0,t=ZC(r,e.pop());return t&&e.length&&(n=function(i,o){let s,l=!0;for(;i.parentElement&&i.parentElement.nodeType===1&&o.length;)l&&(s=o.pop()),l=ZC(i=i.parentElement,s);return o.length===0}(r,e)),t&&n&&e.length===0}var RH=r=>{var e;return(e=gH[r])!==null&&e!==void 0?e:r},kH=new RegExp("(".concat(br,")"),"gi"),FH=r=>r.replace(kH," $1 ").replace(/,/gi," ").replace(/\s+/gi," "),JC,QC,e1,t1,n1,r1,i1,ln="(".concat(br,")"),LH=String.raw(JC||(JC=io(["(skewX)(",")"],["(skewX)\\(","\\)"])),ln),BH=String.raw(QC||(QC=io(["(skewY)(",")"],["(skewY)\\(","\\)"])),ln),jH=String.raw(e1||(e1=io(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),ln,ln,ln),VH=String.raw(t1||(t1=io(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),ln,ln),$H=String.raw(n1||(n1=io(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),ln,ln),UH=String.raw(r1||(r1=io(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),ln,ln,ln,ln,ln,ln),$b="(?:".concat(UH,"|").concat($H,"|").concat(jH,"|").concat(VH,"|").concat(LH,"|").concat(BH,")"),HH="(?:".concat($b,"*)"),zH=String.raw(i1||(i1=io(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),HH),GH=new RegExp(zH),WH=new RegExp($b),qH=new RegExp($b,"g");function lb(r){let e=[];if(!(r=FH(r).replace(/\s*([()])\s*/gi,"$1"))||r&&!GH.test(r))return[...cn];for(let n of r.matchAll(qH)){let t=WH.exec(n[0]);if(!t)continue;let i=cn,o=t.filter(p=>!!p),[,s,...l]=o,[c,a,u,d,h,f]=l.map(p=>parseFloat(p));switch(s){case"translate":i=sl(c,a);break;case Db:i=al({angle:c},{x:a,y:u});break;case zf:i=Wf(c,a);break;case il:i=Ob(c);break;case ol:i=Ab(c);break;case"matrix":i=[c,a,u,d,h,f]}e.push(i)}return Gf(e)}function YH(r,e,n,t){let i=Array.isArray(e),o,s=e;if(r!==Ot&&r!==wn||e!==bn){if(r==="strokeUniform")return e==="non-scaling-stroke";if(r==="strokeDashArray")s=e===bn?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(r==="transformMatrix")s=n&&n.transformMatrix?ct(n.transformMatrix,lb(e)):lb(e);else if(r==="visible")s=e!==bn&&e!=="hidden",n&&n.visible===!1&&(s=!1);else if(r==="opacity")s=parseFloat(e),n&&n.opacity!==void 0&&(s*=n.opacity);else if(r==="textAnchor")s=e==="start"?Le:e==="end"?pt:he;else if(r==="charSpacing")o=hs(e,t)/t*1e3;else if(r==="paintFirst"){let l=e.indexOf(Ot),c=e.indexOf(wn);s=Ot,(l>-1&&c>-1&&c<l||l===-1&&c>-1)&&(s=wn)}else{if(r==="href"||r==="xlink:href"||r==="font"||r==="id")return e;if(r==="imageSmoothing")return e==="optimizeQuality";o=i?e.map(hs):hs(e,t)}}else s="";return!i&&isNaN(o)?s:o}function XH(r,e){let n=r.match(pH);if(!n)return;let t=n[1],i=n[3],o=n[4],s=n[5],l=n[6];t&&(e.fontStyle=t),i&&(e.fontWeight=isNaN(parseFloat(i))?i:parseFloat(i)),o&&(e.fontSize=hs(o)),l&&(e.fontFamily=l),s&&(e.lineHeight=s==="normal"?1:s)}function KH(r,e){r.replace(/;\s*$/,"").split(";").forEach(n=>{if(!n)return;let[t,i]=n.split(":");e[t.trim().toLowerCase()]=i.trim()})}function ZH(r){let e={},n=r.getAttribute("style");return n&&(typeof n=="string"?KH(n,e):function(t,i){Object.entries(t).forEach(o=>{let[s,l]=o;l!==void 0&&(i[s.toLowerCase()]=l)})}(n,e)),e}var JH={stroke:"strokeOpacity",fill:"fillOpacity"};function wi(r,e,n){if(!r)return{};let t,i={},o=Sb;r.parentNode&&WC.test(r.parentNode.nodeName)&&(i=wi(r.parentElement,e,n),i.fontSize&&(t=o=hs(i.fontSize)));let s=E(E(E({},e.reduce((a,u)=>{let d=r.getAttribute(u);return d&&(a[u]=d),a},{})),function(a){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d={};for(let h in u)NH(a,h.split(" "))&&(d=E(E({},d),u[h]));return d}(r,n)),ZH(r));s[Fv]&&r.setAttribute(Fv,s[Fv]),s[kv]&&(t=hs(s[kv],o),s[kv]="".concat(t));let l={};for(let a in s){let u=RH(a),d=YH(u,s[a],i,t);l[u]=d}l&&l.font&&XH(l.font,l);let c=E(E({},i),l);return WC.test(r.nodeName)?c:function(a){let u=Rt.getDefaults();return Object.entries(JH).forEach(d=>{let[h,f]=d;if(a[f]===void 0||a[h]==="")return;if(a[h]===void 0){if(!u[h])return;a[h]=u[h]}if(a[h].indexOf("url(")===0)return;let p=new dn(a[h]);a[h]=p.setAlpha(tt(p.getAlpha()*a[f],2)).toRgba()}),a}(c)}var QH=["left","top","width","height","visible"],oI=["rx","ry"],yr=class r extends Rt{static getDefaults(){return E(E({},super.getDefaults()),r.ownDefaults)}constructor(e){super(),Object.assign(this,r.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){let{rx:e,ry:n}=this;e&&!n?this.ry=e:n&&!e&&(this.rx=n)}_render(e){let{width:n,height:t}=this,i=-n/2,o=-t/2,s=this.rx?Math.min(this.rx,n/2):0,l=this.ry?Math.min(this.ry,t/2):0,c=s!==0||l!==0;e.beginPath(),e.moveTo(i+s,o),e.lineTo(i+n-s,o),c&&e.bezierCurveTo(i+n-Yi*s,o,i+n,o+Yi*l,i+n,o+l),e.lineTo(i+n,o+t-l),c&&e.bezierCurveTo(i+n,o+t-Yi*l,i+n-Yi*s,o+t,i+n-s,o+t),e.lineTo(i+s,o+t),c&&e.bezierCurveTo(i+Yi*s,o+t,i,o+t-Yi*l,i,o+t-l),e.lineTo(i,o+l),c&&e.bezierCurveTo(i,o+Yi*l,i+Yi*s,o,i+s,o),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...oI,...e])}_toSVG(){let{width:e,height:n,rx:t,ry:i}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-n/2,'" rx="').concat(t,'" ry="').concat(i,'" width="').concat(e,'" height="').concat(n,`" />
`)]}static fromElement(e,n,t){return F(this,null,function*(){let i=wi(e,this.ATTRIBUTE_NAMES,t),{left:o=0,top:s=0,width:l=0,height:c=0,visible:a=!0}=i,u=nt(i,QH);return new this(E(E(E({},n),u),{},{left:o,top:s,width:l,height:c,visible:!!(a&&l&&c)}))})}};D(yr,"type","Rect"),D(yr,"cacheProperties",[...bi,...oI]),D(yr,"ownDefaults",{rx:0,ry:0}),D(yr,"ATTRIBUTE_NAMES",[...so,"x","y","rx","ry","width","height"]),G.setClass(yr),G.setSVGClass(yr);var gi="initialization",Pf="added",Ub="removed",Mf="imperative",sI=(r,e)=>{let{strokeUniform:n,strokeWidth:t,width:i,height:o,group:s}=e,l=s&&s!==r?Hc(s.calcTransformMatrix(),r.calcTransformMatrix()):null,c=l?e.getRelativeCenterPoint().transform(l):e.getRelativeCenterPoint(),a=!e.isStrokeAccountedForInDimensions(),u=n&&a?A1(new M(t,t),void 0,r.calcTransformMatrix()):Cb,d=!n&&a?t:0,h=qf(i+d,o+d,Gf([l,e.calcOwnMatrix()],!0)).add(u).scalarDivide(2);return[c.subtract(h),c.add(h)]},tl=class{calcLayoutResult(e,n){if(this.shouldPerformLayout(e))return this.calcBoundingBox(n,e)}shouldPerformLayout(e){let{type:n,prevStrategy:t,strategy:i}=e;return n===gi||n===Mf||!!t&&i!==t}shouldLayoutClipPath(e){let{type:n,target:{clipPath:t}}=e;return n!==gi&&t&&!t.absolutePositioned}getInitialSize(e,n){return n.size}calcBoundingBox(e,n){let{type:t,target:i}=n;if(t===Mf&&n.overrides)return n.overrides;if(e.length===0)return;let{left:o,top:s,width:l,height:c}=Br(e.map(d=>sI(i,d)).reduce((d,h)=>d.concat(h),[])),a=new M(l,c),u=new M(o,s).add(a.scalarDivide(2));if(t===gi){let d=this.getInitialSize(n,{size:a,center:u});return{center:u,relativeCorrection:new M(0,0),size:d}}return{center:u.transform(i.calcOwnMatrix()),size:a}}};D(tl,"type","strategy");var jc=class extends tl{shouldPerformLayout(e){return!0}};D(jc,"type","fit-content"),G.setClass(jc);var e6=["strategy"],t6=["target","strategy","bubbles","prevStrategy"],aI="layoutManager",ms=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new jc;D(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){let n=E(E({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(n);let t=this.getLayoutResult(n);t&&this.commitLayout(n,t),this.onAfterLayout(n,t),this._prevLayoutStrategy=n.strategy}attachHandlers(e,n){let{target:t}=n;return[yf,h1,Rc,f1,Hf,p1,mf,g1,lH].map(i=>e.on(i,o=>this.performLayout(i===yf?{type:"object_modified",trigger:i,e:o,target:t}:{type:"object_modifying",trigger:i,e:o,target:t})))}subscribe(e,n){this.unsubscribe(e,n);let t=this.attachHandlers(e,n);this._subscriptions.set(e,t)}unsubscribe(e,n){(this._subscriptions.get(e)||[]).forEach(t=>t()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(n=>this.unsubscribe(n,e))}subscribeTargets(e){e.targets.forEach(n=>this.subscribe(n,e))}onBeforeLayout(e){let{target:n,type:t}=e,{canvas:i}=n;if(t===gi||t===Pf?this.subscribeTargets(e):t===Ub&&this.unsubscribeTargets(e),n.fire("layout:before",{context:e}),i&&i.fire("object:layout:before",{target:n,context:e}),t===Mf&&e.deep){let o=nt(e,e6);n.forEachObject(s=>s.layoutManager&&s.layoutManager.performLayout(E(E({},o),{},{bubbles:!1,target:s})))}}getLayoutResult(e){let{target:n,strategy:t,type:i}=e,o=t.calcLayoutResult(e,n.getObjects());if(!o)return;let s=i===gi?new M:n.getRelativeCenterPoint(),{center:l,correction:c=new M,relativeCorrection:a=new M}=o,u=s.subtract(l).add(c).transform(i===gi?cn:Rn(n.calcOwnMatrix()),!0).add(a);return{result:o,prevCenter:s,nextCenter:l,offset:u}}commitLayout(e,n){let{target:t}=e,{result:{size:i},nextCenter:o}=n;var s,l;t.set({width:i.x,height:i.y}),this.layoutObjects(e,n),e.type===gi?t.set({left:(s=e.x)!==null&&s!==void 0?s:o.x+i.x*_t(t.originX),top:(l=e.y)!==null&&l!==void 0?l:o.y+i.y*_t(t.originY)}):(t.setPositionByOrigin(o,he,he),t.setCoords(),t.set("dirty",!0))}layoutObjects(e,n){let{target:t}=e;t.forEachObject(i=>{i.group===t&&this.layoutObject(e,n,i)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,n,t.clipPath)}layoutObject(e,n,t){let{offset:i}=n;t.set({left:t.left+i.x,top:t.top+i.y})}onAfterLayout(e,n){let{target:t,strategy:i,bubbles:o,prevStrategy:s}=e,l=nt(e,t6),{canvas:c}=t;t.fire("layout:after",{context:e,result:n}),c&&c.fire("object:layout:after",{context:e,result:n,target:t});let a=t.parent;o&&a!=null&&a.layoutManager&&((l.path||(l.path=[])).push(t),a.layoutManager.performLayout(E(E({},l),{},{target:a}))),t.set("dirty",!0)}dispose(){let{_subscriptions:e}=this;e.forEach(n=>n.forEach(t=>t())),e.clear()}toObject(){return{type:aI,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}};G.setClass(ms,aI);var n6=["type","objects","layoutManager"],cb=class extends ms{performLayout(){}},Qi=class r extends m1(Rt){static getDefaults(){return E(E({},super.getDefaults()),r.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),D(this,"_activeObjects",[]),D(this,"__objectSelectionTracker",void 0),D(this,"__objectSelectionDisposer",void 0),Object.assign(this,r.ownDefaults),this.setOptions(n),this.groupInit(e,n)}groupInit(e,n){var t;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(i=>{this.enterGroup(i,!1)}),this.layoutManager=(t=n.layoutManager)!==null&&t!==void 0?t:new ms,this.layoutManager.performLayout({type:gi,target:this,targets:[...e],x:n.left,y:n.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(eo("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(eo("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((n,t,i)=>this.canEnterGroup(n)&&i.indexOf(n)===t)}add(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];let i=this._filterObjectsBeforeEnteringGroup(n),o=super.add(...i);return this._onAfterObjectsChange(Pf,i),o}insertAt(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),i=1;i<n;i++)t[i-1]=arguments[i];let o=this._filterObjectsBeforeEnteringGroup(t),s=super.insertAt(e,...o);return this._onAfterObjectsChange(Pf,o),s}remove(){let e=super.remove(...arguments);return this._onAfterObjectsChange(Ub,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,n){this.exitGroup(e,n),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,n){this.layoutManager.performLayout({type:e,targets:n,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,n){let t=this[e];return super._set(e,n),e==="canvas"&&t!==n&&(this._objects||[]).forEach(i=>{i._set(e,n)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,n){let{target:t}=n,i=this._activeObjects;if(e)i.push(t),this._set("dirty",!0);else if(i.length>0){let o=i.indexOf(t);o>-1&&(i.splice(o,1),this._set("dirty",!0))}}_watchObject(e,n){e&&this._watchObject(!1,n),e?(n.on("selected",this.__objectSelectionTracker),n.on("deselected",this.__objectSelectionDisposer)):(n.off("selected",this.__objectSelectionTracker),n.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,n){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,n)}_enterGroup(e,n){n&&el(e,ct(Rn(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);let t=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();t&&(t===e||e.isDescendantOf(t))&&this._activeObjects.push(e)}exitGroup(e,n){this._exitGroup(e,n),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,n){e._set("group",void 0),n||(el(e,ct(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);let t=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;t>-1&&this._activeObjects.splice(t,1)}shouldCache(){let e=Rt.prototype.shouldCache.call(this);if(e){for(let n=0;n<this._objects.length;n++)if(this._objects[n].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,n,t){this._renderBackground(e);for(let o=0;o<this._objects.length;o++){var i;let s=this._objects[o];(i=this.canvas)!==null&&i!==void 0&&i.preserveObjectStacking&&s.group!==this?(e.save(),e.transform(...Rn(this.calcTransformMatrix())),s.render(e),e.restore()):s.group===this&&s.render(e)}this._drawClipPath(e,this.clipPath,t)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(E({target:this,type:Mf},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,n){let t=this.includeDefaultValues;return this._objects.filter(function(i){return!i.excludeFromExport}).map(function(i){let o=i.includeDefaultValues;i.includeDefaultValues=t;let s=i[e||"toObject"](n);return i.includeDefaultValues=o,s})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=this.layoutManager.toObject();return E(E(E({},super.toObject(["subTargetCheck","interactive",...e])),n.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:n}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";let n=yr.prototype._toSVG.call(this),t=n.indexOf("COMMON_PARTS");n[t]='for="group" ';let i=n.join("");return e?e(i):i}_toSVG(e){let n=["<g ","COMMON_PARTS",` >
`],t=this._createSVGBgRect(e);t&&n.push("		",t);for(let i=0;i<this._objects.length;i++)n.push("		",this._objects[i].toSVG(e));return n.push(`</g>
`),n}getSvgStyles(){let e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",n=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),n].join("")}toClipPathSVG(e){let n=[],t=this._createSVGBgRect(e);t&&n.push("	",t);for(let i=0;i<this._objects.length;i++)n.push("	",this._objects[i].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(n,{reviver:e})}static fromObject(e,n){let{type:t,objects:i=[],layoutManager:o}=e,s=nt(e,n6);return Promise.all([Qa(i,n),Uc(s,n)]).then(l=>{let[c,a]=l,u=new this(c,E(E(E({},s),a),{},{layoutManager:new cb}));if(o){let d=G.getClass(o.type),h=G.getClass(o.strategy);u.layoutManager=new d(new h)}else u.layoutManager=new ms;return u.layoutManager.subscribeTargets({type:gi,target:u,targets:u.getObjects()}),u.setCoords(),u})}};D(Qi,"type","Group"),D(Qi,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),G.setClass(Qi);var lI=(r,e)=>Math.min(e.width/r.width,e.height/r.height),cI=(r,e)=>Math.max(e.width/r.width,e.height/r.height),ub="\\s*,?\\s*",Ec="".concat(ub,"(").concat(br,")"),r6="".concat(Ec).concat(Ec).concat(Ec).concat(ub,"([01])").concat(ub,"([01])").concat(Ec).concat(Ec),i6={m:"l",M:"L"},o6=(r,e,n,t,i,o,s,l,c,a,u)=>{let d=_r(r),h=Tr(r),f=_r(e),p=Tr(e),g=n*i*f-t*o*p+s,y=t*i*f+n*o*p+l;return["C",a+c*(-n*i*h-t*o*d),u+c*(-t*i*h+n*o*d),g+c*(n*i*p+t*o*f),y+c*(t*i*p-n*o*f),g,y]},o1=(r,e,n,t)=>{let i=Math.atan2(e,r),o=Math.atan2(t,n);return o>=i?o-i:2*Math.PI-(i-o)};function db(r,e,n,t,i,o,s,l){let c;if(Oe.cachesBoundsOfCurve&&(c=[...arguments].join(),Ic.boundsOfCurveCache[c]))return Ic.boundsOfCurveCache[c];let a=Math.sqrt,u=Math.abs,d=[],h=[[0,0],[0,0]],f=6*r-12*n+6*i,p=-3*r+9*n-9*i+3*s,g=3*n-3*r;for(let A=0;A<2;++A){if(A>0&&(f=6*e-12*t+6*o,p=-3*e+9*t-9*o+3*l,g=3*t-3*e),u(p)<1e-12){if(u(f)<1e-12)continue;let we=-g/f;0<we&&we<1&&d.push(we);continue}let L=f*f-4*g*p;if(L<0)continue;let H=a(L),q=(-f+H)/(2*p);0<q&&q<1&&d.push(q);let $=(-f-H)/(2*p);0<$&&$<1&&d.push($)}let y=d.length,w=y,v=dI(r,e,n,t,i,o,s,l);for(;y--;){let{x:A,y:L}=v(d[y]);h[0][y]=A,h[1][y]=L}h[0][w]=r,h[1][w]=e,h[0][w+1]=s,h[1][w+1]=l;let x=[new M(Math.min(...h[0]),Math.min(...h[1])),new M(Math.max(...h[0]),Math.max(...h[1]))];return Oe.cachesBoundsOfCurve&&(Ic.boundsOfCurveCache[c]=x),x}var s6=(r,e,n)=>{let[t,i,o,s,l,c,a,u]=n,d=((h,f,p,g,y,w,v)=>{if(p===0||g===0)return[];let x=0,A=0,L=0,H=Math.PI,q=v*xb,$=Tr(q),we=_r(q),ne=.5*(-we*h-$*f),He=.5*(-we*f+$*h),_e=p**2,Ee=g**2,Pe=He**2,Ve=ne**2,oe=_e*Ee-_e*Pe-Ee*Ve,yt=Math.abs(p),$e=Math.abs(g);if(oe<0){let ke=Math.sqrt(1-oe/(_e*Ee));yt*=ke,$e*=ke}else L=(y===w?-1:1)*Math.sqrt(oe/(_e*Pe+Ee*Ve));let Ze=L*yt*He/$e,Gt=-L*$e*ne/yt,Je=we*Ze-$*Gt+.5*h,rt=$*Ze+we*Gt+.5*f,Tn=o1(1,0,(ne-Ze)/yt,(He-Gt)/$e),Bt=o1((ne-Ze)/yt,(He-Gt)/$e,(-ne-Ze)/yt,(-He-Gt)/$e);w===0&&Bt>0?Bt-=2*H:w===1&&Bt<0&&(Bt+=2*H);let Wr=Math.ceil(Math.abs(Bt/H*2)),Qt=[],jt=Bt/Wr,en=8/3*Math.sin(jt/4)*Math.sin(jt/4)/Math.sin(jt/2),ar=Tn+jt;for(let ke=0;ke<Wr;ke++)Qt[ke]=o6(Tn,ar,we,$,yt,$e,Je,rt,en,x,A),x=Qt[ke][5],A=Qt[ke][6],Tn=ar,ar+=jt;return Qt})(a-r,u-e,i,o,l,c,s);for(let h=0,f=d.length;h<f;h++)d[h][1]+=r,d[h][2]+=e,d[h][3]+=r,d[h][4]+=e,d[h][5]+=r,d[h][6]+=e;return d},uI=r=>{let e=0,n=0,t=0,i=0,o=[],s,l=0,c=0;for(let a of r){let u=[...a],d;switch(u[0]){case"l":u[1]+=e,u[2]+=n;case"L":e=u[1],n=u[2],d=["L",e,n];break;case"h":u[1]+=e;case"H":e=u[1],d=["L",e,n];break;case"v":u[1]+=n;case"V":n=u[1],d=["L",e,n];break;case"m":u[1]+=e,u[2]+=n;case"M":e=u[1],n=u[2],t=u[1],i=u[2],d=["M",e,n];break;case"c":u[1]+=e,u[2]+=n,u[3]+=e,u[4]+=n,u[5]+=e,u[6]+=n;case"C":l=u[3],c=u[4],e=u[5],n=u[6],d=["C",u[1],u[2],l,c,e,n];break;case"s":u[1]+=e,u[2]+=n,u[3]+=e,u[4]+=n;case"S":s==="C"?(l=2*e-l,c=2*n-c):(l=e,c=n),e=u[3],n=u[4],d=["C",l,c,u[1],u[2],e,n],l=d[3],c=d[4];break;case"q":u[1]+=e,u[2]+=n,u[3]+=e,u[4]+=n;case"Q":l=u[1],c=u[2],e=u[3],n=u[4],d=["Q",l,c,e,n];break;case"t":u[1]+=e,u[2]+=n;case"T":s==="Q"?(l=2*e-l,c=2*n-c):(l=e,c=n),e=u[1],n=u[2],d=["Q",l,c,e,n];break;case"a":u[6]+=e,u[7]+=n;case"A":s6(e,n,u).forEach(h=>o.push(h)),e=u[6],n=u[7];break;case"z":case"Z":e=t,n=i,d=["Z"]}d?(o.push(d),s=d[0]):s=""}return o},Nf=(r,e,n,t)=>Math.sqrt((n-r)**2+(t-e)**2),dI=(r,e,n,t,i,o,s,l)=>c=>{let a=c**3,u=(f=>3*f**2*(1-f))(c),d=(f=>3*f*(1-f)**2)(c),h=(f=>(1-f)**3)(c);return new M(s*a+i*u+n*d+r*h,l*a+o*u+t*d+e*h)},hI=r=>r**2,fI=r=>2*r*(1-r),pI=r=>(1-r)**2,a6=(r,e,n,t,i,o,s,l)=>c=>{let a=hI(c),u=fI(c),d=pI(c),h=3*(d*(n-r)+u*(i-n)+a*(s-i)),f=3*(d*(t-e)+u*(o-t)+a*(l-o));return Math.atan2(f,h)},l6=(r,e,n,t,i,o)=>s=>{let l=hI(s),c=fI(s),a=pI(s);return new M(i*l+n*c+r*a,o*l+t*c+e*a)},c6=(r,e,n,t,i,o)=>s=>{let l=1-s,c=2*(l*(n-r)+s*(i-n)),a=2*(l*(t-e)+s*(o-t));return Math.atan2(a,c)},s1=(r,e,n)=>{let t=new M(e,n),i=0;for(let o=1;o<=100;o+=1){let s=r(o/100);i+=Nf(t.x,t.y,s.x,s.y),t=s}return i},u6=(r,e)=>{let n,t=0,i=0,o={x:r.x,y:r.y},s=E({},o),l=.01,c=0,a=r.iterator,u=r.angleFinder;for(;i<e&&l>1e-4;)s=a(t),c=t,n=Nf(o.x,o.y,s.x,s.y),n+i>e?(t-=l,l/=2):(o=s,t+=l,i+=n);return E(E({},s),{},{angle:u(c)})},Hb=r=>{let e,n,t=0,i=0,o=0,s=0,l=0,c=[];for(let a of r){let u={x:i,y:o,command:a[0],length:0};switch(a[0]){case"M":n=u,n.x=s=i=a[1],n.y=l=o=a[2];break;case"L":n=u,n.length=Nf(i,o,a[1],a[2]),i=a[1],o=a[2];break;case"C":e=dI(i,o,a[1],a[2],a[3],a[4],a[5],a[6]),n=u,n.iterator=e,n.angleFinder=a6(i,o,a[1],a[2],a[3],a[4],a[5],a[6]),n.length=s1(e,i,o),i=a[5],o=a[6];break;case"Q":e=l6(i,o,a[1],a[2],a[3],a[4]),n=u,n.iterator=e,n.angleFinder=c6(i,o,a[1],a[2],a[3],a[4]),n.length=s1(e,i,o),i=a[3],o=a[4];break;case"Z":n=u,n.destX=s,n.destY=l,n.length=Nf(i,o,s,l),i=s,o=l}t+=n.length,c.push(n)}return c.push({length:t,x:i,y:o}),c},gI=function(r,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Hb(r),t=0;for(;e-n[t].length>0&&t<n.length-2;)e-=n[t].length,t++;let i=n[t],o=e/i.length,s=r[t];switch(i.command){case"M":return{x:i.x,y:i.y,angle:0};case"Z":return E(E({},new M(i.x,i.y).lerp(new M(i.destX,i.destY),o)),{},{angle:Math.atan2(i.destY-i.y,i.destX-i.x)});case"L":return E(E({},new M(i.x,i.y).lerp(new M(s[1],s[2]),o)),{},{angle:Math.atan2(s[2]-i.y,s[1]-i.x)});case"C":case"Q":return u6(i,e)}},d6=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),a1=new RegExp(r6,"g"),h6=new RegExp(br,"gi"),f6={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},mI=r=>{var e;let n=[],t=(e=r.match(d6))!==null&&e!==void 0?e:[];for(let i of t){let o=i[0];if(o==="z"||o==="Z"){n.push([o]);continue}let s=f6[o.toLowerCase()],l=[];if(o==="a"||o==="A"){a1.lastIndex=0;for(let c=null;c=a1.exec(i);)l.push(...c.slice(1))}else l=i.match(h6)||[];for(let c=0;c<l.length;c+=s){let a=new Array(s),u=i6[o];a[0]=c>0&&u?u:o;for(let d=0;d<s;d++)a[d+1]=parseFloat(l[c+d]);n.push(a)}}return n},p6=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=new M(r[0]),t=new M(r[1]),i=1,o=0,s=[],l=r.length,c=l>2,a;for(c&&(i=r[2].x<t.x?-1:r[2].x===t.x?0:1,o=r[2].y<t.y?-1:r[2].y===t.y?0:1),s.push(["M",n.x-i*e,n.y-o*e]),a=1;a<l;a++){if(!n.eq(t)){let u=n.midPointFrom(t);s.push(["Q",n.x,n.y,u.x,u.y])}n=r[a],a+1<r.length&&(t=r[a+1])}return c&&(i=n.x>r[a-2].x?1:n.x===r[a-2].x?0:-1,o=n.y>r[a-2].y?1:n.y===r[a-2].y?0:-1),s.push(["L",n.x+i*e,n.y+o*e]),s},yI=(r,e)=>r.map(n=>n.map((t,i)=>i===0||e===void 0?t:tt(t,e)).join(" ")).join(" ");function Rf(r,e){let n=r.style;n&&e&&(typeof e=="string"?n.cssText+=";"+e:Object.entries(e).forEach(t=>{let[i,o]=t;return n.setProperty(i,o)}))}var g6=(r,e)=>Math.floor(Math.random()*(e-r+1))+r;function m6(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.onComplete||ds,t=new(Uf()).XMLHttpRequest,i=e.signal,o=function(){t.abort()},s=function(){i&&i.removeEventListener("abort",o),t.onerror=t.ontimeout=ds};if(i&&i.aborted)throw new gf("request");return i&&i.addEventListener("abort",o,{once:!0}),t.onreadystatechange=function(){t.readyState===4&&(s(),n(t),t.onreadystatechange=ds)},t.onerror=t.ontimeout=s,t.open("get",r,!0),t.send(),t}var y6=(r,e)=>{let n=r._findCenterFromElement();r.transformMatrix&&((t=>{if(t.transformMatrix){let{scaleX:i,scaleY:o,angle:s,skewX:l}=Ja(t.transformMatrix);t.flipX=!1,t.flipY=!1,t.set(un,i),t.set(kn,o),t.angle=s,t.skewX=l,t.skewY=0}})(r),n=n.transform(r.transformMatrix)),delete r.transformMatrix,e&&(r.scaleX*=e.scaleX,r.scaleY*=e.scaleY,r.cropX=e.cropX,r.cropY=e.cropY,n.x+=e.offsetLeft,n.y+=e.offsetTop,r.width=e.width,r.height=e.height),r.setPositionByOrigin(n,he,he)},Cee=Object.freeze({__proto__:null,addTransformToObject:I1,animate:Lb,animateColor:B1,applyTransformToObject:el,calcAngleBetweenVectors:Df,calcDimensionsMatrix:$c,calcPlaneChangeMatrix:Hc,calcVectorRotation:k1,cancelAnimFrame:y1,capValue:gs,composeMatrix:T1,copyCanvasElement:r=>{var e;let n=xr(r);return(e=n.getContext("2d"))===null||e===void 0||e.drawImage(r,0,0),n},cos:_r,createCanvasElement:er,createImage:v1,createRotateMatrix:al,createScaleMatrix:Wf,createSkewXMatrix:Ob,createSkewYMatrix:Ab,createTranslateMatrix:sl,createVector:Sf,crossProduct:Ka,degreesToRadians:lt,dotProduct:F1,ease:bH,enlivenObjectEnlivables:Uc,enlivenObjects:Qa,findScaleToCover:cI,findScaleToFit:lI,getBoundsOfCurve:db,getOrthonormalVector:Fb,getPathSegmentsInfo:Hb,getPointOnPath:gI,getPointer:C1,getRandomInt:g6,getRegularPolygonPath:(r,e)=>{let n=2*Math.PI/r,t=-to;r%2==0&&(t+=n/2);let i=new Array(r+1);for(let o=0;o<r;o++){let s=o*n+t,{x:l,y:c}=new M(_r(s),Tr(s)).scalarMultiply(e);i[o]=[o===0?"M":"L",l,c]}return i[r]=["Z"],i},getSmoothPathFromPoints:p6,getSvgAttributes:r=>{let e=["instantiated_by_use","style","id","class"];switch(r){case"linearGradient":return e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return e.concat(["offset","stop-color","stop-opacity"])}return e},getUnitVector:Kf,groupSVGElements:(r,e)=>r&&r.length===1?r[0]:new Qi(r,e),hasStyleChanged:Qf,invertTransform:Rn,isBetweenVectors:Qv,isIdentityMatrix:b1,isTouchEvent:_f,isTransparent:eI,joinPath:yI,loadImage:Ac,magnitude:Ef,makeBoundingBoxFromPoints:Br,makePathSimpler:uI,matrixToSVG:kc,mergeClipPaths:(r,e)=>{var n;let t=r,i=e;t.inverted&&!i.inverted&&(t=e,i=r),Jv(i,(n=i.group)===null||n===void 0?void 0:n.calcTransformMatrix(),t.calcTransformMatrix());let o=t.inverted&&i.inverted;return o&&(t.inverted=i.inverted=!1),new Qi([t],{clipPath:i,inverted:o})},multiplyTransformMatrices:ct,multiplyTransformMatrixArray:Gf,parsePath:mI,parsePreserveAspectRatioAttribute:x1,parseUnit:hs,pick:ys,projectStrokeOnPoints:tI,qrDecompose:Ja,radiansToDegrees:ro,removeFromArray:Go,removeTransformFromObject:(r,e)=>{let n=Rn(e),t=ct(n,r.calcOwnMatrix());el(r,t)},removeTransformMatrixForSvgParsing:y6,request:m6,requestAnimFrame:Oc,resetObjectTransform:O1,rotatePoint:(r,e,n)=>r.rotate(n,e),rotateVector:kb,saveObjectTransform:Mb,sendObjectToPlane:Jv,sendPointToPlane:yi,sendVectorToPlane:A1,setStyle:Rf,sin:Tr,sizeAfterTransform:qf,string:MH,stylesFromArray:iI,stylesToArray:rI,toDataURL:Ib,toFixed:tt,transformPath:(r,e,n)=>(n&&(e=ct(e,[1,0,0,1,-n.x,-n.y])),r.map(t=>{let i=[...t];for(let o=1;o<t.length-1;o+=2){let{x:s,y:l}=Kt({x:t[o],y:t[o+1]},e);i[o]=s,i[o+1]=l}return i})),transformPoint:Kt}),hb=class extends wf{constructor(e){let{allowTouchScrolling:n=!1,containerClass:t=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),D(this,"upper",void 0),D(this,"container",void 0);let{el:i}=this.lower,o=this.createUpperCanvas();this.upper={el:o,ctx:o.getContext("2d")},this.applyCanvasStyle(i,{allowTouchScrolling:n}),this.applyCanvasStyle(o,{allowTouchScrolling:n,styles:{position:"absolute",left:"0",top:"0"}});let s=this.createContainerElement();s.classList.add(t),i.parentNode&&i.parentNode.replaceChild(s,i),s.append(i,o),this.container=s}createUpperCanvas(){let{el:e}=this.lower,n=er();return n.className=e.className,n.classList.remove("lower-canvas"),n.classList.add("upper-canvas"),n.setAttribute("data-fabric","top"),n.style.cssText=e.style.cssText,n.setAttribute("draggable","true"),n}createContainerElement(){let e=rl().createElement("div");return e.setAttribute("data-fabric","wrapper"),Rf(e,{position:"relative"}),HC(e),e}applyCanvasStyle(e,n){let{styles:t,allowTouchScrolling:i}=n;Rf(e,E(E({},t),{},{"touch-action":i?"manipulation":bn})),HC(e)}setDimensions(e,n){super.setDimensions(e,n);let{el:t,ctx:i}=this.upper;D1(t,i,e,n)}setCSSDimensions(e){super.setCSSDimensions(e),Kv(this.upper.el,e),Kv(this.container,e)}cleanupDOM(e){let n=this.container,{el:t}=this.lower,{el:i}=this.upper;super.cleanupDOM(e),n.removeChild(i),n.removeChild(t),n.parentNode&&n.parentNode.replaceChild(t,n)}dispose(){super.dispose(),jr().dispose(this.upper.el),delete this.upper,delete this.container}},kf=class r extends Lc{constructor(){super(...arguments),D(this,"targets",[]),D(this,"_hoveredTargets",[]),D(this,"_objectsToRender",void 0),D(this,"_currentTransform",null),D(this,"_groupSelector",null),D(this,"contextTopDirty",!1)}static getDefaults(){return E(E({},super.getDefaults()),r.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new hb(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){let e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(n=>!n.group&&n!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){let e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;let n=this.getRetinaScaling(),t=Math.ceil((2*e+1)*n);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=t,this.pixelFindContext.scale(n,n)}isTargetTransparent(e,n,t){let i=this.targetFindTolerance,o=this.pixelFindContext;this.clearContext(o),o.save(),o.translate(-n+i,-t+i),o.transform(...this.viewportTransform);let s=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(o),e.selectionBackgroundColor=s,o.restore();let l=Math.round(i*this.getRetinaScaling());return eI(o,l,l,l)}_isSelectionKeyPressed(e){let n=this.selectionKey;return!!n&&(Array.isArray(n)?!!n.find(t=>!!t&&e[t]===!0):e[n])}_shouldClearSelection(e,n){let t=this.getActiveObjects(),i=this._activeObject;return!!(!n||n&&i&&t.length>1&&t.indexOf(n)===-1&&i!==n&&!this._isSelectionKeyPressed(e)||n&&!n.evented||n&&!n.selectable&&i&&i!==n)}_shouldCenterTransform(e,n,t){if(!e)return;let i;return n===zf||n===un||n===kn||n===Rc?i=this.centeredScaling||e.centeredScaling:n===Db&&(i=this.centeredRotation||e.centeredRotation),i?!t:t}_getOriginFromCorner(e,n){let t={x:e.originX,y:e.originY};return n&&(["ml","tl","bl"].includes(n)?t.x=pt:["mr","tr","br"].includes(n)&&(t.x=Le),["tl","mt","tr"].includes(n)?t.y=Yv:["bl","mb","br"].includes(n)&&(t.y=vn)),t}_setupCurrentTransform(e,n,t){var i;let o=n.group?yi(this.getScenePoint(e),void 0,n.group.calcTransformMatrix()):this.getScenePoint(e),{key:s="",control:l}=n.getActiveControl()||{},c=t&&l?(i=l.getActionHandler(e,n,l))===null||i===void 0?void 0:i.bind(l):N1,a=((f,p,g,y)=>{if(!p||!f)return"drag";let w=y.controls[p];return w.getActionName(g,w,y)})(t,s,e,n),u=e[this.centeredKey],d=this._shouldCenterTransform(n,a,u)?{x:he,y:he}:this._getOriginFromCorner(n,s),h={target:n,action:a,actionHandler:c,actionPerformed:!1,corner:s,scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,offsetX:o.x-n.left,offsetY:o.y-n.top,originX:d.x,originY:d.y,ex:o.x,ey:o.y,lastX:o.x,lastY:o.y,theta:lt(n.angle),width:n.width,height:n.height,shiftKey:e.shiftKey,altKey:u,original:E(E({},Mb(n)),{},{originX:d.x,originY:d.y})};this._currentTransform=h,this.fire("before:transform",{e,transform:h})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){let{x:n,y:t,deltaX:i,deltaY:o}=this._groupSelector,s=new M(n,t).transform(this.viewportTransform),l=new M(n+i,t+o).transform(this.viewportTransform),c=this.selectionLineWidth/2,a=Math.min(s.x,l.x),u=Math.min(s.y,l.y),d=Math.max(s.x,l.x),h=Math.max(s.y,l.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(a,u,d-a,h-u)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,a+=c,u+=c,d-=c,h-=c,Rt.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(a,u,d-a,h-u))}findTarget(e){if(this.skipTargetFind)return;let n=this.getViewportPoint(e),t=this._activeObject,i=this.getActiveObjects();if(this.targets=[],t&&i.length>=1){if(t.findControl(n,_f(e))||i.length>1&&this.searchPossibleTargets([t],n))return t;if(t===this.searchPossibleTargets([t],n)){if(this.preserveObjectStacking){let o=this.targets;this.targets=[];let s=this.searchPossibleTargets(this._objects,n);return e[this.altSelectionKey]&&s&&s!==t?(this.targets=o,t):s}return t}}return this.searchPossibleTargets(this._objects,n)}_pointIsInObjectSelectionArea(e,n){let t=e.getCoords(),i=this.getZoom(),o=e.padding/i;if(o){let[s,l,c,a]=t,u=Math.atan2(l.y-s.y,l.x-s.x),d=_r(u)*o,h=Tr(u)*o,f=d+h,p=d-h;t=[new M(s.x-p,s.y-f),new M(l.x+f,l.y-p),new M(c.x+p,c.y+f),new M(a.x-f,a.y+p)]}return ps.isPointInPolygon(n,t)}_checkTarget(e,n){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,yi(n,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,n.x,n.y)))}_searchPossibleTargets(e,n){let t=e.length;for(;t--;){let i=e[t];if(this._checkTarget(i,n)){if(hf(i)&&i.subTargetCheck){let o=this._searchPossibleTargets(i._objects,n);o&&this.targets.push(o)}return i}}}searchPossibleTargets(e,n){let t=this._searchPossibleTargets(e,n);if(t&&hf(t)&&t.interactive&&this.targets[0]){let i=this.targets;for(let o=i.length-1;o>0;o--){let s=i[o];if(!hf(s)||!s.interactive)return s}return i[0]}return t}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1],t=this.upperCanvasEl,i=t.getBoundingClientRect(),o=C1(e),s=i.width||0,l=i.height||0;s&&l||(vn in i&&Yv in i&&(l=Math.abs(i.top-i.bottom)),pt in i&&Le in i&&(s=Math.abs(i.right-i.left))),this.calcOffset(),o.x=o.x-this._offset.left,o.y=o.y-this._offset.top,n||(o=yi(o,void 0,this.viewportTransform));let c=this.getRetinaScaling();c!==1&&(o.x/=c,o.y/=c);let a=s===0||l===0?new M(1,1):new M(t.width/s,t.height/l);return o.multiply(a)}_setDimensionsImpl(e,n){this._resetTransformEventData(),super._setDimensionsImpl(e,n),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=er(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){let e=this._activeObject;return Wo(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,n){let t=!1,i=!1,o=this.getActiveObjects(),s=[],l=[];e.forEach(c=>{o.includes(c)||(t=!0,c.fire("deselected",{e:n,target:c}),l.push(c))}),o.forEach(c=>{e.includes(c)||(t=!0,c.fire("selected",{e:n,target:c}),s.push(c))}),e.length>0&&o.length>0?(i=!0,t&&this.fire("selection:updated",{e:n,selected:s,deselected:l})):o.length>0?(i=!0,this.fire("selection:created",{e:n,selected:s})):e.length>0&&(i=!0,this.fire("selection:cleared",{e:n,deselected:l})),i&&(this._objectsToRender=void 0)}setActiveObject(e,n){let t=this.getActiveObjects(),i=this._setActiveObject(e,n);return this._fireSelectionEvents(t,n),i}_setActiveObject(e,n){let t=this._activeObject;return t!==e&&!(!this._discardActiveObject(n,e)&&this._activeObject)&&!e.onSelect({e:n})&&(this._activeObject=e,Wo(e)&&t!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,n){let t=this._activeObject;return!!t&&!t.onDeselect({e,object:n})&&(this._currentTransform&&this._currentTransform.target===t&&this.endCurrentTransform(e),Wo(t)&&t===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){let n=this.getActiveObjects(),t=this.getActiveObject();n.length&&this.fire("before:selection:cleared",{e,deselected:[t]});let i=this._discardActiveObject(e);return this._fireSelectionEvents(n,e),i}endCurrentTransform(e){let n=this._currentTransform;this._finalizeCurrentTransform(e),n&&n.target&&(n.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){let n=this._currentTransform,t=n.target,i={e,target:t,transform:n,action:n.action};t._scaling&&(t._scaling=!1),t.setCoords(),n.actionPerformed&&(this.fire("object:modified",i),t.fire(yf,i))}setViewportTransform(e){super.setViewportTransform(e);let n=this._activeObject;n&&n.setCoords()}destroy(){let e=this._activeObject;Wo(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){let n=this._activeObject;n&&n._renderControls(e)}_toObject(e,n,t){let i=this._realizeGroupTransformOnObject(e),o=super._toObject(e,n,t);return e.set(i),o}_realizeGroupTransformOnObject(e){let{group:n}=e;if(n&&Wo(n)&&this._activeObject===n){let t=ys(e,["angle","flipX","flipY",Le,un,kn,il,ol,vn]);return I1(e,n.calcOwnMatrix()),t}return{}}_setSVGObject(e,n,t){let i=this._realizeGroupTransformOnObject(n);super._setSVGObject(e,n,t),n.set(i)}};D(kf,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});var fb=class{constructor(e){D(this,"targets",[]),D(this,"__disposer",void 0);let n=()=>{let{hiddenTextarea:i}=e.getActiveObject()||{};i&&i.focus()},t=e.upperCanvasEl;t.addEventListener("click",n),this.__disposer=()=>t.removeEventListener("click",n)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),Go(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var n;!((n=this.target)===null||n===void 0)&&n.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}},v6=["target","oldTarget","fireCanvas","e"],Nn={passive:!1},Ua=(r,e)=>{let n=r.getViewportPoint(e),t=r.getScenePoint(e);return{viewportPoint:n,scenePoint:t,pointer:n,absolutePointer:t}},Xi=function(r){for(var e=arguments.length,n=new Array(e>1?e-1:0),t=1;t<e;t++)n[t-1]=arguments[t];return r.addEventListener(...n)},Xn=function(r){for(var e=arguments.length,n=new Array(e>1?e-1:0),t=1;t<e;t++)n[t-1]=arguments[t];return r.removeEventListener(...n)},b6={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}},nl=class extends kf{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),D(this,"_isClick",void 0),D(this,"textEditingManager",new fb(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onDoubleClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(n=>{this[n]=this[n].bind(this)}),this.addOrRemove(Xi,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,n){let t=this.upperCanvasEl,i=this._getEventPrefix();e(E1(t),"resize",this._onResize),e(t,i+"down",this._onMouseDown),e(t,"".concat(i,"move"),this._onMouseMove,Nn),e(t,"".concat(i,"out"),this._onMouseOut),e(t,"".concat(i,"enter"),this._onMouseEnter),e(t,"wheel",this._onMouseWheel),e(t,"contextmenu",this._onContextMenu),e(t,"dblclick",this._onDoubleClick),e(t,"dragstart",this._onDragStart),e(t,"dragend",this._onDragEnd),e(t,"dragover",this._onDragOver),e(t,"dragenter",this._onDragEnter),e(t,"dragleave",this._onDragLeave),e(t,"drop",this._onDrop),this.enablePointerEvents||e(t,"touchstart",this._onTouchStart,Nn)}removeListeners(){this.addOrRemove(Xn,"remove");let e=this._getEventPrefix(),n=vr(this.upperCanvasEl);Xn(n,"".concat(e,"up"),this._onMouseUp),Xn(n,"touchend",this._onTouchEnd,Nn),Xn(n,"".concat(e,"move"),this._onMouseMove,Nn),Xn(n,"touchmove",this._onMouseMove,Nn),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){let n=this._hoveredTarget,t=E({e},Ua(this,e));this.fire("mouse:out",E(E({},t),{},{target:n})),this._hoveredTarget=void 0,n&&n.fire("mouseout",E({},t)),this._hoveredTargets.forEach(i=>{this.fire("mouse:out",E(E({},t),{},{target:i})),i&&i.fire("mouseout",E({},t))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",E({e},Ua(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;let n=this.getActiveObject();if(n&&n.onDragStart(e)){this._dragSource=n;let t={e,target:n};return this.fire("dragstart",t),n.fire("dragstart",t),void Xi(this.upperCanvasEl,"drag",this._onDragProgress)}Zv(e)}_renderDragEffects(e,n,t){let i=!1,o=this._dropTarget;o&&o!==n&&o!==t&&(o.clearContextTop(),i=!0),n?.clearContextTop(),t!==n&&t?.clearContextTop();let s=this.contextTop;s.save(),s.transform(...this.viewportTransform),n&&(s.save(),n.transform(s),n.renderDragSourceEffect(e),s.restore(),i=!0),t&&(s.save(),t.transform(s),t.renderDropTargetEffect(e),s.restore(),i=!0),s.restore(),i&&(this.contextTopDirty=!0)}_onDragEnd(e){let n=!!e.dataTransfer&&e.dataTransfer.dropEffect!==bn,t=n?this._activeObject:void 0,i={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:n,dropTarget:t};Xn(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",i),this._dragSource&&this._dragSource.fire("dragend",i),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){let n={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",n),this._dragSource&&this._dragSource.fire("drag",n)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){let n="dragover",{target:t,targets:i}=this.findDragTargets(e),o=this._dragSource,s={e,target:t,subTargets:i,dragSource:o,canDrop:!1,dropTarget:void 0},l;this.fire(n,s),this._fireEnterLeaveEvents(t,s),t&&(t.canDrop(e)&&(l=t),t.fire(n,s));for(let c=0;c<i.length;c++){let a=i[c];a.canDrop(e)&&(l=a),a.fire(n,s)}this._renderDragEffects(e,o,l),this._dropTarget=l}_onDragEnter(e){let{target:n,targets:t}=this.findDragTargets(e),i={e,target:n,subTargets:t,dragSource:this._dragSource};this.fire("dragenter",i),this._fireEnterLeaveEvents(n,i)}_onDragLeave(e){let n={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",n),this._fireEnterLeaveEvents(void 0,n),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){let{target:n,targets:t}=this.findDragTargets(e),i=this._basicEventHandler("drop:before",E({e,target:n,subTargets:t,dragSource:this._dragSource},Ua(this,e)));i.didDrop=!1,i.dropTarget=void 0,this._basicEventHandler("drop",i),this.fire("drop:after",i)}_onContextMenu(e){let n=this.findTarget(e),t=this.targets||[],i=this._basicEventHandler("contextmenu:before",{e,target:n,subTargets:t});return this.stopContextMenu&&Zv(e),this._basicEventHandler("contextmenu",i),!1}_onDoubleClick(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData()}getPointerId(e){let n=e.changedTouches;return n?n[0]&&n[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let n=!this.allowTouchScrolling,t=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||t&&this._target===t)&&(n=!0),n&&e.preventDefault(),this._resetTransformEventData();let i=this.upperCanvasEl,o=this._getEventPrefix(),s=vr(i);Xi(s,"touchend",this._onTouchEnd,Nn),n&&Xi(s,"touchmove",this._onMouseMove,Nn),Xn(i,"".concat(o,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();let n=this.upperCanvasEl,t=this._getEventPrefix();Xn(n,"".concat(t,"move"),this._onMouseMove,Nn);let i=vr(n);Xi(i,"".concat(t,"up"),this._onMouseUp),Xi(i,"".concat(t,"move"),this._onMouseMove,Nn)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;let n=this._getEventPrefix(),t=vr(this.upperCanvasEl);Xn(t,"touchend",this._onTouchEnd,Nn),Xn(t,"touchmove",this._onMouseMove,Nn),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{Xi(this.upperCanvasEl,"".concat(n,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();let n=this.upperCanvasEl,t=this._getEventPrefix();if(this._isMainEvent(e)){let i=vr(this.upperCanvasEl);Xn(i,"".concat(t,"up"),this._onMouseUp),Xn(i,"".concat(t,"move"),this._onMouseMove,Nn),Xi(n,"".concat(t,"move"),this._onMouseMove,Nn)}}_onMouseMove(e){let n=this.getActiveObject();!this.allowTouchScrolling&&(!n||!n.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){let n=this.getActiveObject();return!!n!=!!e||n&&e&&n!==e}__onMouseUp(e){var n;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");let t=this._currentTransform,i=this._isClick,o=this._target,{button:s}=e;if(s)return(this.fireMiddleClick&&s===1||this.fireRightClick&&s===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let l,c,a=!1;if(t&&(this._finalizeCurrentTransform(e),a=t.actionPerformed),!i){let u=o===this._activeObject;this.handleSelection(e),a||(a=this._shouldRender(o)||!u&&o===this._activeObject)}if(o){let u=o.findControl(this.getViewportPoint(e),_f(e)),{key:d,control:h}=u||{};if(c=d,o.selectable&&o!==this._activeObject&&o.activeOn==="up")this.setActiveObject(o,e),a=!0;else if(h){let f=h.getMouseUpHandler(e,o,h);f&&(l=this.getScenePoint(e),f.call(h,e,t,l.x,l.y))}o.isMoving=!1}if(t&&(t.target!==o||t.corner!==c)){let u=t.target&&t.target.controls[t.corner],d=u&&u.getMouseUpHandler(e,t.target,u);l=l||this.getScenePoint(e),d&&d.call(u,e,t,l.x,l.y)}this._setCursorFromEvent(e,o),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,o&&(o.__corner=void 0),a?this.requestRenderAll():i||(n=this._activeObject)!==null&&n!==void 0&&n.isEditing||this.renderTop()}_basicEventHandler(e,n){let{target:t,subTargets:i=[]}=n;this.fire(e,n),t&&t.fire(e,n);for(let o=0;o<i.length;o++)i[o]!==t&&i[o].fire(e,n);return n}_handleEvent(e,n){let t=this._target,i=this.targets||[],o=E(E({e,target:t,subTargets:i},Ua(this,e)),{},{transform:this._currentTransform},n==="up:before"||n==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{});this.fire("mouse:".concat(n),o),t&&t.fire("mouse".concat(n),o);for(let s=0;s<i.length;s++)i[s]!==t&&i[s].fire("mouse".concat(n),o)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());let n=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(n,{e,pointer:n}),this._handleEvent(e,"down")}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){let n=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(n,{e,pointer:n})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){let n=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:n}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let n=this._target,{button:t}=e;if(t)return(this.fireMiddleClick&&t===1||this.fireRightClick&&t===2)&&this._handleEvent(e,"down"),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let i=this._shouldRender(n),o=!1;if(this.handleMultiSelection(e,n)?(n=this._activeObject,o=!0,i=!0):this._shouldClearSelection(e,n)&&this.discardActiveObject(e),this.selection&&(!n||!n.selectable&&!n.isEditing&&n!==this._activeObject)){let s=this.getScenePoint(e);this._groupSelector={x:s.x,y:s.y,deltaY:0,deltaX:0}}if(n){let s=n===this._activeObject;n.selectable&&n.activeOn==="down"&&this.setActiveObject(n,e);let l=n.findControl(this.getViewportPoint(e),_f(e));if(n===this._activeObject&&(l||!o)){this._setupCurrentTransform(e,n,s);let c=l?l.control:void 0,a=this.getScenePoint(e),u=c&&c.getMouseDownHandler(e,n,c);u&&u.call(c,e,this._currentTransform,a.x,a.y)}}i&&(this._objectsToRender=void 0),this._handleEvent(e,"down"),i&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=yi(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;let n=this._groupSelector;if(n){let t=this.getScenePoint(e);n.deltaX=t.x-n.x,n.deltaY=t.y-n.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{let t=this.findTarget(e);this._setCursorFromEvent(e,t),this._fireOverOutEvents(e,t)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,n){let t=this._hoveredTarget,i=this._hoveredTargets,o=this.targets,s=Math.max(i.length,o.length);this.fireSyntheticInOutEvents("mouse",{e,target:n,oldTarget:t,fireCanvas:!0});for(let l=0;l<s;l++)this.fireSyntheticInOutEvents("mouse",{e,target:o[l],oldTarget:i[l]});this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,n){let t=this._draggedoverTarget,i=this._hoveredTargets,o=this.targets,s=Math.max(i.length,o.length);this.fireSyntheticInOutEvents("drag",E(E({},n),{},{target:e,oldTarget:t,fireCanvas:!0}));for(let l=0;l<s;l++)this.fireSyntheticInOutEvents("drag",E(E({},n),{},{target:o[l],oldTarget:i[l]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,n){let{target:t,oldTarget:i,fireCanvas:o,e:s}=n,l=nt(n,v6),{targetIn:c,targetOut:a,canvasIn:u,canvasOut:d}=b6[e],h=i!==t;if(i&&h){let f=E(E({},l),{},{e:s,target:i,nextTarget:t},Ua(this,s));o&&this.fire(d,f),i.fire(a,f)}if(t&&h){let f=E(E({},l),{},{e:s,target:t,previousTarget:i},Ua(this,s));o&&this.fire(u,f),t.fire(c,f)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){let n=this.getScenePoint(e),t=this._currentTransform,i=t.target,o=i.group?yi(n,void 0,i.group.calcTransformMatrix()):n;t.shiftKey=e.shiftKey,t.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,t,o),t.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,n,t){let{action:i,actionHandler:o,target:s}=n,l=!!o&&o(e,n,t.x,t.y);l&&s.setCoords(),i==="drag"&&l&&(n.target.isMoving=!0,this.setCursor(n.target.moveCursor||this.moveCursor)),n.actionPerformed=n.actionPerformed||l}_setCursorFromEvent(e,n){if(!n)return void this.setCursor(this.defaultCursor);let t=n.hoverCursor||this.hoverCursor,i=Wo(this._activeObject)?this._activeObject:null,o=(!i||n.group!==i)&&n.findControl(this.getViewportPoint(e));if(o){let s=o.control;this.setCursor(s.cursorStyleHandler(e,s,n))}else n.subTargetCheck&&this.targets.concat().reverse().map(s=>{t=s.hoverCursor||t}),this.setCursor(t)}handleMultiSelection(e,n){let t=this._activeObject,i=Wo(t);if(t&&this._isSelectionKeyPressed(e)&&this.selection&&n&&n.selectable&&(t!==n||i)&&(i||!n.isDescendantOf(t)&&!t.isDescendantOf(n))&&!n.onSelect({e})&&!t.getActiveControl()){if(i){let o=t.getObjects();if(n===t){let s=this.getViewportPoint(e);if(!(n=this.searchPossibleTargets(o,s)||this.searchPossibleTargets(this._objects,s))||!n.selectable)return!1}n.group===t?(t.remove(n),this._hoveredTarget=n,this._hoveredTargets=[...this.targets],t.size()===1&&this._setActiveObject(t.item(0),e)):(t.multiSelectAdd(n),this._hoveredTarget=t,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(o,e)}else{t.isEditing&&t.exitEditing();let o=new(G.getClass("ActiveSelection"))([],{canvas:this});o.multiSelectAdd(t,n),this._hoveredTarget=o,this._setActiveObject(o,e),this._fireSelectionEvents([t],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;let{x:n,y:t,deltaX:i,deltaY:o}=this._groupSelector,s=new M(n,t),l=s.add(new M(i,o)),c=s.min(l),a=s.max(l).subtract(c),u=this.collectObjects({left:c.x,top:c.y,width:a.x,height:a.y},{includeIntersecting:!this.selectionFullyContained}),d=s.eq(l)?u[0]?[u[0]]:[]:u.length>1?u.filter(h=>!h.onSelect({e})).reverse():u;if(d.length===1)this.setActiveObject(d[0],e);else if(d.length>1){let h=G.getClass("ActiveSelection");this.setActiveObject(new h(d,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}},vI={x1:0,y1:0,x2:0,y2:0},w6=E(E({},vI),{},{r1:0,r2:0}),za=(r,e)=>isNaN(r)&&typeof e=="number"?e:r,_6=/^(\d+\.\d+)%|(\d+)%$/;function bI(r){return r&&_6.test(r)}function wI(r,e){let n=typeof r=="number"?r:typeof r=="string"?parseFloat(r)/(bI(r)?100:1):NaN;return gs(0,za(n,e),1)}var T6=/\s*;\s*/,x6=/\s*:\s*/;function S6(r,e){let n,t,i=r.getAttribute("style");if(i){let s=i.split(T6);s[s.length-1]===""&&s.pop();for(let l=s.length;l--;){let[c,a]=s[l].split(x6).map(u=>u.trim());c==="stop-color"?n=a:c==="stop-opacity"&&(t=a)}}let o=new dn(n||r.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:wI(r.getAttribute("offset"),0),color:o.toRgb(),opacity:za(parseFloat(t||r.getAttribute("stop-opacity")||""),1)*o.getAlpha()*e}}function E6(r,e){let n=[],t=r.getElementsByTagName("stop"),i=wI(e,1);for(let o=t.length;o--;)n.push(S6(t[o],i));return n}function _I(r){return r.nodeName==="linearGradient"||r.nodeName==="LINEARGRADIENT"?"linear":"radial"}function TI(r){return r.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function mr(r,e){return r.getAttribute(e)}function D6(r,e){return function(n,t){let i,{width:o,height:s,gradientUnits:l}=t;return Object.keys(n).reduce((c,a)=>{let u=n[a];return u==="Infinity"?i=1:u==="-Infinity"?i=0:(i=typeof u=="string"?parseFloat(u):u,typeof u=="string"&&bI(u)&&(i*=.01,l==="pixels"&&(a!=="x1"&&a!=="x2"&&a!=="r2"||(i*=o),a!=="y1"&&a!=="y2"||(i*=s)))),c[a]=i,c},{})}(_I(r)==="linear"?function(n){return{x1:mr(n,"x1")||0,y1:mr(n,"y1")||0,x2:mr(n,"x2")||"100%",y2:mr(n,"y2")||0}}(r):function(n){return{x1:mr(n,"fx")||mr(n,"cx")||"50%",y1:mr(n,"fy")||mr(n,"cy")||"50%",r1:0,x2:mr(n,"cx")||"50%",y2:mr(n,"cy")||"50%",r2:mr(n,"r")||"50%"}}(r),E(E({},e),{},{gradientUnits:TI(r)}))}var Ga=class{constructor(e){let{type:n="linear",gradientUnits:t="pixels",coords:i={},colorStops:o=[],offsetX:s=0,offsetY:l=0,gradientTransform:c,id:a}=e||{};Object.assign(this,{type:n,gradientUnits:t,coords:E(E({},n==="radial"?w6:vI),i),colorStops:o,offsetX:s,offsetY:l,gradientTransform:c,id:a?"".concat(a,"_").concat(no()):no()})}addColorStop(e){for(let n in e){let t=new dn(e[n]);this.colorStops.push({offset:parseFloat(n),color:t.toRgb(),opacity:t.getAlpha()})}return this}toObject(e){return E(E({},ys(this,e)),{},{type:this.type,coords:E({},this.coords),colorStops:this.colorStops.map(n=>E({},n)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=[],i=this.gradientTransform?this.gradientTransform.concat():cn.concat(),o=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",s=this.colorStops.map(d=>E({},d)).sort((d,h)=>d.offset-h.offset),l=-this.offsetX,c=-this.offsetY;var a;o==="objectBoundingBox"?(l/=e.width,c/=e.height):(l+=e.width/2,c+=e.height/2),(a=e)&&typeof a._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(l-=e.pathOffset.x,c-=e.pathOffset.y),i[4]-=l,i[5]-=c;let u=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(o,'"'),'gradientTransform="'.concat(n?n+" ":"").concat(kc(i),'"'),""].join(" ");if(this.type==="linear"){let{x1:d,y1:h,x2:f,y2:p}=this.coords;t.push("<linearGradient ",u,' x1="',d,'" y1="',h,'" x2="',f,'" y2="',p,`">
`)}else if(this.type==="radial"){let{x1:d,y1:h,x2:f,y2:p,r1:g,r2:y}=this.coords,w=g>y;t.push("<radialGradient ",u,' cx="',w?d:f,'" cy="',w?h:p,'" r="',w?g:y,'" fx="',w?f:d,'" fy="',w?p:h,`">
`),w&&(s.reverse(),s.forEach(x=>{x.offset=1-x.offset}));let v=Math.min(g,y);if(v>0){let x=v/Math.max(g,y);s.forEach(A=>{A.offset+=x*(1-A.offset)})}}return s.forEach(d=>{let{color:h,offset:f,opacity:p}=d;t.push("<stop ",'offset="',100*f+"%",'" style="stop-color:',h,p!==void 0?";stop-opacity: "+p:";",`"/>
`)}),t.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),t.join("")}toLive(e){let{x1:n,y1:t,x2:i,y2:o,r1:s,r2:l}=this.coords,c=this.type==="linear"?e.createLinearGradient(n,t,i,o):e.createRadialGradient(n,t,s,i,o,l);return this.colorStops.forEach(a=>{let{color:u,opacity:d,offset:h}=a;c.addColorStop(h,d!==void 0?new dn(u).setAlpha(d).toRgba():u)}),c}static fromObject(e){return F(this,null,function*(){let{colorStops:n,gradientTransform:t}=e;return new this(E(E({},e),{},{colorStops:n?n.map(i=>E({},i)):void 0,gradientTransform:t?[...t]:void 0}))})}static fromElement(e,n,t){let i=TI(e),o=n._findCenterFromElement();return new this(E({id:e.getAttribute("id")||void 0,type:_I(e),coords:D6(e,{width:t.viewBoxWidth||t.width,height:t.viewBoxHeight||t.height}),colorStops:E6(e,t.opacity),gradientUnits:i,gradientTransform:lb(e.getAttribute("gradientTransform")||"")},i==="pixels"?{offsetX:n.width/2-o.x,offsetY:n.height/2-o.y}:{offsetX:0,offsetY:0}))}};D(Ga,"type","Gradient"),G.setClass(Ga,"gradient"),G.setClass(Ga,"linear"),G.setClass(Ga,"radial");var C6=["type","source","patternTransform"],Pc=class{get type(){return"pattern"}set type(e){eo("warn","Setting type has no effect",e)}constructor(e){D(this,"repeat","repeat"),D(this,"offsetX",0),D(this,"offsetY",0),D(this,"crossOrigin",""),this.id=no(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],{repeat:n,crossOrigin:t}=this;return E(E({},ys(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:n,crossOrigin:t,offsetX:tt(this.offsetX,Oe.NUM_FRACTION_DIGITS),offsetY:tt(this.offsetY,Oe.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:n,height:t}=e,{source:i,repeat:o,id:s}=this,l=za(this.offsetX/n,0),c=za(this.offsetY/t,0),a=o==="repeat-y"||o==="no-repeat"?1+Math.abs(l||0):za(i.width/n,0),u=o==="repeat-x"||o==="no-repeat"?1+Math.abs(c||0):za(i.height/t,0);return['<pattern id="SVGID_'.concat(s,'" x="').concat(l,'" y="').concat(c,'" width="').concat(a,'" height="').concat(u,'">'),'<image x="0" y="0" width="'.concat(i.width,'" height="').concat(i.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static fromObject(e,n){return F(this,null,function*(){let{type:t,source:i,patternTransform:o}=e,s=nt(e,C6),l=yield Ac(i,E(E({},n),{},{crossOrigin:s.crossOrigin}));return new this(E(E({},s),{},{patternTransform:o&&o.slice(0),source:l}))})}};D(Pc,"type","Pattern"),G.setClass(Pc),G.setClass(Pc,"pattern");var I6=["path","left","top"],O6=["d"],qo=class r extends Rt{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:t,left:i,top:o}=n,s=nt(n,I6);super(),Object.assign(this,r.ownDefaults),this.setOptions(s),this._setPath(e||[],!0),typeof i=="number"&&this.set(Le,i),typeof o=="number"&&this.set(vn,o)}_setPath(e,n){this.path=uI(Array.isArray(e)?e:mI(e)),this.setBoundingBox(n)}_findCenterFromElement(){let e=this._calcBoundsFromPath();return new M(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){let n=-this.pathOffset.x,t=-this.pathOffset.y;e.beginPath();for(let i of this.path)switch(i[0]){case"L":e.lineTo(i[1]+n,i[2]+t);break;case"M":e.moveTo(i[1]+n,i[2]+t);break;case"C":e.bezierCurveTo(i[1]+n,i[2]+t,i[3]+n,i[4]+t,i[5]+n,i[6]+t);break;case"Q":e.quadraticCurveTo(i[1]+n,i[2]+t,i[3]+n,i[4]+t);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return E(E({},super.toObject(e)),{},{path:this.path.map(n=>n.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=this.toObject(e);return this.sourcePath&&(delete n.path,n.sourcePath=this.sourcePath),n}_toSVG(){let e=yI(this.path,Oe.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){let e=Oe.NUM_FRACTION_DIGITS;return" translate(".concat(tt(-this.pathOffset.x,e),", ").concat(tt(-this.pathOffset.y,e),")")}toClipPathSVG(e){let n=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:n})}toSVG(e){let n=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:n})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){let{width:n,height:t,pathOffset:i}=this._calcDimensions();this.set({width:n,height:t,pathOffset:i}),e&&this.setPositionByOrigin(i,he,he)}_calcBoundsFromPath(){let e=[],n=0,t=0,i=0,o=0;for(let s of this.path)switch(s[0]){case"L":i=s[1],o=s[2],e.push({x:n,y:t},{x:i,y:o});break;case"M":i=s[1],o=s[2],n=i,t=o;break;case"C":e.push(...db(i,o,s[1],s[2],s[3],s[4],s[5],s[6])),i=s[5],o=s[6];break;case"Q":e.push(...db(i,o,s[1],s[2],s[1],s[2],s[3],s[4])),i=s[3],o=s[4];break;case"Z":i=n,o=t}return Br(e)}_calcDimensions(){let e=this._calcBoundsFromPath();return E(E({},e),{},{pathOffset:new M(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static fromElement(e,n,t){return F(this,null,function*(){let i=wi(e,this.ATTRIBUTE_NAMES,t),{d:o}=i;return new this(o,E(E(E({},nt(i,O6)),n),{},{left:void 0,top:void 0}))})}};D(qo,"type","Path"),D(qo,"cacheProperties",[...bi,"path","fillRule"]),D(qo,"ATTRIBUTE_NAMES",[...so,"d"]),G.setClass(qo),G.setSVGClass(qo);var A6=["left","top","radius"],xI=["radius","startAngle","endAngle","counterClockwise"],Ki=class r extends Rt{static getDefaults(){return E(E({},super.getDefaults()),r.ownDefaults)}constructor(e){super(),Object.assign(this,r.ownDefaults),this.setOptions(e)}_set(e,n){return super._set(e,n),e==="radius"&&this.setRadius(n),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,lt(this.startAngle),lt(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(un)}getRadiusY(){return this.get("radius")*this.get(kn)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...xI,...e])}_toSVG(){let e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{let{radius:n}=this,t=lt(this.startAngle),i=lt(this.endAngle),o=_r(t)*n,s=Tr(t)*n,l=_r(i)*n,c=Tr(i)*n,a=e>180?1:0,u=this.counterClockwise?0:1;return['<path d="M '.concat(o," ").concat(s," A ").concat(n," ").concat(n," 0 ").concat(a," ").concat(u," ").concat(l," ").concat(c,'" '),"COMMON_PARTS",` />
`]}}static fromElement(e,n,t){return F(this,null,function*(){let i=wi(e,this.ATTRIBUTE_NAMES,t),{left:o=0,top:s=0,radius:l=0}=i;return new this(E(E({},nt(i,A6)),{},{radius:l,left:o-l,top:s-l}))})}static fromObject(e){return super._fromObject(e)}};D(Ki,"type","Circle"),D(Ki,"cacheProperties",[...bi,...xI]),D(Ki,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),D(Ki,"ATTRIBUTE_NAMES",["cx","cy","r",...so]),G.setClass(Ki),G.setSVGClass(Ki);var P6=["x1","y1","x2","y2"],M6=["x1","y1","x2","y2"],pb=["x1","x2","y1","y2"],Yo=class r extends Rt{constructor(){let[e,n,t,i]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,r.ownDefaults),this.setOptions(o),this.x1=e,this.x2=t,this.y1=n,this.y2=i,this._setWidthHeight();let{left:s,top:l}=o;typeof s=="number"&&this.set(Le,s),typeof l=="number"&&this.set(vn,l)}_setWidthHeight(){let{x1:e,y1:n,x2:t,y2:i}=this;this.width=Math.abs(t-e),this.height=Math.abs(i-n);let{left:o,top:s,width:l,height:c}=Br([{x:e,y:n},{x:t,y:i}]),a=new M(o+l/2,s+c/2);this.setPositionByOrigin(a,he,he)}_set(e,n){return super._set(e,n),pb.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();let n=this.calcLinePoints();e.moveTo(n.x1,n.y1),e.lineTo(n.x2,n.y2),e.lineWidth=this.strokeWidth;let t=e.strokeStyle;var i;Jn(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(i=this.stroke)!==null&&i!==void 0?i:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=t}_findCenterFromElement(){return new M((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return E(E({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){let e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){let{x1:e,x2:n,y1:t,y2:i,width:o,height:s}=this,l=e<=n?-1:1,c=t<=i?-1:1;return{x1:l*o/2,x2:l*-o/2,y1:c*s/2,y2:c*-s/2}}_toSVG(){let{x1:e,x2:n,y1:t,y2:i}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(t,'" x2="').concat(n,'" y2="').concat(i,`" />
`)]}static fromElement(e,n,t){return F(this,null,function*(){let i=wi(e,this.ATTRIBUTE_NAMES,t),{x1:o=0,y1:s=0,x2:l=0,y2:c=0}=i;return new this([o,s,l,c],nt(i,P6))})}static fromObject(e){let{x1:n,y1:t,x2:i,y2:o}=e,s=nt(e,M6);return this._fromObject(E(E({},s),{},{points:[n,t,i,o]}),{extraParam:"points"})}};D(Yo,"type","Line"),D(Yo,"cacheProperties",[...bi,...pb]),D(Yo,"ATTRIBUTE_NAMES",so.concat(pb)),G.setClass(Yo),G.setSVGClass(Yo);var Wa=class r extends Rt{static getDefaults(){return E(E({},super.getDefaults()),r.ownDefaults)}constructor(e){super(),Object.assign(this,r.ownDefaults),this.setOptions(e)}_render(e){let n=this.width/2,t=this.height/2;e.beginPath(),e.moveTo(-n,t),e.lineTo(0,-t),e.lineTo(n,t),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){let e=this.width/2,n=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(n,",0 ").concat(-n,",").concat(e," ").concat(n),'" />']}};D(Wa,"type","Triangle"),D(Wa,"ownDefaults",{width:100,height:100}),G.setClass(Wa),G.setSVGClass(Wa);var SI=["rx","ry"],Zi=class r extends Rt{static getDefaults(){return E(E({},super.getDefaults()),r.ownDefaults)}constructor(e){super(),Object.assign(this,r.ownDefaults),this.setOptions(e)}_set(e,n){switch(super._set(e,n),e){case"rx":this.rx=n,this.set("width",2*n);break;case"ry":this.ry=n,this.set("height",2*n)}return this}getRx(){return this.get("rx")*this.get(un)}getRy(){return this.get("ry")*this.get(kn)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...SI,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,vi,!1),e.restore(),this._renderPaintInOrder(e)}static fromElement(e,n,t){return F(this,null,function*(){let i=wi(e,this.ATTRIBUTE_NAMES,t);return i.left=(i.left||0)-i.rx,i.top=(i.top||0)-i.ry,new this(i)})}};function N6(r){if(!r)return[];let e=r.replace(/,/g," ").trim().split(/\s+/),n=[];for(let t=0;t<e.length;t+=2)n.push({x:parseFloat(e[t]),y:parseFloat(e[t+1])});return n}D(Zi,"type","Ellipse"),D(Zi,"cacheProperties",[...bi,...SI]),D(Zi,"ownDefaults",{rx:0,ry:0}),D(Zi,"ATTRIBUTE_NAMES",[...so,"cx","cy","rx","ry"]),G.setClass(Zi),G.setSVGClass(Zi);var R6=["left","top"],EI={exactBoundingBox:!1},Fr=class r extends Rt{static getDefaults(){return E(E({},super.getDefaults()),r.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),D(this,"strokeDiff",void 0),Object.assign(this,r.ownDefaults),this.setOptions(n),this.points=e;let{left:t,top:i}=n;this.initialized=!0,this.setBoundingBox(!0),typeof t=="number"&&this.set(Le,t),typeof i=="number"&&this.set(vn,i)}isOpen(){return!0}_projectStrokeOnPoints(e){return tI(this.points,e,this.isOpen())}_calcDimensions(e){e=E({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});let n=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(a=>a.projectedPoint):this.points;if(n.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new M,strokeOffset:new M,strokeDiff:new M};let t=Br(n),i=$c(E(E({},e),{},{scaleX:1,scaleY:1})),o=Br(this.points.map(a=>Kt(a,i,!0))),s=new M(this.scaleX,this.scaleY),l=t.left+t.width/2,c=t.top+t.height/2;return this.exactBoundingBox&&(l-=c*Math.tan(lt(this.skewX)),c-=l*Math.tan(lt(this.skewY))),E(E({},t),{},{pathOffset:new M(l,c),strokeOffset:new M(o.left,o.top).subtract(new M(t.left,t.top)).multiply(s),strokeDiff:new M(t.width,t.height).subtract(new M(o.width,o.height)).multiply(s)})}_findCenterFromElement(){let e=Br(this.points);return new M(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){let{left:n,top:t,width:i,height:o,pathOffset:s,strokeOffset:l,strokeDiff:c}=this._calcDimensions();this.set({width:i,height:o,pathOffset:s,strokeOffset:l,strokeDiff:c}),e&&this.setPositionByOrigin(new M(n+i/2,t+o/2),he,he)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new M(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let s;if(Object.keys(e).some(l=>this.strokeUniform||this.constructor.layoutProperties.includes(l))){var n,t;let{width:l,height:c}=this._calcDimensions(e);s=new M((n=e.width)!==null&&n!==void 0?n:l,(t=e.height)!==null&&t!==void 0?t:c)}else{var i,o;s=new M((i=e.width)!==null&&i!==void 0?i:this.width,(o=e.height)!==null&&o!==void 0?o:this.height)}return s.multiply(new M(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,n){let t=this.initialized&&this[e]!==n,i=super._set(e,n);return this.exactBoundingBox&&t&&((e===un||e===kn)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),i}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return E(E({},super.toObject(e)),{},{points:this.points.map(n=>{let{x:t,y:i}=n;return{x:t,y:i}})})}_toSVG(){let e=[],n=this.pathOffset.x,t=this.pathOffset.y,i=Oe.NUM_FRACTION_DIGITS;for(let o=0,s=this.points.length;o<s;o++)e.push(tt(this.points[o].x-n,i),",",tt(this.points[o].y-t,i)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){let n=this.points.length,t=this.pathOffset.x,i=this.pathOffset.y;if(n&&!isNaN(this.points[n-1].y)){e.beginPath(),e.moveTo(this.points[0].x-t,this.points[0].y-i);for(let o=0;o<n;o++){let s=this.points[o];e.lineTo(s.x-t,s.y-i)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static fromElement(e,n,t){return F(this,null,function*(){return new this(N6(e.getAttribute("points")),E(E({},nt(wi(e,this.ATTRIBUTE_NAMES,t),R6)),n))})}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}};D(Fr,"ownDefaults",EI),D(Fr,"type","Polyline"),D(Fr,"layoutProperties",[il,ol,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),D(Fr,"cacheProperties",[...bi,"points"]),D(Fr,"ATTRIBUTE_NAMES",[...so]),G.setClass(Fr),G.setSVGClass(Fr);var qa=class extends Fr{isOpen(){return!1}};D(qa,"ownDefaults",EI),D(qa,"type","Polygon"),G.setClass(qa),G.setSVGClass(qa);var DI=["fontSize","fontWeight","fontFamily","fontStyle"],CI=["underline","overline","linethrough"],II=[...DI,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],OI=[...II,...CI,"textBackgroundColor","direction"],k6=[...DI,...CI,wn,"strokeWidth",Ot,"deltaY","textBackgroundColor"],F6={_reNewline:Eb,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:Le,fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:Le,pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2},Lr="justify",Ff="justify-left",Mc="justify-right",Nc="justify-center",Lf=class extends Rt{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;let n=e===void 0?this.styles:{line:this.styles[e]};for(let t in n)for(let i in n[t])for(let o in n[t][i])return!1;return!0}styleHas(e,n){if(!this.styles||n!==void 0&&!this.styles[n])return!1;let t=n===void 0?this.styles:{0:this.styles[n]};for(let i in t)for(let o in t[i])if(t[i][o][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;let n=this.styles,t,i,o=0,s=!0,l=0;for(let c in n){t=0;for(let a in n[c]){let u=n[c][a]||{};o++,u[e]!==void 0?(i?u[e]!==i&&(s=!1):i=u[e],u[e]===this[e]&&delete u[e]):s=!1,Object.keys(u).length!==0?t++:delete n[c][a]}t===0&&delete n[c]}for(let c=0;c<this._textLines.length;c++)l+=this._textLines[c].length;s&&o===l&&(this[e]=i,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;let n=this.styles,t,i,o;for(i in n){for(o in t=n[i],t)delete t[o][e],Object.keys(t[o]).length===0&&delete t[o];Object.keys(t).length===0&&delete n[i]}}_extendStyles(e,n){let{lineIndex:t,charIndex:i}=this.get2DCursorLocation(e);this._getLineStyle(t)||this._setLineStyle(t);let o=Pb(E(E({},this._getStyleDeclaration(t,i)),n),s=>s!==void 0);this._setStyleDeclaration(t,i,o)}getSelectionStyles(e,n,t){let i=[];for(let o=e;o<(n||e);o++)i.push(this.getStyleAtPosition(o,t));return i}getStyleAtPosition(e,n){let{lineIndex:t,charIndex:i}=this.get2DCursorLocation(e);return n?this.getCompleteStyleDeclaration(t,i):this._getStyleDeclaration(t,i)}setSelectionStyles(e,n,t){for(let i=n;i<(t||n);i++)this._extendStyles(i,e);this._forceClearCache=!0}_getStyleDeclaration(e,n){var t;let i=this.styles&&this.styles[e];return i&&(t=i[n])!==null&&t!==void 0?t:{}}getCompleteStyleDeclaration(e,n){return E(E({},ys(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,n))}_setStyleDeclaration(e,n,t){this.styles[e][n]=t}_deleteStyleDeclaration(e,n){delete this.styles[e][n]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}};D(Lf,"_styleProperties",k6);var L6=/  +/g,B6=/"/g;function Vv(r,e,n,t,i){return"		".concat(function(o,s){let{left:l,top:c,width:a,height:u}=s,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Oe.NUM_FRACTION_DIGITS,h=Fc(Ot,o,!1),[f,p,g,y]=[l,c,a,u].map(w=>tt(w,d));return"<rect ".concat(h,' x="').concat(f,'" y="').concat(p,'" width="').concat(g,'" height="').concat(y,'"></rect>')}(r,{left:e,top:n,width:t,height:i}),`
`)}var j6=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"],$v,Kn=class r extends Lf{static getDefaults(){return E(E({},super.getDefaults()),r.ownDefaults)}constructor(e,n){super(),D(this,"__charBounds",[]),Object.assign(this,r.ownDefaults),this.setOptions(n),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){let e=this.path;e&&(e.segmentsInfo=Hb(e.path))}_splitText(){let e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Lr)&&this.enlargeSpaces()}enlargeSpaces(){let e,n,t,i,o,s,l;for(let c=0,a=this._textLines.length;c<a;c++)if((this.textAlign===Lr||c!==a-1&&!this.isEndOfWrapping(c))&&(i=0,o=this._textLines[c],n=this.getLineWidth(c),n<this.width&&(l=this.textLines[c].match(this._reSpacesAndTabs)))){t=l.length,e=(this.width-n)/t;for(let u=0;u<=o.length;u++)s=this.__charBounds[c][u],this._reSpaceAndTab.test(o[u])?(s.width+=e,s.kernedWidth+=e,s.left+=i,i+=e):s.left+=i}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,n){let t=n?this._unwrappedTextLines:this._textLines,i;for(i=0;i<t.length;i++){if(e<=t[i].length)return{lineIndex:i,charIndex:e};e-=t[i].length+this.missingNewlineOffset(i,n)}return{lineIndex:i-1,charIndex:t[i-1].length<e?t[i-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){let e=super._getCacheCanvasDimensions(),n=this.fontSize;return e.width+=n*e.zoomX,e.height+=n*e.zoomY,e}_render(e){let n=this.path;n&&!n.isNotVisible()&&n._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===wn?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,n,t){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case he:e.textBaseline="middle";break;case"ascender":e.textBaseline=vn;break;case"descender":e.textBaseline=Yv}e.font=this._getFontDeclaration(n,t)}calcTextWidth(){let e=this.getLineWidth(0);for(let n=1,t=this._textLines.length;n<t;n++){let i=this.getLineWidth(n);i>e&&(e=i)}return e}_renderTextLine(e,n,t,i,o,s){this._renderChars(e,n,t,i,o,s)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;let n=e.fillStyle,t=this._getLeftOffset(),i=this._getTopOffset();for(let o=0,s=this._textLines.length;o<s;o++){let l=this.getHeightOfLine(o);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",o)){i+=l;continue}let c=this._textLines[o].length,a=this._getLineLeftOffset(o),u,d,h=0,f=0,p=this.getValueOfPropertyAt(o,0,"textBackgroundColor");for(let g=0;g<c;g++){let y=this.__charBounds[o][g];d=this.getValueOfPropertyAt(o,g,"textBackgroundColor"),this.path?(e.save(),e.translate(y.renderLeft,y.renderTop),e.rotate(y.angle),e.fillStyle=d,d&&e.fillRect(-y.width/2,-l/this.lineHeight*(1-this._fontSizeFraction),y.width,l/this.lineHeight),e.restore()):d!==p?(u=t+a+f,this.direction==="rtl"&&(u=this.width-u-h),e.fillStyle=p,p&&e.fillRect(u,i,h,l/this.lineHeight),f=y.left,h=y.width,p=d):h+=y.kernedWidth}d&&!this.path&&(u=t+a+f,this.direction==="rtl"&&(u=this.width-u-h),e.fillStyle=d,e.fillRect(u,i,h,l/this.lineHeight)),i+=l}e.fillStyle=n,this._removeShadow(e)}_measureChar(e,n,t,i){let o=Ic.getFontCache(n),s=this._getFontDeclaration(n),l=t+e,c=t&&s===this._getFontDeclaration(i),a=n.fontSize/this.CACHE_FONT_SIZE,u,d,h,f;if(t&&o[t]!==void 0&&(h=o[t]),o[e]!==void 0&&(f=u=o[e]),c&&o[l]!==void 0&&(d=o[l],f=d-h),u===void 0||h===void 0||d===void 0){let p=function(){return $v||($v=xr({width:0,height:0}).getContext("2d")),$v}();this._setTextStyles(p,n,!0),u===void 0&&(f=u=p.measureText(e).width,o[e]=u),h===void 0&&c&&t&&(h=p.measureText(t).width,o[t]=h),c&&d===void 0&&(d=p.measureText(l).width,o[l]=d,f=d-h)}return{width:u*a,kernedWidth:f*a}}getHeightOfChar(e,n){return this.getValueOfPropertyAt(e,n,"fontSize")}measureLine(e){let n=this._measureLine(e);return this.charSpacing!==0&&(n.width-=this._getWidthOfCharSpacing()),n.width<0&&(n.width=0),n}_measureLine(e){let n,t,i=0,o=this.pathSide===pt,s=this.path,l=this._textLines[e],c=l.length,a=new Array(c);this.__charBounds[e]=a;for(let u=0;u<c;u++){let d=l[u];t=this._getGraphemeBox(d,e,u,n),a[u]=t,i+=t.kernedWidth,n=d}if(a[c]={left:t?t.left+t.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},s&&s.segmentsInfo){let u=0,d=s.segmentsInfo[s.segmentsInfo.length-1].length;switch(this.textAlign){case Le:u=o?d-i:0;break;case he:u=(d-i)/2;break;case pt:u=o?0:d-i}u+=this.pathStartOffset*(o?-1:1);for(let h=o?c-1:0;o?h>=0:h<c;o?h--:h++)t=a[h],u>d?u%=d:u<0&&(u+=d),this._setGraphemeOnPath(u,t),u+=t.kernedWidth}return{width:i,numOfSpaces:0}}_setGraphemeOnPath(e,n){let t=e+n.kernedWidth/2,i=this.path,o=gI(i.path,t,i.segmentsInfo);n.renderLeft=o.x-i.pathOffset.x,n.renderTop=o.y-i.pathOffset.y,n.angle=o.angle+(this.pathSide===pt?Math.PI:0)}_getGraphemeBox(e,n,t,i,o){let s=this.getCompleteStyleDeclaration(n,t),l=i?this.getCompleteStyleDeclaration(n,t-1):{},c=this._measureChar(e,s,i,l),a,u=c.kernedWidth,d=c.width;this.charSpacing!==0&&(a=this._getWidthOfCharSpacing(),d+=a,u+=a);let h={width:d,left:0,height:s.fontSize,kernedWidth:u,deltaY:s.deltaY};if(t>0&&!o){let f=this.__charBounds[n][t-1];h.left=f.left+f.width+c.kernedWidth-c.width}return h}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let n=this.getHeightOfChar(e,0);for(let t=1,i=this._textLines[e].length;t<i;t++)n=Math.max(this.getHeightOfChar(e,t),n);return this.__lineHeights[e]=n*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,n=0;for(let t=0,i=this._textLines.length;t<i;t++)e=this.getHeightOfLine(t),n+=t===i-1?e/this.lineHeight:e;return n}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,n){e.save();let t=0,i=this._getLeftOffset(),o=this._getTopOffset();for(let s=0,l=this._textLines.length;s<l;s++){let c=this.getHeightOfLine(s),a=c/this.lineHeight,u=this._getLineLeftOffset(s);this._renderTextLine(n,e,this._textLines[s],i+u,o+t+a,s),t+=c}e.restore()}_renderTextFill(e){(this.fill||this.styleHas(Ot))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,n,t,i,o,s){let l=this.getHeightOfLine(s),c=this.textAlign.includes(Lr),a=this.path,u=!c&&this.charSpacing===0&&this.isEmptyStyles(s)&&!a,d=this.direction==="ltr",h=this.direction==="ltr"?1:-1,f=n.direction,p,g,y,w,v,x="",A=0;if(n.save(),f!==this.direction&&(n.canvas.setAttribute("dir",d?"ltr":"rtl"),n.direction=d?"ltr":"rtl",n.textAlign=d?Le:pt),o-=l*this._fontSizeFraction/this.lineHeight,u)return this._renderChar(e,n,s,0,t.join(""),i,o),void n.restore();for(let L=0,H=t.length-1;L<=H;L++)w=L===H||this.charSpacing||a,x+=t[L],y=this.__charBounds[s][L],A===0?(i+=h*(y.kernedWidth-y.width),A+=y.width):A+=y.kernedWidth,c&&!w&&this._reSpaceAndTab.test(t[L])&&(w=!0),w||(p=p||this.getCompleteStyleDeclaration(s,L),g=this.getCompleteStyleDeclaration(s,L+1),w=Qf(p,g,!1)),w&&(a?(n.save(),n.translate(y.renderLeft,y.renderTop),n.rotate(y.angle),this._renderChar(e,n,s,L,x,-A/2,0),n.restore()):(v=i,this._renderChar(e,n,s,L,x,v,o)),x="",p=g,i+=h*A,A=0);n.restore()}_applyPatternGradientTransformText(e){let n=this.width+this.strokeWidth,t=this.height+this.strokeWidth,i=xr({width:n,height:t}),o=i.getContext("2d");return i.width=n,i.height=t,o.beginPath(),o.moveTo(0,0),o.lineTo(n,0),o.lineTo(n,t),o.lineTo(0,t),o.closePath(),o.translate(n/2,t/2),o.fillStyle=e.toLive(o),this._applyPatternGradientTransform(o,e),o.fill(),o.createPattern(i,"no-repeat")}handleFiller(e,n,t){let i,o;return Jn(t)?t.gradientUnits==="percentage"||t.gradientTransform||t.patternTransform?(i=-this.width/2,o=-this.height/2,e.translate(i,o),e[n]=this._applyPatternGradientTransformText(t),{offsetX:i,offsetY:o}):(e[n]=t.toLive(e),this._applyPatternGradientTransform(e,t)):(e[n]=t,{offsetX:0,offsetY:0})}_setStrokeStyles(e,n){let{stroke:t,strokeWidth:i}=n;return e.lineWidth=i,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",t)}_setFillStyles(e,n){let{fill:t}=n;return this.handleFiller(e,"fillStyle",t)}_renderChar(e,n,t,i,o,s,l){let c=this._getStyleDeclaration(t,i),a=this.getCompleteStyleDeclaration(t,i),u=e==="fillText"&&a.fill,d=e==="strokeText"&&a.stroke&&a.strokeWidth;if(d||u){if(n.save(),n.font=this._getFontDeclaration(a),c.textBackgroundColor&&this._removeShadow(n),c.deltaY&&(l+=c.deltaY),u){let h=this._setFillStyles(n,a);n.fillText(o,s-h.offsetX,l-h.offsetY)}if(d){let h=this._setStrokeStyles(n,a);n.strokeText(o,s-h.offsetX,l-h.offsetY)}n.restore()}}setSuperscript(e,n){this._setScript(e,n,this.superscript)}setSubscript(e,n){this._setScript(e,n,this.subscript)}_setScript(e,n,t){let i=this.get2DCursorLocation(e,!0),o=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"fontSize"),s=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"deltaY"),l={fontSize:o*t.size,deltaY:s+o*t.baseline};this.setSelectionStyles(l,e,n)}_getLineLeftOffset(e){let n=this.getLineWidth(e),t=this.width-n,i=this.textAlign,o=this.direction,s=this.isEndOfWrapping(e),l=0;return i===Lr||i===Nc&&!s||i===Mc&&!s||i===Ff&&!s?0:(i===he&&(l=t/2),i===pt&&(l=t),i===Nc&&(l=t/2),i===Mc&&(l=t),o==="rtl"&&(i===pt||i===Lr||i===Mc?l=0:i===Le||i===Ff?l=-t:i!==he&&i!==Nc||(l=-t/2)),l)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];let{width:n}=this.measureLine(e);return this.__lineWidths[e]=n,n}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,n,t){var i;return(i=this._getStyleDeclaration(e,n)[t])!==null&&i!==void 0?i:this[t]}_renderTextDecoration(e,n){if(!this[n]&&!this.styleHas(n))return;let t=this._getTopOffset(),i=this._getLeftOffset(),o=this.path,s=this._getWidthOfCharSpacing(),l=this.offsets[n];for(let c=0,a=this._textLines.length;c<a;c++){let u=this.getHeightOfLine(c);if(!this[n]&&!this.styleHas(n,c)){t+=u;continue}let d=this._textLines[c],h=u/this.lineHeight,f=this._getLineLeftOffset(c),p,g,y=0,w=0,v=this.getValueOfPropertyAt(c,0,n),x=this.getValueOfPropertyAt(c,0,Ot),A=t+h*(1-this._fontSizeFraction),L=this.getHeightOfChar(c,0),H=this.getValueOfPropertyAt(c,0,"deltaY");for(let $=0,we=d.length;$<we;$++){let ne=this.__charBounds[c][$];p=this.getValueOfPropertyAt(c,$,n),g=this.getValueOfPropertyAt(c,$,Ot);let He=this.getHeightOfChar(c,$),_e=this.getValueOfPropertyAt(c,$,"deltaY");if(o&&p&&g)e.save(),e.fillStyle=x,e.translate(ne.renderLeft,ne.renderTop),e.rotate(ne.angle),e.fillRect(-ne.kernedWidth/2,l*He+_e,ne.kernedWidth,this.fontSize/15),e.restore();else if((p!==v||g!==x||He!==L||_e!==H)&&w>0){let Ee=i+f+y;this.direction==="rtl"&&(Ee=this.width-Ee-w),v&&x&&(e.fillStyle=x,e.fillRect(Ee,A+l*L+H,w,this.fontSize/15)),y=ne.left,w=ne.width,v=p,x=g,L=He,H=_e}else w+=ne.kernedWidth}let q=i+f+y;this.direction==="rtl"&&(q=this.width-q-w),e.fillStyle=g,p&&g&&e.fillRect(q,A+l*L+H,w-s,this.fontSize/15),t+=u}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:n=this.fontStyle,fontWeight:t=this.fontWeight,fontSize:i=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0,s=e.includes("'")||e.includes('"')||e.includes(",")||r.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[n,t,"".concat(o?this.CACHE_FONT_SIZE:i,"px"),s].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return Jf(e)}_splitTextIntoLines(e){let n=e.split(this._reNewline),t=new Array(n.length),i=[`
`],o=[];for(let s=0;s<n.length;s++)t[s]=this.graphemeSplit(n[s]),o=o.concat(t[s],i);return o.pop(),{_unwrappedLines:t,lines:n,graphemeText:o,graphemeLines:t}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return E(E({},super.toObject([...OI,...e])),{},{styles:rI(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,n){let{textLayoutProperties:t}=this.constructor;super.set(e,n);let i=!1,o=!1;if(typeof e=="object")for(let s in e)s==="path"&&this.setPathInfo(),i=i||t.includes(s),o=o||s==="path";else i=t.includes(e),o=e==="path";return o&&this.setPathInfo(),i&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static fromElement(e,n,t){return F(this,null,function*(){let i=wi(e,r.ATTRIBUTE_NAMES,t),o=E(E({},n),i),{textAnchor:s=Le,textDecoration:l="",dx:c=0,dy:a=0,top:u=0,left:d=0,fontSize:h=Sb,strokeWidth:f=1}=o,p=nt(o,j6),g=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),E({left:d+c,top:u+a,underline:l.includes("underline"),overline:l.includes("overline"),linethrough:l.includes("line-through"),strokeWidth:0,fontSize:h},p)),y=g.getScaledHeight()/g.height,w=((g.height+g.strokeWidth)*g.lineHeight-g.height)*y,v=g.getScaledHeight()+w,x=0;return s===he&&(x=g.getScaledWidth()/2),s===pt&&(x=g.getScaledWidth()),g.set({left:g.left-x,top:g.top-(v-g.fontSize*(.07+g._fontSizeFraction))/g.lineHeight,strokeWidth:f}),g})}static fromObject(e){return this._fromObject(E(E({},e),{},{styles:iI(e.styles||{},e.text)}),{extraParam:"text"})}};D(Kn,"textLayoutProperties",II),D(Kn,"cacheProperties",[...bi,...OI]),D(Kn,"ownDefaults",F6),D(Kn,"type","Text"),D(Kn,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),D(Kn,"ATTRIBUTE_NAMES",so.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),Q1(Kn,[class extends xf{_toSVG(){let r=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(r.textTop,r.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(r){return this._createBaseSVGMarkup(this._toSVG(),{reviver:r,noStyle:!0,withShadow:!0})}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(r){let{textBgRects:e,textSpans:n}=r,t=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'.concat(this.fontFamily.replace(B6,"'"),'" '):"",this.fontSize?'font-size="'.concat(this.fontSize,'" '):"",this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",t?'text-decoration="'.concat(t,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",n.join(""),`</text>
`]}_getSVGTextAndBg(r,e){let n=[],t=[],i,o=r;this.backgroundColor&&t.push(...Vv(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let s=0,l=this._textLines.length;s<l;s++)i=this._getLineLeftOffset(s),this.direction==="rtl"&&(i+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",s))&&this._setSVGTextLineBg(t,s,e+i,o),this._setSVGTextLineText(n,s,e+i,o),o+=this.getHeightOfLine(s);return{textSpans:n,textBgRects:t}}_createTextCharSpan(r,e,n,t){let i=this.getSvgSpanStyles(e,r!==r.trim()||!!r.match(L6)),o=i?'style="'.concat(i,'"'):"",s=e.deltaY,l=s?' dy="'.concat(tt(s,Oe.NUM_FRACTION_DIGITS),'" '):"";return'<tspan x="'.concat(tt(n,Oe.NUM_FRACTION_DIGITS),'" y="').concat(tt(t,Oe.NUM_FRACTION_DIGITS),'" ').concat(l).concat(o,">").concat(nI(r),"</tspan>")}_setSVGTextLineText(r,e,n,t){let i=this.getHeightOfLine(e),o=this.textAlign.includes(Lr),s=this._textLines[e],l,c,a,u,d,h="",f=0;t+=i*(1-this._fontSizeFraction)/this.lineHeight;for(let p=0,g=s.length-1;p<=g;p++)d=p===g||this.charSpacing,h+=s[p],a=this.__charBounds[e][p],f===0?(n+=a.kernedWidth-a.width,f+=a.width):f+=a.kernedWidth,o&&!d&&this._reSpaceAndTab.test(s[p])&&(d=!0),d||(l=l||this.getCompleteStyleDeclaration(e,p),c=this.getCompleteStyleDeclaration(e,p+1),d=Qf(l,c,!0)),d&&(u=this._getStyleDeclaration(e,p),r.push(this._createTextCharSpan(h,u,n,t)),h="",l=c,this.direction==="rtl"?n-=f:n+=f,f=0)}_setSVGTextLineBg(r,e,n,t){let i=this._textLines[e],o=this.getHeightOfLine(e)/this.lineHeight,s,l=0,c=0,a=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let u=0;u<i.length;u++){let{left:d,width:h,kernedWidth:f}=this.__charBounds[e][u];s=this.getValueOfPropertyAt(e,u,"textBackgroundColor"),s!==a?(a&&r.push(...Vv(a,n+c,t,l,o)),c=d,l=h,a=s):l+=f}s&&r.push(...Vv(a,n+c,t,l,o))}_getSVGLineTopOffset(r){let e,n=0;for(e=0;e<r;e++)n+=this.getHeightOfLine(e);let t=this.getHeightOfLine(e);return{lineTop:n,offset:(this._fontSizeMult-this._fontSizeFraction)*t/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(r){return"".concat(super.getSvgStyles(r)," white-space: pre;")}getSvgSpanStyles(r,e){let{fontFamily:n,strokeWidth:t,stroke:i,fill:o,fontSize:s,fontStyle:l,fontWeight:c,deltaY:a}=r,u=this.getSvgTextDecoration(r);return[i?Fc(wn,i):"",t?"stroke-width: ".concat(t,"; "):"",n?"font-family: ".concat(n.includes("'")||n.includes('"')?n:"'".concat(n,"'"),"; "):"",s?"font-size: ".concat(s,"px; "):"",l?"font-style: ".concat(l,"; "):"",c?"font-weight: ".concat(c,"; "):"",u&&"text-decoration: ".concat(u,"; "),o?Fc(Ot,o):"",a?"baseline-shift: ".concat(-a,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(r){return["overline","underline","line-through"].filter(e=>r[e.replace("-","")]).join(" ")}}]),G.setClass(Kn),G.setSVGClass(Kn);var gb=class{constructor(e){D(this,"target",void 0),D(this,"__mouseDownInPlace",!1),D(this,"__dragStartFired",!1),D(this,"__isDraggingOver",!1),D(this,"__dragStartSelection",void 0),D(this,"__dragImageDisposer",void 0),D(this,"_dispose",void 0),this.target=e;let n=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{n.forEach(t=>t()),this._dispose=void 0}}isPointerOverSelection(e){let n=this.target,t=n.getSelectionStartFromPointer(e);return n.isEditing&&t>=n.selectionStart&&t<=n.selectionEnd&&n.selectionStart<n.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){let n=this.isActive();return n&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,n}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,n){var t;let{selectionStart:i,selectionEnd:o}=n,s=this.target,l=s.canvas,c=new M(s.flipX?-1:1,s.flipY?-1:1),a=s._getCursorBoundaries(i),u=new M(a.left+a.leftOffset,a.top+a.topOffset).multiply(c).transform(s.calcTransformMatrix()),d=l.getScenePoint(e).subtract(u),h=s.getCanvasRetinaScaling(),f=s.getBoundingRect(),p=u.subtract(new M(f.left,f.top)),g=l.viewportTransform,y=p.add(d).transform(g,!0),w=s.backgroundColor,v=Vb(s.styles);s.backgroundColor="";let x={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};s.setSelectionStyles(x,0,i),s.setSelectionStyles(x,o,s.text.length),s.dirty=!0;let A=s.toCanvasElement({enableRetinaScaling:l.enableRetinaScaling,viewportTransform:!0});s.backgroundColor=w,s.styles=v,s.dirty=!0,Rf(A,{position:"fixed",left:"".concat(-A.width,"px"),border:bn,width:"".concat(A.width/h,"px"),height:"".concat(A.height/h,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{A.remove()},vr(e.target||this.target.hiddenTextarea).body.appendChild(A),(t=e.dataTransfer)===null||t===void 0||t.setDragImage(A,y.x,y.y)}onDragStart(e){this.__dragStartFired=!0;let n=this.target,t=this.isActive();if(t&&e.dataTransfer){let i=this.__dragStartSelection={selectionStart:n.selectionStart,selectionEnd:n.selectionEnd},o=n._text.slice(i.selectionStart,i.selectionEnd).join(""),s=E({text:n.text,value:o},i);e.dataTransfer.setData("text/plain",o),e.dataTransfer.setData("application/fabric",JSON.stringify({value:o,styles:n.getSelectionStyles(i.selectionStart,i.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,s)}return n.abortCursorAnimation(),t}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){let n=this.target.getSelectionStartFromPointer(e),t=this.__dragStartSelection;return n<t.selectionStart||n>t.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:n}=e,t=this.targetCanDrop(n);!this.__isDraggingOver&&t&&(this.__isDraggingOver=!0)}dragOverHandler(e){let{e:n}=e,t=this.targetCanDrop(n);!this.__isDraggingOver&&t?this.__isDraggingOver=!0:this.__isDraggingOver&&!t&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(n.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var n;let{e:t}=e,i=t.defaultPrevented;this.__isDraggingOver=!1,t.preventDefault();let o=(n=t.dataTransfer)===null||n===void 0?void 0:n.getData("text/plain");if(o&&!i){let s=this.target,l=s.canvas,c=s.getSelectionStartFromPointer(t),{styles:a}=t.dataTransfer.types.includes("application/fabric")?JSON.parse(t.dataTransfer.getData("application/fabric")):{},u=o[Math.max(0,o.length-1)],d=0;if(this.__dragStartSelection){let h=this.__dragStartSelection.selectionStart,f=this.__dragStartSelection.selectionEnd;c>h&&c<=f?c=h:c>f&&(c-=f-h),s.removeChars(h,f),delete this.__dragStartSelection}s._reNewline.test(u)&&(s._reNewline.test(s._text[c])||c===s._text.length)&&(o=o.trimEnd()),e.didDrop=!0,e.dropTarget=s,s.insertChars(o,a,c),l.setActiveObject(s),s.enterEditing(t),s.selectionStart=Math.min(c+d,s._text.length),s.selectionEnd=Math.min(s.selectionStart+o.length,s._text.length),s.hiddenTextarea.value=s.text,s._updateTextarea(),s.hiddenTextarea.focus(),s.fire(mf,{index:c+d,action:"drop"}),l.fire("text:changed",{target:s}),l.contextTopDirty=!0,l.requestRenderAll()}}dragEndHandler(e){let{e:n}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var t;let i=this.target,o=this.target.canvas,{selectionStart:s,selectionEnd:l}=this.__dragStartSelection,c=((t=n.dataTransfer)===null||t===void 0?void 0:t.dropEffect)||bn;c===bn?(i.selectionStart=s,i.selectionEnd=l,i._updateTextarea(),i.hiddenTextarea.focus()):(i.clearContextTop(),c==="move"&&(i.removeChars(s,l),i.selectionStart=i.selectionEnd=s,i.hiddenTextarea&&(i.hiddenTextarea.value=i.text),i._updateTextarea(),i.fire(mf,{index:s,action:"dragend"}),o.fire("text:changed",{target:i}),o.requestRenderAll()),i.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}},l1=/[ \n\.,;!\?\-]/,mb=class extends Kn{constructor(){super(...arguments),D(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:n,duration:t,delay:i,onComplete:o}=e;return Lb({startValue:this._currentCursorOpacity,endValue:n,duration:t,delay:i,onComplete:o,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:s=>{this._currentCursorOpacity=s,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(n=>{n&&!n.isDone()&&(e=!0,n.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let n=0,t=e-1;if(this._reSpace.test(this._text[t]))for(;this._reSpace.test(this._text[t]);)n++,t--;for(;/\S/.test(this._text[t])&&t>-1;)n++,t--;return e-n}findWordBoundaryRight(e){let n=0,t=e;if(this._reSpace.test(this._text[t]))for(;this._reSpace.test(this._text[t]);)n++,t++;for(;/\S/.test(this._text[t])&&t<this._text.length;)n++,t++;return e+n}findLineBoundaryLeft(e){let n=0,t=e-1;for(;!/\n/.test(this._text[t])&&t>-1;)n++,t--;return e-n}findLineBoundaryRight(e){let n=0,t=e;for(;!/\n/.test(this._text[t])&&t<this._text.length;)n++,t++;return e+n}searchWordBoundary(e,n){let t=this._text,i=e>0&&this._reSpace.test(t[e])&&(n===-1||!Eb.test(t[e-1]))?e-1:e,o=t[i];for(;i>0&&i<t.length&&!l1.test(o);)i+=n,o=t[i];return n===-1&&l1.test(o)&&i++,i}selectWord(e){e=e||this.selectionStart;let n=this.searchWordBoundary(e,-1),t=Math.max(n,this.searchWordBoundary(e,1));this.selectionStart=n,this.selectionEnd=t,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){e=e||this.selectionStart;let n=this.findLineBoundaryLeft(e),t=this.findLineBoundaryRight(e);return this.selectionStart=n,this.selectionEnd=t,this._fireSelectionChanged(),this._updateTextarea(),this}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;let n=this.hiddenTextarea;vr(n).activeElement!==n&&n.focus();let t=this.getSelectionStartFromPointer(e),i=this.selectionStart,o=this.selectionEnd;(t===this.__selectionStartOnMouseDown&&i!==o||i!==t&&o!==t)&&(t>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=t):(this.selectionStart=t,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===i&&this.selectionEnd===o||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,n,t){let i=t.slice(0,e),o=this.graphemeSplit(i).length;if(e===n)return{selectionStart:o,selectionEnd:o};let s=t.slice(e,n);return{selectionStart:o,selectionEnd:o+this.graphemeSplit(s).length}}fromGraphemeToStringSelection(e,n,t){let i=t.slice(0,e).join("").length;return e===n?{selectionStart:i,selectionEnd:i}:{selectionStart:i,selectionEnd:i+t.slice(e,n).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){let e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};let e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();let n=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=n.selectionEnd,this.inCompositionMode||(this.selectionStart=n.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){let e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};let e=this.inCompositionMode?this.compositionStart:this.selectionStart,n=this._getCursorBoundaries(e),t=this.get2DCursorLocation(e),i=t.lineIndex,o=t.charIndex,s=this.getValueOfPropertyAt(i,o,"fontSize")*this.lineHeight,l=n.leftOffset,c=this.getCanvasRetinaScaling(),a=this.canvas.upperCanvasEl,u=a.width/c,d=a.height/c,h=u-s,f=d-s,p=new M(n.left+l,n.top+n.topOffset+s).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new M(a.clientWidth/u,a.clientHeight/d));return p.x<0&&(p.x=0),p.x>h&&(p.x=h),p.y<0&&(p.y=0),p.y>f&&(p.y=f),p.x+=this.canvas._offset.left,p.y+=this.canvas._offset.top,{left:"".concat(p.x,"px"),top:"".concat(p.y,"px"),fontSize:"".concat(s,"px"),charHeight:s}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){let e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){let e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(yf),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(let e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,n){let{lineIndex:t,charIndex:i}=this.get2DCursorLocation(e,!0),{lineIndex:o,charIndex:s}=this.get2DCursorLocation(n,!0);if(t!==o){if(this.styles[t])for(let l=i;l<this._unwrappedTextLines[t].length;l++)delete this.styles[t][l];if(this.styles[o])for(let l=s;l<this._unwrappedTextLines[o].length;l++){let c=this.styles[o][l];c&&(this.styles[t]||(this.styles[t]={}),this.styles[t][i+l-s]=c)}for(let l=t+1;l<=o;l++)delete this.styles[l];this.shiftLineStyles(o,t-o)}else if(this.styles[t]){let l=this.styles[t],c=s-i;for(let a=i;a<s;a++)delete l[a];for(let a in this.styles[t]){let u=parseInt(a,10);u>=s&&(l[u-c]=l[a],delete l[a])}}}shiftLineStyles(e,n){let t=Object.assign({},this.styles);for(let i in this.styles){let o=parseInt(i,10);o>e&&(this.styles[o+n]=t[o],t[o-n]||delete this.styles[o])}}insertNewlineStyleObject(e,n,t,i){let o={},s=this._unwrappedTextLines[e].length,l=s===n,c=!1;t||(t=1),this.shiftLineStyles(e,t);let a=this.styles[e]?this.styles[e][n===0?n:n-1]:void 0;for(let d in this.styles[e]){let h=parseInt(d,10);h>=n&&(c=!0,o[h-n]=this.styles[e][d],l&&n===0||delete this.styles[e][d])}let u=!1;for(c&&!l&&(this.styles[e+t]=o,u=!0),(u||s>n)&&t--;t>0;)i&&i[t-1]?this.styles[e+t]={0:E({},i[t-1])}:a?this.styles[e+t]={0:E({},a)}:delete this.styles[e+t],t--;this._forceClearCache=!0}insertCharStyleObject(e,n,t,i){this.styles||(this.styles={});let o=this.styles[e],s=o?E({},o):{};t||(t=1);for(let c in s){let a=parseInt(c,10);a>=n&&(o[a+t]=s[a],s[a-t]||delete o[a])}if(this._forceClearCache=!0,i){for(;t--;)Object.keys(i[t]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][n+t]=E({},i[t]));return}if(!o)return;let l=o[n?n-1:1];for(;l&&t--;)this.styles[e][n+t]=E({},l)}insertNewStyleBlock(e,n,t){let i=this.get2DCursorLocation(n,!0),o=[0],s,l=0;for(let c=0;c<e.length;c++)e[c]===`
`?(l++,o[l]=0):o[l]++;for(o[0]>0&&(this.insertCharStyleObject(i.lineIndex,i.charIndex,o[0],t),t=t&&t.slice(o[0]+1)),l&&this.insertNewlineStyleObject(i.lineIndex,i.charIndex+o[0],l),s=1;s<l;s++)o[s]>0?this.insertCharStyleObject(i.lineIndex+s,0,o[s],t):t&&this.styles[i.lineIndex+s]&&t[0]&&(this.styles[i.lineIndex+s][0]=t[0]),t=t&&t.slice(o[s]+1);o[s]>0&&this.insertCharStyleObject(i.lineIndex+s,0,o[s],t)}removeChars(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,n),this._text.splice(e,n-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,n,t){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:t;i>t&&this.removeStyleFromTo(t,i);let o=this.graphemeSplit(e);this.insertNewStyleBlock(o,t,n),this._text=[...this._text.slice(0,t),...o,...this._text.slice(i)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,n,t){t<=e?(n===e?this._selectionDirection=Le:this._selectionDirection===pt&&(this._selectionDirection=Le,this.selectionEnd=e),this.selectionStart=t):t>e&&t<n?this._selectionDirection===pt?this.selectionEnd=t:this.selectionStart=t:(n===e?this._selectionDirection=pt:this._selectionDirection===Le&&(this._selectionDirection=pt,this.selectionStart=n),this.selectionEnd=t)}},yb=class extends mb{initHiddenTextarea(){let e=this.canvas&&vr(this.canvas.getElement())||rl(),n=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(s=>{let[l,c]=s;return n.setAttribute(l,c)});let{top:t,left:i,fontSize:o}=this._calcTextareaPosition();n.style.cssText="position: absolute; top: ".concat(t,"; left: ").concat(i,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(o,";"),(this.hiddenTextareaContainer||e.body).appendChild(n),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(s=>{let[l,c]=s;return n.addEventListener(l,this[c].bind(this))}),this.hiddenTextarea=n}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;let n=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in n)this[n[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){let n=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;let t=()=>{this.updateFromTextArea(),this.fire(mf),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void t();let i=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,o=this._text.length,s=i.length,l=this.selectionStart,c=this.selectionEnd,a=l!==c,u,d,h,f,p=s-o,g=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),y=l>g.selectionStart;a?(d=this._text.slice(l,c),p+=c-l):s<o&&(d=y?this._text.slice(c+p,c):this._text.slice(l,l-p));let w=i.slice(g.selectionEnd-p,g.selectionEnd);if(d&&d.length&&(w.length&&(u=this.getSelectionStyles(l,l+1,!1),u=w.map(()=>u[0])),a?(h=l,f=c):y?(h=c-d.length,f=c):(h=c,f=c+d.length),this.removeStyleFromTo(h,f)),w.length){let{copyPasteData:v}=jr();n&&w.join("")===v.copiedText&&!Oe.disableStyleCopyPaste&&(u=v.copiedTextStyle),this.insertNewStyleBlock(w,l,u)}t()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:n}=e,{selectionStart:t,selectionEnd:i}=n;this.compositionStart=t,this.compositionEnd=i,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;let{copyPasteData:e}=jr();e.copiedText=this.getSelectedText(),Oe.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,n){let t,i=this._getLineLeftOffset(e);return n>0&&(t=this.__charBounds[e][n-1],i+=t.left+t.width),i}getDownCursorOffset(e,n){let t=this._getSelectionForOffset(e,n),i=this.get2DCursorLocation(t),o=i.lineIndex;if(o===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-t;let s=i.charIndex,l=this._getWidthBeforeCursor(o,s),c=this._getIndexOnLine(o+1,l);return this._textLines[o].slice(s).length+c+1+this.missingNewlineOffset(o)}_getSelectionForOffset(e,n){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&n?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,n){let t=this._getSelectionForOffset(e,n),i=this.get2DCursorLocation(t),o=i.lineIndex;if(o===0||e.metaKey||e.keyCode===33)return-t;let s=i.charIndex,l=this._getWidthBeforeCursor(o,s),c=this._getIndexOnLine(o-1,l),a=this._textLines[o].slice(0,s),u=this.missingNewlineOffset(o-1);return-this._textLines[o-1].length+c-a.length+(1-u)}_getIndexOnLine(e,n){let t=this._textLines[e],i,o,s=this._getLineLeftOffset(e),l=0;for(let c=0,a=t.length;c<a;c++)if(i=this.__charBounds[e][c].width,s+=i,s>n){o=!0;let u=s-i,d=s,h=Math.abs(u-n);l=Math.abs(d-n)<h?c:c-1;break}return o||(l=t.length-1),l}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,n){let t=this["get".concat(e,"CursorOffset")](n,this._selectionDirection===pt);if(n.shiftKey?this.moveCursorWithShift(t):this.moveCursorWithoutShift(t),t!==0){let i=this.text.length;this.selectionStart=gs(0,this.selectionStart,i),this.selectionEnd=gs(0,this.selectionEnd,i),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){let n=this._selectionDirection===Le?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,n),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,n,t){let i;if(e.altKey)i=this["findWordBoundary".concat(t)](this[n]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[n]+=t==="Left"?-1:1,!0;i=this["findLineBoundary".concat(t)](this[n])}return i!==void 0&&this[n]!==i&&(this[n]=i,!0)}_moveLeft(e,n){return this._move(e,n,"Left")}_moveRight(e,n){return this._move(e,n,"Right")}moveCursorLeftWithoutShift(e){let n=!0;return this._selectionDirection=Le,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(n=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,n}moveCursorLeftWithShift(e){return this._selectionDirection===pt&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=Le,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,n){let t="moveCursor".concat(e).concat(n.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[t](n)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===Le&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=pt,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let n=!0;return this._selectionDirection=pt,this.selectionStart===this.selectionEnd?(n=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,n}},Uv=r=>!!r.button,vb=class extends yb{constructor(){super(...arguments),D(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler),this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown),this.draggableTextDelegate=new gb(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}onMouseDown(e){if(!this.canvas)return;this.__newClickTime=+new Date;let n=e.pointer;this.isTripleClick(n)&&(this.fire("tripleclick",e),Zv(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=n,this.__lastSelected=this.selected&&!this.getActiveControl()}isTripleClick(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y}doubleClickHandler(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))}tripleClickHandler(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))}_mouseDownHandler(e){let{e:n}=e;this.canvas&&this.editable&&!Uv(n)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(n)||(this.canvas.textEditingManager.register(this),this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(n)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())))}_mouseDownHandlerBefore(e){let{e:n}=e;this.canvas&&this.editable&&!Uv(n)&&(this.selected=this===this.canvas._activeObject)}mouseUpHandler(e){let{e:n,transform:t}=e,i=this.draggableTextDelegate.end(n);if(this.canvas){this.canvas.textEditingManager.unregister(this);let o=this.canvas._activeObject;if(o&&o!==this)return}!this.editable||this.group&&!this.group.interactive||t&&t.actionPerformed||Uv(n)||i||(this.__lastSelected&&!this.getActiveControl()?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(n),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0)}setCursorByClick(e){let n=this.getSelectionStartFromPointer(e),t=this.selectionStart,i=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(t,i,n):(this.selectionStart=n,this.selectionEnd=n),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){let n=this.canvas.getScenePoint(e).transform(Rn(this.calcTransformMatrix())).add(new M(-this._getLeftOffset(),-this._getTopOffset())),t=0,i=0,o=0;for(let a=0;a<this._textLines.length&&t<=n.y;a++)t+=this.getHeightOfLine(a),o=a,a>0&&(i+=this._textLines[a-1].length+this.missingNewlineOffset(a-1));let s=Math.abs(this._getLineLeftOffset(o)),l=this._textLines[o].length,c=this.__charBounds[o];for(let a=0;a<l;a++){let u=s+c[a].kernedWidth;if(n.x<=u){Math.abs(n.x-u)<=Math.abs(n.x-s)&&i++;break}s=u,i++}return Math.min(this.flipX?l-i:i,this._text.length)}},sf="moveCursorUp",af="moveCursorDown",lf="moveCursorLeft",cf="moveCursorRight",uf="exitEditing",V6=E({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:uf,27:uf,33:sf,34:af,35:cf,36:lf,37:lf,38:sf,39:cf,40:af},keysMapRtl:{9:uf,27:uf,33:sf,34:af,35:lf,36:cf,37:cf,38:sf,39:lf,40:af},ctrlKeysMapDown:{65:"selectAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1}),Ji=class r extends vb{static getDefaults(){return E(E({},super.getDefaults()),r.ownDefaults)}get type(){let e=super.type;return e==="itext"?"i-text":e}constructor(e,n){super(e,E(E({},r.ownDefaults),n)),this.initBehavior()}_set(e,n){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=n,this):(e==="canvas"&&(this.canvas instanceof nl&&this.canvas.textEditingManager.remove(this),n instanceof nl&&n.textEditingManager.add(this)),super._set(e,n))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,n){this[e]!==n&&(this._fireSelectionChanged(),this[e]=n),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,t=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,n,t)}setSelectionStyles(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,n,t)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,n=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,n)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){let n=this.isEditing;this.isEditing=!1;let t=super.toCanvasElement(e);return this.isEditing=n,t}renderCursorOrSelection(){if(!this.isEditing)return;let e=this.clearContextTop(!0);if(!e)return;let n=this._getCursorBoundaries();this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(e,n):this.renderCursor(e,n),this.canvas.contextTopDirty=!0,e.restore()}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,n=arguments.length>1?arguments[1]:void 0,t=this._getLeftOffset(),i=this._getTopOffset(),o=this._getCursorBoundariesOffsets(e,n);return{left:t,top:i,leftOffset:o.left,topOffset:o.top}}_getCursorBoundariesOffsets(e,n){return n?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let n=0,t=0,{charIndex:i,lineIndex:o}=this.get2DCursorLocation(e);for(let a=0;a<o;a++)n+=this.getHeightOfLine(a);let s=this._getLineLeftOffset(o),l=this.__charBounds[o][i];l&&(t=l.left),this.charSpacing!==0&&i===this._textLines[o].length&&(t-=this._getWidthOfCharSpacing());let c={top:n,left:s+(t>0?t:0)};return this.direction==="rtl"&&(this.textAlign===pt||this.textAlign===Lr||this.textAlign===Mc?c.left*=-1:this.textAlign===Le||this.textAlign===Ff?c.left=s-(t>0?t:0):this.textAlign!==he&&this.textAlign!==Nc||(c.left=s-(t>0?t:0))),c}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,n){this._renderCursor(e,n,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e),t=this.get2DCursorLocation(e),i=t.lineIndex,o=t.charIndex>0?t.charIndex-1:0,s=this.getValueOfPropertyAt(i,o,"fontSize"),l=this.getObjectScaling().x*this.canvas.getZoom(),c=this.cursorWidth/l,a=this.getValueOfPropertyAt(i,o,"deltaY"),u=n.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-s*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(i,o,"fill"),opacity:this._currentCursorOpacity,left:n.left+n.leftOffset-c/2,top:u+n.top+a,width:c,height:s}}_renderCursor(e,n,t){let{color:i,opacity:o,left:s,top:l,width:c,height:a}=this.getCursorRenderingData(t,n);e.fillStyle=i,e.globalAlpha=o,e.fillRect(s,l,c,a)}renderSelection(e,n){let t={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,t,n)}renderDragSourceEffect(){let e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){let n=this.getSelectionStartFromPointer(e);this.renderCursorAt(n)}_renderSelection(e,n,t){let i=n.selectionStart,o=n.selectionEnd,s=this.textAlign.includes(Lr),l=this.get2DCursorLocation(i),c=this.get2DCursorLocation(o),a=l.lineIndex,u=c.lineIndex,d=l.charIndex<0?0:l.charIndex,h=c.charIndex<0?0:c.charIndex;for(let f=a;f<=u;f++){let p=this._getLineLeftOffset(f)||0,g=this.getHeightOfLine(f),y=0,w=0,v=0;if(f===a&&(w=this.__charBounds[a][d].left),f>=a&&f<u)v=s&&!this.isEndOfWrapping(f)?this.width:this.getLineWidth(f)||5;else if(f===u)if(h===0)v=this.__charBounds[u][h].left;else{let q=this._getWidthOfCharSpacing();v=this.__charBounds[u][h-1].left+this.__charBounds[u][h-1].width-q}y=g,(this.lineHeight<1||f===u&&this.lineHeight>1)&&(g/=this.lineHeight);let x=t.left+p+w,A=g,L=0,H=v-w;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",A=1,L=g):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===pt||this.textAlign===Lr||this.textAlign===Mc?x=this.width-x-H:this.textAlign===Le||this.textAlign===Ff?x=t.left+p-v:this.textAlign!==he&&this.textAlign!==Nc||(x=t.left+p-v)),e.fillRect(x,t.top+t.topOffset+L,H,A),t.topOffset+=y}}getCurrentCharFontSize(){let e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){let e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,Ot)}_getCurrentCharIndex(){let e=this.get2DCursorLocation(this.selectionStart,!0),n=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:n}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}};D(Ji,"ownDefaults",V6),D(Ji,"type","IText"),G.setClass(Ji),G.setClass(Ji,"i-text");var Ya=class r extends Ji{static getDefaults(){return E(E({},super.getDefaults()),r.ownDefaults)}constructor(e,n){super(e,E(E({},r.ownDefaults),n))}static createControls(){return{controls:J1()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Lr)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let n=0,t=0,i=0,o={};for(let s=0;s<e.graphemeLines.length;s++)e.graphemeText[i]===`
`&&s>0?(t=0,i++,n++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[i])&&s>0&&(t++,i++),o[s]={line:n,offset:t},i+=e.graphemeLines[s].length,t+=e.graphemeLines[s].length;return o}styleHas(e,n){if(this._styleMap&&!this.isWrapping){let t=this._styleMap[n];t&&(n=t.line)}return super.styleHas(e,n)}isEmptyStyles(e){if(!this.styles)return!0;let n,t=0,i=e+1,o=!1,s=this._styleMap[e],l=this._styleMap[e+1];s&&(e=s.line,t=s.offset),l&&(i=l.line,o=i===e,n=l.offset);let c=e===void 0?this.styles:{line:this.styles[e]};for(let a in c)for(let u in c[a]){let d=parseInt(u,10);if(d>=t&&(!o||d<n))for(let h in c[a][u])return!1}return!0}_getStyleDeclaration(e,n){if(this._styleMap&&!this.isWrapping){let t=this._styleMap[e];if(!t)return{};e=t.line,n=t.offset+n}return super._getStyleDeclaration(e,n)}_setStyleDeclaration(e,n,t){let i=this._styleMap[e];super._setStyleDeclaration(i.line,i.offset+n,t)}_deleteStyleDeclaration(e,n){let t=this._styleMap[e];super._deleteStyleDeclaration(t.line,t.offset+n)}_getLineStyle(e){let n=this._styleMap[e];return!!this.styles[n.line]}_setLineStyle(e){let n=this._styleMap[e];super._setLineStyle(n.line)}_wrapText(e,n){this.isWrapping=!0;let t=this.getGraphemeDataForRender(e),i=[];for(let o=0;o<t.wordsData.length;o++)i.push(...this._wrapLine(o,n,t));return this.isWrapping=!1,i}getGraphemeDataForRender(e){let n=this.splitByGrapheme,t=n?"":" ",i=0;return{wordsData:e.map((o,s)=>{let l=0,c=n?this.graphemeSplit(o):this.wordSplit(o);return c.length===0?[{word:[],width:0}]:c.map(a=>{let u=n?[a]:this.graphemeSplit(a),d=this._measureWord(u,s,l);return i=Math.max(d,i),l+=u.length+t.length,{word:u,width:d}})}),largestWordWidth:i}}_measureWord(e,n){let t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=0;for(let s=0,l=e.length;s<l;s++)o+=this._getGraphemeBox(e[s],n,s+i,t,!0).kernedWidth,t=e[s];return o}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,n,t){let{largestWordWidth:i,wordsData:o}=t,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,l=this._getWidthOfCharSpacing(),c=this.splitByGrapheme,a=[],u=c?"":" ",d=0,h=[],f=0,p=0,g=!0;n-=s;let y=Math.max(n,i,this.dynamicMinWidth),w=o[e],v;for(f=0,v=0;v<w.length;v++){let{word:x,width:A}=w[v];f+=x.length,d+=p+A-l,d>y&&!g?(a.push(h),h=[],d=A,g=!0):d+=l,g||c||h.push(u),h=h.concat(x),p=c?0:this._measureWord([u],e,f),f++,g=!1}return v&&a.push(h),i+s>this.dynamicMinWidth&&(this.dynamicMinWidth=i-l+s),a}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,n){return this.splitByGrapheme&&!n?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){let n=super._splitTextIntoLines(e),t=this._wrapText(n.lines,this.width),i=new Array(t.length);for(let o=0;o<t.length;o++)i[o]=t[o].join("");return n.lines=i,n.graphemeLines=t,n}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){let e=new Map;for(let n in this._styleMap){let t=parseInt(n,10);if(this._textLines[t]){let i=this._styleMap[n].line;e.set("".concat(i),!0)}}for(let n in this.styles)e.has(n)||delete this.styles[n]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}};D(Ya,"type","Textbox"),D(Ya,"textLayoutProperties",[...Ji.textLayoutProperties,"width"]),D(Ya,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),G.setClass(Ya);var Bf=class extends tl{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,n){let{target:t}=e,{clipPath:i,group:o}=t;if(!i||!this.shouldPerformLayout(e))return;let{width:s,height:l}=Br(sI(t,i)),c=new M(s,l);if(i.absolutePositioned)return{center:yi(i.getRelativeCenterPoint(),void 0,o?o.calcTransformMatrix():void 0),size:c};{let a=i.getRelativeCenterPoint().transform(t.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){let{center:u=new M,correction:d=new M}=this.calcBoundingBox(n,e)||{};return{center:u.add(a),correction:d.subtract(a),size:c}}return{center:t.getRelativeCenterPoint().add(a),size:c}}}};D(Bf,"type","clip-path"),G.setClass(Bf);var jf=class extends tl{getInitialSize(e,n){let{target:t}=e,{size:i}=n;return new M(t.width||i.x,t.height||i.y)}};D(jf,"type","fixed"),G.setClass(jf);var bb=class extends ms{subscribeTargets(e){let n=e.target;e.targets.reduce((t,i)=>(i.parent&&t.add(i.parent),t),new Set).forEach(t=>{t.layoutManager.subscribeTargets({target:t,targets:[n]})})}unsubscribeTargets(e){let n=e.target,t=n.getObjects();e.targets.reduce((i,o)=>(o.parent&&i.add(o.parent),i),new Set).forEach(i=>{!t.some(o=>o.parent===i)&&i.layoutManager.unsubscribeTargets({target:i,targets:[n]})})}},Xa=class r extends Qi{static getDefaults(){return E(E({},super.getDefaults()),r.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,r.ownDefaults),this.setOptions(n);let{left:t,top:i,layoutManager:o}=n;this.groupInit(e,{left:t,top:i,layoutManager:o??new bb})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];this.multiSelectionStacking==="selection-order"?this.add(...n):n.forEach(i=>{let o=this._objects.findIndex(l=>l.isInFrontOf(i)),s=o===-1?this.size():o;this.insertAt(s,i)})}canEnterGroup(e){return this.getObjects().some(n=>n.isDescendantOf(e)||e.isDescendantOf(n))?(eo("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,n){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,n)}exitGroup(e,n){this._exitGroup(e,n),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,n){super._onAfterObjectsChange(e,n);let t=new Set;n.forEach(i=>{let{parent:o}=i;o&&t.add(o)}),e===Ub?t.forEach(i=>{i._onAfterObjectsChange(Pf,n)}):t.forEach(i=>{i._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,n,t){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;let i=E(E({hasControls:!1},t),{},{forActiveSelection:!0});for(let o=0;o<this._objects.length;o++)this._objects[o]._renderControls(e,i);super._renderControls(e,n),e.restore()}};D(Xa,"type","ActiveSelection"),D(Xa,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),G.setClass(Xa),G.setClass(Xa,"activeSelection");var wb=class{constructor(){D(this,"resources",{})}applyFilters(e,n,t,i,o){let s=o.getContext("2d");if(!s)return;s.drawImage(n,0,0,t,i);let l={sourceWidth:t,sourceHeight:i,imageData:s.getImageData(0,0,t,i),originalEl:n,originalImageData:s.getImageData(0,0,t,i),canvasEl:o,ctx:s,filterBackend:this};e.forEach(a=>{a.applyTo(l)});let{imageData:c}=l;return c.width===t&&c.height===i||(o.width=c.width,o.height=c.height),s.putImageData(c,0,0),l}},Vf=class{constructor(){let{tileSize:e=Oe.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};D(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),D(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,n){this.dispose(),this.createWebGLCanvas(e,n)}createWebGLCanvas(e,n){let t=xr({width:e,height:n}),i=t.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});i&&(i.clearColor(0,0,0,0),this.canvas=t,this.gl=i)}applyFilters(e,n,t,i,o,s){let l=this.gl,c=o.getContext("2d");if(!l||!c)return;let a;s&&(a=this.getCachedTexture(s,n));let u={originalWidth:n.width||n.naturalWidth||0,originalHeight:n.height||n.naturalHeight||0,sourceWidth:t,sourceHeight:i,destinationWidth:t,destinationHeight:i,context:l,sourceTexture:this.createTexture(l,t,i,a?void 0:n),targetTexture:this.createTexture(l,t,i),originalTexture:a||this.createTexture(l,t,i,a?void 0:n),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:o},d=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,d),e.forEach(h=>{h&&h.applyTo(u)}),function(h){let f=h.targetCanvas,p=f.width,g=f.height,y=h.destinationWidth,w=h.destinationHeight;p===y&&g===w||(f.width=y,f.height=w)}(u),this.copyGLTo2D(l,u),l.bindTexture(l.TEXTURE_2D,null),l.deleteTexture(u.sourceTexture),l.deleteTexture(u.targetTexture),l.deleteFramebuffer(d),c.setTransform(1,0,0,1,0,0),u}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,n,t,i,o){let{NEAREST:s,TEXTURE_2D:l,RGBA:c,UNSIGNED_BYTE:a,CLAMP_TO_EDGE:u,TEXTURE_MAG_FILTER:d,TEXTURE_MIN_FILTER:h,TEXTURE_WRAP_S:f,TEXTURE_WRAP_T:p}=e,g=e.createTexture();return e.bindTexture(l,g),e.texParameteri(l,d,o||s),e.texParameteri(l,h,o||s),e.texParameteri(l,f,u),e.texParameteri(l,p,u),i?e.texImage2D(l,0,c,c,a,i):e.texImage2D(l,0,c,n,t,0,c,a,null),g}getCachedTexture(e,n,t){let{textureCache:i}=this;if(i[e])return i[e];{let o=this.createTexture(this.gl,n.width,n.height,n,t);return o&&(i[e]=o),o}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,n){let t=e.canvas,i=n.targetCanvas,o=i.getContext("2d");if(!o)return;o.translate(0,i.height),o.scale(1,-1);let s=t.height-i.height;o.drawImage(t,0,s,i.width,i.height,0,0,i.width,i.height)}copyGLTo2DPutImageData(e,n){let t=n.targetCanvas.getContext("2d"),i=n.destinationWidth,o=n.destinationHeight,s=i*o*4;if(!t)return;let l=new Uint8Array(this.imageBuffer,0,s),c=new Uint8ClampedArray(this.imageBuffer,0,s);e.readPixels(0,0,i,o,e.RGBA,e.UNSIGNED_BYTE,l);let a=new ImageData(c,i,o);t.putImageData(a,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;let e=this.gl,n={renderer:"",vendor:""};if(!e)return n;let t=e.getExtension("WEBGL_debug_renderer_info");if(t){let i=e.getParameter(t.UNMASKED_RENDERER_WEBGL),o=e.getParameter(t.UNMASKED_VENDOR_WEBGL);i&&(n.renderer=i.toLowerCase()),o&&(n.vendor=o.toLowerCase())}return this.gpuInfo=n,n}},Hv;function $6(){let{WebGLProbe:r}=jr();return r.queryWebGL(er()),Oe.enableGLFiltering&&r.isSupported(Oe.textureSize)?new Vf({tileSize:Oe.textureSize}):new wb}function zv(){return!Hv&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(Hv=$6()),Hv}var U6=["filters","resizeFilter","src","crossOrigin","type"],AI=["cropX","cropY"],Zn=class r extends Rt{static getDefaults(){return E(E({},super.getDefaults()),r.ownDefaults)}constructor(e,n){super(),D(this,"_lastScaleX",1),D(this,"_lastScaleY",1),D(this,"_filterScalingX",1),D(this,"_filterScalingY",1),this.filters=[],Object.assign(this,r.ownDefaults),this.setOptions(n),this.cacheKey="texture".concat(no()),this.setElement(typeof e=="string"?(this.canvas&&vr(this.canvas.getElement())||rl()).getElementById(e):e,n)}getElement(){return this._element}setElement(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(n),e.classList.add(r.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){let n=zv(!1);n instanceof Vf&&n.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{let n=this[e];n&&jr().dispose(n),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){let e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;let n=this.width/2,t=this.height/2;e.beginPath(),e.moveTo(-n,-t),e.lineTo(n,-t),e.lineTo(n,t),e.lineTo(-n,t),e.lineTo(-n,-t),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[];return this.filters.forEach(t=>{t&&n.push(t.toObject())}),E(E({},super.toObject([...AI,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:n},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){let e=[],n=this._element,t=-this.width/2,i=-this.height/2,o=[],s=[],l="",c="";if(!n)return[];if(this.hasCrop()){let a=no();o.push('<clipPath id="imageCrop_'+a+`">
`,'	<rect x="'+t+'" y="'+i+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),l=' clip-path="url(#imageCrop_'+a+')" '}if(this.imageSmoothing||(c=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(t-this.cropX,'" y="').concat(i-this.cropY,'" width="').concat(n.width||n.naturalWidth,'" height="').concat(n.height||n.naturalHeight,'"').concat(c).concat(l,`></image>
`)),this.stroke||this.strokeDashArray){let a=this.fill;this.fill=null,s=['	<rect x="'.concat(t,'" y="').concat(i,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=a}return o=this.paintFirst!==Ot?o.concat(s,e):o.concat(e,s),o}getSrc(e){let n=e?this._element:this._originalElement;return n?n.toDataURL?n.toDataURL():this.srcFromAttribute?n.getAttribute("src")||"":n.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:n,signal:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ac(e,{crossOrigin:n,signal:t}).then(i=>{n!==void 0&&this.set({crossOrigin:n}),this.setElement(i)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){let e=this.resizeFilter,n=this.minimumScaleTrigger,t=this.getTotalObjectScaling(),i=t.x,o=t.y,s=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||i>n&&o>n)return this._element=s,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,void(this._lastScaleY=o);let l=xr(s),{width:c,height:a}=s;this._element=l,this._lastScaleX=e.scaleX=i,this._lastScaleY=e.scaleY=o,zv().applyFilters([e],s,c,a,this._element),this._filterScalingX=l.width/this._originalElement.width,this._filterScalingY=l.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(o=>o&&!o.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);let n=this._originalElement,t=n.naturalWidth||n.width,i=n.naturalHeight||n.height;if(this._element===this._originalElement){let o=xr({width:t,height:i});this._element=o,this._filteredEl=o}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,t,i),this._lastScaleX=1,this._lastScaleY=1);zv().applyFilters(e,this._originalElement,t,i,this._element),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){let n=this._element;if(!n)return;let t=this._filterScalingX,i=this._filterScalingY,o=this.width,s=this.height,l=Math.max(this.cropX,0),c=Math.max(this.cropY,0),a=n.naturalWidth||n.width,u=n.naturalHeight||n.height,d=l*t,h=c*i,f=Math.min(o*t,a-d),p=Math.min(s*i,u-h),g=-o/2,y=-s/2,w=Math.min(o,a/t-l),v=Math.min(s,u/i-c);n&&e.drawImage(n,d,h,f,p,g,y,w,v)}_needsResize(){let e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=this.getOriginalSize();this.width=e||t.width,this.height=n||t.height}parsePreserveAspectRatioAttribute(){let e=x1(this.preserveAspectRatio||""),n=this.width,t=this.height,i={width:n,height:t},o,s=this._element.width,l=this._element.height,c=1,a=1,u=0,d=0,h=0,f=0;return!e||e.alignX===bn&&e.alignY===bn?(c=n/s,a=t/l):(e.meetOrSlice==="meet"&&(c=a=lI(this._element,i),o=(n-s*c)/2,e.alignX==="Min"&&(u=-o),e.alignX==="Max"&&(u=o),o=(t-l*a)/2,e.alignY==="Min"&&(d=-o),e.alignY==="Max"&&(d=o)),e.meetOrSlice==="slice"&&(c=a=cI(this._element,i),o=s-n/c,e.alignX==="Mid"&&(h=o/2),e.alignX==="Max"&&(h=o),o=l-t/a,e.alignY==="Mid"&&(f=o/2),e.alignY==="Max"&&(f=o),s=n/c,l=t/a)),{width:s,height:l,scaleX:c,scaleY:a,offsetLeft:u,offsetTop:d,cropX:h,cropY:f}}static fromObject(e,n){let{filters:t,resizeFilter:i,src:o,crossOrigin:s,type:l}=e,c=nt(e,U6);return Promise.all([Ac(o,E(E({},n),{},{crossOrigin:s})),t&&Qa(t,n),i&&Qa([i],n),Uc(c,n)]).then(a=>{let[u,d=[],[h]=[],f={}]=a;return new this(u,E(E({},c),{},{src:o,filters:d,resizeFilter:h},f))})}static fromURL(e){let{crossOrigin:n=null,signal:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;return Ac(e,{crossOrigin:n,signal:t}).then(o=>new this(o,i))}static fromElement(n){return F(this,arguments,function*(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,o=wi(e,this.ATTRIBUTE_NAMES,i);return this.fromURL(o["xlink:href"],t,o).catch(s=>(eo("log","Unable to parse Image",s),null))})}};D(Zn,"type","Image"),D(Zn,"cacheProperties",[...bi,...AI]),D(Zn,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),D(Zn,"CSS_CANVAS","canvas-img"),D(Zn,"ATTRIBUTE_NAMES",[...so,"x","y","width","height","preserveAspectRatio","xlink:href","crossOrigin","image-rendering"]),G.setClass(Zn),G.setSVGClass(Zn);var Iee=Xf(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);var PI=g1,c1=r=>function(e,n,t){let{points:i,pathOffset:o}=t;return new M(i[r]).subtract(o).transform(ct(t.getViewportTransform(),t.calcTransformMatrix()))},MI=(r,e,n,t)=>{let{target:i,pointIndex:o}=e,s=i,l=yi(new M(n,t),void 0,s.calcOwnMatrix());return s.points[o]=l.add(s.pathOffset),s.setDimensions(),!0},NI=(r,e)=>function(n,t,i,o){let s=t.target,l=new M(s.points[(r>0?r:s.points.length)-1]),c=l.subtract(s.pathOffset).transform(s.calcOwnMatrix()),a=e(n,E(E({},t),{},{pointIndex:r}),i,o),u=l.subtract(s.pathOffset).transform(s.calcOwnMatrix()).subtract(c);return s.left-=u.x,s.top-=u.y,a},u1=r=>oo(PI,NI(r,MI)),_b=(r,e,n)=>{let{path:t,pathOffset:i}=r,o=t[e];return new M(o[n]-i.x,o[n+1]-i.y).transform(ct(r.getViewportTransform(),r.calcTransformMatrix()))};function H6(r,e,n){let{commandIndex:t,pointIndex:i}=this;return _b(n,t,i)}function z6(r,e,n,t){let{target:i}=e,{commandIndex:o,pointIndex:s}=this,l=((c,a,u,d,h)=>{let{path:f,pathOffset:p}=c,g=f[(d>0?d:f.length)-1],y=new M(g[h],g[h+1]),w=y.subtract(p).transform(c.calcOwnMatrix()),v=yi(new M(a,u),void 0,c.calcOwnMatrix());f[d][h]=v.x+p.x,f[d][h+1]=v.y+p.y,c.setDimensions();let x=y.subtract(c.pathOffset).transform(c.calcOwnMatrix()).subtract(w);return c.left-=x.x,c.top-=x.y,c.set("dirty",!0),!0})(i,n,t,o,s);return Nb(this.actionName,E(E({},Rb(r,e,n,t)),{},{commandIndex:o,pointIndex:s})),l}var $f=class extends an{constructor(e){super(e)}render(e,n,t,i,o){let s=E(E({},i),{},{cornerColor:this.controlFill,cornerStrokeColor:this.controlStroke,transparentCorners:!this.controlFill});super.render(e,n,t,s,o)}},Tb=class extends $f{constructor(e){super(e)}render(e,n,t,i,o){let{path:s}=o,{commandIndex:l,pointIndex:c,connectToCommandIndex:a,connectToPointIndex:u}=this;e.save(),e.strokeStyle=this.controlStroke,this.connectionDashArray&&e.setLineDash(this.connectionDashArray);let[d]=s[l],h=_b(o,a,u);if(d==="Q"){let f=_b(o,l,c+2);e.moveTo(f.x,f.y),e.lineTo(n,t)}else e.moveTo(n,t);e.lineTo(h.x,h.y),e.stroke(),e.restore(),super.render(e,n,t,i,o)}},df=(r,e,n,t,i,o)=>new(n?Tb:$f)(E(E({commandIndex:r,pointIndex:e,actionName:"modifyPath",positionHandler:H6,actionHandler:z6,connectToCommandIndex:i,connectToPointIndex:o},t),n?t.controlPointStyle:t.pointStyle)),Oee=Object.freeze({__proto__:null,changeWidth:ob,createObjectDefaultControls:jb,createPathControls:function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n={},t="M";return r.path.forEach((i,o)=>{let s=i[0];switch(s!=="Z"&&(n["c_".concat(o,"_").concat(s)]=df(o,i.length-2,!1,e)),s){case"C":n["c_".concat(o,"_C_CP_1")]=df(o,1,!0,e,o-1,(l=>l==="C"?5:l==="Q"?3:1)(t)),n["c_".concat(o,"_C_CP_2")]=df(o,3,!0,e,o,5);break;case"Q":n["c_".concat(o,"_Q_CP_1")]=df(o,1,!0,e,o,3)}t=s}),n},createPolyActionHandler:u1,createPolyControls:function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n={};for(let t=0;t<(typeof r=="number"?r:r.points.length);t++)n["p".concat(t)]=new an(E({actionName:PI,positionHandler:c1(t),actionHandler:u1(t)},e));return n},createPolyPositionHandler:c1,createResizeControls:Z1,createTextboxDefaultControls:J1,dragHandler:N1,factoryPolyActionHandler:NI,getLocalPoint:Yf,polyActionHandler:MI,renderCircleControl:j1,renderSquareControl:V1,rotationStyleHandler:$1,rotationWithSnapping:U1,scaleCursorStyleHandler:Ha,scaleOrSkewActionName:Cc,scaleSkewCursorStyleHandler:Xo,scalingEqually:Dc,scalingX:G1,scalingXOrSkewingY:sb,scalingY:W1,scalingYOrSkewingX:ab,skewCursorStyleHandler:q1,skewHandlerX:X1,skewHandlerY:K1,wrapWithFireEvent:oo,wrapWithFixedAnchor:vs}),ep=r=>r.webgl!==void 0;var zb="precision highp float",G6=`
    `.concat(zb,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),W6=["type"],q6=["type"],Y6=new RegExp(zb,"g"),ut=class{get type(){return this.constructor.type}constructor(){let e=nt(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},W6);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return G6}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource(),{WebGLProbe:{GLPrecision:i="highp"}}=jr();i!=="highp"&&(n=n.replace(Y6,zb.replace("highp",i)));let o=e.createShader(e.VERTEX_SHADER),s=e.createShader(e.FRAGMENT_SHADER),l=e.createProgram();if(!o||!s||!l)throw new Qn("Vertex, fragment shader or program creation error");if(e.shaderSource(o,t),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new Qn("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(o)));if(e.shaderSource(s,n),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))throw new Qn("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(s)));if(e.attachShader(l,o),e.attachShader(l,s),e.linkProgram(l),!e.getProgramParameter(l,e.LINK_STATUS))throw new Qn('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(l)));let c=this.getUniformLocations(e,l)||{};return c.uStepW=e.getUniformLocation(l,"uStepW"),c.uStepH=e.getUniformLocation(l,"uStepH"),{program:l,attributeLocations:this.getAttributeLocations(e,l),uniformLocations:c}}getAttributeLocations(e,n){return{aPosition:e.getAttribLocation(n,"aPosition")}}getUniformLocations(e,n){let t=this.constructor.uniformLocations,i={};for(let o=0;o<t.length;o++)i[t[o]]=e.getUniformLocation(n,t[o]);return i}sendAttributeData(e,n,t){let i=n.aPosition,o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)}_setupFrameBuffer(e){let n=e.context;if(e.passes>1){let t=e.destinationWidth,i=e.destinationHeight;e.sourceWidth===t&&e.sourceHeight===i||(n.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(n,t,i)),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e.targetTexture,0)}else n.bindFramebuffer(n.FRAMEBUFFER,null),n.finish()}_swapTextures(e){e.passes--,e.pass++;let n=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=n}isNeutralState(e){return!1}applyTo(e){ep(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){let n=this.getCacheKey();return e.programCache[n]||(e.programCache[n]=this.createProgram(e.context)),e.programCache[n]}applyToWebGL(e){let n=e.context,t=this.retrieveShader(e);e.pass===0&&e.originalTexture?n.bindTexture(n.TEXTURE_2D,e.originalTexture):n.bindTexture(n.TEXTURE_2D,e.sourceTexture),n.useProgram(t.program),this.sendAttributeData(n,t.attributeLocations,e.aPosition),n.uniform1f(t.uniformLocations.uStepW,1/e.sourceWidth),n.uniform1f(t.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(n,t.uniformLocations),n.viewport(0,0,e.destinationWidth,e.destinationHeight),n.drawArrays(n.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,n,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,n),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,n){}createHelpLayer(e){if(!e.helpLayer){let{sourceWidth:n,sourceHeight:t}=e,i=xr({width:n,height:t});e.helpLayer=i}}toObject(){let e=Object.keys(this.constructor.defaults||{});return E({type:this.type},e.reduce((n,t)=>(n[t]=this[t],n),{}))}toJSON(){return this.toObject()}static fromObject(e,n){return F(this,null,function*(){return new this(nt(e,q6))})}};D(ut,"type","BaseFilter"),D(ut,"uniformLocations",[]);var X6={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `},Ko=class extends ut{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(X6[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:n}}=e,t=new dn(this.color).getSource(),i=this.alpha,o=t[0]*i,s=t[1]*i,l=t[2]*i,c=1-i;for(let a=0;a<n.length;a+=4){let u=n[a],d=n[a+1],h=n[a+2],f,p,g;switch(this.mode){case"multiply":f=u*o/255,p=d*s/255,g=h*l/255;break;case"screen":f=255-(255-u)*(255-o)/255,p=255-(255-d)*(255-s)/255,g=255-(255-h)*(255-l)/255;break;case"add":f=u+o,p=d+s,g=h+l;break;case"difference":f=Math.abs(u-o),p=Math.abs(d-s),g=Math.abs(h-l);break;case"subtract":f=u-o,p=d-s,g=h-l;break;case"darken":f=Math.min(u,o),p=Math.min(d,s),g=Math.min(h,l);break;case"lighten":f=Math.max(u,o),p=Math.max(d,s),g=Math.max(h,l);break;case"overlay":f=o<128?2*u*o/255:255-2*(255-u)*(255-o)/255,p=s<128?2*d*s/255:255-2*(255-d)*(255-s)/255,g=l<128?2*h*l/255:255-2*(255-h)*(255-l)/255;break;case"exclusion":f=o+u-2*o*u/255,p=s+d-2*s*d/255,g=l+h-2*l*h/255;break;case"tint":f=o+u*c,p=s+d*c,g=l+h*c}n[a]=f,n[a+1]=p,n[a+2]=g}}sendUniformData(e,n){let t=new dn(this.color).getSource();t[0]=this.alpha*t[0]/255,t[1]=this.alpha*t[1]/255,t[2]=this.alpha*t[2]/255,t[3]=this.alpha,e.uniform4fv(n.uColor,t)}};D(Ko,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),D(Ko,"type","BlendColor"),D(Ko,"uniformLocations",["uColor"]),G.setClass(Ko);var K6={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},Z6=["type","image"],Zo=class extends ut{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return K6[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){let n=e.context,t=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(n,t,n.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(n,n.TEXTURE1)}createTexture(e,n){return e.getCachedTexture(n.cacheKey,n.getElement())}calculateMatrix(){let e=this.image,{width:n,height:t}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/n,-e.top/t,1]}applyTo2d(e){let{imageData:{data:n,width:t,height:i},filterBackend:{resources:o}}=e,s=this.image;o.blendImage||(o.blendImage=er());let l=o.blendImage,c=l.getContext("2d");l.width!==t||l.height!==i?(l.width=t,l.height=i):c.clearRect(0,0,t,i),c.setTransform(s.scaleX,0,0,s.scaleY,s.left,s.top),c.drawImage(s.getElement(),0,0,t,i);let a=c.getImageData(0,0,t,i).data;for(let u=0;u<n.length;u+=4){let d=n[u],h=n[u+1],f=n[u+2],p=n[u+3],g=a[u],y=a[u+1],w=a[u+2],v=a[u+3];switch(this.mode){case"multiply":n[u]=d*g/255,n[u+1]=h*y/255,n[u+2]=f*w/255,n[u+3]=p*v/255;break;case"mask":n[u+3]=v}}}sendUniformData(e,n){let t=this.calculateMatrix();e.uniform1i(n.uImage,1),e.uniformMatrix3fv(n.uTransformMatrix,!1,t)}toObject(){return E(E({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static fromObject(e,n){return F(this,null,function*(){let{type:t,image:i}=e,o=nt(e,Z6);return Zn.fromObject(i,n).then(s=>new this(E(E({},o),{},{image:s})))})}};D(Zo,"type","BlendImage"),D(Zo,"defaults",{mode:"multiply",alpha:1}),D(Zo,"uniformLocations",["uTransformMatrix","uImage"]),G.setClass(Zo);var Jo=class extends ut{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float total = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        float weight = 1.0 - abs(percent);
        color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
        total += weight;
      }
      gl_FragColor = color / total;
    }
  `}applyTo(e){ep(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){e.imageData=this.simpleBlur(e)}simpleBlur(e){let{ctx:n,imageData:t,filterBackend:{resources:i}}=e,{width:o,height:s}=t;i.blurLayer1||(i.blurLayer1=er(),i.blurLayer2=er());let l=i.blurLayer1,c=i.blurLayer2;l.width===o&&l.height===s||(c.width=l.width=o,c.height=l.height=s);let a=l.getContext("2d"),u=c.getContext("2d"),d=15,h=.06*this.blur*.5,f,p,g,y;for(a.putImageData(t,0,0),u.clearRect(0,0,o,s),y=-15;y<=d;y++)f=(Math.random()-.5)/4,p=y/d,g=h*p*o+f,u.globalAlpha=1-Math.abs(p),u.drawImage(l,g,f),a.drawImage(c,0,0),u.globalAlpha=1,u.clearRect(0,0,c.width,c.height);for(y=-15;y<=d;y++)f=(Math.random()-.5)/4,p=y/d,g=h*p*s+f,u.globalAlpha=1-Math.abs(p),u.drawImage(l,f,g),a.drawImage(c,0,0),u.globalAlpha=1,u.clearRect(0,0,c.width,c.height);n.drawImage(l,0,0);let w=n.getImageData(0,0,l.width,l.height);return a.globalAlpha=1,a.clearRect(0,0,l.width,l.height),w}sendUniformData(e,n){let t=this.chooseRightDelta();e.uniform2fv(n.uDelta,t)}isNeutralState(){return this.blur===0}chooseRightDelta(){let e=1,n=[0,0];this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio);let t=e*this.blur*.12;return this.horizontal?n[0]=t:n[1]=t,n}};D(Jo,"type","Blur"),D(Jo,"defaults",{blur:0}),D(Jo,"uniformLocations",["uDelta"]),G.setClass(Jo);var Qo=class extends ut{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:n}}=e,t=Math.round(255*this.brightness);for(let i=0;i<n.length;i+=4)n[i]+=t,n[i+1]+=t,n[i+2]+=t}isNeutralState(){return this.brightness===0}sendUniformData(e,n){e.uniform1f(n.uBrightness,this.brightness)}};D(Qo,"type","Brightness"),D(Qo,"defaults",{brightness:0}),D(Qo,"uniformLocations",["uBrightness"]),G.setClass(Qo);var RI={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0},mi=class extends ut{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){let n=e.imageData.data,t=this.matrix,i=this.colorsOnly;for(let o=0;o<n.length;o+=4){let s=n[o],l=n[o+1],c=n[o+2];if(n[o]=s*t[0]+l*t[1]+c*t[2]+255*t[4],n[o+1]=s*t[5]+l*t[6]+c*t[7]+255*t[9],n[o+2]=s*t[10]+l*t[11]+c*t[12]+255*t[14],!i){let a=n[o+3];n[o]+=a*t[3],n[o+1]+=a*t[8],n[o+2]+=a*t[13],n[o+3]=s*t[15]+l*t[16]+c*t[17]+a*t[18]+255*t[19]}}}sendUniformData(e,n){let t=this.matrix,i=[t[0],t[1],t[2],t[3],t[5],t[6],t[7],t[8],t[10],t[11],t[12],t[13],t[15],t[16],t[17],t[18]],o=[t[4],t[9],t[14],t[19]];e.uniformMatrix4fv(n.uColorMatrix,!1,i),e.uniform4fv(n.uConstants,o)}toObject(){return E(E({},super.toObject()),{},{matrix:[...this.matrix]})}};function bs(r,e){var n;let t=(D(n=class extends mi{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",r),D(n,"defaults",{colorsOnly:!1,matrix:e}),n);return G.setClass(t,r),t}D(mi,"type","ColorMatrix"),D(mi,"defaults",RI),D(mi,"uniformLocations",["uColorMatrix","uConstants"]),G.setClass(mi);var J6=bs("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]),Q6=bs("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]),ez=bs("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]),tz=bs("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]),nz=bs("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]),rz=bs("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]),iz=bs("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]),Vc=class extends ut{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){ep(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(n=>{n.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,n){return Promise.all((e.subFilters||[]).map(t=>G.getClass(t.type).fromObject(t,n))).then(t=>new this({subFilters:t}))}};D(Vc,"type","Composed"),G.setClass(Vc);var es=class extends ut{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:n}}=e,t=Math.floor(255*this.contrast),i=259*(t+255)/(255*(259-t));for(let o=0;o<n.length;o+=4)n[o]=i*(n[o]-128)+128,n[o+1]=i*(n[o+1]-128)+128,n[o+2]=i*(n[o+2]-128)+128}sendUniformData(e,n){e.uniform1f(n.uContrast,this.contrast)}};D(es,"type","Contrast"),D(es,"defaults",{contrast:0}),D(es,"uniformLocations",["uContrast"]),G.setClass(es);var oz={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `},ts=class extends ut{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return oz[this.getCacheKey()]}applyTo2d(e){let n=e.imageData,t=n.data,i=this.matrix,o=Math.round(Math.sqrt(i.length)),s=Math.floor(o/2),l=n.width,c=n.height,a=e.ctx.createImageData(l,c),u=a.data,d=this.opaque?1:0,h,f,p,g,y,w,v,x,A,L,H,q,$;for(H=0;H<c;H++)for(L=0;L<l;L++){for(y=4*(H*l+L),h=0,f=0,p=0,g=0,$=0;$<o;$++)for(q=0;q<o;q++)v=H+$-s,w=L+q-s,v<0||v>=c||w<0||w>=l||(x=4*(v*l+w),A=i[$*o+q],h+=t[x]*A,f+=t[x+1]*A,p+=t[x+2]*A,d||(g+=t[x+3]*A));u[y]=h,u[y+1]=f,u[y+2]=p,u[y+3]=d?t[y+3]:g}e.imageData=a}sendUniformData(e,n){e.uniform1fv(n.uMatrix,this.matrix)}toObject(){return E(E({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}};D(ts,"type","Convolute"),D(ts,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),D(ts,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),G.setClass(ts);var kI="Gamma",ns=class extends ut{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:n}}=e,t=this.gamma,i=1/t[0],o=1/t[1],s=1/t[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});let l=this.rgbValues;for(let c=0;c<256;c++)l.r[c]=255*Math.pow(c/255,i),l.g[c]=255*Math.pow(c/255,o),l.b[c]=255*Math.pow(c/255,s);for(let c=0;c<n.length;c+=4)n[c]=l.r[n[c]],n[c+1]=l.g[n[c+1]],n[c+2]=l.b[n[c+2]]}sendUniformData(e,n){e.uniform3fv(n.uGamma,this.gamma)}isNeutralState(){let{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:kI,gamma:this.gamma.concat()}}};D(ns,"type",kI),D(ns,"defaults",{gamma:[1,1,1]}),D(ns,"uniformLocations",["uGamma"]),G.setClass(ns);var sz={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `},rs=class extends ut{applyTo2d(e){let{imageData:{data:n}}=e;for(let t,i=0;i<n.length;i+=4){let o=n[i],s=n[i+1],l=n[i+2];switch(this.mode){case"average":t=(o+s+l)/3;break;case"lightness":t=(Math.min(o,s,l)+Math.max(o,s,l))/2;break;case"luminosity":t=.21*o+.72*s+.07*l}n[i+2]=n[i+1]=n[i]=t}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return sz[this.mode]}sendUniformData(e,n){e.uniform1i(n.uMode,1)}isNeutralState(){return!1}};D(rs,"type","Grayscale"),D(rs,"defaults",{mode:"average"}),D(rs,"uniformLocations",["uMode"]),G.setClass(rs);var az=E(E({},RI),{},{rotation:0}),Za=class extends mi{calculateMatrix(){let e=this.rotation*Math.PI,n=_r(e),t=Tr(e),i=1/3,o=Math.sqrt(i)*t,s=1-n;this.matrix=[n+s/3,i*s-o,i*s+o,0,0,i*s+o,n+i*s,i*s-o,0,0,i*s-o,i*s+o,n+i*s,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}};D(Za,"type","HueRotation"),D(Za,"defaults",az),G.setClass(Za);var is=class extends ut{applyTo2d(e){let{imageData:{data:n}}=e;for(let t=0;t<n.length;t+=4)n[t]=255-n[t],n[t+1]=255-n[t+1],n[t+2]=255-n[t+2],this.alpha&&(n[t+3]=255-n[t+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,n){e.uniform1i(n.uInvert,Number(this.invert)),e.uniform1i(n.uAlpha,Number(this.alpha))}};D(is,"type","Invert"),D(is,"defaults",{alpha:!1,invert:!0}),D(is,"uniformLocations",["uInvert","uAlpha"]),G.setClass(is);var os=class extends ut{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:n}}=e,t=this.noise;for(let i=0;i<n.length;i+=4){let o=(.5-Math.random())*t;n[i]+=o,n[i+1]+=o,n[i+2]+=o}}sendUniformData(e,n){e.uniform1f(n.uNoise,this.noise/255),e.uniform1f(n.uSeed,Math.random())}isNeutralState(){return this.noise===0}};D(os,"type","Noise"),D(os,"defaults",{noise:0}),D(os,"uniformLocations",["uNoise","uSeed"]),G.setClass(os);var ss=class extends ut{applyTo2d(e){let{imageData:{data:n,width:t,height:i}}=e;for(let o=0;o<i;o+=this.blocksize)for(let s=0;s<t;s+=this.blocksize){let l=4*o*t+4*s,c=n[l],a=n[l+1],u=n[l+2],d=n[l+3];for(let h=o;h<Math.min(o+this.blocksize,i);h++)for(let f=s;f<Math.min(s+this.blocksize,t);f++){let p=4*h*t+4*f;n[p]=c,n[p+1]=a,n[p+2]=u,n[p+3]=d}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,n){e.uniform1f(n.uBlocksize,this.blocksize)}};D(ss,"type","Pixelate"),D(ss,"defaults",{blocksize:4}),D(ss,"uniformLocations",["uBlocksize"]),G.setClass(ss);var as=class extends ut{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:n}}=e,t=255*this.distance,i=new dn(this.color).getSource(),o=[i[0]-t,i[1]-t,i[2]-t],s=[i[0]+t,i[1]+t,i[2]+t];for(let l=0;l<n.length;l+=4){let c=n[l],a=n[l+1],u=n[l+2];c>o[0]&&a>o[1]&&u>o[2]&&c<s[0]&&a<s[1]&&u<s[2]&&(n[l+3]=0)}}sendUniformData(e,n){let t=new dn(this.color).getSource(),i=this.distance,o=[0+t[0]/255-i,0+t[1]/255-i,0+t[2]/255-i,1],s=[t[0]/255+i,t[1]/255+i,t[2]/255+i,1];e.uniform4fv(n.uLow,o),e.uniform4fv(n.uHigh,s)}};D(as,"type","RemoveColor"),D(as,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),D(as,"uniformLocations",["uLow","uHigh"]),G.setClass(as);var ls=class extends ut{sendUniformData(e,n){e.uniform2fv(n.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(n.uTaps,this.taps)}getFilterWindow(){let e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){let e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){let e=this.getFilterWindow();return this.generateShader(e)}getTaps(){let e=this.lanczosCreate(this.lanczosLobes),n=this.tempScale,t=this.getFilterWindow(),i=new Array(t);for(let o=1;o<=t;o++)i[o-1]=e(o*n);return i}generateShader(e){let n=new Array(e);for(let t=1;t<=e;t++)n[t-1]="".concat(t,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(n.map((t,i)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(t,") * uTaps[").concat(i,"] + texture2D(uTexture, vTexCoord - ").concat(t,") * uTaps[").concat(i,`];
              sum += 2.0 * uTaps[`).concat(i,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){ep(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return n=>{if(n>=e||n<=-e)return 0;if(n<11920929e-14&&n>-11920929e-14)return 1;let t=(n*=Math.PI)/e;return Math.sin(n)/n*Math.sin(t)/t}}applyTo2d(e){let n=e.imageData,t=this.scaleX,i=this.scaleY;this.rcpScaleX=1/t,this.rcpScaleY=1/i;let o=n.width,s=n.height,l=Math.round(o*t),c=Math.round(s*i),a;a=this.resizeType==="sliceHack"?this.sliceByTwo(e,o,s,l,c):this.resizeType==="hermite"?this.hermiteFastResize(e,o,s,l,c):this.resizeType==="bilinear"?this.bilinearFiltering(e,o,s,l,c):this.resizeType==="lanczos"?this.lanczosResize(e,o,s,l,c):new ImageData(l,c),e.imageData=a}sliceByTwo(e,n,t,i,o){let s=e.imageData,l=.5,c=!1,a=!1,u=n*l,d=t*l,h=e.filterBackend.resources,f=0,p=0,g=n,y=0;h.sliceByTwo||(h.sliceByTwo=er());let w=h.sliceByTwo;(w.width<1.5*n||w.height<t)&&(w.width=1.5*n,w.height=t);let v=w.getContext("2d");for(v.clearRect(0,0,1.5*n,t),v.putImageData(s,0,0),i=Math.floor(i),o=Math.floor(o);!c||!a;)n=u,t=d,i<Math.floor(u*l)?u=Math.floor(u*l):(u=i,c=!0),o<Math.floor(d*l)?d=Math.floor(d*l):(d=o,a=!0),v.drawImage(w,f,p,n,t,g,y,u,d),f=g,p=y,y+=d;return v.getImageData(f,p,i,o)}lanczosResize(e,n,t,i,o){let s=e.imageData.data,l=e.ctx.createImageData(i,o),c=l.data,a=this.lanczosCreate(this.lanczosLobes),u=this.rcpScaleX,d=this.rcpScaleY,h=2/this.rcpScaleX,f=2/this.rcpScaleY,p=Math.ceil(u*this.lanczosLobes/2),g=Math.ceil(d*this.lanczosLobes/2),y={},w={x:0,y:0},v={x:0,y:0};return function x(A){let L,H,q,$,we,ne,He,_e,Ee,Pe,Ve;for(w.x=(A+.5)*u,v.x=Math.floor(w.x),L=0;L<o;L++){for(w.y=(L+.5)*d,v.y=Math.floor(w.y),we=0,ne=0,He=0,_e=0,Ee=0,H=v.x-p;H<=v.x+p;H++)if(!(H<0||H>=n)){Pe=Math.floor(1e3*Math.abs(H-w.x)),y[Pe]||(y[Pe]={});for(let oe=v.y-g;oe<=v.y+g;oe++)oe<0||oe>=t||(Ve=Math.floor(1e3*Math.abs(oe-w.y)),y[Pe][Ve]||(y[Pe][Ve]=a(Math.sqrt(Math.pow(Pe*h,2)+Math.pow(Ve*f,2))/1e3)),q=y[Pe][Ve],q>0&&($=4*(oe*n+H),we+=q,ne+=q*s[$],He+=q*s[$+1],_e+=q*s[$+2],Ee+=q*s[$+3]))}$=4*(L*i+A),c[$]=ne/we,c[$+1]=He/we,c[$+2]=_e/we,c[$+3]=Ee/we}return++A<i?x(A):l}(0)}bilinearFiltering(e,n,t,i,o){let s,l,c,a,u,d,h,f,p,g,y,w,v,x=0,A=this.rcpScaleX,L=this.rcpScaleY,H=4*(n-1),q=e.imageData.data,$=e.ctx.createImageData(i,o),we=$.data;for(h=0;h<o;h++)for(f=0;f<i;f++)for(u=Math.floor(A*f),d=Math.floor(L*h),p=A*f-u,g=L*h-d,v=4*(d*n+u),y=0;y<4;y++)s=q[v+y],l=q[v+4+y],c=q[v+H+y],a=q[v+H+4+y],w=s*(1-p)*(1-g)+l*p*(1-g)+c*g*(1-p)+a*p*g,we[x++]=w;return $}hermiteFastResize(e,n,t,i,o){let s=this.rcpScaleX,l=this.rcpScaleY,c=Math.ceil(s/2),a=Math.ceil(l/2),u=e.imageData.data,d=e.ctx.createImageData(i,o),h=d.data;for(let f=0;f<o;f++)for(let p=0;p<i;p++){let g=4*(p+f*i),y=0,w=0,v=0,x=0,A=0,L=0,H=0,q=(f+.5)*l;for(let $=Math.floor(f*l);$<(f+1)*l;$++){let we=Math.abs(q-($+.5))/a,ne=(p+.5)*s,He=we*we;for(let _e=Math.floor(p*s);_e<(p+1)*s;_e++){let Ee=Math.abs(ne-(_e+.5))/c,Pe=Math.sqrt(He+Ee*Ee);Pe>1&&Pe<-1||(y=2*Pe*Pe*Pe-3*Pe*Pe+1,y>0&&(Ee=4*(_e+$*n),H+=y*u[Ee+3],v+=y,u[Ee+3]<255&&(y=y*u[Ee+3]/250),x+=y*u[Ee],A+=y*u[Ee+1],L+=y*u[Ee+2],w+=y))}}h[g]=x/w,h[g+1]=A/w,h[g+2]=L/w,h[g+3]=H/v}return d}};D(ls,"type","Resize"),D(ls,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),D(ls,"uniformLocations",["uDelta","uTaps"]),G.setClass(ls);var cs=class extends ut{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:n}}=e,t=-this.saturation;for(let i=0;i<n.length;i+=4){let o=n[i],s=n[i+1],l=n[i+2],c=Math.max(o,s,l);n[i]+=c!==o?(c-o)*t:0,n[i+1]+=c!==s?(c-s)*t:0,n[i+2]+=c!==l?(c-l)*t:0}}sendUniformData(e,n){e.uniform1f(n.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}};D(cs,"type","Saturation"),D(cs,"defaults",{saturation:0}),D(cs,"uniformLocations",["uSaturation"]),G.setClass(cs);var us=class extends ut{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:n}}=e,t=-this.vibrance;for(let i=0;i<n.length;i+=4){let o=n[i],s=n[i+1],l=n[i+2],c=Math.max(o,s,l),a=(o+s+l)/3,u=2*Math.abs(c-a)/255*t;n[i]+=c!==o?(c-o)*u:0,n[i+1]+=c!==s?(c-s)*u:0,n[i+2]+=c!==l?(c-l)*u:0}}sendUniformData(e,n){e.uniform1f(n.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}};D(us,"type","Vibrance"),D(us,"defaults",{vibrance:0}),D(us,"uniformLocations",["uVibrance"]),G.setClass(us);var Aee=Object.freeze({__proto__:null,BaseFilter:ut,BlackWhite:iz,BlendColor:Ko,BlendImage:Zo,Blur:Jo,Brightness:Qo,Brownie:J6,ColorMatrix:mi,Composed:Vc,Contrast:es,Convolute:ts,Gamma:ns,Grayscale:rs,HueRotation:Za,Invert:is,Kodachrome:ez,Noise:os,Pixelate:ss,Polaroid:nz,RemoveColor:as,Resize:ls,Saturation:cs,Sepia:rz,Technicolor:tz,Vibrance:us,Vintage:Q6});function FI(r){return{"":"NONE",Yellow:"linden",Brown:"oak",Blue:"silverFir",LightGreen:"birch",Green:"beech",Red:"sycamore",Grey:"douglasFir",Orange:"horseChestnut",Lila:"europeanLarch",Pink:"stonePine"}[r]}var ws=(o=>(o.BASE="BASE",o.TOP="TOP",o.BOTTOM="BOTTOM",o.LEFT="LEFT",o.RIGHT="RIGHT",o))(ws||{});var kt={Baumsproessling:{speci:"Baumsproessling",color:"",position:"BASE",glCardName:"treeSaplings"},Linde:{speci:"Linde",color:"Yellow",position:"BASE",glCardName:"linden"},Eiche:{speci:"Eiche",color:"Brown",position:"BASE",glCardName:"oak"},Tanne:{speci:"Tanne",color:"Blue",position:"BASE",glCardName:"silverFir"},Birke:{speci:"Birke",color:"LightGreen",position:"BASE",glCardName:"birch"},Buche:{speci:"Buche",color:"Green",position:"BASE",glCardName:"beech"},Ahorn:{speci:"Ahorn",color:"Red",position:"BASE",glCardName:"sycamore"},Douglasie:{speci:"Douglasie",color:"Grey",position:"BASE",glCardName:"douglasFir"},Kastanie:{speci:"Kastanie",color:"Orange",position:"BASE",glCardName:"horseChestnut"},Feldhase_Left_Yellow:{speci:"Feldhase",color:"Yellow",position:"LEFT",glCardName:"europeanHare"},Dachs_Right_Grey:{speci:"Dachs",color:"Grey",position:"RIGHT",glCardName:"europeanBadger"},Feldhase_Left_Brown:{speci:"Feldhase",color:"Brown",position:"LEFT",glCardName:"europeanHare"},Hufeisennase_Right_Yellow:{speci:"Hufeisennase",color:"Yellow",position:"RIGHT",glCardName:"greaterHorseshoeBat"},Feldhase_Left_Blue:{speci:"Feldhase",color:"Blue",position:"LEFT",glCardName:"europeanHare"},Fuchs_Right_Brown:{speci:"Fuchs",color:"Brown",position:"RIGHT",glCardName:"redFox"},Waschbaer_Left_Grey:{speci:"Waschbaer",color:"Grey",position:"LEFT",glCardName:"raccoon"},Feldhase_Right_Red:{speci:"Feldhase",color:"Red",position:"RIGHT",glCardName:"europeanHare"},Wildschwein_Left_Red:{speci:"Wildschwein",color:"Red",position:"LEFT",glCardName:"wildBoar"},Feldhase_Right_Blue:{speci:"Feldhase",color:"Blue",position:"RIGHT",glCardName:"europeanHare"},"Braunes-Langohr_Left_Red":{speci:"Braunes-Langohr",color:"Red",position:"LEFT",glCardName:"brownLongEaredBat"},Feldhase_Right_Yellow:{speci:"Feldhase",color:"Yellow",position:"RIGHT",glCardName:"europeanHare"},Waschbaer_Left_Blue:{speci:"Waschbaer",color:"Blue",position:"LEFT",glCardName:"raccoon"},Reh_Right_Green:{speci:"Reh",color:"Green",position:"RIGHT",glCardName:"roeDeerBeech"},Mopsfledermaus_Left_Orange:{speci:"Mopsfledermaus",color:"Orange",position:"LEFT",glCardName:"barbastelleBat"},Wildschwein_Right_Brown:{speci:"Wildschwein",color:"Brown",position:"RIGHT",glCardName:"wildBoar"},Braunbaer_Left_Yellow:{speci:"Braunbaer",color:"Yellow",position:"LEFT",glCardName:"brownBear"},Waschbaer_Right_Blue:{speci:"Waschbaer",color:"Blue",position:"RIGHT",glCardName:"raccoon"},Steinmarder_Left_Red:{speci:"Steinmarder",color:"Red",position:"LEFT",glCardName:"beechMarten"},Braunbaer_Right_Orange:{speci:"Braunbaer",color:"Orange",position:"RIGHT",glCardName:"brownBear"},Rothirsch_Left_Yellow:{speci:"Rothirsch",color:"Yellow",position:"LEFT",glCardName:"redDeer"},Braunbaer_Right_Green:{speci:"Braunbaer",color:"Green",position:"RIGHT",glCardName:"brownBear"},Mopsfledermaus_Left_Blue:{speci:"Mopsfledermaus",color:"Blue",position:"LEFT",glCardName:"barbastelleBat"},Steinmarder_Right_Orange:{speci:"Steinmarder",color:"Orange",position:"RIGHT",glCardName:"beechMarten"},Luchs_Left_Grey:{speci:"Luchs",color:"Grey",position:"LEFT",glCardName:"lynx"},Feldhase_Right_LightGreen:{speci:"Feldhase",color:"LightGreen",position:"RIGHT",glCardName:"europeanHare"},Wildschwein_Left_LightGreen:{speci:"Wildschwein",color:"LightGreen",position:"LEFT",glCardName:"wildBoar"},Steinmarder_Right_Brown:{speci:"Steinmarder",color:"Brown",position:"RIGHT",glCardName:"beechMarten"},Dachs_Left_Orange:{speci:"Dachs",color:"Orange",position:"LEFT",glCardName:"europeanBadger"},Stechmuecke_Right_Brown:{speci:"Stechmuecke",color:"Brown",position:"RIGHT",glCardName:"gnat"},Fuchs_Left_Yellow:{speci:"Fuchs",color:"Yellow",position:"LEFT",glCardName:"redFox"},Holzbiene_Right_Grey:{speci:"Holzbiene",color:"Grey",position:"RIGHT",glCardName:"violetCarpenterBee"},Reh_Right_Orange:{speci:"Reh",color:"Orange",position:"RIGHT",glCardName:"roeDeerHorseChestnut"},Damhirsch_Left_Yellow:{speci:"Damhirsch",color:"Yellow",position:"LEFT",glCardName:"fallowDeer"},Wildschwein_Right_Grey:{speci:"Wildschwein",color:"Grey",position:"RIGHT",glCardName:"wildBoar"},Reh_Right_LightGreen:{speci:"Reh",color:"LightGreen",position:"RIGHT",glCardName:"roeDeerBirch"},Rothirsch_Left_Blue:{speci:"Rothirsch",color:"Blue",position:"LEFT",glCardName:"redDeer"},Damhirsch_Right_Red:{speci:"Damhirsch",color:"Red",position:"RIGHT",glCardName:"fallowDeer"},Holzbiene_Left_Grey:{speci:"Holzbiene",color:"Grey",position:"LEFT",glCardName:"violetCarpenterBee"},Luchs_Right_Green:{speci:"Luchs",color:"Green",position:"RIGHT",glCardName:"lynx"},Siebenschlaefer_Left_Green:{speci:"Siebenschlaefer",color:"Green",position:"LEFT",glCardName:"europeanFatDormouse"},Mopsfledermaus_Right_Brown:{speci:"Mopsfledermaus",color:"Brown",position:"RIGHT",glCardName:"barbastelleBat"},Hufeisennase_Left_Green:{speci:"Hufeisennase",color:"Green",position:"LEFT",glCardName:"greaterHorseshoeBat"},Siebenschlaefer_Right_Grey:{speci:"Siebenschlaefer",color:"Grey",position:"RIGHT",glCardName:"europeanFatDormouse"},Wolf_Right_Blue:{speci:"Wolf",color:"Blue",position:"RIGHT",glCardName:"wolf"},Siebenschlaefer_Left_Blue:{speci:"Siebenschlaefer",color:"Blue",position:"LEFT",glCardName:"europeanFatDormouse"},"Braunes-Langohr_Right_Green":{speci:"Braunes-Langohr",color:"Green",position:"RIGHT",glCardName:"brownLongEaredBat"},Bechsteinfledermaus_Left_Green:{speci:"Bechsteinfledermaus",color:"Green",position:"LEFT",glCardName:"bechsteinsBat"},Siebenschlaefer_Right_Brown:{speci:"Siebenschlaefer",color:"Brown",position:"RIGHT",glCardName:"europeanFatDormouse"},Stechmuecke_Left_LightGreen:{speci:"Stechmuecke",color:"LightGreen",position:"LEFT",glCardName:"gnat"},Wolf_Left_Grey:{speci:"Wolf",color:"Grey",position:"LEFT",glCardName:"wolf"},Stechmuecke_Right_Orange:{speci:"Stechmuecke",color:"Orange",position:"RIGHT",glCardName:"gnat"},Reh_Left_Yellow:{speci:"Reh",color:"Yellow",position:"LEFT",glCardName:"roeDeerLinden"},Frischling_Right_Red:{speci:"Frischling",color:"Red",position:"RIGHT",glCardName:"squeaker"},Bechsteinfledermaus_Left_Brown:{speci:"Bechsteinfledermaus",color:"Brown",position:"LEFT",glCardName:"bechsteinsBat"},Reh_Left_Blue:{speci:"Reh",color:"Blue",position:"LEFT",glCardName:"roeDeerSilverFir"},Luchs_Right_Yellow:{speci:"Luchs",color:"Yellow",position:"RIGHT",glCardName:"lynx"},Steinmarder_Left_Green:{speci:"Steinmarder",color:"Green",position:"LEFT",glCardName:"beechMarten"},Bechsteinfledermaus_Right_LightGreen:{speci:"Bechsteinfledermaus",color:"LightGreen",position:"RIGHT",glCardName:"bechsteinsBat"},Feldhase_Left_Green:{speci:"Feldhase",color:"Green",position:"LEFT",glCardName:"europeanHare"},Rothirsch_Right_Orange:{speci:"Rothirsch",color:"Orange",position:"RIGHT",glCardName:"redDeer"},Wolf_Left_Red:{speci:"Wolf",color:"Red",position:"LEFT",glCardName:"wolf"},Frischling_Left_Orange:{speci:"Frischling",color:"Orange",position:"LEFT",glCardName:"squeaker"},Rothirsch_Right_Brown:{speci:"Rothirsch",color:"Brown",position:"RIGHT",glCardName:"redDeer"},Fuchs_Left_Green:{speci:"Fuchs",color:"Green",position:"LEFT",glCardName:"redFox"},Frischling_Right_Brown:{speci:"Frischling",color:"Brown",position:"RIGHT",glCardName:"squeaker"},Waschbaer_Right_LightGreen:{speci:"Waschbaer",color:"LightGreen",position:"RIGHT",glCardName:"raccoon"},Frischling_Left_Brown:{speci:"Frischling",color:"Brown",position:"LEFT",glCardName:"squeaker"},Luchs_Right_Blue:{speci:"Luchs",color:"Blue",position:"RIGHT",glCardName:"lynx"},Feldhase_Left_LightGreen:{speci:"Feldhase",color:"LightGreen",position:"LEFT",glCardName:"europeanHare"},Luchs_Left_Orange:{speci:"Luchs",color:"Orange",position:"LEFT",glCardName:"lynx"},Fuchs_Right_Grey:{speci:"Fuchs",color:"Grey",position:"RIGHT",glCardName:"redFox"},Holzbiene_Left_Blue:{speci:"Holzbiene",color:"Blue",position:"LEFT",glCardName:"violetCarpenterBee"},Damhirsch_Right_LightGreen:{speci:"Damhirsch",color:"LightGreen",position:"RIGHT",glCardName:"fallowDeer"},Habicht_Grey:{speci:"Habicht",color:"Grey",position:"TOP",glCardName:"goshawk"},Moos_Yellow:{speci:"Moos",color:"Yellow",position:"BOTTOM",glCardName:"moss"},Buntspecht_Yellow:{speci:"Buntspecht",color:"Yellow",position:"TOP",glCardName:"greatSpottedWoodpecker"},Waldameise_LightGreen:{speci:"Waldameise",color:"LightGreen",position:"BOTTOM",glCardName:"woodAnt"},Buchfink_LightGreen:{speci:"Buchfink",color:"LightGreen",position:"TOP",glCardName:"chaffinch"},Waldameise_Green:{speci:"Waldameise",color:"Green",position:"BOTTOM",glCardName:"woodAnt"},Waldkauz_Green:{speci:"Waldkauz",color:"Green",position:"TOP",glCardName:"tawnyOwl"},Hirschkaefer_Red:{speci:"Hirschkaefer",color:"Red",position:"BOTTOM",glCardName:"stagBeetle"},Kaisermantel_Brown:{speci:"Kaisermantel",color:"Brown",position:"TOP",glCardName:"silverWashedFritillary"},Feuersalamander_Orange:{speci:"Feuersalamander",color:"Orange",position:"BOTTOM",glCardName:"fireSalamander"},Schillerfalter_Orange:{speci:"Schillerfalter",color:"Orange",position:"TOP",glCardName:"purpleEmperor"},Sumpfschildkroete_Red:{speci:"Sumpfschildkroete",color:"Red",position:"BOTTOM",glCardName:"pondTurtle"},Trauermantel_Red:{speci:"Trauermantel",color:"Red",position:"TOP",glCardName:"camberwellBeauty"},Sumpfschildkroete_LightGreen:{speci:"Sumpfschildkroete",color:"LightGreen",position:"BOTTOM",glCardName:"pondTurtle"},"Groser-Fuchs_Blue":{speci:"Groser-Fuchs",color:"Blue",position:"TOP",glCardName:"largeTortoiseshell"},Feuersalamander_Grey:{speci:"Feuersalamander",color:"Grey",position:"BOTTOM",glCardName:"fireSalamander"},Gimpel_Grey:{speci:"Gimpel",color:"Grey",position:"TOP",glCardName:"bullfinch"},Laubfrosch_Yellow:{speci:"Laubfrosch",color:"Yellow",position:"BOTTOM",glCardName:"treeFrog"},Buchfink_Red:{speci:"Buchfink",color:"Red",position:"TOP",glCardName:"chaffinch"},Hirschkaefer_LightGreen:{speci:"Hirschkaefer",color:"LightGreen",position:"BOTTOM",glCardName:"stagBeetle"},Habicht_Blue:{speci:"Habicht",color:"Blue",position:"TOP",glCardName:"goshawk"},Erdkroete_Brown:{speci:"Erdkroete",color:"Brown",position:"BOTTOM",glCardName:"commonToad"},Eichelhaeher_LightGreen:{speci:"Eichelhaeher",color:"LightGreen",position:"TOP",glCardName:"eurasianJay"},Baumfarn_Orange:{speci:"Baumfarn",color:"Orange",position:"BOTTOM",glCardName:"treeFerns"},Walderdbeeren_Red:{speci:"Walderdbeeren",color:"Red",position:"BOTTOM",glCardName:"wildStrawberries"},Brombeeren_Blue:{speci:"Brombeeren",color:"Blue",position:"BOTTOM",glCardName:"blackberries"},Moos_Grey:{speci:"Moos",color:"Grey",position:"BOTTOM",glCardName:"moss"},Gluehwuermchen_Yellow:{speci:"Gluehwuermchen",color:"Yellow",position:"BOTTOM",glCardName:"fireflies"},Brombeeren_LightGreen:{speci:"Brombeeren",color:"LightGreen",position:"BOTTOM",glCardName:"blackberries"},Igel_Green:{speci:"Igel",color:"Green",position:"BOTTOM",glCardName:"hedgehog"},Tagpfauenauge_Blue:{speci:"Tagpfauenauge",color:"Blue",position:"TOP",glCardName:"peacockButterfly"},Igel_Brown:{speci:"Igel",color:"Brown",position:"BOTTOM",glCardName:"hedgehog"},Eichhoernchen_Grey:{speci:"Eichhoernchen",color:"Grey",position:"TOP",glCardName:"redSquirrel"},Erdkroete_Orange:{speci:"Erdkroete",color:"Orange",position:"BOTTOM",glCardName:"commonToad"},Eichhoernchen_Orange:{speci:"Eichhoernchen",color:"Orange",position:"TOP",glCardName:"redSquirrel"},Gluehwuermchen_Red:{speci:"Gluehwuermchen",color:"Red",position:"BOTTOM",glCardName:"fireflies"},Buchfink_Green:{speci:"Buchfink",color:"Green",position:"TOP",glCardName:"chaffinch"},Erdkroete_Blue:{speci:"Erdkroete",color:"Blue",position:"BOTTOM",glCardName:"commonToad"},Gluehwuermchen_Grey:{speci:"Gluehwuermchen",color:"Grey",position:"BOTTOM",glCardName:"fireflies"},Kaisermantel_Green:{speci:"Kaisermantel",color:"Green",position:"TOP",glCardName:"silverWashedFritillary"},Tagpfauenauge_Brown:{speci:"Tagpfauenauge",color:"Brown",position:"TOP",glCardName:"peacockButterfly"},Pfifferling_Blue:{speci:"Pfifferling",color:"Blue",position:"BOTTOM",glCardName:"chanterelle"},Tagpfauenauge_Orange:{speci:"Tagpfauenauge",color:"Orange",position:"TOP",glCardName:"peacockButterfly"},Gluehwuermchen_Green:{speci:"Gluehwuermchen",color:"Green",position:"BOTTOM",glCardName:"fireflies"},"Groser-Fuchs_Red":{speci:"Groser-Fuchs",color:"Red",position:"TOP",glCardName:"largeTortoiseshell"},Maulwurf_Brown:{speci:"Maulwurf",color:"Brown",position:"BOTTOM",glCardName:"mole"},Igel_Orange:{speci:"Igel",color:"Orange",position:"BOTTOM",glCardName:"hedgehog"},Buntspecht_Grey:{speci:"Buntspecht",color:"Grey",position:"TOP",glCardName:"greatSpottedWoodpecker"},Eichelhaeher_Red:{speci:"Eichelhaeher",color:"Red",position:"TOP",glCardName:"eurasianJay"},Fliegenpilz_Blue:{speci:"Fliegenpilz",color:"Blue",position:"BOTTOM",glCardName:"flyagaric"},Waldkauz_LightGreen:{speci:"Waldkauz",color:"LightGreen",position:"TOP",glCardName:"tawnyOwl"},Steinpilz_Grey:{speci:"Steinpilz",color:"Grey",position:"BOTTOM",glCardName:"pennyBun"},Eichhoernchen_Green:{speci:"Eichhoernchen",color:"Green",position:"TOP",glCardName:"redSquirrel"},Feuersalamander_Yellow:{speci:"Feuersalamander",color:"Yellow",position:"BOTTOM",glCardName:"fireSalamander"},Schillerfalter_LightGreen:{speci:"Schillerfalter",color:"LightGreen",position:"TOP",glCardName:"purpleEmperor"},Laubfrosch_Brown:{speci:"Laubfrosch",color:"Brown",position:"BOTTOM",glCardName:"treeFrog"},Tagpfauenauge_Yellow:{speci:"Tagpfauenauge",color:"Yellow",position:"TOP",glCardName:"peacockButterfly"},Erdkroete_Green:{speci:"Erdkroete",color:"Green",position:"BOTTOM",glCardName:"commonToad"},Trauermantel_LightGreen:{speci:"Trauermantel",color:"LightGreen",position:"TOP",glCardName:"camberwellBeauty"},Parasol_Orange:{speci:"Parasol",color:"Orange",position:"BOTTOM",glCardName:"parasolMushroom"},Habicht_Brown:{speci:"Habicht",color:"Brown",position:"TOP",glCardName:"goshawk"},Erdkroete_Red:{speci:"Erdkroete",color:"Red",position:"BOTTOM",glCardName:"commonToad"},Eichelhaeher_Orange:{speci:"Eichelhaeher",color:"Orange",position:"TOP",glCardName:"eurasianJay"},Baumfarn_Blue:{speci:"Baumfarn",color:"Blue",position:"BOTTOM",glCardName:"treeFerns"},Waldkauz_Red:{speci:"Waldkauz",color:"Red",position:"TOP",glCardName:"tawnyOwl"},Erdkroete_Grey:{speci:"Erdkroete",color:"Grey",position:"BOTTOM",glCardName:"commonToad"},Gimpel_Blue:{speci:"Gimpel",color:"Blue",position:"TOP",glCardName:"bullfinch"},Baumfarn_Yellow:{speci:"Baumfarn",color:"Yellow",position:"BOTTOM",glCardName:"treeFerns"},Eichhoernchen_Brown:{speci:"Eichhoernchen",color:"Brown",position:"TOP",glCardName:"redSquirrel"},Walderdbeeren_LightGreen:{speci:"Walderdbeeren",color:"LightGreen",position:"BOTTOM",glCardName:"wildStrawberries"},Brombeeren_Green:{speci:"Brombeeren",color:"Green",position:"BOTTOM",glCardName:"blackberries"},Schillerfalter_Yellow:{speci:"Schillerfalter",color:"Yellow",position:"TOP",glCardName:"purpleEmperor"},Fliegenpilz_Brown:{speci:"Fliegenpilz",color:"Brown",position:"BOTTOM",glCardName:"flyagaric"},Trauermantel_Orange:{speci:"Trauermantel",color:"Orange",position:"TOP",glCardName:"camberwellBeauty"},Pfifferling_LightGreen:{speci:"Pfifferling",color:"LightGreen",position:"BOTTOM",glCardName:"chanterelle"},"Groser-Fuchs_Green":{speci:"Groser-Fuchs",color:"Green",position:"TOP",glCardName:"largeTortoiseshell"},Maulwurf_Red:{speci:"Maulwurf",color:"Red",position:"BOTTOM",glCardName:"mole"},Parasol_Blue:{speci:"Parasol",color:"Blue",position:"BOTTOM",glCardName:"parasolMushroom"},"Europaeische-Laerche":{speci:"Europaeische-Laerche",color:"Lila",position:"BASE",glCardName:"europeanLarch"},Zirbelkiefer:{speci:"Zirbelkiefer",color:"Pink",position:"BASE",glCardName:"stonePine"},Alpenmurmeltier_Left_Green:{speci:"Alpenmurmeltier",color:"Green",position:"LEFT",glCardName:"alpineMarmot"},Gaemse_Right_Pink:{speci:"Gaemse",color:"Pink",position:"RIGHT",glCardName:"chamoisStonePine"},Alpenmurmeltier_Left_Lila:{speci:"Alpenmurmeltier",color:"Lila",position:"LEFT",glCardName:"alpineMarmot"},Auerhuhn_Right_Grey:{speci:"Auerhuhn",color:"Grey",position:"RIGHT",glCardName:"capercaillie"},Schneehase_Left_Blue:{speci:"Schneehase",color:"Blue",position:"LEFT",glCardName:"mountainHare"},Alpenmurmeltier_Right_Pink:{speci:"Alpenmurmeltier",color:"Pink",position:"RIGHT",glCardName:"alpineMarmot"},Steinbock_Left_Lila:{speci:"Steinbock",color:"Lila",position:"LEFT",glCardName:"steinbock"},Alpenmurmeltier_Right_LightGreen:{speci:"Alpenmurmeltier",color:"LightGreen",position:"RIGHT",glCardName:"alpineMarmot"},Gaemse_Left_Lila:{speci:"Gaemse",color:"Lila",position:"LEFT",glCardName:"chamoisEuropeanLarch"},Auerhuhn_Right_Green:{speci:"Auerhuhn",color:"Green",position:"RIGHT",glCardName:"capercaillie"},Schneehase_Left_Lila:{speci:"Schneehase",color:"Lila",position:"LEFT",glCardName:"mountainHare"},Gaemse_Right_Grey:{speci:"Gaemse",color:"Grey",position:"RIGHT",glCardName:"chamoisDouglasFir"},Alpenfledermaus_Left_Blue:{speci:"Alpenfledermaus",color:"Blue",position:"LEFT",glCardName:"savisPipistrelle"},Steinbock_Right_Pink:{speci:"Steinbock",color:"Pink",position:"RIGHT",glCardName:"steinbock"},Auerhuhn_Left_Lila:{speci:"Auerhuhn",color:"Lila",position:"LEFT",glCardName:"capercaillie"},Alpenfledermaus_Right_Pink:{speci:"Alpenfledermaus",color:"Pink",position:"RIGHT",glCardName:"savisPipistrelle"},Auerhuhn_Left_Pink:{speci:"Auerhuhn",color:"Pink",position:"LEFT",glCardName:"capercaillie"},Steinbock_Right_Grey:{speci:"Steinbock",color:"Grey",position:"RIGHT",glCardName:"steinbock"},"Alpen-Apollofalter_Pink":{speci:"Alpen-Apollofalter",color:"Pink",position:"TOP",glCardName:"phoebusApollo"},Herbsttrompete_Lila:{speci:"Herbsttrompete",color:"Lila",position:"BOTTOM",glCardName:"blackTrumpet"},"Alpen-Apollofalter_Grey":{speci:"Alpen-Apollofalter",color:"Grey",position:"TOP",glCardName:"phoebusApollo"},Edelweis_Pink:{speci:"Edelweis",color:"Pink",position:"BOTTOM",glCardName:"edelweiss"},"Alpen-Apollofalter_Lila":{speci:"Alpen-Apollofalter",color:"Lila",position:"TOP",glCardName:"phoebusApollo"},Heidelbeere_LightGreen:{speci:"Heidelbeere",color:"LightGreen",position:"BOTTOM",glCardName:"blueberry"},"Alpen-Apollofalter_Blue":{speci:"Alpen-Apollofalter",color:"Blue",position:"TOP",glCardName:"phoebusApollo"},Bergmolch_Pink:{speci:"Bergmolch",color:"Pink",position:"BOTTOM",glCardName:"alpineNewt"},Steinadler_Green:{speci:"Steinadler",color:"Green",position:"TOP",glCardName:"goldenEagle"},Herbsttrompete_Pink:{speci:"Herbsttrompete",color:"Pink",position:"BOTTOM",glCardName:"blackTrumpet"},Bartgeier_Blue:{speci:"Bartgeier",color:"Blue",position:"TOP",glCardName:"beardedVulture"},Enzian_Lila:{speci:"Enzian",color:"Lila",position:"BOTTOM",glCardName:"gentian"},Steinadler_Lila:{speci:"Steinadler",color:"Lila",position:"TOP",glCardName:"goldenEagle"},Bergmolch_Grey:{speci:"Bergmolch",color:"Grey",position:"BOTTOM",glCardName:"alpineNewt"},Kolkrabe_Lila:{speci:"Kolkrabe",color:"Lila",position:"TOP",glCardName:"commonRaven"},Enzian_Green:{speci:"Enzian",color:"Green",position:"BOTTOM",glCardName:"gentian"},Kolkrabe_Grey:{speci:"Kolkrabe",color:"Grey",position:"TOP",glCardName:"commonRaven"},Heidelbeere_Pink:{speci:"Heidelbeere",color:"Pink",position:"BOTTOM",glCardName:"blueberry"},Bartgeier_Lila:{speci:"Bartgeier",color:"Lila",position:"TOP",glCardName:"beardedVulture"},Bergmolch_Blue:{speci:"Bergmolch",color:"Blue",position:"BOTTOM",glCardName:"alpineNewt"},Bartgeier_Pink:{speci:"Bartgeier",color:"Pink",position:"TOP",glCardName:"beardedVulture"},Edelweis_Lila:{speci:"Edelweis",color:"Lila",position:"BOTTOM",glCardName:"edelweiss"},Steinadler_Blue:{speci:"Steinadler",color:"Blue",position:"TOP",glCardName:"goldenEagle"},Enzian_Pink:{speci:"Enzian",color:"Pink",position:"BOTTOM",glCardName:"gentian"},Alpenfledermaus_Left_Lila:{speci:"Alpenfledermaus",color:"Lila",position:"LEFT",glCardName:"savisPipistrelle"},Schneehase_Right_Pink:{speci:"Schneehase",color:"Pink",position:"RIGHT",glCardName:"mountainHare"},Holunder_Yellow:{speci:"Holunder",color:"Yellow",position:"BASE",glCardName:"elderberry"},Holunder_Red:{speci:"Holunder",color:"Red",position:"BASE",glCardName:"elderberry"},Holunder_LightGreen:{speci:"Holunder",color:"LightGreen",position:"BASE",glCardName:"elderberry"},Holunder_Brown:{speci:"Holunder",color:"Brown",position:"BASE",glCardName:"elderberry"},Haselnuss_Orange:{speci:"Haselnuss",color:"Orange",position:"BASE",glCardName:"commonHazel"},Haselnuss_Brown:{speci:"Haselnuss",color:"Brown",position:"BASE",glCardName:"commonHazel"},Haselnuss_Green:{speci:"Haselnuss",color:"Green",position:"BASE",glCardName:"commonHazel"},Haselnuss_LightGreen:{speci:"Haselnuss",color:"LightGreen",position:"BASE",glCardName:"commonHazel"},Schlehdorn_Grey:{speci:"Schlehdorn",color:"Grey",position:"BASE",glCardName:"blackthorn"},Schlehdorn_LightGreen:{speci:"Schlehdorn",color:"LightGreen",position:"BASE",glCardName:"blackthorn"},Schlehdorn_Blue:{speci:"Schlehdorn",color:"Blue",position:"BASE",glCardName:"blackthorn"},Schlehdorn_Red:{speci:"Schlehdorn",color:"Red",position:"BASE",glCardName:"blackthorn"},Landkaertchen_Yellow:{speci:"Landkaertchen",color:"Yellow",position:"TOP",glCardName:"mapButterfly"},Fingerhut_Grey:{speci:"Fingerhut",color:"Grey",position:"BOTTOM",glCardName:"digitalis"},Landkaertchen_Red:{speci:"Landkaertchen",color:"Red",position:"TOP",glCardName:"mapButterfly"},Brennnessel_LightGreen:{speci:"Brennnessel",color:"LightGreen",position:"BOTTOM",glCardName:"stingingNettle"},Landkaertchen_Brown:{speci:"Landkaertchen",color:"Brown",position:"TOP",glCardName:"mapButterfly"},"Gruenes-Heupferd_Blue":{speci:"Gruenes-Heupferd",color:"Blue",position:"BOTTOM",glCardName:"greatGreenBushCricket"},Landkaertchen_Blue:{speci:"Landkaertchen",color:"Blue",position:"TOP",glCardName:"mapButterfly"},Schermaus_Red:{speci:"Schermaus",color:"Red",position:"BOTTOM",glCardName:"waterVole"},Elster_Green:{speci:"Elster",color:"Green",position:"TOP",glCardName:"eurasianMagpie"},Fingerhut_LightGreen:{speci:"Fingerhut",color:"LightGreen",position:"BOTTOM",glCardName:"digitalis"},Elster_Blue:{speci:"Elster",color:"Blue",position:"TOP",glCardName:"eurasianMagpie"},Brennnessel_Orange:{speci:"Brennnessel",color:"Orange",position:"BOTTOM",glCardName:"stingingNettle"},Elster_LightGreen:{speci:"Elster",color:"LightGreen",position:"TOP",glCardName:"eurasianMagpie"},"Gruenes-Heupferd_Green":{speci:"Gruenes-Heupferd",color:"Green",position:"BOTTOM",glCardName:"greatGreenBushCricket"},Nachtigall_Green:{speci:"Nachtigall",color:"Green",position:"TOP",glCardName:"nightingale"},Fingerhut_Red:{speci:"Fingerhut",color:"Red",position:"BOTTOM",glCardName:"digitalis"},Nachtigall_Brown:{speci:"Nachtigall",color:"Brown",position:"TOP",glCardName:"nightingale"},Brennnessel_Red:{speci:"Brennnessel",color:"Red",position:"BOTTOM",glCardName:"stingingNettle"},Nachtigall_Orange:{speci:"Nachtigall",color:"Orange",position:"TOP",glCardName:"nightingale"},Schermaus_Green:{speci:"Schermaus",color:"Green",position:"BOTTOM",glCardName:"waterVole"},Schleiereule_LightGreen:{speci:"Schleiereule",color:"LightGreen",position:"TOP",glCardName:"barnOwl"},Fingerhut_Brown:{speci:"Fingerhut",color:"Brown",position:"BOTTOM",glCardName:"digitalis"},Schleiereule_Red:{speci:"Schleiereule",color:"Red",position:"TOP",glCardName:"barnOwl"},"Gruenes-Heupferd_Brown":{speci:"Gruenes-Heupferd",color:"Brown",position:"BOTTOM",glCardName:"greatGreenBushCricket"},Bache_Left_LightGreen:{speci:"Bache",color:"LightGreen",position:"LEFT",glCardName:"wildBoarFemale"},Bienenschwarm_Right_Red:{speci:"Bienenschwarm",color:"Red",position:"RIGHT",glCardName:"beeSwarm"},Wisent_Left_Brown:{speci:"Wisent",color:"Brown",position:"LEFT",glCardName:"europeanBison"},Bache_Right_Red:{speci:"Bache",color:"Red",position:"RIGHT",glCardName:"wildBoarFemale"},Bache_Left_Blue:{speci:"Bache",color:"Blue",position:"LEFT",glCardName:"wildBoarFemale"},Wildkatze_Right_Orange:{speci:"Wildkatze",color:"Orange",position:"RIGHT",glCardName:"europeanWildcat"},Zwergfledermaus_Left_Yellow:{speci:"Zwergfledermaus",color:"Yellow",position:"LEFT",glCardName:"commonPipistrelle"},"Frischling-Waldrand_Right_Blue":{speci:"Frischling-Waldrand",color:"Blue",position:"RIGHT",glCardName:"squeakerWE"},"Frischling-Waldrand_Left_Orange":{speci:"Frischling-Waldrand",color:"Orange",position:"LEFT",glCardName:"squeakerWE"},Schnake_Right_Green:{speci:"Schnake",color:"Green",position:"RIGHT",glCardName:"craneFly"},Waldiltis_Left_Blue:{speci:"Waldiltis",color:"Blue",position:"LEFT",glCardName:"europeanPolecat"},"Frischling-Waldrand_Right_Grey":{speci:"Frischling-Waldrand",color:"Grey",position:"RIGHT",glCardName:"squeakerWE"},Bienenschwarm_Left_Green:{speci:"Bienenschwarm",color:"Green",position:"LEFT",glCardName:"beeSwarm"},Zwergfledermaus_Right_Red:{speci:"Zwergfledermaus",color:"Red",position:"RIGHT",glCardName:"commonPipistrelle"},Wildkatze_Left_Brown:{speci:"Wildkatze",color:"Brown",position:"LEFT",glCardName:"europeanWildcat"},Bienenschwarm_Right_LightGreen:{speci:"Bienenschwarm",color:"LightGreen",position:"RIGHT",glCardName:"beeSwarm"},Zwergfledermaus_Left_LightGreen:{speci:"Zwergfledermaus",color:"LightGreen",position:"LEFT",glCardName:"commonPipistrelle"},Wisent_Right_Green:{speci:"Wisent",color:"Green",position:"RIGHT",glCardName:"europeanBison"},Wisent_Left_Green:{speci:"Wisent",color:"Green",position:"LEFT",glCardName:"europeanBison"},Waldiltis_Right_Red:{speci:"Waldiltis",color:"Red",position:"RIGHT",glCardName:"europeanPolecat"},Schnake_Left_LightGreen:{speci:"Schnake",color:"LightGreen",position:"LEFT",glCardName:"craneFly"},Waldiltis_Right_Brown:{speci:"Waldiltis",color:"Brown",position:"RIGHT",glCardName:"europeanPolecat"},Wildkatze_Left_Red:{speci:"Wildkatze",color:"Red",position:"LEFT",glCardName:"europeanWildcat"},Schnake_Right_Brown:{speci:"Schnake",color:"Brown",position:"RIGHT",glCardName:"craneFly"}};var tp={api_key:"",image_player1:"",annotation_player1:void 0};var ll=class r{PLAYER_COUNT=5;players=[];constructor(){this.initializePlayers(this.PLAYER_COUNT),this.players[0].boardGame=tp.image_player1,this.players[1].boardGame=tp.image_player1,this.players[1].annotations=tp.annotation_player1}initializePlayers(e){this.players=[];for(let n=0;n<e;n++)this.players.push({name:"",cardsInCave:0,annotating:!1})}getPlayer(e){return this.players[e]}updatePlayerBoardGame(e,n){let t=this.players[e];t.annotations=void 0,t.boardGame=n}static \u0275fac=function(n){return new(n||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})};var ao=class r{constructor(e){this.router=e;this.router.events.pipe(Vt(n=>n instanceof qn)).subscribe(n=>{this.buttonsSubject.next([this.emptyButton])})}emptyButton={label:"Hello",action:this.noAction,visible:!1};buttonsSubject=new st([this.emptyButton]);buttons$=this.buttonsSubject.asObservable();setButtons(e){setTimeout(()=>{this.buttonsSubject.next(e)})}getButtons(){return this.buttonsSubject.getValue()}noAction(e){}static \u0275fac=function(n){return new(n||r)(J(Yn))};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})};var np=class r{constructor(e,n,t){this.playerService=e;this.headerService=n;this.location=t}player;canvas;currentPredictions=[];currentWidth=0;currentHeight=0;dragActive=!1;lastPosX=0;lastPosY=0;startZoom=1;initialDistance=0;pinchCenter={x:0,y:0};activeTouchId=null;set playerNumber(e){this.player=this.playerService.getPlayer(e)}ngOnInit(){return F(this,null,function*(){console.log(this.player?.annotations),this.headerService.setButtons([{label:"Cancel",class:"btn-secondary",action:this.cancelEdit.bind(this),visible:!0},{label:"Save",class:"btn-primary",action:this.saveEdit.bind(this),visible:!0}]),yield this.initCanvas(),this.updateCanvas()})}onResize(){this.updateCanvas()}getCanvasSize(){let e=Math.min(document.documentElement.clientWidth,window.innerWidth||0),n=Math.min(document.documentElement.clientHeight,window.innerHeight||0),t=document.getElementById("navBar")?.offsetHeight||0;return console.log("PageSize",e,n,t),n-=t,{width:e,height:n}}loadImage(e){return F(this,null,function*(){return new Promise((n,t)=>{let i=new Image;i.src=e,i.onload=()=>n(i),i.onerror=t})})}getCardColor(e){switch(kt[e].color){case"Yellow":return"rgba(255,233,0, 1)";case"Brown":return"rgba(100,40,0, 1)";case"Blue":return"rgba(0,29,255, 1)";case"LightGreen":return"rgba(47,247,11, 1)";case"Green":return"rgba(0,76,0, 1)";case"Red":return"rgba(255,0,0, 1)";case"Grey":return"rgba(194,194,172, 1)";case"Orange":return"rgba(255,142,0, 1)";case"Lila":return"rgba(94,3,140, 1)";case"Pink":return"rgba(255,0,233, 1)";default:return"rgba(255, 255, 255, 1)"}}getCardColorAlpha(e,n=.3){return this.getCardColor(e).replace(", 1)",`, ${n})`)}initCanvas(){return F(this,null,function*(){if(!this.player?.boardGame||!this.player?.annotations?.predictions)throw console.error("Init: Missing image or annotations:",this.player?.boardGame,this.player?.annotations?.predictions),new Error("Init: Missing image or annotations:");let e=yield this.loadImage(this.player.boardGame),n=new nl("annotationCanvas",{selection:!1}),t=new Zn(e,{originX:"left",originY:"top"});n.backgroundImage=t,this.currentPredictions=this.player?.annotations?.predictions,this.canvas=n,n.on("mouse:down",this.mouseDown.bind(this)),n.on("mouse:move",this.mouseMove.bind(this)),n.on("mouse:up",this.mouseUp.bind(this)),n.on("mouse:wheel",this.zoomCanvasMouseWheel.bind(this)),this.registerTouchEventHandler();for(let i of this.currentPredictions){let o=new yr({left:i.x-i.width/2,top:i.y-i.height/2,width:i.width,height:i.height,fill:this.getCardColorAlpha(i.class,.3),stroke:this.getCardColor(i.class),strokeWidth:2,cornerStyle:"circle"});this.canvas.add(o)}})}updateCanvas(){if(!this.player?.boardGame||!this.player?.annotations?.predictions||!this.canvas||!this.canvas.backgroundImage)throw console.error("Update: Missing image or annotations:",this.player?.boardGame,this.player?.annotations?.predictions,this.canvas,this.canvas?.backgroundImage),new Error("Update: Missing image or annotations:");if(!this.canvas?.getElement()){console.error("Canvas element not found");return}let{width:n,height:t}=this.getCanvasSize();this.canvas.setDimensions({width:n,height:t});let i=this.player.annotations.image,o=n/i.width,s=t/i.height,l=Math.min(o,s);this.canvas.setZoom(l),this.canvas.absolutePan(new M(0,0))}saveEdit(e){alert("Not implemented!")}cancelEdit(e){this.location.back()}getTransformVals(e){let n=window.getComputedStyle(e),t=new DOMMatrixReadOnly(n.transform);return{scaleX:t.m11,scaleY:t.m22,translateX:t.m41,translateY:t.m42,width:e.getBoundingClientRect().width,height:e.getBoundingClientRect().height}}getPinchCoordinates(e,n){return{x1:e.clientX,y1:e.clientY,x2:n.clientX,y2:n.clientY}}getPinchDistance(e,n){let t=this.getPinchCoordinates(e,n);return Math.sqrt(Math.pow(t.x2-t.x1,2)+Math.pow(t.y2-t.y1,2))}setPinchCenter(e,n){let t=this.getPinchCoordinates(e,n),i=(t.x1+t.x2)/2,o=(t.y1+t.y2)/2;if(this.canvas){let s=this.getTransformVals(this.canvas.wrapperEl);this.pinchCenter={x:i-s.translateX,y:o-s.translateY}}}registerTouchEventHandler(){this.canvas&&(this.canvas.upperCanvasEl.addEventListener("touchstart",e=>{console.log("touchstart",e),e.preventDefault(),this.pinchCanvasStart(e),this.dragCanvasStart(e)}),this.canvas.upperCanvasEl.addEventListener("touchmove",e=>{e.preventDefault(),this.pinchCanvas(e),this.dragCanvas(e)}))}dragCanvasStart(e){let n=e.e||e;if(this.canvas?._activeObject)return;this.activeTouchId===null&&e.targetTouches.length>0&&(this.activeTouchId=e.targetTouches[0].identifier);let t=Array.from(e.targetTouches).find(i=>i.identifier===this.activeTouchId);t&&(this.lastPosX=t.clientX,this.lastPosY=t.clientY,this.dragActive=!0)}dragCanvas(e){if(!this.canvas)return;let n=e.e||e;if(!this.dragActive)return;let t=Array.from(n.targetTouches).find(i=>i.identifier===this.activeTouchId);t||this.dragCanvasStart(e),t=Array.from(e.targetTouches).find(i=>i.identifier===this.activeTouchId),t&&this.redrawCanvas(t)}mouseDown(e){let n=e.e||e;!e.target&&!this.dragActive&&(this.lastPosX=n.clientX,this.lastPosY=n.clientY,this.dragActive=!0)}mouseMove(e){let n=e.e||e;this.dragActive&&n.buttons===1&&this.redrawCanvas(n)}mouseUp(e){this.dragActive=!1}redrawCanvas(e){if(this.canvas){let n=this.canvas.viewportTransform,t=n[4]+e.clientX-(this.lastPosX||0),i=n[5]+e.clientY-(this.lastPosY||0);n[4]=t,n[5]=i,this.lastPosX=e.clientX,this.lastPosY=e.clientY,this.canvas.setViewportTransform(n)}}pinchCanvasStart(e){if(this.canvas){if(e.touches.length!==2)return;this.canvas?.discardActiveObject(e),this.startZoom=this.canvas?.getZoom(),this.initialDistance=this.getPinchDistance(e.touches[0],e.touches[1])}}pinchCanvas(e){if(e.touches.length!==2)return;this.canvas?.discardActiveObject(e),this.setPinchCenter(e.touches[0],e.touches[1]);let t=this.getPinchDistance(e.touches[0],e.touches[1])/this.initialDistance;this.zoomCanvas(t*this.startZoom,this.pinchCenter)}zoomCanvasMouseWheel(e){if(this.canvas){var n=e.e.deltaY,t=this.canvas.getZoom();t*=.999**n,t>20&&(t=20),t<.1&&(t=.1),this.canvas.zoomToPoint(new M(e.e.offsetX,e.e.offsetY),t),e.e.preventDefault(),e.e.stopPropagation()}}zoomCanvas(e,n){this.canvas&&(e>20&&(e=20),e<.1&&(e=.1),this.canvas.zoomToPoint(n,e),this.canvas.renderAll())}static \u0275fac=function(n){return new(n||r)(se(ll),se(ao),se(Hi))};static \u0275cmp=Nr({type:r,selectors:[["app-annotation-editor"]],hostBindings:function(n,t){n&1&&Mt("resize",function(){return t.onResize()},!1,hE)},inputs:{playerNumber:"playerNumber"},decls:1,vars:0,consts:[["id","annotationCanvas"]],template:function(n,t){n&1&&et(0,"canvas",0)},dependencies:[di],encapsulation:2})};var qI=(()=>{class r{_renderer;_elementRef;onChange=n=>{};onTouched=()=>{};constructor(n,t){this._renderer=n,this._elementRef=t}setProperty(n,t){this._renderer.setProperty(this._elementRef.nativeElement,n,t)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}static \u0275fac=function(t){return new(t||r)(se(Vi),se(oi))};static \u0275dir=Ut({type:r})}return r})(),Zb=(()=>{class r extends qI{static \u0275fac=(()=>{let n;return function(i){return(n||(n=Li(r)))(i||r)}})();static \u0275dir=Ut({type:r,features:[ai]})}return r})(),ap=new Y(""),dz={provide:ap,useExisting:ki(()=>Jb),multi:!0},Jb=(()=>{class r extends Zb{writeValue(n){this.setProperty("checked",n)}static \u0275fac=(()=>{let n;return function(i){return(n||(n=Li(r)))(i||r)}})();static \u0275dir=Ut({type:r,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,i){t&1&&Mt("change",function(s){return i.onChange(s.target.checked)})("blur",function(){return i.onTouched()})},standalone:!1,features:[xa([dz]),ai]})}return r})(),hz={provide:ap,useExisting:ki(()=>lp),multi:!0};function fz(){let r=ci()?ci().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}var pz=new Y(""),lp=(()=>{class r extends qI{_compositionMode;_composing=!1;constructor(n,t,i){super(n,t),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!fz())}writeValue(n){let t=n??"";this.setProperty("value",t)}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}static \u0275fac=function(t){return new(t||r)(se(Vi),se(oi),se(pz,8))};static \u0275dir=Ut({type:r,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,i){t&1&&Mt("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},standalone:!1,features:[xa([hz]),ai]})}return r})();function BI(r){return r==null||(typeof r=="string"||Array.isArray(r))&&r.length===0}var YI=new Y(""),gz=new Y("");function mz(r){return e=>{if(BI(e.value)||BI(r))return null;let n=parseFloat(e.value);return!isNaN(n)&&n<r?{min:{min:r,actual:e.value}}:null}}function jI(r){return null}function XI(r){return r!=null}function KI(r){return $i(r)?Xe(r):r}function ZI(r){let e={};return r.forEach(n=>{e=n!=null?C(C({},e),n):e}),Object.keys(e).length===0?null:e}function JI(r,e){return e.map(n=>n(r))}function yz(r){return!r.validate}function QI(r){return r.map(e=>yz(e)?e:n=>e.validate(n))}function vz(r){if(!r)return null;let e=r.filter(XI);return e.length==0?null:function(n){return ZI(JI(n,e))}}function eO(r){return r!=null?vz(QI(r)):null}function bz(r){if(!r)return null;let e=r.filter(XI);return e.length==0?null:function(n){let t=JI(n,e).map(KI);return Cg(t).pipe(ue(ZI))}}function tO(r){return r!=null?bz(QI(r)):null}function VI(r,e){return r===null?[e]:Array.isArray(r)?[...r,e]:[r,e]}function wz(r){return r._rawValidators}function _z(r){return r._rawAsyncValidators}function qb(r){return r?Array.isArray(r)?r:[r]:[]}function ip(r,e){return Array.isArray(r)?r.includes(e):r===e}function $I(r,e){let n=qb(e);return qb(r).forEach(i=>{ip(n,i)||n.push(i)}),n}function UI(r,e){return qb(e).filter(n=>!ip(r,n))}var op=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=eO(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=tO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},Yb=class extends op{name;get formDirective(){return null}get path(){return null}},Yc=class extends op{_parent=null;name=null;valueAccessor=null},Xb=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},Tz={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},mte=k(C({},Tz),{"[class.ng-submitted]":"isSubmitted"}),nO=(()=>{class r extends Xb{constructor(n){super(n)}static \u0275fac=function(t){return new(t||r)(se(Yc,2))};static \u0275dir=Ut({type:r,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,i){t&2&&wy("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[ai]})}return r})();var zc="VALID",rp="INVALID",cl="PENDING",Gc="DISABLED",dl=class{},sp=class extends dl{value;source;constructor(e,n){super(),this.value=e,this.source=n}},Wc=class extends dl{pristine;source;constructor(e,n){super(),this.pristine=e,this.source=n}},qc=class extends dl{touched;source;constructor(e,n){super(),this.touched=e,this.source=n}},ul=class extends dl{status;source;constructor(e,n){super(),this.status=e,this.source=n}};function xz(r){return(cp(r)?r.validators:r)||null}function Sz(r){return Array.isArray(r)?eO(r):r||null}function Ez(r,e){return(cp(e)?e.asyncValidators:r)||null}function Dz(r){return Array.isArray(r)?tO(r):r||null}function cp(r){return r!=null&&!Array.isArray(r)&&typeof r=="object"}var Kb=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,n){this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Rr(this.statusReactive)}set status(e){Rr(()=>this.statusReactive.set(e))}_status=Eh(()=>this.statusReactive());statusReactive=ph(void 0);get valid(){return this.status===zc}get invalid(){return this.status===rp}get pending(){return this.status==cl}get disabled(){return this.status===Gc}get enabled(){return this.status!==Gc}errors;get pristine(){return Rr(this.pristineReactive)}set pristine(e){Rr(()=>this.pristineReactive.set(e))}_pristine=Eh(()=>this.pristineReactive());pristineReactive=ph(!0);get dirty(){return!this.pristine}get touched(){return Rr(this.touchedReactive)}set touched(e){Rr(()=>this.touchedReactive.set(e))}_touched=Eh(()=>this.touchedReactive());touchedReactive=ph(!1);get untouched(){return!this.touched}_events=new Dt;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators($I(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators($I(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(UI(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(UI(e,this._rawAsyncValidators))}hasValidator(e){return ip(this._rawValidators,e)}hasAsyncValidator(e){return ip(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let n=this.touched===!1;this.touched=!0;let t=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(k(C({},e),{sourceControl:t})),n&&e.emitEvent!==!1&&this._events.next(new qc(!0,t))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(n=>n.markAllAsTouched(e))}markAsUntouched(e={}){let n=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let t=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:t})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t),n&&e.emitEvent!==!1&&this._events.next(new qc(!1,t))}markAsDirty(e={}){let n=this.pristine===!0;this.pristine=!1;let t=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(k(C({},e),{sourceControl:t})),n&&e.emitEvent!==!1&&this._events.next(new Wc(!1,t))}markAsPristine(e={}){let n=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let t=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),n&&e.emitEvent!==!1&&this._events.next(new Wc(!0,t))}markAsPending(e={}){this.status=cl;let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ul(this.status,n)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(k(C({},e),{sourceControl:n}))}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Gc,this.errors=null,this._forEachChild(i=>{i.disable(k(C({},e),{onlySelf:!0}))}),this._updateValue();let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new sp(this.value,t)),this._events.next(new ul(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(k(C({},e),{skipPristineCheck:n}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=zc,this._forEachChild(t=>{t.enable(k(C({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(k(C({},e),{skipPristineCheck:n}),this),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(e,n){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},n),this._parent._updateTouched({},n))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let t=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===zc||this.status===cl)&&this._runAsyncValidator(t,e.emitEvent)}let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new sp(this.value,n)),this._events.next(new ul(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(k(C({},e),{sourceControl:n}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Gc:zc}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,n){if(this.asyncValidator){this.status=cl,this._hasOwnPendingAsyncValidator={emitEvent:n!==!1};let t=KI(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:n,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1,this,n.shouldHaveEmitted)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((t,i)=>t&&t._find(i),this)}getError(e,n){let t=n?this.get(n):this;return t&&t.errors?t.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,n,t){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||t)&&this._events.next(new ul(this.status,n)),this._parent&&this._parent._updateControlsErrors(e,n,t)}_initObservables(){this.valueChanges=new $t,this.statusChanges=new $t}_calculateStatus(){return this._allControlsDisabled()?Gc:this.errors?rp:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(cl)?cl:this._anyControlsHaveStatus(rp)?rp:zc}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,n){let t=!this._anyControlsDirty(),i=this.pristine!==t;this.pristine=t,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,n),i&&this._events.next(new Wc(this.pristine,n))}_updateTouched(e={},n){this.touched=this._anyControlsTouched(),this._events.next(new qc(this.touched,n)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,n)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){cp(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=Sz(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=Dz(this._rawAsyncValidators)}};var rO=new Y("",{providedIn:"root",factory:()=>Qb}),Qb="always";function Cz(r,e){return[...e.path,r]}function Iz(r,e,n=Qb){Az(r,e),e.valueAccessor.writeValue(r.value),(r.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(r.disabled),Pz(r,e),Nz(r,e),Mz(r,e),Oz(r,e)}function HI(r,e){r.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function Oz(r,e){if(e.valueAccessor.setDisabledState){let n=t=>{e.valueAccessor.setDisabledState(t)};r.registerOnDisabledChange(n),e._registerOnDestroy(()=>{r._unregisterOnDisabledChange(n)})}}function Az(r,e){let n=wz(r);e.validator!==null?r.setValidators(VI(n,e.validator)):typeof n=="function"&&r.setValidators([n]);let t=_z(r);e.asyncValidator!==null?r.setAsyncValidators(VI(t,e.asyncValidator)):typeof t=="function"&&r.setAsyncValidators([t]);let i=()=>r.updateValueAndValidity();HI(e._rawValidators,i),HI(e._rawAsyncValidators,i)}function Pz(r,e){e.valueAccessor.registerOnChange(n=>{r._pendingValue=n,r._pendingChange=!0,r._pendingDirty=!0,r.updateOn==="change"&&iO(r,e)})}function Mz(r,e){e.valueAccessor.registerOnTouched(()=>{r._pendingTouched=!0,r.updateOn==="blur"&&r._pendingChange&&iO(r,e),r.updateOn!=="submit"&&r.markAsTouched()})}function iO(r,e){r._pendingDirty&&r.markAsDirty(),r.setValue(r._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1}function Nz(r,e){let n=(t,i)=>{e.valueAccessor.writeValue(t),i&&e.viewToModelUpdate(t)};r.registerOnChange(n),e._registerOnDestroy(()=>{r._unregisterOnChange(n)})}function Rz(r,e){if(!r.hasOwnProperty("model"))return!1;let n=r.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function kz(r){return Object.getPrototypeOf(r.constructor)===Zb}function Fz(r,e){if(!e)return null;Array.isArray(e);let n,t,i;return e.forEach(o=>{o.constructor===lp?n=o:kz(o)?t=o:i=o}),i||t||n||null}function zI(r,e){let n=r.indexOf(e);n>-1&&r.splice(n,1)}function GI(r){return typeof r=="object"&&r!==null&&Object.keys(r).length===2&&"value"in r&&"disabled"in r}var Lz=class extends Kb{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,n,t){super(xz(n),Ez(t,n)),this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),cp(n)&&(n.nonNullable||n.initialValueIsDefault)&&(GI(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(t=>t(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){zI(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){zI(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){GI(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Bz={provide:Yc,useExisting:ki(()=>e0)},WI=Promise.resolve(),e0=(()=>{class r extends Yc{_changeDetectorRef;callSetDisabledState;control=new Lz;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new $t;constructor(n,t,i,o,s,l){super(),this._changeDetectorRef=s,this.callSetDisabledState=l,this._parent=n,this._setValidators(t),this._setAsyncValidators(i),this.valueAccessor=Fz(this,o)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){let t=n.name.previousValue;this.formDirective.removeControl({name:t,path:this._getPath(t)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),Rz(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Iz(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(n){WI.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){let t=n.isDisabled.currentValue,i=t!==0&&Vo(t);WI.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?Cz(n,this._parent):[n]}static \u0275fac=function(t){return new(t||r)(se(Yb,9),se(YI,10),se(gz,10),se(ap,10),se(Ui,8),se(rO,8))};static \u0275dir=Ut({type:r,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[xa([Bz]),ai,Fo]})}return r})();var jz={provide:ap,useExisting:ki(()=>t0),multi:!0},t0=(()=>{class r extends Zb{writeValue(n){let t=n??"";this.setProperty("value",t)}registerOnChange(n){this.onChange=t=>{n(t==""?null:parseFloat(t))}}static \u0275fac=(()=>{let n;return function(i){return(n||(n=Li(r)))(i||r)}})();static \u0275dir=Ut({type:r,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,i){t&1&&Mt("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},standalone:!1,features:[xa([jz]),ai]})}return r})();function Vz(r){return typeof r=="number"?r:parseFloat(r)}var $z=(()=>{class r{_validator=jI;_onChange;_enabled;ngOnChanges(n){if(this.inputName in n){let t=this.normalizeInput(n[this.inputName].currentValue);this._enabled=this.enabled(t),this._validator=this._enabled?this.createValidator(t):jI,this._onChange&&this._onChange()}}validate(n){return this._validator(n)}registerOnValidatorChange(n){this._onChange=n}enabled(n){return n!=null}static \u0275fac=function(t){return new(t||r)};static \u0275dir=Ut({type:r,features:[Fo]})}return r})();var Uz={provide:YI,useExisting:ki(()=>n0),multi:!0},n0=(()=>{class r extends $z{min;inputName="min";normalizeInput=n=>Vz(n);createValidator=n=>mz(n);static \u0275fac=(()=>{let n;return function(i){return(n||(n=Li(r)))(i||r)}})();static \u0275dir=Ut({type:r,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(t,i){t&2&&Kl("min",i._enabled?i.min:null)},inputs:{min:"min"},standalone:!1,features:[xa([Uz]),ai]})}return r})();var Hz=(()=>{class r{static \u0275fac=function(t){return new(t||r)};static \u0275mod=si({type:r});static \u0275inj=ni({})}return r})();var up=(()=>{class r{static withConfig(n){return{ngModule:r,providers:[{provide:rO,useValue:n.callSetDisabledState??Qb}]}}static \u0275fac=function(t){return new(t||r)};static \u0275mod=si({type:r});static \u0275inj=ni({imports:[Hz]})}return r})();var oO={BASE:0,LEFT:1,RIGHT:2,TOP:3,BOTTOM:4},dp=class r{static compareCards(e,n){if(e.position!==n.position)return oO[e.position]-oO[n.position];switch(e.position){case"BASE":return Math.abs(e.y-n.y)<e.height/2?e.x-n.x:e.y-n.y;case"LEFT":return n.x-e.x;case"RIGHT":return e.x-n.x;case"TOP":return n.y-e.y;case"BOTTOM":return e.y-n.y;default:return 0}}static findNearestCard(e,n){let t=null,i=1/0;for(let o of n){if(o===e||!["BASE",e.position].includes(o.position))continue;switch(e.position){case"LEFT":if(o.x<=e.x)continue;break;case"RIGHT":if(o.x>=e.x)continue;break;case"TOP":if(o.y<=e.y)continue;break;case"BOTTOM":if(o.y>=e.y)continue;break}let s=Math.pow(e.x-o.x,2)+Math.pow(e.y-o.y,2);s<i&&(i=s,t=o)}return t}static assembleForest(e){let n=[],t=[];for(let o of e.predictions){let s=kt[o.class];t.push(C(C({},o),s))}t.sort(r.compareCards);let i=0;for(let o of t)if(o.position=="BASE")o.baseIndex=i,i++;else{let s=r.findNearestCard(o,t);if(s===null)throw new Error(`No nearest card found for card at position (${o?.x}, ${o?.y})`);if(s.baseIndex===void 0||s.baseIndex===null)throw new Error(`Base index not defined for nearest card at position (${s?.x}, ${s?.y})`);o.baseIndex=s.baseIndex}for(let o of t){let s={id:o.class,color:o.color,baseIndex:o.baseIndex};n.push(s)}return n}};var Gz={name:"beech",type:"beech",symbols:["tree","beech"],recalculatePoints(r){let e=this.count,t=r.cards.find(i=>i.name==="violetCarpenterBee").params[0].value;e+t>=4?this.points=e*5:this.points=0}},Wz={name:"birch",type:"birch",symbols:["tree","birch"],recalculatePoints(r){this.points=this.count}},qz={name:"douglasFir",type:"douglasFir",symbols:["tree","douglasFir"],recalculatePoints(r){this.points=this.count*5}},Yz={name:"horseChestnut",type:"horseChestnut",symbols:["tree","horseChestnut"],recalculatePoints(r){let e=r.cards.find(t=>t.name==="violetCarpenterBee"),n=this.count+e.params[1].value;this.points=Math.min(n*n,49)}},Xz={name:"linden",type:"linden",symbols:["tree","linden"],params:[{name:"hasMostLindens",type:"boolean",distributed:!0,value:!1}],recalculatePoints(r){let e=r.distributedScoring?this.params[0].value:r.hasMostOfName("linden");this.points=this.count*(e?3:1)}},Kz={name:"oak",type:"oak",symbols:["tree","oak"],recalculatePoints(r){r.cards.filter(n=>n.symbols.indexOf("tree")>=0&&n.name!=="treeSaplings"&&n.count>0).length>=8?this.points=this.count*10:this.points=0}},Zz={name:"silverFir",type:"silverFir",symbols:["tree","silverFir"],params:[{name:"cardsAttachedToSilverFirs",type:"number",value:0,unrestricted:!0}],recalculatePoints(r){this.points=this.params[0].value*2}},Jz={name:"sycamore",type:"sycamore",symbols:["tree","sycamore"],recalculatePoints(r){this.points=r.countByName("sycamore")*r.countBySymbol("tree")}},Qz={name:"treeSaplings",type:"none",symbols:["tree"],recalculatePoints(r){}},eG={name:"europeanLarch",type:"alpineLarch",symbols:["tree","europeanLarch","alps"],recalculatePoints(r){this.points=this.count*3}},tG={name:"stonePine",type:"stonePine",symbols:["tree","stonePine","alps"],recalculatePoints(r){this.points=this.count*r.countBySymbol("alps")}},nG={name:"downyBirch",symbols:["tree"],hide:r=>!r.hobbyPromo,recalculatePoints(r){this.points=this.count}},sO=[Gz,Wz,qz,Yz,Xz,Kz,Zz,Jz,eG,tG,Qz,nG];var rG={name:"bullfinch",position:"top",symbols:["bird"],recalculatePoints(r){this.points=this.count*r.countBySymbol("insect")*2}},iG={name:"chaffinch",position:"top",symbols:["bird"],params:[{name:"chaffinchesAtopABeech",type:"number",value:0}],recalculatePoints(r){this.points=this.params[0].value*5}},oG={name:"eurasianJay",position:"top",symbols:["bird"],recalculatePoints(r){this.points=this.count*3}},sG={name:"goshawk",position:"top",symbols:["bird"],recalculatePoints(r){this.points=this.count*r.countBySymbol("bird")*3}},aG={name:"greatSpottedWoodpecker",position:"top",symbols:["bird"],params:[{name:"hasMostTrees",type:"boolean",distributed:!0,value:!1}],recalculatePoints(r){let e=r.distributedScoring?this.params[0].value:r.hasMostTrees();this.points=e?this.count*10:0}},lG={name:"tawnyOwl",position:"top",symbols:["bird"],recalculatePoints(r){this.points=this.count*5}},cG={name:"capercaillie",position:"side",symbols:["bird","alps"],recalculatePoints(r){this.points=this.count*r.countBySymbol("plant")}},uG={name:"goldenEagle",position:"top",symbols:["bird","alps"],recalculatePoints(r){this.points=this.count*(r.countBySymbol("pawedAnimal")+r.countBySymbol("amphibian"))}},dG={name:"beardedVulture",position:"top",symbols:["bird","alps"],recalculatePoints(r){this.points=this.count*r.caveCount}},hG={name:"commonRaven",position:"top",symbols:["bird","alps"],recalculatePoints(r){this.points=this.count*5}},fG={name:"eurasianMagpie",position:"top",symbols:["bird","woodlandEdge"],recalculatePoints(r){this.points=this.count*3}},pG={name:"nightingale",position:"top",symbols:["bird","woodlandEdge"],params:[{name:"nightingalesAtopAShrub",type:"number",value:0}],recalculatePoints(r){this.points=this.params[0].value*5}},gG={name:"barnOwl",position:"top",symbols:["bird","woodlandEdge"],recalculatePoints(r){this.points=3*this.count*r.countBySymbol("bat")}},mG={name:"whinchat",symbols:["bird"],hide:r=>!r.hobbyPromo,recalculatePoints(r){this.points=this.count*r.countBySymbol("plant")}},aO=[rG,iG,oG,sG,aG,lG,cG,uG,dG,hG,fG,pG,gG,mG];var yG=[0,0,3,6,12,20,35,55];function lO(r){let e=r.cards.filter(t=>t.symbols.indexOf("butterfly")>=0&&t.count>0).map(t=>t.count),n=0;for(;e.length>0;)n+=yG[e.length],e=e.map(t=>t-1).filter(t=>t>0);return n}var vG={name:"camberwellBeauty",position:"top",symbols:["butterfly","insect"],recalculatePoints(r){}},bG={name:"peacockButterfly",position:"top",symbols:["butterfly","insect"],recalculatePoints(r){}},wG={name:"silverWashedFritillary",position:"top",symbols:["butterfly","insect"],recalculatePoints(r){}},_G={name:"purpleEmperor",position:"top",symbols:["butterfly","insect"],recalculatePoints(r){}},TG={name:"largeTortoiseshell",position:"top",symbols:["butterfly","insect"],recalculatePoints(r){}},xG={name:"phoebusApollo",position:"top",symbols:["butterfly","insect","alps"],recalculatePoints(r){}},SG={name:"mapButterfly",position:"top",symbols:["butterfly","insect","woodlandEdge"],recalculatePoints(r){}},cO=[vG,bG,wG,_G,TG,xG,SG];var EG={name:"redSquirrel",position:"top",symbols:["pawedAnimal"],params:[{name:"redSquirrelsAtopAnOak",type:"number",value:0}],recalculatePoints(r){this.points=this.params[0].value*5}},uO=[EG];var DG={name:"blackberries",position:"bottom",symbols:["plant"],recalculatePoints(r){this.points=this.count*r.countBySymbol("plant")*2}},CG={name:"moss",position:"bottom",symbols:["plant"],recalculatePoints(r){r.countTreesIncludingVioletCarpenterBee()>=10?this.points=this.count*10:this.points=0}},IG={name:"treeFerns",position:"bottom",symbols:["plant"],recalculatePoints(r){this.points=this.count*r.countBySymbol("amphibian")*6}},OG={name:"wildStrawberries",position:"bottom",symbols:["plant"],recalculatePoints(r){r.cards.filter(n=>n.symbols.indexOf("tree")>=0&&n.name!=="treeSaplings"&&n.count>0).length>=8?this.points=this.count*10:this.points=0}},AG={name:"edelweiss",position:"bottom",symbols:["plant","alps"],recalculatePoints(r){this.points=this.count*3}},PG={name:"blueberry",position:"bottom",symbols:["plant","alps"],recalculatePoints(r){this.points=this.count*2*r.countDistinctBySymbol("bird")}},MG={name:"gentian",position:"bottom",symbols:["plant","alps"],recalculatePoints(r){this.points=this.count*3*r.countBySymbol("butterfly")}},NG={name:"digitalis",position:"bottom",symbols:["plant","woodlandEdge"],recalculatePoints(r){let e=[0,1,3,6,10,15];this.points=this.count*e[Math.min(5,r.countDistinctBySymbol("plant"))]}},RG={name:"stingingNettle",position:"bottom",symbols:["plant","woodlandEdge"],recalculatePoints(r){this.points=2*this.count*r.countBySymbol("butterfly")}},kG={name:"maretak",position:"top",symbols:["plant","woodlandEdge"],hide:r=>!r.maretakPromo,recalculatePoints(r){this.points=this.count*r.countBySymbol("plant")}},FG={name:"bostulp",position:"bottom",symbols:["plant","woodlandEdge"],hide:r=>!r.maretakPromo,recalculatePoints(r){this.points=3*this.count}},dO=[DG,IG,OG,CG,AG,PG,MG,NG,RG,kG,FG];var LG={name:"chanterelle",position:"bottom",symbols:["mushroom"],recalculatePoints(r){}},BG={name:"flyagaric",position:"bottom",symbols:["mushroom"],recalculatePoints(r){}},jG={name:"parasolMushroom",position:"bottom",symbols:["mushroom"],recalculatePoints(r){}},VG={name:"pennyBun",position:"bottom",symbols:["mushroom"],recalculatePoints(r){}},$G={name:"blackTrumpet",position:"bottom",symbols:["mushroom","alps"],recalculatePoints(r){}},hO=[LG,BG,jG,VG,$G];var UG={name:"commonToad",position:"bottom",symbols:["amphibian"],params:[{name:"sharingACardSlot",type:"number",value:0}],recalculatePoints(r){this.points=this.params[0].value*5}},HG={name:"pondTurtle",position:"bottom",symbols:["amphibian"],recalculatePoints(r){this.points=this.count*5}},zG={name:"treeFrog",position:"bottom",symbols:["amphibian"],recalculatePoints(r){this.points=this.count*r.countByName("gnat")*5}},GG={name:"fireSalamander",position:"bottom",symbols:["amphibian"],recalculatePoints(r){this.points=[0,5,15,25][Math.min(3,this.count)]}},WG={name:"alpineNewt",position:"bottom",symbols:["amphibian","alps"],recalculatePoints(r){this.points=this.count*2*r.countBySymbol("insect")}},fO=[UG,HG,zG,GG,WG];var qG={name:"gnat",position:"side",symbols:["insect"],recalculatePoints(r){this.points=r.countByName("gnat")*r.countBySymbol("bat")}},YG={name:"fireflies",position:"bottom",symbols:["insect"],recalculatePoints(r){this.points=[0,0,10,15,20][Math.min(4,this.count)]}},XG={name:"woodAnt",position:"bottom",symbols:["insect"],recalculatePoints(r){this.points=this.count*r.countByPosition("bottom")*2}},KG={name:"stagBeetle",position:"bottom",symbols:["insect"],recalculatePoints(r){this.points=this.count*r.countBySymbol("pawedAnimal")}},ZG={name:"violetCarpenterBee",position:"side",symbols:["insect"],params:[{name:"onABeech",type:"number",value:0},{name:"onAHorseChestnut",type:"number",value:0},{name:"onALinden",type:"number",value:0}],recalculatePoints(r){}},JG={name:"greatGreenBushCricket",position:"bottom",symbols:["insect","woodlandEdge"],recalculatePoints(r){this.points=this.count*r.countBySymbol("insect")}},QG={name:"beeSwarm",position:"side",symbols:["insect","woodlandEdge"],recalculatePoints(r){this.points=this.count*r.countBySymbol("plant")}},e5={name:"craneFly",position:"side",symbols:["insect","woodlandEdge"],recalculatePoints(r){this.points=this.count*r.countBySymbol("bat")}},pO=[qG,YG,XG,KG,ZG,JG,QG,e5];var t5={name:"hedgehog",position:"bottom",symbols:["pawedAnimal"],recalculatePoints(r){this.points=this.count*r.countBySymbol("butterfly")*2}},n5={name:"mole",position:"bottom",symbols:["pawedAnimal"],recalculatePoints(r){}},r5={name:"beechMarten",position:"side",symbols:["pawedAnimal"],params:[{name:"fullyOccupiedTrees",type:"number",value:0,unrestricted:!0}],recalculatePoints(r){this.points=this.count*5*this.params[0].value}},i5={name:"brownBear",position:"side",symbols:["pawedAnimal"],recalculatePoints(r){}},o5={name:"europeanBadger",position:"side",symbols:["pawedAnimal"],recalculatePoints(r){this.points=this.count*2}},s5={name:"europeanFatDormouse",position:"side",symbols:["pawedAnimal"],params:[{name:"batOnTheOtherSide",type:"number",value:0}],recalculatePoints(r){this.points=this.params[0].value*15}},r0=r=>r.countByName("europeanHare")+r.countByName("mountainHare"),a5={name:"europeanHare",position:"side",symbols:["pawedAnimal"],recalculatePoints(r){this.points=this.count*r0(r)}},l5={name:"lynx",position:"side",symbols:["pawedAnimal"],recalculatePoints(r){r.countByName("roeDeerBeech")+r.countByName("roeDeerBirch")+r.countByName("roeDeerHorseChestnut")+r.countByName("roeDeerLinden")+r.countByName("roeDeerSilverFir")>0?this.points=this.count*10:this.points=0}},c5={name:"raccoon",position:"side",symbols:["pawedAnimal"],recalculatePoints(r){}},u5={name:"redFox",position:"side",symbols:["pawedAnimal"],recalculatePoints(r){this.points=this.count*r0(r)*2}},d5={name:"wolf",position:"side",symbols:["pawedAnimal"],recalculatePoints(r){this.points=this.count*5*r.countBySymbol("deer")}},h5={name:"alpineMarmot",position:"side",symbols:["pawedAnimal","alps"],recalculatePoints(r){this.points=this.count*3*r.countDistinctBySymbol("plant")}},f5={name:"mountainHare",position:"side",symbols:["pawedAnimal","alps"],recalculatePoints(r){this.points=this.count*r0(r)}},p5={name:"waterVole",position:"bottom",symbols:["pawedAnimal","woodlandEdge"],recalculatePoints(r){}},g5={name:"europeanWildcat",position:"side",symbols:["pawedAnimal","woodlandEdge"],recalculatePoints(r){this.points=this.count*r.countBySymbol("woodlandEdge")}},m5={name:"europeanPolecat",position:"side",symbols:["pawedAnimal","woodlandEdge"],params:[{name:"europeanPolecatAloneOnTreeOrShrub",type:"number",value:0}],recalculatePoints(){this.points=10*this.params[0].value}},y5={name:"meeps",position:"side",symbols:["pawedAnimal","woodlandEdge"],hide:r=>!r.spiel24Promo,recalculatePoints(r){this.points=this.count*r.countBySymbol("woodlandEdge")}},gO=[t5,n5,r5,i5,o5,s5,a5,l5,c5,u5,d5,h5,f5,p5,g5,m5,y5];var _s=(r,e)=>r.countDistinctBySymbol("bat")>=3?r.countByName(e)*5:0,v5={name:"barbastelleBat",position:"side",symbols:["bat"],recalculatePoints(r){this.points=_s(r,this.name)}},b5={name:"bechsteinsBat",position:"side",symbols:["bat"],recalculatePoints(r){this.points=_s(r,this.name)}},w5={name:"brownLongEaredBat",position:"side",symbols:["bat"],recalculatePoints(r){this.points=_s(r,this.name)}},_5={name:"greaterHorseshoeBat",position:"side",symbols:["bat"],recalculatePoints(r){this.points=_s(r,this.name)}},T5={name:"savisPipistrelle",position:"side",symbols:["bat","alps"],recalculatePoints(r){this.points=_s(r,this.name)}},x5={name:"duererBat",position:"side",symbols:["bat"],hide:r=>!r.duererExpansion,recalculatePoints(r){this.points=_s(r,this.name)}},S5={name:"commonPipistrelle",position:"side",symbols:["bat","woodlandEdge"],recalculatePoints(r){this.points=_s(r,this.name)}},mO=[v5,b5,w5,_5,T5,x5,S5];var E5={name:"fallowDeer",position:"side",symbols:["deer","clovenHoofedAnimal"],recalculatePoints(r){this.points=r.countByName("fallowDeer")*3*r.countBySymbol("clovenHoofedAnimal")}},D5={name:"redDeer",position:"side",symbols:["deer","clovenHoofedAnimal"],recalculatePoints(r){this.points=r.countByName("redDeer")*(r.countBySymbol("plant")+r.countBySymbol("tree"))}},C5={name:"roeDeerBeech",type:"beech",position:"side",symbols:["deer","clovenHoofedAnimal"],params:[{name:"beechCount",type:"type",symbol:"beech",value:0,unrestricted:!0}],recalculatePoints(r){this.points=this.count*r.beechCount*3}},I5={name:"roeDeerBirch",type:"birch",position:"side",symbols:["deer","clovenHoofedAnimal"],params:[{name:"birchCount",type:"type",symbol:"birch",value:0,unrestricted:!0}],recalculatePoints(r){this.points=this.count*r.birchCount*3}},O5={name:"roeDeerHorseChestnut",type:"horseChestnut",position:"side",symbols:["deer","clovenHoofedAnimal"],params:[{name:"horseChestnutCount",type:"type",symbol:"horseChestnut",value:0,unrestricted:!0}],recalculatePoints(r){this.points=this.count*r.horseChestnutCount*3}},A5={name:"roeDeerLinden",type:"linden",position:"side",symbols:["deer","clovenHoofedAnimal"],params:[{name:"lindenCount",type:"type",symbol:"linden",value:0,unrestricted:!0}],recalculatePoints(r){this.points=this.count*r.lindenCount*3}},P5={name:"roeDeerSilverFir",type:"silverFir",position:"side",symbols:["deer","clovenHoofedAnimal"],params:[{name:"silverFirCount",type:"type",symbol:"silverFir",value:0,unrestricted:!0}],recalculatePoints(r){this.points=this.count*r.silverFirCount*3}},M5={name:"squeaker",position:"side",symbols:["clovenHoofedAnimal"],recalculatePoints(r){this.points=this.count}},N5={name:"squeakerWE",position:"side",symbols:["clovenHoofedAnimal","woodlandEdge"],recalculatePoints(r){this.points=this.count}},R5={name:"wildBoar",position:"side",symbols:["clovenHoofedAnimal"],recalculatePoints(r){let e=r.countByName("squeaker")+r.countByName("squeakerWE")>0;this.points=this.count*10*(e?1:0)}},k5={name:"wildBoarFemale",position:"side",symbols:["clovenHoofedAnimal","woodlandEdge"],recalculatePoints(r){this.points=this.count*10*(r.countByName("squeaker")+r.countByName("squeakerWE"))}},F5={name:"chamoisStonePine",position:"side",symbols:["clovenHoofedAnimal","alps","stonePine"],params:[{name:"stonePineCount",type:"type",symbol:"stonePine",value:0,unrestricted:!0}],recalculatePoints(r){this.points=this.count*r.stonePineCount*3}},L5={name:"chamoisEuropeanLarch",position:"side",symbols:["clovenHoofedAnimal","alps","europeanLarch"],params:[{name:"europeanLarchCount",type:"type",symbol:"europeanLarch",value:0,unrestricted:!0}],recalculatePoints(r){this.points=this.count*r.europeanLarchCount*3}},B5={name:"chamoisDouglasFir",position:"side",symbols:["clovenHoofedAnimal","alps","douglasFir"],params:[{name:"douglasFirCount",type:"type",symbol:"douglasFir",value:0,unrestricted:!0}],recalculatePoints(r){this.points=this.count*r.douglasFirCount*3}},j5={name:"steinbock",position:"side",symbols:["clovenHoofedAnimal","alps"],recalculatePoints(r){this.points=this.count*10}},V5={name:"europeanBison",position:"side",symbols:["clovenHoofedAnimal","woodlandEdge"],params:[{name:"beechCount",type:"type",symbol:"beech",value:0,unrestricted:!0},{name:"oakCount",type:"type",symbol:"oak",value:0,unrestricted:!0}],recalculatePoints(r){this.points=2*this.count*(r.beechCount+r.oakCount)}},yO=[E5,D5,C5,A5,P5,O5,I5,M5,N5,R5,k5,B5,L5,F5,j5,V5];var $5={name:"elderberry",position:"tree",symbols:["shrub","woodlandEdge"],recalculatePoints(r){}},U5={name:"commonHazel",position:"tree",symbols:["shrub","woodlandEdge"],recalculatePoints(r){}},H5={name:"blackthorn",position:"tree",symbols:["shrub","woodlandEdge"],recalculatePoints(r){}},vO=[$5,U5,H5];var z5=[...sO,...aO,...cO,...uO,...dO,...hO,...fO,...pO,...gO,...mO,...yO,...vO],bO=z5;var hp=class{distributedScoring=!1;constructor(e,n){this.playerName=e,this.allForests=n,this.reset()}reset(){this.butterflyPoints=0,this.silverFirCount=0,this.lindenCount=0,this.horseChestnutCount=0,this.birchCount=0,this.beechCount=0,this.sycamoreCount=0,this.douglasFirCount=0,this.oakCount=0,this.europeanLarchCount=0,this.stonePineCount=0,this.caveCount=0,this.points=0,this.cards=[];for(let e of bO){let n=C({},e);e.params&&(n.params=e.params.map(t=>C({},t))),this.cards.push(k(C({},n),{count:0,points:0}))}}getSymbolCount(e){return this[e+"Count"]}setSymbolCount(e,n){this[e+"Count"]=n,this.updatePoints()}findCard(e){return this.cards[this.cards.findIndex(n=>n.name===e)]}addCard(e){++this.findCard(e).count}removeCard(e){let n=this.findCard(e);n.count=Math.max(0,--n.count),n.count===0&&n.params&&n.params.forEach(t=>t.value=0)}addParam(e,n){let t=this.findCard(e),i=t.params.find(o=>o.name===n);i.value=Math.min(i.unrestricted?99:t.count,i.value+1)}subParam(e,n){let i=this.findCard(e).params.find(o=>o.name===n);i.value=Math.max(0,i.value-1)}toggleParam(e,n){let i=this.findCard(e).params.find(o=>o.name===n);i.value=!i.value}updatePoints(){let e=0;for(let n of this.cards)n.recalculatePoints(this),e+=n.points;this.butterflyPoints=lO(this),this.points=e+this.butterflyPoints+this.caveCount}countByName(e){let n=this.cards.find(t=>t.name===e).count;return e==="linden"&&(n+=this.cards.find(t=>t.name==="violetCarpenterBee").params[2].value),n}countBySymbol(e){return this.cards.filter(n=>n.symbols.filter(t=>t===e).length>0).reduce((n,t)=>n+=t.count,0)}countTreesIncludingVioletCarpenterBee(){let e=this.countBySymbol("tree"),n=this.cards.find(t=>t.name==="violetCarpenterBee");for(let t of n.params)e+=t.value;return e}countByPosition(e){return this.cards.filter(n=>n.position===e).reduce((n,t)=>n+=t.count,0)}countDistinctBySymbol(e){return this.cards.filter(n=>n.symbols.filter(t=>t===e).length>0).filter(n=>n.count>0).length}hasMostOfName(e){let n=this.countByName(e),t=!0,i=this.allForests.filter(o=>o.playerName!==this.playerName);for(let o of i)o.countByName(e)>n&&(t=!1);return t}hasMostOfSymbol(e){let n=this.countBySymbol(e),t=!0,i=this.allForests.filter(o=>o.playerName!==this.playerName);for(let o of i)o.countBySymbol(e)>n&&(t=!1);return t}hasMostTrees(){let e=this.countTreesIncludingVioletCarpenterBee(),n=!0,t=this.allForests.filter(i=>i.playerName!==this.playerName);for(let i of t)i.countTreesIncludingVioletCarpenterBee()>e&&(n=!1);return n}treeCount(){return this.countBySymbol("tree")}treeCardsCount(){return this.cards.filter(e=>e.symbols.filter(n=>n==="tree").length>0||e.symbols.filter(n=>n==="shrub").length>0).reduce((e,n)=>e+=n.count,0)}topCount(){return this.countByPosition("top")}bottomCount(){return this.countByPosition("bottom")}sideCount(){return this.countByPosition("side")}treePoints(){return this.cards.filter(e=>e.symbols.indexOf("tree")>=0||e.symbols.indexOf("shrub")>=0).map(e=>e.points).reduce((e,n)=>n+=e)}bottomPoints(){return this.cards.filter(e=>e.position==="bottom").map(e=>e.points).reduce((e,n)=>n+=e)}topPoints(){return this.cards.filter(n=>n.position==="top").map(n=>n.points).reduce((n,t)=>t+=n)+this.butterflyPoints}sidePoints(){return this.cards.filter(e=>e.position==="side").map(e=>e.points).reduce((e,n)=>n+=e)}};var fp=class{handleNothingToDo(e,n,t){}handleFullyOccupiedTree(e,n){let t=Object.keys(ws).length,i=new Array(t).fill(!1),o=e.getCardsOnBase(n,void 0,!0);for(let s of o){if(s.baseIndex!=n)continue;let l=kt[s.id],c=Object.values(ws).indexOf(l.position);i[c]=!0}return i.every(s=>s)}handleFullyOccupiedTrees(e,n,t){for(let i of t.forestCards)kt[i.id].position=="BASE"&&this.handleFullyOccupiedTree(t,i.baseIndex)&&n.value++}handleCardsAttachedToSilverFirs(e,n,t){for(let i of t.forestCards)if(kt[i.id].speci=="Tanne"){let s=t.getCardsOnBase(i.baseIndex);n.value+=s.length}}handleSharingACardSlot(e,n,t){for(let i of t.forestCards)kt[i.id].speci=="Erdkroete"&&t.getCardsOnBase(i.baseIndex,"Erdkroete").length>1&&n.value++}handleEuropeanPolecatAloneOnTreeOrShrub(e,n,t){for(let i of t.forestCards)kt[i.id].speci=="Waldiltis"&&t.getCardsOnBase(i.baseIndex).length==1&&n.value++}countCardsOnBase(e,n,t){let i=0,o=Array.isArray(t)?t:[t];for(let s of e.forestCards)if(kt[s.id].speci==n){let c=e.getBase(s.baseIndex),a=kt[c.id];o.includes(a.speci)&&i++}return i}handleChaffinchesAtopABeech(e,n,t){n.value+=this.countCardsOnBase(t,"Buchfink","Buche")}handleNightingalesAtopAShrub(e,n,t){n.value+=this.countCardsOnBase(t,"Buchfink",["Holunder","Haselnuss","Schlehdorn"])}handleRedSquirrelsAtopAnOak(e,n,t){n.value+=this.countCardsOnBase(t,"Eichhoernchen","Eiche")}handleBatOnTheOtherSide(e,n,t){for(let i of t.forestCards)if(kt[i.id].speci=="Siebenschlaefer"){let s=t.getCardsOnBase(i.baseIndex);for(let l of s){let c=kt[i.id];t.findCard(c.glCardName).symbols?.includes("bat")&&n.value++}}}handleVioletCarpenterBeeOnABeech(e,n,t){n.value+=this.countCardsOnBase(t,"Holzbiene","Buche")}handleVioletCarpenterBeeOnAHorseChestnut(e,n,t){n.value+=this.countCardsOnBase(t,"Holzbiene","Kastanie")}handleVioletCarpenterBeeOnALinden(e,n,t){n.value+=this.countCardsOnBase(t,"Holzbiene","Linde")}paramHandlers={hasMostLindens:this.handleNothingToDo.bind(this),hasMostTrees:this.handleNothingToDo.bind(this),fullyOccupiedTrees:this.handleFullyOccupiedTrees.bind(this),cardsAttachedToSilverFirs:this.handleCardsAttachedToSilverFirs.bind(this),sharingACardSlot:this.handleSharingACardSlot.bind(this),europeanPolecatAloneOnTreeOrShrub:this.handleEuropeanPolecatAloneOnTreeOrShrub.bind(this),chaffinchesAtopABeech:this.handleChaffinchesAtopABeech.bind(this),nightingalesAtopAShrub:this.handleNightingalesAtopAShrub.bind(this),redSquirrelsAtopAnOak:this.handleRedSquirrelsAtopAnOak.bind(this),batOnTheOtherSide:this.handleBatOnTheOtherSide.bind(this),onABeech:this.handleVioletCarpenterBeeOnABeech.bind(this),onAHorseChestnut:this.handleVioletCarpenterBeeOnAHorseChestnut.bind(this),onALinden:this.handleVioletCarpenterBeeOnALinden.bind(this),beechCount:this.handleNothingToDo.bind(this),oakCount:this.handleNothingToDo.bind(this),birchCount:this.handleNothingToDo.bind(this),horseChestnutCount:this.handleNothingToDo.bind(this),lindenCount:this.handleNothingToDo.bind(this),silverFirCount:this.handleNothingToDo.bind(this),stonePineCount:this.handleNothingToDo.bind(this),europeanLarchCount:this.handleNothingToDo.bind(this),douglasFirCount:this.handleNothingToDo.bind(this)};handleParam(e,n,t){let i=this.paramHandlers[n.name];if(!i)throw RangeError(`Parameter '${n.name}' has no handler defined in ParamHandler`);i(e,n,t)}};var pp=class extends hp{forestCards=[];getCardsOnBase(e,n,t=!1){let i=[];for(let o of this.forestCards){if(o.baseIndex!=e)continue;let s=kt[o.id];n!=null&&n!=s.speci||(t||s.position!="BASE")&&i.push(o)}return i}getBase(e){for(let n of this.forestCards){if(n.baseIndex!=e)continue;if(kt[n.id].position=="BASE")return n}throw new Error(`No base found with index: '${e}'!`)}addCardColor(e){let n=FI(e);this[n+"Count"]++}handleParams(){let e=new fp;for(let n of this.cards)if(n.params)for(let t of n.params)e.handleParam(n,t,this)}setCards(e){this.forestCards=e;for(let n of e){let t=kt[n.id],i=t.glCardName;try{let o=this.findCard(i);o.count++}catch(o){if(o instanceof Error){let s=`Adding Card '${i}' cause an error '${o.message}'`;console.error(s)}else console.error(o)}this.addCardColor(t.color)}this.handleParams()}};var hl=class r{loadingProgress=new st(0);isLoading=new st(!1);progressMap={};expectedSizes={};constructor(){}fetchAndCache(e,n){return F(this,null,function*(){if(yield this.isFileCached(e)){let d=yield this.getCachedFile(e);return n(this.expectedSizes[e]||1,this.expectedSizes[e]||1),d}let t=yield fetch(e);if(!t.ok)throw new Error(`Failed to fetch ${e}: ${t.statusText}`);let i=t.headers.get("Content-Length"),o=i?parseInt(i,10):0;this.expectedSizes[e]=o||1;let s=t.body?.getReader();if(!s)throw new Error("ReadableStream not supported in this browser.");let l=0,c=[];for(;;){let{done:d,value:h}=yield s.read();if(d)break;h&&(c.push(h),l+=h.length,n(l,this.expectedSizes[e]))}let a=new Uint8Array(l),u=0;for(let d of c)a.set(d,u),u+=d.length;return yield this.cacheFile(e,a),a.buffer})}cacheFile(e,n){return F(this,null,function*(){let t=yield caches.open("download-cache"),i=new Response(n,{headers:{"Content-Type":"application/octet-stream"}});yield t.put(e,i)})}getCachedFile(e){return F(this,null,function*(){let t=yield(yield caches.open("download-cache")).match(e);if(!t)throw new Error(`Cached file not found for ${e}`);return t.arrayBuffer()})}isFileCached(e){return F(this,null,function*(){return!!(yield(yield caches.open("download-cache")).match(e))})}clearCache(){return F(this,null,function*(){yield caches.delete("download-cache"),console.log("Cache cleared"),window.location.reload()})}loadResources(e){return F(this,null,function*(){this.isLoading.next(!0);for(let s of e)if(this.expectedSizes[s]=1,this.progressMap[s]=1,!(yield this.isFileCached(s))){this.progressMap[s]=0;try{let c=(yield fetch(s,{method:"HEAD"})).headers.get("Content-Length");this.expectedSizes[s]=c?parseInt(c,10):1}catch{console.warn(`HEAD request failed for ${s}, using default size 1.`),this.expectedSizes[s]=1}}let n=e.reduce((s,l)=>s+(this.expectedSizes[l]||1),0),t=()=>{let s=Object.values(this.progressMap).reduce((c,a)=>c+a,0),l=Math.min(100,Math.round(s/n*100));this.loadingProgress.next(l)},i={};e.forEach(s=>{i[s]=(l,c)=>{this.progressMap[s]=l,t()}});let o=yield Promise.all(e.map(s=>this.fetchAndCache(s,i[s])));return this.loadingProgress.next(100),this.isLoading.next(!1),o})}static \u0275fac=function(n){return new(n||r)};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})};function G5(r,e){if(r&1&&(te(0,"div",1)(1,"div",2),Sa(2,"async"),It(3),Sa(4,"async"),Q()()),r&2){let n=Ct();ie(),_a("width",Ea(2,3,n.loadingProgress$),"%"),ie(2),On("Downloading card detection models: ",Ea(4,5,n.loadingProgress$),"%")}}var gp=class r{constructor(e){this.downloadService=e;this.loadingProgress$=this.downloadService.loadingProgress,this.isLoading$=this.downloadService.isLoading.asObservable().pipe(Ig(1e3))}isLoading$;loadingProgress$;static \u0275fac=function(n){return new(n||r)(se(hl))};static \u0275cmp=Nr({type:r,selectors:[["app-download-progress"]],decls:2,vars:3,consts:[["class","progress","role","progressbar","aria-label","Example with label","aria-valuenow","25","aria-valuemin","0","aria-valuemax","100",4,"ngIf"],["role","progressbar","aria-label","Example with label","aria-valuenow","25","aria-valuemin","0","aria-valuemax","100",1,"progress"],[1,"progress-bar",2,"width","25%"]],template:function(n,t){n&1&&(Ke(0,G5,5,7,"div",0),Sa(1,"async")),n&2&&ge("ngIf",Ea(1,1,t.isLoading$))},dependencies:[di,Ca,Oh],encapsulation:2})};var W5=Object.create,Np=Object.defineProperty,q5=Object.getOwnPropertyDescriptor,Y5=Object.getOwnPropertyNames,X5=Object.getPrototypeOf,K5=Object.prototype.hasOwnProperty,Z5=(r=>typeof To<"u"?To:typeof Proxy<"u"?new Proxy(r,{get:(e,n)=>(typeof To<"u"?To:e)[n]}):r)(function(r){if(typeof To<"u")return To.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')}),R=(r,e)=>()=>(r&&(e=r(r=0)),e),Tt=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),xu=(r,e)=>{for(var n in e)Np(r,n,{get:e[n],enumerable:!0})},eM=(r,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Y5(e))!K5.call(r,i)&&i!==n&&Np(r,i,{get:()=>e[i],enumerable:!(t=q5(e,i))||t.enumerable});return r},ml=(r,e,n)=>(n=r!=null?W5(X5(r)):{},eM(e||!r||!r.__esModule?Np(n,"default",{value:r,enumerable:!0}):n,r)),Dp=r=>eM(Np({},"__esModule",{value:!0}),r),Xc,lo,bu,_O,Ow,Aw=R(()=>{"use strict";Xc=new Map,lo=[],bu=(r,e,n)=>{if(e&&typeof e.init=="function"&&typeof e.createInferenceSessionHandler=="function"){let t=Xc.get(r);if(t===void 0)Xc.set(r,{backend:e,priority:n});else{if(t.priority>n)return;if(t.priority===n&&t.backend!==e)throw new Error(`cannot register backend "${r}" using priority ${n}`)}if(n>=0){let i=lo.indexOf(r);i!==-1&&lo.splice(i,1);for(let o=0;o<lo.length;o++)if(Xc.get(lo[o]).priority<=n){lo.splice(o,0,r);return}lo.push(r)}return}throw new TypeError("not a valid backend")},_O=r=>F(void 0,null,function*(){let e=Xc.get(r);if(!e)return"backend not found.";if(e.initialized)return e.backend;if(e.aborted)return e.error;{let n=!!e.initPromise;try{return n||(e.initPromise=e.backend.init(r)),yield e.initPromise,e.initialized=!0,e.backend}catch(t){return n||(e.error=`${t}`,e.aborted=!0),e.error}finally{delete e.initPromise}}}),Ow=r=>F(void 0,null,function*(){let e=r.executionProviders||[],n=e.map(c=>typeof c=="string"?c:c.name),t=n.length===0?lo:n,i,o=[],s=new Set;for(let c of t){let a=yield _O(c);typeof a=="string"?o.push({name:c,err:a}):(i||(i=a),i===a&&s.add(c))}if(!i)throw new Error(`no available backend found. ERR: ${o.map(c=>`[${c.name}] ${c.err}`).join(", ")}`);for(let{name:c,err:a}of o)n.includes(c)&&console.warn(`removing requested execution provider "${c}" from session options because it is not available: ${a}`);let l=e.filter(c=>s.has(typeof c=="string"?c:c.name));return[i,new Proxy(r,{get:(c,a)=>a==="executionProviders"?l:Reflect.get(c,a)})]})}),J5=R(()=>{"use strict";Aw()}),tM,Q5=R(()=>{"use strict";tM="1.20.1"}),i0,nr,nM=R(()=>{"use strict";Q5(),i0="warning",nr={wasm:{},webgl:{},webgpu:{},versions:{common:tM},set logLevel(r){if(r!==void 0){if(typeof r!="string"||["verbose","info","warning","error","fatal"].indexOf(r)===-1)throw new Error(`Unsupported logging level: ${r}`);i0=r}},get logLevel(){return i0}},Object.defineProperty(nr,"logLevel",{enumerable:!0})}),me,e8=R(()=>{"use strict";nM(),me=nr}),rM,iM,t8=R(()=>{"use strict";rM=(r,e)=>{let n=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);n.width=r.dims[3],n.height=r.dims[2];let t=n.getContext("2d");if(t!=null){let i,o;e?.tensorLayout!==void 0&&e.tensorLayout==="NHWC"?(i=r.dims[2],o=r.dims[3]):(i=r.dims[3],o=r.dims[2]);let s=e?.format!==void 0?e.format:"RGB",l=e?.norm,c,a;l===void 0||l.mean===void 0?c=[255,255,255,255]:typeof l.mean=="number"?c=[l.mean,l.mean,l.mean,l.mean]:(c=[l.mean[0],l.mean[1],l.mean[2],0],l.mean[3]!==void 0&&(c[3]=l.mean[3])),l===void 0||l.bias===void 0?a=[0,0,0,0]:typeof l.bias=="number"?a=[l.bias,l.bias,l.bias,l.bias]:(a=[l.bias[0],l.bias[1],l.bias[2],0],l.bias[3]!==void 0&&(a[3]=l.bias[3]));let u=o*i,d=0,h=u,f=u*2,p=-1;s==="RGBA"?(d=0,h=u,f=u*2,p=u*3):s==="RGB"?(d=0,h=u,f=u*2):s==="RBG"&&(d=0,f=u,h=u*2);for(let g=0;g<o;g++)for(let y=0;y<i;y++){let w=(r.data[d++]-a[0])*c[0],v=(r.data[h++]-a[1])*c[1],x=(r.data[f++]-a[2])*c[2],A=p===-1?255:(r.data[p++]-a[3])*c[3];t.fillStyle="rgba("+w+","+v+","+x+","+A+")",t.fillRect(y,g,1,1)}if("toDataURL"in n)return n.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},iM=(r,e)=>{let n=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),t;if(n!=null){let i,o,s;e?.tensorLayout!==void 0&&e.tensorLayout==="NHWC"?(i=r.dims[2],o=r.dims[1],s=r.dims[3]):(i=r.dims[3],o=r.dims[2],s=r.dims[1]);let l=e!==void 0&&e.format!==void 0?e.format:"RGB",c=e?.norm,a,u;c===void 0||c.mean===void 0?a=[255,255,255,255]:typeof c.mean=="number"?a=[c.mean,c.mean,c.mean,c.mean]:(a=[c.mean[0],c.mean[1],c.mean[2],255],c.mean[3]!==void 0&&(a[3]=c.mean[3])),c===void 0||c.bias===void 0?u=[0,0,0,0]:typeof c.bias=="number"?u=[c.bias,c.bias,c.bias,c.bias]:(u=[c.bias[0],c.bias[1],c.bias[2],0],c.bias[3]!==void 0&&(u[3]=c.bias[3]));let d=o*i;if(e!==void 0&&(e.format!==void 0&&s===4&&e.format!=="RGBA"||s===3&&e.format!=="RGB"&&e.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let h=4,f=0,p=1,g=2,y=3,w=0,v=d,x=d*2,A=-1;l==="RGBA"?(w=0,v=d,x=d*2,A=d*3):l==="RGB"?(w=0,v=d,x=d*2):l==="RBG"&&(w=0,x=d,v=d*2),t=n.createImageData(i,o);for(let L=0;L<o*i;f+=h,p+=h,g+=h,y+=h,L++)t.data[f]=(r.data[w++]-u[0])*a[0],t.data[p]=(r.data[v++]-u[1])*a[1],t.data[g]=(r.data[x++]-u[2])*a[2],t.data[y]=A===-1?255:(r.data[A++]-u[3])*a[3]}else throw new Error("Can not access image data");return t}}),mp,oM,sM,aM,lM,cM,n8=R(()=>{"use strict";Pw(),mp=(r,e)=>{if(r===void 0)throw new Error("Image buffer must be defined");if(e.height===void 0||e.width===void 0)throw new Error("Image height and width must be defined");if(e.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:n,width:t}=e,i=e.norm??{mean:255,bias:0},o,s;typeof i.mean=="number"?o=[i.mean,i.mean,i.mean,i.mean]:o=[i.mean[0],i.mean[1],i.mean[2],i.mean[3]??255],typeof i.bias=="number"?s=[i.bias,i.bias,i.bias,i.bias]:s=[i.bias[0],i.bias[1],i.bias[2],i.bias[3]??0];let l=e.format!==void 0?e.format:"RGBA",c=e.tensorFormat!==void 0&&e.tensorFormat!==void 0?e.tensorFormat:"RGB",a=n*t,u=c==="RGBA"?new Float32Array(a*4):new Float32Array(a*3),d=4,h=0,f=1,p=2,g=3,y=0,w=a,v=a*2,x=-1;l==="RGB"&&(d=3,h=0,f=1,p=2,g=-1),c==="RGBA"?x=a*3:c==="RBG"?(y=0,v=a,w=a*2):c==="BGR"&&(v=0,w=a,y=a*2);for(let A=0;A<a;A++,h+=d,p+=d,f+=d,g+=d)u[y++]=(r[h]+s[0])/o[0],u[w++]=(r[f]+s[1])/o[1],u[v++]=(r[p]+s[2])/o[2],x!==-1&&g!==-1&&(u[x++]=(r[g]+s[3])/o[3]);return c==="RGBA"?new Vn("float32",u,[1,4,n,t]):new Vn("float32",u,[1,3,n,t])},oM=(r,e)=>F(void 0,null,function*(){let n=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,t=typeof ImageData<"u"&&r instanceof ImageData,i=typeof ImageBitmap<"u"&&r instanceof ImageBitmap,o=typeof r=="string",s,l=e??{},c=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},a=u=>typeof HTMLCanvasElement<"u"&&u instanceof HTMLCanvasElement||u instanceof OffscreenCanvas?u.getContext("2d"):null;if(n){let u=c();u.width=r.width,u.height=r.height;let d=a(u);if(d!=null){let h=r.height,f=r.width;if(e!==void 0&&e.resizedHeight!==void 0&&e.resizedWidth!==void 0&&(h=e.resizedHeight,f=e.resizedWidth),e!==void 0){if(l=e,e.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");l.tensorFormat="RGBA",l.height=h,l.width=f}else l.tensorFormat="RGBA",l.height=h,l.width=f;d.drawImage(r,0,0),s=d.getImageData(0,0,f,h).data}else throw new Error("Can not access image data")}else if(t){let u,d;if(e!==void 0&&e.resizedWidth!==void 0&&e.resizedHeight!==void 0?(u=e.resizedHeight,d=e.resizedWidth):(u=r.height,d=r.width),e!==void 0&&(l=e),l.format="RGBA",l.height=u,l.width=d,e!==void 0){let h=c();h.width=d,h.height=u;let f=a(h);if(f!=null)f.putImageData(r,0,0),s=f.getImageData(0,0,d,u).data;else throw new Error("Can not access image data")}else s=r.data}else if(i){if(e===void 0)throw new Error("Please provide image config with format for Imagebitmap");let u=c();u.width=r.width,u.height=r.height;let d=a(u);if(d!=null){let h=r.height,f=r.width;return d.drawImage(r,0,0,f,h),s=d.getImageData(0,0,f,h).data,l.height=h,l.width=f,mp(s,l)}else throw new Error("Can not access image data")}else{if(o)return new Promise((u,d)=>{let h=c(),f=a(h);if(!r||!f)return d();let p=new Image;p.crossOrigin="Anonymous",p.src=r,p.onload=()=>{h.width=p.width,h.height=p.height,f.drawImage(p,0,0,h.width,h.height);let g=f.getImageData(0,0,h.width,h.height);l.height=h.height,l.width=h.width,u(mp(g.data,l))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(s!==void 0)return mp(s,l);throw new Error("Input data provided is not supported - aborted tensor creation")}),sM=(r,e)=>{let{width:n,height:t,download:i,dispose:o}=e,s=[1,t,n,4];return new Vn({location:"texture",type:"float32",texture:r,dims:s,download:i,dispose:o})},aM=(r,e)=>{let{dataType:n,dims:t,download:i,dispose:o}=e;return new Vn({location:"gpu-buffer",type:n??"float32",gpuBuffer:r,dims:t,download:i,dispose:o})},lM=(r,e)=>{let{dataType:n,dims:t,download:i,dispose:o}=e;return new Vn({location:"ml-tensor",type:n??"float32",mlTensor:r,dims:t,download:i,dispose:o})},cM=(r,e,n)=>new Vn({location:"cpu-pinned",type:r,data:e,dims:n??[e.length]})}),Is,su,o0,uM,r8=R(()=>{"use strict";Is=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),su=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),o0=!1,uM=()=>{if(!o0){o0=!0;let r=typeof BigInt64Array<"u"&&BigInt64Array.from,e=typeof BigUint64Array<"u"&&BigUint64Array.from,n=typeof Float16Array<"u"&&Float16Array.from;r&&(Is.set("int64",BigInt64Array),su.set(BigInt64Array,"int64")),e&&(Is.set("uint64",BigUint64Array),su.set(BigUint64Array,"uint64")),n?(Is.set("float16",Float16Array),su.set(Float16Array,"float16")):Is.set("float16",Uint16Array)}}}),dM,hM,i8=R(()=>{"use strict";Pw(),dM=r=>{let e=1;for(let n=0;n<r.length;n++){let t=r[n];if(typeof t!="number"||!Number.isSafeInteger(t))throw new TypeError(`dims[${n}] must be an integer, got: ${t}`);if(t<0)throw new RangeError(`dims[${n}] must be a non-negative integer, got: ${t}`);e*=t}return e},hM=(r,e)=>{switch(r.location){case"cpu":return new Vn(r.type,r.data,e);case"cpu-pinned":return new Vn({location:"cpu-pinned",data:r.data,type:r.type,dims:e});case"texture":return new Vn({location:"texture",texture:r.texture,type:r.type,dims:e});case"gpu-buffer":return new Vn({location:"gpu-buffer",gpuBuffer:r.gpuBuffer,type:r.type,dims:e});case"ml-tensor":return new Vn({location:"ml-tensor",mlTensor:r.mlTensor,type:r.type,dims:e});default:throw new Error(`tensorReshape: tensor location ${r.location} is not supported`)}}}),Vn,Pw=R(()=>{"use strict";t8(),n8(),r8(),i8(),Vn=class{constructor(r,e,n){uM();let t,i;if(typeof r=="object"&&"location"in r)switch(this.dataLocation=r.location,t=r.type,i=r.dims,r.location){case"cpu-pinned":{let s=Is.get(t);if(!s)throw new TypeError(`unsupported type "${t}" to create tensor from pinned buffer`);if(!(r.data instanceof s))throw new TypeError(`buffer should be of type ${s.name}`);this.cpuData=r.data;break}case"texture":{if(t!=="float32")throw new TypeError(`unsupported type "${t}" to create tensor from texture`);this.gpuTextureData=r.texture,this.downloader=r.download,this.disposer=r.dispose;break}case"gpu-buffer":{if(t!=="float32"&&t!=="float16"&&t!=="int32"&&t!=="int64"&&t!=="uint32"&&t!=="uint8"&&t!=="bool"&&t!=="uint4"&&t!=="int4")throw new TypeError(`unsupported type "${t}" to create tensor from gpu buffer`);this.gpuBufferData=r.gpuBuffer,this.downloader=r.download,this.disposer=r.dispose;break}case"ml-tensor":{if(t!=="float32"&&t!=="float16"&&t!=="int32"&&t!=="int64"&&t!=="uint32"&&t!=="uint64"&&t!=="int8"&&t!=="uint8"&&t!=="bool")throw new TypeError(`unsupported type "${t}" to create tensor from MLTensor`);this.mlTensorData=r.mlTensor,this.downloader=r.download,this.disposer=r.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let s,l;if(typeof r=="string")if(t=r,l=n,r==="string"){if(!Array.isArray(e))throw new TypeError("A string tensor's data must be a string array.");s=e}else{let c=Is.get(r);if(c===void 0)throw new TypeError(`Unsupported tensor type: ${r}.`);if(Array.isArray(e)){if(r==="float16"&&c===Uint16Array||r==="uint4"||r==="int4")throw new TypeError(`Creating a ${r} tensor from number array is not supported. Please use ${c.name} as data.`);r==="uint64"||r==="int64"?s=c.from(e,BigInt):s=c.from(e)}else if(e instanceof c)s=e;else if(e instanceof Uint8ClampedArray)if(r==="uint8")s=Uint8Array.from(e);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else throw new TypeError(`A ${t} tensor's data must be type of ${c}`)}else if(l=e,Array.isArray(r)){if(r.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let c=typeof r[0];if(c==="string")t="string",s=r;else if(c==="boolean")t="bool",s=Uint8Array.from(r);else throw new TypeError(`Invalid element type of data array: ${c}.`)}else if(r instanceof Uint8ClampedArray)t="uint8",s=Uint8Array.from(r);else{let c=su.get(r.constructor);if(c===void 0)throw new TypeError(`Unsupported type for tensor data: ${r.constructor}.`);t=c,s=r}if(l===void 0)l=[s.length];else if(!Array.isArray(l))throw new TypeError("A tensor's dims must be a number array");i=l,this.cpuData=s,this.dataLocation="cpu"}let o=dM(i);if(this.cpuData&&o!==this.cpuData.length&&!((t==="uint4"||t==="int4")&&Math.ceil(o/2)===this.cpuData.length))throw new Error(`Tensor's size(${o}) does not match data length(${this.cpuData.length}).`);this.type=t,this.dims=i,this.size=o}static fromImage(r,e){return F(this,null,function*(){return oM(r,e)})}static fromTexture(r,e){return sM(r,e)}static fromGpuBuffer(r,e){return aM(r,e)}static fromMLTensor(r,e){return lM(r,e)}static fromPinnedBuffer(r,e,n){return cM(r,e,n)}toDataURL(r){return rM(this,r)}toImageData(r){return iM(this,r)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}getData(r){return F(this,null,function*(){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let e=yield this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=e,r&&this.disposer&&(this.disposer(),this.disposer=void 0),e}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}})}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(r){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return hM(this,r)}}}),Ft,Mw=R(()=>{"use strict";Pw(),Ft=Vn}),q0,s0,yl,vl,fM=R(()=>{"use strict";nM(),q0=(r,e)=>{(typeof nr.trace>"u"?!nr.wasm.trace:!nr.trace)||console.timeStamp(`${r}::ORT::${e}`)},s0=(r,e)=>{let n=new Error().stack?.split(/\r\n|\r|\n/g)||[],t=!1;for(let i=0;i<n.length;i++){if(t&&!n[i].includes("TRACE_FUNC")){let o=`FUNC_${r}::${n[i].trim().split(" ")[1]}`;e&&(o+=`::${e}`),q0("CPU",o);return}n[i].includes("TRACE_FUNC")&&(t=!0)}},yl=r=>{(typeof nr.trace>"u"?!nr.wasm.trace:!nr.trace)||s0("BEGIN",r)},vl=r=>{(typeof nr.trace>"u"?!nr.wasm.trace:!nr.trace)||s0("END",r)}}),pM,o8=R(()=>{"use strict";Aw(),Mw(),fM(),pM=class gM{constructor(e){this.handler=e}run(e,n,t){return F(this,null,function*(){yl();let i={},o={};if(typeof e!="object"||e===null||e instanceof Ft||Array.isArray(e))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let s=!0;if(typeof n=="object"){if(n===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof Ft)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(n.length===0)throw new TypeError("'fetches' cannot be an empty array.");s=!1;for(let a of n){if(typeof a!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(a)===-1)throw new RangeError(`'fetches' contains invalid output name: ${a}.`);i[a]=null}if(typeof t=="object"&&t!==null)o=t;else if(typeof t<"u")throw new TypeError("'options' must be an object.")}else{let a=!1,u=Object.getOwnPropertyNames(n);for(let d of this.outputNames)if(u.indexOf(d)!==-1){let h=n[d];(h===null||h instanceof Ft)&&(a=!0,s=!1,i[d]=h)}if(a){if(typeof t=="object"&&t!==null)o=t;else if(typeof t<"u")throw new TypeError("'options' must be an object.")}else o=n}}else if(typeof n<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let a of this.inputNames)if(typeof e[a]>"u")throw new Error(`input '${a}' is missing in 'feeds'.`);if(s)for(let a of this.outputNames)i[a]=null;let l=yield this.handler.run(e,i,o),c={};for(let a in l)if(Object.hasOwnProperty.call(l,a)){let u=l[a];u instanceof Ft?c[a]=u:c[a]=new Ft(u.type,u.data,u.dims)}return vl(),c})}release(){return F(this,null,function*(){return this.handler.dispose()})}static create(e,n,t,i){return F(this,null,function*(){yl();let o,s={};if(typeof e=="string"){if(o=e,typeof n=="object"&&n!==null)s=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(e instanceof Uint8Array){if(o=e,typeof n=="object"&&n!==null)s=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer){let u=e,d=0,h=e.byteLength;if(typeof n=="object"&&n!==null)s=n;else if(typeof n=="number"){if(d=n,!Number.isSafeInteger(d))throw new RangeError("'byteOffset' must be an integer.");if(d<0||d>=u.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${u.byteLength}).`);if(h=e.byteLength-d,typeof t=="number"){if(h=t,!Number.isSafeInteger(h))throw new RangeError("'byteLength' must be an integer.");if(h<=0||d+h>u.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${u.byteLength-d}].`);if(typeof i=="object"&&i!==null)s=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(typeof t<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof n<"u")throw new TypeError("'options' must be an object.");o=new Uint8Array(u,d,h)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[l,c]=yield Ow(s),a=yield l.createInferenceSessionHandler(o,c);return vl(),new gM(a)})}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}}),Rp,s8=R(()=>{"use strict";o8(),Rp=pM}),a8=R(()=>{"use strict"}),l8=R(()=>{"use strict"}),c8=R(()=>{"use strict"}),u8=R(()=>{"use strict"}),TO,mM,d8=R(()=>{"use strict";Aw(),Mw(),TO="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",mM=class yM{constructor(e,n,t){this.handler=e,this.hasOptimizerModel=n,this.hasEvalModel=t}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static create(e,n){return F(this,null,function*(){let t=e.evalModel||"",i=e.optimizerModel||"",o=n||{},[s,l]=yield Ow(o);if(s.createTrainingSessionHandler){let c=yield s.createTrainingSessionHandler(e.checkpointState,e.trainModel,t,i,l);return new yM(c,!!e.optimizerModel,!!e.evalModel)}else throw new Error(TO)})}typeNarrowingForRunStep(e,n,t,i,o){let s={},l={};if(typeof t!="object"||t===null||t instanceof Ft||Array.isArray(t))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let c=!0;if(typeof i=="object"){if(i===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(i instanceof Ft)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(i)){if(i.length===0)throw new TypeError("'fetches' cannot be an empty array.");c=!1;for(let a of i){if(typeof a!="string")throw new TypeError("'fetches' must be a string array or an object.");if(n.indexOf(a)===-1)throw new RangeError(`'fetches' contains invalid output name: ${a}.`);s[a]=null}if(typeof o=="object"&&o!==null)l=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else{let a=!1,u=Object.getOwnPropertyNames(i);for(let d of n)if(u.indexOf(d)!==-1){let h=i[d];(h===null||h instanceof Ft)&&(a=!0,c=!1,s[d]=h)}if(a){if(typeof o=="object"&&o!==null)l=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else l=i}}else if(typeof i<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let a of e)if(typeof t[a]>"u")throw new Error(`input '${a}' is missing in 'feeds'.`);if(c)for(let a of n)s[a]=null;return[s,l]}convertHandlerReturnTypeToMapOfTensors(e){let n={};for(let t in e)if(Object.hasOwnProperty.call(e,t)){let i=e[t];i instanceof Ft?n[t]=i:n[t]=new Ft(i.type,i.data,i.dims)}return n}lazyResetGrad(){return F(this,null,function*(){yield this.handler.lazyResetGrad()})}runTrainStep(e,n,t){return F(this,null,function*(){let[i,o]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,e,n,t),s=yield this.handler.runTrainStep(e,i,o);return this.convertHandlerReturnTypeToMapOfTensors(s)})}runOptimizerStep(e){return F(this,null,function*(){if(this.hasOptimizerModel)yield this.handler.runOptimizerStep(e||{});else throw new Error("This TrainingSession has no OptimizerModel loaded.")})}runEvalStep(e,n,t){return F(this,null,function*(){if(this.hasEvalModel){let[i,o]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,e,n,t),s=yield this.handler.runEvalStep(e,i,o);return this.convertHandlerReturnTypeToMapOfTensors(s)}else throw new Error("This TrainingSession has no EvalModel loaded.")})}getParametersSize(e=!0){return F(this,null,function*(){return this.handler.getParametersSize(e)})}loadParametersBuffer(e,n=!0){return F(this,null,function*(){let t=yield this.getParametersSize(n);if(e.length!==4*t)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(e,n)})}getContiguousParameters(e=!0){return F(this,null,function*(){return this.handler.getContiguousParameters(e)})}release(){return F(this,null,function*(){return this.handler.dispose()})}}}),vM,h8=R(()=>{"use strict";d8(),vM=mM}),bM={};xu(bM,{InferenceSession:()=>Rp,TRACE:()=>q0,TRACE_FUNC_BEGIN:()=>yl,TRACE_FUNC_END:()=>vl,Tensor:()=>Ft,TrainingSession:()=>vM,env:()=>me,registerBackend:()=>bu});var Hr=R(()=>{"use strict";J5(),e8(),s8(),Mw(),a8(),l8(),fM(),c8(),u8(),h8()});function Os(r,e,n,t){if(e===void 0)return f8(r);if(n===void 0)yp(r,e,1);else if(typeof n=="number"&&t===void 0)yp(r,e,n);else if(typeof n=="string"&&t===void 0)yp(r,n,1,e);else if(typeof n=="string"&&typeof t=="number")yp(r,n,t,e);else throw new TypeError("input is valid")}function f8(r){return{verbose:Os.verbose.bind(null,r),info:Os.info.bind(null,r),warning:Os.warning.bind(null,r),error:Os.error.bind(null,r),fatal:Os.fatal.bind(null,r)}}function yp(r,e,n,t){let i=gl[t||""]||gl[""];Y0[r]<Y0[i.minimalSeverity]||(i.logDateTime&&(e=`${new Date().toISOString()}|${e}`),i.logSourceLocation,wM[i.provider].log(r,e,t))}var xO,SO,Y0,wM,a0,gl,ht,l0,c0,_M,Kc,Er=R(()=>{"use strict";xO=class{log(r,e,n){}},SO=class{log(r,e,n){console.log(`${this.color(r)} ${n?"\x1B[35m"+n+"\x1B[0m ":""}${e}`)}color(r){switch(r){case"verbose":return"\x1B[34;40mv\x1B[0m";case"info":return"\x1B[32mi\x1B[0m";case"warning":return"\x1B[30;43mw\x1B[0m";case"error":return"\x1B[31;40me\x1B[0m";case"fatal":return"\x1B[101mf\x1B[0m";default:throw new Error(`unsupported severity: ${r}`)}}},Y0={verbose:1e3,info:2e3,warning:4e3,error:5e3,fatal:6e3},wM={none:new xO,console:new SO},a0={provider:"console",minimalSeverity:"warning",logDateTime:!0,logSourceLocation:!1},gl={"":a0},(r=>{function e(a,u){r("verbose",a,u)}r.verbose=e;function n(a,u){r("info",a,u)}r.info=n;function t(a,u){r("warning",a,u)}r.warning=t;function i(a,u){r("error",a,u)}r.error=i;function o(a,u){r("fatal",a,u)}r.fatal=o;function s(a){gl={},l("",a||{})}r.reset=s;function l(a,u){if(a==="*")s(u);else{let d=gl[a]||a0;gl[a]={provider:u.provider||d.provider,minimalSeverity:u.minimalSeverity||d.minimalSeverity,logDateTime:u.logDateTime===void 0?d.logDateTime:u.logDateTime,logSourceLocation:u.logSourceLocation===void 0?d.logSourceLocation:u.logSourceLocation}}}r.set=l;function c(a){let u={};a.logLevel&&(u.minimalSeverity=a.logLevel),l("",u)}r.setWithEnv=c})(Os||={}),ht=Os,l0=class{constructor(r,e,n,t,i,o){this.category=r,this.name=e,this.startTime=n,this.endCallback=t,this.timer=i,this.ctx=o}end(){return F(this,null,function*(){return this.endCallback(this)})}checkTimer(){return F(this,null,function*(){if(this.ctx===void 0||this.timer===void 0)throw new Error("No webgl timer found");return this.ctx.endTimer(),this.ctx.waitForQueryAndGetTime(this.timer)})}},c0=class{constructor(r,e,n,t){this.category=r,this.name=e,this.startTime=n,this.endTime=t}},_M=class{constructor(r,e,n){this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=r===void 0?1e4:r,this._flushBatchSize=e===void 0?10:e,this._flushIntervalInMilliseconds=n===void 0?5e3:n}static create(r){return r===void 0?new this:new this(r.maxNumberEvents,r.flushBatchSize,r.flushIntervalInMilliseconds)}start(){this._started=!0,this._timingEvents=[],this._flushTime=Kc(),this._flushPointer=0}stop(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer])}event(r,e,n,t){let i=this._started?this.begin(r,e,t):void 0,o=!1,s=n();if(s&&typeof s.then=="function")return o=!0,new Promise((l,c)=>{s.then(a=>F(this,null,function*(){i&&(yield i.end()),l(a)}),a=>F(this,null,function*(){i&&(yield i.end()),c(a)}))});if(!o&&i){let l=i.end();if(l&&typeof l.then=="function")return new Promise((c,a)=>{l.then(()=>{c(s)},u=>{a(u)})})}return s}begin(r,e,n){if(!this._started)throw new Error("profiler is not started yet");if(n===void 0){let t=Kc();return this.flush(t),new l0(r,e,t,i=>this.endSync(i))}else{let t=n.beginTimer();return new l0(r,e,0,i=>F(this,null,function*(){return this.end(i)}),t,n)}}end(r){return F(this,null,function*(){let e=yield r.checkTimer();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new c0(r.category,r.name,r.startTime,e)),this.flush(e))})}endSync(r){let e=Kc();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new c0(r.category,r.name,r.startTime,e)),this.flush(e))}logOneEvent(r){ht.verbose(`Profiler.${r.category}`,`${(r.endTime-r.startTime).toFixed(2)}ms on event '${r.name}' at ${r.endTime.toFixed(2)}`)}flush(r){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||r-this._flushTime>=this._flushIntervalInMilliseconds){for(let e=this._flushPointer;this._flushPointer<e+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=Kc()}}get started(){return this._started}},Kc=typeof performance<"u"&&performance.now?()=>performance.now():Date.now});function p8(r,e,n){for(let t of n){let i=t[0],o=t[1],s=t[2],l=t[3],c=t[4];if(r.opType===i){for(let a of e)if((a.domain===o||a.domain==="ai.onnx"&&o==="")&&g8(a.version,s))return{opImpl:l,opInit:c}}}throw new TypeError(`cannot resolve operator '${r.opType}' with opsets: ${e.map(t=>`${t.domain||"ai.onnx"} v${t.version}`).join(", ")}`)}function g8(r,e){if(e.endsWith("+")){let n=Number.parseInt(e.substring(0,e.length-1),10);return!isNaN(n)&&n<=r}else if(e.split("-").length===2){let n=e.split("-"),t=Number.parseInt(n[0],10),i=Number.parseInt(n[1],10);return!isNaN(t)&&!isNaN(i)&&t<=r&&r<=i}else return Number.parseInt(e,10)===r}var m8=R(()=>{"use strict"}),y8=Tt(r=>{"use strict";r.__esModule=!0;var e=function(){function n(t){if(!t)throw new TypeError("Invalid argument; `value` has no value.");this.value=n.EMPTY,t&&n.isGuid(t)&&(this.value=t)}return n.isGuid=function(t){var i=t.toString();return t&&(t instanceof n||n.validator.test(i))},n.create=function(){return new n([n.gen(2),n.gen(1),n.gen(1),n.gen(1),n.gen(3)].join("-"))},n.createEmpty=function(){return new n("emptyguid")},n.parse=function(t){return new n(t)},n.raw=function(){return[n.gen(2),n.gen(1),n.gen(1),n.gen(1),n.gen(3)].join("-")},n.gen=function(t){for(var i="",o=0;o<t;o++)i+=((1+Math.random())*65536|0).toString(16).substring(1);return i},n.prototype.equals=function(t){return n.isGuid(t)&&this.value===t.toString()},n.prototype.isEmpty=function(){return this.value===n.EMPTY},n.prototype.toString=function(){return this.value},n.prototype.toJSON=function(){return{value:this.value}},n.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),n.EMPTY="00000000-0000-0000-0000-000000000000",n}();r.Guid=e});function Ge(r,e,n){this.low=r|0,this.high=e|0,this.unsigned=!!n}function Zt(r){return(r&&r.__isLong__)===!0}function EO(r){var e=Math.clz32(r&-r);return r?31-e:e}function Ts(r,e){var n,t,i;return e?(r>>>=0,(i=0<=r&&r<256)&&(t=K0[r],t)?t:(n=Me(r,0,!0),i&&(K0[r]=n),n)):(r|=0,(i=-128<=r&&r<128)&&(t=X0[r],t)?t:(n=Me(r,r<0?-1:0,!1),i&&(X0[r]=n),n))}function ir(r,e){if(isNaN(r))return e?Vr:rr;if(e){if(r<0)return Vr;if(r>=Z0)return ew}else{if(r<=-J0)return hn;if(r+1>=J0)return Q0}return r<0?ir(-r,e).neg():Me(r%As|0,r/As|0,e)}function Me(r,e,n){return new Ge(r,e,n)}function Nw(r,e,n){if(r.length===0)throw Error("empty string");if(typeof e=="number"?(n=e,e=!1):e=!!e,r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return e?Vr:rr;if(n=n||10,n<2||36<n)throw RangeError("radix");var t;if((t=r.indexOf("-"))>0)throw Error("interior hyphen");if(t===0)return Nw(r.substring(1),e,n).neg();for(var i=ir(gu(n,8)),o=rr,s=0;s<r.length;s+=8){var l=Math.min(8,r.length-s),c=parseInt(r.substring(s,s+l),n);if(l<8){var a=ir(gu(n,l));o=o.mul(a).add(ir(c))}else o=o.mul(i),o=o.add(ir(c))}return o.unsigned=e,o}function Sr(r,e){return typeof r=="number"?ir(r,e):typeof r=="string"?Nw(r,e):Me(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}var Fn,X0,K0,gu,u0,DO,As,Z0,J0,d0,rr,Vr,xs,h0,vp,Q0,ew,hn,j,po,TM=R(()=>{Fn=null;try{Fn=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}Ge.prototype.__isLong__,Object.defineProperty(Ge.prototype,"__isLong__",{value:!0}),Ge.isLong=Zt,X0={},K0={},Ge.fromInt=Ts,Ge.fromNumber=ir,Ge.fromBits=Me,gu=Math.pow,Ge.fromString=Nw,Ge.fromValue=Sr,u0=65536,DO=1<<24,As=u0*u0,Z0=As*As,J0=Z0/2,d0=Ts(DO),rr=Ts(0),Ge.ZERO=rr,Vr=Ts(0,!0),Ge.UZERO=Vr,xs=Ts(1),Ge.ONE=xs,h0=Ts(1,!0),Ge.UONE=h0,vp=Ts(-1),Ge.NEG_ONE=vp,Q0=Me(-1,2147483647,!1),Ge.MAX_VALUE=Q0,ew=Me(-1,-1,!0),Ge.MAX_UNSIGNED_VALUE=ew,hn=Me(0,-2147483648,!1),Ge.MIN_VALUE=hn,j=Ge.prototype,j.toInt=function(){return this.unsigned?this.low>>>0:this.low},j.toNumber=function(){return this.unsigned?(this.high>>>0)*As+(this.low>>>0):this.high*As+(this.low>>>0)},j.toString=function(r){if(r=r||10,r<2||36<r)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(hn)){var e=ir(r),n=this.div(e),t=n.mul(e).sub(this);return n.toString(r)+t.toInt().toString(r)}else return"-"+this.neg().toString(r);for(var i=ir(gu(r,6),this.unsigned),o=this,s="";;){var l=o.div(i),c=o.sub(l.mul(i)).toInt()>>>0,a=c.toString(r);if(o=l,o.isZero())return a+s;for(;a.length<6;)a="0"+a;s=""+a+s}},j.getHighBits=function(){return this.high},j.getHighBitsUnsigned=function(){return this.high>>>0},j.getLowBits=function(){return this.low},j.getLowBitsUnsigned=function(){return this.low>>>0},j.getNumBitsAbs=function(){if(this.isNegative())return this.eq(hn)?64:this.neg().getNumBitsAbs();for(var r=this.high!=0?this.high:this.low,e=31;e>0&&!(r&1<<e);e--);return this.high!=0?e+33:e+1},j.isZero=function(){return this.high===0&&this.low===0},j.eqz=j.isZero,j.isNegative=function(){return!this.unsigned&&this.high<0},j.isPositive=function(){return this.unsigned||this.high>=0},j.isOdd=function(){return(this.low&1)===1},j.isEven=function(){return(this.low&1)===0},j.equals=function(r){return Zt(r)||(r=Sr(r)),this.unsigned!==r.unsigned&&this.high>>>31===1&&r.high>>>31===1?!1:this.high===r.high&&this.low===r.low},j.eq=j.equals,j.notEquals=function(r){return!this.eq(r)},j.neq=j.notEquals,j.ne=j.notEquals,j.lessThan=function(r){return this.comp(r)<0},j.lt=j.lessThan,j.lessThanOrEqual=function(r){return this.comp(r)<=0},j.lte=j.lessThanOrEqual,j.le=j.lessThanOrEqual,j.greaterThan=function(r){return this.comp(r)>0},j.gt=j.greaterThan,j.greaterThanOrEqual=function(r){return this.comp(r)>=0},j.gte=j.greaterThanOrEqual,j.ge=j.greaterThanOrEqual,j.compare=function(r){if(Zt(r)||(r=Sr(r)),this.eq(r))return 0;var e=this.isNegative(),n=r.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?r.high>>>0>this.high>>>0||r.high===this.high&&r.low>>>0>this.low>>>0?-1:1:this.sub(r).isNegative()?-1:1},j.comp=j.compare,j.negate=function(){return!this.unsigned&&this.eq(hn)?hn:this.not().add(xs)},j.neg=j.negate,j.add=function(r){Zt(r)||(r=Sr(r));var e=this.high>>>16,n=this.high&65535,t=this.low>>>16,i=this.low&65535,o=r.high>>>16,s=r.high&65535,l=r.low>>>16,c=r.low&65535,a=0,u=0,d=0,h=0;return h+=i+c,d+=h>>>16,h&=65535,d+=t+l,u+=d>>>16,d&=65535,u+=n+s,a+=u>>>16,u&=65535,a+=e+o,a&=65535,Me(d<<16|h,a<<16|u,this.unsigned)},j.subtract=function(r){return Zt(r)||(r=Sr(r)),this.add(r.neg())},j.sub=j.subtract,j.multiply=function(r){if(this.isZero())return this;if(Zt(r)||(r=Sr(r)),Fn){var e=Fn.mul(this.low,this.high,r.low,r.high);return Me(e,Fn.get_high(),this.unsigned)}if(r.isZero())return this.unsigned?Vr:rr;if(this.eq(hn))return r.isOdd()?hn:rr;if(r.eq(hn))return this.isOdd()?hn:rr;if(this.isNegative())return r.isNegative()?this.neg().mul(r.neg()):this.neg().mul(r).neg();if(r.isNegative())return this.mul(r.neg()).neg();if(this.lt(d0)&&r.lt(d0))return ir(this.toNumber()*r.toNumber(),this.unsigned);var n=this.high>>>16,t=this.high&65535,i=this.low>>>16,o=this.low&65535,s=r.high>>>16,l=r.high&65535,c=r.low>>>16,a=r.low&65535,u=0,d=0,h=0,f=0;return f+=o*a,h+=f>>>16,f&=65535,h+=i*a,d+=h>>>16,h&=65535,h+=o*c,d+=h>>>16,h&=65535,d+=t*a,u+=d>>>16,d&=65535,d+=i*c,u+=d>>>16,d&=65535,d+=o*l,u+=d>>>16,d&=65535,u+=n*a+t*c+i*l+o*s,u&=65535,Me(h<<16|f,u<<16|d,this.unsigned)},j.mul=j.multiply,j.divide=function(r){if(Zt(r)||(r=Sr(r)),r.isZero())throw Error("division by zero");if(Fn){if(!this.unsigned&&this.high===-2147483648&&r.low===-1&&r.high===-1)return this;var e=(this.unsigned?Fn.div_u:Fn.div_s)(this.low,this.high,r.low,r.high);return Me(e,Fn.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Vr:rr;var n,t,i;if(this.unsigned){if(r.unsigned||(r=r.toUnsigned()),r.gt(this))return Vr;if(r.gt(this.shru(1)))return h0;i=Vr}else{if(this.eq(hn)){if(r.eq(xs)||r.eq(vp))return hn;if(r.eq(hn))return xs;var o=this.shr(1);return n=o.div(r).shl(1),n.eq(rr)?r.isNegative()?xs:vp:(t=this.sub(r.mul(n)),i=n.add(t.div(r)),i)}else if(r.eq(hn))return this.unsigned?Vr:rr;if(this.isNegative())return r.isNegative()?this.neg().div(r.neg()):this.neg().div(r).neg();if(r.isNegative())return this.div(r.neg()).neg();i=rr}for(t=this;t.gte(r);){n=Math.max(1,Math.floor(t.toNumber()/r.toNumber()));for(var s=Math.ceil(Math.log(n)/Math.LN2),l=s<=48?1:gu(2,s-48),c=ir(n),a=c.mul(r);a.isNegative()||a.gt(t);)n-=l,c=ir(n,this.unsigned),a=c.mul(r);c.isZero()&&(c=xs),i=i.add(c),t=t.sub(a)}return i},j.div=j.divide,j.modulo=function(r){if(Zt(r)||(r=Sr(r)),Fn){var e=(this.unsigned?Fn.rem_u:Fn.rem_s)(this.low,this.high,r.low,r.high);return Me(e,Fn.get_high(),this.unsigned)}return this.sub(this.div(r).mul(r))},j.mod=j.modulo,j.rem=j.modulo,j.not=function(){return Me(~this.low,~this.high,this.unsigned)},j.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},j.clz=j.countLeadingZeros,j.countTrailingZeros=function(){return this.low?EO(this.low):EO(this.high)+32},j.ctz=j.countTrailingZeros,j.and=function(r){return Zt(r)||(r=Sr(r)),Me(this.low&r.low,this.high&r.high,this.unsigned)},j.or=function(r){return Zt(r)||(r=Sr(r)),Me(this.low|r.low,this.high|r.high,this.unsigned)},j.xor=function(r){return Zt(r)||(r=Sr(r)),Me(this.low^r.low,this.high^r.high,this.unsigned)},j.shiftLeft=function(r){return Zt(r)&&(r=r.toInt()),(r&=63)===0?this:r<32?Me(this.low<<r,this.high<<r|this.low>>>32-r,this.unsigned):Me(0,this.low<<r-32,this.unsigned)},j.shl=j.shiftLeft,j.shiftRight=function(r){return Zt(r)&&(r=r.toInt()),(r&=63)===0?this:r<32?Me(this.low>>>r|this.high<<32-r,this.high>>r,this.unsigned):Me(this.high>>r-32,this.high>=0?0:-1,this.unsigned)},j.shr=j.shiftRight,j.shiftRightUnsigned=function(r){return Zt(r)&&(r=r.toInt()),(r&=63)===0?this:r<32?Me(this.low>>>r|this.high<<32-r,this.high>>>r,this.unsigned):r===32?Me(this.high,0,this.unsigned):Me(this.high>>>r-32,0,this.unsigned)},j.shru=j.shiftRightUnsigned,j.shr_u=j.shiftRightUnsigned,j.rotateLeft=function(r){var e;return Zt(r)&&(r=r.toInt()),(r&=63)===0?this:r===32?Me(this.high,this.low,this.unsigned):r<32?(e=32-r,Me(this.low<<r|this.high>>>e,this.high<<r|this.low>>>e,this.unsigned)):(r-=32,e=32-r,Me(this.high<<r|this.low>>>e,this.low<<r|this.high>>>e,this.unsigned))},j.rotl=j.rotateLeft,j.rotateRight=function(r){var e;return Zt(r)&&(r=r.toInt()),(r&=63)===0?this:r===32?Me(this.high,this.low,this.unsigned):r<32?(e=32-r,Me(this.high<<e|this.low>>>r,this.low<<e|this.high>>>r,this.unsigned)):(r-=32,e=32-r,Me(this.low<<e|this.high>>>r,this.high<<e|this.low>>>r,this.unsigned))},j.rotr=j.rotateRight,j.toSigned=function(){return this.unsigned?Me(this.low,this.high,!1):this},j.toUnsigned=function(){return this.unsigned?this:Me(this.low,this.high,!0)},j.toBytes=function(r){return r?this.toBytesLE():this.toBytesBE()},j.toBytesLE=function(){var r=this.high,e=this.low;return[e&255,e>>>8&255,e>>>16&255,e>>>24,r&255,r>>>8&255,r>>>16&255,r>>>24]},j.toBytesBE=function(){var r=this.high,e=this.low;return[r>>>24,r>>>16&255,r>>>8&255,r&255,e>>>24,e>>>16&255,e>>>8&255,e&255]},Ge.fromBytes=function(r,e,n){return n?Ge.fromBytesLE(r,e):Ge.fromBytesBE(r,e)},Ge.fromBytesLE=function(r,e){return new Ge(r[0]|r[1]<<8|r[2]<<16|r[3]<<24,r[4]|r[5]<<8|r[6]<<16|r[7]<<24,e)},Ge.fromBytesBE=function(r,e){return new Ge(r[4]<<24|r[5]<<16|r[6]<<8|r[7],r[0]<<24|r[1]<<16|r[2]<<8|r[3],e)},po=Ge}),O,Rw=R(()=>{O={},O.Offset,O.Table,O.SIZEOF_SHORT=2,O.SIZEOF_INT=4,O.FILE_IDENTIFIER_LENGTH=4,O.SIZE_PREFIX_LENGTH=4,O.Encoding={UTF8_BYTES:1,UTF16_STRING:2},O.int32=new Int32Array(2),O.float32=new Float32Array(O.int32.buffer),O.float64=new Float64Array(O.int32.buffer),O.isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1,O.Long=function(r,e){this.low=r|0,this.high=e|0},O.Long.create=function(r,e){return r==0&&e==0?O.Long.ZERO:new O.Long(r,e)},O.Long.prototype.toFloat64=function(){return(this.low>>>0)+this.high*4294967296},O.Long.prototype.equals=function(r){return this.low==r.low&&this.high==r.high},O.Long.ZERO=new O.Long(0,0),O.Builder=function(r){if(r)var e=r;else var e=1024;this.bb=O.ByteBuffer.allocate(e),this.space=e,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},O.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},O.Builder.prototype.forceDefaults=function(r){this.force_defaults=r},O.Builder.prototype.dataBuffer=function(){return this.bb},O.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},O.Builder.prototype.prep=function(r,e){r>this.minalign&&(this.minalign=r);for(var n=~(this.bb.capacity()-this.space+e)+1&r-1;this.space<n+r+e;){var t=this.bb.capacity();this.bb=O.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-t}this.pad(n)},O.Builder.prototype.pad=function(r){for(var e=0;e<r;e++)this.bb.writeInt8(--this.space,0)},O.Builder.prototype.writeInt8=function(r){this.bb.writeInt8(this.space-=1,r)},O.Builder.prototype.writeInt16=function(r){this.bb.writeInt16(this.space-=2,r)},O.Builder.prototype.writeInt32=function(r){this.bb.writeInt32(this.space-=4,r)},O.Builder.prototype.writeInt64=function(r){this.bb.writeInt64(this.space-=8,r)},O.Builder.prototype.writeFloat32=function(r){this.bb.writeFloat32(this.space-=4,r)},O.Builder.prototype.writeFloat64=function(r){this.bb.writeFloat64(this.space-=8,r)},O.Builder.prototype.addInt8=function(r){this.prep(1,0),this.writeInt8(r)},O.Builder.prototype.addInt16=function(r){this.prep(2,0),this.writeInt16(r)},O.Builder.prototype.addInt32=function(r){this.prep(4,0),this.writeInt32(r)},O.Builder.prototype.addInt64=function(r){this.prep(8,0),this.writeInt64(r)},O.Builder.prototype.addFloat32=function(r){this.prep(4,0),this.writeFloat32(r)},O.Builder.prototype.addFloat64=function(r){this.prep(8,0),this.writeFloat64(r)},O.Builder.prototype.addFieldInt8=function(r,e,n){(this.force_defaults||e!=n)&&(this.addInt8(e),this.slot(r))},O.Builder.prototype.addFieldInt16=function(r,e,n){(this.force_defaults||e!=n)&&(this.addInt16(e),this.slot(r))},O.Builder.prototype.addFieldInt32=function(r,e,n){(this.force_defaults||e!=n)&&(this.addInt32(e),this.slot(r))},O.Builder.prototype.addFieldInt64=function(r,e,n){(this.force_defaults||!e.equals(n))&&(this.addInt64(e),this.slot(r))},O.Builder.prototype.addFieldFloat32=function(r,e,n){(this.force_defaults||e!=n)&&(this.addFloat32(e),this.slot(r))},O.Builder.prototype.addFieldFloat64=function(r,e,n){(this.force_defaults||e!=n)&&(this.addFloat64(e),this.slot(r))},O.Builder.prototype.addFieldOffset=function(r,e,n){(this.force_defaults||e!=n)&&(this.addOffset(e),this.slot(r))},O.Builder.prototype.addFieldStruct=function(r,e,n){e!=n&&(this.nested(e),this.slot(r))},O.Builder.prototype.nested=function(r){if(r!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},O.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},O.Builder.prototype.slot=function(r){this.vtable[r]=this.offset()},O.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},O.Builder.growByteBuffer=function(r){var e=r.capacity();if(e&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var n=e<<1,t=O.ByteBuffer.allocate(n);return t.setPosition(n-e),t.bytes().set(r.bytes(),n-e),t},O.Builder.prototype.addOffset=function(r){this.prep(O.SIZEOF_INT,0),this.writeInt32(this.offset()-r+O.SIZEOF_INT)},O.Builder.prototype.startObject=function(r){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=r;for(var e=0;e<r;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()},O.Builder.prototype.endObject=function(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var r=this.offset(),e=this.vtable_in_use-1;e>=0&&this.vtable[e]==0;e--);for(var n=e+1;e>=0;e--)this.addInt16(this.vtable[e]!=0?r-this.vtable[e]:0);var t=2;this.addInt16(r-this.object_start);var i=(n+t)*O.SIZEOF_SHORT;this.addInt16(i);var o=0,s=this.space;e:for(e=0;e<this.vtables.length;e++){var l=this.bb.capacity()-this.vtables[e];if(i==this.bb.readInt16(l)){for(var c=O.SIZEOF_SHORT;c<i;c+=O.SIZEOF_SHORT)if(this.bb.readInt16(s+c)!=this.bb.readInt16(l+c))continue e;o=this.vtables[e];break}}return o?(this.space=this.bb.capacity()-r,this.bb.writeInt32(this.space,o-r)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-r,this.offset()-r)),this.isNested=!1,r},O.Builder.prototype.finish=function(r,e,n){var t=n?O.SIZE_PREFIX_LENGTH:0;if(e){var i=e;if(this.prep(this.minalign,O.SIZEOF_INT+O.FILE_IDENTIFIER_LENGTH+t),i.length!=O.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+O.FILE_IDENTIFIER_LENGTH);for(var o=O.FILE_IDENTIFIER_LENGTH-1;o>=0;o--)this.writeInt8(i.charCodeAt(o))}this.prep(this.minalign,O.SIZEOF_INT+t),this.addOffset(r),t&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)},O.Builder.prototype.finishSizePrefixed=function(r,e){this.finish(r,e,!0)},O.Builder.prototype.requiredField=function(r,e){var n=this.bb.capacity()-r,t=n-this.bb.readInt32(n),i=this.bb.readInt16(t+e)!=0;if(!i)throw new Error("FlatBuffers: field "+e+" must be set")},O.Builder.prototype.startVector=function(r,e,n){this.notNested(),this.vector_num_elems=e,this.prep(O.SIZEOF_INT,r*e),this.prep(n,r*e)},O.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},O.Builder.prototype.createString=function(r){if(r instanceof Uint8Array)var e=r;else for(var e=[],n=0;n<r.length;){var t,i=r.charCodeAt(n++);if(i<55296||i>=56320)t=i;else{var o=r.charCodeAt(n++);t=(i<<10)+o+-56613888}t<128?e.push(t):(t<2048?e.push(t>>6&31|192):(t<65536?e.push(t>>12&15|224):e.push(t>>18&7|240,t>>12&63|128),e.push(t>>6&63|128)),e.push(t&63|128))}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(var n=0,s=this.space,l=this.bb.bytes();n<e.length;n++)l[s++]=e[n];return this.endVector()},O.Builder.prototype.createLong=function(r,e){return O.Long.create(r,e)},O.ByteBuffer=function(r){this.bytes_=r,this.position_=0},O.ByteBuffer.allocate=function(r){return new O.ByteBuffer(new Uint8Array(r))},O.ByteBuffer.prototype.clear=function(){this.position_=0},O.ByteBuffer.prototype.bytes=function(){return this.bytes_},O.ByteBuffer.prototype.position=function(){return this.position_},O.ByteBuffer.prototype.setPosition=function(r){this.position_=r},O.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},O.ByteBuffer.prototype.readInt8=function(r){return this.readUint8(r)<<24>>24},O.ByteBuffer.prototype.readUint8=function(r){return this.bytes_[r]},O.ByteBuffer.prototype.readInt16=function(r){return this.readUint16(r)<<16>>16},O.ByteBuffer.prototype.readUint16=function(r){return this.bytes_[r]|this.bytes_[r+1]<<8},O.ByteBuffer.prototype.readInt32=function(r){return this.bytes_[r]|this.bytes_[r+1]<<8|this.bytes_[r+2]<<16|this.bytes_[r+3]<<24},O.ByteBuffer.prototype.readUint32=function(r){return this.readInt32(r)>>>0},O.ByteBuffer.prototype.readInt64=function(r){return new O.Long(this.readInt32(r),this.readInt32(r+4))},O.ByteBuffer.prototype.readUint64=function(r){return new O.Long(this.readUint32(r),this.readUint32(r+4))},O.ByteBuffer.prototype.readFloat32=function(r){return O.int32[0]=this.readInt32(r),O.float32[0]},O.ByteBuffer.prototype.readFloat64=function(r){return O.int32[O.isLittleEndian?0:1]=this.readInt32(r),O.int32[O.isLittleEndian?1:0]=this.readInt32(r+4),O.float64[0]},O.ByteBuffer.prototype.writeInt8=function(r,e){this.bytes_[r]=e},O.ByteBuffer.prototype.writeUint8=function(r,e){this.bytes_[r]=e},O.ByteBuffer.prototype.writeInt16=function(r,e){this.bytes_[r]=e,this.bytes_[r+1]=e>>8},O.ByteBuffer.prototype.writeUint16=function(r,e){this.bytes_[r]=e,this.bytes_[r+1]=e>>8},O.ByteBuffer.prototype.writeInt32=function(r,e){this.bytes_[r]=e,this.bytes_[r+1]=e>>8,this.bytes_[r+2]=e>>16,this.bytes_[r+3]=e>>24},O.ByteBuffer.prototype.writeUint32=function(r,e){this.bytes_[r]=e,this.bytes_[r+1]=e>>8,this.bytes_[r+2]=e>>16,this.bytes_[r+3]=e>>24},O.ByteBuffer.prototype.writeInt64=function(r,e){this.writeInt32(r,e.low),this.writeInt32(r+4,e.high)},O.ByteBuffer.prototype.writeUint64=function(r,e){this.writeUint32(r,e.low),this.writeUint32(r+4,e.high)},O.ByteBuffer.prototype.writeFloat32=function(r,e){O.float32[0]=e,this.writeInt32(r,O.int32[0])},O.ByteBuffer.prototype.writeFloat64=function(r,e){O.float64[0]=e,this.writeInt32(r,O.int32[O.isLittleEndian?0:1]),this.writeInt32(r+4,O.int32[O.isLittleEndian?1:0])},O.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+O.SIZEOF_INT+O.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var r="",e=0;e<O.FILE_IDENTIFIER_LENGTH;e++)r+=String.fromCharCode(this.readInt8(this.position_+O.SIZEOF_INT+e));return r},O.ByteBuffer.prototype.__offset=function(r,e){var n=r-this.readInt32(r);return e<this.readInt16(n)?this.readInt16(n+e):0},O.ByteBuffer.prototype.__union=function(r,e){return r.bb_pos=e+this.readInt32(e),r.bb=this,r},O.ByteBuffer.prototype.__string=function(r,e){r+=this.readInt32(r);var n=this.readInt32(r),t="",i=0;if(r+=O.SIZEOF_INT,e===O.Encoding.UTF8_BYTES)return this.bytes_.subarray(r,r+n);for(;i<n;){var o,s=this.readUint8(r+i++);if(s<192)o=s;else{var l=this.readUint8(r+i++);if(s<224)o=(s&31)<<6|l&63;else{var c=this.readUint8(r+i++);if(s<240)o=(s&15)<<12|(l&63)<<6|c&63;else{var a=this.readUint8(r+i++);o=(s&7)<<18|(l&63)<<12|(c&63)<<6|a&63}}}o<65536?t+=String.fromCharCode(o):(o-=65536,t+=String.fromCharCode((o>>10)+55296,(o&1023)+56320))}return t},O.ByteBuffer.prototype.__indirect=function(r){return r+this.readInt32(r)},O.ByteBuffer.prototype.__vector=function(r){return r+this.readInt32(r)+O.SIZEOF_INT},O.ByteBuffer.prototype.__vector_len=function(r){return this.readInt32(r+this.readInt32(r))},O.ByteBuffer.prototype.__has_identifier=function(r){if(r.length!=O.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+O.FILE_IDENTIFIER_LENGTH);for(var e=0;e<O.FILE_IDENTIFIER_LENGTH;e++)if(r.charCodeAt(e)!=this.readInt8(this.position_+O.SIZEOF_INT+e))return!1;return!0},O.ByteBuffer.prototype.createLong=function(r,e){return O.Long.create(r,e)}}),Be,kp=R(()=>{"use strict";Rw(),(r=>{let e;(n=>{let t;(i=>{let o;(s=>(s[s.UNDEFINED=0]="UNDEFINED",s[s.FLOAT=1]="FLOAT",s[s.INT=2]="INT",s[s.STRING=3]="STRING",s[s.TENSOR=4]="TENSOR",s[s.GRAPH=5]="GRAPH",s[s.FLOATS=6]="FLOATS",s[s.INTS=7]="INTS",s[s.STRINGS=8]="STRINGS",s[s.TENSORS=9]="TENSORS",s[s.GRAPHS=10]="GRAPHS",s[s.SPARSE_TENSOR=11]="SPARSE_TENSOR",s[s.SPARSE_TENSORS=12]="SPARSE_TENSORS"))(o=i.AttributeType||={})})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{let o;(s=>(s[s.UNKNOWN=0]="UNKNOWN",s[s.VALUE=1]="VALUE",s[s.PARAM=2]="PARAM"))(o=i.DimensionValueType||={})})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{let o;(s=>(s[s.UNDEFINED=0]="UNDEFINED",s[s.FLOAT=1]="FLOAT",s[s.UINT8=2]="UINT8",s[s.INT8=3]="INT8",s[s.UINT16=4]="UINT16",s[s.INT16=5]="INT16",s[s.INT32=6]="INT32",s[s.INT64=7]="INT64",s[s.STRING=8]="STRING",s[s.BOOL=9]="BOOL",s[s.FLOAT16=10]="FLOAT16",s[s.DOUBLE=11]="DOUBLE",s[s.UINT32=12]="UINT32",s[s.UINT64=13]="UINT64",s[s.COMPLEX64=14]="COMPLEX64",s[s.COMPLEX128=15]="COMPLEX128",s[s.BFLOAT16=16]="BFLOAT16",s[s.FLOAT8E4M3FN=17]="FLOAT8E4M3FN",s[s.FLOAT8E4M3FNUZ=18]="FLOAT8E4M3FNUZ",s[s.FLOAT8E5M2=19]="FLOAT8E5M2",s[s.FLOAT8E5M2FNUZ=20]="FLOAT8E5M2FNUZ"))(o=i.TensorDataType||={})})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{let o;(s=>(s[s.Primitive=0]="Primitive",s[s.Fused=1]="Fused"))(o=i.NodeType||={})})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{let o;(s=>(s[s.NONE=0]="NONE",s[s.tensor_type=1]="tensor_type",s[s.sequence_type=2]="sequence_type",s[s.map_type=3]="map_type"))(o=i.TypeInfoValue||={})})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsShape(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsShape(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}dim(l,c){let a=this.bb.__offset(this.bb_pos,4);return a?(c||new r.experimental.fbs.Dimension).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+a)+l*4),this.bb):null}dimLength(){let l=this.bb.__offset(this.bb_pos,4);return l?this.bb.__vector_len(this.bb_pos+l):0}static startShape(l){l.startObject(1)}static addDim(l,c){l.addFieldOffset(0,c,0)}static createDimVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startDimVector(l,c){l.startVector(4,c,4)}static endShape(l){return l.endObject()}static createShape(l,c){return o.startShape(l),o.addDim(l,c),o.endShape(l)}}i.Shape=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsDimension(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsDimension(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}value(l){let c=this.bb.__offset(this.bb_pos,4);return c?(l||new r.experimental.fbs.DimensionValue).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}denotation(l){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,l):null}static startDimension(l){l.startObject(2)}static addValue(l,c){l.addFieldOffset(0,c,0)}static addDenotation(l,c){l.addFieldOffset(1,c,0)}static endDimension(l){return l.endObject()}static createDimension(l,c,a){return o.startDimension(l),o.addValue(l,c),o.addDenotation(l,a),o.endDimension(l)}}i.Dimension=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsDimensionValue(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsDimensionValue(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}dimType(){let l=this.bb.__offset(this.bb_pos,4);return l?this.bb.readInt8(this.bb_pos+l):0}dimValue(){let l=this.bb.__offset(this.bb_pos,6);return l?this.bb.readInt64(this.bb_pos+l):this.bb.createLong(0,0)}dimParam(l){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.__string(this.bb_pos+c,l):null}static startDimensionValue(l){l.startObject(3)}static addDimType(l,c){l.addFieldInt8(0,c,0)}static addDimValue(l,c){l.addFieldInt64(1,c,l.createLong(0,0))}static addDimParam(l,c){l.addFieldOffset(2,c,0)}static endDimensionValue(l){return l.endObject()}static createDimensionValue(l,c,a,u){return o.startDimensionValue(l),o.addDimType(l,c),o.addDimValue(l,a),o.addDimParam(l,u),o.endDimensionValue(l)}}i.DimensionValue=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsTensorTypeAndShape(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsTensorTypeAndShape(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}elemType(){let l=this.bb.__offset(this.bb_pos,4);return l?this.bb.readInt32(this.bb_pos+l):0}shape(l){let c=this.bb.__offset(this.bb_pos,6);return c?(l||new r.experimental.fbs.Shape).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startTensorTypeAndShape(l){l.startObject(2)}static addElemType(l,c){l.addFieldInt32(0,c,0)}static addShape(l,c){l.addFieldOffset(1,c,0)}static endTensorTypeAndShape(l){return l.endObject()}static createTensorTypeAndShape(l,c,a){return o.startTensorTypeAndShape(l),o.addElemType(l,c),o.addShape(l,a),o.endTensorTypeAndShape(l)}}i.TensorTypeAndShape=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsMapType(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsMapType(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}keyType(){let l=this.bb.__offset(this.bb_pos,4);return l?this.bb.readInt32(this.bb_pos+l):0}valueType(l){let c=this.bb.__offset(this.bb_pos,6);return c?(l||new r.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startMapType(l){l.startObject(2)}static addKeyType(l,c){l.addFieldInt32(0,c,0)}static addValueType(l,c){l.addFieldOffset(1,c,0)}static endMapType(l){return l.endObject()}static createMapType(l,c,a){return o.startMapType(l),o.addKeyType(l,c),o.addValueType(l,a),o.endMapType(l)}}i.MapType=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsSequenceType(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsSequenceType(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}elemType(l){let c=this.bb.__offset(this.bb_pos,4);return c?(l||new r.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startSequenceType(l){l.startObject(1)}static addElemType(l,c){l.addFieldOffset(0,c,0)}static endSequenceType(l){return l.endObject()}static createSequenceType(l,c){return o.startSequenceType(l),o.addElemType(l,c),o.endSequenceType(l)}}i.SequenceType=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}nodeIndex(){return this.bb.readUint32(this.bb_pos)}srcArgIndex(){return this.bb.readInt32(this.bb_pos+4)}dstArgIndex(){return this.bb.readInt32(this.bb_pos+8)}static createEdgeEnd(l,c,a,u){return l.prep(4,12),l.writeInt32(u),l.writeInt32(a),l.writeInt32(c),l.offset()}}i.EdgeEnd=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsNodeEdge(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsNodeEdge(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}nodeIndex(){let l=this.bb.__offset(this.bb_pos,4);return l?this.bb.readUint32(this.bb_pos+l):0}inputEdges(l,c){let a=this.bb.__offset(this.bb_pos,6);return a?(c||new r.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+a)+l*12,this.bb):null}inputEdgesLength(){let l=this.bb.__offset(this.bb_pos,6);return l?this.bb.__vector_len(this.bb_pos+l):0}outputEdges(l,c){let a=this.bb.__offset(this.bb_pos,8);return a?(c||new r.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+a)+l*12,this.bb):null}outputEdgesLength(){let l=this.bb.__offset(this.bb_pos,8);return l?this.bb.__vector_len(this.bb_pos+l):0}static startNodeEdge(l){l.startObject(3)}static addNodeIndex(l,c){l.addFieldInt32(0,c,0)}static addInputEdges(l,c){l.addFieldOffset(1,c,0)}static startInputEdgesVector(l,c){l.startVector(12,c,4)}static addOutputEdges(l,c){l.addFieldOffset(2,c,0)}static startOutputEdgesVector(l,c){l.startVector(12,c,4)}static endNodeEdge(l){return l.endObject()}static createNodeEdge(l,c,a,u){return o.startNodeEdge(l),o.addNodeIndex(l,c),o.addInputEdges(l,a),o.addOutputEdges(l,u),o.endNodeEdge(l)}}i.NodeEdge=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsNode(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsNode(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}name(l){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,l):null}docString(l){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,l):null}domain(l){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.__string(this.bb_pos+c,l):null}sinceVersion(){let l=this.bb.__offset(this.bb_pos,10);return l?this.bb.readInt32(this.bb_pos+l):0}index(){let l=this.bb.__offset(this.bb_pos,12);return l?this.bb.readUint32(this.bb_pos+l):0}opType(l){let c=this.bb.__offset(this.bb_pos,14);return c?this.bb.__string(this.bb_pos+c,l):null}type(){let l=this.bb.__offset(this.bb_pos,16);return l?this.bb.readInt32(this.bb_pos+l):0}executionProviderType(l){let c=this.bb.__offset(this.bb_pos,18);return c?this.bb.__string(this.bb_pos+c,l):null}inputs(l,c){let a=this.bb.__offset(this.bb_pos,20);return a?this.bb.__string(this.bb.__vector(this.bb_pos+a)+l*4,c):null}inputsLength(){let l=this.bb.__offset(this.bb_pos,20);return l?this.bb.__vector_len(this.bb_pos+l):0}outputs(l,c){let a=this.bb.__offset(this.bb_pos,22);return a?this.bb.__string(this.bb.__vector(this.bb_pos+a)+l*4,c):null}outputsLength(){let l=this.bb.__offset(this.bb_pos,22);return l?this.bb.__vector_len(this.bb_pos+l):0}attributes(l,c){let a=this.bb.__offset(this.bb_pos,24);return a?(c||new r.experimental.fbs.Attribute).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+a)+l*4),this.bb):null}attributesLength(){let l=this.bb.__offset(this.bb_pos,24);return l?this.bb.__vector_len(this.bb_pos+l):0}inputArgCounts(l){let c=this.bb.__offset(this.bb_pos,26);return c?this.bb.readInt32(this.bb.__vector(this.bb_pos+c)+l*4):0}inputArgCountsLength(){let l=this.bb.__offset(this.bb_pos,26);return l?this.bb.__vector_len(this.bb_pos+l):0}inputArgCountsArray(){let l=this.bb.__offset(this.bb_pos,26);return l?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+l),this.bb.__vector_len(this.bb_pos+l)):null}implicitInputs(l,c){let a=this.bb.__offset(this.bb_pos,28);return a?this.bb.__string(this.bb.__vector(this.bb_pos+a)+l*4,c):null}implicitInputsLength(){let l=this.bb.__offset(this.bb_pos,28);return l?this.bb.__vector_len(this.bb_pos+l):0}static startNode(l){l.startObject(13)}static addName(l,c){l.addFieldOffset(0,c,0)}static addDocString(l,c){l.addFieldOffset(1,c,0)}static addDomain(l,c){l.addFieldOffset(2,c,0)}static addSinceVersion(l,c){l.addFieldInt32(3,c,0)}static addIndex(l,c){l.addFieldInt32(4,c,0)}static addOpType(l,c){l.addFieldOffset(5,c,0)}static addType(l,c){l.addFieldInt32(6,c,0)}static addExecutionProviderType(l,c){l.addFieldOffset(7,c,0)}static addInputs(l,c){l.addFieldOffset(8,c,0)}static createInputsVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startInputsVector(l,c){l.startVector(4,c,4)}static addOutputs(l,c){l.addFieldOffset(9,c,0)}static createOutputsVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startOutputsVector(l,c){l.startVector(4,c,4)}static addAttributes(l,c){l.addFieldOffset(10,c,0)}static createAttributesVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startAttributesVector(l,c){l.startVector(4,c,4)}static addInputArgCounts(l,c){l.addFieldOffset(11,c,0)}static createInputArgCountsVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addInt32(c[a]);return l.endVector()}static startInputArgCountsVector(l,c){l.startVector(4,c,4)}static addImplicitInputs(l,c){l.addFieldOffset(12,c,0)}static createImplicitInputsVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startImplicitInputsVector(l,c){l.startVector(4,c,4)}static endNode(l){return l.endObject()}static createNode(l,c,a,u,d,h,f,p,g,y,w,v,x,A){return o.startNode(l),o.addName(l,c),o.addDocString(l,a),o.addDomain(l,u),o.addSinceVersion(l,d),o.addIndex(l,h),o.addOpType(l,f),o.addType(l,p),o.addExecutionProviderType(l,g),o.addInputs(l,y),o.addOutputs(l,w),o.addAttributes(l,v),o.addInputArgCounts(l,x),o.addImplicitInputs(l,A),o.endNode(l)}}i.Node=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsValueInfo(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsValueInfo(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}name(l){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,l):null}docString(l){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,l):null}type(l){let c=this.bb.__offset(this.bb_pos,8);return c?(l||new r.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startValueInfo(l){l.startObject(3)}static addName(l,c){l.addFieldOffset(0,c,0)}static addDocString(l,c){l.addFieldOffset(1,c,0)}static addType(l,c){l.addFieldOffset(2,c,0)}static endValueInfo(l){return l.endObject()}static createValueInfo(l,c,a,u){return o.startValueInfo(l),o.addName(l,c),o.addDocString(l,a),o.addType(l,u),o.endValueInfo(l)}}i.ValueInfo=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsTypeInfo(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsTypeInfo(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}denotation(l){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,l):null}valueType(){let l=this.bb.__offset(this.bb_pos,6);return l?this.bb.readUint8(this.bb_pos+l):0}value(l){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.__union(l,this.bb_pos+c):null}static startTypeInfo(l){l.startObject(3)}static addDenotation(l,c){l.addFieldOffset(0,c,0)}static addValueType(l,c){l.addFieldInt8(1,c,0)}static addValue(l,c){l.addFieldOffset(2,c,0)}static endTypeInfo(l){return l.endObject()}static createTypeInfo(l,c,a,u){return o.startTypeInfo(l),o.addDenotation(l,c),o.addValueType(l,a),o.addValue(l,u),o.endTypeInfo(l)}}i.TypeInfo=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsOperatorSetId(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsOperatorSetId(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}domain(l){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,l):null}version(){let l=this.bb.__offset(this.bb_pos,6);return l?this.bb.readInt64(this.bb_pos+l):this.bb.createLong(0,0)}static startOperatorSetId(l){l.startObject(2)}static addDomain(l,c){l.addFieldOffset(0,c,0)}static addVersion(l,c){l.addFieldInt64(1,c,l.createLong(0,0))}static endOperatorSetId(l){return l.endObject()}static createOperatorSetId(l,c,a){return o.startOperatorSetId(l),o.addDomain(l,c),o.addVersion(l,a),o.endOperatorSetId(l)}}i.OperatorSetId=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsTensor(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsTensor(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}name(l){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,l):null}docString(l){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,l):null}dims(l){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.readInt64(this.bb.__vector(this.bb_pos+c)+l*8):this.bb.createLong(0,0)}dimsLength(){let l=this.bb.__offset(this.bb_pos,8);return l?this.bb.__vector_len(this.bb_pos+l):0}dataType(){let l=this.bb.__offset(this.bb_pos,10);return l?this.bb.readInt32(this.bb_pos+l):0}rawData(l){let c=this.bb.__offset(this.bb_pos,12);return c?this.bb.readUint8(this.bb.__vector(this.bb_pos+c)+l):0}rawDataLength(){let l=this.bb.__offset(this.bb_pos,12);return l?this.bb.__vector_len(this.bb_pos+l):0}rawDataArray(){let l=this.bb.__offset(this.bb_pos,12);return l?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+l),this.bb.__vector_len(this.bb_pos+l)):null}stringData(l,c){let a=this.bb.__offset(this.bb_pos,14);return a?this.bb.__string(this.bb.__vector(this.bb_pos+a)+l*4,c):null}stringDataLength(){let l=this.bb.__offset(this.bb_pos,14);return l?this.bb.__vector_len(this.bb_pos+l):0}static startTensor(l){l.startObject(6)}static addName(l,c){l.addFieldOffset(0,c,0)}static addDocString(l,c){l.addFieldOffset(1,c,0)}static addDims(l,c){l.addFieldOffset(2,c,0)}static createDimsVector(l,c){l.startVector(8,c.length,8);for(let a=c.length-1;a>=0;a--)l.addInt64(c[a]);return l.endVector()}static startDimsVector(l,c){l.startVector(8,c,8)}static addDataType(l,c){l.addFieldInt32(3,c,0)}static addRawData(l,c){l.addFieldOffset(4,c,0)}static createRawDataVector(l,c){l.startVector(1,c.length,1);for(let a=c.length-1;a>=0;a--)l.addInt8(c[a]);return l.endVector()}static startRawDataVector(l,c){l.startVector(1,c,1)}static addStringData(l,c){l.addFieldOffset(5,c,0)}static createStringDataVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startStringDataVector(l,c){l.startVector(4,c,4)}static endTensor(l){return l.endObject()}static createTensor(l,c,a,u,d,h,f){return o.startTensor(l),o.addName(l,c),o.addDocString(l,a),o.addDims(l,u),o.addDataType(l,d),o.addRawData(l,h),o.addStringData(l,f),o.endTensor(l)}}i.Tensor=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsSparseTensor(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsSparseTensor(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}values(l){let c=this.bb.__offset(this.bb_pos,4);return c?(l||new r.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}indices(l){let c=this.bb.__offset(this.bb_pos,6);return c?(l||new r.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}dims(l){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.readInt64(this.bb.__vector(this.bb_pos+c)+l*8):this.bb.createLong(0,0)}dimsLength(){let l=this.bb.__offset(this.bb_pos,8);return l?this.bb.__vector_len(this.bb_pos+l):0}static startSparseTensor(l){l.startObject(3)}static addValues(l,c){l.addFieldOffset(0,c,0)}static addIndices(l,c){l.addFieldOffset(1,c,0)}static addDims(l,c){l.addFieldOffset(2,c,0)}static createDimsVector(l,c){l.startVector(8,c.length,8);for(let a=c.length-1;a>=0;a--)l.addInt64(c[a]);return l.endVector()}static startDimsVector(l,c){l.startVector(8,c,8)}static endSparseTensor(l){return l.endObject()}static createSparseTensor(l,c,a,u){return o.startSparseTensor(l),o.addValues(l,c),o.addIndices(l,a),o.addDims(l,u),o.endSparseTensor(l)}}i.SparseTensor=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsAttribute(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsAttribute(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}name(l){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,l):null}docString(l){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,l):null}type(){let l=this.bb.__offset(this.bb_pos,8);return l?this.bb.readInt32(this.bb_pos+l):0}f(){let l=this.bb.__offset(this.bb_pos,10);return l?this.bb.readFloat32(this.bb_pos+l):0}i(){let l=this.bb.__offset(this.bb_pos,12);return l?this.bb.readInt64(this.bb_pos+l):this.bb.createLong(0,0)}s(l){let c=this.bb.__offset(this.bb_pos,14);return c?this.bb.__string(this.bb_pos+c,l):null}t(l){let c=this.bb.__offset(this.bb_pos,16);return c?(l||new r.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}g(l){let c=this.bb.__offset(this.bb_pos,18);return c?(l||new r.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}floats(l){let c=this.bb.__offset(this.bb_pos,20);return c?this.bb.readFloat32(this.bb.__vector(this.bb_pos+c)+l*4):0}floatsLength(){let l=this.bb.__offset(this.bb_pos,20);return l?this.bb.__vector_len(this.bb_pos+l):0}floatsArray(){let l=this.bb.__offset(this.bb_pos,20);return l?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+l),this.bb.__vector_len(this.bb_pos+l)):null}ints(l){let c=this.bb.__offset(this.bb_pos,22);return c?this.bb.readInt64(this.bb.__vector(this.bb_pos+c)+l*8):this.bb.createLong(0,0)}intsLength(){let l=this.bb.__offset(this.bb_pos,22);return l?this.bb.__vector_len(this.bb_pos+l):0}strings(l,c){let a=this.bb.__offset(this.bb_pos,24);return a?this.bb.__string(this.bb.__vector(this.bb_pos+a)+l*4,c):null}stringsLength(){let l=this.bb.__offset(this.bb_pos,24);return l?this.bb.__vector_len(this.bb_pos+l):0}tensors(l,c){let a=this.bb.__offset(this.bb_pos,26);return a?(c||new r.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+a)+l*4),this.bb):null}tensorsLength(){let l=this.bb.__offset(this.bb_pos,26);return l?this.bb.__vector_len(this.bb_pos+l):0}graphs(l,c){let a=this.bb.__offset(this.bb_pos,28);return a?(c||new r.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+a)+l*4),this.bb):null}graphsLength(){let l=this.bb.__offset(this.bb_pos,28);return l?this.bb.__vector_len(this.bb_pos+l):0}static startAttribute(l){l.startObject(13)}static addName(l,c){l.addFieldOffset(0,c,0)}static addDocString(l,c){l.addFieldOffset(1,c,0)}static addType(l,c){l.addFieldInt32(2,c,0)}static addF(l,c){l.addFieldFloat32(3,c,0)}static addI(l,c){l.addFieldInt64(4,c,l.createLong(0,0))}static addS(l,c){l.addFieldOffset(5,c,0)}static addT(l,c){l.addFieldOffset(6,c,0)}static addG(l,c){l.addFieldOffset(7,c,0)}static addFloats(l,c){l.addFieldOffset(8,c,0)}static createFloatsVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addFloat32(c[a]);return l.endVector()}static startFloatsVector(l,c){l.startVector(4,c,4)}static addInts(l,c){l.addFieldOffset(9,c,0)}static createIntsVector(l,c){l.startVector(8,c.length,8);for(let a=c.length-1;a>=0;a--)l.addInt64(c[a]);return l.endVector()}static startIntsVector(l,c){l.startVector(8,c,8)}static addStrings(l,c){l.addFieldOffset(10,c,0)}static createStringsVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startStringsVector(l,c){l.startVector(4,c,4)}static addTensors(l,c){l.addFieldOffset(11,c,0)}static createTensorsVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startTensorsVector(l,c){l.startVector(4,c,4)}static addGraphs(l,c){l.addFieldOffset(12,c,0)}static createGraphsVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startGraphsVector(l,c){l.startVector(4,c,4)}static endAttribute(l){return l.endObject()}static createAttribute(l,c,a,u,d,h,f,p,g,y,w,v,x,A){return o.startAttribute(l),o.addName(l,c),o.addDocString(l,a),o.addType(l,u),o.addF(l,d),o.addI(l,h),o.addS(l,f),o.addT(l,p),o.addG(l,g),o.addFloats(l,y),o.addInts(l,w),o.addStrings(l,v),o.addTensors(l,x),o.addGraphs(l,A),o.endAttribute(l)}}i.Attribute=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsGraph(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsGraph(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}initializers(l,c){let a=this.bb.__offset(this.bb_pos,4);return a?(c||new r.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+a)+l*4),this.bb):null}initializersLength(){let l=this.bb.__offset(this.bb_pos,4);return l?this.bb.__vector_len(this.bb_pos+l):0}nodeArgs(l,c){let a=this.bb.__offset(this.bb_pos,6);return a?(c||new r.experimental.fbs.ValueInfo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+a)+l*4),this.bb):null}nodeArgsLength(){let l=this.bb.__offset(this.bb_pos,6);return l?this.bb.__vector_len(this.bb_pos+l):0}nodes(l,c){let a=this.bb.__offset(this.bb_pos,8);return a?(c||new r.experimental.fbs.Node).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+a)+l*4),this.bb):null}nodesLength(){let l=this.bb.__offset(this.bb_pos,8);return l?this.bb.__vector_len(this.bb_pos+l):0}maxNodeIndex(){let l=this.bb.__offset(this.bb_pos,10);return l?this.bb.readUint32(this.bb_pos+l):0}nodeEdges(l,c){let a=this.bb.__offset(this.bb_pos,12);return a?(c||new r.experimental.fbs.NodeEdge).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+a)+l*4),this.bb):null}nodeEdgesLength(){let l=this.bb.__offset(this.bb_pos,12);return l?this.bb.__vector_len(this.bb_pos+l):0}inputs(l,c){let a=this.bb.__offset(this.bb_pos,14);return a?this.bb.__string(this.bb.__vector(this.bb_pos+a)+l*4,c):null}inputsLength(){let l=this.bb.__offset(this.bb_pos,14);return l?this.bb.__vector_len(this.bb_pos+l):0}outputs(l,c){let a=this.bb.__offset(this.bb_pos,16);return a?this.bb.__string(this.bb.__vector(this.bb_pos+a)+l*4,c):null}outputsLength(){let l=this.bb.__offset(this.bb_pos,16);return l?this.bb.__vector_len(this.bb_pos+l):0}sparseInitializers(l,c){let a=this.bb.__offset(this.bb_pos,18);return a?(c||new r.experimental.fbs.SparseTensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+a)+l*4),this.bb):null}sparseInitializersLength(){let l=this.bb.__offset(this.bb_pos,18);return l?this.bb.__vector_len(this.bb_pos+l):0}static startGraph(l){l.startObject(8)}static addInitializers(l,c){l.addFieldOffset(0,c,0)}static createInitializersVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startInitializersVector(l,c){l.startVector(4,c,4)}static addNodeArgs(l,c){l.addFieldOffset(1,c,0)}static createNodeArgsVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startNodeArgsVector(l,c){l.startVector(4,c,4)}static addNodes(l,c){l.addFieldOffset(2,c,0)}static createNodesVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startNodesVector(l,c){l.startVector(4,c,4)}static addMaxNodeIndex(l,c){l.addFieldInt32(3,c,0)}static addNodeEdges(l,c){l.addFieldOffset(4,c,0)}static createNodeEdgesVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startNodeEdgesVector(l,c){l.startVector(4,c,4)}static addInputs(l,c){l.addFieldOffset(5,c,0)}static createInputsVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startInputsVector(l,c){l.startVector(4,c,4)}static addOutputs(l,c){l.addFieldOffset(6,c,0)}static createOutputsVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startOutputsVector(l,c){l.startVector(4,c,4)}static addSparseInitializers(l,c){l.addFieldOffset(7,c,0)}static createSparseInitializersVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startSparseInitializersVector(l,c){l.startVector(4,c,4)}static endGraph(l){return l.endObject()}static createGraph(l,c,a,u,d,h,f,p,g){return o.startGraph(l),o.addInitializers(l,c),o.addNodeArgs(l,a),o.addNodes(l,u),o.addMaxNodeIndex(l,d),o.addNodeEdges(l,h),o.addInputs(l,f),o.addOutputs(l,p),o.addSparseInitializers(l,g),o.endGraph(l)}}i.Graph=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsModel(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsModel(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}irVersion(){let l=this.bb.__offset(this.bb_pos,4);return l?this.bb.readInt64(this.bb_pos+l):this.bb.createLong(0,0)}opsetImport(l,c){let a=this.bb.__offset(this.bb_pos,6);return a?(c||new r.experimental.fbs.OperatorSetId).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+a)+l*4),this.bb):null}opsetImportLength(){let l=this.bb.__offset(this.bb_pos,6);return l?this.bb.__vector_len(this.bb_pos+l):0}producerName(l){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.__string(this.bb_pos+c,l):null}producerVersion(l){let c=this.bb.__offset(this.bb_pos,10);return c?this.bb.__string(this.bb_pos+c,l):null}domain(l){let c=this.bb.__offset(this.bb_pos,12);return c?this.bb.__string(this.bb_pos+c,l):null}modelVersion(){let l=this.bb.__offset(this.bb_pos,14);return l?this.bb.readInt64(this.bb_pos+l):this.bb.createLong(0,0)}docString(l){let c=this.bb.__offset(this.bb_pos,16);return c?this.bb.__string(this.bb_pos+c,l):null}graph(l){let c=this.bb.__offset(this.bb_pos,18);return c?(l||new r.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}graphDocString(l){let c=this.bb.__offset(this.bb_pos,20);return c?this.bb.__string(this.bb_pos+c,l):null}static startModel(l){l.startObject(9)}static addIrVersion(l,c){l.addFieldInt64(0,c,l.createLong(0,0))}static addOpsetImport(l,c){l.addFieldOffset(1,c,0)}static createOpsetImportVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startOpsetImportVector(l,c){l.startVector(4,c,4)}static addProducerName(l,c){l.addFieldOffset(2,c,0)}static addProducerVersion(l,c){l.addFieldOffset(3,c,0)}static addDomain(l,c){l.addFieldOffset(4,c,0)}static addModelVersion(l,c){l.addFieldInt64(5,c,l.createLong(0,0))}static addDocString(l,c){l.addFieldOffset(6,c,0)}static addGraph(l,c){l.addFieldOffset(7,c,0)}static addGraphDocString(l,c){l.addFieldOffset(8,c,0)}static endModel(l){return l.endObject()}static createModel(l,c,a,u,d,h,f,p,g,y){return o.startModel(l),o.addIrVersion(l,c),o.addOpsetImport(l,a),o.addProducerName(l,u),o.addProducerVersion(l,d),o.addDomain(l,h),o.addModelVersion(l,f),o.addDocString(l,p),o.addGraph(l,g),o.addGraphDocString(l,y),o.endModel(l)}}i.Model=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsKernelCreateInfos(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsKernelCreateInfos(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}nodeIndices(l){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.readUint32(this.bb.__vector(this.bb_pos+c)+l*4):0}nodeIndicesLength(){let l=this.bb.__offset(this.bb_pos,4);return l?this.bb.__vector_len(this.bb_pos+l):0}nodeIndicesArray(){let l=this.bb.__offset(this.bb_pos,4);return l?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+l),this.bb.__vector_len(this.bb_pos+l)):null}kernelDefHashes(l){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.readUint64(this.bb.__vector(this.bb_pos+c)+l*8):this.bb.createLong(0,0)}kernelDefHashesLength(){let l=this.bb.__offset(this.bb_pos,6);return l?this.bb.__vector_len(this.bb_pos+l):0}static startKernelCreateInfos(l){l.startObject(2)}static addNodeIndices(l,c){l.addFieldOffset(0,c,0)}static createNodeIndicesVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addInt32(c[a]);return l.endVector()}static startNodeIndicesVector(l,c){l.startVector(4,c,4)}static addKernelDefHashes(l,c){l.addFieldOffset(1,c,0)}static createKernelDefHashesVector(l,c){l.startVector(8,c.length,8);for(let a=c.length-1;a>=0;a--)l.addInt64(c[a]);return l.endVector()}static startKernelDefHashesVector(l,c){l.startVector(8,c,8)}static endKernelCreateInfos(l){return l.endObject()}static createKernelCreateInfos(l,c,a){return o.startKernelCreateInfos(l),o.addNodeIndices(l,c),o.addKernelDefHashes(l,a),o.endKernelCreateInfos(l)}}i.KernelCreateInfos=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsSubGraphSessionState(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsSubGraphSessionState(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}graphId(l){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,l):null}sessionState(l){let c=this.bb.__offset(this.bb_pos,6);return c?(l||new r.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startSubGraphSessionState(l){l.startObject(2)}static addGraphId(l,c){l.addFieldOffset(0,c,0)}static addSessionState(l,c){l.addFieldOffset(1,c,0)}static endSubGraphSessionState(l){let c=l.endObject();return l.requiredField(c,4),c}static createSubGraphSessionState(l,c,a){return o.startSubGraphSessionState(l),o.addGraphId(l,c),o.addSessionState(l,a),o.endSubGraphSessionState(l)}}i.SubGraphSessionState=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsSessionState(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsSessionState(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}kernels(l){let c=this.bb.__offset(this.bb_pos,4);return c?(l||new r.experimental.fbs.KernelCreateInfos).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}subGraphSessionStates(l,c){let a=this.bb.__offset(this.bb_pos,6);return a?(c||new r.experimental.fbs.SubGraphSessionState).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+a)+l*4),this.bb):null}subGraphSessionStatesLength(){let l=this.bb.__offset(this.bb_pos,6);return l?this.bb.__vector_len(this.bb_pos+l):0}static startSessionState(l){l.startObject(2)}static addKernels(l,c){l.addFieldOffset(0,c,0)}static addSubGraphSessionStates(l,c){l.addFieldOffset(1,c,0)}static createSubGraphSessionStatesVector(l,c){l.startVector(4,c.length,4);for(let a=c.length-1;a>=0;a--)l.addOffset(c[a]);return l.endVector()}static startSubGraphSessionStatesVector(l,c){l.startVector(4,c,4)}static endSessionState(l){return l.endObject()}static createSessionState(l,c,a){return o.startSessionState(l),o.addKernels(l,c),o.addSubGraphSessionStates(l,a),o.endSessionState(l)}}i.SessionState=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={}),(r=>{let e;(n=>{let t;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(l,c){return this.bb_pos=l,this.bb=c,this}static getRootAsInferenceSession(l,c){return(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static getSizePrefixedRootAsInferenceSession(l,c){return l.setPosition(l.position()+O.SIZE_PREFIX_LENGTH),(c||new o).__init(l.readInt32(l.position())+l.position(),l)}static bufferHasIdentifier(l){return l.__has_identifier("ORTM")}ortVersion(l){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,l):null}model(l){let c=this.bb.__offset(this.bb_pos,6);return c?(l||new r.experimental.fbs.Model).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}sessionState(l){let c=this.bb.__offset(this.bb_pos,8);return c?(l||new r.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startInferenceSession(l){l.startObject(3)}static addOrtVersion(l,c){l.addFieldOffset(0,c,0)}static addModel(l,c){l.addFieldOffset(1,c,0)}static addSessionState(l,c){l.addFieldOffset(2,c,0)}static endInferenceSession(l){return l.endObject()}static finishInferenceSessionBuffer(l,c){l.finish(c,"ORTM")}static finishSizePrefixedInferenceSessionBuffer(l,c){l.finish(c,"ORTM",!0)}static createInferenceSession(l,c,a,u){return o.startInferenceSession(l),o.addOrtVersion(l,c),o.addModel(l,a),o.addSessionState(l,u),o.endInferenceSession(l)}}i.InferenceSession=o})(t=n.fbs||={})})(e=r.experimental||={})})(Be||={})}),v8=Tt((r,e)=>{"use strict";e.exports=n;function n(t,i){for(var o=new Array(arguments.length-1),s=0,l=2,c=!0;l<arguments.length;)o[s++]=arguments[l++];return new Promise(function(a,u){o[s]=function(d){if(c)if(c=!1,d)u(d);else{for(var h=new Array(arguments.length-1),f=0;f<h.length;)h[f++]=arguments[f];a.apply(null,h)}};try{t.apply(i||null,o)}catch(d){c&&(c=!1,u(d))}})}}),b8=Tt(r=>{"use strict";var e=r;e.length=function(s){var l=s.length;if(!l)return 0;for(var c=0;--l%4>1&&s.charAt(l)==="=";)++c;return Math.ceil(s.length*3)/4-c};var n=new Array(64),t=new Array(123);for(i=0;i<64;)t[n[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;var i;e.encode=function(s,l,c){for(var a=null,u=[],d=0,h=0,f;l<c;){var p=s[l++];switch(h){case 0:u[d++]=n[p>>2],f=(p&3)<<4,h=1;break;case 1:u[d++]=n[f|p>>4],f=(p&15)<<2,h=2;break;case 2:u[d++]=n[f|p>>6],u[d++]=n[p&63],h=0;break}d>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,u)),d=0)}return h&&(u[d++]=n[f],u[d++]=61,h===1&&(u[d++]=61)),a?(d&&a.push(String.fromCharCode.apply(String,u.slice(0,d))),a.join("")):String.fromCharCode.apply(String,u.slice(0,d))};var o="invalid encoding";e.decode=function(s,l,c){for(var a=c,u=0,d,h=0;h<s.length;){var f=s.charCodeAt(h++);if(f===61&&u>1)break;if((f=t[f])===void 0)throw Error(o);switch(u){case 0:d=f,u=1;break;case 1:l[c++]=d<<2|(f&48)>>4,d=f,u=2;break;case 2:l[c++]=(d&15)<<4|(f&60)>>2,d=f,u=3;break;case 3:l[c++]=(d&3)<<6|f,u=0;break}}if(u===1)throw Error(o);return c-a},e.test=function(s){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(s)}}),w8=Tt((r,e)=>{"use strict";e.exports=n;function n(){this._listeners={}}n.prototype.on=function(t,i,o){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:i,ctx:o||this}),this},n.prototype.off=function(t,i){if(t===void 0)this._listeners={};else if(i===void 0)this._listeners[t]=[];else for(var o=this._listeners[t],s=0;s<o.length;)o[s].fn===i?o.splice(s,1):++s;return this},n.prototype.emit=function(t){var i=this._listeners[t];if(i){for(var o=[],s=1;s<arguments.length;)o.push(arguments[s++]);for(s=0;s<i.length;)i[s].fn.apply(i[s++].ctx,o)}return this}}),_8=Tt((r,e)=>{"use strict";e.exports=n(n);function n(l){return typeof Float32Array<"u"?function(){var c=new Float32Array([-0]),a=new Uint8Array(c.buffer),u=a[3]===128;function d(g,y,w){c[0]=g,y[w]=a[0],y[w+1]=a[1],y[w+2]=a[2],y[w+3]=a[3]}function h(g,y,w){c[0]=g,y[w]=a[3],y[w+1]=a[2],y[w+2]=a[1],y[w+3]=a[0]}l.writeFloatLE=u?d:h,l.writeFloatBE=u?h:d;function f(g,y){return a[0]=g[y],a[1]=g[y+1],a[2]=g[y+2],a[3]=g[y+3],c[0]}function p(g,y){return a[3]=g[y],a[2]=g[y+1],a[1]=g[y+2],a[0]=g[y+3],c[0]}l.readFloatLE=u?f:p,l.readFloatBE=u?p:f}():function(){function c(u,d,h,f){var p=d<0?1:0;if(p&&(d=-d),d===0)u(1/d>0?0:2147483648,h,f);else if(isNaN(d))u(2143289344,h,f);else if(d>34028234663852886e22)u((p<<31|2139095040)>>>0,h,f);else if(d<11754943508222875e-54)u((p<<31|Math.round(d/1401298464324817e-60))>>>0,h,f);else{var g=Math.floor(Math.log(d)/Math.LN2),y=Math.round(d*Math.pow(2,-g)*8388608)&8388607;u((p<<31|g+127<<23|y)>>>0,h,f)}}l.writeFloatLE=c.bind(null,t),l.writeFloatBE=c.bind(null,i);function a(u,d,h){var f=u(d,h),p=(f>>31)*2+1,g=f>>>23&255,y=f&8388607;return g===255?y?NaN:p*(1/0):g===0?p*1401298464324817e-60*y:p*Math.pow(2,g-150)*(y+8388608)}l.readFloatLE=a.bind(null,o),l.readFloatBE=a.bind(null,s)}(),typeof Float64Array<"u"?function(){var c=new Float64Array([-0]),a=new Uint8Array(c.buffer),u=a[7]===128;function d(g,y,w){c[0]=g,y[w]=a[0],y[w+1]=a[1],y[w+2]=a[2],y[w+3]=a[3],y[w+4]=a[4],y[w+5]=a[5],y[w+6]=a[6],y[w+7]=a[7]}function h(g,y,w){c[0]=g,y[w]=a[7],y[w+1]=a[6],y[w+2]=a[5],y[w+3]=a[4],y[w+4]=a[3],y[w+5]=a[2],y[w+6]=a[1],y[w+7]=a[0]}l.writeDoubleLE=u?d:h,l.writeDoubleBE=u?h:d;function f(g,y){return a[0]=g[y],a[1]=g[y+1],a[2]=g[y+2],a[3]=g[y+3],a[4]=g[y+4],a[5]=g[y+5],a[6]=g[y+6],a[7]=g[y+7],c[0]}function p(g,y){return a[7]=g[y],a[6]=g[y+1],a[5]=g[y+2],a[4]=g[y+3],a[3]=g[y+4],a[2]=g[y+5],a[1]=g[y+6],a[0]=g[y+7],c[0]}l.readDoubleLE=u?f:p,l.readDoubleBE=u?p:f}():function(){function c(u,d,h,f,p,g){var y=f<0?1:0;if(y&&(f=-f),f===0)u(0,p,g+d),u(1/f>0?0:2147483648,p,g+h);else if(isNaN(f))u(0,p,g+d),u(2146959360,p,g+h);else if(f>17976931348623157e292)u(0,p,g+d),u((y<<31|2146435072)>>>0,p,g+h);else{var w;if(f<22250738585072014e-324)w=f/5e-324,u(w>>>0,p,g+d),u((y<<31|w/4294967296)>>>0,p,g+h);else{var v=Math.floor(Math.log(f)/Math.LN2);v===1024&&(v=1023),w=f*Math.pow(2,-v),u(w*4503599627370496>>>0,p,g+d),u((y<<31|v+1023<<20|w*1048576&1048575)>>>0,p,g+h)}}}l.writeDoubleLE=c.bind(null,t,0,4),l.writeDoubleBE=c.bind(null,i,4,0);function a(u,d,h,f,p){var g=u(f,p+d),y=u(f,p+h),w=(y>>31)*2+1,v=y>>>20&2047,x=4294967296*(y&1048575)+g;return v===2047?x?NaN:w*(1/0):v===0?w*5e-324*x:w*Math.pow(2,v-1075)*(x+4503599627370496)}l.readDoubleLE=a.bind(null,o,0,4),l.readDoubleBE=a.bind(null,s,4,0)}(),l}function t(l,c,a){c[a]=l&255,c[a+1]=l>>>8&255,c[a+2]=l>>>16&255,c[a+3]=l>>>24}function i(l,c,a){c[a]=l>>>24,c[a+1]=l>>>16&255,c[a+2]=l>>>8&255,c[a+3]=l&255}function o(l,c){return(l[c]|l[c+1]<<8|l[c+2]<<16|l[c+3]<<24)>>>0}function s(l,c){return(l[c]<<24|l[c+1]<<16|l[c+2]<<8|l[c+3])>>>0}}),T8=Tt((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}}),x8=Tt(r=>{"use strict";var e=r;e.length=function(n){for(var t=0,i=0,o=0;o<n.length;++o)i=n.charCodeAt(o),i<128?t+=1:i<2048?t+=2:(i&64512)===55296&&(n.charCodeAt(o+1)&64512)===56320?(++o,t+=4):t+=3;return t},e.read=function(n,t,i){var o=i-t;if(o<1)return"";for(var s=null,l=[],c=0,a;t<i;)a=n[t++],a<128?l[c++]=a:a>191&&a<224?l[c++]=(a&31)<<6|n[t++]&63:a>239&&a<365?(a=((a&7)<<18|(n[t++]&63)<<12|(n[t++]&63)<<6|n[t++]&63)-65536,l[c++]=55296+(a>>10),l[c++]=56320+(a&1023)):l[c++]=(a&15)<<12|(n[t++]&63)<<6|n[t++]&63,c>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,l)),c=0);return s?(c&&s.push(String.fromCharCode.apply(String,l.slice(0,c))),s.join("")):String.fromCharCode.apply(String,l.slice(0,c))},e.write=function(n,t,i){for(var o=i,s,l,c=0;c<n.length;++c)s=n.charCodeAt(c),s<128?t[i++]=s:s<2048?(t[i++]=s>>6|192,t[i++]=s&63|128):(s&64512)===55296&&((l=n.charCodeAt(c+1))&64512)===56320?(s=65536+((s&1023)<<10)+(l&1023),++c,t[i++]=s>>18|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128,t[i++]=s&63|128):(t[i++]=s>>12|224,t[i++]=s>>6&63|128,t[i++]=s&63|128);return i-o}}),S8=Tt((r,e)=>{"use strict";e.exports=n;function n(t,i,o){var s=o||8192,l=s>>>1,c=null,a=s;return function(u){if(u<1||u>l)return t(u);a+u>s&&(c=t(s),a=0);var d=i.call(c,a,a+=u);return a&7&&(a=(a|7)+1),d}}}),E8=Tt((r,e)=>{"use strict";e.exports=t;var n=Ps();function t(l,c){this.lo=l>>>0,this.hi=c>>>0}var i=t.zero=new t(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var o=t.zeroHash="\0\0\0\0\0\0\0\0";t.fromNumber=function(l){if(l===0)return i;var c=l<0;c&&(l=-l);var a=l>>>0,u=(l-a)/4294967296>>>0;return c&&(u=~u>>>0,a=~a>>>0,++a>4294967295&&(a=0,++u>4294967295&&(u=0))),new t(a,u)},t.from=function(l){if(typeof l=="number")return t.fromNumber(l);if(n.isString(l))if(n.Long)l=n.Long.fromString(l);else return t.fromNumber(parseInt(l,10));return l.low||l.high?new t(l.low>>>0,l.high>>>0):i},t.prototype.toNumber=function(l){if(!l&&this.hi>>>31){var c=~this.lo+1>>>0,a=~this.hi>>>0;return c||(a=a+1>>>0),-(c+a*4294967296)}return this.lo+this.hi*4294967296},t.prototype.toLong=function(l){return n.Long?new n.Long(this.lo|0,this.hi|0,!!l):{low:this.lo|0,high:this.hi|0,unsigned:!!l}};var s=String.prototype.charCodeAt;t.fromHash=function(l){return l===o?i:new t((s.call(l,0)|s.call(l,1)<<8|s.call(l,2)<<16|s.call(l,3)<<24)>>>0,(s.call(l,4)|s.call(l,5)<<8|s.call(l,6)<<16|s.call(l,7)<<24)>>>0)},t.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},t.prototype.zzEncode=function(){var l=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^l)>>>0,this.lo=(this.lo<<1^l)>>>0,this},t.prototype.zzDecode=function(){var l=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^l)>>>0,this.hi=(this.hi>>>1^l)>>>0,this},t.prototype.length=function(){var l=this.lo,c=(this.lo>>>28|this.hi<<4)>>>0,a=this.hi>>>24;return a===0?c===0?l<16384?l<128?1:2:l<2097152?3:4:c<16384?c<128?5:6:c<2097152?7:8:a<128?9:10}}),Ps=Tt(r=>{"use strict";var e=r;e.asPromise=v8(),e.base64=b8(),e.EventEmitter=w8(),e.float=_8(),e.inquire=T8(),e.utf8=x8(),e.pool=S8(),e.LongBits=E8(),e.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node),e.global=e.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||r,e.emptyArray=Object.freeze?Object.freeze([]):[],e.emptyObject=Object.freeze?Object.freeze({}):{},e.isInteger=Number.isInteger||function(i){return typeof i=="number"&&isFinite(i)&&Math.floor(i)===i},e.isString=function(i){return typeof i=="string"||i instanceof String},e.isObject=function(i){return i&&typeof i=="object"},e.isset=e.isSet=function(i,o){var s=i[o];return s!=null&&i.hasOwnProperty(o)?typeof s!="object"||(Array.isArray(s)?s.length:Object.keys(s).length)>0:!1},e.Buffer=function(){try{var i=e.inquire("buffer").Buffer;return i.prototype.utf8Write?i:null}catch{return null}}(),e._Buffer_from=null,e._Buffer_allocUnsafe=null,e.newBuffer=function(i){return typeof i=="number"?e.Buffer?e._Buffer_allocUnsafe(i):new e.Array(i):e.Buffer?e._Buffer_from(i):typeof Uint8Array>"u"?i:new Uint8Array(i)},e.Array=typeof Uint8Array<"u"?Uint8Array:Array,e.Long=e.global.dcodeIO&&e.global.dcodeIO.Long||e.global.Long||e.inquire("long"),e.key2Re=/^true|false|0|1$/,e.key32Re=/^-?(?:0|[1-9][0-9]*)$/,e.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,e.longToHash=function(i){return i?e.LongBits.from(i).toHash():e.LongBits.zeroHash},e.longFromHash=function(i,o){var s=e.LongBits.fromHash(i);return e.Long?e.Long.fromBits(s.lo,s.hi,o):s.toNumber(!!o)};function n(i,o,s){for(var l=Object.keys(o),c=0;c<l.length;++c)(i[l[c]]===void 0||!s)&&(i[l[c]]=o[l[c]]);return i}e.merge=n,e.lcFirst=function(i){return i.charAt(0).toLowerCase()+i.substring(1)};function t(i){function o(s,l){if(!(this instanceof o))return new o(s,l);Object.defineProperty(this,"message",{get:function(){return s}}),Error.captureStackTrace?Error.captureStackTrace(this,o):Object.defineProperty(this,"stack",{value:new Error().stack||""}),l&&n(this,l)}return o.prototype=Object.create(Error.prototype,{constructor:{value:o,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return i},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),o}e.newError=t,e.ProtocolError=t("ProtocolError"),e.oneOfGetter=function(i){for(var o={},s=0;s<i.length;++s)o[i[s]]=1;return function(){for(var l=Object.keys(this),c=l.length-1;c>-1;--c)if(o[l[c]]===1&&this[l[c]]!==void 0&&this[l[c]]!==null)return l[c]}},e.oneOfSetter=function(i){return function(o){for(var s=0;s<i.length;++s)i[s]!==o&&delete this[i[s]]}},e.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},e._configure=function(){var i=e.Buffer;if(!i){e._Buffer_from=e._Buffer_allocUnsafe=null;return}e._Buffer_from=i.from!==Uint8Array.from&&i.from||function(o,s){return new i(o,s)},e._Buffer_allocUnsafe=i.allocUnsafe||function(o){return new i(o)}}}),xM=Tt((r,e)=>{"use strict";e.exports=u;var n=Ps(),t,i=n.LongBits,o=n.base64,s=n.utf8;function l(v,x,A){this.fn=v,this.len=x,this.next=void 0,this.val=A}function c(){}function a(v){this.head=v.head,this.tail=v.tail,this.len=v.len,this.next=v.states}function u(){this.len=0,this.head=new l(c,0,0),this.tail=this.head,this.states=null}var d=function(){return n.Buffer?function(){return(u.create=function(){return new t})()}:function(){return new u}};u.create=d(),u.alloc=function(v){return new n.Array(v)},n.Array!==Array&&(u.alloc=n.pool(u.alloc,n.Array.prototype.subarray)),u.prototype._push=function(v,x,A){return this.tail=this.tail.next=new l(v,x,A),this.len+=x,this};function h(v,x,A){x[A]=v&255}function f(v,x,A){for(;v>127;)x[A++]=v&127|128,v>>>=7;x[A]=v}function p(v,x){this.len=v,this.next=void 0,this.val=x}p.prototype=Object.create(l.prototype),p.prototype.fn=f,u.prototype.uint32=function(v){return this.len+=(this.tail=this.tail.next=new p((v=v>>>0)<128?1:v<16384?2:v<2097152?3:v<268435456?4:5,v)).len,this},u.prototype.int32=function(v){return v<0?this._push(g,10,i.fromNumber(v)):this.uint32(v)},u.prototype.sint32=function(v){return this.uint32((v<<1^v>>31)>>>0)};function g(v,x,A){for(;v.hi;)x[A++]=v.lo&127|128,v.lo=(v.lo>>>7|v.hi<<25)>>>0,v.hi>>>=7;for(;v.lo>127;)x[A++]=v.lo&127|128,v.lo=v.lo>>>7;x[A++]=v.lo}u.prototype.uint64=function(v){var x=i.from(v);return this._push(g,x.length(),x)},u.prototype.int64=u.prototype.uint64,u.prototype.sint64=function(v){var x=i.from(v).zzEncode();return this._push(g,x.length(),x)},u.prototype.bool=function(v){return this._push(h,1,v?1:0)};function y(v,x,A){x[A]=v&255,x[A+1]=v>>>8&255,x[A+2]=v>>>16&255,x[A+3]=v>>>24}u.prototype.fixed32=function(v){return this._push(y,4,v>>>0)},u.prototype.sfixed32=u.prototype.fixed32,u.prototype.fixed64=function(v){var x=i.from(v);return this._push(y,4,x.lo)._push(y,4,x.hi)},u.prototype.sfixed64=u.prototype.fixed64,u.prototype.float=function(v){return this._push(n.float.writeFloatLE,4,v)},u.prototype.double=function(v){return this._push(n.float.writeDoubleLE,8,v)};var w=n.Array.prototype.set?function(v,x,A){x.set(v,A)}:function(v,x,A){for(var L=0;L<v.length;++L)x[A+L]=v[L]};u.prototype.bytes=function(v){var x=v.length>>>0;if(!x)return this._push(h,1,0);if(n.isString(v)){var A=u.alloc(x=o.length(v));o.decode(v,A,0),v=A}return this.uint32(x)._push(w,x,v)},u.prototype.string=function(v){var x=s.length(v);return x?this.uint32(x)._push(s.write,x,v):this._push(h,1,0)},u.prototype.fork=function(){return this.states=new a(this),this.head=this.tail=new l(c,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(c,0,0),this.len=0),this},u.prototype.ldelim=function(){var v=this.head,x=this.tail,A=this.len;return this.reset().uint32(A),A&&(this.tail.next=v.next,this.tail=x,this.len+=A),this},u.prototype.finish=function(){for(var v=this.head.next,x=this.constructor.alloc(this.len),A=0;v;)v.fn(v.val,x,A),A+=v.len,v=v.next;return x},u._configure=function(v){t=v,u.create=d(),t._configure()}}),D8=Tt((r,e)=>{"use strict";e.exports=i;var n=xM();(i.prototype=Object.create(n.prototype)).constructor=i;var t=Ps();function i(){n.call(this)}i._configure=function(){i.alloc=t._Buffer_allocUnsafe,i.writeBytesBuffer=t.Buffer&&t.Buffer.prototype instanceof Uint8Array&&t.Buffer.prototype.set.name==="set"?function(s,l,c){l.set(s,c)}:function(s,l,c){if(s.copy)s.copy(l,c,0,s.length);else for(var a=0;a<s.length;)l[c++]=s[a++]}},i.prototype.bytes=function(s){t.isString(s)&&(s=t._Buffer_from(s,"base64"));var l=s.length>>>0;return this.uint32(l),l&&this._push(i.writeBytesBuffer,l,s),this};function o(s,l,c){s.length<40?t.utf8.write(s,l,c):l.utf8Write?l.utf8Write(s,c):l.write(s,c)}i.prototype.string=function(s){var l=t.Buffer.byteLength(s);return this.uint32(l),l&&this._push(o,l,s),this},i._configure()}),SM=Tt((r,e)=>{"use strict";e.exports=l;var n=Ps(),t,i=n.LongBits,o=n.utf8;function s(f,p){return RangeError("index out of range: "+f.pos+" + "+(p||1)+" > "+f.len)}function l(f){this.buf=f,this.pos=0,this.len=f.length}var c=typeof Uint8Array<"u"?function(f){if(f instanceof Uint8Array||Array.isArray(f))return new l(f);throw Error("illegal buffer")}:function(f){if(Array.isArray(f))return new l(f);throw Error("illegal buffer")},a=function(){return n.Buffer?function(f){return(l.create=function(p){return n.Buffer.isBuffer(p)?new t(p):c(p)})(f)}:c};l.create=a(),l.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice,l.prototype.uint32=function(){var f=4294967295;return function(){if(f=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(f=(f|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(f=(f|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(f=(f|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(f=(f|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return f;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return f}}(),l.prototype.int32=function(){return this.uint32()|0},l.prototype.sint32=function(){var f=this.uint32();return f>>>1^-(f&1)|0};function u(){var f=new i(0,0),p=0;if(this.len-this.pos>4){for(;p<4;++p)if(f.lo=(f.lo|(this.buf[this.pos]&127)<<p*7)>>>0,this.buf[this.pos++]<128)return f;if(f.lo=(f.lo|(this.buf[this.pos]&127)<<28)>>>0,f.hi=(f.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return f;p=0}else{for(;p<3;++p){if(this.pos>=this.len)throw s(this);if(f.lo=(f.lo|(this.buf[this.pos]&127)<<p*7)>>>0,this.buf[this.pos++]<128)return f}return f.lo=(f.lo|(this.buf[this.pos++]&127)<<p*7)>>>0,f}if(this.len-this.pos>4){for(;p<5;++p)if(f.hi=(f.hi|(this.buf[this.pos]&127)<<p*7+3)>>>0,this.buf[this.pos++]<128)return f}else for(;p<5;++p){if(this.pos>=this.len)throw s(this);if(f.hi=(f.hi|(this.buf[this.pos]&127)<<p*7+3)>>>0,this.buf[this.pos++]<128)return f}throw Error("invalid varint encoding")}l.prototype.bool=function(){return this.uint32()!==0};function d(f,p){return(f[p-4]|f[p-3]<<8|f[p-2]<<16|f[p-1]<<24)>>>0}l.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return d(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return d(this.buf,this.pos+=4)|0};function h(){if(this.pos+8>this.len)throw s(this,8);return new i(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}l.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var f=n.float.readFloatLE(this.buf,this.pos);return this.pos+=4,f},l.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var f=n.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,f},l.prototype.bytes=function(){var f=this.uint32(),p=this.pos,g=this.pos+f;if(g>this.len)throw s(this,f);if(this.pos+=f,Array.isArray(this.buf))return this.buf.slice(p,g);if(p===g){var y=n.Buffer;return y?y.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,p,g)},l.prototype.string=function(){var f=this.bytes();return o.read(f,0,f.length)},l.prototype.skip=function(f){if(typeof f=="number"){if(this.pos+f>this.len)throw s(this,f);this.pos+=f}else do if(this.pos>=this.len)throw s(this);while(this.buf[this.pos++]&128);return this},l.prototype.skipType=function(f){switch(f){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(f=this.uint32()&7)!==4;)this.skipType(f);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+f+" at offset "+this.pos)}return this},l._configure=function(f){t=f,l.create=a(),t._configure();var p=n.Long?"toLong":"toNumber";n.merge(l.prototype,{int64:function(){return u.call(this)[p](!1)},uint64:function(){return u.call(this)[p](!0)},sint64:function(){return u.call(this).zzDecode()[p](!1)},fixed64:function(){return h.call(this)[p](!0)},sfixed64:function(){return h.call(this)[p](!1)}})}}),C8=Tt((r,e)=>{"use strict";e.exports=i;var n=SM();(i.prototype=Object.create(n.prototype)).constructor=i;var t=Ps();function i(o){n.call(this,o)}i._configure=function(){t.Buffer&&(i.prototype._slice=t.Buffer.prototype.slice)},i.prototype.string=function(){var o=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+o,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+o,this.len))},i._configure()}),I8=Tt((r,e)=>{"use strict";e.exports=t;var n=Ps();(t.prototype=Object.create(n.EventEmitter.prototype)).constructor=t;function t(i,o,s){if(typeof i!="function")throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=i,this.requestDelimited=!!o,this.responseDelimited=!!s}t.prototype.rpcCall=function i(o,s,l,c,a){if(!c)throw TypeError("request must be specified");var u=this;if(!a)return n.asPromise(i,u,o,s,l,c);if(!u.rpcImpl){setTimeout(function(){a(Error("already ended"))},0);return}try{return u.rpcImpl(o,s[u.requestDelimited?"encodeDelimited":"encode"](c).finish(),function(d,h){if(d)return u.emit("error",d,o),a(d);if(h===null){u.end(!0);return}if(!(h instanceof l))try{h=l[u.responseDelimited?"decodeDelimited":"decode"](h)}catch(f){return u.emit("error",f,o),a(f)}return u.emit("data",h,o),a(null,h)})}catch(d){u.emit("error",d,o),setTimeout(function(){a(d)},0);return}},t.prototype.end=function(i){return this.rpcImpl&&(i||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}}),O8=Tt(r=>{"use strict";var e=r;e.Service=I8()}),A8=Tt((r,e)=>{"use strict";e.exports={}}),P8=Tt(r=>{"use strict";var e=r;e.build="minimal",e.Writer=xM(),e.BufferWriter=D8(),e.Reader=SM(),e.BufferReader=C8(),e.util=Ps(),e.rpc=O8(),e.roots=A8(),e.configure=n;function n(){e.util._configure(),e.Writer._configure(e.BufferWriter),e.Reader._configure(e.BufferReader)}n()}),M8=Tt((r,e)=>{"use strict";e.exports=P8()}),Su=Tt((r,e)=>{"use strict";var n=M8(),t=n.Reader,i=n.Writer,o=n.util,s=n.roots.default||(n.roots.default={});s.onnx=function(){var l={};return l.Version=function(){var c={},a=Object.create(c);return a[c[0]="_START_VERSION"]=0,a[c[1]="IR_VERSION_2017_10_10"]=1,a[c[2]="IR_VERSION_2017_10_30"]=2,a[c[3]="IR_VERSION_2017_11_3"]=3,a[c[4]="IR_VERSION_2019_1_22"]=4,a[c[5]="IR_VERSION_2019_3_18"]=5,a[c[6]="IR_VERSION_2019_9_19"]=6,a[c[7]="IR_VERSION_2020_5_8"]=7,a[c[8]="IR_VERSION_2021_7_30"]=8,a[c[9]="IR_VERSION"]=9,a}(),l.AttributeProto=function(){function c(a){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],this.sparseTensors=[],this.typeProtos=[],a)for(var u=Object.keys(a),d=0;d<u.length;++d)a[u[d]]!=null&&(this[u[d]]=a[u[d]])}return c.prototype.name="",c.prototype.refAttrName="",c.prototype.docString="",c.prototype.type=0,c.prototype.f=0,c.prototype.i=o.Long?o.Long.fromBits(0,0,!1):0,c.prototype.s=o.newBuffer([]),c.prototype.t=null,c.prototype.g=null,c.prototype.sparseTensor=null,c.prototype.tp=null,c.prototype.floats=o.emptyArray,c.prototype.ints=o.emptyArray,c.prototype.strings=o.emptyArray,c.prototype.tensors=o.emptyArray,c.prototype.graphs=o.emptyArray,c.prototype.sparseTensors=o.emptyArray,c.prototype.typeProtos=o.emptyArray,c.create=function(a){return new c(a)},c.encode=function(a,u){if(u||(u=i.create()),a.name!=null&&Object.hasOwnProperty.call(a,"name")&&u.uint32(10).string(a.name),a.f!=null&&Object.hasOwnProperty.call(a,"f")&&u.uint32(21).float(a.f),a.i!=null&&Object.hasOwnProperty.call(a,"i")&&u.uint32(24).int64(a.i),a.s!=null&&Object.hasOwnProperty.call(a,"s")&&u.uint32(34).bytes(a.s),a.t!=null&&Object.hasOwnProperty.call(a,"t")&&s.onnx.TensorProto.encode(a.t,u.uint32(42).fork()).ldelim(),a.g!=null&&Object.hasOwnProperty.call(a,"g")&&s.onnx.GraphProto.encode(a.g,u.uint32(50).fork()).ldelim(),a.floats!=null&&a.floats.length){u.uint32(58).fork();for(var d=0;d<a.floats.length;++d)u.float(a.floats[d]);u.ldelim()}if(a.ints!=null&&a.ints.length){u.uint32(66).fork();for(var d=0;d<a.ints.length;++d)u.int64(a.ints[d]);u.ldelim()}if(a.strings!=null&&a.strings.length)for(var d=0;d<a.strings.length;++d)u.uint32(74).bytes(a.strings[d]);if(a.tensors!=null&&a.tensors.length)for(var d=0;d<a.tensors.length;++d)s.onnx.TensorProto.encode(a.tensors[d],u.uint32(82).fork()).ldelim();if(a.graphs!=null&&a.graphs.length)for(var d=0;d<a.graphs.length;++d)s.onnx.GraphProto.encode(a.graphs[d],u.uint32(90).fork()).ldelim();if(a.docString!=null&&Object.hasOwnProperty.call(a,"docString")&&u.uint32(106).string(a.docString),a.tp!=null&&Object.hasOwnProperty.call(a,"tp")&&s.onnx.TypeProto.encode(a.tp,u.uint32(114).fork()).ldelim(),a.typeProtos!=null&&a.typeProtos.length)for(var d=0;d<a.typeProtos.length;++d)s.onnx.TypeProto.encode(a.typeProtos[d],u.uint32(122).fork()).ldelim();if(a.type!=null&&Object.hasOwnProperty.call(a,"type")&&u.uint32(160).int32(a.type),a.refAttrName!=null&&Object.hasOwnProperty.call(a,"refAttrName")&&u.uint32(170).string(a.refAttrName),a.sparseTensor!=null&&Object.hasOwnProperty.call(a,"sparseTensor")&&s.onnx.SparseTensorProto.encode(a.sparseTensor,u.uint32(178).fork()).ldelim(),a.sparseTensors!=null&&a.sparseTensors.length)for(var d=0;d<a.sparseTensors.length;++d)s.onnx.SparseTensorProto.encode(a.sparseTensors[d],u.uint32(186).fork()).ldelim();return u},c.encodeDelimited=function(a,u){return this.encode(a,u).ldelim()},c.decode=function(a,u){a instanceof t||(a=t.create(a));for(var d=u===void 0?a.len:a.pos+u,h=new s.onnx.AttributeProto;a.pos<d;){var f=a.uint32();switch(f>>>3){case 1:{h.name=a.string();break}case 21:{h.refAttrName=a.string();break}case 13:{h.docString=a.string();break}case 20:{h.type=a.int32();break}case 2:{h.f=a.float();break}case 3:{h.i=a.int64();break}case 4:{h.s=a.bytes();break}case 5:{h.t=s.onnx.TensorProto.decode(a,a.uint32());break}case 6:{h.g=s.onnx.GraphProto.decode(a,a.uint32());break}case 22:{h.sparseTensor=s.onnx.SparseTensorProto.decode(a,a.uint32());break}case 14:{h.tp=s.onnx.TypeProto.decode(a,a.uint32());break}case 7:{if(h.floats&&h.floats.length||(h.floats=[]),(f&7)===2)for(var p=a.uint32()+a.pos;a.pos<p;)h.floats.push(a.float());else h.floats.push(a.float());break}case 8:{if(h.ints&&h.ints.length||(h.ints=[]),(f&7)===2)for(var p=a.uint32()+a.pos;a.pos<p;)h.ints.push(a.int64());else h.ints.push(a.int64());break}case 9:{h.strings&&h.strings.length||(h.strings=[]),h.strings.push(a.bytes());break}case 10:{h.tensors&&h.tensors.length||(h.tensors=[]),h.tensors.push(s.onnx.TensorProto.decode(a,a.uint32()));break}case 11:{h.graphs&&h.graphs.length||(h.graphs=[]),h.graphs.push(s.onnx.GraphProto.decode(a,a.uint32()));break}case 23:{h.sparseTensors&&h.sparseTensors.length||(h.sparseTensors=[]),h.sparseTensors.push(s.onnx.SparseTensorProto.decode(a,a.uint32()));break}case 15:{h.typeProtos&&h.typeProtos.length||(h.typeProtos=[]),h.typeProtos.push(s.onnx.TypeProto.decode(a,a.uint32()));break}default:a.skipType(f&7);break}}return h},c.decodeDelimited=function(a){return a instanceof t||(a=new t(a)),this.decode(a,a.uint32())},c.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.name!=null&&a.hasOwnProperty("name")&&!o.isString(a.name))return"name: string expected";if(a.refAttrName!=null&&a.hasOwnProperty("refAttrName")&&!o.isString(a.refAttrName))return"refAttrName: string expected";if(a.docString!=null&&a.hasOwnProperty("docString")&&!o.isString(a.docString))return"docString: string expected";if(a.type!=null&&a.hasOwnProperty("type"))switch(a.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 11:case 13:case 6:case 7:case 8:case 9:case 10:case 12:case 14:break}if(a.f!=null&&a.hasOwnProperty("f")&&typeof a.f!="number")return"f: number expected";if(a.i!=null&&a.hasOwnProperty("i")&&!o.isInteger(a.i)&&!(a.i&&o.isInteger(a.i.low)&&o.isInteger(a.i.high)))return"i: integer|Long expected";if(a.s!=null&&a.hasOwnProperty("s")&&!(a.s&&typeof a.s.length=="number"||o.isString(a.s)))return"s: buffer expected";if(a.t!=null&&a.hasOwnProperty("t")){var u=s.onnx.TensorProto.verify(a.t);if(u)return"t."+u}if(a.g!=null&&a.hasOwnProperty("g")){var u=s.onnx.GraphProto.verify(a.g);if(u)return"g."+u}if(a.sparseTensor!=null&&a.hasOwnProperty("sparseTensor")){var u=s.onnx.SparseTensorProto.verify(a.sparseTensor);if(u)return"sparseTensor."+u}if(a.tp!=null&&a.hasOwnProperty("tp")){var u=s.onnx.TypeProto.verify(a.tp);if(u)return"tp."+u}if(a.floats!=null&&a.hasOwnProperty("floats")){if(!Array.isArray(a.floats))return"floats: array expected";for(var d=0;d<a.floats.length;++d)if(typeof a.floats[d]!="number")return"floats: number[] expected"}if(a.ints!=null&&a.hasOwnProperty("ints")){if(!Array.isArray(a.ints))return"ints: array expected";for(var d=0;d<a.ints.length;++d)if(!o.isInteger(a.ints[d])&&!(a.ints[d]&&o.isInteger(a.ints[d].low)&&o.isInteger(a.ints[d].high)))return"ints: integer|Long[] expected"}if(a.strings!=null&&a.hasOwnProperty("strings")){if(!Array.isArray(a.strings))return"strings: array expected";for(var d=0;d<a.strings.length;++d)if(!(a.strings[d]&&typeof a.strings[d].length=="number"||o.isString(a.strings[d])))return"strings: buffer[] expected"}if(a.tensors!=null&&a.hasOwnProperty("tensors")){if(!Array.isArray(a.tensors))return"tensors: array expected";for(var d=0;d<a.tensors.length;++d){var u=s.onnx.TensorProto.verify(a.tensors[d]);if(u)return"tensors."+u}}if(a.graphs!=null&&a.hasOwnProperty("graphs")){if(!Array.isArray(a.graphs))return"graphs: array expected";for(var d=0;d<a.graphs.length;++d){var u=s.onnx.GraphProto.verify(a.graphs[d]);if(u)return"graphs."+u}}if(a.sparseTensors!=null&&a.hasOwnProperty("sparseTensors")){if(!Array.isArray(a.sparseTensors))return"sparseTensors: array expected";for(var d=0;d<a.sparseTensors.length;++d){var u=s.onnx.SparseTensorProto.verify(a.sparseTensors[d]);if(u)return"sparseTensors."+u}}if(a.typeProtos!=null&&a.hasOwnProperty("typeProtos")){if(!Array.isArray(a.typeProtos))return"typeProtos: array expected";for(var d=0;d<a.typeProtos.length;++d){var u=s.onnx.TypeProto.verify(a.typeProtos[d]);if(u)return"typeProtos."+u}}return null},c.fromObject=function(a){if(a instanceof s.onnx.AttributeProto)return a;var u=new s.onnx.AttributeProto;switch(a.name!=null&&(u.name=String(a.name)),a.refAttrName!=null&&(u.refAttrName=String(a.refAttrName)),a.docString!=null&&(u.docString=String(a.docString)),a.type){default:if(typeof a.type=="number"){u.type=a.type;break}break;case"UNDEFINED":case 0:u.type=0;break;case"FLOAT":case 1:u.type=1;break;case"INT":case 2:u.type=2;break;case"STRING":case 3:u.type=3;break;case"TENSOR":case 4:u.type=4;break;case"GRAPH":case 5:u.type=5;break;case"SPARSE_TENSOR":case 11:u.type=11;break;case"TYPE_PROTO":case 13:u.type=13;break;case"FLOATS":case 6:u.type=6;break;case"INTS":case 7:u.type=7;break;case"STRINGS":case 8:u.type=8;break;case"TENSORS":case 9:u.type=9;break;case"GRAPHS":case 10:u.type=10;break;case"SPARSE_TENSORS":case 12:u.type=12;break;case"TYPE_PROTOS":case 14:u.type=14;break}if(a.f!=null&&(u.f=Number(a.f)),a.i!=null&&(o.Long?(u.i=o.Long.fromValue(a.i)).unsigned=!1:typeof a.i=="string"?u.i=parseInt(a.i,10):typeof a.i=="number"?u.i=a.i:typeof a.i=="object"&&(u.i=new o.LongBits(a.i.low>>>0,a.i.high>>>0).toNumber())),a.s!=null&&(typeof a.s=="string"?o.base64.decode(a.s,u.s=o.newBuffer(o.base64.length(a.s)),0):a.s.length>=0&&(u.s=a.s)),a.t!=null){if(typeof a.t!="object")throw TypeError(".onnx.AttributeProto.t: object expected");u.t=s.onnx.TensorProto.fromObject(a.t)}if(a.g!=null){if(typeof a.g!="object")throw TypeError(".onnx.AttributeProto.g: object expected");u.g=s.onnx.GraphProto.fromObject(a.g)}if(a.sparseTensor!=null){if(typeof a.sparseTensor!="object")throw TypeError(".onnx.AttributeProto.sparseTensor: object expected");u.sparseTensor=s.onnx.SparseTensorProto.fromObject(a.sparseTensor)}if(a.tp!=null){if(typeof a.tp!="object")throw TypeError(".onnx.AttributeProto.tp: object expected");u.tp=s.onnx.TypeProto.fromObject(a.tp)}if(a.floats){if(!Array.isArray(a.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");u.floats=[];for(var d=0;d<a.floats.length;++d)u.floats[d]=Number(a.floats[d])}if(a.ints){if(!Array.isArray(a.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");u.ints=[];for(var d=0;d<a.ints.length;++d)o.Long?(u.ints[d]=o.Long.fromValue(a.ints[d])).unsigned=!1:typeof a.ints[d]=="string"?u.ints[d]=parseInt(a.ints[d],10):typeof a.ints[d]=="number"?u.ints[d]=a.ints[d]:typeof a.ints[d]=="object"&&(u.ints[d]=new o.LongBits(a.ints[d].low>>>0,a.ints[d].high>>>0).toNumber())}if(a.strings){if(!Array.isArray(a.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");u.strings=[];for(var d=0;d<a.strings.length;++d)typeof a.strings[d]=="string"?o.base64.decode(a.strings[d],u.strings[d]=o.newBuffer(o.base64.length(a.strings[d])),0):a.strings[d].length>=0&&(u.strings[d]=a.strings[d])}if(a.tensors){if(!Array.isArray(a.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");u.tensors=[];for(var d=0;d<a.tensors.length;++d){if(typeof a.tensors[d]!="object")throw TypeError(".onnx.AttributeProto.tensors: object expected");u.tensors[d]=s.onnx.TensorProto.fromObject(a.tensors[d])}}if(a.graphs){if(!Array.isArray(a.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");u.graphs=[];for(var d=0;d<a.graphs.length;++d){if(typeof a.graphs[d]!="object")throw TypeError(".onnx.AttributeProto.graphs: object expected");u.graphs[d]=s.onnx.GraphProto.fromObject(a.graphs[d])}}if(a.sparseTensors){if(!Array.isArray(a.sparseTensors))throw TypeError(".onnx.AttributeProto.sparseTensors: array expected");u.sparseTensors=[];for(var d=0;d<a.sparseTensors.length;++d){if(typeof a.sparseTensors[d]!="object")throw TypeError(".onnx.AttributeProto.sparseTensors: object expected");u.sparseTensors[d]=s.onnx.SparseTensorProto.fromObject(a.sparseTensors[d])}}if(a.typeProtos){if(!Array.isArray(a.typeProtos))throw TypeError(".onnx.AttributeProto.typeProtos: array expected");u.typeProtos=[];for(var d=0;d<a.typeProtos.length;++d){if(typeof a.typeProtos[d]!="object")throw TypeError(".onnx.AttributeProto.typeProtos: object expected");u.typeProtos[d]=s.onnx.TypeProto.fromObject(a.typeProtos[d])}}return u},c.toObject=function(a,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.floats=[],d.ints=[],d.strings=[],d.tensors=[],d.graphs=[],d.typeProtos=[],d.sparseTensors=[]),u.defaults){if(d.name="",d.f=0,o.Long){var h=new o.Long(0,0,!1);d.i=u.longs===String?h.toString():u.longs===Number?h.toNumber():h}else d.i=u.longs===String?"0":0;u.bytes===String?d.s="":(d.s=[],u.bytes!==Array&&(d.s=o.newBuffer(d.s))),d.t=null,d.g=null,d.docString="",d.tp=null,d.type=u.enums===String?"UNDEFINED":0,d.refAttrName="",d.sparseTensor=null}if(a.name!=null&&a.hasOwnProperty("name")&&(d.name=a.name),a.f!=null&&a.hasOwnProperty("f")&&(d.f=u.json&&!isFinite(a.f)?String(a.f):a.f),a.i!=null&&a.hasOwnProperty("i")&&(typeof a.i=="number"?d.i=u.longs===String?String(a.i):a.i:d.i=u.longs===String?o.Long.prototype.toString.call(a.i):u.longs===Number?new o.LongBits(a.i.low>>>0,a.i.high>>>0).toNumber():a.i),a.s!=null&&a.hasOwnProperty("s")&&(d.s=u.bytes===String?o.base64.encode(a.s,0,a.s.length):u.bytes===Array?Array.prototype.slice.call(a.s):a.s),a.t!=null&&a.hasOwnProperty("t")&&(d.t=s.onnx.TensorProto.toObject(a.t,u)),a.g!=null&&a.hasOwnProperty("g")&&(d.g=s.onnx.GraphProto.toObject(a.g,u)),a.floats&&a.floats.length){d.floats=[];for(var f=0;f<a.floats.length;++f)d.floats[f]=u.json&&!isFinite(a.floats[f])?String(a.floats[f]):a.floats[f]}if(a.ints&&a.ints.length){d.ints=[];for(var f=0;f<a.ints.length;++f)typeof a.ints[f]=="number"?d.ints[f]=u.longs===String?String(a.ints[f]):a.ints[f]:d.ints[f]=u.longs===String?o.Long.prototype.toString.call(a.ints[f]):u.longs===Number?new o.LongBits(a.ints[f].low>>>0,a.ints[f].high>>>0).toNumber():a.ints[f]}if(a.strings&&a.strings.length){d.strings=[];for(var f=0;f<a.strings.length;++f)d.strings[f]=u.bytes===String?o.base64.encode(a.strings[f],0,a.strings[f].length):u.bytes===Array?Array.prototype.slice.call(a.strings[f]):a.strings[f]}if(a.tensors&&a.tensors.length){d.tensors=[];for(var f=0;f<a.tensors.length;++f)d.tensors[f]=s.onnx.TensorProto.toObject(a.tensors[f],u)}if(a.graphs&&a.graphs.length){d.graphs=[];for(var f=0;f<a.graphs.length;++f)d.graphs[f]=s.onnx.GraphProto.toObject(a.graphs[f],u)}if(a.docString!=null&&a.hasOwnProperty("docString")&&(d.docString=a.docString),a.tp!=null&&a.hasOwnProperty("tp")&&(d.tp=s.onnx.TypeProto.toObject(a.tp,u)),a.typeProtos&&a.typeProtos.length){d.typeProtos=[];for(var f=0;f<a.typeProtos.length;++f)d.typeProtos[f]=s.onnx.TypeProto.toObject(a.typeProtos[f],u)}if(a.type!=null&&a.hasOwnProperty("type")&&(d.type=u.enums===String?s.onnx.AttributeProto.AttributeType[a.type]===void 0?a.type:s.onnx.AttributeProto.AttributeType[a.type]:a.type),a.refAttrName!=null&&a.hasOwnProperty("refAttrName")&&(d.refAttrName=a.refAttrName),a.sparseTensor!=null&&a.hasOwnProperty("sparseTensor")&&(d.sparseTensor=s.onnx.SparseTensorProto.toObject(a.sparseTensor,u)),a.sparseTensors&&a.sparseTensors.length){d.sparseTensors=[];for(var f=0;f<a.sparseTensors.length;++f)d.sparseTensors[f]=s.onnx.SparseTensorProto.toObject(a.sparseTensors[f],u)}return d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/onnx.AttributeProto"},c.AttributeType=function(){var a={},u=Object.create(a);return u[a[0]="UNDEFINED"]=0,u[a[1]="FLOAT"]=1,u[a[2]="INT"]=2,u[a[3]="STRING"]=3,u[a[4]="TENSOR"]=4,u[a[5]="GRAPH"]=5,u[a[11]="SPARSE_TENSOR"]=11,u[a[13]="TYPE_PROTO"]=13,u[a[6]="FLOATS"]=6,u[a[7]="INTS"]=7,u[a[8]="STRINGS"]=8,u[a[9]="TENSORS"]=9,u[a[10]="GRAPHS"]=10,u[a[12]="SPARSE_TENSORS"]=12,u[a[14]="TYPE_PROTOS"]=14,u}(),c}(),l.ValueInfoProto=function(){function c(a){if(a)for(var u=Object.keys(a),d=0;d<u.length;++d)a[u[d]]!=null&&(this[u[d]]=a[u[d]])}return c.prototype.name="",c.prototype.type=null,c.prototype.docString="",c.create=function(a){return new c(a)},c.encode=function(a,u){return u||(u=i.create()),a.name!=null&&Object.hasOwnProperty.call(a,"name")&&u.uint32(10).string(a.name),a.type!=null&&Object.hasOwnProperty.call(a,"type")&&s.onnx.TypeProto.encode(a.type,u.uint32(18).fork()).ldelim(),a.docString!=null&&Object.hasOwnProperty.call(a,"docString")&&u.uint32(26).string(a.docString),u},c.encodeDelimited=function(a,u){return this.encode(a,u).ldelim()},c.decode=function(a,u){a instanceof t||(a=t.create(a));for(var d=u===void 0?a.len:a.pos+u,h=new s.onnx.ValueInfoProto;a.pos<d;){var f=a.uint32();switch(f>>>3){case 1:{h.name=a.string();break}case 2:{h.type=s.onnx.TypeProto.decode(a,a.uint32());break}case 3:{h.docString=a.string();break}default:a.skipType(f&7);break}}return h},c.decodeDelimited=function(a){return a instanceof t||(a=new t(a)),this.decode(a,a.uint32())},c.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.name!=null&&a.hasOwnProperty("name")&&!o.isString(a.name))return"name: string expected";if(a.type!=null&&a.hasOwnProperty("type")){var u=s.onnx.TypeProto.verify(a.type);if(u)return"type."+u}return a.docString!=null&&a.hasOwnProperty("docString")&&!o.isString(a.docString)?"docString: string expected":null},c.fromObject=function(a){if(a instanceof s.onnx.ValueInfoProto)return a;var u=new s.onnx.ValueInfoProto;if(a.name!=null&&(u.name=String(a.name)),a.type!=null){if(typeof a.type!="object")throw TypeError(".onnx.ValueInfoProto.type: object expected");u.type=s.onnx.TypeProto.fromObject(a.type)}return a.docString!=null&&(u.docString=String(a.docString)),u},c.toObject=function(a,u){u||(u={});var d={};return u.defaults&&(d.name="",d.type=null,d.docString=""),a.name!=null&&a.hasOwnProperty("name")&&(d.name=a.name),a.type!=null&&a.hasOwnProperty("type")&&(d.type=s.onnx.TypeProto.toObject(a.type,u)),a.docString!=null&&a.hasOwnProperty("docString")&&(d.docString=a.docString),d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/onnx.ValueInfoProto"},c}(),l.NodeProto=function(){function c(a){if(this.input=[],this.output=[],this.attribute=[],a)for(var u=Object.keys(a),d=0;d<u.length;++d)a[u[d]]!=null&&(this[u[d]]=a[u[d]])}return c.prototype.input=o.emptyArray,c.prototype.output=o.emptyArray,c.prototype.name="",c.prototype.opType="",c.prototype.domain="",c.prototype.attribute=o.emptyArray,c.prototype.docString="",c.create=function(a){return new c(a)},c.encode=function(a,u){if(u||(u=i.create()),a.input!=null&&a.input.length)for(var d=0;d<a.input.length;++d)u.uint32(10).string(a.input[d]);if(a.output!=null&&a.output.length)for(var d=0;d<a.output.length;++d)u.uint32(18).string(a.output[d]);if(a.name!=null&&Object.hasOwnProperty.call(a,"name")&&u.uint32(26).string(a.name),a.opType!=null&&Object.hasOwnProperty.call(a,"opType")&&u.uint32(34).string(a.opType),a.attribute!=null&&a.attribute.length)for(var d=0;d<a.attribute.length;++d)s.onnx.AttributeProto.encode(a.attribute[d],u.uint32(42).fork()).ldelim();return a.docString!=null&&Object.hasOwnProperty.call(a,"docString")&&u.uint32(50).string(a.docString),a.domain!=null&&Object.hasOwnProperty.call(a,"domain")&&u.uint32(58).string(a.domain),u},c.encodeDelimited=function(a,u){return this.encode(a,u).ldelim()},c.decode=function(a,u){a instanceof t||(a=t.create(a));for(var d=u===void 0?a.len:a.pos+u,h=new s.onnx.NodeProto;a.pos<d;){var f=a.uint32();switch(f>>>3){case 1:{h.input&&h.input.length||(h.input=[]),h.input.push(a.string());break}case 2:{h.output&&h.output.length||(h.output=[]),h.output.push(a.string());break}case 3:{h.name=a.string();break}case 4:{h.opType=a.string();break}case 7:{h.domain=a.string();break}case 5:{h.attribute&&h.attribute.length||(h.attribute=[]),h.attribute.push(s.onnx.AttributeProto.decode(a,a.uint32()));break}case 6:{h.docString=a.string();break}default:a.skipType(f&7);break}}return h},c.decodeDelimited=function(a){return a instanceof t||(a=new t(a)),this.decode(a,a.uint32())},c.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.input!=null&&a.hasOwnProperty("input")){if(!Array.isArray(a.input))return"input: array expected";for(var u=0;u<a.input.length;++u)if(!o.isString(a.input[u]))return"input: string[] expected"}if(a.output!=null&&a.hasOwnProperty("output")){if(!Array.isArray(a.output))return"output: array expected";for(var u=0;u<a.output.length;++u)if(!o.isString(a.output[u]))return"output: string[] expected"}if(a.name!=null&&a.hasOwnProperty("name")&&!o.isString(a.name))return"name: string expected";if(a.opType!=null&&a.hasOwnProperty("opType")&&!o.isString(a.opType))return"opType: string expected";if(a.domain!=null&&a.hasOwnProperty("domain")&&!o.isString(a.domain))return"domain: string expected";if(a.attribute!=null&&a.hasOwnProperty("attribute")){if(!Array.isArray(a.attribute))return"attribute: array expected";for(var u=0;u<a.attribute.length;++u){var d=s.onnx.AttributeProto.verify(a.attribute[u]);if(d)return"attribute."+d}}return a.docString!=null&&a.hasOwnProperty("docString")&&!o.isString(a.docString)?"docString: string expected":null},c.fromObject=function(a){if(a instanceof s.onnx.NodeProto)return a;var u=new s.onnx.NodeProto;if(a.input){if(!Array.isArray(a.input))throw TypeError(".onnx.NodeProto.input: array expected");u.input=[];for(var d=0;d<a.input.length;++d)u.input[d]=String(a.input[d])}if(a.output){if(!Array.isArray(a.output))throw TypeError(".onnx.NodeProto.output: array expected");u.output=[];for(var d=0;d<a.output.length;++d)u.output[d]=String(a.output[d])}if(a.name!=null&&(u.name=String(a.name)),a.opType!=null&&(u.opType=String(a.opType)),a.domain!=null&&(u.domain=String(a.domain)),a.attribute){if(!Array.isArray(a.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");u.attribute=[];for(var d=0;d<a.attribute.length;++d){if(typeof a.attribute[d]!="object")throw TypeError(".onnx.NodeProto.attribute: object expected");u.attribute[d]=s.onnx.AttributeProto.fromObject(a.attribute[d])}}return a.docString!=null&&(u.docString=String(a.docString)),u},c.toObject=function(a,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.input=[],d.output=[],d.attribute=[]),u.defaults&&(d.name="",d.opType="",d.docString="",d.domain=""),a.input&&a.input.length){d.input=[];for(var h=0;h<a.input.length;++h)d.input[h]=a.input[h]}if(a.output&&a.output.length){d.output=[];for(var h=0;h<a.output.length;++h)d.output[h]=a.output[h]}if(a.name!=null&&a.hasOwnProperty("name")&&(d.name=a.name),a.opType!=null&&a.hasOwnProperty("opType")&&(d.opType=a.opType),a.attribute&&a.attribute.length){d.attribute=[];for(var h=0;h<a.attribute.length;++h)d.attribute[h]=s.onnx.AttributeProto.toObject(a.attribute[h],u)}return a.docString!=null&&a.hasOwnProperty("docString")&&(d.docString=a.docString),a.domain!=null&&a.hasOwnProperty("domain")&&(d.domain=a.domain),d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/onnx.NodeProto"},c}(),l.TrainingInfoProto=function(){function c(a){if(this.initializationBinding=[],this.updateBinding=[],a)for(var u=Object.keys(a),d=0;d<u.length;++d)a[u[d]]!=null&&(this[u[d]]=a[u[d]])}return c.prototype.initialization=null,c.prototype.algorithm=null,c.prototype.initializationBinding=o.emptyArray,c.prototype.updateBinding=o.emptyArray,c.create=function(a){return new c(a)},c.encode=function(a,u){if(u||(u=i.create()),a.initialization!=null&&Object.hasOwnProperty.call(a,"initialization")&&s.onnx.GraphProto.encode(a.initialization,u.uint32(10).fork()).ldelim(),a.algorithm!=null&&Object.hasOwnProperty.call(a,"algorithm")&&s.onnx.GraphProto.encode(a.algorithm,u.uint32(18).fork()).ldelim(),a.initializationBinding!=null&&a.initializationBinding.length)for(var d=0;d<a.initializationBinding.length;++d)s.onnx.StringStringEntryProto.encode(a.initializationBinding[d],u.uint32(26).fork()).ldelim();if(a.updateBinding!=null&&a.updateBinding.length)for(var d=0;d<a.updateBinding.length;++d)s.onnx.StringStringEntryProto.encode(a.updateBinding[d],u.uint32(34).fork()).ldelim();return u},c.encodeDelimited=function(a,u){return this.encode(a,u).ldelim()},c.decode=function(a,u){a instanceof t||(a=t.create(a));for(var d=u===void 0?a.len:a.pos+u,h=new s.onnx.TrainingInfoProto;a.pos<d;){var f=a.uint32();switch(f>>>3){case 1:{h.initialization=s.onnx.GraphProto.decode(a,a.uint32());break}case 2:{h.algorithm=s.onnx.GraphProto.decode(a,a.uint32());break}case 3:{h.initializationBinding&&h.initializationBinding.length||(h.initializationBinding=[]),h.initializationBinding.push(s.onnx.StringStringEntryProto.decode(a,a.uint32()));break}case 4:{h.updateBinding&&h.updateBinding.length||(h.updateBinding=[]),h.updateBinding.push(s.onnx.StringStringEntryProto.decode(a,a.uint32()));break}default:a.skipType(f&7);break}}return h},c.decodeDelimited=function(a){return a instanceof t||(a=new t(a)),this.decode(a,a.uint32())},c.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.initialization!=null&&a.hasOwnProperty("initialization")){var u=s.onnx.GraphProto.verify(a.initialization);if(u)return"initialization."+u}if(a.algorithm!=null&&a.hasOwnProperty("algorithm")){var u=s.onnx.GraphProto.verify(a.algorithm);if(u)return"algorithm."+u}if(a.initializationBinding!=null&&a.hasOwnProperty("initializationBinding")){if(!Array.isArray(a.initializationBinding))return"initializationBinding: array expected";for(var d=0;d<a.initializationBinding.length;++d){var u=s.onnx.StringStringEntryProto.verify(a.initializationBinding[d]);if(u)return"initializationBinding."+u}}if(a.updateBinding!=null&&a.hasOwnProperty("updateBinding")){if(!Array.isArray(a.updateBinding))return"updateBinding: array expected";for(var d=0;d<a.updateBinding.length;++d){var u=s.onnx.StringStringEntryProto.verify(a.updateBinding[d]);if(u)return"updateBinding."+u}}return null},c.fromObject=function(a){if(a instanceof s.onnx.TrainingInfoProto)return a;var u=new s.onnx.TrainingInfoProto;if(a.initialization!=null){if(typeof a.initialization!="object")throw TypeError(".onnx.TrainingInfoProto.initialization: object expected");u.initialization=s.onnx.GraphProto.fromObject(a.initialization)}if(a.algorithm!=null){if(typeof a.algorithm!="object")throw TypeError(".onnx.TrainingInfoProto.algorithm: object expected");u.algorithm=s.onnx.GraphProto.fromObject(a.algorithm)}if(a.initializationBinding){if(!Array.isArray(a.initializationBinding))throw TypeError(".onnx.TrainingInfoProto.initializationBinding: array expected");u.initializationBinding=[];for(var d=0;d<a.initializationBinding.length;++d){if(typeof a.initializationBinding[d]!="object")throw TypeError(".onnx.TrainingInfoProto.initializationBinding: object expected");u.initializationBinding[d]=s.onnx.StringStringEntryProto.fromObject(a.initializationBinding[d])}}if(a.updateBinding){if(!Array.isArray(a.updateBinding))throw TypeError(".onnx.TrainingInfoProto.updateBinding: array expected");u.updateBinding=[];for(var d=0;d<a.updateBinding.length;++d){if(typeof a.updateBinding[d]!="object")throw TypeError(".onnx.TrainingInfoProto.updateBinding: object expected");u.updateBinding[d]=s.onnx.StringStringEntryProto.fromObject(a.updateBinding[d])}}return u},c.toObject=function(a,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.initializationBinding=[],d.updateBinding=[]),u.defaults&&(d.initialization=null,d.algorithm=null),a.initialization!=null&&a.hasOwnProperty("initialization")&&(d.initialization=s.onnx.GraphProto.toObject(a.initialization,u)),a.algorithm!=null&&a.hasOwnProperty("algorithm")&&(d.algorithm=s.onnx.GraphProto.toObject(a.algorithm,u)),a.initializationBinding&&a.initializationBinding.length){d.initializationBinding=[];for(var h=0;h<a.initializationBinding.length;++h)d.initializationBinding[h]=s.onnx.StringStringEntryProto.toObject(a.initializationBinding[h],u)}if(a.updateBinding&&a.updateBinding.length){d.updateBinding=[];for(var h=0;h<a.updateBinding.length;++h)d.updateBinding[h]=s.onnx.StringStringEntryProto.toObject(a.updateBinding[h],u)}return d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/onnx.TrainingInfoProto"},c}(),l.ModelProto=function(){function c(a){if(this.opsetImport=[],this.metadataProps=[],this.trainingInfo=[],this.functions=[],a)for(var u=Object.keys(a),d=0;d<u.length;++d)a[u[d]]!=null&&(this[u[d]]=a[u[d]])}return c.prototype.irVersion=o.Long?o.Long.fromBits(0,0,!1):0,c.prototype.opsetImport=o.emptyArray,c.prototype.producerName="",c.prototype.producerVersion="",c.prototype.domain="",c.prototype.modelVersion=o.Long?o.Long.fromBits(0,0,!1):0,c.prototype.docString="",c.prototype.graph=null,c.prototype.metadataProps=o.emptyArray,c.prototype.trainingInfo=o.emptyArray,c.prototype.functions=o.emptyArray,c.create=function(a){return new c(a)},c.encode=function(a,u){if(u||(u=i.create()),a.irVersion!=null&&Object.hasOwnProperty.call(a,"irVersion")&&u.uint32(8).int64(a.irVersion),a.producerName!=null&&Object.hasOwnProperty.call(a,"producerName")&&u.uint32(18).string(a.producerName),a.producerVersion!=null&&Object.hasOwnProperty.call(a,"producerVersion")&&u.uint32(26).string(a.producerVersion),a.domain!=null&&Object.hasOwnProperty.call(a,"domain")&&u.uint32(34).string(a.domain),a.modelVersion!=null&&Object.hasOwnProperty.call(a,"modelVersion")&&u.uint32(40).int64(a.modelVersion),a.docString!=null&&Object.hasOwnProperty.call(a,"docString")&&u.uint32(50).string(a.docString),a.graph!=null&&Object.hasOwnProperty.call(a,"graph")&&s.onnx.GraphProto.encode(a.graph,u.uint32(58).fork()).ldelim(),a.opsetImport!=null&&a.opsetImport.length)for(var d=0;d<a.opsetImport.length;++d)s.onnx.OperatorSetIdProto.encode(a.opsetImport[d],u.uint32(66).fork()).ldelim();if(a.metadataProps!=null&&a.metadataProps.length)for(var d=0;d<a.metadataProps.length;++d)s.onnx.StringStringEntryProto.encode(a.metadataProps[d],u.uint32(114).fork()).ldelim();if(a.trainingInfo!=null&&a.trainingInfo.length)for(var d=0;d<a.trainingInfo.length;++d)s.onnx.TrainingInfoProto.encode(a.trainingInfo[d],u.uint32(162).fork()).ldelim();if(a.functions!=null&&a.functions.length)for(var d=0;d<a.functions.length;++d)s.onnx.FunctionProto.encode(a.functions[d],u.uint32(202).fork()).ldelim();return u},c.encodeDelimited=function(a,u){return this.encode(a,u).ldelim()},c.decode=function(a,u){a instanceof t||(a=t.create(a));for(var d=u===void 0?a.len:a.pos+u,h=new s.onnx.ModelProto;a.pos<d;){var f=a.uint32();switch(f>>>3){case 1:{h.irVersion=a.int64();break}case 8:{h.opsetImport&&h.opsetImport.length||(h.opsetImport=[]),h.opsetImport.push(s.onnx.OperatorSetIdProto.decode(a,a.uint32()));break}case 2:{h.producerName=a.string();break}case 3:{h.producerVersion=a.string();break}case 4:{h.domain=a.string();break}case 5:{h.modelVersion=a.int64();break}case 6:{h.docString=a.string();break}case 7:{h.graph=s.onnx.GraphProto.decode(a,a.uint32());break}case 14:{h.metadataProps&&h.metadataProps.length||(h.metadataProps=[]),h.metadataProps.push(s.onnx.StringStringEntryProto.decode(a,a.uint32()));break}case 20:{h.trainingInfo&&h.trainingInfo.length||(h.trainingInfo=[]),h.trainingInfo.push(s.onnx.TrainingInfoProto.decode(a,a.uint32()));break}case 25:{h.functions&&h.functions.length||(h.functions=[]),h.functions.push(s.onnx.FunctionProto.decode(a,a.uint32()));break}default:a.skipType(f&7);break}}return h},c.decodeDelimited=function(a){return a instanceof t||(a=new t(a)),this.decode(a,a.uint32())},c.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.irVersion!=null&&a.hasOwnProperty("irVersion")&&!o.isInteger(a.irVersion)&&!(a.irVersion&&o.isInteger(a.irVersion.low)&&o.isInteger(a.irVersion.high)))return"irVersion: integer|Long expected";if(a.opsetImport!=null&&a.hasOwnProperty("opsetImport")){if(!Array.isArray(a.opsetImport))return"opsetImport: array expected";for(var u=0;u<a.opsetImport.length;++u){var d=s.onnx.OperatorSetIdProto.verify(a.opsetImport[u]);if(d)return"opsetImport."+d}}if(a.producerName!=null&&a.hasOwnProperty("producerName")&&!o.isString(a.producerName))return"producerName: string expected";if(a.producerVersion!=null&&a.hasOwnProperty("producerVersion")&&!o.isString(a.producerVersion))return"producerVersion: string expected";if(a.domain!=null&&a.hasOwnProperty("domain")&&!o.isString(a.domain))return"domain: string expected";if(a.modelVersion!=null&&a.hasOwnProperty("modelVersion")&&!o.isInteger(a.modelVersion)&&!(a.modelVersion&&o.isInteger(a.modelVersion.low)&&o.isInteger(a.modelVersion.high)))return"modelVersion: integer|Long expected";if(a.docString!=null&&a.hasOwnProperty("docString")&&!o.isString(a.docString))return"docString: string expected";if(a.graph!=null&&a.hasOwnProperty("graph")){var d=s.onnx.GraphProto.verify(a.graph);if(d)return"graph."+d}if(a.metadataProps!=null&&a.hasOwnProperty("metadataProps")){if(!Array.isArray(a.metadataProps))return"metadataProps: array expected";for(var u=0;u<a.metadataProps.length;++u){var d=s.onnx.StringStringEntryProto.verify(a.metadataProps[u]);if(d)return"metadataProps."+d}}if(a.trainingInfo!=null&&a.hasOwnProperty("trainingInfo")){if(!Array.isArray(a.trainingInfo))return"trainingInfo: array expected";for(var u=0;u<a.trainingInfo.length;++u){var d=s.onnx.TrainingInfoProto.verify(a.trainingInfo[u]);if(d)return"trainingInfo."+d}}if(a.functions!=null&&a.hasOwnProperty("functions")){if(!Array.isArray(a.functions))return"functions: array expected";for(var u=0;u<a.functions.length;++u){var d=s.onnx.FunctionProto.verify(a.functions[u]);if(d)return"functions."+d}}return null},c.fromObject=function(a){if(a instanceof s.onnx.ModelProto)return a;var u=new s.onnx.ModelProto;if(a.irVersion!=null&&(o.Long?(u.irVersion=o.Long.fromValue(a.irVersion)).unsigned=!1:typeof a.irVersion=="string"?u.irVersion=parseInt(a.irVersion,10):typeof a.irVersion=="number"?u.irVersion=a.irVersion:typeof a.irVersion=="object"&&(u.irVersion=new o.LongBits(a.irVersion.low>>>0,a.irVersion.high>>>0).toNumber())),a.opsetImport){if(!Array.isArray(a.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");u.opsetImport=[];for(var d=0;d<a.opsetImport.length;++d){if(typeof a.opsetImport[d]!="object")throw TypeError(".onnx.ModelProto.opsetImport: object expected");u.opsetImport[d]=s.onnx.OperatorSetIdProto.fromObject(a.opsetImport[d])}}if(a.producerName!=null&&(u.producerName=String(a.producerName)),a.producerVersion!=null&&(u.producerVersion=String(a.producerVersion)),a.domain!=null&&(u.domain=String(a.domain)),a.modelVersion!=null&&(o.Long?(u.modelVersion=o.Long.fromValue(a.modelVersion)).unsigned=!1:typeof a.modelVersion=="string"?u.modelVersion=parseInt(a.modelVersion,10):typeof a.modelVersion=="number"?u.modelVersion=a.modelVersion:typeof a.modelVersion=="object"&&(u.modelVersion=new o.LongBits(a.modelVersion.low>>>0,a.modelVersion.high>>>0).toNumber())),a.docString!=null&&(u.docString=String(a.docString)),a.graph!=null){if(typeof a.graph!="object")throw TypeError(".onnx.ModelProto.graph: object expected");u.graph=s.onnx.GraphProto.fromObject(a.graph)}if(a.metadataProps){if(!Array.isArray(a.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");u.metadataProps=[];for(var d=0;d<a.metadataProps.length;++d){if(typeof a.metadataProps[d]!="object")throw TypeError(".onnx.ModelProto.metadataProps: object expected");u.metadataProps[d]=s.onnx.StringStringEntryProto.fromObject(a.metadataProps[d])}}if(a.trainingInfo){if(!Array.isArray(a.trainingInfo))throw TypeError(".onnx.ModelProto.trainingInfo: array expected");u.trainingInfo=[];for(var d=0;d<a.trainingInfo.length;++d){if(typeof a.trainingInfo[d]!="object")throw TypeError(".onnx.ModelProto.trainingInfo: object expected");u.trainingInfo[d]=s.onnx.TrainingInfoProto.fromObject(a.trainingInfo[d])}}if(a.functions){if(!Array.isArray(a.functions))throw TypeError(".onnx.ModelProto.functions: array expected");u.functions=[];for(var d=0;d<a.functions.length;++d){if(typeof a.functions[d]!="object")throw TypeError(".onnx.ModelProto.functions: object expected");u.functions[d]=s.onnx.FunctionProto.fromObject(a.functions[d])}}return u},c.toObject=function(a,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.opsetImport=[],d.metadataProps=[],d.trainingInfo=[],d.functions=[]),u.defaults){if(o.Long){var h=new o.Long(0,0,!1);d.irVersion=u.longs===String?h.toString():u.longs===Number?h.toNumber():h}else d.irVersion=u.longs===String?"0":0;if(d.producerName="",d.producerVersion="",d.domain="",o.Long){var h=new o.Long(0,0,!1);d.modelVersion=u.longs===String?h.toString():u.longs===Number?h.toNumber():h}else d.modelVersion=u.longs===String?"0":0;d.docString="",d.graph=null}if(a.irVersion!=null&&a.hasOwnProperty("irVersion")&&(typeof a.irVersion=="number"?d.irVersion=u.longs===String?String(a.irVersion):a.irVersion:d.irVersion=u.longs===String?o.Long.prototype.toString.call(a.irVersion):u.longs===Number?new o.LongBits(a.irVersion.low>>>0,a.irVersion.high>>>0).toNumber():a.irVersion),a.producerName!=null&&a.hasOwnProperty("producerName")&&(d.producerName=a.producerName),a.producerVersion!=null&&a.hasOwnProperty("producerVersion")&&(d.producerVersion=a.producerVersion),a.domain!=null&&a.hasOwnProperty("domain")&&(d.domain=a.domain),a.modelVersion!=null&&a.hasOwnProperty("modelVersion")&&(typeof a.modelVersion=="number"?d.modelVersion=u.longs===String?String(a.modelVersion):a.modelVersion:d.modelVersion=u.longs===String?o.Long.prototype.toString.call(a.modelVersion):u.longs===Number?new o.LongBits(a.modelVersion.low>>>0,a.modelVersion.high>>>0).toNumber():a.modelVersion),a.docString!=null&&a.hasOwnProperty("docString")&&(d.docString=a.docString),a.graph!=null&&a.hasOwnProperty("graph")&&(d.graph=s.onnx.GraphProto.toObject(a.graph,u)),a.opsetImport&&a.opsetImport.length){d.opsetImport=[];for(var f=0;f<a.opsetImport.length;++f)d.opsetImport[f]=s.onnx.OperatorSetIdProto.toObject(a.opsetImport[f],u)}if(a.metadataProps&&a.metadataProps.length){d.metadataProps=[];for(var f=0;f<a.metadataProps.length;++f)d.metadataProps[f]=s.onnx.StringStringEntryProto.toObject(a.metadataProps[f],u)}if(a.trainingInfo&&a.trainingInfo.length){d.trainingInfo=[];for(var f=0;f<a.trainingInfo.length;++f)d.trainingInfo[f]=s.onnx.TrainingInfoProto.toObject(a.trainingInfo[f],u)}if(a.functions&&a.functions.length){d.functions=[];for(var f=0;f<a.functions.length;++f)d.functions[f]=s.onnx.FunctionProto.toObject(a.functions[f],u)}return d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/onnx.ModelProto"},c}(),l.StringStringEntryProto=function(){function c(a){if(a)for(var u=Object.keys(a),d=0;d<u.length;++d)a[u[d]]!=null&&(this[u[d]]=a[u[d]])}return c.prototype.key="",c.prototype.value="",c.create=function(a){return new c(a)},c.encode=function(a,u){return u||(u=i.create()),a.key!=null&&Object.hasOwnProperty.call(a,"key")&&u.uint32(10).string(a.key),a.value!=null&&Object.hasOwnProperty.call(a,"value")&&u.uint32(18).string(a.value),u},c.encodeDelimited=function(a,u){return this.encode(a,u).ldelim()},c.decode=function(a,u){a instanceof t||(a=t.create(a));for(var d=u===void 0?a.len:a.pos+u,h=new s.onnx.StringStringEntryProto;a.pos<d;){var f=a.uint32();switch(f>>>3){case 1:{h.key=a.string();break}case 2:{h.value=a.string();break}default:a.skipType(f&7);break}}return h},c.decodeDelimited=function(a){return a instanceof t||(a=new t(a)),this.decode(a,a.uint32())},c.verify=function(a){return typeof a!="object"||a===null?"object expected":a.key!=null&&a.hasOwnProperty("key")&&!o.isString(a.key)?"key: string expected":a.value!=null&&a.hasOwnProperty("value")&&!o.isString(a.value)?"value: string expected":null},c.fromObject=function(a){if(a instanceof s.onnx.StringStringEntryProto)return a;var u=new s.onnx.StringStringEntryProto;return a.key!=null&&(u.key=String(a.key)),a.value!=null&&(u.value=String(a.value)),u},c.toObject=function(a,u){u||(u={});var d={};return u.defaults&&(d.key="",d.value=""),a.key!=null&&a.hasOwnProperty("key")&&(d.key=a.key),a.value!=null&&a.hasOwnProperty("value")&&(d.value=a.value),d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/onnx.StringStringEntryProto"},c}(),l.TensorAnnotation=function(){function c(a){if(this.quantParameterTensorNames=[],a)for(var u=Object.keys(a),d=0;d<u.length;++d)a[u[d]]!=null&&(this[u[d]]=a[u[d]])}return c.prototype.tensorName="",c.prototype.quantParameterTensorNames=o.emptyArray,c.create=function(a){return new c(a)},c.encode=function(a,u){if(u||(u=i.create()),a.tensorName!=null&&Object.hasOwnProperty.call(a,"tensorName")&&u.uint32(10).string(a.tensorName),a.quantParameterTensorNames!=null&&a.quantParameterTensorNames.length)for(var d=0;d<a.quantParameterTensorNames.length;++d)s.onnx.StringStringEntryProto.encode(a.quantParameterTensorNames[d],u.uint32(18).fork()).ldelim();return u},c.encodeDelimited=function(a,u){return this.encode(a,u).ldelim()},c.decode=function(a,u){a instanceof t||(a=t.create(a));for(var d=u===void 0?a.len:a.pos+u,h=new s.onnx.TensorAnnotation;a.pos<d;){var f=a.uint32();switch(f>>>3){case 1:{h.tensorName=a.string();break}case 2:{h.quantParameterTensorNames&&h.quantParameterTensorNames.length||(h.quantParameterTensorNames=[]),h.quantParameterTensorNames.push(s.onnx.StringStringEntryProto.decode(a,a.uint32()));break}default:a.skipType(f&7);break}}return h},c.decodeDelimited=function(a){return a instanceof t||(a=new t(a)),this.decode(a,a.uint32())},c.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.tensorName!=null&&a.hasOwnProperty("tensorName")&&!o.isString(a.tensorName))return"tensorName: string expected";if(a.quantParameterTensorNames!=null&&a.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(a.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var u=0;u<a.quantParameterTensorNames.length;++u){var d=s.onnx.StringStringEntryProto.verify(a.quantParameterTensorNames[u]);if(d)return"quantParameterTensorNames."+d}}return null},c.fromObject=function(a){if(a instanceof s.onnx.TensorAnnotation)return a;var u=new s.onnx.TensorAnnotation;if(a.tensorName!=null&&(u.tensorName=String(a.tensorName)),a.quantParameterTensorNames){if(!Array.isArray(a.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");u.quantParameterTensorNames=[];for(var d=0;d<a.quantParameterTensorNames.length;++d){if(typeof a.quantParameterTensorNames[d]!="object")throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");u.quantParameterTensorNames[d]=s.onnx.StringStringEntryProto.fromObject(a.quantParameterTensorNames[d])}}return u},c.toObject=function(a,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.quantParameterTensorNames=[]),u.defaults&&(d.tensorName=""),a.tensorName!=null&&a.hasOwnProperty("tensorName")&&(d.tensorName=a.tensorName),a.quantParameterTensorNames&&a.quantParameterTensorNames.length){d.quantParameterTensorNames=[];for(var h=0;h<a.quantParameterTensorNames.length;++h)d.quantParameterTensorNames[h]=s.onnx.StringStringEntryProto.toObject(a.quantParameterTensorNames[h],u)}return d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/onnx.TensorAnnotation"},c}(),l.GraphProto=function(){function c(a){if(this.node=[],this.initializer=[],this.sparseInitializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],a)for(var u=Object.keys(a),d=0;d<u.length;++d)a[u[d]]!=null&&(this[u[d]]=a[u[d]])}return c.prototype.node=o.emptyArray,c.prototype.name="",c.prototype.initializer=o.emptyArray,c.prototype.sparseInitializer=o.emptyArray,c.prototype.docString="",c.prototype.input=o.emptyArray,c.prototype.output=o.emptyArray,c.prototype.valueInfo=o.emptyArray,c.prototype.quantizationAnnotation=o.emptyArray,c.create=function(a){return new c(a)},c.encode=function(a,u){if(u||(u=i.create()),a.node!=null&&a.node.length)for(var d=0;d<a.node.length;++d)s.onnx.NodeProto.encode(a.node[d],u.uint32(10).fork()).ldelim();if(a.name!=null&&Object.hasOwnProperty.call(a,"name")&&u.uint32(18).string(a.name),a.initializer!=null&&a.initializer.length)for(var d=0;d<a.initializer.length;++d)s.onnx.TensorProto.encode(a.initializer[d],u.uint32(42).fork()).ldelim();if(a.docString!=null&&Object.hasOwnProperty.call(a,"docString")&&u.uint32(82).string(a.docString),a.input!=null&&a.input.length)for(var d=0;d<a.input.length;++d)s.onnx.ValueInfoProto.encode(a.input[d],u.uint32(90).fork()).ldelim();if(a.output!=null&&a.output.length)for(var d=0;d<a.output.length;++d)s.onnx.ValueInfoProto.encode(a.output[d],u.uint32(98).fork()).ldelim();if(a.valueInfo!=null&&a.valueInfo.length)for(var d=0;d<a.valueInfo.length;++d)s.onnx.ValueInfoProto.encode(a.valueInfo[d],u.uint32(106).fork()).ldelim();if(a.quantizationAnnotation!=null&&a.quantizationAnnotation.length)for(var d=0;d<a.quantizationAnnotation.length;++d)s.onnx.TensorAnnotation.encode(a.quantizationAnnotation[d],u.uint32(114).fork()).ldelim();if(a.sparseInitializer!=null&&a.sparseInitializer.length)for(var d=0;d<a.sparseInitializer.length;++d)s.onnx.SparseTensorProto.encode(a.sparseInitializer[d],u.uint32(122).fork()).ldelim();return u},c.encodeDelimited=function(a,u){return this.encode(a,u).ldelim()},c.decode=function(a,u){a instanceof t||(a=t.create(a));for(var d=u===void 0?a.len:a.pos+u,h=new s.onnx.GraphProto;a.pos<d;){var f=a.uint32();switch(f>>>3){case 1:{h.node&&h.node.length||(h.node=[]),h.node.push(s.onnx.NodeProto.decode(a,a.uint32()));break}case 2:{h.name=a.string();break}case 5:{h.initializer&&h.initializer.length||(h.initializer=[]),h.initializer.push(s.onnx.TensorProto.decode(a,a.uint32()));break}case 15:{h.sparseInitializer&&h.sparseInitializer.length||(h.sparseInitializer=[]),h.sparseInitializer.push(s.onnx.SparseTensorProto.decode(a,a.uint32()));break}case 10:{h.docString=a.string();break}case 11:{h.input&&h.input.length||(h.input=[]),h.input.push(s.onnx.ValueInfoProto.decode(a,a.uint32()));break}case 12:{h.output&&h.output.length||(h.output=[]),h.output.push(s.onnx.ValueInfoProto.decode(a,a.uint32()));break}case 13:{h.valueInfo&&h.valueInfo.length||(h.valueInfo=[]),h.valueInfo.push(s.onnx.ValueInfoProto.decode(a,a.uint32()));break}case 14:{h.quantizationAnnotation&&h.quantizationAnnotation.length||(h.quantizationAnnotation=[]),h.quantizationAnnotation.push(s.onnx.TensorAnnotation.decode(a,a.uint32()));break}default:a.skipType(f&7);break}}return h},c.decodeDelimited=function(a){return a instanceof t||(a=new t(a)),this.decode(a,a.uint32())},c.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.node!=null&&a.hasOwnProperty("node")){if(!Array.isArray(a.node))return"node: array expected";for(var u=0;u<a.node.length;++u){var d=s.onnx.NodeProto.verify(a.node[u]);if(d)return"node."+d}}if(a.name!=null&&a.hasOwnProperty("name")&&!o.isString(a.name))return"name: string expected";if(a.initializer!=null&&a.hasOwnProperty("initializer")){if(!Array.isArray(a.initializer))return"initializer: array expected";for(var u=0;u<a.initializer.length;++u){var d=s.onnx.TensorProto.verify(a.initializer[u]);if(d)return"initializer."+d}}if(a.sparseInitializer!=null&&a.hasOwnProperty("sparseInitializer")){if(!Array.isArray(a.sparseInitializer))return"sparseInitializer: array expected";for(var u=0;u<a.sparseInitializer.length;++u){var d=s.onnx.SparseTensorProto.verify(a.sparseInitializer[u]);if(d)return"sparseInitializer."+d}}if(a.docString!=null&&a.hasOwnProperty("docString")&&!o.isString(a.docString))return"docString: string expected";if(a.input!=null&&a.hasOwnProperty("input")){if(!Array.isArray(a.input))return"input: array expected";for(var u=0;u<a.input.length;++u){var d=s.onnx.ValueInfoProto.verify(a.input[u]);if(d)return"input."+d}}if(a.output!=null&&a.hasOwnProperty("output")){if(!Array.isArray(a.output))return"output: array expected";for(var u=0;u<a.output.length;++u){var d=s.onnx.ValueInfoProto.verify(a.output[u]);if(d)return"output."+d}}if(a.valueInfo!=null&&a.hasOwnProperty("valueInfo")){if(!Array.isArray(a.valueInfo))return"valueInfo: array expected";for(var u=0;u<a.valueInfo.length;++u){var d=s.onnx.ValueInfoProto.verify(a.valueInfo[u]);if(d)return"valueInfo."+d}}if(a.quantizationAnnotation!=null&&a.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(a.quantizationAnnotation))return"quantizationAnnotation: array expected";for(var u=0;u<a.quantizationAnnotation.length;++u){var d=s.onnx.TensorAnnotation.verify(a.quantizationAnnotation[u]);if(d)return"quantizationAnnotation."+d}}return null},c.fromObject=function(a){if(a instanceof s.onnx.GraphProto)return a;var u=new s.onnx.GraphProto;if(a.node){if(!Array.isArray(a.node))throw TypeError(".onnx.GraphProto.node: array expected");u.node=[];for(var d=0;d<a.node.length;++d){if(typeof a.node[d]!="object")throw TypeError(".onnx.GraphProto.node: object expected");u.node[d]=s.onnx.NodeProto.fromObject(a.node[d])}}if(a.name!=null&&(u.name=String(a.name)),a.initializer){if(!Array.isArray(a.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");u.initializer=[];for(var d=0;d<a.initializer.length;++d){if(typeof a.initializer[d]!="object")throw TypeError(".onnx.GraphProto.initializer: object expected");u.initializer[d]=s.onnx.TensorProto.fromObject(a.initializer[d])}}if(a.sparseInitializer){if(!Array.isArray(a.sparseInitializer))throw TypeError(".onnx.GraphProto.sparseInitializer: array expected");u.sparseInitializer=[];for(var d=0;d<a.sparseInitializer.length;++d){if(typeof a.sparseInitializer[d]!="object")throw TypeError(".onnx.GraphProto.sparseInitializer: object expected");u.sparseInitializer[d]=s.onnx.SparseTensorProto.fromObject(a.sparseInitializer[d])}}if(a.docString!=null&&(u.docString=String(a.docString)),a.input){if(!Array.isArray(a.input))throw TypeError(".onnx.GraphProto.input: array expected");u.input=[];for(var d=0;d<a.input.length;++d){if(typeof a.input[d]!="object")throw TypeError(".onnx.GraphProto.input: object expected");u.input[d]=s.onnx.ValueInfoProto.fromObject(a.input[d])}}if(a.output){if(!Array.isArray(a.output))throw TypeError(".onnx.GraphProto.output: array expected");u.output=[];for(var d=0;d<a.output.length;++d){if(typeof a.output[d]!="object")throw TypeError(".onnx.GraphProto.output: object expected");u.output[d]=s.onnx.ValueInfoProto.fromObject(a.output[d])}}if(a.valueInfo){if(!Array.isArray(a.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");u.valueInfo=[];for(var d=0;d<a.valueInfo.length;++d){if(typeof a.valueInfo[d]!="object")throw TypeError(".onnx.GraphProto.valueInfo: object expected");u.valueInfo[d]=s.onnx.ValueInfoProto.fromObject(a.valueInfo[d])}}if(a.quantizationAnnotation){if(!Array.isArray(a.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");u.quantizationAnnotation=[];for(var d=0;d<a.quantizationAnnotation.length;++d){if(typeof a.quantizationAnnotation[d]!="object")throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");u.quantizationAnnotation[d]=s.onnx.TensorAnnotation.fromObject(a.quantizationAnnotation[d])}}return u},c.toObject=function(a,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.node=[],d.initializer=[],d.input=[],d.output=[],d.valueInfo=[],d.quantizationAnnotation=[],d.sparseInitializer=[]),u.defaults&&(d.name="",d.docString=""),a.node&&a.node.length){d.node=[];for(var h=0;h<a.node.length;++h)d.node[h]=s.onnx.NodeProto.toObject(a.node[h],u)}if(a.name!=null&&a.hasOwnProperty("name")&&(d.name=a.name),a.initializer&&a.initializer.length){d.initializer=[];for(var h=0;h<a.initializer.length;++h)d.initializer[h]=s.onnx.TensorProto.toObject(a.initializer[h],u)}if(a.docString!=null&&a.hasOwnProperty("docString")&&(d.docString=a.docString),a.input&&a.input.length){d.input=[];for(var h=0;h<a.input.length;++h)d.input[h]=s.onnx.ValueInfoProto.toObject(a.input[h],u)}if(a.output&&a.output.length){d.output=[];for(var h=0;h<a.output.length;++h)d.output[h]=s.onnx.ValueInfoProto.toObject(a.output[h],u)}if(a.valueInfo&&a.valueInfo.length){d.valueInfo=[];for(var h=0;h<a.valueInfo.length;++h)d.valueInfo[h]=s.onnx.ValueInfoProto.toObject(a.valueInfo[h],u)}if(a.quantizationAnnotation&&a.quantizationAnnotation.length){d.quantizationAnnotation=[];for(var h=0;h<a.quantizationAnnotation.length;++h)d.quantizationAnnotation[h]=s.onnx.TensorAnnotation.toObject(a.quantizationAnnotation[h],u)}if(a.sparseInitializer&&a.sparseInitializer.length){d.sparseInitializer=[];for(var h=0;h<a.sparseInitializer.length;++h)d.sparseInitializer[h]=s.onnx.SparseTensorProto.toObject(a.sparseInitializer[h],u)}return d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/onnx.GraphProto"},c}(),l.TensorProto=function(){function c(a){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],a)for(var u=Object.keys(a),d=0;d<u.length;++d)a[u[d]]!=null&&(this[u[d]]=a[u[d]])}return c.prototype.dims=o.emptyArray,c.prototype.dataType=0,c.prototype.segment=null,c.prototype.floatData=o.emptyArray,c.prototype.int32Data=o.emptyArray,c.prototype.stringData=o.emptyArray,c.prototype.int64Data=o.emptyArray,c.prototype.name="",c.prototype.docString="",c.prototype.rawData=o.newBuffer([]),c.prototype.externalData=o.emptyArray,c.prototype.dataLocation=0,c.prototype.doubleData=o.emptyArray,c.prototype.uint64Data=o.emptyArray,c.create=function(a){return new c(a)},c.encode=function(a,u){if(u||(u=i.create()),a.dims!=null&&a.dims.length){u.uint32(10).fork();for(var d=0;d<a.dims.length;++d)u.int64(a.dims[d]);u.ldelim()}if(a.dataType!=null&&Object.hasOwnProperty.call(a,"dataType")&&u.uint32(16).int32(a.dataType),a.segment!=null&&Object.hasOwnProperty.call(a,"segment")&&s.onnx.TensorProto.Segment.encode(a.segment,u.uint32(26).fork()).ldelim(),a.floatData!=null&&a.floatData.length){u.uint32(34).fork();for(var d=0;d<a.floatData.length;++d)u.float(a.floatData[d]);u.ldelim()}if(a.int32Data!=null&&a.int32Data.length){u.uint32(42).fork();for(var d=0;d<a.int32Data.length;++d)u.int32(a.int32Data[d]);u.ldelim()}if(a.stringData!=null&&a.stringData.length)for(var d=0;d<a.stringData.length;++d)u.uint32(50).bytes(a.stringData[d]);if(a.int64Data!=null&&a.int64Data.length){u.uint32(58).fork();for(var d=0;d<a.int64Data.length;++d)u.int64(a.int64Data[d]);u.ldelim()}if(a.name!=null&&Object.hasOwnProperty.call(a,"name")&&u.uint32(66).string(a.name),a.rawData!=null&&Object.hasOwnProperty.call(a,"rawData")&&u.uint32(74).bytes(a.rawData),a.doubleData!=null&&a.doubleData.length){u.uint32(82).fork();for(var d=0;d<a.doubleData.length;++d)u.double(a.doubleData[d]);u.ldelim()}if(a.uint64Data!=null&&a.uint64Data.length){u.uint32(90).fork();for(var d=0;d<a.uint64Data.length;++d)u.uint64(a.uint64Data[d]);u.ldelim()}if(a.docString!=null&&Object.hasOwnProperty.call(a,"docString")&&u.uint32(98).string(a.docString),a.externalData!=null&&a.externalData.length)for(var d=0;d<a.externalData.length;++d)s.onnx.StringStringEntryProto.encode(a.externalData[d],u.uint32(106).fork()).ldelim();return a.dataLocation!=null&&Object.hasOwnProperty.call(a,"dataLocation")&&u.uint32(112).int32(a.dataLocation),u},c.encodeDelimited=function(a,u){return this.encode(a,u).ldelim()},c.decode=function(a,u){a instanceof t||(a=t.create(a));for(var d=u===void 0?a.len:a.pos+u,h=new s.onnx.TensorProto;a.pos<d;){var f=a.uint32();switch(f>>>3){case 1:{if(h.dims&&h.dims.length||(h.dims=[]),(f&7)===2)for(var p=a.uint32()+a.pos;a.pos<p;)h.dims.push(a.int64());else h.dims.push(a.int64());break}case 2:{h.dataType=a.int32();break}case 3:{h.segment=s.onnx.TensorProto.Segment.decode(a,a.uint32());break}case 4:{if(h.floatData&&h.floatData.length||(h.floatData=[]),(f&7)===2)for(var p=a.uint32()+a.pos;a.pos<p;)h.floatData.push(a.float());else h.floatData.push(a.float());break}case 5:{if(h.int32Data&&h.int32Data.length||(h.int32Data=[]),(f&7)===2)for(var p=a.uint32()+a.pos;a.pos<p;)h.int32Data.push(a.int32());else h.int32Data.push(a.int32());break}case 6:{h.stringData&&h.stringData.length||(h.stringData=[]),h.stringData.push(a.bytes());break}case 7:{if(h.int64Data&&h.int64Data.length||(h.int64Data=[]),(f&7)===2)for(var p=a.uint32()+a.pos;a.pos<p;)h.int64Data.push(a.int64());else h.int64Data.push(a.int64());break}case 8:{h.name=a.string();break}case 12:{h.docString=a.string();break}case 9:{h.rawData=a.bytes();break}case 13:{h.externalData&&h.externalData.length||(h.externalData=[]),h.externalData.push(s.onnx.StringStringEntryProto.decode(a,a.uint32()));break}case 14:{h.dataLocation=a.int32();break}case 10:{if(h.doubleData&&h.doubleData.length||(h.doubleData=[]),(f&7)===2)for(var p=a.uint32()+a.pos;a.pos<p;)h.doubleData.push(a.double());else h.doubleData.push(a.double());break}case 11:{if(h.uint64Data&&h.uint64Data.length||(h.uint64Data=[]),(f&7)===2)for(var p=a.uint32()+a.pos;a.pos<p;)h.uint64Data.push(a.uint64());else h.uint64Data.push(a.uint64());break}default:a.skipType(f&7);break}}return h},c.decodeDelimited=function(a){return a instanceof t||(a=new t(a)),this.decode(a,a.uint32())},c.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.dims!=null&&a.hasOwnProperty("dims")){if(!Array.isArray(a.dims))return"dims: array expected";for(var u=0;u<a.dims.length;++u)if(!o.isInteger(a.dims[u])&&!(a.dims[u]&&o.isInteger(a.dims[u].low)&&o.isInteger(a.dims[u].high)))return"dims: integer|Long[] expected"}if(a.dataType!=null&&a.hasOwnProperty("dataType")&&!o.isInteger(a.dataType))return"dataType: integer expected";if(a.segment!=null&&a.hasOwnProperty("segment")){var d=s.onnx.TensorProto.Segment.verify(a.segment);if(d)return"segment."+d}if(a.floatData!=null&&a.hasOwnProperty("floatData")){if(!Array.isArray(a.floatData))return"floatData: array expected";for(var u=0;u<a.floatData.length;++u)if(typeof a.floatData[u]!="number")return"floatData: number[] expected"}if(a.int32Data!=null&&a.hasOwnProperty("int32Data")){if(!Array.isArray(a.int32Data))return"int32Data: array expected";for(var u=0;u<a.int32Data.length;++u)if(!o.isInteger(a.int32Data[u]))return"int32Data: integer[] expected"}if(a.stringData!=null&&a.hasOwnProperty("stringData")){if(!Array.isArray(a.stringData))return"stringData: array expected";for(var u=0;u<a.stringData.length;++u)if(!(a.stringData[u]&&typeof a.stringData[u].length=="number"||o.isString(a.stringData[u])))return"stringData: buffer[] expected"}if(a.int64Data!=null&&a.hasOwnProperty("int64Data")){if(!Array.isArray(a.int64Data))return"int64Data: array expected";for(var u=0;u<a.int64Data.length;++u)if(!o.isInteger(a.int64Data[u])&&!(a.int64Data[u]&&o.isInteger(a.int64Data[u].low)&&o.isInteger(a.int64Data[u].high)))return"int64Data: integer|Long[] expected"}if(a.name!=null&&a.hasOwnProperty("name")&&!o.isString(a.name))return"name: string expected";if(a.docString!=null&&a.hasOwnProperty("docString")&&!o.isString(a.docString))return"docString: string expected";if(a.rawData!=null&&a.hasOwnProperty("rawData")&&!(a.rawData&&typeof a.rawData.length=="number"||o.isString(a.rawData)))return"rawData: buffer expected";if(a.externalData!=null&&a.hasOwnProperty("externalData")){if(!Array.isArray(a.externalData))return"externalData: array expected";for(var u=0;u<a.externalData.length;++u){var d=s.onnx.StringStringEntryProto.verify(a.externalData[u]);if(d)return"externalData."+d}}if(a.dataLocation!=null&&a.hasOwnProperty("dataLocation"))switch(a.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:break}if(a.doubleData!=null&&a.hasOwnProperty("doubleData")){if(!Array.isArray(a.doubleData))return"doubleData: array expected";for(var u=0;u<a.doubleData.length;++u)if(typeof a.doubleData[u]!="number")return"doubleData: number[] expected"}if(a.uint64Data!=null&&a.hasOwnProperty("uint64Data")){if(!Array.isArray(a.uint64Data))return"uint64Data: array expected";for(var u=0;u<a.uint64Data.length;++u)if(!o.isInteger(a.uint64Data[u])&&!(a.uint64Data[u]&&o.isInteger(a.uint64Data[u].low)&&o.isInteger(a.uint64Data[u].high)))return"uint64Data: integer|Long[] expected"}return null},c.fromObject=function(a){if(a instanceof s.onnx.TensorProto)return a;var u=new s.onnx.TensorProto;if(a.dims){if(!Array.isArray(a.dims))throw TypeError(".onnx.TensorProto.dims: array expected");u.dims=[];for(var d=0;d<a.dims.length;++d)o.Long?(u.dims[d]=o.Long.fromValue(a.dims[d])).unsigned=!1:typeof a.dims[d]=="string"?u.dims[d]=parseInt(a.dims[d],10):typeof a.dims[d]=="number"?u.dims[d]=a.dims[d]:typeof a.dims[d]=="object"&&(u.dims[d]=new o.LongBits(a.dims[d].low>>>0,a.dims[d].high>>>0).toNumber())}if(a.dataType!=null&&(u.dataType=a.dataType|0),a.segment!=null){if(typeof a.segment!="object")throw TypeError(".onnx.TensorProto.segment: object expected");u.segment=s.onnx.TensorProto.Segment.fromObject(a.segment)}if(a.floatData){if(!Array.isArray(a.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");u.floatData=[];for(var d=0;d<a.floatData.length;++d)u.floatData[d]=Number(a.floatData[d])}if(a.int32Data){if(!Array.isArray(a.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");u.int32Data=[];for(var d=0;d<a.int32Data.length;++d)u.int32Data[d]=a.int32Data[d]|0}if(a.stringData){if(!Array.isArray(a.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");u.stringData=[];for(var d=0;d<a.stringData.length;++d)typeof a.stringData[d]=="string"?o.base64.decode(a.stringData[d],u.stringData[d]=o.newBuffer(o.base64.length(a.stringData[d])),0):a.stringData[d].length>=0&&(u.stringData[d]=a.stringData[d])}if(a.int64Data){if(!Array.isArray(a.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");u.int64Data=[];for(var d=0;d<a.int64Data.length;++d)o.Long?(u.int64Data[d]=o.Long.fromValue(a.int64Data[d])).unsigned=!1:typeof a.int64Data[d]=="string"?u.int64Data[d]=parseInt(a.int64Data[d],10):typeof a.int64Data[d]=="number"?u.int64Data[d]=a.int64Data[d]:typeof a.int64Data[d]=="object"&&(u.int64Data[d]=new o.LongBits(a.int64Data[d].low>>>0,a.int64Data[d].high>>>0).toNumber())}if(a.name!=null&&(u.name=String(a.name)),a.docString!=null&&(u.docString=String(a.docString)),a.rawData!=null&&(typeof a.rawData=="string"?o.base64.decode(a.rawData,u.rawData=o.newBuffer(o.base64.length(a.rawData)),0):a.rawData.length>=0&&(u.rawData=a.rawData)),a.externalData){if(!Array.isArray(a.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");u.externalData=[];for(var d=0;d<a.externalData.length;++d){if(typeof a.externalData[d]!="object")throw TypeError(".onnx.TensorProto.externalData: object expected");u.externalData[d]=s.onnx.StringStringEntryProto.fromObject(a.externalData[d])}}switch(a.dataLocation){default:if(typeof a.dataLocation=="number"){u.dataLocation=a.dataLocation;break}break;case"DEFAULT":case 0:u.dataLocation=0;break;case"EXTERNAL":case 1:u.dataLocation=1;break}if(a.doubleData){if(!Array.isArray(a.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");u.doubleData=[];for(var d=0;d<a.doubleData.length;++d)u.doubleData[d]=Number(a.doubleData[d])}if(a.uint64Data){if(!Array.isArray(a.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");u.uint64Data=[];for(var d=0;d<a.uint64Data.length;++d)o.Long?(u.uint64Data[d]=o.Long.fromValue(a.uint64Data[d])).unsigned=!0:typeof a.uint64Data[d]=="string"?u.uint64Data[d]=parseInt(a.uint64Data[d],10):typeof a.uint64Data[d]=="number"?u.uint64Data[d]=a.uint64Data[d]:typeof a.uint64Data[d]=="object"&&(u.uint64Data[d]=new o.LongBits(a.uint64Data[d].low>>>0,a.uint64Data[d].high>>>0).toNumber(!0))}return u},c.toObject=function(a,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.dims=[],d.floatData=[],d.int32Data=[],d.stringData=[],d.int64Data=[],d.doubleData=[],d.uint64Data=[],d.externalData=[]),u.defaults&&(d.dataType=0,d.segment=null,d.name="",u.bytes===String?d.rawData="":(d.rawData=[],u.bytes!==Array&&(d.rawData=o.newBuffer(d.rawData))),d.docString="",d.dataLocation=u.enums===String?"DEFAULT":0),a.dims&&a.dims.length){d.dims=[];for(var h=0;h<a.dims.length;++h)typeof a.dims[h]=="number"?d.dims[h]=u.longs===String?String(a.dims[h]):a.dims[h]:d.dims[h]=u.longs===String?o.Long.prototype.toString.call(a.dims[h]):u.longs===Number?new o.LongBits(a.dims[h].low>>>0,a.dims[h].high>>>0).toNumber():a.dims[h]}if(a.dataType!=null&&a.hasOwnProperty("dataType")&&(d.dataType=a.dataType),a.segment!=null&&a.hasOwnProperty("segment")&&(d.segment=s.onnx.TensorProto.Segment.toObject(a.segment,u)),a.floatData&&a.floatData.length){d.floatData=[];for(var h=0;h<a.floatData.length;++h)d.floatData[h]=u.json&&!isFinite(a.floatData[h])?String(a.floatData[h]):a.floatData[h]}if(a.int32Data&&a.int32Data.length){d.int32Data=[];for(var h=0;h<a.int32Data.length;++h)d.int32Data[h]=a.int32Data[h]}if(a.stringData&&a.stringData.length){d.stringData=[];for(var h=0;h<a.stringData.length;++h)d.stringData[h]=u.bytes===String?o.base64.encode(a.stringData[h],0,a.stringData[h].length):u.bytes===Array?Array.prototype.slice.call(a.stringData[h]):a.stringData[h]}if(a.int64Data&&a.int64Data.length){d.int64Data=[];for(var h=0;h<a.int64Data.length;++h)typeof a.int64Data[h]=="number"?d.int64Data[h]=u.longs===String?String(a.int64Data[h]):a.int64Data[h]:d.int64Data[h]=u.longs===String?o.Long.prototype.toString.call(a.int64Data[h]):u.longs===Number?new o.LongBits(a.int64Data[h].low>>>0,a.int64Data[h].high>>>0).toNumber():a.int64Data[h]}if(a.name!=null&&a.hasOwnProperty("name")&&(d.name=a.name),a.rawData!=null&&a.hasOwnProperty("rawData")&&(d.rawData=u.bytes===String?o.base64.encode(a.rawData,0,a.rawData.length):u.bytes===Array?Array.prototype.slice.call(a.rawData):a.rawData),a.doubleData&&a.doubleData.length){d.doubleData=[];for(var h=0;h<a.doubleData.length;++h)d.doubleData[h]=u.json&&!isFinite(a.doubleData[h])?String(a.doubleData[h]):a.doubleData[h]}if(a.uint64Data&&a.uint64Data.length){d.uint64Data=[];for(var h=0;h<a.uint64Data.length;++h)typeof a.uint64Data[h]=="number"?d.uint64Data[h]=u.longs===String?String(a.uint64Data[h]):a.uint64Data[h]:d.uint64Data[h]=u.longs===String?o.Long.prototype.toString.call(a.uint64Data[h]):u.longs===Number?new o.LongBits(a.uint64Data[h].low>>>0,a.uint64Data[h].high>>>0).toNumber(!0):a.uint64Data[h]}if(a.docString!=null&&a.hasOwnProperty("docString")&&(d.docString=a.docString),a.externalData&&a.externalData.length){d.externalData=[];for(var h=0;h<a.externalData.length;++h)d.externalData[h]=s.onnx.StringStringEntryProto.toObject(a.externalData[h],u)}return a.dataLocation!=null&&a.hasOwnProperty("dataLocation")&&(d.dataLocation=u.enums===String?s.onnx.TensorProto.DataLocation[a.dataLocation]===void 0?a.dataLocation:s.onnx.TensorProto.DataLocation[a.dataLocation]:a.dataLocation),d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/onnx.TensorProto"},c.DataType=function(){var a={},u=Object.create(a);return u[a[0]="UNDEFINED"]=0,u[a[1]="FLOAT"]=1,u[a[2]="UINT8"]=2,u[a[3]="INT8"]=3,u[a[4]="UINT16"]=4,u[a[5]="INT16"]=5,u[a[6]="INT32"]=6,u[a[7]="INT64"]=7,u[a[8]="STRING"]=8,u[a[9]="BOOL"]=9,u[a[10]="FLOAT16"]=10,u[a[11]="DOUBLE"]=11,u[a[12]="UINT32"]=12,u[a[13]="UINT64"]=13,u[a[14]="COMPLEX64"]=14,u[a[15]="COMPLEX128"]=15,u[a[16]="BFLOAT16"]=16,u[a[17]="FLOAT8E4M3FN"]=17,u[a[18]="FLOAT8E4M3FNUZ"]=18,u[a[19]="FLOAT8E5M2"]=19,u[a[20]="FLOAT8E5M2FNUZ"]=20,u}(),c.Segment=function(){function a(u){if(u)for(var d=Object.keys(u),h=0;h<d.length;++h)u[d[h]]!=null&&(this[d[h]]=u[d[h]])}return a.prototype.begin=o.Long?o.Long.fromBits(0,0,!1):0,a.prototype.end=o.Long?o.Long.fromBits(0,0,!1):0,a.create=function(u){return new a(u)},a.encode=function(u,d){return d||(d=i.create()),u.begin!=null&&Object.hasOwnProperty.call(u,"begin")&&d.uint32(8).int64(u.begin),u.end!=null&&Object.hasOwnProperty.call(u,"end")&&d.uint32(16).int64(u.end),d},a.encodeDelimited=function(u,d){return this.encode(u,d).ldelim()},a.decode=function(u,d){u instanceof t||(u=t.create(u));for(var h=d===void 0?u.len:u.pos+d,f=new s.onnx.TensorProto.Segment;u.pos<h;){var p=u.uint32();switch(p>>>3){case 1:{f.begin=u.int64();break}case 2:{f.end=u.int64();break}default:u.skipType(p&7);break}}return f},a.decodeDelimited=function(u){return u instanceof t||(u=new t(u)),this.decode(u,u.uint32())},a.verify=function(u){return typeof u!="object"||u===null?"object expected":u.begin!=null&&u.hasOwnProperty("begin")&&!o.isInteger(u.begin)&&!(u.begin&&o.isInteger(u.begin.low)&&o.isInteger(u.begin.high))?"begin: integer|Long expected":u.end!=null&&u.hasOwnProperty("end")&&!o.isInteger(u.end)&&!(u.end&&o.isInteger(u.end.low)&&o.isInteger(u.end.high))?"end: integer|Long expected":null},a.fromObject=function(u){if(u instanceof s.onnx.TensorProto.Segment)return u;var d=new s.onnx.TensorProto.Segment;return u.begin!=null&&(o.Long?(d.begin=o.Long.fromValue(u.begin)).unsigned=!1:typeof u.begin=="string"?d.begin=parseInt(u.begin,10):typeof u.begin=="number"?d.begin=u.begin:typeof u.begin=="object"&&(d.begin=new o.LongBits(u.begin.low>>>0,u.begin.high>>>0).toNumber())),u.end!=null&&(o.Long?(d.end=o.Long.fromValue(u.end)).unsigned=!1:typeof u.end=="string"?d.end=parseInt(u.end,10):typeof u.end=="number"?d.end=u.end:typeof u.end=="object"&&(d.end=new o.LongBits(u.end.low>>>0,u.end.high>>>0).toNumber())),d},a.toObject=function(u,d){d||(d={});var h={};if(d.defaults){if(o.Long){var f=new o.Long(0,0,!1);h.begin=d.longs===String?f.toString():d.longs===Number?f.toNumber():f}else h.begin=d.longs===String?"0":0;if(o.Long){var f=new o.Long(0,0,!1);h.end=d.longs===String?f.toString():d.longs===Number?f.toNumber():f}else h.end=d.longs===String?"0":0}return u.begin!=null&&u.hasOwnProperty("begin")&&(typeof u.begin=="number"?h.begin=d.longs===String?String(u.begin):u.begin:h.begin=d.longs===String?o.Long.prototype.toString.call(u.begin):d.longs===Number?new o.LongBits(u.begin.low>>>0,u.begin.high>>>0).toNumber():u.begin),u.end!=null&&u.hasOwnProperty("end")&&(typeof u.end=="number"?h.end=d.longs===String?String(u.end):u.end:h.end=d.longs===String?o.Long.prototype.toString.call(u.end):d.longs===Number?new o.LongBits(u.end.low>>>0,u.end.high>>>0).toNumber():u.end),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},a.getTypeUrl=function(u){return u===void 0&&(u="type.googleapis.com"),u+"/onnx.TensorProto.Segment"},a}(),c.DataLocation=function(){var a={},u=Object.create(a);return u[a[0]="DEFAULT"]=0,u[a[1]="EXTERNAL"]=1,u}(),c}(),l.SparseTensorProto=function(){function c(a){if(this.dims=[],a)for(var u=Object.keys(a),d=0;d<u.length;++d)a[u[d]]!=null&&(this[u[d]]=a[u[d]])}return c.prototype.values=null,c.prototype.indices=null,c.prototype.dims=o.emptyArray,c.create=function(a){return new c(a)},c.encode=function(a,u){if(u||(u=i.create()),a.values!=null&&Object.hasOwnProperty.call(a,"values")&&s.onnx.TensorProto.encode(a.values,u.uint32(10).fork()).ldelim(),a.indices!=null&&Object.hasOwnProperty.call(a,"indices")&&s.onnx.TensorProto.encode(a.indices,u.uint32(18).fork()).ldelim(),a.dims!=null&&a.dims.length){u.uint32(26).fork();for(var d=0;d<a.dims.length;++d)u.int64(a.dims[d]);u.ldelim()}return u},c.encodeDelimited=function(a,u){return this.encode(a,u).ldelim()},c.decode=function(a,u){a instanceof t||(a=t.create(a));for(var d=u===void 0?a.len:a.pos+u,h=new s.onnx.SparseTensorProto;a.pos<d;){var f=a.uint32();switch(f>>>3){case 1:{h.values=s.onnx.TensorProto.decode(a,a.uint32());break}case 2:{h.indices=s.onnx.TensorProto.decode(a,a.uint32());break}case 3:{if(h.dims&&h.dims.length||(h.dims=[]),(f&7)===2)for(var p=a.uint32()+a.pos;a.pos<p;)h.dims.push(a.int64());else h.dims.push(a.int64());break}default:a.skipType(f&7);break}}return h},c.decodeDelimited=function(a){return a instanceof t||(a=new t(a)),this.decode(a,a.uint32())},c.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.values!=null&&a.hasOwnProperty("values")){var u=s.onnx.TensorProto.verify(a.values);if(u)return"values."+u}if(a.indices!=null&&a.hasOwnProperty("indices")){var u=s.onnx.TensorProto.verify(a.indices);if(u)return"indices."+u}if(a.dims!=null&&a.hasOwnProperty("dims")){if(!Array.isArray(a.dims))return"dims: array expected";for(var d=0;d<a.dims.length;++d)if(!o.isInteger(a.dims[d])&&!(a.dims[d]&&o.isInteger(a.dims[d].low)&&o.isInteger(a.dims[d].high)))return"dims: integer|Long[] expected"}return null},c.fromObject=function(a){if(a instanceof s.onnx.SparseTensorProto)return a;var u=new s.onnx.SparseTensorProto;if(a.values!=null){if(typeof a.values!="object")throw TypeError(".onnx.SparseTensorProto.values: object expected");u.values=s.onnx.TensorProto.fromObject(a.values)}if(a.indices!=null){if(typeof a.indices!="object")throw TypeError(".onnx.SparseTensorProto.indices: object expected");u.indices=s.onnx.TensorProto.fromObject(a.indices)}if(a.dims){if(!Array.isArray(a.dims))throw TypeError(".onnx.SparseTensorProto.dims: array expected");u.dims=[];for(var d=0;d<a.dims.length;++d)o.Long?(u.dims[d]=o.Long.fromValue(a.dims[d])).unsigned=!1:typeof a.dims[d]=="string"?u.dims[d]=parseInt(a.dims[d],10):typeof a.dims[d]=="number"?u.dims[d]=a.dims[d]:typeof a.dims[d]=="object"&&(u.dims[d]=new o.LongBits(a.dims[d].low>>>0,a.dims[d].high>>>0).toNumber())}return u},c.toObject=function(a,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.dims=[]),u.defaults&&(d.values=null,d.indices=null),a.values!=null&&a.hasOwnProperty("values")&&(d.values=s.onnx.TensorProto.toObject(a.values,u)),a.indices!=null&&a.hasOwnProperty("indices")&&(d.indices=s.onnx.TensorProto.toObject(a.indices,u)),a.dims&&a.dims.length){d.dims=[];for(var h=0;h<a.dims.length;++h)typeof a.dims[h]=="number"?d.dims[h]=u.longs===String?String(a.dims[h]):a.dims[h]:d.dims[h]=u.longs===String?o.Long.prototype.toString.call(a.dims[h]):u.longs===Number?new o.LongBits(a.dims[h].low>>>0,a.dims[h].high>>>0).toNumber():a.dims[h]}return d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/onnx.SparseTensorProto"},c}(),l.TensorShapeProto=function(){function c(a){if(this.dim=[],a)for(var u=Object.keys(a),d=0;d<u.length;++d)a[u[d]]!=null&&(this[u[d]]=a[u[d]])}return c.prototype.dim=o.emptyArray,c.create=function(a){return new c(a)},c.encode=function(a,u){if(u||(u=i.create()),a.dim!=null&&a.dim.length)for(var d=0;d<a.dim.length;++d)s.onnx.TensorShapeProto.Dimension.encode(a.dim[d],u.uint32(10).fork()).ldelim();return u},c.encodeDelimited=function(a,u){return this.encode(a,u).ldelim()},c.decode=function(a,u){a instanceof t||(a=t.create(a));for(var d=u===void 0?a.len:a.pos+u,h=new s.onnx.TensorShapeProto;a.pos<d;){var f=a.uint32();switch(f>>>3){case 1:{h.dim&&h.dim.length||(h.dim=[]),h.dim.push(s.onnx.TensorShapeProto.Dimension.decode(a,a.uint32()));break}default:a.skipType(f&7);break}}return h},c.decodeDelimited=function(a){return a instanceof t||(a=new t(a)),this.decode(a,a.uint32())},c.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.dim!=null&&a.hasOwnProperty("dim")){if(!Array.isArray(a.dim))return"dim: array expected";for(var u=0;u<a.dim.length;++u){var d=s.onnx.TensorShapeProto.Dimension.verify(a.dim[u]);if(d)return"dim."+d}}return null},c.fromObject=function(a){if(a instanceof s.onnx.TensorShapeProto)return a;var u=new s.onnx.TensorShapeProto;if(a.dim){if(!Array.isArray(a.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");u.dim=[];for(var d=0;d<a.dim.length;++d){if(typeof a.dim[d]!="object")throw TypeError(".onnx.TensorShapeProto.dim: object expected");u.dim[d]=s.onnx.TensorShapeProto.Dimension.fromObject(a.dim[d])}}return u},c.toObject=function(a,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.dim=[]),a.dim&&a.dim.length){d.dim=[];for(var h=0;h<a.dim.length;++h)d.dim[h]=s.onnx.TensorShapeProto.Dimension.toObject(a.dim[h],u)}return d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/onnx.TensorShapeProto"},c.Dimension=function(){function a(d){if(d)for(var h=Object.keys(d),f=0;f<h.length;++f)d[h[f]]!=null&&(this[h[f]]=d[h[f]])}a.prototype.dimValue=null,a.prototype.dimParam=null,a.prototype.denotation="";var u;return Object.defineProperty(a.prototype,"value",{get:o.oneOfGetter(u=["dimValue","dimParam"]),set:o.oneOfSetter(u)}),a.create=function(d){return new a(d)},a.encode=function(d,h){return h||(h=i.create()),d.dimValue!=null&&Object.hasOwnProperty.call(d,"dimValue")&&h.uint32(8).int64(d.dimValue),d.dimParam!=null&&Object.hasOwnProperty.call(d,"dimParam")&&h.uint32(18).string(d.dimParam),d.denotation!=null&&Object.hasOwnProperty.call(d,"denotation")&&h.uint32(26).string(d.denotation),h},a.encodeDelimited=function(d,h){return this.encode(d,h).ldelim()},a.decode=function(d,h){d instanceof t||(d=t.create(d));for(var f=h===void 0?d.len:d.pos+h,p=new s.onnx.TensorShapeProto.Dimension;d.pos<f;){var g=d.uint32();switch(g>>>3){case 1:{p.dimValue=d.int64();break}case 2:{p.dimParam=d.string();break}case 3:{p.denotation=d.string();break}default:d.skipType(g&7);break}}return p},a.decodeDelimited=function(d){return d instanceof t||(d=new t(d)),this.decode(d,d.uint32())},a.verify=function(d){if(typeof d!="object"||d===null)return"object expected";var h={};if(d.dimValue!=null&&d.hasOwnProperty("dimValue")&&(h.value=1,!o.isInteger(d.dimValue)&&!(d.dimValue&&o.isInteger(d.dimValue.low)&&o.isInteger(d.dimValue.high))))return"dimValue: integer|Long expected";if(d.dimParam!=null&&d.hasOwnProperty("dimParam")){if(h.value===1)return"value: multiple values";if(h.value=1,!o.isString(d.dimParam))return"dimParam: string expected"}return d.denotation!=null&&d.hasOwnProperty("denotation")&&!o.isString(d.denotation)?"denotation: string expected":null},a.fromObject=function(d){if(d instanceof s.onnx.TensorShapeProto.Dimension)return d;var h=new s.onnx.TensorShapeProto.Dimension;return d.dimValue!=null&&(o.Long?(h.dimValue=o.Long.fromValue(d.dimValue)).unsigned=!1:typeof d.dimValue=="string"?h.dimValue=parseInt(d.dimValue,10):typeof d.dimValue=="number"?h.dimValue=d.dimValue:typeof d.dimValue=="object"&&(h.dimValue=new o.LongBits(d.dimValue.low>>>0,d.dimValue.high>>>0).toNumber())),d.dimParam!=null&&(h.dimParam=String(d.dimParam)),d.denotation!=null&&(h.denotation=String(d.denotation)),h},a.toObject=function(d,h){h||(h={});var f={};return h.defaults&&(f.denotation=""),d.dimValue!=null&&d.hasOwnProperty("dimValue")&&(typeof d.dimValue=="number"?f.dimValue=h.longs===String?String(d.dimValue):d.dimValue:f.dimValue=h.longs===String?o.Long.prototype.toString.call(d.dimValue):h.longs===Number?new o.LongBits(d.dimValue.low>>>0,d.dimValue.high>>>0).toNumber():d.dimValue,h.oneofs&&(f.value="dimValue")),d.dimParam!=null&&d.hasOwnProperty("dimParam")&&(f.dimParam=d.dimParam,h.oneofs&&(f.value="dimParam")),d.denotation!=null&&d.hasOwnProperty("denotation")&&(f.denotation=d.denotation),f},a.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},a.getTypeUrl=function(d){return d===void 0&&(d="type.googleapis.com"),d+"/onnx.TensorShapeProto.Dimension"},a}(),c}(),l.TypeProto=function(){function c(u){if(u)for(var d=Object.keys(u),h=0;h<d.length;++h)u[d[h]]!=null&&(this[d[h]]=u[d[h]])}c.prototype.tensorType=null,c.prototype.sequenceType=null,c.prototype.mapType=null,c.prototype.optionalType=null,c.prototype.sparseTensorType=null,c.prototype.denotation="";var a;return Object.defineProperty(c.prototype,"value",{get:o.oneOfGetter(a=["tensorType","sequenceType","mapType","optionalType","sparseTensorType"]),set:o.oneOfSetter(a)}),c.create=function(u){return new c(u)},c.encode=function(u,d){return d||(d=i.create()),u.tensorType!=null&&Object.hasOwnProperty.call(u,"tensorType")&&s.onnx.TypeProto.Tensor.encode(u.tensorType,d.uint32(10).fork()).ldelim(),u.sequenceType!=null&&Object.hasOwnProperty.call(u,"sequenceType")&&s.onnx.TypeProto.Sequence.encode(u.sequenceType,d.uint32(34).fork()).ldelim(),u.mapType!=null&&Object.hasOwnProperty.call(u,"mapType")&&s.onnx.TypeProto.Map.encode(u.mapType,d.uint32(42).fork()).ldelim(),u.denotation!=null&&Object.hasOwnProperty.call(u,"denotation")&&d.uint32(50).string(u.denotation),u.sparseTensorType!=null&&Object.hasOwnProperty.call(u,"sparseTensorType")&&s.onnx.TypeProto.SparseTensor.encode(u.sparseTensorType,d.uint32(66).fork()).ldelim(),u.optionalType!=null&&Object.hasOwnProperty.call(u,"optionalType")&&s.onnx.TypeProto.Optional.encode(u.optionalType,d.uint32(74).fork()).ldelim(),d},c.encodeDelimited=function(u,d){return this.encode(u,d).ldelim()},c.decode=function(u,d){u instanceof t||(u=t.create(u));for(var h=d===void 0?u.len:u.pos+d,f=new s.onnx.TypeProto;u.pos<h;){var p=u.uint32();switch(p>>>3){case 1:{f.tensorType=s.onnx.TypeProto.Tensor.decode(u,u.uint32());break}case 4:{f.sequenceType=s.onnx.TypeProto.Sequence.decode(u,u.uint32());break}case 5:{f.mapType=s.onnx.TypeProto.Map.decode(u,u.uint32());break}case 9:{f.optionalType=s.onnx.TypeProto.Optional.decode(u,u.uint32());break}case 8:{f.sparseTensorType=s.onnx.TypeProto.SparseTensor.decode(u,u.uint32());break}case 6:{f.denotation=u.string();break}default:u.skipType(p&7);break}}return f},c.decodeDelimited=function(u){return u instanceof t||(u=new t(u)),this.decode(u,u.uint32())},c.verify=function(u){if(typeof u!="object"||u===null)return"object expected";var d={};if(u.tensorType!=null&&u.hasOwnProperty("tensorType")){d.value=1;{var h=s.onnx.TypeProto.Tensor.verify(u.tensorType);if(h)return"tensorType."+h}}if(u.sequenceType!=null&&u.hasOwnProperty("sequenceType")){if(d.value===1)return"value: multiple values";d.value=1;{var h=s.onnx.TypeProto.Sequence.verify(u.sequenceType);if(h)return"sequenceType."+h}}if(u.mapType!=null&&u.hasOwnProperty("mapType")){if(d.value===1)return"value: multiple values";d.value=1;{var h=s.onnx.TypeProto.Map.verify(u.mapType);if(h)return"mapType."+h}}if(u.optionalType!=null&&u.hasOwnProperty("optionalType")){if(d.value===1)return"value: multiple values";d.value=1;{var h=s.onnx.TypeProto.Optional.verify(u.optionalType);if(h)return"optionalType."+h}}if(u.sparseTensorType!=null&&u.hasOwnProperty("sparseTensorType")){if(d.value===1)return"value: multiple values";d.value=1;{var h=s.onnx.TypeProto.SparseTensor.verify(u.sparseTensorType);if(h)return"sparseTensorType."+h}}return u.denotation!=null&&u.hasOwnProperty("denotation")&&!o.isString(u.denotation)?"denotation: string expected":null},c.fromObject=function(u){if(u instanceof s.onnx.TypeProto)return u;var d=new s.onnx.TypeProto;if(u.tensorType!=null){if(typeof u.tensorType!="object")throw TypeError(".onnx.TypeProto.tensorType: object expected");d.tensorType=s.onnx.TypeProto.Tensor.fromObject(u.tensorType)}if(u.sequenceType!=null){if(typeof u.sequenceType!="object")throw TypeError(".onnx.TypeProto.sequenceType: object expected");d.sequenceType=s.onnx.TypeProto.Sequence.fromObject(u.sequenceType)}if(u.mapType!=null){if(typeof u.mapType!="object")throw TypeError(".onnx.TypeProto.mapType: object expected");d.mapType=s.onnx.TypeProto.Map.fromObject(u.mapType)}if(u.optionalType!=null){if(typeof u.optionalType!="object")throw TypeError(".onnx.TypeProto.optionalType: object expected");d.optionalType=s.onnx.TypeProto.Optional.fromObject(u.optionalType)}if(u.sparseTensorType!=null){if(typeof u.sparseTensorType!="object")throw TypeError(".onnx.TypeProto.sparseTensorType: object expected");d.sparseTensorType=s.onnx.TypeProto.SparseTensor.fromObject(u.sparseTensorType)}return u.denotation!=null&&(d.denotation=String(u.denotation)),d},c.toObject=function(u,d){d||(d={});var h={};return d.defaults&&(h.denotation=""),u.tensorType!=null&&u.hasOwnProperty("tensorType")&&(h.tensorType=s.onnx.TypeProto.Tensor.toObject(u.tensorType,d),d.oneofs&&(h.value="tensorType")),u.sequenceType!=null&&u.hasOwnProperty("sequenceType")&&(h.sequenceType=s.onnx.TypeProto.Sequence.toObject(u.sequenceType,d),d.oneofs&&(h.value="sequenceType")),u.mapType!=null&&u.hasOwnProperty("mapType")&&(h.mapType=s.onnx.TypeProto.Map.toObject(u.mapType,d),d.oneofs&&(h.value="mapType")),u.denotation!=null&&u.hasOwnProperty("denotation")&&(h.denotation=u.denotation),u.sparseTensorType!=null&&u.hasOwnProperty("sparseTensorType")&&(h.sparseTensorType=s.onnx.TypeProto.SparseTensor.toObject(u.sparseTensorType,d),d.oneofs&&(h.value="sparseTensorType")),u.optionalType!=null&&u.hasOwnProperty("optionalType")&&(h.optionalType=s.onnx.TypeProto.Optional.toObject(u.optionalType,d),d.oneofs&&(h.value="optionalType")),h},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(u){return u===void 0&&(u="type.googleapis.com"),u+"/onnx.TypeProto"},c.Tensor=function(){function u(d){if(d)for(var h=Object.keys(d),f=0;f<h.length;++f)d[h[f]]!=null&&(this[h[f]]=d[h[f]])}return u.prototype.elemType=0,u.prototype.shape=null,u.create=function(d){return new u(d)},u.encode=function(d,h){return h||(h=i.create()),d.elemType!=null&&Object.hasOwnProperty.call(d,"elemType")&&h.uint32(8).int32(d.elemType),d.shape!=null&&Object.hasOwnProperty.call(d,"shape")&&s.onnx.TensorShapeProto.encode(d.shape,h.uint32(18).fork()).ldelim(),h},u.encodeDelimited=function(d,h){return this.encode(d,h).ldelim()},u.decode=function(d,h){d instanceof t||(d=t.create(d));for(var f=h===void 0?d.len:d.pos+h,p=new s.onnx.TypeProto.Tensor;d.pos<f;){var g=d.uint32();switch(g>>>3){case 1:{p.elemType=d.int32();break}case 2:{p.shape=s.onnx.TensorShapeProto.decode(d,d.uint32());break}default:d.skipType(g&7);break}}return p},u.decodeDelimited=function(d){return d instanceof t||(d=new t(d)),this.decode(d,d.uint32())},u.verify=function(d){if(typeof d!="object"||d===null)return"object expected";if(d.elemType!=null&&d.hasOwnProperty("elemType")&&!o.isInteger(d.elemType))return"elemType: integer expected";if(d.shape!=null&&d.hasOwnProperty("shape")){var h=s.onnx.TensorShapeProto.verify(d.shape);if(h)return"shape."+h}return null},u.fromObject=function(d){if(d instanceof s.onnx.TypeProto.Tensor)return d;var h=new s.onnx.TypeProto.Tensor;if(d.elemType!=null&&(h.elemType=d.elemType|0),d.shape!=null){if(typeof d.shape!="object")throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");h.shape=s.onnx.TensorShapeProto.fromObject(d.shape)}return h},u.toObject=function(d,h){h||(h={});var f={};return h.defaults&&(f.elemType=0,f.shape=null),d.elemType!=null&&d.hasOwnProperty("elemType")&&(f.elemType=d.elemType),d.shape!=null&&d.hasOwnProperty("shape")&&(f.shape=s.onnx.TensorShapeProto.toObject(d.shape,h)),f},u.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},u.getTypeUrl=function(d){return d===void 0&&(d="type.googleapis.com"),d+"/onnx.TypeProto.Tensor"},u}(),c.Sequence=function(){function u(d){if(d)for(var h=Object.keys(d),f=0;f<h.length;++f)d[h[f]]!=null&&(this[h[f]]=d[h[f]])}return u.prototype.elemType=null,u.create=function(d){return new u(d)},u.encode=function(d,h){return h||(h=i.create()),d.elemType!=null&&Object.hasOwnProperty.call(d,"elemType")&&s.onnx.TypeProto.encode(d.elemType,h.uint32(10).fork()).ldelim(),h},u.encodeDelimited=function(d,h){return this.encode(d,h).ldelim()},u.decode=function(d,h){d instanceof t||(d=t.create(d));for(var f=h===void 0?d.len:d.pos+h,p=new s.onnx.TypeProto.Sequence;d.pos<f;){var g=d.uint32();switch(g>>>3){case 1:{p.elemType=s.onnx.TypeProto.decode(d,d.uint32());break}default:d.skipType(g&7);break}}return p},u.decodeDelimited=function(d){return d instanceof t||(d=new t(d)),this.decode(d,d.uint32())},u.verify=function(d){if(typeof d!="object"||d===null)return"object expected";if(d.elemType!=null&&d.hasOwnProperty("elemType")){var h=s.onnx.TypeProto.verify(d.elemType);if(h)return"elemType."+h}return null},u.fromObject=function(d){if(d instanceof s.onnx.TypeProto.Sequence)return d;var h=new s.onnx.TypeProto.Sequence;if(d.elemType!=null){if(typeof d.elemType!="object")throw TypeError(".onnx.TypeProto.Sequence.elemType: object expected");h.elemType=s.onnx.TypeProto.fromObject(d.elemType)}return h},u.toObject=function(d,h){h||(h={});var f={};return h.defaults&&(f.elemType=null),d.elemType!=null&&d.hasOwnProperty("elemType")&&(f.elemType=s.onnx.TypeProto.toObject(d.elemType,h)),f},u.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},u.getTypeUrl=function(d){return d===void 0&&(d="type.googleapis.com"),d+"/onnx.TypeProto.Sequence"},u}(),c.Map=function(){function u(d){if(d)for(var h=Object.keys(d),f=0;f<h.length;++f)d[h[f]]!=null&&(this[h[f]]=d[h[f]])}return u.prototype.keyType=0,u.prototype.valueType=null,u.create=function(d){return new u(d)},u.encode=function(d,h){return h||(h=i.create()),d.keyType!=null&&Object.hasOwnProperty.call(d,"keyType")&&h.uint32(8).int32(d.keyType),d.valueType!=null&&Object.hasOwnProperty.call(d,"valueType")&&s.onnx.TypeProto.encode(d.valueType,h.uint32(18).fork()).ldelim(),h},u.encodeDelimited=function(d,h){return this.encode(d,h).ldelim()},u.decode=function(d,h){d instanceof t||(d=t.create(d));for(var f=h===void 0?d.len:d.pos+h,p=new s.onnx.TypeProto.Map;d.pos<f;){var g=d.uint32();switch(g>>>3){case 1:{p.keyType=d.int32();break}case 2:{p.valueType=s.onnx.TypeProto.decode(d,d.uint32());break}default:d.skipType(g&7);break}}return p},u.decodeDelimited=function(d){return d instanceof t||(d=new t(d)),this.decode(d,d.uint32())},u.verify=function(d){if(typeof d!="object"||d===null)return"object expected";if(d.keyType!=null&&d.hasOwnProperty("keyType")&&!o.isInteger(d.keyType))return"keyType: integer expected";if(d.valueType!=null&&d.hasOwnProperty("valueType")){var h=s.onnx.TypeProto.verify(d.valueType);if(h)return"valueType."+h}return null},u.fromObject=function(d){if(d instanceof s.onnx.TypeProto.Map)return d;var h=new s.onnx.TypeProto.Map;if(d.keyType!=null&&(h.keyType=d.keyType|0),d.valueType!=null){if(typeof d.valueType!="object")throw TypeError(".onnx.TypeProto.Map.valueType: object expected");h.valueType=s.onnx.TypeProto.fromObject(d.valueType)}return h},u.toObject=function(d,h){h||(h={});var f={};return h.defaults&&(f.keyType=0,f.valueType=null),d.keyType!=null&&d.hasOwnProperty("keyType")&&(f.keyType=d.keyType),d.valueType!=null&&d.hasOwnProperty("valueType")&&(f.valueType=s.onnx.TypeProto.toObject(d.valueType,h)),f},u.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},u.getTypeUrl=function(d){return d===void 0&&(d="type.googleapis.com"),d+"/onnx.TypeProto.Map"},u}(),c.Optional=function(){function u(d){if(d)for(var h=Object.keys(d),f=0;f<h.length;++f)d[h[f]]!=null&&(this[h[f]]=d[h[f]])}return u.prototype.elemType=null,u.create=function(d){return new u(d)},u.encode=function(d,h){return h||(h=i.create()),d.elemType!=null&&Object.hasOwnProperty.call(d,"elemType")&&s.onnx.TypeProto.encode(d.elemType,h.uint32(10).fork()).ldelim(),h},u.encodeDelimited=function(d,h){return this.encode(d,h).ldelim()},u.decode=function(d,h){d instanceof t||(d=t.create(d));for(var f=h===void 0?d.len:d.pos+h,p=new s.onnx.TypeProto.Optional;d.pos<f;){var g=d.uint32();switch(g>>>3){case 1:{p.elemType=s.onnx.TypeProto.decode(d,d.uint32());break}default:d.skipType(g&7);break}}return p},u.decodeDelimited=function(d){return d instanceof t||(d=new t(d)),this.decode(d,d.uint32())},u.verify=function(d){if(typeof d!="object"||d===null)return"object expected";if(d.elemType!=null&&d.hasOwnProperty("elemType")){var h=s.onnx.TypeProto.verify(d.elemType);if(h)return"elemType."+h}return null},u.fromObject=function(d){if(d instanceof s.onnx.TypeProto.Optional)return d;var h=new s.onnx.TypeProto.Optional;if(d.elemType!=null){if(typeof d.elemType!="object")throw TypeError(".onnx.TypeProto.Optional.elemType: object expected");h.elemType=s.onnx.TypeProto.fromObject(d.elemType)}return h},u.toObject=function(d,h){h||(h={});var f={};return h.defaults&&(f.elemType=null),d.elemType!=null&&d.hasOwnProperty("elemType")&&(f.elemType=s.onnx.TypeProto.toObject(d.elemType,h)),f},u.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},u.getTypeUrl=function(d){return d===void 0&&(d="type.googleapis.com"),d+"/onnx.TypeProto.Optional"},u}(),c.SparseTensor=function(){function u(d){if(d)for(var h=Object.keys(d),f=0;f<h.length;++f)d[h[f]]!=null&&(this[h[f]]=d[h[f]])}return u.prototype.elemType=0,u.prototype.shape=null,u.create=function(d){return new u(d)},u.encode=function(d,h){return h||(h=i.create()),d.elemType!=null&&Object.hasOwnProperty.call(d,"elemType")&&h.uint32(8).int32(d.elemType),d.shape!=null&&Object.hasOwnProperty.call(d,"shape")&&s.onnx.TensorShapeProto.encode(d.shape,h.uint32(18).fork()).ldelim(),h},u.encodeDelimited=function(d,h){return this.encode(d,h).ldelim()},u.decode=function(d,h){d instanceof t||(d=t.create(d));for(var f=h===void 0?d.len:d.pos+h,p=new s.onnx.TypeProto.SparseTensor;d.pos<f;){var g=d.uint32();switch(g>>>3){case 1:{p.elemType=d.int32();break}case 2:{p.shape=s.onnx.TensorShapeProto.decode(d,d.uint32());break}default:d.skipType(g&7);break}}return p},u.decodeDelimited=function(d){return d instanceof t||(d=new t(d)),this.decode(d,d.uint32())},u.verify=function(d){if(typeof d!="object"||d===null)return"object expected";if(d.elemType!=null&&d.hasOwnProperty("elemType")&&!o.isInteger(d.elemType))return"elemType: integer expected";if(d.shape!=null&&d.hasOwnProperty("shape")){var h=s.onnx.TensorShapeProto.verify(d.shape);if(h)return"shape."+h}return null},u.fromObject=function(d){if(d instanceof s.onnx.TypeProto.SparseTensor)return d;var h=new s.onnx.TypeProto.SparseTensor;if(d.elemType!=null&&(h.elemType=d.elemType|0),d.shape!=null){if(typeof d.shape!="object")throw TypeError(".onnx.TypeProto.SparseTensor.shape: object expected");h.shape=s.onnx.TensorShapeProto.fromObject(d.shape)}return h},u.toObject=function(d,h){h||(h={});var f={};return h.defaults&&(f.elemType=0,f.shape=null),d.elemType!=null&&d.hasOwnProperty("elemType")&&(f.elemType=d.elemType),d.shape!=null&&d.hasOwnProperty("shape")&&(f.shape=s.onnx.TensorShapeProto.toObject(d.shape,h)),f},u.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},u.getTypeUrl=function(d){return d===void 0&&(d="type.googleapis.com"),d+"/onnx.TypeProto.SparseTensor"},u}(),c}(),l.OperatorSetIdProto=function(){function c(a){if(a)for(var u=Object.keys(a),d=0;d<u.length;++d)a[u[d]]!=null&&(this[u[d]]=a[u[d]])}return c.prototype.domain="",c.prototype.version=o.Long?o.Long.fromBits(0,0,!1):0,c.create=function(a){return new c(a)},c.encode=function(a,u){return u||(u=i.create()),a.domain!=null&&Object.hasOwnProperty.call(a,"domain")&&u.uint32(10).string(a.domain),a.version!=null&&Object.hasOwnProperty.call(a,"version")&&u.uint32(16).int64(a.version),u},c.encodeDelimited=function(a,u){return this.encode(a,u).ldelim()},c.decode=function(a,u){a instanceof t||(a=t.create(a));for(var d=u===void 0?a.len:a.pos+u,h=new s.onnx.OperatorSetIdProto;a.pos<d;){var f=a.uint32();switch(f>>>3){case 1:{h.domain=a.string();break}case 2:{h.version=a.int64();break}default:a.skipType(f&7);break}}return h},c.decodeDelimited=function(a){return a instanceof t||(a=new t(a)),this.decode(a,a.uint32())},c.verify=function(a){return typeof a!="object"||a===null?"object expected":a.domain!=null&&a.hasOwnProperty("domain")&&!o.isString(a.domain)?"domain: string expected":a.version!=null&&a.hasOwnProperty("version")&&!o.isInteger(a.version)&&!(a.version&&o.isInteger(a.version.low)&&o.isInteger(a.version.high))?"version: integer|Long expected":null},c.fromObject=function(a){if(a instanceof s.onnx.OperatorSetIdProto)return a;var u=new s.onnx.OperatorSetIdProto;return a.domain!=null&&(u.domain=String(a.domain)),a.version!=null&&(o.Long?(u.version=o.Long.fromValue(a.version)).unsigned=!1:typeof a.version=="string"?u.version=parseInt(a.version,10):typeof a.version=="number"?u.version=a.version:typeof a.version=="object"&&(u.version=new o.LongBits(a.version.low>>>0,a.version.high>>>0).toNumber())),u},c.toObject=function(a,u){u||(u={});var d={};if(u.defaults)if(d.domain="",o.Long){var h=new o.Long(0,0,!1);d.version=u.longs===String?h.toString():u.longs===Number?h.toNumber():h}else d.version=u.longs===String?"0":0;return a.domain!=null&&a.hasOwnProperty("domain")&&(d.domain=a.domain),a.version!=null&&a.hasOwnProperty("version")&&(typeof a.version=="number"?d.version=u.longs===String?String(a.version):a.version:d.version=u.longs===String?o.Long.prototype.toString.call(a.version):u.longs===Number?new o.LongBits(a.version.low>>>0,a.version.high>>>0).toNumber():a.version),d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/onnx.OperatorSetIdProto"},c}(),l.OperatorStatus=function(){var c={},a=Object.create(c);return a[c[0]="EXPERIMENTAL"]=0,a[c[1]="STABLE"]=1,a}(),l.FunctionProto=function(){function c(a){if(this.input=[],this.output=[],this.attribute=[],this.attributeProto=[],this.node=[],this.opsetImport=[],a)for(var u=Object.keys(a),d=0;d<u.length;++d)a[u[d]]!=null&&(this[u[d]]=a[u[d]])}return c.prototype.name="",c.prototype.input=o.emptyArray,c.prototype.output=o.emptyArray,c.prototype.attribute=o.emptyArray,c.prototype.attributeProto=o.emptyArray,c.prototype.node=o.emptyArray,c.prototype.docString="",c.prototype.opsetImport=o.emptyArray,c.prototype.domain="",c.create=function(a){return new c(a)},c.encode=function(a,u){if(u||(u=i.create()),a.name!=null&&Object.hasOwnProperty.call(a,"name")&&u.uint32(10).string(a.name),a.input!=null&&a.input.length)for(var d=0;d<a.input.length;++d)u.uint32(34).string(a.input[d]);if(a.output!=null&&a.output.length)for(var d=0;d<a.output.length;++d)u.uint32(42).string(a.output[d]);if(a.attribute!=null&&a.attribute.length)for(var d=0;d<a.attribute.length;++d)u.uint32(50).string(a.attribute[d]);if(a.node!=null&&a.node.length)for(var d=0;d<a.node.length;++d)s.onnx.NodeProto.encode(a.node[d],u.uint32(58).fork()).ldelim();if(a.docString!=null&&Object.hasOwnProperty.call(a,"docString")&&u.uint32(66).string(a.docString),a.opsetImport!=null&&a.opsetImport.length)for(var d=0;d<a.opsetImport.length;++d)s.onnx.OperatorSetIdProto.encode(a.opsetImport[d],u.uint32(74).fork()).ldelim();if(a.domain!=null&&Object.hasOwnProperty.call(a,"domain")&&u.uint32(82).string(a.domain),a.attributeProto!=null&&a.attributeProto.length)for(var d=0;d<a.attributeProto.length;++d)s.onnx.AttributeProto.encode(a.attributeProto[d],u.uint32(90).fork()).ldelim();return u},c.encodeDelimited=function(a,u){return this.encode(a,u).ldelim()},c.decode=function(a,u){a instanceof t||(a=t.create(a));for(var d=u===void 0?a.len:a.pos+u,h=new s.onnx.FunctionProto;a.pos<d;){var f=a.uint32();switch(f>>>3){case 1:{h.name=a.string();break}case 4:{h.input&&h.input.length||(h.input=[]),h.input.push(a.string());break}case 5:{h.output&&h.output.length||(h.output=[]),h.output.push(a.string());break}case 6:{h.attribute&&h.attribute.length||(h.attribute=[]),h.attribute.push(a.string());break}case 11:{h.attributeProto&&h.attributeProto.length||(h.attributeProto=[]),h.attributeProto.push(s.onnx.AttributeProto.decode(a,a.uint32()));break}case 7:{h.node&&h.node.length||(h.node=[]),h.node.push(s.onnx.NodeProto.decode(a,a.uint32()));break}case 8:{h.docString=a.string();break}case 9:{h.opsetImport&&h.opsetImport.length||(h.opsetImport=[]),h.opsetImport.push(s.onnx.OperatorSetIdProto.decode(a,a.uint32()));break}case 10:{h.domain=a.string();break}default:a.skipType(f&7);break}}return h},c.decodeDelimited=function(a){return a instanceof t||(a=new t(a)),this.decode(a,a.uint32())},c.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.name!=null&&a.hasOwnProperty("name")&&!o.isString(a.name))return"name: string expected";if(a.input!=null&&a.hasOwnProperty("input")){if(!Array.isArray(a.input))return"input: array expected";for(var u=0;u<a.input.length;++u)if(!o.isString(a.input[u]))return"input: string[] expected"}if(a.output!=null&&a.hasOwnProperty("output")){if(!Array.isArray(a.output))return"output: array expected";for(var u=0;u<a.output.length;++u)if(!o.isString(a.output[u]))return"output: string[] expected"}if(a.attribute!=null&&a.hasOwnProperty("attribute")){if(!Array.isArray(a.attribute))return"attribute: array expected";for(var u=0;u<a.attribute.length;++u)if(!o.isString(a.attribute[u]))return"attribute: string[] expected"}if(a.attributeProto!=null&&a.hasOwnProperty("attributeProto")){if(!Array.isArray(a.attributeProto))return"attributeProto: array expected";for(var u=0;u<a.attributeProto.length;++u){var d=s.onnx.AttributeProto.verify(a.attributeProto[u]);if(d)return"attributeProto."+d}}if(a.node!=null&&a.hasOwnProperty("node")){if(!Array.isArray(a.node))return"node: array expected";for(var u=0;u<a.node.length;++u){var d=s.onnx.NodeProto.verify(a.node[u]);if(d)return"node."+d}}if(a.docString!=null&&a.hasOwnProperty("docString")&&!o.isString(a.docString))return"docString: string expected";if(a.opsetImport!=null&&a.hasOwnProperty("opsetImport")){if(!Array.isArray(a.opsetImport))return"opsetImport: array expected";for(var u=0;u<a.opsetImport.length;++u){var d=s.onnx.OperatorSetIdProto.verify(a.opsetImport[u]);if(d)return"opsetImport."+d}}return a.domain!=null&&a.hasOwnProperty("domain")&&!o.isString(a.domain)?"domain: string expected":null},c.fromObject=function(a){if(a instanceof s.onnx.FunctionProto)return a;var u=new s.onnx.FunctionProto;if(a.name!=null&&(u.name=String(a.name)),a.input){if(!Array.isArray(a.input))throw TypeError(".onnx.FunctionProto.input: array expected");u.input=[];for(var d=0;d<a.input.length;++d)u.input[d]=String(a.input[d])}if(a.output){if(!Array.isArray(a.output))throw TypeError(".onnx.FunctionProto.output: array expected");u.output=[];for(var d=0;d<a.output.length;++d)u.output[d]=String(a.output[d])}if(a.attribute){if(!Array.isArray(a.attribute))throw TypeError(".onnx.FunctionProto.attribute: array expected");u.attribute=[];for(var d=0;d<a.attribute.length;++d)u.attribute[d]=String(a.attribute[d])}if(a.attributeProto){if(!Array.isArray(a.attributeProto))throw TypeError(".onnx.FunctionProto.attributeProto: array expected");u.attributeProto=[];for(var d=0;d<a.attributeProto.length;++d){if(typeof a.attributeProto[d]!="object")throw TypeError(".onnx.FunctionProto.attributeProto: object expected");u.attributeProto[d]=s.onnx.AttributeProto.fromObject(a.attributeProto[d])}}if(a.node){if(!Array.isArray(a.node))throw TypeError(".onnx.FunctionProto.node: array expected");u.node=[];for(var d=0;d<a.node.length;++d){if(typeof a.node[d]!="object")throw TypeError(".onnx.FunctionProto.node: object expected");u.node[d]=s.onnx.NodeProto.fromObject(a.node[d])}}if(a.docString!=null&&(u.docString=String(a.docString)),a.opsetImport){if(!Array.isArray(a.opsetImport))throw TypeError(".onnx.FunctionProto.opsetImport: array expected");u.opsetImport=[];for(var d=0;d<a.opsetImport.length;++d){if(typeof a.opsetImport[d]!="object")throw TypeError(".onnx.FunctionProto.opsetImport: object expected");u.opsetImport[d]=s.onnx.OperatorSetIdProto.fromObject(a.opsetImport[d])}}return a.domain!=null&&(u.domain=String(a.domain)),u},c.toObject=function(a,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.input=[],d.output=[],d.attribute=[],d.node=[],d.opsetImport=[],d.attributeProto=[]),u.defaults&&(d.name="",d.docString="",d.domain=""),a.name!=null&&a.hasOwnProperty("name")&&(d.name=a.name),a.input&&a.input.length){d.input=[];for(var h=0;h<a.input.length;++h)d.input[h]=a.input[h]}if(a.output&&a.output.length){d.output=[];for(var h=0;h<a.output.length;++h)d.output[h]=a.output[h]}if(a.attribute&&a.attribute.length){d.attribute=[];for(var h=0;h<a.attribute.length;++h)d.attribute[h]=a.attribute[h]}if(a.node&&a.node.length){d.node=[];for(var h=0;h<a.node.length;++h)d.node[h]=s.onnx.NodeProto.toObject(a.node[h],u)}if(a.docString!=null&&a.hasOwnProperty("docString")&&(d.docString=a.docString),a.opsetImport&&a.opsetImport.length){d.opsetImport=[];for(var h=0;h<a.opsetImport.length;++h)d.opsetImport[h]=s.onnx.OperatorSetIdProto.toObject(a.opsetImport[h],u)}if(a.domain!=null&&a.hasOwnProperty("domain")&&(d.domain=a.domain),a.attributeProto&&a.attributeProto.length){d.attributeProto=[];for(var h=0;h<a.attributeProto.length;++h)d.attributeProto[h]=s.onnx.AttributeProto.toObject(a.attributeProto[h],u)}return d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/onnx.FunctionProto"},c}(),l}(),e.exports=s});function Cp(r,e){if(!r)throw new Error(typeof e=="string"?e:e())}function tw(r){return new TextDecoder().decode(r)}var ze,au,CO,Ur,EM,jn,$r,ce,nw,Ip,wu,_u,Re=R(()=>{"use strict";Rw(),TM(),ze=ml(Su()),wl(),au=class{static arraysEqual(r,e){if(r.length!==e.length)return!1;for(let n=0;n<r.length;n++)if(r[n]!==e[n])return!1;return!0}},CO=class{static preprocessInputShapes(r,e){let n=r.length===1?[1,r[0]]:r,t=e.length===1?[e[0],1]:e;return[n,t]}static postprocessOutputShape(r,e,n){e===1&&r.splice(r.length-2,1),n===1&&r.pop()}static calcMatMulShape(r,e){return r[1]!==e[0]?void 0:[r[0],e[1]]}},Ur=class lu{static calcShape(e,n,t=!1){let i=e.length,o=n.length;if(i===0)return n;if(o===0)return e;let s=Math.max(e.length,n.length),l=new Array(s);if(t){if(i<2||o<2)return;let c=CO.calcMatMulShape([e[i-2],e[i-1]],[n[o-2],n[o-1]]);if(c===void 0)return;[l[s-2],l[s-1]]=c}for(let c=t?3:1;c<=s;c++){let a=i-c<0?1:e[i-c],u=o-c<0?1:n[o-c];if(a!==u&&a>1&&u>1)return;l[s-c]=Math.max(a,u)}return l}static index(e,n){let t=new Array(n.length);return lu.fillIndex(e,n,t),t}static fillIndex(e,n,t){let i=e.length-n.length;for(let o=0;o<n.length;o++)t[o]=e[i+o]%n[o]}static calc(e,n,t,i,o){let s=lu.calcShape(e.dims,n.dims);if(s){if(i&&!ce.areEqual(s,e.dims))return;let l=ce.size(s),c=i?e:new $n(s,o||e.type);if(s.length===0)c.set([],t(e.get([]),n.get([])));else{let a=new Array(s.length),u=new Array(e.dims.length),d=new Array(n.dims.length),h=0,f=0,p=!1,g=!1;e.dims.length===0&&(h=e.get([]),p=!0),n.dims.length===0&&(f=n.get([]),g=!0);let y;for(let w=0;w<l;w++){y=w;for(let v=s.length-1;v>=0;v--)a[v]=y%s[v],y=Math.floor(y/s[v]);p||(lu.fillIndex(a,e.dims,u),h=e.get(u)),g||(lu.fillIndex(a,n.dims,d),f=n.get(d)),c.set(a,t(h,f))}}return c}}static isValidBroadcast(e,n){let t=e.length,i=n.length;if(t>i)return!1;for(let o=1;o<=t;o++)if(e[t-o]!==1&&e[t-o]!==n[i-o])return!1;return!0}static getBroadcastDims(e,n){let t=e.length,i=[];for(let o=0;o<t;o++){let s=t-1-o,l=e[s]||1;(n[n.length-1-o]||1)>1&&l===1&&i.unshift(s)}return i}},EM=class{static getShapeOfGemmResult(r,e,n,t,i){if(r.length!==2||n.length!==2)throw new Error("shape need to be of size 2");let o,s,l;e?(o=r[1],s=r[0]):(o=r[0],s=r[1]);let c=-1;if(t?(l=n[0],c=1):(l=n[1],c=0),n[c]!==s)throw new Error("dimension mismatch");if(o<=0||l<=0||s<=0)throw new Error("invalid shape specified");if(i&&!Ur.isValidBroadcast(i,[o,l]))throw new Error("gemm: invalid bias shape for broadcast");return[o,l,s]}},jn=class rw{static tensorDataTypeFromProto(e){switch(e){case ze.onnx.TensorProto.DataType.INT8:return"int8";case ze.onnx.TensorProto.DataType.UINT8:return"uint8";case ze.onnx.TensorProto.DataType.BOOL:return"bool";case ze.onnx.TensorProto.DataType.INT16:return"int16";case ze.onnx.TensorProto.DataType.UINT16:return"uint16";case ze.onnx.TensorProto.DataType.INT32:return"int32";case ze.onnx.TensorProto.DataType.UINT32:return"uint32";case ze.onnx.TensorProto.DataType.FLOAT:return"float32";case ze.onnx.TensorProto.DataType.DOUBLE:return"float64";case ze.onnx.TensorProto.DataType.STRING:return"string";case ze.onnx.TensorProto.DataType.INT64:return"int32";case ze.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw new Error(`unsupported data type: ${ze.onnx.TensorProto.DataType[e]}`)}}static tensorDataTypeStringToEnum(e){switch(e){case"int8":return ze.onnx.TensorProto.DataType.INT8;case"uint8":return ze.onnx.TensorProto.DataType.UINT8;case"bool":return ze.onnx.TensorProto.DataType.BOOL;case"int16":return ze.onnx.TensorProto.DataType.INT16;case"uint16":return ze.onnx.TensorProto.DataType.UINT16;case"int32":return ze.onnx.TensorProto.DataType.INT32;case"uint32":return ze.onnx.TensorProto.DataType.UINT32;case"float32":return ze.onnx.TensorProto.DataType.FLOAT;case"float64":return ze.onnx.TensorProto.DataType.DOUBLE;case"string":return ze.onnx.TensorProto.DataType.STRING;case"int64":return ze.onnx.TensorProto.DataType.INT64;case"uint64":return ze.onnx.TensorProto.DataType.UINT64;default:throw new Error(`unsupported data type: ${e}`)}}static tensorDimsFromProto(e){return e.map(n=>po.isLong(n)?n.toNumber():n)}static tensorValueTypeFromProto(e){return{tensorType:rw.tensorDataTypeFromProto(e.elemType),shape:{dims:rw.tensorDimsFromProto(e.shape.dim.map(n=>n.dimValue))}}}static tensorDimsFromORTFormat(e){let n=[];for(let t=0;t<e.dimsLength();t++)n.push($r.longToNumber(e.dims(t)));return n}static tensorAttributesFromORTFormat(e){let n=[];for(let t=0;t<e.attributesLength();t++)n.push(e.attributes(t));return n}},$r=class{static longToNumber(r,e){return po.isLong(r)?r.toNumber():r instanceof O.Long?po.fromValue({low:r.low,high:r.high,unsigned:e??!1}).toNumber():r}static isLong(r){return po.isLong(r)||r instanceof O.Long}},ce=class ho{static size(e){return ho.getSizeFromDimensionRange(e,0,e.length)}static sizeFromDimension(e,n){if(n<0||n>e.length)throw new Error(`invalid dimension of ${n} for sizeFromDimension as Tensor has ${e.length} dimensions.`);return ho.getSizeFromDimensionRange(e,n,e.length)}static sizeToDimension(e,n){if(n<0||n>e.length)throw new Error(`invalid dimension of ${n} for sizeToDimension as Tensor has ${e.length} dimensions.`);return ho.getSizeFromDimensionRange(e,0,n)}static getSizeFromDimensionRange(e,n,t){let i=1;for(let o=n;o<t;o++){if(e[o]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");i*=e[o]}return i}static computeStrides(e){let n=e.length;if(n===0)return[];if(n===1)return[1];let t=new Array(n);t[n-1]=1,t[n-2]=e[n-1];for(let i=n-3;i>=0;--i)t[i]=t[i+1]*e[i+1];return t}static transpose(e){return e.slice().reverse()}static indicesToOffset(e,n,t){t===void 0&&(t=e.length);let i=0;for(let o=0;o<t;++o)i+=n[o]*e[o];return i}static offsetToIndices(e,n){let t=n.length;if(t===0)return[];if(t===1)return[e*n[0]];let i=new Array(n.length);for(let o=0;o<i.length-1;++o)i[o]=Math.floor(e/n[o]),e-=i[o]*n[o];return i[i.length-1]=e,i}static normalizeAxis(e,n){if(e<-n&&e>=n)throw new Error("unsupported axis for this operation.");return e<0?e+n:e}static normalizeAxes(e,n){return e.map(t=>this.normalizeAxis(t,n))}static incrementIndex(e,n,t){if(n.length===0||e.length===0)throw new Error("Index incrementing unsupported for scalar Tensor");if(t===void 0)t=n.length;else if(t<=0||t>n.length)throw new Error("Incorrect axis to increment on");for(let i=t-1;i>=0&&(e[i]++,!(e[i]<n[i]));--i)e[i]=0}static calculateReshapedDims(e,n){if(n.length===0){if(e.length===0||ho.size(e)===1)return[];throw new Error("cannot reshape to a scalar Tensor")}let t=n.length,i=new Array(t),o=-1,s=1;for(let c=0;c<t;c++){if(n[c]<-1)throw new Error("a dimension in shape hints cannot be less than -1");if(n[c]===-1){if(o!==-1)throw new Error("at most one dimension in shape hints can be -1");o=c}else{if(n[c]===0){if(c>=e.length)throw new Error("the dimension with value zero exceeds the dimension size of the input tensor");i[c]=e[c]}else i[c]=n[c];s*=i[c]}}let l=ho.size(e);if(o!==-1){if(l%s!==0)throw new Error(`the input tensor cannot be reshaped to the requested shape. Input shape: [${e}] Output shape: [${n}]`);i[o]=l/s}else if(s!==l)throw new Error("reshapedDims and originalDims don't have matching sizes");return i}static sortBasedOnPerm(e,n){return n?n.map(t=>e[t]):e.slice().reverse()}static padShape(e,n){let t=e.length;return e.map((i,o)=>i+n[o]+n[o+t])}static areEqual(e,n){return e.length!==n.length?!1:e.every((t,i)=>t===n[i])}static validateDimsAndCalcSize(e){if(e.length>6)throw new TypeError("Only rank 0 to 6 is supported for tensor shape.");let n=1;for(let t of e){if(!Number.isInteger(t))throw new TypeError(`Invalid shape: ${t} is not an integer`);if(t<0||t>2147483647)throw new TypeError(`Invalid shape: length ${t} is not allowed`);n*=t}return n}static flattenShape(e,n){n<0&&(n+=e.length);let t=e.reduce((o,s)=>o*s,1),i=e.slice(n).reduce((o,s)=>o*s,1);return[t/i,i]}static squeezeShape(e,n){let t=new Array;n=ho.normalizeAxes(n,e.length);for(let i=0;i<e.length;i++){let o=n.indexOf(i)>=0;if(o&&e[i]!==1)throw new Error("squeeze an axis of size different than 1");(n.length===0&&e[i]>1||n.length>0&&!o)&&t.push(e[i])}return t}static unsqueezeShape(e,n){let t=new Array(e.length+n.length);t.fill(0);for(let o=0;o<n.length;o++){let s=ho.normalizeAxis(n[o],t.length);if(s>=t.length)throw new Error("'axes' has an out of range axis");if(t[s]!==0)throw new Error("'axes' has a duplicate axis");t[s]=1}let i=0;for(let o=0;o<t.length;o++)t[o]===0&&(t[o]=e[i++]);if(i!==e.length)throw new Error("the unsqueezed dimension could not be established");return t}},nw=class DM{static splitShape(e,n,t,i){if(t.length===0){if(!i)throw new Error("need to know number of outputs when the 'split' attribute is not specified");DM.determineSplit(e[n],i,t)}let o=[],s=[0];for(let l=0;l<t.length;++l){l!==0&&s.push(s[l-1]+t[l-1]);let c=e.slice();c[n]=t[l],o.push(c)}return[o,s]}static determineSplit(e,n,t){if(e%n!==0)throw new Error("cannot split tensor to equal sized parts");for(let i=0;i<n;++i)t.push(e/n)}},Ip=class cu{static adjustPoolAttributes(e,n,t,i,o,s){if(!e&&t.length!==n.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(e)for(let l=0;l<n.length-2;l++)l>=t.length?t.push(n[l+2]):t[l]=n[l+2];for(let l=0;l<t.length;l++)if(l<i.length){if(i[l]<0)throw new Error("strides should be greater than or equal to 1")}else i.push(1);for(let l=0;l<t.length;l++)if(l<o.length){if(o[l]<0)throw new Error("dilations should be greater than or equal to 1")}else o.push(1);for(let l=0;l<t.length*2;l++)if(l<s.length){if(s[l]<0)throw new Error("pad should be greater than or equal to 1")}else s.push(0);for(let l=0;l<t.length;l++){if(t[l]<=0)throw new Error("kernel shapes need to be greater than 0");if(s[l]>=t[l]||s[l+t.length]>=t[l])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(e,n,t,i,o,s){if(s){if(o.length!==2*(e.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(n.length!==e.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==e.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let l=0;l<e.length-2;l++)cu.adjustPadAndReturnShape(e[l+2],n[l],t[l],i[l],o,l,l+e.length-2,s)}}static computePoolOutputShape(e,n,t,i,o,s,l){if(n.length<=0)throw new Error("input shape must be of size greater than 0");let c=[n[0],n[1]];return cu.computeShapeHelper(e,n,c,t,i,o,s,l),c}static computeConvOutputShape(e,n,t,i,o,s,l){if(e.length<=0||n.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let c=[e[0],n[0]];return cu.computeShapeHelper(!1,e,c,t,i,o,s,l),c}static computeShapeHelper(e,n,t,i,o,s,l,c){if(e)for(let a=0;a<n.length-2;a++)t.push(1);else for(let a=0;a<n.length-2;a++)t.push(cu.adjustPadAndReturnShape(n[a+2],i[a],o[a],s[a],l,a,a+n.length-2,c))}static adjustPadAndReturnShape(e,n,t,i,o,s,l,c){let a=t*(i-1)+1;if(c&&c!=="NOTSET")switch(c){case"VALID":return o[s]=0,o[l]=0,Math.floor((e-a)/n+1);case"SAME_LOWER":case"SAME_UPPER":if(t!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let u=((e+n-1)/n-1)*n+i-e;return o[s]=Math.floor(c==="SAME_LOWER"?(u+1)/2:u/2),o[l]=u-o[s],Math.floor((e+u-i)/n+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((e+o[s]+o[l]-a)/n+1)}},wu=-34028234663852886e22,_u=34028234663852886e22});function N8(r){switch(r){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw new Error(`cannot calculate sizeof() on type ${r}`)}}function IO(r){switch(r){case fe.onnx.TensorProto.DataType.UINT8:case fe.onnx.TensorProto.DataType.INT8:case fe.onnx.TensorProto.DataType.BOOL:return 1;case fe.onnx.TensorProto.DataType.UINT16:case fe.onnx.TensorProto.DataType.INT16:return 2;case fe.onnx.TensorProto.DataType.FLOAT:case fe.onnx.TensorProto.DataType.INT32:case fe.onnx.TensorProto.DataType.UINT32:return 4;case fe.onnx.TensorProto.DataType.INT64:case fe.onnx.TensorProto.DataType.DOUBLE:case fe.onnx.TensorProto.DataType.UINT64:return 8;default:throw new Error(`cannot calculate sizeof() on type ${fe.onnx.TensorProto.DataType[r]}`)}}function R8(r,e){return new(CM(e))(r)}function CM(r){switch(r){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw new Error("unspecified error")}}function iw(r,e){if(e===fe.onnx.TensorProto.DataType.INT64||e===Sp.TensorDataType.INT64){if(r.greaterThanOrEqual(2147483648)||r.lessThan(-2147483648))throw new TypeError("int64 is not supported")}else if(e===fe.onnx.TensorProto.DataType.UINT32||e===Sp.TensorDataType.UINT32||e===fe.onnx.TensorProto.DataType.UINT64||e===Sp.TensorDataType.UINT64){if(r.greaterThanOrEqual(4294967296)||r.lessThan(0))throw new TypeError("uint64 is not supported")}else throw new TypeError(`not a LONG type: ${fe.onnx.TensorProto.DataType[e]}`);return r.toNumber()}function OO(r,e,n){switch(e){case fe.onnx.TensorProto.DataType.BOOL:case fe.onnx.TensorProto.DataType.UINT8:return r.getUint8(n);case fe.onnx.TensorProto.DataType.INT8:return r.getInt8(n);case fe.onnx.TensorProto.DataType.UINT16:return r.getUint16(n,!0);case fe.onnx.TensorProto.DataType.INT16:return r.getInt16(n,!0);case fe.onnx.TensorProto.DataType.FLOAT:return r.getFloat32(n,!0);case fe.onnx.TensorProto.DataType.INT32:return r.getInt32(n,!0);case fe.onnx.TensorProto.DataType.UINT32:return r.getUint32(n,!0);case fe.onnx.TensorProto.DataType.INT64:return iw(po.fromBits(r.getUint32(n,!0),r.getUint32(n+4,!0),!1),e);case fe.onnx.TensorProto.DataType.DOUBLE:return r.getFloat64(n,!0);case fe.onnx.TensorProto.DataType.UINT64:return iw(po.fromBits(r.getUint32(n,!0),r.getUint32(n+4,!0),!0),e);default:throw new Error(`cannot read from DataView for type ${fe.onnx.TensorProto.DataType[e]}`)}}var AO,fe,Sp,$n,wl=R(()=>{"use strict";AO=ml(y8()),TM(),kp(),fe=ml(Su()),Re(),Sp=Be.experimental.fbs,$n=class Ep{constructor(e,n,t,i,o,s=AO.Guid.create()){this.dims=e,this.type=n,this.dataProvider=t,this.asyncDataProvider=i,this.cache=o,this.dataId=s,this.size=ce.validateDimsAndCalcSize(e);let l=this.size,c=t===void 0&&i===void 0&&o===void 0;if(o!==void 0&&o.length!==l)throw new RangeError("Input dims doesn't match data length.");if(n==="string"){if(o!==void 0&&(!Array.isArray(o)||!o.every(a=>typeof a=="string")))throw new TypeError("cache should be a string array");c&&(this.cache=new Array(l))}else{if(o!==void 0){let a=CM(n);if(!(o instanceof a))throw new TypeError(`cache should be type ${a.name}`)}if(c){let a=new ArrayBuffer(l*N8(n));this.cache=R8(a,n)}}}get data(){if(this.cache===void 0){let e=this.dataProvider(this.dataId);if(e.length!==this.size)throw new Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=e}return this.cache}get stringData(){if(this.type!=="string")throw new TypeError("data type is not string");return this.data}get integerData(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw new TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)")}}get floatData(){switch(this.type){case"float32":case"float64":return this.data;default:throw new TypeError("data type is not float (float32, float64)")}}get numberData(){if(this.type!=="string")return this.data;throw new TypeError("type cannot be non-number (string)")}get(e){return this.data[ce.indicesToOffset(e,this.strides)]}set(e,n){this.data[ce.indicesToOffset(e,this.strides)]=n}getData(){return F(this,null,function*(){return this.cache===void 0&&(this.cache=yield this.asyncDataProvider(this.dataId)),this.cache})}get strides(){return this._strides||(this._strides=ce.computeStrides(this.dims)),this._strides}static fromProto(e){if(!e)throw new Error("cannot construct Value from an empty tensor");let n=jn.tensorDataTypeFromProto(e.dataType),t=jn.tensorDimsFromProto(e.dims),i=new Ep(t,n);if(n==="string")e.stringData.forEach((o,s)=>{i.data[s]=tw(o)});else if(e.rawData&&typeof e.rawData.byteLength=="number"&&e.rawData.byteLength>0){let o=i.data,s=new DataView(e.rawData.buffer,e.rawData.byteOffset,e.rawData.byteLength),l=IO(e.dataType),c=e.rawData.byteLength/l;if(e.rawData.byteLength%l!==0)throw new Error("invalid buffer length");if(o.length!==c)throw new Error("buffer length mismatch");for(let a=0;a<c;a++){let u=OO(s,e.dataType,a*l);o[a]=u}}else{let o;switch(e.dataType){case fe.onnx.TensorProto.DataType.FLOAT:o=e.floatData;break;case fe.onnx.TensorProto.DataType.INT32:case fe.onnx.TensorProto.DataType.INT16:case fe.onnx.TensorProto.DataType.UINT16:case fe.onnx.TensorProto.DataType.INT8:case fe.onnx.TensorProto.DataType.UINT8:case fe.onnx.TensorProto.DataType.BOOL:o=e.int32Data;break;case fe.onnx.TensorProto.DataType.INT64:o=e.int64Data;break;case fe.onnx.TensorProto.DataType.DOUBLE:o=e.doubleData;break;case fe.onnx.TensorProto.DataType.UINT32:case fe.onnx.TensorProto.DataType.UINT64:o=e.uint64Data;break;default:throw new Error("unspecific error")}if(o==null)throw new Error("failed to populate data from a tensorproto value");let s=i.data;if(s.length!==o.length)throw new Error("array length mismatch");for(let l=0;l<o.length;l++){let c=o[l];po.isLong(c)?s[l]=iw(c,e.dataType):s[l]=c}}return i}static fromData(e,n,t){return new Ep(n,t,void 0,void 0,e)}static fromOrtTensor(e){if(!e)throw new Error("cannot construct Value from an empty tensor");let n=jn.tensorDimsFromORTFormat(e),t=jn.tensorDataTypeFromProto(e.dataType()),i=new Ep(n,t);if(t==="string")for(let o=0;o<e.stringDataLength();o++)i.data[o]=e.stringData(o);else if(e.rawDataArray()&&typeof e.rawDataLength()=="number"&&e.rawDataLength()>0){let o=i.data,s=new DataView(e.rawDataArray().buffer,e.rawDataArray().byteOffset,e.rawDataLength()),l=IO(e.dataType()),c=e.rawDataLength()/l;if(e.rawDataLength()%l!==0)throw new Error("invalid buffer length");if(o.length!==c)throw new Error("buffer length mismatch");for(let a=0;a<c;a++){let u=OO(s,e.dataType(),a*l);o[a]=u}}return i}}});function Se(r){return r===1?IM:OM}function k8(r){let e=Se(r);return`${e.version}
      precision highp float;
      ${e.attribute} vec3 position;
      ${e.attribute} vec2 textureCoord;

      ${e.varyingVertex} vec2 TexCoords;

      void main()
      {
          gl_Position = vec4(position, 1.0);
          TexCoords = textureCoord;
      }`}function F8(r){let e=Se(r);return`${e.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${e.varyingFrag} vec2 TexCoords;
    ${e.outputDeclaration}
    const vec2 halfCR = vec2(0.5, 0.5);

    // Custom vector types to handle higher dimenalities.
    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    `}function L8(r,e){let n=Se(r);return`
  void main() {
    int indices[${e}];
    toVec(TexCoords, indices);
    vec4 result = vec4(process(indices));
    ${n.output} = result;
  }
  `}var IM,OM,it=R(()=>{"use strict";IM={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},OM={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"}}),Ce=R(()=>{"use strict"});function PO(r,e=t=>0,n){return F(this,null,function*(){return new Promise((t,i)=>{let o=0,s=()=>{if(r()){t();return}o++;let l=e(o);if(n!=null&&o>=n){i();return}setTimeout(s,l)};s()})})}function f0(r){return Cp(typeof r<"u"&&r.length!==0,()=>"empty string found for sampler name"),"get"+r.charAt(0).toUpperCase()+r.slice(1)}function B8(r){return Cp(typeof r<"u"&&r.length!==0,()=>"empty string found for sampler name"),"get"+r.charAt(0).toUpperCase()+r.slice(1)+"AtOutCoords"}function Zc(r,e){let n=JSON.parse(JSON.stringify(r));return n=e,n}function Jc(r,e){return e.map(n=>r[n]).join(", ")}function go(r){if(r<=1)return"int";if(r===2)return"ivec2";if(r===3)return"ivec3";if(r===4)return"ivec4";if(r===5)return"ivec5";if(r===6)return"ivec6";throw Error(`GPU for rank ${r} is not yet supported`)}function bl(r=6){return["x","y","z","w","u","v"].slice(0,r)}var Ti=R(()=>{"use strict";Re()});function j8(r,e){return bl(e).map(n=>`${r}.${n}`)}function kw(r,e){return e===1?[r]:j8(r,e)}function Eu(){return`
    float getChannel(vec4 frag, int dim) {
      int modCoord = imod(dim, 2);
      return modCoord == 0 ? frag.r : frag.g;
    }

    float getChannel(vec4 frag, vec2 innerDims) {
      vec2 modCoord = mod(innerDims, 2.);
      return modCoord.x == 0. ?
        (modCoord.y == 0. ? frag.r : frag.g) :
        (modCoord.y == 0. ? frag.b : frag.a);
    }
  `}var _l=R(()=>{"use strict";Ti()});function V8(r,e,n){if(r===0)return"false";if(r===1)return`rc > ${e[0]}`;let t="";for(let i=r-2;i<r;i++)t+=`${n[i]} >= ${e[i-r+2]}`,i<r-1&&(t+="||");return t}function $8(r,e){let n=r.length;if(n===0)return"getA(), 0, 0, 0";if(n===1)return`getA(rc),
            rc + 1 >= ${r[0]} ? 0. : getA(rc + 1),
            0, 0`;let t="r, c",i="r, cp1",o="rp1, c",s="rp1, cp1",l="";if(n>2)for(let c=0;c<n-2;++c)l=l+`${e[c]},`;return`getA(${l}${t}),
          rEdge ? 0. : getA(${l}${o}),
          cEdge ? 0. : getA(${l}${i}),
          rEdge || cEdge ? 0. : getA(${l}${s})`}function U8(r,e,n,t){return r===0||r===1?"":`
    int r = ${e[r-2]};
    int c = ${e[r-1]};
    int rp1 = ${e[r-2]} + 1;
    int cp1 = ${e[r-1]} + 1;
    bool rEdge = rp1 >= ${t};
    bool cEdge = cp1 >= ${n};
    `}var p0,MO,AM,H8=R(()=>{"use strict";it(),Ce(),Ti(),_l(),p0={name:"pack",inputNames:["A"],inputTypes:[1]},MO=(r,e)=>{let n=Se(r.session.backend.glContext.version),t=e.dims,i=t.length,o=e.dims.length,s=go(o),l=kw("rc",o),c=U8(o,l,t[t.length-2],t[t.length-1]),a;i===0?a=[1,1]:i===1?a=[t[0],1]:a=[t[o-1],t[o-2]];let u=V8(o,a,l),d=$8(t,l),h=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${u}) {
            ${n.output} = vec4(0);
          } else {
            ${c}

            ${n.output} = vec4(${d});
          }
        }
      `;return k(C({},p0),{hasMain:!0,output:{dims:e.dims,type:e.type,textureType:2},shaderSource:h})},AM=(r,e)=>k(C({},p0),{get:()=>MO(r,e)})});function NO(r){if(r.length===0)return[1,1,1];let e=1;for(let n=0;n<r.length-2;++n)e*=r[n];return[e,r.length>1?r[r.length-2]:1,r[r.length-1]]}function z8(r,e){let n=!1;return r.length===0||e.length===0?n=!0:r.length<2||e.length<2?n=r[r.length-1]===e[e.length-1]:n=r[r.length-1]===e[e.length-1]&&r[r.length-2]===e[e.length-2],n}function G8(r){let e=ce.computeStrides(r),n=["b","r","c"],t="index";return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e.map((i,o)=>{let s=`int ${n[o]} = ${t} / ${i}`,l=o===e.length-1?`int ${n[o+1]} = ${t} - ${n[o]} * ${i}`:`index -= ${n[o]} * ${i}`;return`${s}; ${l};`}).join("")}
      return ivec3(b, r, c);
    }
  `}function W8(r){let e=ce.computeStrides(r);return`
  int getFlattenedIndex(ivec3 coords) {
    // reverse y, z order
    return coords.x * ${e[0]} + coords.z * ${e[1]} + coords.y;
  }
`}var RO,kO,PM,q8=R(()=>{"use strict";Re(),it(),Ce(),_l(),RO=r=>({name:"Reshape (packed)",inputTypes:[2],inputNames:["A"],cacheHint:`${r}`}),kO=(r,e,n,t)=>{let i=e.dims,o=t,s="";for(let a=0;a<4;a++){let u="";switch(a){case 0:u="outputCoords = rc;";break;case 1:u="outputCoords = ivec3(rc.x, rc.y+1, rc.z);";break;case 2:u="outputCoords = ivec3(rc.x, rc.y, rc.z+1);";break;case 3:u="outputCoords = ivec3(rc.x, rc.y+1, rc.z+1);";break;default:throw new Error}s+=`
        ${u}
        ${a>0?"if(outputCoords.y < rows && outputCoords.z < cols){":""}
          int flattenedIndex = getFlattenedIndex(outputCoords);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flattenedIndex);
          vec2 innerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${a}] = getChannel(getA(inputRC.x, inputRC.y, inputRC.z), innerDims);

        ${a>0?"}":""}
      `}let l=Se(r.session.backend.glContext.version),c=`
      ${G8(i)}
      ${W8(o)}
      ${Eu()}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.0);

        ivec3 outputCoords;
        int rows = ${o[2]};
        int cols = ${o[1]};

        ${s}
        ${l.output} = result;
      }
    `;return k(C({},n),{output:{dims:o,type:e.type,textureType:2},shaderSource:c,hasMain:!0})},PM=(r,e,n)=>{let t=RO(n);return k(C({},t),{get:()=>kO(r,e,t,n)})}}),ow,Y8=R(()=>{"use strict";it(),Ce(),ow=(r,e)=>{let n=e.shape,t=Se(r.session.backend.glContext.version),i=`
    const float FLOAT_MAX = 1.70141184e38;
    const float FLOAT_MIN = 1.17549435e-38;

    bool isNaN(float val) {
      return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;
    }

    highp vec4 encodeAsUint8(highp float v) {
      if (isNaN(v)) {
        return vec4(255, 255, 255, 255);
      }

      highp float av = abs(v);

      if(av < FLOAT_MIN) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      } else if(v > FLOAT_MAX) {
        return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
      } else if(v < -FLOAT_MAX) {
        return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
      }

      highp vec4 c = vec4(0,0,0,0);

      highp float e = floor(log2(av));
      highp float m = exp2(fract(log2(av))) - 1.0;

      c[2] = floor(128.0 * m);
      m -= c[2] / 128.0;
      c[1] = floor(32768.0 * m);
      m -= c[1] / 32768.0;
      c[0] = floor(8388608.0 * m);

      highp float ebias = e + 127.0;
      c[3] = floor(ebias / 2.0);
      ebias -= c[3] * 2.0;
      c[2] += floor(ebias) * 128.0;

      c[3] += 128.0 * step(0.0, -v);

      return c / 255.0;
    }

    void main() {
      float value = ${t.texture2D}(X,TexCoords).r;
      ${t.output} = encodeAsUint8(value);
    }`,o={name:"Uint8Encode",inputTypes:[0],inputNames:["X"],output:{dims:n,type:e.tensor.type,textureType:3},shaderSource:i,hasMain:!0};return r.executeProgram(o,[e.tensor])}});function X8(r,e){if(r===1)return"rc";let n="";for(let t=0;t<r;t++)n+=e[t],t<r-1&&(n+=",");return n}var g0,FO,MM,K8=R(()=>{"use strict";it(),Ce(),Ti(),_l(),g0={name:"unpack",inputNames:["A"],inputTypes:[2]},FO=(r,e)=>{let n=e.dims.length,t=kw("rc",n),i=t.slice(-2),o=go(n),s=Eu(),l=e.dims.length===0?"":X8(n,t),c=n<=1?"rc":`vec2(${i.join(",")})`,a=Se(r.session.backend.glContext.version),u=`
    ${s}
    void main() {
      ${o} rc = getOutputCoords();

       // Sample the texture with the coords to get the rgba channel value.
       vec4 packedInput = getA(${l});

       ${a.output} = vec4(getChannel(packedInput, ${c}), 0, 0, 0);
     }
   `;return k(C({},g0),{hasMain:!0,output:{dims:e.dims,type:e.type,textureType:0},shaderSource:u})},MM=(r,e)=>k(C({},g0),{get:()=>FO(r,e)})}),NM,sw,RM,Op=R(()=>{"use strict";Er(),NM=class{constructor(r,e=1){if(e===1)this.internalFormat=r.R32F,this.format=r.RED,this.textureType=r.FLOAT,this.channelSize=e;else if(e===4)this.internalFormat=r.RGBA32F,this.format=r.RGBA,this.textureType=r.FLOAT,this.channelSize=e;else throw new Error(`Invalid number of channels: ${e}`)}encode(r,e){let n,t;return r.constructor!==Float32Array&&(ht.warning("Encoder","data was not of type Float32; creating new Float32Array"),t=new Float32Array(r)),e*this.channelSize>r.length?(ht.warning("Encoder","Source data too small. Allocating larger array"),t=r,n=this.allocate(e*this.channelSize),t.forEach((i,o)=>n[o]=i)):(t=r,n=t),n}allocate(r){return new Float32Array(r*4)}decode(r,e){return this.channelSize===1?r.filter((n,t)=>t%4===0).subarray(0,e):r.subarray(0,e)}},sw=class{constructor(r,e=1,n){if(e!==1&&e!==4)throw new Error(`Invalid number of channels: ${e}`);this.internalFormat=r.RGBA,this.format=r.RGBA,this.channelSize=e,this.textureType=n||r.FLOAT}encode(r,e){let n=r;return this.channelSize===1&&(ht.verbose("Encoder","Exploding into a larger array"),n=this.allocate(e),r.forEach((t,i)=>n[i*4]=t)),n}allocate(r){return new Float32Array(r*4)}decode(r,e){return this.channelSize===1?r.filter((n,t)=>t%4===0).subarray(0,e):r.subarray(0,e)}},RM=class{constructor(r,e=1){if(this.channelSize=4,e===1)this.internalFormat=r.ALPHA,this.format=r.ALPHA,this.textureType=r.UNSIGNED_BYTE,this.channelSize=e;else if(e===4)this.internalFormat=r.RGBA,this.format=r.RGBA,this.textureType=r.UNSIGNED_BYTE,this.channelSize=e;else throw new Error(`Invalid number of channels: ${e}`)}encode(r,e){return new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}allocate(r){return new Uint8Array(r*this.channelSize)}decode(r,e){if(r instanceof Uint8Array)return r.subarray(0,e);throw new Error(`Invalid array type: ${r.constructor}`)}}}),mu,kM,aw,Z8=R(()=>{"use strict";Re(),Ce(),mu=(r,e,n)=>{let t=n===0||n===1?1:4,i=n===2,o=n===1||n===2,s=n===4?e.length-1:void 0,l=n===4?e.map((c,a)=>a===e.length-1?c*4:c):void 0;return aw(r,e,t,l,{isPacked:i,reverseWH:o,breakAxis:s})},kM=(r,e,n)=>{let t=mu(r,e,n);return[t.width,t.height]},aw=(r,e,n=1,t,i)=>{let o=!!(i&&i.isPacked),[s,l]=r.computeTextureWH(o&&t||e,i),c=e.length,a=e.slice(0);if(c===0&&(a=[1]),n===1)t=e;else if(o){if(n!==4)throw new Error("a packed texture must be 4-channel");t=e,c>0&&(a[c-1]=Math.ceil(a[c-1]/2)),c>1&&(a[c-2]=Math.ceil(a[c-2]/2))}else if(!t)throw new Error("Unpacked shape is needed when using channels > 1");return{width:s,height:l,channels:n,isPacked:o,shape:a,strides:ce.computeStrides(a),unpackedShape:t,reversedWH:i&&i.reverseWH}}}),LO,FM,J8=R(()=>{"use strict";Er(),wl(),Re(),H8(),q8(),Y8(),K8(),Op(),Z8(),Ce(),LO=(r,e)=>{let n=e.map(i=>`${i.unpackedShape.join(",")};${i.width}x${i.height}`).join("_"),t=r.name;return r.cacheHint&&(t+="["+r.cacheHint+"]"),t+=":"+n,t},FM=class{constructor(r){this.session=r,this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map}calculateTextureWidthAndHeight(r,e){return kM(this.session.layoutStrategy,r,e)}executeProgram(r,e){if(e.length<r.inputNames.length)throw new Error(`Input size mustn't be less than ${r.inputNames.length}.`);if(r.inputNames.length!==r.inputTypes.length)throw new Error("input names size does not match input types");let n=[];for(let c=0;c<r.inputNames.length;++c)n[c]=this.getOrCreateTextureData(e[c],r.inputTypes[c]);let t=LO(r,n),i=this.session.programManager.getArtifact(t),o=i?i.programInfo:typeof r.get=="function"?r.get():r,s=mu(this.session.layoutStrategy,o.output.dims,o.output.textureType),l=this.createTextureData(s,o.output.type);return i||(i=this.session.programManager.build(o,n,l),this.session.programManager.setArtifact(t,i)),this.runProgram(i,n,l),l}run(r,e){return this.executeProgram(r,e).tensor}runProgram(r,e,n){for(let t=0;t<e.length;++t)if(!!e[t].isPacked!=(r.programInfo.inputTypes[t]===2))throw new Error(`input[${t}] property packed inconsistent`);if(!!n.isPacked!=(r.programInfo.output.textureType===2))throw new Error("output property packed inconsistent");this.session.programManager.run(r,e,n)}getOrCreateTextureData(r,e){let n=this.getTextureData(r.dataId,e===2);if(!n&&(n=this.getTextureData(r.dataId,e!==2),n))return e===2?this.pack(n):this.unpack(n);if(!n){let t=mu(this.session.layoutStrategy,r.dims,e);if(e===4){let i=r.dims;if(i.length===4){let o=[i[0],Math.ceil(i[1]*i[2]*i[3]/4)],s=mu(this.session.layoutStrategy,o,e),l=r.numberData;if(i[1]*i[2]*i[3]%4!==0){let c=i[0],a=i[1]*i[2]*i[3],u=Math.ceil(a*1/4)*4,d=c*u;l=new Float32Array(d);for(let h=0;h<c;++h){let f=h*a,p=h*u+h%1*a;l.set(r.numberData.subarray(f,f+a),p)}}return this.createTextureData(s,r.type,l,r,1)}}if(e===2){let i=aw(this.session.layoutStrategy,r.dims,1,[],{reverseWH:!0}),o=this.createTextureData(i,r.type,r.numberData,r,1);n=this.pack(o)}else n=this.createTextureData(t,r.type,r.numberData,r,1)}return n}createTextureDataFromLayoutBindTensor(r,e,n,t){return this.createTextureData(r,e,n,t,1)}createTextureData(r,e,n,t,i){ht.verbose("InferenceHandler",`Creating TextureData: layout:[${JSON.stringify(r)}]`);let o=this.session.textureManager.createTextureFromLayout(e,r,n,i);return this.createTextureDataFromTexture(r,e,o,t)}reshapeUnpacked(r,e){let n=this.getOrCreateTextureData(r,0),t={channels:n.channels,height:n.height,width:n.width,shape:e.length!==0?e:[1],strides:ce.computeStrides(e),unpackedShape:e};return this.createTextureDataFromTexture(t,r.type,n.texture).tensor}reshapePacked(r,e){let n=this.getOrCreateTextureData(r,2);if(z8(r.dims,e)){let l={channels:n.channels,height:n.height,width:n.width,shape:e.length!==0?e:[1],strides:ce.computeStrides(e),unpackedShape:e,isPacked:!0};return this.createTextureDataFromTexture(l,r.type,n.texture).tensor}let t=NO(r.dims),i=NO(e),o=this.reshapePacked(r,t),s=this.run(PM(this,o,i),[o]);return this.reshapePacked(s,e)}cast(r,e){let n=this.getOrCreateTextureData(r,0);return this.createTextureDataFromTexture(n,e,n.texture).tensor}createTextureDataFromTexture(r,e,n,t,i){let o=k(C({},r),{tensor:t||new $n(r.unpackedShape,e,s=>this.readTexture(o),s=>F(this,null,function*(){return this.readTextureAsync(o)}),void 0,i),texture:n});return this.setTextureData(o.tensor.dataId,o,r.isPacked),o}getTextureData(r,e=!1){return this.session.isInitializer(r)?this.session.getTextureData(r,e):e?this.packedTextureDataCache.get(r):this.unpackedTextureDataCache.get(r)}setTextureData(r,e,n=!1){this.session.isInitializer(r)?this.session.setTextureData(r,e,n):(n?this.packedTextureDataCache:this.unpackedTextureDataCache).set(r,e)}isTextureLayoutCached(r,e=!1){return!!this.getTextureData(r.dataId,e)}dispose(){this.session.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(r=>this.session.textureManager.releaseTexture(r)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(r=>this.session.textureManager.releaseTexture(r)),this.unpackedTextureDataCache=new Map}readTexture(r){return r.isPacked?this.readTexture(this.unpack(r)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTexture(r,r.tensor.type,r.channels):this.session.textureManager.readUint8TextureAsFloat(ow(this,r))}readTextureAsync(r){return F(this,null,function*(){return r.isPacked?this.readTextureAsync(this.unpack(r)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTextureAsync(r,r.tensor.type,r.channels):this.session.textureManager.readUint8TextureAsFloat(ow(this,r))})}pack(r){return this.executeProgram(AM(this,r.tensor),[r.tensor])}unpack(r){return this.executeProgram(MM(this,r.tensor),[r.tensor])}}}),BO,We,zt=R(()=>{"use strict";BO=class{constructor(r){Object.assign(this,r)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(r=>`${this[r]}`).join(";")),this.key}},We=r=>new BO(r)}),m0,LM,BM,jO,VO,Q8=R(()=>{"use strict";zt(),it(),Ce(),m0={name:"BatchNormalization",inputNames:["A","Scale","B","Mean","Variance"],inputTypes:[0,0,0,0,0]},LM=(r,e,n)=>(VO(e),[r.run(k(C({},m0),{cacheHint:n.cacheKey,get:()=>jO(r,e,n)}),e)]),BM=r=>{let e=r.attributes.getFloat("epsilon",1e-5),n=r.attributes.getFloat("momentum",.9),t=r.attributes.getInt("spatial",1);return We({epsilon:e,momentum:n,spatial:t})},jO=(r,e,n)=>{let t=Se(r.session.backend.glContext.version),i=e[0].dims.length,[o,s]=r.calculateTextureWidthAndHeight(e[1].dims,0),l=`
  float process(int[${i}] indices) {
    vec2 position = offsetToCoords(indices[1], ${o}, ${s});
    float scale = getColorAsFloat(${t.texture2D}(Scale, position));
    float mean = getColorAsFloat(${t.texture2D}(Mean, position));
    float variance = getColorAsFloat(${t.texture2D}(Variance, position));
    float b = getColorAsFloat(${t.texture2D}(B, position));

    return scale * ( (_A(indices) - mean) / sqrt(variance + float(${n.epsilon})) ) + b;
  }`;return k(C({},m0),{output:{dims:e[0].dims,type:e[0].type,textureType:0},shaderSource:l})},VO=r=>{if(!r||r.length!==5)throw new Error("BatchNormalization requires 5 inputs.");let e=r[0],n=r[1],t=r[2],i=r[3],o=r[4];if(e.dims.length<3||n.dims.length!==1||t.dims.length!==1||i.dims.length!==1||o.dims.length!==1)throw new Error("invalid input shape.");if(n.dims[0]!==e.dims[1]||t.dims[0]!==e.dims[1]||i.dims[0]!==e.dims[1]||o.dims[0]!==e.dims[1])throw new Error("invalid input shape.");if(e.type!=="float32"&&e.type!=="float64"||n.type!=="float32"&&n.type!=="float64"||t.type!=="float32"&&t.type!=="float64"||i.type!=="float32"&&i.type!=="float64"||o.type!=="float32"&&o.type!=="float64")throw new Error("invalid input tensor types.")}}),jM,Tl,z,lw,VM,mo=R(()=>{"use strict";jM=class{constructor(r,e,n,t){this.glContext=r,this.programInfo=e,this.inputTextureLayouts=n,this.outputTextureLayout=t}},Tl=class{constructor(r){this.context=r}},z=class{constructor(r,e){this.routineBody=r,this.dependencies=e}},lw=class{constructor(r,e,n){this.name=r,n?this.dependencies=n:this.dependencies=[],e&&(this.routineBody=e)}addDependency(r){r&&this.dependencies.push(r)}},VM=class{static returnOrderedNodes(r){if(!r||r.length===0)return[];if(r.length===1)return r;let e=new Set,n=new Set,t=new Array;return this.createOrderedNodes(r,e,n,t),t}static createOrderedNodes(r,e,n,t){for(let i=0;i<r.length;++i)this.dfsTraverse(r[i],e,n,t)}static dfsTraverse(r,e,n,t){if(!r||n.has(r.name))return;if(e.has(r.name))throw new Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");e.add(r.name);let i=r.dependencies;if(i&&i.length>0)for(let o=0;o<i.length;++o)this.dfsTraverse(i[o],e,n,t);t.push(r),n.add(r.name),e.delete(r.name)}}});function eW(){let r="add_";return{body:`
  float ${r}(float a, float b) {
    return a + b;
  }
  vec4 ${r}(vec4 v1, vec4 v2) {
    return v1 + v2;
  }
  `,name:r,type:0}}function tW(){let r="div_";return{body:`
  float ${r}(float a, float b) {
    return a / b;
  }
  vec4 ${r}(vec4 v1, vec4 v2) {
    return v1 / v2;
  }
  `,name:r,type:0}}function nW(){let r="mul_";return{body:`
  float ${r}(float a, float b) {
    return a * b;
  }
  vec4 ${r}(vec4 v1, vec4 v2) {
    return v1 * v2;
  }
  `,name:r,type:0}}function rW(){let r="sub_";return{body:`
  float ${r}(float a, float b) {
    return a - b;
  }
  vec4 ${r}(vec4 v1, vec4 v2) {
    return v1 - v2;
  }
  `,name:r,type:0}}function iW(){let r="equal_";return{body:`
  float ${r}(float a, float b) {
    return float(a == b);
  }
  vec4 ${r}(vec4 v1, vec4 v2) {
    return vec4(equal(v1, v2));
  }
  `,name:r,type:0}}function oW(){let r="greater_";return{body:`
  float ${r}(float a, float b) {
    return float(a > b);
  }
  vec4 ${r}(vec4 v1, vec4 v2) {
    return vec4( v1.r > v2.r ,
      v1.g > v2.g,
      v1.b > v2.b,
      v1.a > v2.a );
  }
  `,name:r,type:0}}function sW(){let r="less_";return{body:`
  float ${r}(float a, float b) {
    return float(a < b);
  }
  vec4 ${r}(vec4 v1, vec4 v2) {
    return vec4( v1.r < v2.r ,
                v1.g < v2.g,
                v1.b < v2.b,
                v1.a < v2.a );
  }
  `,name:r,type:0}}function aW(){let r="and_";return{body:`
  float ${r}(float a, float b) {
    return float( bool(a) && bool(b) );
  }
  vec4 ${r}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r && b2.r ,
                b1.g && b2.g,
                b1.b && b2.b,
                b1.a && b2.a );
  }
  `,name:r,type:0}}function lW(){let r="or_";return{body:`
  float ${r}(float a, float b) {
    return float( bool(a) || bool(b) );
  }
  vec4 ${r}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r || b2.r ,
                b1.g || b2.g,
                b1.b || b2.b,
                b1.a || b2.a );
  }
  `,name:r,type:0}}function cW(){let r="xor_";return{body:`
  float ${r}(float a, float b) {
    return float( bool(a) ^^ bool(b) );
  }
  vec4 ${r}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r ^^ b2.r ,
                b1.g ^^ b2.g,
                b1.b ^^ b2.b,
                b1.a ^^ b2.a );
  }
  `,name:r,type:0}}function uW(){return hW("pow")}function dW(){let r="prelu_";return{body:`
  float ${r}(float a, float b) {
    return a < 0.0 ? a * b: a;
  }
  vec4 ${r}(vec4 v1, vec4 v2) {
    return vec4(
      v1.r < 0.0 ? v1.r * v2.r: v1.r,
      v1.g < 0.0 ? v1.g * v2.g: v1.g,
      v1.b < 0.0 ? v1.b * v2.b: v1.b,
      v1.a < 0.0 ? v1.a * v2.a: v1.a
      );
  }
  `,name:r,type:0}}function hW(r){let e=`${r}_`;return{body:`
  float ${e}(float a, float b) {
    return ${r}(a, b);
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return ${r}(v1, v2);
  }
  `,name:e,type:0}}var Ln,$O,$M,UM,HM,zM,GM,WM,qM,YM,XM,KM,ZM,JM,fW=R(()=>{"use strict";Re(),mo(),it(),Ce(),Ln=(r,e,n,t=e[0].type,i)=>{let o=r.session.pack?2:0;return{name:n.name,inputNames:["A","B"],inputTypes:[o,o],cacheHint:i,get:()=>$O(r,e,n,t)}},$O=(r,e,n,t=e[0].type)=>{let i=r.session.pack?2:0,o=!ce.areEqual(e[0].dims,e[1].dims),s=e[0].dims,l=r.session.pack;if(o){let u=Ur.calcShape(e[0].dims,e[1].dims,!1);if(!u)throw new Error("Can't perform binary op on the given tensors");s=u;let d=s.length,h=e[0].dims.length!==0?e[0].dims.length:1,f=e[1].dims.length!==0?e[1].dims.length:1,p=e[0].dims.length!==0?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",g=e[1].dims.length!==0?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",y=Se(r.session.backend.glContext.version),w=l?`
      ${n.body}
      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();
        vec4 result = ${n.name}(a, b);
        ${y.output} = result;
      }`:`
      ${n.body}
      float process(int indices[${d}]) {
        int aindices[${h}];
        int bindices[${f}];
        ${p}
        ${g}
        return ${n.name}(_A(aindices), _B(bindices));
      }`;return{name:n.name,inputNames:["A","B"],inputTypes:[i,i],output:{dims:s,type:t,textureType:i},shaderSource:w,hasMain:l}}let c=Se(r.session.backend.glContext.version),a=`
    ${n.body}
    void main() {
      vec4 v1 = ${c.texture2D}(A, TexCoords);
      vec4 v2 = ${c.texture2D}(B, TexCoords);
      vec4 result = ${n.name}(v1, v2);
      ${c.output} = result;
    }
    `;return{name:n.name,inputNames:["A","B"],inputTypes:[i,i],output:{dims:e[0].dims,type:t,textureType:i},shaderSource:a,hasMain:!0}},$M=(r,e)=>[r.run(Ln(r,e,eW()),e)],UM=(r,e)=>[r.run(Ln(r,e,aW(),"bool"),e)],HM=(r,e)=>[r.run(Ln(r,e,tW()),e)],zM=(r,e)=>[r.run(Ln(r,e,iW(),"bool"),e)],GM=(r,e)=>[r.run(Ln(r,e,oW(),"bool"),e)],WM=(r,e)=>[r.run(Ln(r,e,sW(),"bool"),e)],qM=(r,e)=>[r.run(Ln(r,e,nW()),e)],YM=(r,e)=>[r.run(Ln(r,e,lW(),"bool"),e)],XM=(r,e)=>[r.run(Ln(r,e,uW()),e)],KM=(r,e)=>[r.run(Ln(r,e,dW()),e)],ZM=(r,e)=>[r.run(Ln(r,e,rW()),e)],JM=(r,e)=>[r.run(Ln(r,e,cW(),"bool"),e)]}),QM,e2,UO,pW=R(()=>{"use strict";Re(),QM=(r,e,n)=>(UO(e),[r.cast(e[0],n)]),e2=r=>jn.tensorDataTypeFromProto(r.attributes.getInt("to")),UO=r=>{if(!r||r.length!==1)throw new Error("Cast requires 1 input.");if(r[0].type==="string")throw new Error("Invalid input type.")}}),HO,zO,t2,Qc,gW=R(()=>{"use strict";it(),Ce(),Ti(),_l(),HO=(r,e)=>({name:"Concat (packed)",inputNames:Array.from({length:r},(n,t)=>`X${t}`),inputTypes:Array(r).fill(2),cacheHint:e}),zO=(r,e,n,t)=>{let i=n[0].dims.slice();if(t>=i.length||t<-1*i.length)throw new Error("axis specified for concat doesn't match input dimensionality");t<0&&(t=i.length+t);let o=i.slice(0);for(let L=1;L<n.length;L++){let H=n[L].dims.slice();for(let q=0;q<i.length;q++)if(q===t)o[t]+=H[q];else if(i[q]!==H[q])throw new Error("non concat dimensions must match")}let s=o.length,l=kw("coords",s),c=go(s),a=Eu(),u=n.map(L=>L.dims),d=bl(s),h=new Array(u.length-1);h[0]=u[0][t];for(let L=1;L<h.length;L++)h[L]=h[L-1]+u[L][t];let f=d[t],p=d.slice(-2),g=d.join(),y=`if (${f} < ${h[0]}) {
        return getChannel(
            getX0(${g}), vec2(${p.join()}));
        }`;for(let L=1;L<h.length;L++){let H=h[L-1];y+=`
            if (${f} < ${h[L]}  && ${f} >= ${h[L-1]}) {
              return getChannel(
                getX${L}(${Qc(d,f,H)}),
                vec2(${Qc(p,f,H)}));
            }`}let w=h.length,v=h[h.length-1];y+=`
            return getChannel(
              getX${w}(${Qc(d,f,v)}),
              vec2(${Qc(p,f,v)}));`;let x=Se(r.session.backend.glContext.version),A=`
          ${a}
          float getValue(${d.map(L=>"int "+L)}) {
            ${y}
          }

          void main() {
            ${c} coords = getOutputCoords();
            int lastDim = coords.${d[s-1]};
            coords.${d[s-1]} = coords.${d[s-2]};
            coords.${d[s-2]} = lastDim;

            vec4 result = vec4(getValue(${l}), 0., 0., 0.);

            ${l[s-1]} = ${l[s-1]} + 1;
            if (${l[s-1]} < ${o[s-1]}) {
              result.g = getValue(${l});
            }

            ${l[s-2]} = ${l[s-2]} + 1;
            if (${l[s-2]} < ${o[s-2]}) {
              result.a = getValue(${l});
            }

            ${l[s-1]} = ${l[s-1]} - 1;
            if (${l[s-2]} < ${o[s-2]} &&
                ${l[s-1]} < ${o[s-1]}) {
              result.b = getValue(${l});
            }
            ${x.output} = result;
          }
        `;return k(C({},e),{output:{dims:o,type:n[0].type,textureType:2},shaderSource:A,hasMain:!0})},t2=(r,e,n)=>{let t=HO(e.length,n.cacheKey);return k(C({},t),{get:()=>zO(r,t,e,n.axis)})},Qc=(r,e,n)=>{let t=r.indexOf(e);return r.map((i,o)=>o===t?`${i} - ${n}`:i).join()}}),n2,GO,WO,qO,y0,YO,XO,KO,r2,ZO,mW=R(()=>{"use strict";zt(),Ce(),gW(),n2=(r,e,n)=>(ZO(e),r.session.pack&&e[0].dims.length>1?[r.run(t2(r,e,n),e)]:[r.run(qO(r,e,n),e)]),GO=(r,e)=>({name:"Concat",inputNames:Array.from({length:r},(n,t)=>`X${t}`),inputTypes:Array(r).fill(0),cacheHint:e}),WO=(r,e,n,t)=>{let i=n[0].dims.slice();if(t>=i.length||t<-1*i.length)throw new Error("axis specified for concat doesn't match input dimensionality");t<0&&(t=i.length+t);let o=i.slice(0);for(let f=1;f<n.length;f++){let p=n[f].dims.slice();for(let g=0;g<i.length;g++)if(g===t)o[t]+=p[g];else if(i[g]!==p[g])throw new Error("non concat dimensions must match")}let s=o.length,l=new Array(n.length),c=0;for(let f=0;f<l.length;++f)c+=n[f].dims[t],l[f]=c;let a="";n.length<5?a=y0(l):a=YO(l);let u=XO(n.length,s),d=KO(l),h=`
        ${u}
        ${d}
        ${a}
        float process(int indices[${s}]) {
          int textureIndex = getTextureWhereDataResides (indices[${t}]);

          if(textureIndex != 0) {
            indices[${t}] = indices[${t}] - int(getSizeInConcatAxisValueFromIndex(textureIndex-int(1)));
          }

          return fetchDataFromCorrectTexture(textureIndex, indices);
        }`;return k(C({},e),{output:{dims:o,type:n[0].type,textureType:0},shaderSource:h})},qO=(r,e,n)=>{let t=GO(e.length,n.cacheKey);return k(C({},t),{get:()=>WO(r,t,e,n.axis)})},y0=r=>`int getTextureWhereDataResides(int index) {
      ${r.map((e,n)=>`if(index<${e}) {return ${n};}
`).join("")}
    }`,YO=r=>y0(r),XO=(r,e)=>{let n=[`float fetchDataFromCorrectTexture(int textureIndex, int indices[${e}]) {`];for(let t=0;t<r;++t)t===0?n.push(`	if (textureIndex == ${t}) { return _X${t}(indices); }`):t===r-1?n.push(`	else { return _X${t}(indices); }`):n.push(`	else if (textureIndex == ${t}) { return _X${t}(indices); }`);return n.push("	}"),n.join(`
`)},KO=r=>{let e=["int getSizeInConcatAxisValueFromIndex(int index) {"];for(let n=0;n<r.length;++n)n===0?e.push(`	if (index == ${n}) { return ${r[n]}; }`):n===r.length-1?e.push(`	else { return ${r[n]}; }`):e.push(`	else if (index == ${n}) { return ${r[n]}; }`);return e.push("	}"),e.join(`
`)},r2=r=>We({axis:r.attributes.getInt("axis")}),ZO=r=>{if(!r||r.length<1)throw new Error("too few inputs");let e=r[0].type,n=r[0].dims.length;if(e==="string")throw new Error("string tensor is not supported yet");for(let t of r){if(t.type!==e)throw new Error("input tensors should be one type");if(t.dims.length!==n)throw new Error("input tensors should have the same shape")}}});function yW(){return or("abs")}function vW(){return or("acos")}function bW(){return or("asin")}function wW(){return or("atan")}function _W(){return or("ceil")}function TW(){return or("cos")}function xW(r){let e="elu";return{body:`
  const float alpha = float(${r});

  float ${e}_(float a) {
    return a >= 0.0 ? a: (exp(a) - 1.0) * alpha;
  }
  vec4 ${e}_(vec4 v) {
    return vec4(${e}_(v.x), ${e}_(v.y), ${e}_(v.z), ${e}_(v.w));
  }
  `,name:e,type:0}}function SW(){return or("exp")}function EW(){return or("floor")}function i2(r,e){let n="clip";return{body:`
  const float min = float(${r});
  const float max = float(${e});

  float ${n}_(float a) {
    return clamp(a, min, max);
  }
  vec4 ${n}_(vec4 v) {
    return clamp(v, min, max);
  }
  `,name:n,type:0}}function DW(){let r="indentity";return{body:`
  float ${r}_(float a) {
    return a;
  }
  vec4 ${r}_(vec4 v) {
    return v;
  }
  `,name:r,type:0}}function CW(r){let e="leakyRelu";return{body:`
  const float alpha = float(${r});

  float ${e}_(float a) {
    return a < 0.0 ? a * alpha : a;
  }
  vec4 ${e}_(vec4 v) {
    return vec4(${e}_(v.x), ${e}_(v.y), ${e}_(v.z), ${e}_(v.w));
  }
  `,name:e,type:0}}function IW(){return or("log")}function OW(){let r="neg";return{body:`
  float ${r}_(float a) {
    return -a;
  }
  vec4 ${r}_(vec4 v) {
    return -v;
  }
  `,name:r,type:0}}function AW(){let r="not";return{body:`
  float ${r}_(float a) {
    return float( ! bool(a) );
  }
  bool ${r}_(bool a) {
    return !a;
  }
  vec4 ${r}_(vec4 v) {
    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));
  }
  bvec4 ${r}_(bvec4 v) {
    return bvec4(!v.x, !v.y, !v.z, !v.w);
  }
  `,name:r,type:0}}function PW(){return or("sin")}function o2(){let r="relu";return{body:`
  float ${r}_(float a) {
    return max( a, 0.0 );
  }
  vec4 ${r}_(vec4 v) {
    return max( v, 0.0 );
  }
  `,name:r,type:0}}function s2(){let r="sigmoid";return{body:`
  float ${r}_(float a) {
    return 1.0 / (1.0 + exp(-a));
  }
  vec4 ${r}_(vec4 v) {
    return 1.0 / (1.0 + exp(-v));
  }
  `,name:r,type:0}}function MW(){return or("sqrt")}function NW(){return or("tan")}function RW(){let r="tanh";return{body:`
  float ${r}_(float a) {
    a = clamp(a, -10., 10.);
    a = exp(2.*a);
    return (a - 1.) / (a + 1.);
  }
  vec4 ${r}_(vec4 v) {
    v = clamp(v, -10., 10.);
    v = exp(2.*v);
    return (v - 1.) / (v + 1.);
  }
  `,name:r,type:0}}function or(r){return{body:`
  float ${r}_(float a) {
    return ${r}(a);
  }
  vec4 ${r}_(vec4 v) {
    return ${r}(v);
  }
  `,name:r,type:0}}var JO,dt,a2,l2,c2,u2,cw,d2,h2,QO,f2,p2,g2,m2,y2,v2,uw,b2,w2,_2,T2,x2,S2,E2,D2,C2,I2,O2,A2=R(()=>{"use strict";zt(),Re(),mo(),it(),Ce(),JO=(r,e,n,t)=>{let i=r.session.pack?2:0,o=Se(r.session.backend.glContext.version);return k(C({},e),{output:{dims:n.dims,type:n.type,textureType:i},shaderSource:`
     ${t.body}
     void main() {
       vec4 v = ${o.texture2D}(A, TexCoords);
       v = ${t.name}_(v);
       ${o.output} = v;
     }
     `,hasMain:!0})},dt=(r,e,n,t)=>{let i=r.session.pack?2:0,o={name:n.name,inputTypes:[i],inputNames:["A"],cacheHint:t};return k(C({},o),{get:()=>JO(r,o,e,n)})},a2=(r,e)=>[r.run(dt(r,e[0],yW()),e)],l2=(r,e)=>[r.run(dt(r,e[0],vW()),e)],c2=(r,e)=>[r.run(dt(r,e[0],bW()),e)],u2=(r,e)=>[r.run(dt(r,e[0],wW()),e)],cw=(r,e,n)=>[r.run(dt(r,e[0],i2(n.min,n.max),n.cacheKey),e)],d2=r=>We({min:r.attributes.getFloat("min",wu),max:r.attributes.getFloat("max",_u)}),h2=(r,e)=>{let n=QO(r,e);return cw(r,[e[0]],n)},QO=(r,e)=>{if(e.length>=3&&(!r.session.isInitializer(e[1].dataId)||!r.session.isInitializer(e[2].dataId)))throw new Error("dynamic clip attributes are not allowed");let n=e.length>=3?e[1].numberData[0]:wu,t=e.length>=3?e[2].numberData[0]:_u;return We({min:n,max:t})},f2=(r,e)=>[r.run(dt(r,e[0],_W()),e)],p2=(r,e)=>[r.run(dt(r,e[0],TW()),e)],g2=(r,e,n)=>[r.run(dt(r,e[0],xW(n.alpha),n.cacheKey),e)],m2=r=>We({alpha:r.attributes.getFloat("alpha",1)}),y2=(r,e)=>[r.run(dt(r,e[0],SW()),e)],v2=(r,e)=>[r.run(dt(r,e[0],EW()),e)],uw=(r,e)=>[r.run(dt(r,e[0],DW()),e)],b2=(r,e,n)=>[r.run(dt(r,e[0],CW(n.alpha),n.cacheKey),e)],w2=r=>We({alpha:r.attributes.getFloat("alpha",.01)}),_2=(r,e)=>[r.run(dt(r,e[0],IW()),e)],T2=(r,e)=>[r.run(dt(r,e[0],OW()),e)],x2=(r,e)=>[r.run(dt(r,e[0],AW()),e)],S2=(r,e)=>[r.run(dt(r,e[0],o2()),e)],E2=(r,e)=>[r.run(dt(r,e[0],s2()),e)],D2=(r,e)=>[r.run(dt(r,e[0],PW()),e)],C2=(r,e)=>[r.run(dt(r,e[0],MW()),e)],I2=(r,e)=>[r.run(dt(r,e[0],NW()),e)],O2=(r,e)=>[r.run(dt(r,e[0],RW()),e)]});function Du(r){let e;switch(r.activation){case"Relu":e=o2();break;case"Sigmoid":e=s2();break;case"Clip":e=i2(r.clipMin,r.clipMax);break;default:return{activationFunction:"",applyActivation:""}}let n=e.name,t=e.body,i=`value = ${n}_(value);`;return{activationFunction:t,applyActivation:i}}var Fp,xl=R(()=>{"use strict";Re(),A2(),Fp=r=>{let e=r.getString("activation","");if(e==="Clip"){let[n,t]=r.getFloats("activation_params",[wu,_u]);return{activation:e,clipMax:t,clipMin:n,activationCacheKey:`${e}:${n},${t}`}}return{activation:e,activationCacheKey:e}}}),eA,tA,P2,kW=R(()=>{"use strict";Er(),it(),Ce(),Bw(),xl(),eA=(r,e)=>({name:"GroupedConv",inputNames:r?["X","W","Bias"]:["X","W"],inputTypes:r?[0,0,0]:[0,0],cacheHint:e}),tA=(r,e,n,t)=>{let i=e.length>2?"value += getBias(output_channel);":"",o=e[0].dims.slice(),s=e[1].dims.slice(),l=s[0]/t.group;ht.verbose("GroupedConv",`autpPad:${t.autoPad}, dilations:${t.dilations}, group:${t.group}, kernelShape:${t.kernelShape}, pads:${t.pads}, strides:${t.strides}`);let c=yu(o,s,t.dilations,t.pads,t.strides),a=Se(r.session.backend.glContext.version),{activationFunction:u,applyActivation:d}=Du(t),h=`
  const ivec2 strides = ivec2(${t.strides[0]}, ${t.strides[1]});
  const ivec2 pads = ivec2(${t.pads[0]}, ${t.pads[1]});
  ${u}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;
    ivec2 xRCCorner = coords.zw * strides - pads;
    int group_id = output_channel / ${l};

    float value = 0.0;
    for (int wInChannel = 0; wInChannel < ${s[1]}; wInChannel++) {
      int input_channel = group_id * ${s[1]} + wInChannel;
      for (int wHeight = 0; wHeight < ${s[2]}; wHeight++) {
        int xHeight = xRCCorner.x + wHeight * ${t.dilations[0]};

        if (xHeight < 0 || xHeight >= ${o[2]}) {
          continue;
        }

        for (int wWidth = 0; wWidth < ${s[3]}; wWidth++) {
          int xWidth = xRCCorner.y + wWidth * ${t.dilations[1]};
          if (xWidth < 0 || xWidth >= ${o[3]}) {
            continue;
          }

          float xVal = getX(batch, input_channel, xWidth, xHeight);
          float wVal = getW(output_channel, wInChannel, wWidth, wHeight);
          value += xVal*wVal;
        }
      }
    }
    ${i}
    ${d}
    ${a.output} = vec4(value, .0, .0, .0);
  }
`;return k(C({},n),{output:{dims:c,type:e[0].type,textureType:0},shaderSource:h,hasMain:!0})},P2=(r,e,n)=>{let t=eA(e.length>2,n.cacheKey);return k(C({},t),{get:()=>tA(r,e,t,n)})}}),nA,rA,M2,FW=R(()=>{"use strict";it(),Ce(),_l(),nA=r=>({name:"Im2Col (packed)",inputNames:["A"],inputTypes:[2],cacheHint:r}),rA=(r,e,n,t,i,o)=>{let s=n.dims,l=t.dims,c=2,a=3,u=i.length,d=[l[1]*l[2]*l[3],i[2]*i[3]],h=l[2]*l[3],f=Eu(),p=Se(r.session.backend.glContext.version),g="";for(let w=0;w<=1;w++)for(let v=0;v<=1;v++)g+=`
            blockIndex = rc.x + ${v};
            pos = rc.y + ${w};

            if(blockIndex < ${d[1]} && pos < ${d[0]}) {
              offsetY = int(blockIndex / (${i[u-1]})) * ${o.strides[0]} -
                ${o.pads[0]};
              d0 = offsetY + ${o.dilations[0]} * (imod(pos, ${h}) / ${l[2]});

              if(d0 < ${s[c]} && d0 >= 0) {
                offsetX = imod(blockIndex, ${i[u-1]}) * ${o.strides[1]} -
                  ${o.pads[1]};
                d1 = offsetX + ${o.dilations[1]} * imod(imod(pos, ${h}), ${l[2]});

                if(d1 < ${s[a]} && d1 >= 0) {

                  ch = int(float(pos)/ ${h}.);
                    innerDims = vec2(d0, d1);
                    result[${w*2+v}] = getChannel(
                      getA(0, ch, int(innerDims.x),
                      int(innerDims.y)), innerDims);
                }
              }
            }

          `;let y=`
      ${f}

      void main() {
        ivec2 rc = getOutputCoords();
          vec4 result = vec4(0.0);
          int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
          vec2 innerDims;
          ${g}
          ${p.output} = result;
      }
            `;return k(C({},e),{output:{dims:d,type:n.type,textureType:2},shaderSource:y,hasMain:!0})},M2=(r,e,n,t,i)=>{let o=nA(i.cacheKey);return k(C({},o),{get:()=>rA(r,o,e,n,t,i)})}});function LW(r,e,n){let t=e[0].dims,i=e[1].dims,o=Ur.calcShape(t,i,!0);if(!o)throw new Error("Can't use matmul on the given tensors");let s=go(o.length),l=bl(),{activationFunction:c,applyActivation:a}=Du(n),u=e.length>2,d=u?"value += getBiasForMatmul();":"",h=u?`${R2(s,l,e[2].dims,o,!1)}`:"",f=o.length,p=t.length,g=i.length,y=t[t.length-1],w=`
    ${c}
    ${h}
    float process(int indices[${f}]) {
        int a[${p}];
        int b[${g}];
        bcastMatmulIndices_A(indices, a);
        bcastMatmulIndices_B(indices, b);

        float value;
        for (int k=0; k<${y}; ++k) {
            a[${p-1}] = k;
            b[${g-2}] = k;
            value += _A(a) * _B(b);
        }
        ${d}
        ${a}
        return value;
    }`;return k(C({},r),{output:{dims:o,type:e[0].type,textureType:0},shaderSource:w})}function N2(r,e){let n=L2(r.length>2,e.activationCacheKey);return k(C({},n),{get:()=>LW(n,r,e)})}function R2(r,e,n,t,i){let o="",s=n.length,l=t.length,c=l-s;l<2&&s>0?o="coords":o=n.map((h,f)=>`coords.${e[f+c]}`).join(", ");let a=Ur.getBroadcastDims(n,t).map(h=>`coords.${e[h+c]} = 0;`).join(`
`),u=ce.size(n)===1,d="vec4(outputValue.xx, outputValue.yy)";return u&&(d="vec4(outputValue.x)"),i?`
vec4 getBiasForMatmul() {
  ${r} coords = getOutputCoords();
  ${a}
  vec4 outputValue = getBias(${o});
  return ${d};
}`:`
float getBiasForMatmul() {
  ${r} coords = getOutputCoords();
  ${a}
  return getBias(coords.x);
}`}var k2,F2,L2,iA,Fw=R(()=>{"use strict";Re(),Ce(),Ti(),xl(),B2(),k2=(r,e,n)=>(iA(e),r.session.pack?[r.run(Lw(r,e,n),e)]:[r.run(N2(e,n),e)]),F2=r=>Fp(r.attributes),L2=(r,e)=>({name:"MatMul",inputNames:r?["A","B","Bias"]:["A","B"],inputTypes:r?[0,0,0]:[0,0],cacheHint:e}),iA=r=>{if(!r||r.length!==2)throw new Error("MatMul requires 2 inputs.");if(r[0].dims[r[0].dims.length-1]!==r[1].dims[r[1].dims.length-2])throw new Error("shared dimension does not match.");if(r[0].type!=="float32"&&r[0].type!=="float64"||r[1].type!=="float32"&&r[1].type!=="float64")throw new Error("inputs should be float type");if(r[0].type!==r[1].type)throw new Error("inputs types should match")}});function BW(r,e,n,t){let i=[],o=[],s=n[0].dims,l=n[1].dims,c=s.length,a=l.length,u=t.length,d=u-c,h=u-a;i=s.map((v,x)=>`coords.${e[x+d]}`),i[c-1]="i*2",i.join(", "),o=l.map((v,x)=>`coords.${e[x+h]}`),o[a-2]="i*2",o.join(", ");let f=Ur.getBroadcastDims(s,t),p=Ur.getBroadcastDims(l,t),g=f.map(v=>`coords.${e[v+d]} = 0;`).join(`
`),y=p.map(v=>`coords.${e[v+h]} = 0;`).join(`
`),w=`int lastDim = coords.${e[u-1]};
  coords.${e[u-1]} = coords.${e[u-2]};
  coords.${e[u-2]} = lastDim;`;return`
vec4 getAAtOutCoordsMatmul(int i) {
  ${r} coords = getOutputCoords();
  ${w}
  ${g}
  vec4 outputValue = getA(${i});
  return outputValue;
}

vec4 getBAtOutCoordsMatmul(int i) {
  ${r} coords = getOutputCoords();
  ${w}
  ${y}
  vec4 outputValue = getB(${o});
  return outputValue;
}`}function jW(r,e){let n="";for(let t=0;t<e-2;t++)n+=`rc.${r[t]}, `;return n+=`rc.${r[e-2]}, i*2`,n}function VW(r,e){let n="";for(let t=0;t<e-2;t++)n+=`rc.${r[t]}, `;return n+=`i*2, rc.${r[e-1]}`,n}var oA,sA,Lw,B2=R(()=>{"use strict";Re(),it(),Ce(),Ti(),xl(),Fw(),oA=(r,e)=>({name:"MatMul (packed)",inputNames:r?["A","B","Bias"]:["A","B"],inputTypes:r?[2,2,2]:[2,2],cacheHint:e}),sA=(r,e,n,t)=>{let i=n.length>2,o=i?"value += getBiasForMatmul();":"",s=n[0].dims,l=n[1].dims,c=Ur.calcShape(s,l,!0),a=!ce.areEqual(n[0].dims,n[1].dims);if(!c)throw new Error("Can't use matmul on the given tensors");let u=s[s.length-1],d=Math.ceil(u/2),h=s.length,f=l.length,p=Se(r.session.backend.glContext.version),g=go(c.length),y=c.length,w=bl(),{activationFunction:v,applyActivation:x}=Du(t),A=i?`${R2(g,w,n[2].dims,c,!0)}`:"",L=a?`${BW(g,w,n,c)}`:"",H=a?"getAAtOutCoordsMatmul(i)":`getA(${jW(w,h)})`,q=a?"getBAtOutCoordsMatmul(i)":`getB(${VW(w,f)})`,$=a?"":`${g} rc =
          getOutputCoords(); int lastDim = rc.${w[y-1]}; rc.${w[y-1]} =
          rc.${w[y-2]}; rc.${w[y-2]} = lastDim;
      `,we=`
            ${L}
            ${A}
            ${v}
            void main() {
              ${$}

              vec4 value = vec4(0);
              for (int i = 0; i < ${d}; i++) {
                vec4 a = ${H};
                vec4 b = ${q};

                value += (a.rrbb * b.rgrg);
                value += (a.ggaa * b.baba);
              }
              ${o}
              ${x}
              ${p.output} = value;
            }`;return k(C({},e),{output:{dims:c,type:n[0].type,textureType:2},shaderSource:we,hasMain:!0})},Lw=(r,e,n)=>{let t=oA(e.length>2,n.activationCacheKey);return k(C({},t),{get:()=>sA(r,t,e,n)})}}),j2,$W=R(()=>{"use strict";Bw(),FW(),B2(),j2=(r,e,n)=>{let t=e[0].dims,i=e[1].dims,o=yu(t,i,n.dilations,n.pads,n.strides),s=r.run(M2(r,e[0],e[1],o,n),[e[0]]),l=r.reshapePacked(e[1],[i[0],i[1]*i[2]*i[3]]),c=e.length===3?[l,s,e[2]]:[l,s],a=r.run(Lw(r,c,n),c);return r.reshapePacked(a,o)}}),aA,lA,V2,dw,$2=R(()=>{"use strict";Ce(),aA=r=>({name:"Im2Col",inputNames:["X"],inputTypes:[0],cacheHint:r}),lA=(r,e,n,t,i,o)=>{let s=n.dims,l=t.dims,c=i.length,a=dw(s,l,i,4),u=`
        const int XC = ${s[1]};
        const int XH = ${s[2]};
        const int XW = ${s[3]};
        const int KH = ${o.kernelShape[0]};
        const int KW = ${o.kernelShape[1]};
        const int dilationH = ${o.dilations[0]};
        const int dilationW = ${o.dilations[1]};
        const int strideH = ${o.strides[0]};
        const int strideW = ${o.strides[1]};
        const int padH = ${o.pads[0]};
        const int padW = ${o.pads[1]};
        const int KHKW = KH*KW;
        const int XCKHKW = XC * KHKW;
        const int outputChannels = 4;
        vec4 process(int indices[${c}]) {
          int b  = indices[0]; // batch size
          int oh = indices[1] * strideH - padH; //output height
          int ow = indices[2] * strideW - padW; //output width
          int p = indices[3] * outputChannels; //patch
          vec4 value = vec4(0.0);
          for(int i=0; i < outputChannels; ++i) {
            if(p < XCKHKW) {
              int patchC = p / KHKW;
              int patchH = (p - patchC*KHKW) / KW;
              int patchW = (p - patchC*KHKW) - patchH * KW;
              int xh2 = oh + patchH * dilationH;
              int xw2 = ow + patchW * dilationW;
              int x[${s.length}];
              x[0] = b;
              x[1] = patchC;
              x[2] = xh2;
              x[3] = xw2;
              if(xh2 >= 0 &&
                  xh2 < XH &&
                  xw2 >= 0 &&
                  xw2 < XW) {
                value[i] = _X(x);
              }
            }
            ++p;
          }
          return value;
        }
        `;return k(C({},e),{output:{dims:a,type:n.type,textureType:4},shaderSource:u})},V2=(r,e,n,t,i)=>{let o=aA(i.cacheKey);return k(C({},o),{get:()=>lA(r,o,e,n,t,i)})},dw=(r,e,n,t=4)=>[n[0],n[2],n[3],Math.ceil(r[1]*e[2]*e[3]/t)]}),cA,uA,U2,UW=R(()=>{"use strict";Re(),it(),Ce(),xl(),$2(),cA=(r,e)=>({name:"ConvDotProduct",inputNames:r?["Im2Col","K","B"]:["Im2Col","K"],inputTypes:r?[0,4,0]:[0,4],cacheKey:e.activationCacheKey}),uA=(r,e,n,t,i)=>{let o=n[0].dims,s=n[1].dims,l=[s[0],Math.ceil(o[1]*s[2]*s[3]/4)],c=dw(o,s,t),[a,u]=r.calculateTextureWidthAndHeight(l,4),d=ce.computeStrides(c),[h,f]=r.calculateTextureWidthAndHeight(c,4),p=t.length,g=n.length<3?"0.0":"_B(b)",y=Math.ceil(o[1]*s[2]*s[3]/4),{activationFunction:w,applyActivation:v}=Du(i),x=Se(r.session.backend.glContext.version),A=`
${w}
float process(int indices[${p}]) {
  int b[1];
  b[0] = indices[1];
  int im2col[4];
  im2col[0] = indices[0];
  im2col[1] = indices[2];
  im2col[2] = indices[3];
  int im2colOffset = im2col[0] * ${d[0]} + im2col[1] * ${d[1]} + im2col[2] * ${d[2]};
  int kernelOffset = indices[1] * ${l[1]};
  float value = ${g};
  for (int i = 0; i < ${y}; ++i) {
    vec2 im2colCoords = offsetToCoords(im2colOffset, ${h}, ${f});
    vec2 kernelCoords = offsetToCoords(kernelOffset, ${a}, ${u});
    value += dot(${x.texture2D}(Im2Col, im2colCoords), ${x.texture2D}(K, kernelCoords));
    ++im2colOffset;
    ++kernelOffset;
  }
  ${v}
  return value;
}`;return k(C({},e),{output:{dims:t,type:n[0].type,textureType:0},shaderSource:A})},U2=(r,e,n,t)=>{let i=cA(e.length>2,t);return k(C({},i),{get:()=>uA(r,i,e,n,t)})}}),yu,hw,dA,hA,fA,pA,fw,gA,Bw=R(()=>{"use strict";zt(),Re(),kW(),$W(),UW(),xl(),$2(),Fw(),yu=(r,e,n,t,i)=>{let o=r[0],s=r.slice(2),l=s.length,c=e[0],a=e.slice(2).map((d,h)=>d+(d-1)*(n[h]-1)),u=s.map((d,h)=>d+t[h]+t[h+l]).map((d,h)=>Math.floor((d-a[h]+i[h])/i[h]));return[o,c].concat(...u)},hw=(r,e,n)=>(gA(e,n),dA(r,e,n)),dA=(r,e,n)=>{let t=pA(n,e),i=r.session.pack,o=t.kernelShape[0]===1&&t.kernelShape[1]===1;return t.group>1?[r.run(P2(r,e,t),e)]:o&&i?[hA(r,e,t)]:i&&e[0].dims.length===4&&e[0].dims[0]===1&&!o?[j2(r,e,t)]:[fA(r,e,t)]},hA=(r,e,n)=>{let t=e[0].dims,i=e[1].dims,o=yu(t,i,n.dilations,n.pads,n.strides),s=r.reshapeUnpacked(e[0],[t[1],t[2]*t[3]]),l=r.reshapeUnpacked(e[1],[i[0],i[1]]),c=e.length>2?[l,s,e[2]]:[l,s],a=r.run(N2(c,n),c);return r.reshapeUnpacked(a,o)},fA=(r,e,n)=>{let t=e[0].dims,i=e[1].dims,o=yu(t,i,n.dilations,n.pads,n.strides),s=r.run(V2(r,e[0],e[1],o,n),[e[0]]),l=e.length===3?[s,e[1],e[2]]:[s,e[1]];return r.run(U2(r,e,o,n),l)},pA=(r,e)=>{let n=r.kernelShape.slice();if(r.kernelShape.length===0)for(let o=2;o<e[1].dims.length;++o)n.push(e[1].dims[o]);let t=r.pads.slice();Ip.adjustPadsBasedOnAutoPad(e[0].dims,r.strides,r.dilations,n,t,r.autoPad);let i=Object.assign({},r);return Object.assign(i,{kernelShape:n,pads:t,cacheKey:r.cacheKey}),i},fw=r=>{let e=r.attributes,n=Fp(e),t=e.getString("auto_pad","NOTSET"),i=e.getInts("dilations",[1,1]),o=e.getInt("group",1),s=e.getInts("kernel_shape",[]),l=e.getInts("pads",[0,0,0,0]),c=e.getInts("strides",[1,1]);return We(C({autoPad:t,dilations:i,group:o,kernelShape:s,pads:l,strides:c},n))},gA=(r,e)=>{if(!r||r.length!==2&&r.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(r[0].dims.length!==4||r[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");let n=r[0].dims[1],t=r[1].dims[1]*e.group;if(n!==t)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(r.length===3&&(r[2].dims.length!==1||r[1].dims[0]!==r[2].dims[0]))throw new Error("invalid bias");let i=r[0].dims.length-2;if(e.dilations.length!==i)throw new Error(`dilations should be ${i}D`);if(e.strides.length!==i)throw new Error(`strides should be ${i}D`);if(e.pads.length!==i*2)throw new Error(`pads should be ${i*2}D`);if(e.kernelShape.length!==0&&e.kernelShape.length!==r[1].dims.length-2)throw new Error("invalid kernel shape");if(r[0].type!=="float32"||r[1].type!=="float32")throw new Error("Conv input(X,W) should be float tensor");if(r.length===3&&r[2].type!=="float32")throw new Error("Conv input(bias) should be float tensor")}}),mA,yA,vA,H2,bA,wA,_A,TA,xA,SA,z2,EA,HW=R(()=>{"use strict";zt(),it(),Ce(),xl(),mA=(r,e,n,t,i,o)=>(r-1)*e+n+(t-1)*i+1-o,yA=(r,e,n,t,i)=>{let o=Math.floor(r/2);e==="SAME_UPPER"?(n[t]=o,n[i]=r-o):e==="SAME_LOWER"&&(n[t]=r-o,n[i]=o)},vA=(r,e,n,t,i,o,s,l)=>{let c=r.length-2,a=l.length===0;for(let u=0;u<c;++u){let d=a?r[u+2]*o[u]:l[u],h=mA(r[u+2],o[u],i[u],e[u],n[u],d);yA(h,t,i,u,u+c),a&&l.push(o[u]*(r[u+2]-1)+s[u]+(e[u]-1)*n[u]+1-i[u]-i[u+c])}},H2=(r,e,n)=>(EA(e,n),bA(r,e,n)),bA=(r,e,n)=>{let t=SA(n,e);return[xA(r,e,t)]},wA=(r,e)=>({name:"ConvTranspose",inputNames:r?["X","W","B"]:["X","W"],inputTypes:r?[0,0,0]:[0,0],cacheHint:e}),_A=(r,e,n,t)=>{let i=e.length>2?"getB(output_channel)":"0.0",o=e[0].dims,s=e[1].dims,l=s[1],c=s[0]/t.group,a=[e[0].dims[0],e[1].dims[1]*t.group,...t.outputShape],u=Se(r.session.backend.glContext.version),{activationFunction:d,applyActivation:h}=Du(t),f=`
  const ivec2 strides = ivec2(${t.strides[0]}, ${t.strides[1]});
  const ivec2 pads = ivec2(${t.pads[0]}, ${t.pads[1]});
  ${d}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;

    ivec2 loc = coords.zw + pads;

    int group_id = output_channel / ${l};
    int wOutChannel = output_channel - group_id * ${l};

    float value = ${i};
    for (int inChannelOffset = 0; inChannelOffset < ${c}; inChannelOffset++) {
      int input_channel = group_id * ${c} + inChannelOffset;
      for (int wWOff = 0; wWOff < ${s[2]}; wWOff++) {
        for (int wHOff = 0; wHOff < ${s[3]}; wHOff++) {
          ivec2 wOff = ivec2(wWOff * ${t.dilations[0]}, wHOff * ${t.dilations[1]});
          ivec2 wLoc = loc - wOff;
          ivec2 wLocIn = wLoc / strides;
          if (
            wLocIn * strides == wLoc &&
            wLocIn.x >= 0 && wLocIn.x < ${o[2]} &&
            wLocIn.y >= 0 && wLocIn.y < ${o[3]}
          ) {
            float xVal = getX(batch, input_channel, wLocIn.y, wLocIn.x);
            float wVal = getW(input_channel, wOutChannel, wHOff, wWOff);
            value += xVal * wVal;
          }
        }
      }
    }
    ${h}
    ${u.output} = vec4(value, .0, .0, .0);
  }
`;return k(C({},n),{output:{dims:a,type:e[0].type,textureType:0},shaderSource:f,hasMain:!0})},TA=(r,e,n)=>{let t=wA(e.length>2,n.cacheKey);return k(C({},t),{get:()=>_A(r,e,t,n)})},xA=(r,e,n)=>r.run(TA(r,e,n),e),SA=(r,e)=>{let n=r.kernelShape.slice();if(r.kernelShape.length===0)for(let l=2;l<e[1].dims.length;++l)n.push(e[1].dims[l]);let t=r.pads.slice(),i=r.outputShape.slice(),o=e[0].dims;vA(o,n,r.dilations,r.autoPad,t,r.strides,r.outputPadding,i);let s=Object.assign({},r);return Object.assign(s,{kernelShape:n,pads:t,outputShape:i,cacheKey:r.cacheKey}),s},z2=r=>{let e=r.attributes,n=Fp(e),t=e.getString("auto_pad","NOTSET"),i=e.getInts("dilations",[1,1]),o=e.getInt("group",1),s=e.getInts("kernel_shape",[]),l=e.getInts("output_padding",[0,0]),c=e.getInts("output_shape",[]),a=e.getInts("pads",[0,0,0,0]),u=e.getInts("strides",[1,1]);return We(C({autoPad:t,dilations:i,group:o,kernelShape:s,outputPadding:l,outputShape:c,pads:a,strides:u},n))},EA=(r,e)=>{if(!r||r.length!==2&&r.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(r[0].dims.length!==4||r[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");let n=r[0].dims[1],t=r[1].dims[0];if(n!==t)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let i=r[1].dims[1]*e.group;if(r.length===3&&(r[2].dims.length!==1||r[2].dims[0]!==i))throw new Error("invalid bias");let o=r[0].dims.length-2;if(e.dilations.length!==o)throw new Error(`dilations should be ${o}D`);if(e.strides.length!==o)throw new Error(`strides should be ${o}D`);if(e.pads.length!==o*2)throw new Error(`pads should be ${o*2}D`);if(e.outputPadding.length!==o)throw new Error(`output_padding should be ${o}D`);if(e.kernelShape.length!==0&&e.kernelShape.length!==r[1].dims.length-2)throw new Error("invalid kernel shape");if(e.outputShape.length!==0&&e.outputShape.length!==r[0].dims.length-2)throw new Error("invalid output shape");if(r[0].type!=="float32"||r[1].type!=="float32")throw new Error("ConvTranspose input(X,W) should be float tensor");if(r.length===3&&r[2].type!=="float32")throw new Error("ConvTranspose input(bias) should be float tensor")}}),v0,Tu,G2,DA,b0,CA,IA,OA,jw=R(()=>{"use strict";zt(),Re(),Ce(),v0={name:"Transpose",inputNames:["A"],inputTypes:[0]},Tu=(r,e,n)=>(OA(e),[r.run(k(C({},v0),{cacheHint:n.cacheKey,get:()=>DA(r,e[0],n.perm)}),e)]),G2=r=>We({perm:r.attributes.getInts("perm",[])}),DA=(r,e,n)=>{let t=e.dims;n=b0(t,n);let i=CA(t,n),o=t.length,s=`
      ${IA("perm",n,o)}
      float process(int indices[${o}]) {
        int a[${o}];
        perm(a, indices);
        return _A(a);
      }`;return k(C({},v0),{output:{dims:i,type:e.type,textureType:0},shaderSource:s})},b0=(r,e)=>(e&&e.length!==r.length&&(e=[...r.keys()].reverse()),e),CA=(r,e)=>(e=b0(r,e),ce.sortBasedOnPerm(r,e)),IA=(r,e,n)=>{let t=[];t.push(`void ${r}(out int a[${n}], int src[${n}]) {`);for(let i=0;i<n;++i)t.push(`	a[${e[i]}]=src[${i}];`);return t.push("	}"),t.join(`
`)},OA=r=>{if(!r||r.length!==1)throw new Error("Transpose requires 1 input.");if(r[0].type!=="float32"&&r[0].type!=="float64")throw new Error("input should be float tensor")}}),W2,q2,AA,zW=R(()=>{"use strict";jw(),W2=(r,e,n)=>{AA(e);let t=n.blocksize,i=t*t,o=n.mode==="DCR"?[0,3,4,1,5,2]:[0,1,4,2,5,3],s=n.mode==="DCR"?[e[0].dims[0],t,t,e[0].dims[1]/i,e[0].dims[2],e[0].dims[3]]:[e[0].dims[0],e[0].dims[1]/i,t,t,e[0].dims[2],e[0].dims[3]],l=r.reshapeUnpacked(e[0],s),c={perm:o,cacheKey:`${o}`},[a]=Tu(r,[l],c),u=[e[0].dims[0],e[0].dims[1]/i,e[0].dims[2]*t,e[0].dims[3]*t];return[r.reshapeUnpacked(a,u)]},q2=r=>{let e=r.attributes.getInt("blocksize");if(e<1)throw new Error(`blocksize must be >= 1, but got : ${e} for DepthToSpace`);let n=r.attributes.getString("mode","DCR");if(n!=="DCR"&&n!=="CRD")throw new Error(`unrecognized mode: ${n} for DepthToSpace`);return{mode:n,blocksize:e}},AA=r=>{if(r.length!==1)throw new Error(`DepthToSpace expect 1 inputs, but got ${r.length}`);if(r[0].type==="string"||r[0].dims.length!==4)throw new TypeError("DepthToSpace input should be a 4-D numeric tensor")}}),Y2,X2,PA,GW=R(()=>{"use strict";Re(),Y2=(r,e,n)=>{PA(e,n);let t=ce.flattenShape(e[0].dims,n);return[r.reshapeUnpacked(e[0],t)]},X2=r=>r.attributes.getInt("axis",1),PA=(r,e)=>{if(!r||r.length!==1)throw new Error("Flatten requires 1 input.");let n=r[0].dims.length;if(n===0)throw new Error("scalar tensor is not supported.");if(e<-n||e>n)throw new Error("Invalid axis");if(r[0].type==="string")throw new Error("string tensor is not supported.")}}),Cu,Lp=R(()=>{"use strict";Cu=["float32","float64","int32","int16","int8","uint16","uint32","uint8"]}),K2,Z2,MA,NA,RA,kA,WW=R(()=>{"use strict";zt(),Lp(),Re(),Ce(),K2=(r,e,n)=>(kA(e,n.axis),[r.run(RA(r,e,n),e)]),Z2=r=>We({axis:r.attributes.getInt("axis",0)}),MA={name:"Gather",inputNames:["A","B"],inputTypes:[0,0]},NA=(r,e,n,t)=>{let i=n[0].dims.slice(),o=n[1].dims.slice(),s=new Array(i.length+o.length-1);t=ce.normalizeAxis(t,i.length);let l=[];for(let h=0;h<s.length;h++)h<t?(s[h]=i[h],l.push(`inputIdx[${h}] = outputIdx[${h}];`)):h<t+o.length?(s[h]=o[h-t],l.push(`indexDataIdx[${h-t}] = outputIdx[${h}];`)):(s[h]=i[h-o.length+1],l.push(`inputIdx[${h-o.length+1}] = outputIdx[${h}];`));let c=s.length||1,a=i.length,u=o.length||1,d=`
      float process(int outputIdx[${c}]) {
        int inputIdx[${a}];
        int indexDataIdx[${u}];
        indexDataIdx[0] = 0;
        ${l.join(`
        `)}
        int idx = int(_B(indexDataIdx));
        inputIdx[${t}] = idx < 0 ? idx + ${i[t]} : idx;
        return _A(inputIdx);
      }`;return k(C({},e),{output:{dims:s,type:n[0].type,textureType:0},shaderSource:d})},RA=(r,e,n)=>{let t=k(C({},MA),{cacheHint:n.cacheKey});return k(C({},t),{get:()=>NA(r,t,e,n.axis)})},kA=(r,e)=>{if(!r||r.length!==2)throw new Error("Gather requires 2 inputs.");let n=r[0].dims.length;if(n<1)throw new Error("Invalid input shape.");if(e<-n||e>n-1)throw new Error("Invalid axis.");if(Cu.indexOf(r[0].type)===-1)throw new Error("Invaid input type.");if(r[1].type!=="int32"&&r[1].type!=="int16")throw new Error("Invaid input type.")}}),pw,w0,J2,Q2,FA,LA,BA,qW=R(()=>{"use strict";zt(),Re(),Ce(),pw=(r,e,n)=>(BA(e,n),[r.run(FA(e,n),e)]),w0=(r,e)=>{let n=r.attributes.getInt("transA",0)!==0,t=r.attributes.getInt("transB",0)!==0,i=r.attributes.getFloat("alpha",1),o=r.attributes.getFloat("beta",1);return We({transA:n,transB:t,alpha:i,beta:o,isOptionalC:e})},J2=r=>w0(r,!1),Q2=r=>w0(r,!0),FA=(r,e)=>{let n={name:"Gemm",inputNames:r.length===3?["A","B","C"]:["A","B"],inputTypes:r.length===3?[0,0,0]:[0,0],key:e.cacheKey};return k(C({},n),{get:()=>LA(n,r,e)})},LA=(r,e,n)=>{let t=e[0].dims.slice(),i=e[1].dims.slice(),[o,s]=EM.getShapeOfGemmResult(t,n.transA,i,n.transB,e.length===3?e[2].dims:void 0),l=[o,s];if(!l)throw new Error("Can't use gemm on the given tensors");let c=t[t.length-1],a="";n.transA&&(c=t[0]),n.transA&&n.transB?a="value += _A_T(a) * _B_T(b);":n.transA&&!n.transB?a="value += _A_T(a) * _B(b);":!n.transA&&n.transB?a="value += _A(a) * _B_T(b);":!n.transA&&!n.transB&&(a="value += _A(a) * _B(b);");let u=l.length,d=e.length===3?`int c[${e[2].dims.length}];`:"",h=e.length===3?"bcastIndices_C(indices, c);":"",f=e.length===3?"value += beta * _C(c);":"",p=`
      float process(int indices[${u}]) {
          int a[${u}];
          int b[${u}];
          ${d}

          copyVec(indices, a);
          copyVec(indices, b);
          ${h}

          float value = 0.0;
          for (int k=0; k<${c}; ++k) {
              a[${u-1}] = k;
              b[${u-2}] = k;
              ${a}
          }

          value = value * alpha;
          ${f}
          return value;
      }`;return k(C({},r),{output:{dims:l,type:e[0].type,textureType:0},variables:[{name:"alpha",type:"float",data:n.alpha},{name:"beta",type:"float",data:n.beta}],shaderSource:p})},BA=(r,e)=>{if(!r)throw new Error("Input is missing");if(e.isOptionalC&&(r.length<2||r.length>3))throw new Error("Invaid input shape.");if(!e.isOptionalC&&r.length!==3)throw new Error("Gemm requires 3 inputs");if(r.length===3&&r[2].dims.length!==1&&r[2].dims.length!==2)throw new Error("Invalid input shape of C");if(r[0].type!=="float32"&&r[0].type!=="float64"||r[1].type!=="float32"&&r[1].type!=="float64"||r.length===3&&r[2].type!=="float32"&&r[2].type!=="float64")throw new Error("Invalid input type.");if(r[0].type!==r[1].type||r.length===3&&r[0].type!==r[2].type)throw new Error("Input types are mismatched")}}),eN,tN,jA,VA,$A,UA,HA,YW=R(()=>{"use strict";zt(),Ce(),eN=(r,e,n)=>(HA(e),[r.run($A(r,e,n),e)]),tN=r=>{let e=r.attributes.getFloat("scale"),n=r.attributes.getFloats("bias");return We({scale:e,bias:n})},jA={name:"ImageScaler",inputNames:["X"],inputTypes:[0]},VA=(r,e,n,t)=>{let i=n[0].dims.slice(),o=i.length,s=`
      ${UA(t.bias.length)}
      float process(int indices[${o}]) {
        return _X(indices) * scale + getBias(bias, indices[1]);
      }`;return k(C({},e),{output:{dims:i,type:n[0].type,textureType:0},variables:[{name:"bias",type:"float",arrayLength:t.bias.length,data:t.bias},{name:"scale",type:"float",data:t.scale}],shaderSource:s})},$A=(r,e,n)=>{let t=k(C({},jA),{cacheHint:n.cacheKey});return k(C({},t),{get:()=>VA(r,t,e,n)})},UA=r=>{let e=[`float getBias(float bias[${r}], int channel) {`];for(let n=0;n<r;++n)n===0?e.push(`	if (channel == ${n}) { return bias[${n}]; }`):n===r-1?e.push(`	else { return bias[${n}]; }`):e.push(`	else if (channel == ${n}) { return bias[${n}]; }`);return e.push("	}"),e.join(`
`)},HA=r=>{if(!r||r.length!==1)throw new Error("ImageScaler requires 1 input.");if(r[0].dims.length!==4)throw new Error("Invalid input shape.");if(r[0].type!=="float32"&&r[0].type!=="float64")throw new Error("Invalid input type.")}}),nN,rN,_0,zA,GA,WA,qA,YA,XA,XW=R(()=>{"use strict";it(),Ce(),nN=(r,e,n)=>{XA(e);let t=r.run(GA(e[0]),e);return[r.run(YA(r,e[0],n,t.dims),[e[0],t,e[1],e[2]])]},rN=r=>r.attributes.getFloat("epsilon",1e-5),_0={name:"InstanceNormalization_MeanAndVariance",inputNames:["X"],inputTypes:[0]},zA=(r,e)=>{let n=e.dims.slice(),t=n[1],i=n[2]*n[3],o=[n[0],t],s=`
      vec4 process(int[2] indices) {
        vec4 v = vec4(0.0);
        int a[4];
        a[0] = indices[0];
        a[1] = indices[1];
        float temp = 0.0;
        for(int a2=0; a2<${n[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${n[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += x;
          }
        }
        float mean = temp / float(${i});
        temp = 0.0;
        for(int a2=0; a2<${n[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${n[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += (x - mean) * (x - mean);
          }
        }
        v.r = mean;
        v.g = temp / float(${i});

        return v;
      }`;return k(C({},r),{output:{dims:o,type:e.type,textureType:4},shaderSource:s})},GA=r=>k(C({},_0),{get:()=>zA(_0,r)}),WA={name:"InstanceNormalization_ComputeOutput",inputNames:["X","MeanAndVariance","Scale","B"],inputTypes:[0,4,0,0]},qA=(r,e,n,t,i)=>{let o=Se(r.session.backend.glContext.version),[s,l]=r.calculateTextureWidthAndHeight(i,4),[c,a]=[s/4,l],u=`
      vec4 get_MeanAndVariance(int[2] mv) {
        int offset = indicesToOffset_MeanAndVariance(mv);
        vec2 coords = offsetToCoords(offset, ${c}, ${a});
        return ${o.texture2D}(MeanAndVariance, coords);
      }

      float process(int[4] indices) {
        int mv[2];
        mv[0] = indices[0];
        mv[1] = indices[1];
        vec4 mean_and_variance = get_MeanAndVariance(mv);
        float mean = mean_and_variance.r;
        float variance = mean_and_variance.g;

        int sb[1];
        sb[0] = indices[1];
        float scale = _Scale(sb);
        float b = _B(sb);

        return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;
      }`;return k(C({},e),{output:{dims:n.dims,type:n.type,textureType:0},variables:[{name:"epsilon",type:"float",data:t}],shaderSource:u})},YA=(r,e,n,t)=>{let i=k(C({},WA),{cacheHint:`${n}`});return k(C({},i),{get:()=>qA(r,i,e,n,t)})},XA=r=>{if(!r||r.length!==3)throw new Error("InstanceNormalization requires 3 inputs.");let e=r[0],n=r[1],t=r[2];if(e.dims.length<3||n.dims.length!==1||t.dims.length!==1)throw new Error("Invalid input shape.");if(n.dims[0]!==e.dims[1]||t.dims[0]!==e.dims[1])throw new Error("Input shapes are mismatched.");if(e.type!=="float32"&&e.type!=="float64"||n.type!=="float32"&&n.type!=="float64"||t.type!=="float32"&&t.type!=="float64")throw new Error("Invalid input type.");if(r[0].dims.length!==4)throw new Error("Only support 4-D input shape.")}});function KW(r,e){let n=r[0].dims[1],t=r[0].dims.length,i=-Math.floor((e.size-1)/2),o=Math.ceil((e.size-1)/2),s=`float(${e.alpha}) / float(${e.size})`,l=`float(${e.bias})`,c=`float(${e.beta})`,a=`
    float process(int indices[${t}]) {
        int c = indices[1];
        float x = _X(indices);
        float square_sum = 0.0;

        for (int i = ${i}; i <= ${o}; i++) {
          int idx = c + i;
          if (c >= 0 && c < ${n}) {
            indices[1] = idx;
            float j = _X(indices);
            square_sum += j * j;
          }
        }
        return x / pow(${l} + ${s} * square_sum, ${c});
    }`;return k(C({},Vw),{cacheHint:e.cacheKey,output:{dims:r[0].dims,type:r[0].type,textureType:0},shaderSource:a})}function ZW(r,e){return k(C({},Vw),{cacheHint:e.cacheKey,get:()=>KW(r,e)})}var iN,oN,Vw,KA,JW=R(()=>{"use strict";zt(),Ce(),iN=(r,e,n)=>(KA(e),[r.run(ZW(e,n),e)]),oN=r=>{let e=r.attributes.getFloat("alpha",1e-4),n=r.attributes.getFloat("beta",.75),t=r.attributes.getFloat("bias",1),i=r.attributes.getInt("size");return We({alpha:e,beta:n,bias:t,size:i})},Vw={name:"LRN",inputNames:["X"],inputTypes:[0]},KA=r=>{if(!r||r.length!==1)throw new Error("LRN requires 1 input.");if(r[0].dims.length!==4)throw new Error('currently only support LRN for input with "NCHW" format');if(r[0].type!=="float32")throw new Error("input should be float type")}}),ZA,gw,sN,aN,lN,JA,QA,eP,tP,nP,rP,iP,oP,QW=R(()=>{"use strict";zt(),Re(),it(),Ce(),ZA={name:"Pad",inputNames:["A"],inputTypes:[0]},gw=(r,e,n)=>(eP(e),[r.run(k(C({},ZA),{cacheHint:n.cacheKey,get:()=>QA(r,e[0],n)}),e)]),sN=r=>{let e=r.attributes.getString("mode","constant"),n=r.attributes.getFloat("value",0),t=r.attributes.getInts("pads");return We({mode:e,value:n,pads:t})},aN=(r,e,n)=>{tP(e);let t=JA(r,e,n);return gw(r,[e[0]],t)},lN=r=>r.attributes.getString("mode","constant"),JA=(r,e,n)=>{if(!r.session.isInitializer(e[1].dataId)||e.length>=3&&!r.session.isInitializer(e[2].dataId))throw new Error("dynamic pad attributes are not allowed");let t=Array.from(e[1].integerData),i=e.length>=3?e[2].floatData[0]:0;return We({mode:n,pads:t,value:i})},QA=(r,e,n)=>{let t=ce.padShape(e.dims.slice(),n.pads),i=t.length,o=`
      ${nP(r,e,n)}
      float process(int[${i}] indices) {
          return padA(indices);
      }`;return{name:"Pad",inputNames:["A"],inputTypes:[0],output:{dims:t,type:e.type,textureType:0},shaderSource:o}},eP=r=>{if(!r||r.length!==1)throw new Error("Pad requires 1 input");if(r[0].type!=="float32"&&r[0].type!=="float64")throw new Error("Invalid input type.")},tP=r=>{if(!r||r.length!==2&&r.length!==3)throw new Error("Pad requires 2 or 3 inputs");if(r[1].type!=="int32")throw new Error("Invalid input type.");if(r.length>=3&&r[2].type==="string")throw new Error("Invalid input type.")},nP=(r,e,n)=>{let t=Se(r.session.backend.glContext.version),[i,o]=r.calculateTextureWidthAndHeight(e.dims,0),s=ce.computeStrides(e.dims);switch(n.mode){case"constant":return rP(t,e.dims,s,i,o,n.pads,n.value);case"reflect":return iP(t,e.dims,s,i,o,n.pads);case"edge":return oP(t,e.dims,s,i,o,n.pads);default:throw new Error("Invalid mode")}},rP=(r,e,n,t,i,o,s)=>{let l=e.length,c="";for(let a=l-1;a>=0;--a)c+=`
        k = m[${a}] - ${o[a]};
        if (k < 0)  return constant;
        if (k >= ${e[a]}) return constant;
        offset += k * ${n[a]};
        `;return`
      float padA(int m[${l}]) {
        const float constant = float(${s});
        int offset = 0;
        int k = 0;
        ${c}
        vec2 coords = offsetToCoords(offset, ${t}, ${i});
        float value = getColorAsFloat(${r.texture2D}(A, coords));
        return value;
      }
      `},iP=(r,e,n,t,i,o)=>{let s=e.length,l="";for(let c=s-1;c>=0;--c)l+=`
        k = m[${c}] - ${o[c]};
        if (k < 0) { k = -k; }
        {
          const int _2n_1 = ${2*(e[c]-1)};
          k = int( mod( float(k), float(_2n_1) ) ) ;
          if(k >= ${e[c]}) { k = _2n_1 - k; }
        }
        offset += k * ${n[c]};
        `;return`
      float padA(int m[${s}]) {
        int offset = 0;
        int k = 0;
        ${l}
        vec2 coords = offsetToCoords(offset, ${t}, ${i});
        float value = getColorAsFloat(${r.texture2D}(A, coords));
        return value;
      }
      `},oP=(r,e,n,t,i,o)=>{let s=e.length,l="";for(let c=s-1;c>=0;--c)l+=`
        k = m[${c}] - ${o[c]};
        if (k < 0)  k = 0;
        if (k >= ${e[c]}) k = ${e[c]-1};
        offset += k * ${n[c]};
      `;return`
      float padA(int m[${s}]) {
        int offset = 0;
        int k = 0;
        ${l}
        vec2 coords = offsetToCoords(offset, ${t}, ${i});
        float value = getColorAsFloat(${r.texture2D}(A, coords));
        return value;
      }
      `}}),cN,uN,T0,dN,hN,fN,pN,x0,S0,sP,E0,gN,eu,D0,tu,aP,eq=R(()=>{"use strict";zt(),Re(),Ce(),cN=(r,e,n)=>{eu(e);let t={name:"AveragePool",inputNames:["X"],inputTypes:[0],cacheHint:n.cacheKey};return[r.run(k(C({},t),{get:()=>T0(e,t,!1,n)}),e)]},uN=r=>{let e=r.attributes.getString("auto_pad","NOTSET"),n=r.attributes.getInt("ceil_mode",0),t=r.attributes.getInt("count_include_pad",0)!==0,i=r.attributes.getInts("kernel_shape"),o=r.attributes.getInts("strides",[]),s=r.attributes.getInts("pads",[]);if(n!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return We({autoPad:e,ceilMode:n,countIncludePad:t,kernelShape:i,strides:o,pads:s})},T0=(r,e,n,t)=>{let[i,o]=S0(r,t,n),s=ce.size(i.kernelShape),l="value += _X(x);",c="";i.countIncludePad?c+=`value /= float(${s});`:c+=`value /= float(${s} - pad);`;let a=`
        ${D0(r[0].dims,i,l,c,"0.0")}
      `;return k(C({},e),{output:{dims:o,type:r[0].type,textureType:0},shaderSource:a})},dN=(r,e,n)=>{eu(e);let t={name:"GlobalAveragePool",inputNames:["X"],inputTypes:[0],cacheHint:`${n.countIncludePad}`};return[r.run(k(C({},t),{get:()=>T0(e,t,!0,n)}),e)]},hN=r=>{let e=r.attributes.getInt("count_include_pad",0)!==0;return We({autoPad:"",ceilMode:0,countIncludePad:e,kernelShape:[],strides:[],pads:[]})},fN=(r,e,n)=>{eu(e);let t={name:"MaxPool",inputNames:["X"],inputTypes:[0],cacheHint:n.cacheKey};return[r.run(k(C({},t),{get:()=>x0(e,t,!1,n)}),e)]},pN=r=>{let e=r.attributes.getString("auto_pad","NOTSET"),n=r.attributes.getInt("ceil_mode",0),t=r.attributes.getInts("kernel_shape"),i=r.attributes.getInts("strides",[]),o=r.attributes.getInts("pads",[]),s=r.attributes.getInt("storage_order",0),l=r.attributes.getInts("dilations",[]);if(s!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(n!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return We({autoPad:e,ceilMode:n,countIncludePad:!1,kernelShape:t,strides:i,pads:o,storageOrder:s,dilations:l})},x0=(r,e,n,t)=>{let[i,o]=S0(r,t,n),s=`
      value = max(_X(x), value);
    `,l="",c=`
      ${D0(r[0].dims,i,s,l,"-1e5")}
    `;return k(C({},e),{output:{dims:o,type:r[0].type,textureType:0},shaderSource:c})},S0=(r,e,n)=>{let t=r[0].dims.slice(),i=Object.hasOwnProperty.call(e,"dilations"),o=e.kernelShape.slice(),s=e.strides.slice(),l=i?e.dilations.slice():[],c=e.pads.slice();Ip.adjustPoolAttributes(n,t,o,s,l,c);let a=Ip.computePoolOutputShape(n,t,s,l,o,c,e.autoPad),u=Object.assign({},e);return i?Object.assign(u,{kernelShape:o,strides:s,pads:c,dilations:l,cacheKey:e.cacheKey}):Object.assign(u,{kernelShape:o,strides:s,pads:c,cacheKey:e.cacheKey}),[u,a]},sP={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""},E0={name:"GlobalMaxPool",inputNames:["X"],inputTypes:[0]},gN=(r,e)=>(eu(e),[r.run(k(C({},E0),{get:()=>x0(e,E0,!0,sP)}),e)]),eu=r=>{if(!r||r.length!==1)throw new Error("Pool ops requires 1 input.");if(r[0].type!=="float32"&&r[0].type!=="float64")throw new Error("Invalid input type.")},D0=(r,e,n,t,i)=>{let o=r.length;if(e.kernelShape.length<=2){let s=e.kernelShape[e.kernelShape.length-1],l=e.strides[e.strides.length-1],c=e.pads[e.pads.length/2-1],a=e.pads[e.pads.length-1],u=r[o-1],d="",h="",f="";if(c+a!==0?d=`
          for (int i = 0; i < ${s}; i++) {
            x[${o} - 1] = indices[${o} - 1] * ${l} - ${c} + i;
            if (x[${o} - 1] < 0 || x[${o} - 1] >= ${u}) {
              pad++;
              continue;
            }
            ${n}
          }`:d=`
          for (int i = 0; i < ${s}; i++) {
            x[${o} - 1] = indices[${o} - 1] * ${l} - ${c} + i;
            ${n}
          }`,e.kernelShape.length===2){let p=e.kernelShape[e.kernelShape.length-2],g=e.strides[e.strides.length-2],y=e.pads[e.pads.length/2-2],w=e.pads[e.pads.length-2],v=r[o-2];y+w!==0?h=`
            for (int j = 0; j < ${p}; j++) {
              x[${o} - 2] = indices[${o} - 2] * ${g} - ${y} + j;
              if (x[${o} - 2] < 0 || x[${o} - 2] >= ${v}) {
                pad+= ${s};
                continue;
              }
          `:h=`
            for (int j = 0; j < ${p}; j++) {
              x[${o} - 2] = indices[${o} - 2] * ${g} - ${y} + j;
            `,f=`
          }
        `}return`
        float process(int indices[${o}]) {
          int x[${o}];
          copyVec(indices, x);

          float value = ${i};
          int pad = 0;
          ${h}
          ${d}
          ${f}
          ${t}
          return value;
        }
      `}else{let s=ce.size(e.kernelShape),l=ce.computeStrides(e.kernelShape),c=l.length,a=e.pads.length,u=aP(c),d=tu(r,"inputDims"),h=tu(e.pads,"pads"),f=tu(l,"kernelStrides"),p=tu(e.strides,"strides"),g=e.pads.reduce((w,v)=>w+v),y="";return g?y=`
            if (x[j] >= inputDims[j] || x[j] < 0) {
              pad++;
              isPad = true;
              break;
            }
          }
          if (!isPad) {
            ${n}
          }`:y=`
          }
          ${n}
        `,`
        ${u}
        float process(int indices[${o}]) {
          int x[${o}];
          copyVec(indices, x);
          int offset[${c}];
          int pads[${a}];
          int inputDims[${o}];
          int kernelStrides[${c}];
          int strides[${c}];
          ${h}
          ${d}
          ${p}
          ${f}

          float value = ${i};
          int pad = 0;
          bool isPad = false;
          for (int i = 0; i < ${s}; i++) {
            offsetToIndices(i, kernelStrides, offset);
            isPad = false;
            for (int j = ${o} - ${c}; j < ${o}; j++) {
              x[j] = indices[j] * strides[j - ${o} + ${c}]
                + offset[j - ${o} + ${c}] - pads[j - 2];
              ${y}
          }
          ${t}

          return value;
        }
      `}},tu=(r,e)=>{let n="";for(let t=0;t<r.length;t++)n+=`
      ${e}[${t}] = ${r[t]};
    `;return n},aP=r=>`
  void offsetToIndices(int offset, int[${r}] strides, out int[${r}] indices) {
    if (${r} == 0) {
      return;
    }
    for (int i = 0; i < ${r} - 1; ++i) {
      indices[i] = offset / strides[i];
      offset -= indices[i] * strides[i];
    }
    indices[${r} - 1] = offset;
  }`}),co,fo,lP,cP,mN,yN,vN,bN,wN,_N,TN,tq=R(()=>{"use strict";zt(),Lp(),Re(),Ce(),co=(r,e,n,t,i)=>{cP(e);let o={name:t,inputNames:["A"],inputTypes:[0]};return[r.run(k(C({},o),{cacheHint:n.cacheKey,get:()=>lP(r,e,n,t,i,o)}),e)]},fo=r=>{let e=r.attributes.getInts("axes",[]),n=r.attributes.getInt("keepdims",1)===1;return We({axes:e,keepDims:n})},lP=(r,e,n,t,i,o)=>{let s=[],l=e[0].dims.length||1,c=[],a=ce.normalizeAxes(n.axes,e[0].dims.length),u=i(e,a),d=u[1];for(let f=0;f<e[0].dims.length;f++)a.indexOf(f)>=0||a.length===0?(n.keepDims&&s.push(1),d=`
          for(int j${f} = 0; j${f} < ${e[0].dims[f]}; j${f}++) {
            inputIdx[${f}] = j${f};
            ${d}
          }`):(c.push(`inputIdx[${f}] = outputIdx[${s.length}];`),s.push(e[0].dims[f]));let h=`
      float process(int outputIdx[${s.length||1}]) {
        float value;                 // final result
        int inputIdx[${l}];      // addressing input data
        ${c.join(`
`)}
        ${u[0]}       // init ops for reduce max/min
        ${d}
        ${u[2]}       // final computation for reduce mean
        return value;
      }`;return k(C({},o),{output:{dims:s,type:e[0].type,textureType:0},shaderSource:h})},cP=r=>{if(!r||r.length!==1)throw new Error("Reduce op requires 1 input.");if(Cu.indexOf(r[0].type)===-1)throw new Error("Invalid input type.")},mN=(r,e,n)=>co(r,e,n,"ReduceSum",()=>["value = 0.0;","value += _A(inputIdx);",""]),yN=(r,e,n)=>co(r,e,n,"ReduceMean",(t,i)=>{let o=1;for(let s=0;s<t[0].dims.length;s++)(i.indexOf(s)>=0||i.length===0)&&(o*=t[0].dims[s]);return["value = 0.0;","value += _A(inputIdx);",`value /= ${o}.;`]}),vN=(r,e,n)=>co(r,e,n,"ReduceMax",(t,i)=>{let o=[];for(let s=0;s<t[0].dims.length;s++)(i.indexOf(s)>=0||i.length===0)&&o.push(`inputIdx[${s}] = 0;`);return[`${o.join(`
`)}
value = _A(inputIdx);`,"value = max(value, _A(inputIdx));",""]}),bN=(r,e,n)=>co(r,e,n,"ReduceMin",(t,i)=>{let o=[];for(let s=0;s<t[0].dims.length;s++)(i.indexOf(s)>=0||i.length===0)&&o.push(`inputIdx[${s}] = 0;`);return[`${o.join(`
`)}
value = _A(inputIdx);`,"value = min(value, _A(inputIdx));",""]}),wN=(r,e,n)=>co(r,e,n,"ReduceProd",()=>["value = 1.0;","value *= _A(inputIdx);",""]),_N=(r,e,n)=>co(r,e,n,"ReduceLogSum",()=>["value = 0.0;","value += _A(inputIdx);","value = log(value);"]),TN=(r,e,n)=>co(r,e,n,"ReduceLogSumSquare",()=>["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""])}),xN,nq=R(()=>{"use strict";Re(),xN=(r,e)=>{let n=ce.calculateReshapedDims(e[0].dims,e[1].integerData);return r.session.pack?[r.reshapePacked(e[0],n)]:[r.reshapeUnpacked(e[0],n)]}}),C0,mw,SN,EN,vu,uP,yw,Ap,DN=R(()=>{"use strict";zt(),it(),Ce(),C0={name:"Upsample",inputNames:["X"],inputTypes:[0]},mw=(r,e,n)=>(yw(e,n),[r.run(k(C({},C0),{cacheHint:n.cacheKey,get:()=>uP(r,e,n)}),e)]),SN=r=>vu(r,7),EN=r=>vu(r,9),vu=(r,e)=>{let n=e>=10,t=r.attributes.getString("mode","nearest");if(t!=="nearest"&&t!=="linear"&&(e<11||t!=="cubic"))throw new Error(`unrecognized mode: ${t}`);let i=[];e<9&&(i=r.attributes.getFloats("scales"),Ap(i,t,n));let o=r.attributes.getFloat("extrapolation_value",0),s=e>10?r.attributes.getString("coordinate_transformation_mode","half_pixel"):"asymmetric";if(["asymmetric","pytorch_half_pixel","tf_half_pixel_for_nn","align_corners","tf_crop_and_resize","half_pixel"].indexOf(s)===-1)throw new Error(`coordinate_transform_mode '${s}' is not supported`);let l=s==="tf_crop_and_resize",c=l,a=t==="nearest"&&e>=11?r.attributes.getString("nearest_mode","round_prefer_floor"):"";if(["round_prefer_floor","round_prefer_ceil","floor","ceil",""].indexOf(a)===-1)throw new Error(`nearest_mode '${a}' is not supported`);let u=r.attributes.getFloat("cubic_coeff_a",-.75),d=r.attributes.getInt("exclude_outside",0)!==0;if(d&&t!=="cubic")throw new Error("exclude_outside can be set to 1 only when mode is CUBIC.");let h=e<11?!0:t==="nearest"&&s==="asymmetric"&&a==="floor",f=0,p=0,g=0;return e>10?r.inputs.length>2?(f=1,p=2,g=3):(p=1,g=2):e===9&&(p=1),We({opset:e,isResize:n,mode:t,scales:i,extrapolationValue:o,coordinateTransformMode:s,useExtrapolation:c,needRoiInput:l,nearestMode:a,cubicCoefficientA:u,excludeOutside:d,useNearest2xOptimization:h,roiInputIdx:f,scalesInputIdx:p,sizesInputIdx:g})},uP=(r,e,n)=>{let t=Se(r.session.backend.glContext.version),[i,o]=r.calculateTextureWidthAndHeight(e[0].dims,0),s=e[0].dims.map((g,y)=>Math.floor(g*n.scales[y])),[l,c]=r.calculateTextureWidthAndHeight(s,0),a=s.length,u=new Array(a),d=new Array(a),h=`
      int output_pitches[${a}];
      int input_pitches[${a}];
      `;for(let g=a-1;g>=0;g--)u[g]=g===a-1?1:u[g+1]*s[g+1],d[g]=g===a-1?1:d[g+1]*e[0].dims[g+1],h+=`
        output_pitches[${g}] = ${u[g]};
        input_pitches[${g}] = ${d[g]};
        `;let f=`
      float getInputFloat(int index) {
        vec2 coords = offsetToCoords(index, ${i}, ${o});
        float value = getColorAsFloat(${t.texture2D}(X, coords));
        return value;
      }
      `,p=n.mode==="nearest"?`
    ${f}
    float process(int indices[${a}]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${l}, ${c});

      ${h}

      int d, m;
      for (int dim = 0; dim < ${a}; ++dim) {
        d = output_index / output_pitches[dim];
        m = output_index - d * output_pitches[dim];
        output_index = m;

        if (scales[dim] != 1 && d > 0) {
          int d2 = d / scales[dim];
          m = d - d2 * scales[dim];
          d = d2;
        }
        input_index += input_pitches[dim] * d;
      }

      return getInputFloat(input_index);
    }`:a===4?`
    ${f}
    float process(int indices[4]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${l}, ${c});

      ${h}

      int m;
      int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m / output_pitches[1];
      m = m - index_of_dim1 * output_pitches[1];
      index_of_dim2 = m / output_pitches[2];
      m = m - index_of_dim2 * output_pitches[2];
      index_of_dim3 = m;

      int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;
      index_of_input_dim2 = index_of_dim2 / scales[2];
      y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];
      index_of_input_dim3 = index_of_dim3 / scales[3];
      x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];

      input_index = index_of_dim0 * input_pitches[0] +
            index_of_dim1 * input_pitches[1] +
            index_of_input_dim2 * input_pitches[2] +
            index_of_input_dim3;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim2 = false;
      if (index_of_input_dim2 == (${e[0].dims[2]} - 1)) {
        // It's the end in dimension 2
        x01 = x00;
        end_of_dim2 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[2]);
      }

      if (index_of_input_dim3 == (input_pitches[2] - 1)) {
        // It's the end in dimension 3
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);
    }`:`
    ${f}
    float process(int indices[2]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${l}, ${c});

      ${h}

      int m;
      int index_of_dim0, index_of_dim1;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m;

      int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;
      index_of_input_dim0 = index_of_dim0 / scales[0];
      y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];
      index_of_input_dim1 = index_of_dim1 / scales[1];
      x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];

      input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim0 = false;
      if (index_of_input_dim0 == (${e[0].dims[0]} - 1)) {
        // It's the end in dimension 0
        x01 = x00;
        end_of_dim0 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[0]);
      }

      if (index_of_input_dim1 == (input_pitches[0] - 1)) {
        // It's the end in dimension 1
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);
    }`;return k(C({},C0),{output:{dims:s,type:e[0].type,textureType:0},shaderSource:p,variables:[{name:"scales",type:"int",arrayLength:n.scales.length,data:n.scales.map(g=>Math.ceil(g))}]})},yw=(r,e)=>{if(!r||e.opset<9&&r.length!==1||e.opset>=9&&e.opset<11&&r.length!==2||e.opset>=11&&r.length<2)throw new Error("invalid inputs.");if(e.scales.length>0&&r[0].dims.length!==e.scales.length)throw new Error("Invalid input shape.");if(r[0].type==="string")throw new Error("Invalid input tensor types.")},Ap=(r,e,n)=>{if(n){for(let t of r)if(t<=0)throw new Error("Scale value should be greater than 0.")}else for(let t of r)if(t<1)throw new Error("Scale value should be greater than or equal to 1.");if((e==="linear"||e==="cubic")&&r.length!==2&&(r.length!==4||r[0]!==1||r[1]!==1))throw new Error(`'Linear' mode and 'Cubic' mode only support 2-D inputs ('Bilinear', 'Bicubic')         or 4-D inputs with the corresponding outermost 2 scale values being 1         in the ${n?"Resize":"Upsample"} opeartor.`)}}),bp,vw,CN,IN,dP,hP,fP,pP,rq=R(()=>{"use strict";it(),Ce(),Ti(),_l(),DN(),bp={name:"Resize",inputNames:["A"],inputTypes:[2]},vw=(r,e,n)=>(yw(e,n),[r.run(k(C({},bp),{cacheHint:n.cacheKey,get:()=>dP(r,e,n)}),e)]),CN=r=>vu(r,10),IN=r=>vu(r,11),dP=(r,e,n)=>{let t=Se(r.session.backend.glContext.version),[i,o]=hP(e,n);if(i.every(v=>v===1)&&n.coordinateTransformMode!=="tf_crop_and_resize")return k(C({},bp),{output:{dims:o,type:e[0].type,textureType:2},hasMain:!0,shaderSource:`void main() {
                    vec4 v = ${t.texture2D}(X, TexCoords);
                    ${t.output} = v;
                }`});let s=o.length;if(s<2)throw new Error(`output dimension should be at least 2, but got ${s}`);let l=o[s-2],c=o[s-1],a=e[0].dims;if(s!==a.length)throw new Error(`output dimension should match input ${a.length}, but got ${s}`);let u=a[s-2],d=a[s-1],h=i[s-2],f=i[s-1],p="";if(n.mode!=="linear")throw new Error(`resize (packed) does not support mode: '${n.mode}'`);switch(n.coordinateTransformMode){case"asymmetric":p=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return vec4(coords) / scaleWHWH;
                    }
                `;break;case"half_pixel":p=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return (vec4(coords) + 0.5) / scaleWHWH - 0.5;
                    }
                `;break;case"pytorch_half_pixel":p=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 fcoords = vec4(coords);
                        return vec4(
                            ${c}.0 > 1.0 ? (fcoords.x + 0.5) / scaleWHWH.x - 0.5 : 0.0,
                            ${l}.0 > 1.0 ? (fcoords.y + 0.5) / scaleWHWH.y - 0.5 : 0.0,
                            ${c}.0 > 1.0 ? (fcoords.z + 0.5) / scaleWHWH.z - 0.5 : 0.0,
                            ${l}.0 > 1.0 ? (fcoords.w + 0.5) / scaleWHWH.w - 0.5 : 0.0
                          );
                    }
                `;break;case"align_corners":p=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 resized = vec4(${c}.0 - 1.0, ${l}.0 - 1.0, ${c}.0 - 1.0,
                            ${l}.0 - 1.0);
                        vec4 original = vec4(${d}.0 - 1.0, ${u}.0 - 1.0, ${d}.0 - 1.0,
                            ${u}.0 - 1.0);
                        vec4 new_scale = original / resized;
                        return vec4(coords) * new_scale;
                    }
                `;break;default:throw new Error(`resize (packed) does not support coordinateTransformMode:                                 '${n.coordinateTransformMode}'`)}let g=go(s),y=Eu(),w=`
            const vec2 inputWH = vec2(${u}.0, ${d}.0);
            const vec4 scaleWHWH = vec4(float(${h}), float(${f}), float(${h}), float(${f}));
            ${y}
            ${p}
            float getAValue(int x10, int r, int c, int d) {
                return getChannel(getA(x10, r, c, d), vec2(c, d));
            }
            void main() {
                ${g} rc = getOutputCoords();

                int batch = rc[0];
                int depth = rc[1];

                // retrieve the 4 coordinates that is used in the 4 packed output values.
                ivec4 coords = ivec4(rc.wz, rc.w + 1, rc.z + 1);

                // calculate the source index in fraction
                vec4 sourceFrac = getSourceFracIndex(coords);

                // get the lower and upper bound of the 4 values that will be packed into one texel.
                ivec4 x00 = ivec4(max(sourceFrac.xy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xy)));
                ivec4 x01 = ivec4(max(sourceFrac.xw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xw)));
                ivec4 x10 = ivec4(max(sourceFrac.zy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zy)));
                ivec4 x11 = ivec4(max(sourceFrac.zw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zw)));

                bool hasNextRow = rc.w < ${l-1};
                bool hasNextCol = rc.z < ${c-1};

                // pack x00, x01, x10, x11's top-left corner into one vec4 structure
                vec4 topLeft = vec4(
                    getAValue(batch, depth, x00.x, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.y) : 0.0);

                // pack x00, x01, x10, x11's top-right corner into one vec4 structure
                vec4 topRight = vec4(
                    getAValue(batch, depth, x00.x, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.w) : 0.0);

                // pack x00, x01, x10, x11's bottom-left corner into one vec4 structure
                vec4 bottomLeft = vec4(
                    getAValue(batch, depth, x00.z, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.y) : 0.0);

                // pack x00, x01, x10, x11's bottom-right corner into one vec4 structure
                vec4 bottomRight = vec4(
                    getAValue(batch, depth, x00.z, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.w) : 0.0);

                // calculate the interpolation fraction on u and v direction
                vec4 frac = vec4(sourceFrac) - floor(sourceFrac);
                vec4 clampFrac = clamp(frac, vec4(0.0), vec4(1.0));

                vec4 top = mix(topLeft, topRight, clampFrac.ywyw);
                vec4 bottom = mix(bottomLeft, bottomRight, clampFrac.ywyw);
                vec4 newValue = mix(top, bottom, clampFrac.xxzz);

                ${t.output} = vec4(newValue);
            }
        `;return k(C({},bp),{output:{dims:o,type:e[0].type,textureType:2},hasMain:!0,shaderSource:w})},hP=(r,e)=>{let n=r[0].dims,t=e.scales,i;if(t.length===0){let s=r[e.scalesInputIdx];if(s&&s.size!==0){if(r[e.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");t=fP(s,e.mode,e.isResize)}else{let l=r[e.sizesInputIdx];if(!l||l.size===0)throw new Error("Either scales or sizes MUST be provided as input.");i=Array.from(l.integerData),t=pP(i,n,e.mode,e.isResize)}}else if(r[e.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");let o=i||n.map((s,l)=>Math.floor(s*t[l]));return[t,o]},fP=(r,e,n)=>{let t=Array.from(r.floatData);return Ap(t,e,n),t},pP=(r,e,n,t)=>{let i=e.length,o=new Array(i);for(let s=0,l=i;s<l;s++)if(e[s]===0){if(r[s]!==0)throw new Error("Input dim is zero but required output dim is non-zero.");o[s]=1}else o[s]=r[s]/e[s];return Ap(o,n,t),o}}),ON,gP,iq=R(()=>{"use strict";wl(),ON=(r,e)=>(gP(e),[new $n([e[0].dims.length],"int32",void 0,void 0,new Int32Array(e[0].dims))]),gP=r=>{if(!r||r.length!==1)throw new Error("Shape requires 1 input.")}}),wp,AN,PN,I0,mP,MN,yP,vP,oq=R(()=>{"use strict";zt(),Lp(),Re(),Ce(),wp={name:"Slice",inputNames:["A"],inputTypes:[0]},AN=(r,e,n)=>(mP(e),[r.run(k(C({},wp),{cacheHint:n.cacheKey,get:()=>I0(r,e[0],n)}),e)]),PN=r=>{let e=r.attributes.getInts("starts"),n=r.attributes.getInts("ends"),t=r.attributes.getInts("axes",[]);return We({starts:e,ends:n,axes:t})},I0=(r,e,n)=>{let t=n.axes.length===0?e.dims.slice(0).map((u,d)=>d):n.axes,i=ce.normalizeAxes(t,e.dims.length),o=n.starts.map((u,d)=>u>e.dims[i[d]]-1?e.dims[i[d]]:ce.normalizeAxis(u,e.dims[i[d]])),s=n.ends.map((u,d)=>u>e.dims[i[d]]-1?e.dims[i[d]]:ce.normalizeAxis(u,e.dims[i[d]])),l=e.dims.slice(),c=[];for(let u=0;u<i.length;u++)l[i[u]]=s[u]-o[u],o[u]>0&&c.push(`outputIdx[${i[u]}] += ${o[u]};`);let a=`
      float process(int outputIdx[${l.length}]) {
        ${c.join(`
      `)}
        return _A(outputIdx);
      }`;return k(C({},wp),{output:{dims:l,type:e.type,textureType:0},shaderSource:a})},mP=r=>{if(!r||r.length!==1)throw new Error("Slice requires 1 input.");if(Cu.indexOf(r[0].type)===-1)throw new Error("Invalid input type.")},MN=(r,e)=>{vP(e);let n=yP(r,e);return[r.run(k(C({},wp),{cacheHint:n.cacheKey,get:()=>I0(r,e[0],n)}),[e[0]])]},yP=(r,e)=>{if(!r.session.isInitializer(e[1].dataId)||!r.session.isInitializer(e[2].dataId)||e.length>=4&&!r.session.isInitializer(e[3].dataId)||e.length>=5&&!r.session.isInitializer(e[4].dataId))throw new Error("dynamic slice attributes are not allowed");if(e.length>=5&&e[4].integerData.some(s=>s!==1))throw new Error("currently non-1 steps is not supported for Slice");let n=Array.from(e[1].integerData),t=Array.from(e[2].integerData),i=e.length>=4?Array.from(e[3].integerData):[],o=`${i};${n};${t}`;return{starts:n,ends:t,axes:i,cacheKey:o}},vP=r=>{if(!r||r.length<3||r.length>5)throw new Error("Invalid input number.");if(r[1].type!=="int32"||r[1].dims.length!==1)throw new Error("Invalid input type.");if(r[2].type!=="int32"||r[2].dims.length!==1)throw new Error("Invalid input type.");if(r.length>=4&&(r[3].type!=="int32"||r[3].dims.length!==1))throw new Error("Invalid input type.");if(r.length>=5&&(r[4].type!=="int32"||r[4].dims.length!==1))throw new Error("Invalid input type.")}}),O0,A0,P0,NN,RN,kN,FN,M0,bP,wP,_P,N0,sq=R(()=>{"use strict";zt(),Re(),it(),Ce(),jw(),O0={name:"SoftmaxComputeMax",inputNames:["A"],inputTypes:[0]},A0={name:"SoftmaxComputeScale",inputNames:["A","Max"],inputTypes:[0,0]},P0={name:"SoftMax",inputNames:["A","Max","Norm"],inputTypes:[0,0,0]},NN=(r,e,n)=>{N0(e);let t=e[0].dims.slice(),i=ce.normalizeAxis(n.axis,t.length),o=ce.sizeToDimension(t,i),s=ce.sizeFromDimension(t,i);return M0(r,e,n,o,s)},RN=r=>We({axis:r.attributes.getInt("axis",1)}),kN=r=>We({axis:r.attributes.getInt("axis",-1)}),FN=(r,e,n)=>{N0(e);let t=e[0].dims.slice(),i=ce.normalizeAxis(n.axis,t.length),o=t.length,s=i!==o-1,l=[],c=[],a=[],u;s&&(c=Array.from({length:o}).map((p,g)=>g),c[i]=o-1,c[o-1]=i,c.map(p=>l.push(t[p])),u=We({perm:c}),a=Tu(r,e,u));let d=s?ce.sizeToDimension(l,o-1):ce.sizeToDimension(t,o-1),h=s?ce.sizeFromDimension(l,o-1):ce.sizeFromDimension(t,o-1),f=M0(r,s?a:e,n,d,h);return s?Tu(r,f,u):f},M0=(r,e,n,t,i)=>{let o=bP(r,e[0],t,i,[t]),s=r.run(k(C({},O0),{cacheHint:n.cacheKey,get:()=>o}),e),l=wP(r,e[0],t,i,o.output.dims,[t]),c=r.run(k(C({},A0),{cacheHint:n.cacheKey,get:()=>l}),[e[0],s]),a=_P(r,e[0],t,i,o.output.dims,l.output.dims);return[r.run(k(C({},P0),{cacheHint:n.cacheKey,get:()=>a}),[e[0],s,c])]},bP=(r,e,n,t,i)=>{let[o,s]=r.calculateTextureWidthAndHeight(e.dims,0),l=i.length;if(n<1||t<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(i.length!==1)throw new Error("Dimensionality of the output should be 1");if(i[0]!==n)throw new Error("Shape of the output should be equal to logical row count");let c=Se(r.session.backend.glContext.version),a=`
      float process(int[${l}] indices) {
        int logical_row_start_offset = indices[0] * ${t};

        float max = getColorAsFloat(${c.texture2D}(A, offsetToCoords(logical_row_start_offset, ${o},
        ${s} )));
        for(int i=1; i<${t}; ++i)
        {
          float current = getColorAsFloat(${c.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${o}, ${s})));
          if(current > max)
          max = current;
        }

        return max;
      }`;return k(C({},O0),{output:{dims:i,type:e.type,textureType:0},shaderSource:a})},wP=(r,e,n,t,i,o)=>{let[s,l]=r.calculateTextureWidthAndHeight(e.dims,0),c=o.length;if(n<1||t<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(o.length!==1)throw new Error("Dimensionality of the output should be 1");if(o[0]!==n)throw new Error("Shape of the output should be equal to logical row count");if(i.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(i[0]!==n)throw new Error("Shape of the intermediate results should be equal to logical row count");let a=Se(r.session.backend.glContext.version),u=`
      float process(int[${c}] indices) {
        int logical_row_start_offset = indices[0] * ${t};

        float norm_factor = 0.0;
        float max = _Max(indices);
        for(int i=0; i<${t}; ++i)
        {
          norm_factor += exp(getColorAsFloat(${a.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${s}, ${l}))) - max);
        }

        return norm_factor;
      }`;return k(C({},A0),{output:{dims:o,type:e.type,textureType:0},shaderSource:u})},_P=(r,e,n,t,i,o)=>{let[s,l]=r.calculateTextureWidthAndHeight(e.dims,0),c=e.dims.length;if(n<1||t<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(i.length!==1||o.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(i[0]!==n||o[0]!==n)throw new Error("Shape of the intermediate results should be equal to logical row count");let a=`
      float process(int[${c}] indices) {

      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)
      int offset = coordsToOffset(TexCoords, ${s}, ${l});

      //determine the logical row for this index
      int logical_row_index[1];
      logical_row_index[0] = offset / ${t};

      float norm_factor = _Norm(logical_row_index);

      // avoid possible division by 0
      // if norm_facor is 0, all elements are zero
      // if so, return 0
      if(norm_factor == 0.0)
        return 0.0;

      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;
    }`;return k(C({},P0),{output:{dims:e.dims,type:e.type,textureType:0},shaderSource:a})},N0=r=>{if(!r||r.length!==1)throw new Error("Softmax requires 1 input.");if(r[0].type!=="float32"&&r[0].type!=="float64")throw new Error("Invalid input type")}}),R0,LN,BN,TP,xP,SP,aq=R(()=>{"use strict";zt(),Re(),Ce(),R0={name:"Split",inputNames:["A"],inputTypes:[0]},LN=(r,e,n)=>{SP(e);let t=ce.normalizeAxis(n.axis,e[0].dims.length),i=TP(r,e,t,n),o=[];for(let s=0;s<i;++s)o.push(r.run(k(C({},R0),{cacheHint:`${n.cacheKey};${s}`,get:()=>xP(r,e[0],n,t,s)}),e));return o},BN=r=>{let e=r.attributes.getInt("axis",0),n=r.attributes.getInts("split",[]),t=r.outputs.length;return We({axis:e,split:n,numOutputs:t})},TP=(r,e,n,t)=>{let[,i]=nw.splitShape(e[0].dims,n,t.split,t.numOutputs);return i.length},xP=(r,e,n,t,i)=>{let[o,s]=nw.splitShape(e.dims,t,n.split,n.numOutputs),l=s[i],c=o[i],a=`
      float process(int indices[${c.length}]) {
        indices[${t}] += ${l};
        return _A(indices);
      }
    `;return k(C({},R0),{cacheHint:`${n.cacheKey}:${i}`,output:{dims:c,type:e.type,textureType:0},shaderSource:a})},SP=r=>{if(!r||r.length!==1)throw new Error("Split requires one input.");if(r[0].type!=="int8"&&r[0].type!=="uint8"&&r[0].type!=="int16"&&r[0].type!=="uint16"&&r[0].type!=="int32"&&r[0].type!=="uint32"&&r[0].type!=="float32"&&r[0].type!=="float64"&&r[0].type!=="bool")throw new Error("Invalid input type.")}}),bw,jN,VN,EP,DP,lq=R(()=>{"use strict";Re(),bw=(r,e,n)=>{EP(e);let t=ce.squeezeShape(e[0].dims,n);return[r.reshapeUnpacked(e[0],t)]},jN=(r,e)=>(DP(e),bw(r,[e[0]],Array.from(e[1].integerData))),VN=r=>r.attributes.getInts("axes"),EP=r=>{if(!r||r.length!==1)throw new Error("Squeeze requires 1 input.");if(r[0].type==="string")throw new Error("invalid input tensor types.")},DP=r=>{if(!r||r.length!==2)throw new Error("Squeeze requires 2 inputs.");if(r[1].type!=="int32")throw new Error("Invalid input type.")}}),$N,CP,IP,cq=R(()=>{"use strict";it(),Ce(),$N=(r,e)=>{IP(e);let n={name:"Sum",inputNames:e.map((t,i)=>`X${i}`),inputTypes:new Array(e.length).fill(0)};return[r.run(k(C({},n),{get:()=>CP(r,e,n)}),e)]},CP=(r,e,n)=>{let t=Se(r.session.backend.glContext.version),i=e[0].dims.slice(),o=`
      void main() {
        vec4 result = ${e.map((s,l)=>`${t.texture2D}(X${l},TexCoords)`).join(" + ")};
        ${t.output} = result;
      }
    `;return k(C({},n),{output:{dims:i,type:e[0].type,textureType:0},hasMain:!0,shaderSource:o})},IP=r=>{if(!r||r.length===0)throw new Error("Sum requires inputs.");let e=r[0].dims.length;for(let n=1;n<r.length;n++){if(e!==r[n].dims.length)throw new Error("Input shapes are mismatched.");for(let t=0;t<e;t++)if(r[0].dims[t]!==r[n].dims[t])throw new Error("Input shapes are not matched.")}if(r[0].type!=="float32"&&r[0].type!=="float64")throw new Error("Invalid input type.");for(let n=1;n<r.length;n++)if(r[0].type!==r[n].type)throw new Error("Input types are not matched.")}}),UN,OP,AP,uq=R(()=>{"use strict";Lp(),Ce(),UN=(r,e)=>{AP(e);let n={name:"Tile",inputNames:["A"],inputTypes:[0]};return[r.run(k(C({},n),{get:()=>OP(r,e,n)}),e)]},OP=(r,e,n)=>{let t=e[0].dims.slice(),i=new Array(t.length),o=[];for(let c=0;c<t.length;c++)i[c]=t[c]*e[1].numberData[c],o.push(`inputIdx[${c}] = int(mod(float(outputIdx[${c}]), ${t[c]}.));`);let s=i.length,l=`
      float process(int outputIdx[${s}]) {
        int inputIdx[${s}];
        ${o.join(`
`)}
        return _A(inputIdx);
      }
    `;return k(C({},n),{output:{dims:i,type:e[0].type,textureType:0},shaderSource:l})},AP=r=>{if(!r||r.length!==2)throw new Error("Tile requires 2 input.");if(r[1].dims.length!==1)throw new Error("The second input shape must 1 dimension.");if(r[1].dims[0]!==r[0].dims.length)throw new Error("Invalid input shape.");if(Cu.indexOf(r[0].type)===-1)throw new Error("Invalid input type.");if(r[1].type!=="int32"&&r[1].type!=="int16")throw new Error("Invalid repeat type.")}}),ww,HN,zN,PP,MP,dq=R(()=>{"use strict";Re(),ww=(r,e,n)=>{PP(e);let t=ce.unsqueezeShape(e[0].dims,n);return[r.reshapeUnpacked(e[0],t)]},HN=(r,e)=>(MP(e),ww(r,[e[0]],Array.from(e[1].integerData))),zN=r=>r.attributes.getInts("axes"),PP=r=>{if(!r||r.length!==1)throw new Error("Unsqueeze requires 1 input.");if(r[0].type==="string")throw new Error("invalid input tensor types.")},MP=r=>{if(!r||r.length!==2)throw new Error("Unsqueeze requires 2 inputs.");if(r[1].type!=="int32")throw new Error("Invalid input type.")}}),GN,hq=R(()=>{"use strict";Q8(),fW(),pW(),mW(),Bw(),HW(),zW(),GW(),WW(),qW(),YW(),XW(),JW(),Fw(),QW(),eq(),tq(),nq(),rq(),iq(),oq(),sq(),aq(),lq(),cq(),uq(),jw(),A2(),dq(),DN(),GN=[["Abs","","6+",a2],["Acos","","7+",l2],["Add","","7+",$M],["And","","7+",UM],["Asin","","7+",c2],["Atan","","7+",u2],["AveragePool","","7+",cN,uN],["BatchNormalization","","7+",LM,BM],["Cast","","6+",QM,e2],["Ceil","","6+",f2],["Clip","","6-10",cw,d2],["Clip","","11+",h2],["Concat","","4+",n2,r2],["Conv","","1+",hw,fw],["ConvTranspose","","1+",H2,z2],["Cos","","7+",p2],["Div","","7+",HM],["Dropout","","7+",uw],["DepthToSpace","","1+",W2,q2],["Equal","","7+",zM],["Elu","","6+",g2,m2],["Exp","","6+",y2],["Flatten","","1+",Y2,X2],["Floor","","6+",v2],["FusedConv","com.microsoft","1+",hw,fw],["Gather","","1+",K2,Z2],["Gemm","","7-10",pw,J2],["Gemm","","11+",pw,Q2],["GlobalAveragePool","","1+",dN,hN],["GlobalMaxPool","","1+",gN],["Greater","","7+",GM],["Identity","","1+",uw],["ImageScaler","","1+",eN,tN],["InstanceNormalization","","6+",nN,rN],["LeakyRelu","","6+",b2,w2],["Less","","7+",WM],["LRN","","1+",iN,oN],["Log","","6+",_2],["MatMul","","1+",k2,F2],["MaxPool","","1+",fN,pN],["Mul","","7+",qM],["Neg","","6+",T2],["Not","","1+",x2],["Or","","7+",YM],["Pad","","2-10",gw,sN],["Pad","","11+",aN,lN],["Pow","","7+",XM],["PRelu","","7+",KM],["ReduceLogSum","","1+",_N,fo],["ReduceMax","","1+",vN,fo],["ReduceMean","","1+",yN,fo],["ReduceMin","","1+",bN,fo],["ReduceProd","","1+",wN,fo],["ReduceSum","","1-12",mN,fo],["ReduceSumSquare","","1+",TN,fo],["Relu","","6+",S2],["Reshape","","5+",xN],["Resize","","10",vw,CN],["Resize","","11+",vw,IN],["Shape","","1+",ON],["Sigmoid","","6+",E2],["Sin","","7+",D2],["Slice","","10+",MN],["Slice","","1-9",AN,PN],["Softmax","","1-12",NN,RN],["Softmax","","13+",FN,kN],["Split","","2-12",LN,BN],["Sqrt","","6+",C2],["Squeeze","","1-12",bw,VN],["Squeeze","","13+",jN],["Sub","","7+",ZM],["Sum","","6+",$N],["Tan","","7+",I2],["Tanh","","6+",O2],["Tile","","6+",UN],["Transpose","","1+",Tu,G2],["Upsample","","7-8",mw,SN],["Upsample","","9",mw,EN],["Unsqueeze","","1-12",ww,zN],["Unsqueeze","","13+",HN],["Xor","","7+",JM]]});function fq(r){let e={},n;for(;(n=_w.exec(r))!==null;){let t=n[3].split(",").map(i=>{let o=i.trim().split(" ");return o&&o.length===2?{type:o[0],name:o[1]}:null}).filter(i=>i!==null);e[n[2]]={params:t,body:n[4]}}for(let t in e){let i=WN.replace("__FUNC__",t),o=new RegExp(i,"gm");for(;(n=o.exec(r))!==null;){let s=n[1],l=n[2],c=n[3].split(","),a=s?`${s} ${l};`:"",u=e[t].body,d="";e[t].params.forEach((f,p)=>{f&&(d+=`${f.type} ${f.name} = ${c[p]};
`)}),u=`${d}
 ${u}`,u=u.replace("return",`${l} = `);let h=`
      ${a}
      {
        ${u}
      }
      `;r=r.replace(n[0],h)}}return r=r.replace(_w,""),r}var _w,WN,pq=R(()=>{"use strict";_w=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm,WN="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;"});function uu(r,e){let n=[],t=[],i=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||i?null:gq(e,r).sort(),s=0;for(let l=0;l<r.length;++l){if(o!=null){if(o[s]===l&&r[l]!==1)throw new Error(`Can't squeeze axis ${l} since its dim '${r[l]}' is not 1`);(o[s]==null||o[s]>l)&&r[l]===1&&(n.push(r[l]),t.push(l)),o[s]<=l&&s++}r[l]!==1&&(n.push(r[l]),t.push(l))}return{newShape:n,keptDims:t}}function gq(r,e){let n=e.length;return r=r==null?e.map((t,i)=>i):[].concat(r),Cp(r.every(t=>t>=-n&&t<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${r}`),Cp(r.every(mq),()=>`All values in axis param must be integers but got axis ${r}`),r.map(t=>t<0?n+t:t)}function mq(r){return r%1===0}function yq(r){if(r.length===0)return 1;let e=r[0];for(let n=1;n<r.length;n++)e*=r[n];return e}function NP(r){let e=Math.ceil(Math.sqrt(r));return[e,Math.ceil(r/e)]}var qN,YN=R(()=>{"use strict";Er(),Re(),qN=class{constructor(r){this.maxTextureSize=r}computeTextureWH(r,e){let n=this.computeTexture(r,e);return e&&e.isPacked&&(n[0]/=2,n[1]/=2),e&&e.reverseWH?[n[1],n[0]]:n}computeTexture(r,e){let n=e&&e.isPacked;if(r.length===0)return n?[2,2]:[1,1];let t=this.maxTextureSize;if(e&&e.breakAxis!==void 0){let s=e.breakAxis>=r.length?1:r.slice(e.breakAxis).reduce((c,a)=>c*a),l=e.breakAxis<=0?1:r.slice(0,e.breakAxis).reduce((c,a)=>c*a);if(s>t||l>t)ht.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${r}, breakAxis:${e.breakAxis}`);else return[s,l]}let i=r.slice(0);n&&(t=t*2,i=i.map((s,l)=>l>=i.length-2?i[l]%2===0?i[l]:i[l]+1:i[l]),i.length===1&&(i=[2,i[0]])),i.length!==2&&(i=uu(i).newShape);let o=yq(i);return i.length<=1&&o<=t?[1,o]:i.length===2&&i[0]<=t&&i[1]<=t?i:i.length===3&&i[0]*i[1]<=t&&i[2]<=t?[i[0]*i[1],i[2]]:i.length===3&&i[0]<=t&&i[1]*i[2]<=t?[i[0],i[1]*i[2]]:i.length===4&&i[0]*i[1]*i[2]<=t&&i[3]<=t?[i[0]*i[1]*i[2],i[3]]:i.length===4&&i[0]<=t&&i[1]*i[2]*i[3]<=t?[i[0],i[1]*i[2]*i[3]]:n?NP(o/4).map(s=>s*2):NP(o)}}}),XN,vq=R(()=>{"use strict";Re(),mo(),it(),YN(),Ti(),XN=class extends Tl{constructor(r){super(r)}getFunctions(){return C(C(C(C(C(C(C({},this.offsetToCoords()),this.coordsToOffset()),this.toVec()),this.valueFrom()),this.getCommonUtilFuncs()),this.getInputsSamplingSnippets()),this.getOutputSamplingSnippet())}getCustomTypes(){return{}}offsetToCoords(){let r="offsetToCoords";return{offsetToCoords:new z(`
      vec2 ${r}(int offset, int width, int height) {
        int t = offset / width;
        int s = offset - t*width;
        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);
        return coords;
      }
      `)}}coordsToOffset(){let r="coordsToOffset";return{coordsToOffset:new z(`
      int ${r}(vec2 coords, int width, int height) {
        float s = coords.s * float(width);
        float t = coords.t * float(height);
        int offset = int(t) * width + int(s);
        return offset;
      }
      `)}}getOutputSamplingSnippet(){let r=this.context.outputTextureLayout;return r.isPacked?this.getPackedOutputSamplingSnippet(r):this.getUnpackedOutputSamplingSnippet(r)}getPackedOutputSamplingSnippet(r){let e=r.unpackedShape,n=[r.width,r.height],t={},i="getOutputCoords";switch(e.length){case 0:t[i]=this.getOutputScalarCoords();break;case 1:t[i]=this.getOutputPacked1DCoords(e,n);break;case 2:t[i]=this.getOutputPacked2DCoords(e,n);break;case 3:t[i]=this.getOutputPacked3DCoords(e,n);break;default:t[i]=this.getOutputPackedNDCoords(e,n)}let o=`
      void setOutput(vec4 val) {
        ${Se(this.context.glContext.version).output} = val;
      }
    `,s="floatTextureSetRGBA";return t[s]=new z(o),t}getUnpackedOutputSamplingSnippet(r){let e=r.unpackedShape,n=[r.width,r.height],t={},i="getOutputCoords";switch(e.length){case 0:t[i]=this.getOutputScalarCoords();break;case 1:t[i]=this.getOutputUnpacked1DCoords(e,n);break;case 2:t[i]=this.getOutputUnpacked2DCoords(e,n);break;case 3:t[i]=this.getOutputUnpacked3DCoords(e,n);break;case 4:t[i]=this.getOutputUnpacked4DCoords(e,n);break;case 5:t[i]=this.getOutputUnpacked5DCoords(e,n);break;case 6:t[i]=this.getOutputUnpacked6DCoords(e,n);break;default:throw new Error(`Unsupported output dimensionality: ${e.length}`)}let o=`
        void setOutput(float val) {
          ${Se(this.context.glContext.version).output} = vec4(val, 0, 0, 0);
        }
    `,s="floatTextureSetR";return t[s]=new z(o),t}getOutputScalarCoords(){return new z(`
      int getOutputCoords() {
        return 0;
      }
    `)}getOutputPacked1DCoords(r,e){let n=e,t="";return n[0]===1?(t=`
          int getOutputCoords() {
            return 2 * int(TexCoords.y * ${n[1]}.0);
          }
        `,new z(t)):n[1]===1?(t=`
          int getOutputCoords() {
            return 2 * int(TexCoords.x * ${n[0]}.0);
          }
        `,new z(t)):(t=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                 vec2(${n[0]}, ${n[1]}));
          return 2 * (resTexRC.y * ${n[0]} + resTexRC.x);
        }
      `,new z(t))}getOutputPacked2DCoords(r,e){let n="";if(au.arraysEqual(r,e))return n=`
        ivec2 getOutputCoords() {
          return 2 * ivec2(TexCoords.xy * vec2(${e[0]}, ${e[1]}));
        }
      `,new z(n);let t=e,i=Math.ceil(r[1]/2);return n=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${t[0]}, ${t[1]}));

          int index = resTexRC.y * ${t[0]} + resTexRC.x;

          // reverse r and c order for packed texture
          int r = imod(index, ${i}) * 2;
          int c = 2 * (index / ${i});

          return ivec2(r, c);
        }
      `,new z(n)}getOutputPacked3DCoords(r,e){let n=[e[0],e[1]],t=Math.ceil(r[2]/2),i=t*Math.ceil(r[1]/2),o=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${n[0]}, ${n[1]}));
          int index = resTexRC.y * ${n[0]} + resTexRC.x;

          int b = index / ${i};
          index -= b * ${i};

          // reverse r and c order for packed texture
          int r = imod(index, ${t}) * 2;
          int c = 2 * (index / ${t});

          return ivec3(b, r, c);
        }
      `;return new z(o)}getOutputPackedNDCoords(r,e){let n=[e[0],e[1]],t=Math.ceil(r[r.length-1]/2),i=t*Math.ceil(r[r.length-2]/2),o=i,s="",l="b, r, c";for(let a=2;a<r.length-1;a++)o*=r[r.length-a-1],s=`
      int b${a} = index / ${o};
      index -= b${a} * ${o};
    `+s,l=`b${a}, `+l;let c=`
      ivec${r.length} getOutputCoords() {
        ivec2 resTexRC = ivec2(TexCoords.xy *
                              vec2(${n[0]}, ${n[1]}));
        int index = resTexRC.y * ${n[0]} + resTexRC.x;

        ${s}

        int b = index / ${i};
        index -= b * ${i};

        // reverse r and c order for packed texture
        int r = imod(index, ${t}) * 2;
        int c = 2 * (index / ${t});

        return ivec${r.length}(${l});
      }
    `;return new z(c)}getOutputUnpacked1DCoords(r,e){let n=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${e[0]}, ${e[1]}));
          return resTexRC.y * ${e[0]} + resTexRC.x;
        }
      `;return new z(n)}getOutputUnpacked2DCoords(r,e){let n=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${e[0]}, ${e[1]}));
          int index = resTexRC.y * ${e[0]} + resTexRC.x;
          int r = index / ${r[1]};
          int c = index - r * ${r[1]};
          return ivec2(r, c);
        }
      `;return new z(n)}getOutputUnpacked3DCoords(r,e){let n="",t=r.length,i=null;t<2&&(i=[]),i=new Array(t-1),i[t-2]=r[t-1];for(let l=t-3;l>=0;--l)i[l]=i[l+1]*r[l+1];let o=["r","c","d"],s=i.map((l,c)=>{let a=`int ${o[c]} = index / ${l}`,u=c===i.length-1?`int ${o[c+1]} = index - ${o[c]} * ${l}`:`index -= ${o[c]} * ${l}`;return`${a}; ${u};`}).join("");return n=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${e[0]}, ${e[1]}));
          int index = resTexRC.y * ${e[0]} + resTexRC.x;
          ${s}
          return ivec3(r, c, d);
        }
      `,new z(n)}getOutputUnpacked4DCoords(r,e){let n="",t=r.length,i=null;t<2&&(i=[]),i=new Array(t-1),i[t-2]=r[t-1];for(let l=t-3;l>=0;--l)i[l]=i[l+1]*r[l+1];let o=["r","c","d","d2"],s=i.map((l,c)=>{let a=`int ${o[c]} = index / ${l}`,u=c===i.length-1?`int ${o[c+1]} = index - ${o[c]} * ${l}`:`index -= ${o[c]} * ${l}`;return`${a}; ${u};`}).join("");return n=`
      ivec4 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${e[0]}, ${e[1]}));
          int index = resTexRC.y * ${e[0]} + resTexRC.x;
          ${s}
          return ivec4(r, c, d, d2);
        }
      `,new z(n)}getOutputUnpacked5DCoords(r,e){let n="",t=r.length,i=null;t<2&&(i=[]),i=new Array(t-1),i[t-2]=r[t-1];for(let l=t-3;l>=0;--l)i[l]=i[l+1]*r[l+1];let o=["r","c","d","d2","d3"],s=i.map((l,c)=>{let a=`int ${o[c]} = index / ${l}`,u=c===i.length-1?`int ${o[c+1]} = index - ${o[c]} * ${l}`:`index -= ${o[c]} * ${l}`;return`${a}; ${u};`}).join("");return n=`
      ivec5 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${e[0]}, ${e[1]}));
          int index = resTexRC.y * ${e[0]} + resTexRC.x;
          ${s}
          return ivec5(r, c, d, d2, d3);
        }
      `,new z(n)}getOutputUnpacked6DCoords(r,e){let n="",t=r.length,i=null;t<2&&(i=[]),i=new Array(t-1),i[t-2]=r[t-1];for(let l=t-3;l>=0;--l)i[l]=i[l+1]*r[l+1];let o=["r","c","d","d2","d3","d4"],s=i.map((l,c)=>{let a=`int ${o[c]} = index / ${l}`,u=c===i.length-1?`int ${o[c+1]} = index - ${o[c]} * ${l}`:`index -= ${o[c]} * ${l}`;return`${a}; ${u};`}).join("");return n=`
     ivec6 getOutputCoords() {
         ivec2 resTexRC = ivec2(TexCoords.xy *
                               vec2(${e[0]}, ${e[1]}));
         int index = resTexRC.y * ${e[0]} + resTexRC.x;
         ${s}
         return ivec6(r, c, d, d2, d3, d4);
       }
     `,new z(n)}getCommonUtilFuncs(){let r={},e="uvFromFlat";r[e]=new z(`
    vec2 uvFromFlat(int texNumR, int texNumC, int index) {
      int texC = index / texNumR;
      int texR = index - texC * texNumR;
      // TODO: swap texR, texC order in following function so row is corresponding to u and column is corresponding to
      //       v.
      return (vec2(texR, texC) + halfCR) / vec2(texNumR, texNumC);
    }
    `),e="packedUVfrom1D",r[e]=new z(`
      vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
        int texelIndex = index / 2;
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),e="packedUVfrom2D",r[e]=new z(`
      vec2 packedUVfrom2D(int texNumR, int texNumC, int texelsInLogicalRow, int row, int col) {
        int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),e="packedUVfrom3D",r[e]=new z(`
      vec2 packedUVfrom3D(int texNumR, int texNumC,
          int texelsInBatch, int texelsInLogicalRow, int b,
          int row, int col) {
        int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = index / texNumC;
        int texC = index - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),e="sampleTexture";let n=Se(this.context.glContext.version);return r[e]=new z(`
        float sampleTexture(sampler2D textureSampler, vec2 uv) {
            return ${n.texture2D}(textureSampler, uv).r;
        }`),r}getInputsSamplingSnippets(){let r={},e=this.context.outputTextureLayout;return this.context.programInfo.inputNames.forEach((n,t)=>{let i=this.context.inputTextureLayouts[t],o=f0(n);i.isPacked?r[o]=this.getPackedSamplerFromInput(o,n,i):r[o]=this.getUnpackedSamplerFromInput(o,n,i);let s=B8(n);i.unpackedShape.length<=e.unpackedShape.length&&(i.isPacked?r[s]=this.getPackedSamplerAtOutputCoords(s,i,e,n):r[s]=this.getUnpackedSamplerAtOutputCoords(s,i,e,n))}),r}getPackedSamplerAtOutputCoords(r,e,n,t){let i=e.unpackedShape,o=n.unpackedShape,s=f0(t),l=i.length,c=o.length,a=Ur.getBroadcastDims(i,o),u=go(c),d=c-l,h,f=bl();l===0?h="":c<2&&a.length>=1?h="coords = 0;":h=a.map(A=>`coords.${f[A+d]} = 0;`).join(`
`);let p="";c<2&&l>0?p="coords":p=i.map((A,L)=>`coords.${f[L+d]}`).join(", ");let g="return outputValue;",y=ce.size(i)===1,w=ce.size(o)===1;if(l===1&&!y&&!w)g=`
        return vec4(outputValue.xy, outputValue.xy);
      `;else if(y&&!w)c===1?g=`
          return vec4(outputValue.x, outputValue.x, 0., 0.);
        `:g=`
          return vec4(outputValue.x);
        `;else if(a.length){let A=l-2,L=l-1;a.indexOf(A)>-1&&a.indexOf(L)>-1?g="return vec4(outputValue.x);":a.indexOf(A)>-1?g="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(L)>-1&&(g="return vec4(outputValue.xx, outputValue.zz);")}let v=`
        int lastDim = coords.${f[c-1]};
        coords.${f[c-1]} = coords.${f[c-2]};
        coords.${f[c-2]} = lastDim;
      `,x=`
      vec4 ${r}() {
        ${u} coords = getOutputCoords();
        ${v}
        ${h}
        vec4 outputValue = ${s}(${p});
        ${g}
      }
    `;return new z(x,["coordinates.getOutputCoords"])}getUnpackedSamplerAtOutputCoords(r,e,n,t){let i=[n.width,n.height],o=[e.width,e.height],s=e.unpackedShape.length,l=n.unpackedShape.length,c=e.unpackedShape,a=n.unpackedShape,u=f0(t);if(s===l&&au.arraysEqual(o,i)){let v=`
          float ${r}() {
            return sampleTexture(${t}, TexCoords);
          }
        `;return new z(v,["coordinates.sampleTexture"])}let d=go(l),h=Ur.getBroadcastDims(c,a),f=l-s,p,g=bl();s===0?p="":l<2&&h.length>=1?p="coords = 0;":p=h.map(v=>`coords.${g[v+f]} = 0;`).join(`
`);let y="";l<2&&s>0?y="coords":y=e.unpackedShape.map((v,x)=>`coords.${g[x+f]}`).join(", ");let w=`
        float ${r}() {
          ${d} coords = getOutputCoords();
          ${p}
          return ${u}(${y});
        }
      `;return new z(w,["coordinates.getOutputCoords"])}getPackedSamplerFromInput(r,e,n){switch(n.unpackedShape.length){case 0:return this.getPackedSamplerScalar(r,e);case 1:return this.getPackedSampler1D(r,e,n);case 2:return this.getPackedSampler2D(r,e,n);case 3:return this.getPackedSampler3D(r,e,n);default:return this.getPackedSamplerND(r,e,n)}}getUnpackedSamplerFromInput(r,e,n){let t=n.unpackedShape;switch(t.length){case 0:return this.getUnpackedSamplerScalar(r,e,n);case 1:return this.getUnpackedSampler1D(r,e,n);case 2:return this.getUnpackedSampler2D(r,e,n);case 3:return this.getUnpackedSampler3D(r,e,n);case 4:return this.getUnpackedSampler4D(r,e,n);case 5:return this.getUnpackedSampler5D(r,e,n);case 6:return this.getUnpackedSampler6D(r,e,n);default:throw new Error(`Unsupported dimension ${t.length}-D`)}}getPackedSamplerScalar(r,e){let n=Se(this.context.glContext.version),t=`
          vec4 ${r}() {
            return ${n.texture2D}(${e}, halfCR);
          }
        `;return new z(t)}getPackedSampler1D(r,e,n){let t=[n.width,n.height],i=[t[1],t[0]],o=Se(this.context.glContext.version),s=`vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
      ${i[0]}, ${i[1]}, index);
      return ${o.texture2D}(${e}, uv);
    }`;return new z(s,["coordinates.packedUVfrom1D"])}getPackedSampler2D(r,e,n){let t=n.unpackedShape,i=[n.width,n.height],o=Se(this.context.glContext.version),s=i[0],l=i[1];if(i!=null&&au.arraysEqual(t,i)){let d=`vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${l}.0, ${s}.0);
        return ${o.texture2D}(${e}, uv);
      }`;return new z(d)}let c=i,a=Math.ceil(t[1]/2),u=`vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c[1]}, ${c[0]}, ${a}, row, col);
      return ${o.texture2D}(${e}, uv);
    }`;return new z(u,["coordinates.packedUVfrom2D"])}getPackedSampler3D(r,e,n){let t=n.unpackedShape,i=[n.width,n.height],o=[i[0],i[1]],s=Se(this.context.glContext.version);if(t[0]===1){let h=t.slice(1),f=[1,2],p=Zc(t,h),g=["b","row","col"],y=JSON.parse(JSON.stringify(n));y.unpackedShape=p;let w=this.getPackedSamplerFromInput(r,e,y),v=`${w.routineBody}
      vec4 ${r}(int b, int row, int col) {
        return ${r}(${Jc(g,f)});
      } `;return new z(v,w.dependencies)}let l=o[0],c=o[1],a=Math.ceil(t[2]/2),u=a*Math.ceil(t[1]/2),d=`vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${c}, ${l}, ${u}, ${a}, b, row, col);
      return ${s.texture2D}(${e}, uv);}`;return new z(d,["coordinates.packedUVfrom3D"])}getPackedSamplerND(r,e,n){let t=n.unpackedShape,i=t.length,o=[n.width,n.height],s=Se(this.context.glContext.version),l=[o[0],o[1]],c=l[1],a=l[0],u=Math.ceil(t[i-1]/2),d=u*Math.ceil(t[i-2]/2),h="int b, int row, int col",f=`b * ${d} + (row / 2) * ${u} + (col / 2)`;for(let g=2;g<i-1;g++)h=`int b${g}, `+h,d*=t[i-g-1],f=`b${g} * ${d} + `+f;let p=`vec4 ${r}(${h}) {
      int index = ${f};
      int texR = index / ${a};
      int texC = index - texR * ${a};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${a}, ${c});
      return ${s.texture2D}(${e}, uv);
    }`;return new z(p)}getUnpackedSamplerScalar(r,e,n){let[t,i]=[n.width,n.height];if(t===1&&i===1){let s=`
          float ${r}() {
            return sampleTexture(${e}, halfCR);
          }
        `;return new z(s,["coordinates.sampleTexture"])}let o=`
        float ${r}() {
          int offset_${e} = coordsToOffset(TexCoords, ${t}, ${i});
          vec2 uv = uvFromFlat(${t}, ${i}, offset_${e});
          return sampleTexture(${e}, uv);
        }
      `;return new z(o,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler1D(r,e,n){let t=n.width,i=n.height;if(i===1&&t===1){let s=`
        float ${r}(int index) {
          return sampleTexture(${e}, halfCR);
        }
      `;return new z(s,["coordinates.sampleTexture"])}if(i===1){let s=`
          float ${r}(int index) {
            vec2 uv = vec2((float(index) + 0.5) / ${t}.0, 0.5);
            return sampleTexture(${e}, uv);
          }
        `;return new z(s,["coordinates.sampleTexture"])}if(t===1){let s=`
          float ${r}(int index) {
            vec2 uv = vec2(0.5, (float(index) + 0.5) / ${i}.0);
            return sampleTexture(${e}, uv);
          }
        `;return new z(s,["coordinates.sampleTexture"])}let o=`
        float ${r}(int index) {
          vec2 uv = uvFromFlat(${t}, ${i}, index);
          return sampleTexture(${e}, uv);
        }
      `;return new z(o,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler2D(r,e,n){let t=n.unpackedShape,i=[n.height,n.width];if(i!=null&&au.arraysEqual(t,i)){let d=i[1],h=i[0],f=`
          float ${r}(int row, int col) {
            vec2 uv = (vec2(row, col) + halfCR) / vec2(${d}.0, ${h}.0);
            return sampleTexture(${e}, uv);
          }
        `;return new z(f,["coordinates.sampleTexture"])}let{newShape:o,keptDims:s}=uu(t),l=o;if(l.length<t.length){let d=Zc(t,l),h=JSON.parse(JSON.stringify(n));h.unpackedShape=d;let f=["col","row"],p=`
          ${this.getUnpackedSamplerFromInput(r,e,h).routineBody}
          float ${r}(int row, int col) {
            return ${r}(${Jc(f,s)});
          }
        `;return new z(p,["coordinates.sampleTexture"])}let c=i[1],a=i[0];if(a===1){let d=`
          float ${r}(int row, int col) {
            int offset_${e} = coordsToOffset(TexCoords, ${c}, ${a});
            float index = dot(vec3(row, col, offset_${e}), vec3(${t[1]}, 1, 1));
            vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
            return sampleTexture(${e}, uv);
          }
        `;return new z(d,["coordinates.sampleTexture","coordinates.coordsToOffset"])}if(c===1){let d=`
          float ${r}(int row, int col) {
            int offset_${e} = coordsToOffset(TexCoords, ${c}, ${a});
            float index = dot(vec3(row, col, offset_${e}), vec3(${t[1]}, 1, 1));
            vec2 uv = vec2((index + 0.5) / ${a}.0, 0.5);
            return sampleTexture(${e}, uv);
          }
        `;return new z(d,["coordinates.sampleTexture","coordinates.coordsToOffset"])}let u=`
        float ${r}(int row, int col) {
          int index = col * ${t[1]} + row;
          vec2 uv = uvFromFlat(${c}, ${a}, index);
          return sampleTexture(${e}, uv);
        }
      `;return new z(u,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler3D(r,e,n){let t=n.unpackedShape,i=t[1]*t[2],o=t[2],{newShape:s,keptDims:l}=uu(t),c=s;if(c.length<t.length){let h=Zc(t,c),f=["batch","col","row"],p=JSON.parse(JSON.stringify(n));p.unpackedShape=h;let g=this.getUnpackedSamplerFromInput(r,e,p),y=l.reverse(),w=`
          ${g.routineBody}
          float ${r}(int batch, int row, int col) {
            return ${r}(${Jc(f,y)});
          }
        `;return new z(w,g.dependencies)}let a=n.width,u=n.height,d=`
          float ${r}(int depth, int row, int col) {
            // Explicitly use integer operations as dot() only works on floats.
            int index = depth * ${i} + col * ${o} + row;
            vec2 uv = uvFromFlat(${a}, ${u}, index);
            return sampleTexture(${e}, uv);
          }
      `;return new z(d,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler4D(r,e,n){let t=n.unpackedShape,i=t[3],o=t[2]*i,s=t[1]*o,l=n.width,c=n.height,a=`
        float ${r}(int row, int col, int depth, int depth2) {
          int index = row * ${s} + col * ${o} +
              depth2 * ${i} + depth;
          vec2 uv = uvFromFlat(${l}, ${c}, index);
          return sampleTexture(${e}, uv);
        }
      `;return new z(a,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler5D(r,e,n){let t=n.unpackedShape,i=t[4],o=t[3]*i,s=t[2]*o,l=t[1]*s,{newShape:c,keptDims:a}=uu(t);if(c.length<t.length){let f=Zc(t,c),p=["row","col","depth","depth2","depth3"],g=JSON.parse(JSON.stringify(n));g.unpackedShape=f;let y=`
          ${this.getUnpackedSamplerFromInput(r,e,g).routineBody}
          float ${r}(int row, int col, int depth, int depth2, int depth3) {
            return ${r}(${Jc(p,a)});
          }
        `;return new z(y,["coordinates.sampleTexture","coordinates.uvFromFlat"])}let u=n.width,d=n.height,h=`
        float ${r}(int row, int col, int depth, int depth2, int depth3) {
          int index = row * ${l} + col * ${s} + depth * ${o} +
          depth3 * ${i} + depth2;
          vec2 uv = uvFromFlat(${u}, ${d}, index);
          return sampleTexture(${e}, uv);
        }
      `;return new z(h,["coordinates.sampleTexture","coordinates.uvFromFlat"])}getUnpackedSampler6D(r,e,n){let t=n.unpackedShape,i=t[5],o=t[4]*i,s=t[3]*o,l=t[2]*s,c=t[1]*l,{newShape:a,keptDims:u}=uu(t);if(a.length<t.length){let p=Zc(t,a),g=["row","col","depth","depth2","depth3","depth4"],y=JSON.parse(JSON.stringify(n));y.unpackedShape=p;let w=`
            ${this.getUnpackedSamplerFromInput(r,e,y).routineBody}
            float ${r}(int row, int col, int depth,
              int depth2, int depth3, int depth4) {
              return ${r}(${Jc(g,u)});
            }
          `;return new z(w,["coordinates.sampleTexture","coordinates.uvFromFlat"])}let d=n.width,h=n.height,f=`
          float ${r}(int row, int col, int depth,
            int depth2, int depth3, int depth4) {
            int index = row * ${c} + col * ${l} + depth * ${s} +
            depth2 * ${o} + depth3 * ${i} + depth4;
            vec2 uv = uvFromFlat(${d}, ${h}, index);
            return sampleTexture(${e}, uv);
          }
        `;return new z(f,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}toVec(){let r=this.context.outputTextureLayout,e=r.shape.length,n=r.strides,t=r.width,i=r.height,o=[];for(let l=0;l<e-1;++l)o.push(`
        c[${l}] = offset / ${n[l]};`),o.push(`
        offset -= c[${l}] * ${n[l]};`);o.push(`
        c[${e-1}] = offset;`);let s=`
      void toVec(vec2 texCoords, out int c[${e}]) {
        int offset = coordsToOffset(texCoords, ${t}, ${i});
        ${o.join("")}
      }
      void toVec(int offset, out int c[${e}]) {
        ${o.join("")}
      }
    `;return{toVec:new z(s,["coordinates.coordsToOffset"])}}valueFrom(){let r={};return this.context.programInfo.inputNames.forEach((e,n)=>{let t=this.context.inputTextureLayouts[n],i=(t.unpackedShape.length>0?t.unpackedShape:t.shape).length,o=`_${e}`;r[o]=new z(this.getValueFromSingle(e,i,t.width,t.height,!1),[`shapeUtils.indicesToOffset${o}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),o=o+"_T",r[o]=new z(this.getValueFromSingle(e,i,t.width,t.height,!0),[`shapeUtils.indicesToOffset${o}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"])}),r}getValueFromSingle(r,e,n,t,i){let o=`_${r}`;i&&(o=o+"_T");let s=Se(this.context.glContext.version);return`
        float ${o}(int m[${e}]) {
          int offset = indicesToOffset${o}(m);
          vec2 coords = offsetToCoords(offset, ${n}, ${t});
          float value = getColorAsFloat(${s.texture2D}(${r}, coords));
          return value;
        }
        `}getPackedValueFrom(r,e,n,t,i){let o=`_${r}_Pack`;i&&(o=o+"_T");let s=Se(this.context.glContext.version);return`
        vec4 ${o}(int m[${e}]) {
          int offset = indicesToOffset_${r}(m);
          vec2 coords = offsetToCoords(offset, ${n}, ${t});
          return ${s.texture2D}(${r}, coords);
        }
        `}}}),KN,bq=R(()=>{"use strict";mo(),KN=class Tw extends Tl{constructor(e){super(e)}getFunctions(){return C(C({},this.encodeFloat32()),this.decodeFloat32())}getCustomTypes(){return{}}encodeFloat32(){return{encode:new z(`highp vec4 encode(highp float f) {
        return vec4(f, 0.0, 0.0, 0.0);
      }
        `)}}decodeFloat32(){return{decode:new z(`highp float decode(highp vec4 rgba) {
        return rgba.r;
      }
        `)}}encodeUint8(){let e=Tw.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new z(`
      highp vec4 encode(highp float f) {
        highp float F = abs(f);
        highp float Sign = step(0.0,-f);
        highp float Exponent = floor(log2(F));
        highp float Mantissa = (exp2(- Exponent) * F);
        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));
        highp vec4 rgba;
        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));
        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);
        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));
        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));
        ${e}
        rgba = rgba / 255.0; // values need to be normalized to [0,1]
        return rgba;
    }
        `)}}decodeUint8(){let e=Tw.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new z(`
        highp float decode(highp vec4 rgba) {
          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]
          ${e}
          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;
          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;
          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);
          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));
          return Result;
      }
        `)}}static isLittleEndian(){let e=new ArrayBuffer(4),n=new Uint32Array(e),t=new Uint8Array(e);if(n[0]=3735928559,t[0]===239)return!0;if(t[0]===222)return!1;throw new Error("unknown endianness")}}}),ZN,wq=R(()=>{"use strict";mo(),it(),ZN=class extends Tl{constructor(r){super(r)}getFunctions(){return C(C({},this.setFragColor()),this.getColorAsFloat())}getCustomTypes(){return{}}setFragColor(){let r=Se(this.context.glContext.version);return{setFragColor:new z(`
        void setFragColor(float value) {
            ${r.output} = encode(value);
        }
        `,["encoding.encode"])}}getColorAsFloat(){return{getColorAsFloat:new z(`
        float getColorAsFloat(vec4 color) {
            return decode(color);
        }
        `,["encoding.decode"])}}}}),JN,_q=R(()=>{"use strict";mo(),JN=class du extends Tl{constructor(e){super(e)}getFunctions(){return C(C(C(C(C({},this.bcastIndex()),this.bcastMatmulIndex()),this.offsetToIndices()),this.indicesToOffset()),this.incrementIndices())}getCustomTypes(){return{}}bcastIndex(){let e=this.context.outputTextureLayout.shape.length,n={};return this.context.programInfo.inputNames.forEach((t,i)=>{let o=this.context.inputTextureLayouts[i].unpackedShape;if(o.length<=e){let s=o.length,l=e-s,c=`bcastIndices_${t}`,a="";for(let d=0;d<s;++d)a+=`
          realIndices[${d}] = int( mod(float(bcastedIndices[${l+d}]), ${o[d]}.0) );
          `;let u=`
        void ${c} (int bcastedIndices[${e}], out int realIndices[${s}]) {
          ${a}
        }
        `;n[c]=new z(u)}}),n}bcastMatmulIndex(){let e=this.context.outputTextureLayout.shape.length,n={};return this.context.programInfo.inputNames.forEach((t,i)=>{let o=this.context.inputTextureLayouts[i].shape;if(!(o.length<2||o.length>e)){let s=o.length,l=e-s,c=`bcastMatmulIndices_${t}`,a="";for(let d=0;d<s-2;++d)a+=`
          realIndices[${d}] = int( mod(float(bcastedIndices[${l+d}]), ${o[d]}.0) );
          `;let u=`
        void ${c}(int bcastedIndices[${e}], out int realIndices[${s}]) {
          ${a}
          realIndices[${s-1}] = bcastedIndices[${e-1}];
          realIndices[${s-2}] = bcastedIndices[${e-2}];
        }
        `;n[c]=new z(u)}}),n}indicesToOffset(){let e={};return this.context.programInfo.inputNames.forEach((n,t)=>{let i=this.context.inputTextureLayouts[t].shape,o=this.context.inputTextureLayouts[t].strides,s=i.length,l=`indicesToOffset_${n}`;e[l]=new z(du.indexToOffsetSingle(l,s,o)),l=`indicesToOffset_${n}_T`,e[l]=new z(du.indexToOffsetSingle(l,s,o.slice().reverse()))}),e}static indexToOffsetSingle(e,n,t){let i="";for(let o=n-1;o>=0;--o)i+=`
        offset += indices[${o}] * ${t[o]};
        `;return`
      int ${e}(int indices[${n}]) {
        int offset = 0;
        ${i}
        return offset;
      }
      `}offsetToIndices(){let e={};return this.context.programInfo.inputNames.forEach((n,t)=>{let i=this.context.inputTextureLayouts[t].shape,o=this.context.inputTextureLayouts[t].strides,s=i.length,l=`offsetToIndices_${n}`;e[l]=new z(du.offsetToIndicesSingle(l,s,o)),l=`offsetToIndices_${n}_T`,e[l]=new z(du.offsetToIndicesSingle(l,s,o.slice().reverse()))}),e}static offsetToIndicesSingle(e,n,t){let i=[];for(let o=0;o<n-1;++o)i.push(`
      indices[${o}] = offset / ${t[o]};`),i.push(`
        offset -= indices[${o}] * ${t[o]};`);return i.push(`
      indices[${n-1}] = offset;`),`
      void ${e}(int offset, out int indices[${n}]) {
        ${i.join("")}
      }
      `}incrementIndices(){let e={};return this.context.programInfo.inputNames.forEach((n,t)=>{let i=this.context.inputTextureLayouts[t].shape,o=i.length,s=`incrementIndices_${n}`,l="";for(let a=0;a<o;++a)l+=`
        shape[${a}] = ${i[a]};`;let c=`
        void ${s}(int axis, out int indices[${o}]) {
          int shape[${o}];
          ${l};
          for(int i = ${o} -1 ; i >= 0; --i) {
            if(i > axis) continue;
            indices[i] += 1;
            if(indices[i] < shape[i]) {
              break;
            }
            indices[i] = 0;
          }
        }
        `;e[s]=new z(c)}),e}}}),QN,Tq=R(()=>{"use strict";mo(),QN=class extends Tl{constructor(r){super(r)}getCustomTypes(){return{}}getFunctions(){return C(C(C(C({},this.binaryVecFunctions()),this.copyVec()),this.setVecItem()),this.getVecItem())}binaryVecFunctions(){let r=this.context.outputTextureLayout.shape.length,e={add:"+=",sub:"-=",mul:"*=",div:"/="},n={};for(let t in e){let i=`${t}Vec`,o="";for(let l=0;l<r;++l)o+=`
          dest[${l}] ${e[t]} src[${l}];
          `;let s=`
        void ${i}(int src[${r}], out int dest[${r}]) {
          ${o}
        }
        `;n[i]=new z(s)}return n}copyVec(){let r=this.context.outputTextureLayout.shape.length,e="";for(let t=0;t<r;++t)e+=`
        dest[${t}] = src[${t}];
        `;let n=`
      void copyVec(int src[${r}], out int dest[${r}]) {
        ${e}
      }
      `;return{copyVec:new z(n)}}setVecItem(){let r=this.context.outputTextureLayout.shape.length,e=`
        if(index < 0)
            index =${r} + index;
        if (index == 0)
            m[0] = value;
        `;for(let t=1;t<r-1;++t)e+=`
        else if (index == ${t})
            m[${t}] = value;
            `;e+=`
        else
            m[${r-1}] = value;
        `;let n=`
      void setVecItem(out int m[${r}], int index, int value) {
        ${e}
      }
        `;return{setVecItem:new z(n)}}getVecItem(){let r=this.context.outputTextureLayout.shape.length,e=`
        if(index < 0)
            index = ${r} + index;
        if (index == 0)
            return m[0];
      `;for(let t=1;t<r-1;++t)e+=`
        else if (index == ${t})
            return m[${t}];
      `;e+=`
        else
            return m[${r-1}];
        `;let n=`
      int getVecItem(int m[${r}], int index) {
        ${e}
      }
    `;return{getVecItem:new z(n)}}}}),xw,xq=R(()=>{"use strict";vq(),bq(),wq(),_q(),Tq(),xw={encoding:KN,fragcolor:ZN,vec:QN,shapeUtils:JN,coordinates:XN}}),eR,Sq=R(()=>{"use strict";mo(),pq(),xq(),it(),eR=class{constructor(r,e,n,t){this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new jM(r,e,n,t),Object.keys(xw).forEach(o=>{let s=new xw[o](this.context);this.libs[o]=s});let i=this.glslLibRoutineDependencyGraph;for(let o in this.libs){let s=this.libs[o].getFunctions();for(let l in s){let c=o+"."+l,a;i[c]?(a=i[c],a.routineBody=s[l].routineBody):(a=new lw(c,s[l].routineBody),i[c]=a);let u=s[l].dependencies;if(u)for(let d=0;d<u.length;++d)if(i[u[d]])a.addDependency(i[u[d]]);else{let h=new lw(u[d]);i[u[d]]=h,a.addDependency(h)}}}}preprocess(){let r=this.context.programInfo,e=r.shaderSource;return this.context.programInfo.hasMain||(e=`${e}
      ${L8(this.context.glContext.version,this.context.outputTextureLayout.shape.length)}`),e=fq(e),`${F8(this.context.glContext.version)}
    ${this.getUniforms(r.inputNames,r.variables)}
    ${this.getImports(e)}
    ${e}`}getImports(r){let e=this.selectGlslLibRoutinesToBeIncluded(r);if(e.length===0)return"";let n="";for(let t=0;t<e.length;++t)if(e[t].routineBody)n+=e[t].routineBody+`
`;else throw new Error(`Missing body for the Glsl Library routine: ${e[t].name}`);return n}selectGlslLibRoutinesToBeIncluded(r){let e=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach(n=>{let t=n.split(".")[1];r.indexOf(t)!==-1&&e.push(this.glslLibRoutineDependencyGraph[n])}),VM.returnOrderedNodes(e)}getUniforms(r,e){let n=[];if(r)for(let t of r)n.push(`uniform sampler2D ${t};`);if(e)for(let t of e)n.push(`uniform ${t.type} ${t.name}${t.arrayLength?`[${t.arrayLength}]`:""};`);return n.join(`
`)}}}),tR,Eq=R(()=>{"use strict";Hr(),Er(),Sq(),it(),tR=class{constructor(r,e,n){this.profiler=r,this.glContext=e,this.textureLayoutStrategy=n,this.repo=new Map,this.attributesBound=!1}getArtifact(r){return this.repo.get(r)}setArtifact(r,e){this.repo.set(r,e)}run(r,e,n){this.profiler.event("op",`ProgramManager.run ${r.programInfo.name??"unknown kernel"}`,()=>{let t=this.glContext.gl,i=r.program;t.useProgram(i);try{this.bindOutput(n),this.attributesBound||this.bindAttributes(r.attribLocations),this.bindUniforms(r.uniformLocations,r.programInfo.variables??[],e)}catch(o){throw ht.error("ProgramManager",r.programInfo.shaderSource),o}this.profiler.event("backend","GlContext.draw()",()=>{this.glContext.draw()})},this.glContext)}dispose(){this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach(r=>this.glContext.deleteProgram(r.program))}build(r,e,n){return this.profiler.event("backend","ProgramManager.build",()=>{let t=new eR(this.glContext,r,e,n),i=t.preprocess(),o=this.compile(i);return{programInfo:r,program:o,uniformLocations:this.getUniformLocations(o,t.context.programInfo.inputNames,t.context.programInfo.variables),attribLocations:this.getAttribLocations(o)}})}compile(r){if(!this.vertexShader){ht.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");let t=k8(this.glContext.version);this.vertexShader=this.glContext.compileShader(t,this.glContext.gl.VERTEX_SHADER)}me.debug&&ht.verbose("ProrgramManager",`FragShader:
${r}
`);let e=this.glContext.compileShader(r,this.glContext.gl.FRAGMENT_SHADER),n=this.glContext.createProgram(this.vertexShader,e);return this.glContext.deleteShader(e),n}bindOutput(r){let e=r.width,n=r.height;ht.verbose("ProrgramManager",`Binding output texture to Framebuffer: w/h=${e}/${n}, shape=${r.shape}, type=${r.tensor.type}`),this.glContext.attachFramebuffer(r.texture,e,n)}bindAttributes(r){let e=r.position,n=r.textureCoord;this.glContext.setVertexAttributes(e,n),this.attributesBound=!0}bindUniforms(r,e,n){let t=this.glContext.gl,i=0;for(let{name:o,type:s,location:l,arrayLength:c}of r){let a=e.find(u=>u.name===o)?.data;if(s!=="sampler2D"&&!a)throw new Error(`variable '${o}' does not have data defined in program info`);switch(s){case"sampler2D":this.bindTexture(n[i],l,i),i++;break;case"float":c?t.uniform1fv(l,a):t.uniform1f(l,a);break;case"int":c?t.uniform1iv(l,a):t.uniform1i(l,a);break;default:throw new Error(`Uniform not implemented: ${s}`)}}}bindTexture(r,e,n){this.glContext.bindTextureToUniform(r.texture,n,e)}getAttribLocations(r){return{position:this.getAttribLocation(r,"position"),textureCoord:this.getAttribLocation(r,"textureCoord")}}getUniformLocations(r,e,n){let t=[];if(e)for(let i of e)t.push({name:i,type:"sampler2D",location:this.getUniformLocation(r,i)});if(n)for(let i of n)t.push(k(C({},i),{location:this.getUniformLocation(r,i.name)}));return t}getUniformLocation(r,e){let n=this.glContext.gl.getUniformLocation(r,e);if(n===null)throw new Error(`Uniform ${e} not found.`);return n}getAttribLocation(r,e){return this.glContext.gl.getAttribLocation(r,e)}}}),nR,Dq=R(()=>{"use strict";Er(),Op(),nR=class{constructor(r,e,n,t){this.glContext=r,this.layoutStrategy=e,this.profiler=n,this.config=t,this.pendingRead=new Map,t.reuseTextures&&(this.inUseTextures=new Map,this.idleTextures=new Map,this.textureLookup=new Map)}createTextureFromLayout(r,e,n,t){let i=this.toEncoderType(r),o=this.glContext.getEncoder(i,e.channels||1,t);if(e.isPacked&&t===1)throw new Error("not implemented");let s=e.width,l=e.height,c,a;if(this.config.reuseTextures){c=`${s}x${l}_${o.format}_${o.internalFormat}_${o.textureType}`,a=this.inUseTextures.get(c),a||(a=[],this.inUseTextures.set(c,a));let d=this.idleTextures.get(c);if(d&&d.length>0){let h=d.pop();return a.push(h),t===1&&this.glContext.updateTexture(h,s,l,o,this.toTextureData(r,n)),h}}ht.verbose("TextureManager",`Creating new texture of size ${e.width}x${e.height}`);let u=this.glContext.allocateTexture(s,l,o,this.toTextureData(r,n));return this.config.reuseTextures&&(a.push(u),this.textureLookup.set(u,c)),u}readTexture(r,e,n){return n||(n=1),this.profiler.event("backend","TextureManager.readTexture",()=>{let t=r.shape.reduce((o,s)=>o*s)*n,i=this.glContext.readTexture(r.texture,r.width,r.height,t,this.toEncoderType(e),n);return this.toTensorData(e,i)})}readTextureAsync(r,e,n){return F(this,null,function*(){let t=r.tensor.dataId;if(n||(n=1),this.pendingRead.has(t)){let i=this.pendingRead.get(t);return new Promise(o=>i?.push(o))}return this.profiler.event("backend","TextureManager.readTextureAsync",()=>F(this,null,function*(){this.pendingRead.set(t,[]);let i=r.shape.reduce((c,a)=>c*a)*n;yield this.glContext.createAndWaitForFence();let o=this.glContext.readTexture(r.texture,r.width,r.height,i,this.toEncoderType(e),n),s=this.toTensorData(e,o),l=this.pendingRead.get(t);return this.pendingRead.delete(t),l?.forEach(c=>c(s)),s}))})}readUint8TextureAsFloat(r){return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",()=>{let e=r.shape.reduce((t,i)=>t*i),n=this.glContext.readTexture(r.texture,r.width,r.height,e*4,"byte",4);return new Float32Array(n.buffer,n.byteOffset,e)})}releaseTexture(r,e){let n;if(this.config.reuseTextures&&(n=this.textureLookup.get(r.texture),n)){e&&this.textureLookup.delete(n);let t=this.inUseTextures.get(n);if(t){let i=t.indexOf(r.texture);if(i!==-1){t.splice(i,1);let o=this.idleTextures.get(n);o||(o=[],this.idleTextures.set(n,o)),o.push(r.texture)}}}(!n||e)&&(ht.verbose("TextureManager",`Deleting texture of size ${r.width}x${r.height}`),this.glContext.deleteTexture(r.texture))}toTensorData(r,e){switch(r){case"int16":return e instanceof Int16Array?e:Int16Array.from(e);case"int32":return e instanceof Int32Array?e:Int32Array.from(e);case"int8":return e instanceof Int8Array?e:Int8Array.from(e);case"uint16":return e instanceof Uint16Array?e:Uint16Array.from(e);case"uint32":return e instanceof Uint32Array?e:Uint32Array.from(e);case"uint8":case"bool":return e instanceof Uint8Array?e:Uint8Array.from(e);case"float32":return e instanceof Float32Array?e:Float32Array.from(e);case"float64":return e instanceof Float64Array?e:Float64Array.from(e);default:throw new Error(`TensorData type ${r} is not supported`)}}toTextureData(r,e){if(e)return e instanceof Float32Array?e:new Float32Array(e)}toEncoderType(r){return"float"}clearActiveTextures(){this.glContext.clearActiveTextures()}}}),rR,Cq=R(()=>{"use strict";Er(),m8(),J8(),hq(),Eq(),YN(),Dq(),rR=class{constructor(r,e){this.backend=r,this.context=e,this.layoutStrategy=new qN(r.glContext.maxTextureSize),this.programManager=new tR(this.context.profiler,r.glContext,this.layoutStrategy),this.textureManager=new nR(r.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:r.textureCacheMode==="full"}),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map,this.pack=r.pack,this.pack2unpackMap=new Map,this.unpack2packMap=new Map}createInferenceHandler(){return new FM(this)}onGraphInitialized(r){let e=r.getValues().filter(n=>n.from===-1&&n.tensor).map(n=>n.tensor.dataId);this.initializers=new Set(e)}isInitializer(r){return this.initializers?this.initializers.has(r):!1}addInitializer(r){this.initializers.add(r)}getTextureData(r,e){return e?this.packedTextureDataCache.get(r):this.unpackedTextureDataCache.get(r)}setTextureData(r,e,n=!1){ht.verbose("WebGLSessionHandler","Storing Texture data in cache"),n?this.packedTextureDataCache.set(r,e):this.unpackedTextureDataCache.set(r,e)}dispose(){this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(r=>this.textureManager.releaseTexture(r,!0)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(r=>this.textureManager.releaseTexture(r,!0)),this.unpackedTextureDataCache=new Map}resolve(r,e,n){let t=p8(r,e,GN);return{impl:t.opImpl,context:t.opInit?t.opInit(r,n):r}}}});function Iq(r){let e=0;for(;e<r.length&&r[e]();++e);return e-1}var Sw,Oq=R(()=>{"use strict";Hr(),Op(),Op(),Ti(),Sw=class{constructor(r,e){this.frameBufferBound=!1,this.itemsToPoll=[],this.gl=r,this.version=e,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters()}allocateTexture(r,e,n,t){let i=this.gl,o=i.createTexture();i.bindTexture(i.TEXTURE_2D,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE);let s=t?n.encode(t,r*e):null;return i.texImage2D(i.TEXTURE_2D,0,n.internalFormat,r,e,0,n.format,n.textureType,s),this.checkError(),o}updateTexture(r,e,n,t,i){let o=this.gl;o.bindTexture(o.TEXTURE_2D,r);let s=t.encode(i,e*n);o.texSubImage2D(o.TEXTURE_2D,0,0,0,e,n,t.format,t.textureType,s),this.checkError()}attachFramebuffer(r,e,n){let t=this.gl;t.bindTexture(t.TEXTURE_2D,r),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),this.checkError(),t.viewport(0,0,e,n),t.scissor(0,0,e,n)}readTexture(r,e,n,t,i,o){let s=this.gl;o||(o=1),this.frameBufferBound||this.attachFramebuffer(r,e,n);let l=this.getEncoder(i,o),c=l.allocate(e*n);return s.bindTexture(s.TEXTURE_2D,r),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,r,0),s.readPixels(0,0,e,n,s.RGBA,l.textureType,c),this.checkError(),l.decode(c,t)}isFramebufferReady(){return!0}getActiveTexture(){let r=this.gl;return`TEXTURE${r.getParameter(this.gl.ACTIVE_TEXTURE)-r.TEXTURE0}`}getTextureBinding(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D)}getFramebufferBinding(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)}setVertexAttributes(r,e){let n=this.gl;n.vertexAttribPointer(r,3,n.FLOAT,!1,20,0),n.enableVertexAttribArray(r),e!==-1&&(n.vertexAttribPointer(e,2,n.FLOAT,!1,20,12),n.enableVertexAttribArray(e)),this.checkError()}createProgram(r,e){let n=this.gl,t=n.createProgram();return n.attachShader(t,r),n.attachShader(t,e),n.linkProgram(t),t}compileShader(r,e){let n=this.gl,t=n.createShader(e);if(!t)throw new Error(`createShader() returned null with type ${e}`);if(n.shaderSource(t,r),n.compileShader(t),n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw new Error(`Failed to compile shader: ${n.getShaderInfoLog(t)}
Shader source:
${r}`);return t}deleteShader(r){this.gl.deleteShader(r)}bindTextureToUniform(r,e,n){let t=this.gl;t.activeTexture(t.TEXTURE0+e),this.checkError(),t.bindTexture(t.TEXTURE_2D,r),this.checkError(),t.uniform1i(n,e),this.checkError()}draw(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError()}checkError(){if(me.debug){let r=this.gl,e=r.getError(),n="";switch(e){case r.NO_ERROR:return;case r.INVALID_ENUM:n="INVALID_ENUM";break;case r.INVALID_VALUE:n="INVALID_VALUE";break;case r.INVALID_OPERATION:n="INVALID_OPERATION";break;case r.INVALID_FRAMEBUFFER_OPERATION:n="INVALID_FRAMEBUFFER_OPERATION";break;case r.OUT_OF_MEMORY:n="OUT_OF_MEMORY";break;case r.CONTEXT_LOST_WEBGL:n="CONTEXT_LOST_WEBGL";break;default:n=`Unknown WebGL Error: ${e.toString(16)}`}throw new Error(n)}}deleteTexture(r){this.gl.deleteTexture(r)}deleteProgram(r){this.gl.deleteProgram(r)}getEncoder(r,e,n=0){if(this.version===2)return new NM(this.gl,e);switch(r){case"float":return n===1||this.isRenderFloat32Supported?new sw(this.gl,e):new sw(this.gl,e,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw new Error("not implemented");case"byte":return new RM(this.gl,e);default:throw new Error(`Invalid dataType: ${r}`)}}clearActiveTextures(){let r=this.gl;for(let e=0;e<this.maxTextureImageUnits;++e)r.activeTexture(r.TEXTURE0+e),r.bindTexture(r.TEXTURE_2D,null)}dispose(){if(this.disposed)return;let r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteFramebuffer(this.framebuffer),r.bindBuffer(r.ARRAY_BUFFER,null),r.deleteBuffer(this.vertexbuffer),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null),r.finish(),this.disposed=!0}createDefaultGeometry(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0])}createVertexbuffer(){let r=this.gl,e=r.createBuffer();if(!e)throw new Error("createBuffer() returned null");let n=this.createDefaultGeometry();return r.bindBuffer(r.ARRAY_BUFFER,e),r.bufferData(r.ARRAY_BUFFER,n,r.STATIC_DRAW),this.checkError(),e}createFramebuffer(){let r=this.gl.createFramebuffer();if(!r)throw new Error("createFramebuffer returned null");return r}queryVitalParameters(){let r=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),this.version===1&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw new Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),this.version}getExtensions(){this.version===2?(this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"),this.disjointTimerQueryWebgl2Extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"))}checkFloatTextureAttachableToFrameBuffer(){let r=this.gl,e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e);let n=this.version===2?r.RGBA32F:r.RGBA;r.texImage2D(r.TEXTURE_2D,0,n,1,1,0,r.RGBA,r.FLOAT,null);let t=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,t),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0);let i=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(e),r.deleteFramebuffer(t),i}checkRenderFloat32(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Download(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension||!this.gl.getExtension("WEBGL_color_buffer_float"))return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Blend(){let r=this.gl,e,n,t,i,o;try{e=r.createTexture(),n=r.createFramebuffer(),r.bindTexture(r.TEXTURE_2D,e);let s=this.version===2?r.RGBA32F:r.RGBA;return r.texImage2D(r.TEXTURE_2D,0,s,1,1,0,r.RGBA,r.FLOAT,null),r.bindFramebuffer(r.FRAMEBUFFER,n),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),r.enable(r.BLEND),t=r.createShader(r.VERTEX_SHADER),!t||(r.shaderSource(t,"void main(){}"),r.compileShader(t),i=r.createShader(r.FRAGMENT_SHADER),!i)||(r.shaderSource(i,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),r.compileShader(i),o=r.createProgram(),!o)?!1:(r.attachShader(o,t),r.attachShader(o,i),r.linkProgram(o),r.useProgram(o),r.drawArrays(r.POINTS,0,1),r.getError()===r.NO_ERROR)}finally{r.disable(r.BLEND),o&&r.deleteProgram(o),t&&r.deleteShader(t),i&&r.deleteShader(i),n&&(r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteFramebuffer(n)),e&&(r.bindTexture(r.TEXTURE_2D,null),r.deleteTexture(e))}}beginTimer(){if(this.version===2&&this.disjointTimerQueryWebgl2Extension){let r=this.gl,e=this.disjointTimerQueryWebgl2Extension,n=r.createQuery();return r.beginQuery(e.TIME_ELAPSED_EXT,n),n}else throw new Error("WebGL1 profiling currently not supported.")}endTimer(){if(this.version===2&&this.disjointTimerQueryWebgl2Extension){let r=this.gl,e=this.disjointTimerQueryWebgl2Extension;r.endQuery(e.TIME_ELAPSED_EXT);return}else throw new Error("WebGL1 profiling currently not supported")}isTimerResultAvailable(r){let e=!1,n=!1;if(this.version===2&&this.disjointTimerQueryWebgl2Extension){let t=this.gl,i=this.disjointTimerQueryWebgl2Extension;e=t.getQueryParameter(r,t.QUERY_RESULT_AVAILABLE),n=t.getParameter(i.GPU_DISJOINT_EXT)}else throw new Error("WebGL1 profiling currently not supported");return e&&!n}getTimerResult(r){let e=0;if(this.version===2){let n=this.gl;e=n.getQueryParameter(r,n.QUERY_RESULT),n.deleteQuery(r)}else throw new Error("WebGL1 profiling currently not supported");return e/1e6}waitForQueryAndGetTime(r){return F(this,null,function*(){return yield PO(()=>this.isTimerResultAvailable(r)),this.getTimerResult(r)})}createAndWaitForFence(){return F(this,null,function*(){let r=this.createFence(this.gl);return this.pollFence(r)})}createFence(r){let e,n=r,t=n.fenceSync(n.SYNC_GPU_COMMANDS_COMPLETE,0);return r.flush(),t===null?e=()=>!0:e=()=>{let i=n.clientWaitSync(t,0,0);return i===n.ALREADY_SIGNALED||i===n.CONDITION_SATISFIED},{query:t,isFencePassed:e}}pollFence(r){return F(this,null,function*(){return new Promise(e=>{this.addItemToPoll(()=>r.isFencePassed(),()=>e())})})}pollItems(){let r=Iq(this.itemsToPoll.map(e=>e.isDoneFn));for(let e=0;e<=r;++e){let{resolveFn:n}=this.itemsToPoll[e];n()}this.itemsToPoll=this.itemsToPoll.slice(r+1)}addItemToPoll(r,e){return F(this,null,function*(){this.itemsToPoll.push({isDoneFn:r,resolveFn:e}),!(this.itemsToPoll.length>1)&&(yield PO(()=>(this.pollItems(),this.itemsToPoll.length===0)))})}}});function iR(r){let e;if((!r||r==="webgl2")&&"webgl2"in Cs?e=Cs.webgl2:(!r||r==="webgl")&&"webgl"in Cs&&(e=Cs.webgl),!e)try{let t=Pq();e=RP(t,r)}catch{let t=Aq();e=RP(t,r)}r=r||e.version===1?"webgl":"webgl2";let n=e.gl;return Cs[r]=e,n.isContextLost()?(delete Cs[r],iR(r)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),e)}function RP(r,e){let n={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1},t,i=n;if((!e||e==="webgl2")&&(t=r.getContext("webgl2",i),t))try{return new Sw(t,2)}catch(o){ht.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl2'. Error: ${o}`)}if((!e||e==="webgl")&&(t=r.getContext("webgl",i)||r.getContext("experimental-webgl",i),t))try{return new Sw(t,1)}catch(o){ht.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: ${o}`)}throw new Error("WebGL is not supported")}function Aq(){if(typeof document>"u")throw new TypeError("failed to create canvas: document is not supported");let r=document.createElement("canvas");return r.width=1,r.height=1,r}function Pq(){if(typeof OffscreenCanvas>"u")throw new TypeError("failed to create offscreen canvas: OffscreenCanvas is not supported");return new OffscreenCanvas(1,1)}var Cs,Mq=R(()=>{"use strict";Er(),Oq(),Cs={}}),oR,Nq=R(()=>{"use strict";Hr(),Er(),Cq(),Mq(),oR=class{get contextId(){return me.webgl.contextId}set contextId(r){me.webgl.contextId=r}get matmulMaxBatchSize(){return me.webgl.matmulMaxBatchSize}set matmulMaxBatchSize(r){me.webgl.matmulMaxBatchSize=r}get textureCacheMode(){return me.webgl.textureCacheMode}set textureCacheMode(r){me.webgl.textureCacheMode=r}get pack(){return me.webgl.pack}set pack(r){me.webgl.pack=r}get async(){return me.webgl.async}set async(r){me.webgl.async=r}initialize(){try{return this.glContext=iR(this.contextId),typeof this.matmulMaxBatchSize!="number"&&(this.matmulMaxBatchSize=16),typeof this.textureCacheMode!="string"&&(this.textureCacheMode="full"),typeof this.pack!="boolean"&&(this.pack=!1),typeof this.async!="boolean"&&(this.async=!1),ht.setWithEnv(me),me.webgl.context||Object.defineProperty(me.webgl,"context",{value:this.glContext.gl}),ht.verbose("WebGLBackend",`Created WebGLContext: ${typeof this.glContext} with matmulMaxBatchSize: ${this.matmulMaxBatchSize}; textureCacheMode: ${this.textureCacheMode}; pack: ${this.pack}; async: ${this.async}.`),!0}catch(r){return ht.warning("WebGLBackend",`Unable to initialize WebGLBackend. ${r}`),!1}}createSessionHandler(r){return new rR(this,r)}dispose(){this.glContext.dispose()}}});function sR(r){return F(this,null,function*(){if(r){let e=typeof r=="string"?[r]:r;for(let n of e){let t=$w.get(n);if(t)return t;let i=yield Rq(n);if(i)return i}}else return sR(["webgl"]);throw new Error("no available backend to use")})}function Rq(r){return F(this,null,function*(){let e=aR;if(typeof e[r]<"u"&&kq(e[r])){let n=e[r],t=n.initialize();if(typeof t=="object"&&"then"in t&&(t=yield t),t)return $w.set(r,n),n}})}function kq(r){let e=r;return"initialize"in e&&typeof e.initialize=="function"&&"createSessionHandler"in e&&typeof e.createSessionHandler=="function"&&"dispose"in e&&typeof e.dispose=="function"}var $w,aR,Fq=R(()=>{"use strict";Nq(),$w=new Map,aR={webgl:new oR}}),kP,lR,Lq=R(()=>{"use strict";Er(),kP=class{constructor(r,e){this.op=r,this.node=e}},lR=class{constructor(r,e,n){this.graph=r,this.profiler=n,this.initialize(e)}initialize(r){this.profiler.event("session","ExecutionPlan.initialize",()=>{let e=this.graph.getNodes();if(e.length!==r.length)throw new Error("The size of nodes and OPs do not match.");this._ops=r.map((n,t)=>new kP(n,e[t])),this.reset(),this._starter=[],this._ops.forEach((n,t)=>{let i=!0;for(let o of n.node.inputs)if(!this._values[o]&&this.graph.getInputIndices().indexOf(o)===-1){i=!1;break}i&&this._starter.push(t)})})}reset(){this._values=this.graph.getValues().map(r=>r.tensor)}execute(r,e){return F(this,null,function*(){return this.profiler.event("session","ExecutionPlan.execute",()=>F(this,null,function*(){this.reset();let n=r.createInferenceHandler(),t=this.graph.getInputIndices();if(e.length!==t.length)throw new Error(`number of input tensors don't match the number of inputs to the model: actual: ${e.length} expected: ${t.length}`);e.forEach((a,u)=>{let d=t[u];this._values[d]=a});let i=this._starter.slice(0),o=this.graph.getValues(),s=this.graph.getNodes(),l=0;for(;l<i.length;){let a=i[l++],u=this._ops[a],d=u.node.inputs.map(g=>this._values[g]);if(d.indexOf(void 0)!==-1)throw new Error(`unresolved input detected: op: ${u.node}`);let h=d;ht.verbose("ExecPlan",`Running op:${u.node.name} (${h.map((g,y)=>`'${u.node.inputs[y]}': ${g.type}[${g.dims.join(",")}]`).join(", ")})`);let f=yield this.profiler.event("node",u.node.name,()=>F(this,null,function*(){return u.op.impl(n,h,u.op.context)}));if(f.length!==u.node.outputs.length)throw new Error("the size of output does not match model definition.");f.forEach((g,y)=>{let w=u.node.outputs[y];if(this._values[w])throw new Error(`output [${w}] already has value: op:${u.node.name}`);this._values[w]=g});let p=new Set;f.forEach((g,y)=>{let w=u.node.outputs[y];for(let v of o[w].to){let x=s[v],A=!0;for(let L of x.inputs)if(!this._values[L]){A=!1;break}A&&p.add(v)}}),i.push(...p)}let c=[];for(let a=0;a<this.graph.getOutputIndices().length;a++){let u=this.graph.getOutputIndices()[a],d=this._values[u];if(d===void 0)throw new Error(`required output [${u}] does not have value`);u===0?yield d.getData():d.data,c.push(d)}return ht.verbose("ExecPlan","disposing of inferenceHandler"),n.dispose(),c}))})}}}),be,Bn,Ew,Bq=R(()=>{"use strict";kp(),be=ml(Su()),wl(),Re(),Bn=Be.experimental.fbs,Ew=class hu{constructor(e){if(this._attributes=new Map,e!=null){for(let n of e)n instanceof be.onnx.AttributeProto?this._attributes.set(n.name,[hu.getValue(n),hu.getType(n)]):n instanceof Bn.Attribute&&this._attributes.set(n.name(),[hu.getValue(n),hu.getType(n)]);if(this._attributes.size<e.length)throw new Error("duplicated attribute names")}}set(e,n,t){this._attributes.set(e,[t,n])}delete(e){this._attributes.delete(e)}getFloat(e,n){return this.get(e,"float",n)}getInt(e,n){return this.get(e,"int",n)}getString(e,n){return this.get(e,"string",n)}getTensor(e,n){return this.get(e,"tensor",n)}getFloats(e,n){return this.get(e,"floats",n)}getInts(e,n){return this.get(e,"ints",n)}getStrings(e,n){return this.get(e,"strings",n)}getTensors(e,n){return this.get(e,"tensors",n)}get(e,n,t){let i=this._attributes.get(e);if(i===void 0){if(t!==void 0)return t;throw new Error(`required attribute not found: ${e}`)}if(i[1]!==n)throw new Error(`type mismatch: expected ${n} but got ${i[1]}`);return i[0]}static getType(e){let n=e instanceof be.onnx.AttributeProto?e.type:e.type();switch(n){case be.onnx.AttributeProto.AttributeType.FLOAT:return"float";case be.onnx.AttributeProto.AttributeType.INT:return"int";case be.onnx.AttributeProto.AttributeType.STRING:return"string";case be.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case be.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case be.onnx.AttributeProto.AttributeType.INTS:return"ints";case be.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case be.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw new Error(`attribute type is not supported yet: ${be.onnx.AttributeProto.AttributeType[n]}`)}}static getValue(e){let n=e instanceof be.onnx.AttributeProto?e.type:e.type();if(n===be.onnx.AttributeProto.AttributeType.GRAPH||n===be.onnx.AttributeProto.AttributeType.GRAPHS)throw new Error("graph attribute is not supported yet");let t=this.getValueNoCheck(e);if(n===be.onnx.AttributeProto.AttributeType.INT&&$r.isLong(t))return $r.longToNumber(t);if(n===be.onnx.AttributeProto.AttributeType.INTS){let i=t,o=new Array(i.length);for(let s=0;s<i.length;s++){let l=i[s];o[s]=$r.longToNumber(l)}return o}if(n===be.onnx.AttributeProto.AttributeType.TENSOR)return e instanceof be.onnx.AttributeProto?$n.fromProto(t):$n.fromOrtTensor(t);if(n===be.onnx.AttributeProto.AttributeType.TENSORS){if(e instanceof be.onnx.AttributeProto)return t.map(i=>$n.fromProto(i));if(e instanceof Bn.Attribute)return t.map(i=>$n.fromOrtTensor(i))}return n===be.onnx.AttributeProto.AttributeType.STRING&&e instanceof be.onnx.AttributeProto?tw(t):n===be.onnx.AttributeProto.AttributeType.STRINGS&&e instanceof be.onnx.AttributeProto?t.map(tw):t}static getValueNoCheck(e){return e instanceof be.onnx.AttributeProto?this.getValueNoCheckFromOnnxFormat(e):this.getValueNoCheckFromOrtFormat(e)}static getValueNoCheckFromOnnxFormat(e){switch(e.type){case be.onnx.AttributeProto.AttributeType.FLOAT:return e.f;case be.onnx.AttributeProto.AttributeType.INT:return e.i;case be.onnx.AttributeProto.AttributeType.STRING:return e.s;case be.onnx.AttributeProto.AttributeType.TENSOR:return e.t;case be.onnx.AttributeProto.AttributeType.GRAPH:return e.g;case be.onnx.AttributeProto.AttributeType.FLOATS:return e.floats;case be.onnx.AttributeProto.AttributeType.INTS:return e.ints;case be.onnx.AttributeProto.AttributeType.STRINGS:return e.strings;case be.onnx.AttributeProto.AttributeType.TENSORS:return e.tensors;case be.onnx.AttributeProto.AttributeType.GRAPHS:return e.graphs;default:throw new Error(`unsupported attribute type: ${be.onnx.AttributeProto.AttributeType[e.type]}`)}}static getValueNoCheckFromOrtFormat(e){switch(e.type()){case Bn.AttributeType.FLOAT:return e.f();case Bn.AttributeType.INT:return e.i();case Bn.AttributeType.STRING:return e.s();case Bn.AttributeType.TENSOR:return e.t();case Bn.AttributeType.GRAPH:return e.g();case Bn.AttributeType.FLOATS:return e.floatsArray();case Bn.AttributeType.INTS:{let n=[];for(let t=0;t<e.intsLength();t++)n.push(e.ints(t));return n}case Bn.AttributeType.STRINGS:{let n=[];for(let t=0;t<e.stringsLength();t++)n.push(e.strings(t));return n}case Bn.AttributeType.TENSORS:{let n=[];for(let t=0;t<e.tensorsLength();t++)n.push(e.tensors(t));return n}default:throw new Error(`unsupported attribute type: ${Bn.AttributeType[e.type()]}`)}}}}),k0,nu,Dw,_i,F0,FP,jq=R(()=>{"use strict";Bq(),kp(),k0=ml(Su()),wl(),Re(),nu=Be.experimental.fbs,Dw={from:(r,e)=>new FP(r,e)},_i=class{constructor(r){this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,r&&(this.type=jn.tensorValueTypeFromProto(r.type.tensorType))}get from(){return this._from}get to(){return this._to}},F0=class{constructor(r,e){r instanceof k0.onnx.NodeProto?(this.name=r.name,this.opType=r.opType,this.attributes=new Ew(r.attribute)):r instanceof nu.Node&&(this.name=e??r.name(),this.opType=r.opType(),this.attributes=new Ew(jn.tensorAttributesFromORTFormat(r))),this.inputs=[],this.outputs=[],this.executeNode=!0}},FP=class{constructor(r,e){if(!r)throw new TypeError("graph is empty");this.buildGraph(r),this.transformGraph(e),this.checkIsAcyclic()}getInputIndices(){return this._allInputIndices}getInputNames(){return this._allInputNames}getOutputIndices(){return this._allOutputIndices}getOutputNames(){return this._allOutputNames}getValues(){return this._allData}getNodes(){return this._nodes}buildGraph(r){if(r instanceof k0.onnx.GraphProto)this.buildGraphFromOnnxFormat(r);else if(r instanceof nu.Graph)this.buildGraphFromOrtFormat(r);else throw new TypeError("Graph type is not supported.")}buildGraphFromOnnxFormat(r){let e=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];let n=new Map;if(!r.input)throw new Error("missing information in graph: input");let t=[];for(let i of r.input){if(e.has(i.name))throw new Error(`duplicated input name: ${i.name}`);let o=this._allData.push(new _i(i))-1;e.set(i.name,o),t.push(i.name)}if(!r.initializer)throw new Error("missing information in graph: initializer");for(let i of r.initializer){let o=e.get(i.name);if(o===void 0){let s=new _i;s.type={shape:{dims:jn.tensorDimsFromProto(i.dims)},tensorType:jn.tensorDataTypeFromProto(i.dataType)},o=this._allData.push(s)-1,e.set(i.name,o)}this._allData[o]._from=-1,this._allData[o].tensor=$n.fromProto(i)}for(let i=0;i<this._allData.length;i++)this._allData[i].tensor||(this._allInputIndices.push(i),this._allInputNames.push(t[i]));if(!r.output)throw new Error("missing information in graph: output");for(let i of r.output){if(e.has(i.name))throw new Error(`duplicated output name: ${i.name}`);let o=this._allData.push(new _i(i))-1;e.set(i.name,o),this._allOutputIndices.push(o),this._allOutputNames.push(i.name)}if(!r.node)throw new Error("missing information in graph: node");for(let i of r.node){if(!i.name)for(let s=0;;s++){let l=`unnamed_${i.opType}_${s}`;if(!n.has(l)){i.name=l;break}}if(n.has(i.name))throw new Error(`duplicated node name: ${i.name}`);let o=this._nodes.push(new F0(i))-1;n.set(i.name,o)}for(let i=0;i<this._nodes.length;i++){let o=this._nodes[i],s=r.node[i];if(!s.output)throw new Error(`missing output for node: ${s.name}`);for(let l of s.output){let c=e.get(l);if(typeof c>"u"&&(c=this._allData.push(new _i)-1,e.set(l,c)),o.outputs.push(c),this._allData[c]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${c}`);if(this._allData[c]._from=i,s.opType==="Constant"){if(!s.attribute||s.attribute.length!==1||!s.attribute[0].t)throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!s.output||s.output.length!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");o.outputs.pop(),o.executeNode=!1,this._allData[c]._from=-1,this._allData[c].tensor=$n.fromProto(s.attribute[0].t)}}}for(let i=0;i<this._nodes.length;i++){let o=this._nodes[i],s=r.node[i];if(!s.input)throw new Error(`missing input for node: ${s.name}`);for(let l of s.input){let c=e.get(l);if(typeof c>"u"){if(l===""&&(s.input.length===3||s.input.length===4)&&s.opType==="Resize")continue;throw new Error(`unrecognized input '${l}' for node: ${s.name}`)}o.inputs.push(c),this._allData[c]._to.push(i)}}return!0}buildGraphFromOrtFormat(r){let e=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];let n=new Map,t=[];for(let i=0;i<r.inputsLength();i++){let o=r.inputs(i);if(e.has(o))throw new Error(`duplicated input name: ${o}`);for(let s=0;s<r.nodeArgsLength();s++)if(r.nodeArgs(s)?.name()===o){let l=new _i;if(r.nodeArgs(s)?.type()?.valueType()!==nu.TypeInfoValue.tensor_type)throw new Error("Unexpected value type for the nodeArg.");let c=r.nodeArgs(s).type().value(new nu.TensorTypeAndShape),a=jn.tensorDataTypeFromProto(c.elemType()),u=c.shape(),d=[];for(let f=0;f<u.dimLength();f++)d.push($r.longToNumber(u.dim(f).value().dimValue()));l.type={shape:{dims:d},tensorType:a};let h=this._allData.push(l)-1;e.set(o,h),t.push(o)}}for(let i=0;i<r.initializersLength();i++){let o=r.initializers(i),s=e.get(o.name());if(s===void 0){let l=new _i,c=jn.tensorDimsFromORTFormat(o),a=jn.tensorDataTypeFromProto(o.dataType());l.type={shape:{dims:c},tensorType:a},s=this._allData.push(l)-1,e.set(o.name(),s)}this._allData[s]._from=-1,this._allData[s].tensor=$n.fromOrtTensor(o)}for(let i=0;i<this._allData.length;i++)this._allData[i].tensor||(this._allInputIndices.push(i),this._allInputNames.push(t[i]));for(let i=0;i<r.outputsLength();i++){let o=r.outputs(i);if(e.has(o))throw new Error(`duplicated output name: ${o}`);let s=this._allData.push(new _i)-1;e.set(o,s),this._allOutputIndices.push(s),this._allOutputNames.push(o)}if(!r.nodes)throw new Error("missing information in graph: node");for(let i=0;i<r.nodesLength();i++){let o=r.nodes(i),s=o.name();if(!s)for(let c=0;s=`unnamed_${o.opType()}_${c}`,!!n.has(s);c++);if(n.has(s))throw new Error(`duplicated node name: ${s}`);let l=this._nodes.push(new F0(o,s))-1;n.set(s,l)}for(let i=0;i<this._nodes.length;i++){let o=this._nodes[i],s=r.nodes(i);if(s==null)throw new Error(`No node exists at index ${i}`);if(s?.outputsLength()===0)throw new Error(`missing output for node: ${s.name}`);for(let l=0;l<s?.outputsLength();l++){let c=s?.outputs(l),a=e.get(c);if(typeof a>"u"&&(a=this._allData.push(new _i)-1,e.set(c,a)),o.outputs.push(a),this._allData[a]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${a}`);if(this._allData[a]._from=i,s.opType()==="Constant"){if(s.attributesLength()!==1||!s.attributes(0).t())throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(s.outputsLength()!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");o.outputs.pop(),o.executeNode=!1,this._allData[a]._from=-1,this._allData[a].tensor=$n.fromOrtTensor(s.attributes(0).t())}}}for(let i=0;i<this._nodes.length;i++){let o=this._nodes[i],s=r.nodes(i);if(s.inputsLength()===0)throw new Error(`missing input for node: ${s.name}`);for(let l=0;l<s.inputsLength();l++){let c=s.inputs(l),a=e.get(c);if(typeof a>"u")throw new Error(`unrecognized input '${c}' for node: ${s.name()}`);o.inputs.push(a),this._allData[a]._to.push(i)}}}checkIsAcyclic(){let r=new Set;this._allInputIndices.forEach(t=>{this._allData[t]._to.forEach(i=>{r.add(i)})});let e=Array.from(r),n=new Array(this._nodes.length).fill("white");for(;e.length>0;){let t=e.pop();n[t]==="gray"?n[t]="black":(e.push(t),n[t]="gray",this._nodes[t].outputs.forEach(i=>{let o=this._allData[i];if(typeof o.tensor<"u")throw new Error("node outputs should not be initialized");if(o._from!==t)throw new Error("from property of the Value object doesn't match index of Node being processed");o._to.forEach(s=>{if(n[s]==="gray")throw new Error("model graph is cyclic");n[s]==="white"&&e.push(s)})}))}}transformGraph(r){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),this.fuseConvActivationNodes(),r&&r.transformGraph(this),this.finalizeGraph()}finalizeGraph(){let r=0,e=new Array(this._nodes.length,0),n=0;for(let t=0;t<this._nodes.length;t++)e[t]=n,this._nodes[t].executeNode?(n!==t&&(this._nodes[n]=this._nodes[t]),n++):this._nodes[t].outputs.forEach(i=>{this._allData[i]._from=-2});this._nodes.splice(n,this._nodes.length-n);for(let t=0;t<this._allData.length;t++){let i=this._allData[t];i._from!==void 0&&i._from!==-1&&i._from!==-2&&(i._from=e[i._from]);for(let o=0;o<i._to.length;o++)if(i._to[o]>=0)i._to[o]=e[i._to[o]];else throw new Error("Trying to update a removed node")}r=0;for(let t=0;t<this._allData.length;t++){if(this._allData[t].from===-2&&this._allOutputIndices.indexOf(t+r)===-1){r++,this._allData.splice(t,1),t--;continue}if(r>0){let i=-1;this._allData[t].from!==void 0&&this._allData[t].from!==-1?(i=this._nodes[this._allData[t].from].outputs.indexOf(t+r),i!==-1&&(this._nodes[this._allData[t].from].outputs[i]=t)):(i=this._allInputIndices.indexOf(t+r),i!==-1&&(this._allInputIndices[i]=t)),this._allData[t].to.forEach(o=>{i=this._nodes[o].inputs.indexOf(t+r),i!==-1&&(this._nodes[o].inputs[i]=t)}),this._allData[t].to.length===0&&(i=this._allOutputIndices.indexOf(t+r),i!==-1&&(this._allOutputIndices[i]=t))}}}deleteNode(r){let e=this._nodes[r];if(e.outputs.length>1){for(let s=1;s<e.outputs.length;s++)if(this._allData[e.outputs[s]].to.length>0)throw new Error("Node deletion with more than one output connected to other nodes is not supported. ")}e.executeNode=!1;let n=e.inputs[0],t=e.outputs[0],i=this._allData[t].to;for(let s=0;s<e.inputs.length;s++){let l=this._allData[e.inputs[s]].to.indexOf(r);if(l===-1)throw new Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[e.inputs[s]].to.splice(l,1)}this._allData[t]._to=[];let o=this._allOutputIndices.indexOf(t);if(o!==-1&&(this._allOutputIndices[o]=n),i&&i.length>0)for(let s of i){let l=this._nodes[s].inputs.indexOf(t);if(l===-1)throw new Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[s].inputs[l]=n,this._allData[n].to.push(s)}}removeAllDropoutNodes(){let r=0;for(let e of this._nodes){if(e.opType==="Dropout"){if(e.inputs.length!==1)throw new Error("Dropout nodes should only contain one input. ");if(e.outputs.length!==1&&e.outputs.length!==2)throw new Error("Dropout nodes should contain either 1 or 2 output(s)");if(e.outputs.length===2&&this._allData[e.outputs[1]]._to.length!==0)throw new Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(r)}r++}}removeAllIdentityNodes(){let r=0;for(let e of this._nodes)e.opType==="Identity"&&this.deleteNode(r),r++}isActivation(r){switch(r.opType){case"Relu":case"Sigmoid":case"Clip":return!0;default:return!1}}fuseConvActivationNodes(){for(let r of this._nodes)if(r.opType==="Conv"){let e=this._allData[r.outputs[0]]._to;if(e.length===1&&this.isActivation(this._nodes[e[0]])){let n=this._nodes[e[0]];if(n.opType==="Clip")if(n.inputs.length===1)try{r.attributes.set("activation_params","floats",[n.attributes.getFloat("min"),n.attributes.getFloat("max")])}catch{r.attributes.set("activation_params","floats",[wu,_u])}else if(n.inputs.length>=3&&this._allData[n.inputs[1]].tensor!==void 0&&this._allData[n.inputs[2]].tensor!==void 0)r.attributes.set("activation_params","floats",[this._allData[n.inputs[1]].tensor.floatData[0],this._allData[n.inputs[2]].tensor.floatData[0]]);else continue;r.attributes.set("activation","string",n.opType),this.deleteNode(e[0])}}}}}),LP,BP,cR,Vq=R(()=>{"use strict";Rw(),jq(),kp(),LP=ml(Su()),Re(),BP=Be.experimental.fbs,cR=class{constructor(){}load(r,e,n){let t;if(!n)try{this.loadFromOnnxFormat(r,e);return}catch(i){if(n!==void 0)throw i;t=i}try{this.loadFromOrtFormat(r,e)}catch(i){throw n!==void 0?i:new Error(`Failed to load model as ONNX format: ${t}
as ORT format: ${i}`)}}loadFromOnnxFormat(r,e){let n=LP.onnx.ModelProto.decode(r);if($r.longToNumber(n.irVersion)<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=n.opsetImport.map(t=>({domain:t.domain,version:$r.longToNumber(t.version)})),this._graph=Dw.from(n.graph,e)}loadFromOrtFormat(r,e){let n=new O.ByteBuffer(r),t=BP.InferenceSession.getRootAsInferenceSession(n).model();if($r.longToNumber(t.irVersion())<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=[];for(let i=0;i<t.opsetImportLength();i++){let o=t.opsetImport(i);this._opsets.push({domain:o?.domain(),version:$r.longToNumber(o.version())})}this._graph=Dw.from(t.graph(),e)}get graph(){return this._graph}get opsets(){return this._opsets}}}),uR,$q=R(()=>{"use strict";Fq(),Lq(),Er(),Vq(),uR=class{constructor(r={}){this._initialized=!1,this.backendHint=r.backendHint,this.profiler=_M.create(r.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]}}get inputNames(){return this._model.graph.getInputNames()}get outputNames(){return this._model.graph.getOutputNames()}startProfiling(){this.profiler.start()}endProfiling(){this.profiler.stop()}loadModel(r,e,n){return F(this,null,function*(){yield this.profiler.event("session","Session.loadModel",()=>F(this,null,function*(){let t=yield sR(this.backendHint);if(this.sessionHandler=t.createSessionHandler(this.context),this._model=new cR,typeof r=="string"){let i=r.endsWith(".ort");{let o=yield(yield fetch(r)).arrayBuffer();this.initialize(new Uint8Array(o),i)}}else if(ArrayBuffer.isView(r))this.initialize(r);else{let i=new Uint8Array(r,e||0,n||r.byteLength);this.initialize(i)}}))})}initialize(r,e){if(this._initialized)throw new Error("already initialized");this.profiler.event("session","Session.initialize",()=>{let n=this.sessionHandler.transformGraph?this.sessionHandler:void 0;this._model.load(r,n,e),this.sessionHandler.onGraphInitialized&&this.sessionHandler.onGraphInitialized(this._model.graph),this.initializeOps(this._model.graph),this._executionPlan=new lR(this._model.graph,this._ops,this.profiler)}),this._initialized=!0}run(r){return F(this,null,function*(){if(!this._initialized)throw new Error("session not initialized yet");return this.profiler.event("session","Session.run",()=>F(this,null,function*(){let e=this.normalizeAndValidateInputs(r),n=yield this._executionPlan.execute(this.sessionHandler,e);return this.createOutput(n)}))})}normalizeAndValidateInputs(r){let e=this._model.graph.getInputNames();if(Array.isArray(r)){if(r.length!==e.length)throw new Error(`incorrect input array length: expected ${e.length} but got ${r.length}`)}else{if(r.size!==e.length)throw new Error(`incorrect input map size: expected ${e.length} but got ${r.size}`);let n=new Array(r.size),t=0;for(let i=0;i<e.length;++i){let o=r.get(e[i]);if(!o)throw new Error(`missing input tensor for: '${name}'`);n[t++]=o}r=n}if(!this.context.graphInputTypes||this.context.graphInputTypes.length===0||!this.context.graphInputDims||this.context.graphInputDims.length===0){let n=this._model.graph.getInputIndices(),t=this._model.graph.getValues(),i=new Array(n.length);for(let o=0;o<n.length;++o){let s=t[n[o]];i[o]=s.type.shape.dims,this.context.graphInputTypes.push(s.type.tensorType),this.context.graphInputDims.push(r[o].dims)}this.validateInputTensorDims(i,r,!0)}else this.validateInputTensorDims(this.context.graphInputDims,r,!1);return this.validateInputTensorTypes(this.context.graphInputTypes,r),r}validateInputTensorTypes(r,e){for(let n=0;n<e.length;n++){let t=r[n],i=e[n].type;if(t!==i)throw new Error(`input tensor[${n}] check failed: expected type '${t}' but got ${i}`)}}validateInputTensorDims(r,e,n){for(let t=0;t<e.length;t++){let i=r[t],o=e[t].dims;if(!this.compareTensorDims(i,o,n))throw new Error(`input tensor[${t}] check failed: expected shape '[${i.join(",")}]' but got [${o.join(",")}]`)}}compareTensorDims(r,e,n){if(r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(r[t]!==e[t]&&(!n||r[t]!==0))return!1;return!0}createOutput(r){let e=this._model.graph.getOutputNames();if(r.length!==e.length)throw new Error("expected number of outputs do not match number of generated outputs");let n=new Map;for(let t=0;t<e.length;++t)n.set(e[t],r[t]);return n}initializeOps(r){let e=r.getNodes();this._ops=new Array(e.length);for(let n=0;n<e.length;n++)this._ops[n]=this.sessionHandler.resolve(e[n],this._model.opsets,r)}}}),dR,Uq=R(()=>{"use strict";Hr(),wl(),dR=class{constructor(r){this.session=r,this.inputNames=this.session.inputNames,this.outputNames=this.session.outputNames}dispose(){return F(this,null,function*(){})}run(r,e,n){return F(this,null,function*(){let t=new Map;for(let s in r)if(Object.hasOwnProperty.call(r,s)){let l=r[s];t.set(s,new $n(l.dims,l.type,void 0,void 0,l.data))}let i=yield this.session.run(t),o={};return i.forEach((s,l)=>{o[l]=new Ft(s.type,s.data,s.dims)}),o})}startProfiling(){this.session.startProfiling()}endProfiling(){this.session.endProfiling()}}}),hR={};xu(hR,{onnxjsBackend:()=>fR});var jP,fR,Hq=R(()=>{"use strict";$q(),Uq(),jP=class{init(){return F(this,null,function*(){})}createInferenceSessionHandler(r,e){return F(this,null,function*(){let n=new uR(e);return typeof r=="string"?yield n.loadModel(r):yield n.loadModel(r),new dR(n)})}},fR=new jP}),Uw=R(()=>{"use strict"}),pR={};xu(pR,{default:()=>gR});var L0,B0,gR,zq=R(()=>{"use strict";IR(),Sl(),Bp(),L0="ort-wasm-proxy-worker",B0=globalThis.self?.name===L0,B0&&(self.onmessage=r=>{let{type:e,in:n}=r.data;try{switch(e){case"init-wasm":Hw(n.wasm).then(()=>{Yw(n).then(()=>{postMessage({type:e})},t=>{postMessage({type:e,err:t})})},t=>{postMessage({type:e,err:t})});break;case"init-ep":{let{epName:t,env:i}=n;Xw(i,t).then(()=>{postMessage({type:e})},o=>{postMessage({type:e,err:o})});break}case"copy-from":{let{buffer:t}=n,i=Mp(t);postMessage({type:e,out:i});break}case"create":{let{model:t,options:i}=n;Kw(t,i).then(o=>{postMessage({type:e,out:o})},o=>{postMessage({type:e,err:o})});break}case"release":Zw(n),postMessage({type:e});break;case"run":{let{sessionId:t,inputIndices:i,inputs:o,outputIndices:s,options:l}=n;Jw(t,i,o,s,new Array(s.length).fill(null),l).then(c=>{c.some(a=>a[3]!=="cpu")?postMessage({type:e,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:e,out:c},e_([...o,...c]))},c=>{postMessage({type:e,err:c})});break}case"end-profiling":Qw(n),postMessage({type:e});break;default:}}catch(t){postMessage({type:e,err:t})}}),gR=B0?null:r=>new Worker(r??pl,{type:"module",name:L0})}),mR={};xu(mR,{default:()=>yR});var j0,V0,yR,Gq=R(()=>{"use strict";V0=(j0=import.meta.url,function(){return F(this,arguments,function*(r={}){function e(){return _e.buffer!=Ve.buffer&&rt(),Ve}function n(){return _e.buffer!=Ve.buffer&&rt(),oe}function t(){return _e.buffer!=Ve.buffer&&rt(),yt}function i(){return _e.buffer!=Ve.buffer&&rt(),$e}function o(){return _e.buffer!=Ve.buffer&&rt(),Gt}var s,l,c=Object.assign({},r),a=new Promise((m,_)=>{s=m,l=_}),u=typeof window=="object",d=typeof importScripts=="function",h=d&&self.name=="em-pthread";c.mountExternalData=(m,_)=>{m.startsWith("./")&&(m=m.substring(2)),(c.Ua||(c.Ua=new Map)).set(m,_)},c.unmountExternalData=()=>{delete c.Ua};var f,p,g=globalThis.SharedArrayBuffer??new WebAssembly.Memory({initial:0,maximum:0,shared:!0}).buffer.constructor,y=Object.assign({},c),w="./this.program",v=(m,_)=>{throw _},x="";(u||d)&&(d?x=self.location.href:typeof document<"u"&&document.currentScript&&(x=document.currentScript.src),j0&&(x=j0),x=x.startsWith("blob:")?"":x.substr(0,x.replace(/[?#].*/,"").lastIndexOf("/")+1),d&&(p=m=>{var _=new XMLHttpRequest;return _.open("GET",m,!1),_.responseType="arraybuffer",_.send(null),new Uint8Array(_.response)}),f=(m,_,S)=>{var I=new XMLHttpRequest;I.open("GET",m,!0),I.responseType="arraybuffer",I.onload=()=>{I.status==200||I.status==0&&I.response?_(I.response):S()},I.onerror=S,I.send(null)});var A,L=console.log.bind(console),H=console.error.bind(console),q=L,$=H;if(Object.assign(c,y),y=null,h){let m=function(_){try{var S=_.data,I=S.cmd;if(I==="load"){let P=[];self.onmessage=B=>P.push(B),self.startWorker=()=>{postMessage({cmd:"loaded"});for(let B of P)m(B);self.onmessage=m};for(let B of S.handlers)c[B]&&!c[B].proxy||(c[B]=(...Z)=>{postMessage({Za:"callHandler",kb:B,args:Z})},B=="print"&&(q=c[B]),B=="printErr"&&($=c[B]));_e=S.wasmMemory,rt(),ne(S.wasmModule)}else if(I==="run"){tg(S.pthread_ptr,0,0,1,0,0),Kp(S.pthread_ptr),Hk(),__(),He||=!0;try{zk(S.start_routine,S.arg)}catch(P){if(P!="unwind")throw P}}else I==="cancel"?Fs()&&Lu(-1):S.target!=="setimmediate"&&(I==="checkMailbox"?He&&Ru():I&&($(`worker: received unknown command ${I}`),$(S)))}catch(P){throw sT(),P}};var we=m,ne,He=!1;$=function(..._){_=_.join(" "),console.error(_)},self.alert=function(..._){postMessage({Za:"alert",text:_.join(" "),nb:Fs()})},c.instantiateWasm=(_,S)=>new Promise(I=>{ne=P=>{P=new WebAssembly.Instance(P,g_()),S(P),I()}}),self.onunhandledrejection=_=>{throw _.reason||_},self.onmessage=m}c.wasmBinary&&(A=c.wasmBinary);var _e,Ee,Pe,Ve,oe,yt,$e,Ze,Gt,Je=!1;function rt(){var m=_e.buffer;c.HEAP8=Ve=new Int8Array(m),c.HEAP16=new Int16Array(m),c.HEAPU8=oe=new Uint8Array(m),c.HEAPU16=new Uint16Array(m),c.HEAP32=yt=new Int32Array(m),c.HEAPU32=$e=new Uint32Array(m),c.HEAPF32=new Float32Array(m),c.HEAPF64=Gt=new Float64Array(m),c.HEAP64=Ze=new BigInt64Array(m),c.HEAPU64=new BigUint64Array(m)}if(!h){if(!((_e=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0})).buffer instanceof g))throw $("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),Error("bad memory");rt()}var Tn=[],Bt=[],Wr=[],Qt=0,jt=null,en=null;function ar(){if(--Qt==0&&(jt!==null&&(clearInterval(jt),jt=null),en)){var m=en;en=null,m()}}function ke(m){throw $(m="Aborted("+m+")"),Je=!0,Pe=1,m=new WebAssembly.RuntimeError(m+". Build with -sASSERTIONS for more info."),l(m),m}var xt,qr=m=>m.startsWith("data:application/octet-stream;base64,"),Dl=m=>m.startsWith("file://");function Pu(m){if(m==xt&&A)return new Uint8Array(A);if(p)return p(m);throw"both async and sync fetching of the wasm failed"}function p_(m,_,S){return function(I){if(!A&&(u||d)){if(typeof fetch=="function"&&!Dl(I))return fetch(I,{credentials:"same-origin"}).then(P=>{if(!P.ok)throw`failed to load wasm binary file at '${I}'`;return P.arrayBuffer()}).catch(()=>Pu(I));if(f)return new Promise((P,B)=>{f(I,Z=>P(new Uint8Array(Z)),B)})}return Promise.resolve().then(()=>Pu(I))}(m).then(I=>WebAssembly.instantiate(I,_)).then(S,I=>{$(`failed to asynchronously prepare wasm: ${I}`),ke(I)})}function g_(){return{a:{j:Uk,b:Wk,E:D_,g:O_,V:A_,A:N_,C:R_,W:k_,T:F_,L:L_,S:B_,o:j_,B:V_,y:$_,U:U_,z:H_,_:qk,Z:Yk,P:Xk,w:Kk,F:Zk,k:Jk,O:Kp,Y:Qk,I:eF,J:tF,K:nF,G:W_,H:q_,v:rF,q:iF,l:oF,p:sF,e:aF,X:lF,x:cF,d:Y_,f:uF,i:dF,u:hF,t:fF,s:pF,Q:Z_,R:J_,D:Xp,h:Q_,n:eT,M:tT,m:nT,a:_e,r:Yp,N:oT,c:yF}}}var m_={837620:(m,_,S,I,P)=>{if(c===void 0||!c.Ua)return 1;if((m=Il(m>>>0)).startsWith("./")&&(m=m.substring(2)),!(m=c.Ua.get(m)))return 2;if(I>>>=0,(_>>>=0)+(S>>>=0)>m.byteLength)return 3;try{let B=m.subarray(_,_+S);switch(P){case 0:n().set(B,I>>>0);break;case 1:c.mb(I,B);break;default:return 4}return 0}catch{return 4}},838303:()=>typeof wasmOffsetConverter<"u"};function Uk(){return typeof wasmOffsetConverter<"u"}function Wp(m){this.name="ExitStatus",this.message=`Program terminated with exit(${m})`,this.status=m}var qp=m=>{m.terminate(),m.onmessage=()=>{}},y_=m=>{xi.length==0&&(x_(),T_(xi[0]));var _=xi.pop();if(!_)return 6;wo.push(_),Ir[m.Ra]=_,_.Ra=m.Ra;var S={cmd:"run",start_routine:m.cb,arg:m.ab,pthread_ptr:m.Ra};return _.postMessage(S,m.ib),0},Cl=0,Qe=(m,_,...S)=>{for(var I=2*S.length,P=ig(),B=rg(8*I),Z=B>>>3,Ye=0;Ye<S.length;Ye++){var Wt=S[Ye];typeof Wt=="bigint"?(Ze[Z+2*Ye]=1n,Ze[Z+2*Ye+1]=Wt):(Ze[Z+2*Ye]=0n,o()[Z+2*Ye+1>>>0]=Wt)}return m=aT(m,0,I,B,_),Bu(P),m};function Yp(m){if(h)return Qe(0,1,m);if(Pe=m,!(0<Cl)){for(var _ of wo)qp(_);for(_ of xi)qp(_);xi=[],wo=[],Ir=[],Je=!0}v(m,new Wp(m))}function v_(m){if(h)return Qe(1,0,m);Xp(m)}var Xp=m=>{if(Pe=m,h)throw v_(m),"unwind";Yp(m)},xi=[],wo=[],b_=[],Ir={},w_=m=>{var _=m.Ra;delete Ir[_],xi.push(m),wo.splice(wo.indexOf(m),1),m.Ra=0,ng(_)};function __(){b_.forEach(m=>m())}var T_=m=>new Promise(_=>{m.onmessage=P=>{var B=(P=P.data).cmd;if(P.targetThread&&P.targetThread!=Fs()){var Z=Ir[P.targetThread];Z?Z.postMessage(P,P.transferList):$(`Internal error! Worker sent a message "${B}" to target pthread ${P.targetThread}, but that thread no longer exists!`)}else B==="checkMailbox"?Ru():B==="spawnThread"?y_(P):B==="cleanupThread"?w_(Ir[P.thread]):B==="killThread"?(P=P.thread,B=Ir[P],delete Ir[P],qp(B),ng(P),wo.splice(wo.indexOf(B),1),B.Ra=0):B==="cancelThread"?Ir[P.thread].postMessage({cmd:"cancel"}):B==="loaded"?(m.loaded=!0,_(m)):B==="alert"?alert(`Thread ${P.threadId}: ${P.text}`):P.target==="setimmediate"?m.postMessage(P):B==="callHandler"?c[P.handler](...P.args):B&&$(`worker sent an unknown command ${B}`)},m.onerror=P=>{throw $(`worker sent an error! ${P.filename}:${P.lineno}: ${P.message}`),P};var S,I=[];for(S of[])c.hasOwnProperty(S)&&I.push(S);m.postMessage({cmd:"load",handlers:I,wasmMemory:_e,wasmModule:Ee})});function x_(){var m=new Worker(new URL(import.meta.url),{type:"module",workerData:"em-pthread",name:"em-pthread"});xi.push(m)}var S_,Mu=m=>{for(;0<m.length;)m.shift()(c)},Hk=()=>{var m=Fs(),_=i()[m+52>>>2>>>0];m=i()[m+56>>>2>>>0],cT(_,_-m),Bu(_)},Nu=[],zk=(m,_)=>{Cl=0;var S=Nu[m];S||(m>=Nu.length&&(Nu.length=m+1),Nu[m]=S=S_.get(m)),m=S(_),0<Cl?Pe=m:Lu(m)};class Gk{constructor(_){this.Xa=_-24}}function Wk(m,_,S){var I=new Gk(m>>>=0);throw _>>>=0,S>>>=0,i()[I.Xa+16>>>2>>>0]=0,i()[I.Xa+4>>>2>>>0]=_,i()[I.Xa+8>>>2>>>0]=S,m}function E_(m,_,S,I){return h?Qe(2,1,m,_,S,I):D_(m,_,S,I)}function D_(m,_,S,I){if(m>>>=0,_>>>=0,S>>>=0,I>>>=0,g===void 0)return $("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var P=[];return h&&P.length===0?E_(m,_,S,I):(m={cb:S,Ra:m,ab:I,ib:P},h?(m.Za="spawnThread",postMessage(m,P),0):y_(m))}var C_=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,I_=(m,_,S)=>{var I=(_>>>=0)+S;for(S=_;m[S]&&!(S>=I);)++S;if(16<S-_&&m.buffer&&C_)return C_.decode(m.buffer instanceof g?m.slice(_,S):m.subarray(_,S));for(I="";_<S;){var P=m[_++];if(128&P){var B=63&m[_++];if((224&P)==192)I+=String.fromCharCode((31&P)<<6|B);else{var Z=63&m[_++];65536>(P=(240&P)==224?(15&P)<<12|B<<6|Z:(7&P)<<18|B<<12|Z<<6|63&m[_++])?I+=String.fromCharCode(P):(P-=65536,I+=String.fromCharCode(55296|P>>10,56320|1023&P))}}else I+=String.fromCharCode(P)}return I},Il=(m,_)=>(m>>>=0)?I_(n(),m,_):"";function O_(m,_,S){return h?Qe(3,1,m,_,S):0}function A_(m,_){if(h)return Qe(4,1,m,_)}var P_=m=>{for(var _=0,S=0;S<m.length;++S){var I=m.charCodeAt(S);127>=I?_++:2047>=I?_+=2:55296<=I&&57343>=I?(_+=4,++S):_+=3}return _},M_=(m,_,S,I)=>{if(!(0<I))return 0;var P=S>>>=0;I=S+I-1;for(var B=0;B<m.length;++B){var Z=m.charCodeAt(B);if(55296<=Z&&57343>=Z&&(Z=65536+((1023&Z)<<10)|1023&m.charCodeAt(++B)),127>=Z){if(S>=I)break;_[S++>>>0]=Z}else{if(2047>=Z){if(S+1>=I)break;_[S++>>>0]=192|Z>>6}else{if(65535>=Z){if(S+2>=I)break;_[S++>>>0]=224|Z>>12}else{if(S+3>=I)break;_[S++>>>0]=240|Z>>18,_[S++>>>0]=128|Z>>12&63}_[S++>>>0]=128|Z>>6&63}_[S++>>>0]=128|63&Z}}return _[S>>>0]=0,S-P},Ol=(m,_,S)=>M_(m,n(),_,S);function N_(m,_){if(h)return Qe(5,1,m,_)}function R_(m,_,S){if(h)return Qe(6,1,m,_,S)}function k_(m,_,S){return h?Qe(7,1,m,_,S):0}function F_(m,_){if(h)return Qe(8,1,m,_)}function L_(m,_,S){if(h)return Qe(9,1,m,_,S)}function B_(m,_,S,I){if(h)return Qe(10,1,m,_,S,I)}function j_(m,_,S,I){if(h)return Qe(11,1,m,_,S,I)}function V_(m,_,S,I){if(h)return Qe(12,1,m,_,S,I)}function $_(m){if(h)return Qe(13,1,m)}function U_(m,_){if(h)return Qe(14,1,m,_)}function H_(m,_,S){if(h)return Qe(15,1,m,_,S)}var qk=()=>{ke("")},Yk=()=>1;function Xk(m){tg(m>>>0,!d,1,!u,131072,!1),__()}function Kp(m){m>>>=0,typeof Atomics.jb=="function"&&(Atomics.jb(t(),m>>>2,m).value.then(Ru),m+=128,Atomics.store(t(),m>>>2,1))}var Ru=()=>{var m=Fs();if(m&&(Kp(m),m=lT,!Je))try{if(m(),!(0<Cl))try{h?Lu(Pe):Xp(Pe)}catch(_){_ instanceof Wp||_=="unwind"||v(1,_)}}catch(_){_ instanceof Wp||_=="unwind"||v(1,_)}};function Kk(m,_){(m>>>=0)==_>>>0?setTimeout(Ru):h?postMessage({targetThread:m,cmd:"checkMailbox"}):(m=Ir[m])&&m.postMessage({cmd:"checkMailbox"})}var Zp=[];function Zk(m,_,S,I,P){for(_>>>=0,I/=2,Zp.length=I,S=P>>>0>>>3,P=0;P<I;P++)Zp[P]=Ze[S+2*P]?Ze[S+2*P+1]:o()[S+2*P+1>>>0];return(_?m_[_]:vF[m])(...Zp)}function Jk(m){m>>>=0,h?postMessage({cmd:"cleanupThread",thread:m}):w_(Ir[m])}function Qk(m){}function eF(m,_){m=-9007199254740992>m||9007199254740992<m?NaN:Number(m),_>>>=0,m=new Date(1e3*m),t()[_>>>2>>>0]=m.getUTCSeconds(),t()[_+4>>>2>>>0]=m.getUTCMinutes(),t()[_+8>>>2>>>0]=m.getUTCHours(),t()[_+12>>>2>>>0]=m.getUTCDate(),t()[_+16>>>2>>>0]=m.getUTCMonth(),t()[_+20>>>2>>>0]=m.getUTCFullYear()-1900,t()[_+24>>>2>>>0]=m.getUTCDay(),m=(m.getTime()-Date.UTC(m.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,t()[_+28>>>2>>>0]=m}var Rs=m=>m%4==0&&(m%100!=0||m%400==0),z_=[0,31,60,91,121,152,182,213,244,274,305,335],G_=[0,31,59,90,120,151,181,212,243,273,304,334];function tF(m,_){m=-9007199254740992>m||9007199254740992<m?NaN:Number(m),_>>>=0,m=new Date(1e3*m),t()[_>>>2>>>0]=m.getSeconds(),t()[_+4>>>2>>>0]=m.getMinutes(),t()[_+8>>>2>>>0]=m.getHours(),t()[_+12>>>2>>>0]=m.getDate(),t()[_+16>>>2>>>0]=m.getMonth(),t()[_+20>>>2>>>0]=m.getFullYear()-1900,t()[_+24>>>2>>>0]=m.getDay();var S=(Rs(m.getFullYear())?z_:G_)[m.getMonth()]+m.getDate()-1|0;t()[_+28>>>2>>>0]=S,t()[_+36>>>2>>>0]=-60*m.getTimezoneOffset(),S=new Date(m.getFullYear(),6,1).getTimezoneOffset();var I=new Date(m.getFullYear(),0,1).getTimezoneOffset();m=0|(S!=I&&m.getTimezoneOffset()==Math.min(I,S)),t()[_+32>>>2>>>0]=m}function nF(m){m>>>=0;var _=new Date(t()[m+20>>>2>>>0]+1900,t()[m+16>>>2>>>0],t()[m+12>>>2>>>0],t()[m+8>>>2>>>0],t()[m+4>>>2>>>0],t()[m>>>2>>>0],0),S=t()[m+32>>>2>>>0],I=_.getTimezoneOffset(),P=new Date(_.getFullYear(),6,1).getTimezoneOffset(),B=new Date(_.getFullYear(),0,1).getTimezoneOffset(),Z=Math.min(B,P);return 0>S?t()[m+32>>>2>>>0]=+(P!=B&&Z==I):0<S!=(Z==I)&&(P=Math.max(B,P),_.setTime(_.getTime()+6e4*((0<S?Z:P)-I))),t()[m+24>>>2>>>0]=_.getDay(),S=(Rs(_.getFullYear())?z_:G_)[_.getMonth()]+_.getDate()-1|0,t()[m+28>>>2>>>0]=S,t()[m>>>2>>>0]=_.getSeconds(),t()[m+4>>>2>>>0]=_.getMinutes(),t()[m+8>>>2>>>0]=_.getHours(),t()[m+12>>>2>>>0]=_.getDate(),t()[m+16>>>2>>>0]=_.getMonth(),t()[m+20>>>2>>>0]=_.getYear(),m=_.getTime(),BigInt(isNaN(m)?-1:m/1e3)}function W_(m,_,S,I,P,B,Z){return h?Qe(16,1,m,_,S,I,P,B,Z):-52}function q_(m,_,S,I,P,B){if(h)return Qe(17,1,m,_,S,I,P,B)}function rF(m,_,S,I){m>>>=0,_>>>=0,S>>>=0,I>>>=0;var P=new Date().getFullYear(),B=new Date(P,0,1),Z=new Date(P,6,1);P=B.getTimezoneOffset();var Ye=Z.getTimezoneOffset(),Wt=Math.max(P,Ye);i()[m>>>2>>>0]=60*Wt,t()[_>>>2>>>0]=+(P!=Ye),B=(m=tn=>tn.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1])(B),Z=m(Z),Ye<P?(Ol(B,S,17),Ol(Z,I,17)):(Ol(B,I,17),Ol(Z,S,17))}var Jp=[];function iF(m,_,S){m>>>=0,_>>>=0,S>>>=0,Jp.length=0;for(var I;I=n()[_++>>>0];){var P=I!=105;S+=(P&=I!=112)&&S%8?4:0,Jp.push(I==112?i()[S>>>2>>>0]:I==106?Ze[S>>>3]:I==105?t()[S>>>2>>>0]:o()[S>>>3>>>0]),S+=P?8:4}return m_[m](...Jp)}var oF=()=>{},sF=()=>Date.now();function aF(m,_){return $(Il(m>>>0,_>>>0))}var Y_,lF=()=>{throw Cl+=1,"unwind"};function cF(){return 4294901760}Y_=()=>performance.timeOrigin+performance.now();var uF=()=>navigator.hardwareConcurrency;function dF(){return ke("Cannot use emscripten_pc_get_function without -sUSE_OFFSET_CONVERTER"),0}function hF(m){m>>>=0;var _=n().length;if(m<=_||4294901760<m)return!1;for(var S=1;4>=S;S*=2){var I=_*(1+.2/S);I=Math.min(I,m+100663296);var P=Math;I=Math.max(m,I);e:{P=(P.min.call(P,4294901760,I+(65536-I%65536)%65536)-_e.buffer.byteLength+65535)/65536;try{_e.grow(P),rt();var B=1;break e}catch{}B=void 0}if(B)return!0}return!1}var ku=()=>(ke("Cannot use convertFrameToPC (needed by __builtin_return_address) without -sUSE_OFFSET_CONVERTER"),0),ks={},X_=m=>{m.forEach(_=>{var S=ku();S&&(ks[S]=_)})};function fF(){var m=Error().stack.toString().split(`
`);return m[0]=="Error"&&m.shift(),X_(m),ks.$a=ku(),ks.bb=m,ks.$a}function pF(m,_,S){if(m>>>=0,_>>>=0,ks.$a==m)var I=ks.bb;else(I=Error().stack.toString().split(`
`))[0]=="Error"&&I.shift(),X_(I);for(var P=3;I[P]&&ku()!=m;)++P;for(m=0;m<S&&I[m+P];++m)t()[_+4*m>>>2>>>0]=ku();return m}var Qp,eg={},K_=()=>{if(!Qp){var m,_={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:w||"./this.program"};for(m in eg)eg[m]===void 0?delete _[m]:_[m]=eg[m];var S=[];for(m in _)S.push(`${m}=${_[m]}`);Qp=S}return Qp};function Z_(m,_){if(h)return Qe(18,1,m,_);m>>>=0,_>>>=0;var S=0;return K_().forEach((I,P)=>{var B=_+S;for(P=i()[m+4*P>>>2>>>0]=B,B=0;B<I.length;++B)e()[P++>>>0]=I.charCodeAt(B);e()[P>>>0]=0,S+=I.length+1}),0}function J_(m,_){if(h)return Qe(19,1,m,_);m>>>=0,_>>>=0;var S=K_();i()[m>>>2>>>0]=S.length;var I=0;return S.forEach(P=>I+=P.length+1),i()[_>>>2>>>0]=I,0}function Q_(m){return h?Qe(20,1,m):52}function eT(m,_,S,I){return h?Qe(21,1,m,_,S,I):52}function tT(m,_,S,I){return h?Qe(22,1,m,_,S,I):70}var gF=[null,[],[]];function nT(m,_,S,I){if(h)return Qe(23,1,m,_,S,I);_>>>=0,S>>>=0,I>>>=0;for(var P=0,B=0;B<S;B++){var Z=i()[_>>>2>>>0],Ye=i()[_+4>>>2>>>0];_+=8;for(var Wt=0;Wt<Ye;Wt++){var tn=n()[Z+Wt>>>0],fn=gF[m];tn===0||tn===10?((m===1?q:$)(I_(fn,0)),fn.length=0):fn.push(tn)}P+=Ye}return i()[I>>>2>>>0]=P,0}var rT=[31,29,31,30,31,30,31,31,30,31,30,31],iT=[31,28,31,30,31,30,31,31,30,31,30,31],mF=(m,_)=>{e().set(m,_>>>0)};function oT(m,_,S,I){function P(N,Ne,ft){for(N=typeof N=="number"?N.toString():N||"";N.length<Ne;)N=ft[0]+N;return N}function B(N,Ne){return P(N,Ne,"0")}function Z(N,Ne){function ft(fT){return 0>fT?-1:0<fT?1:0}var _o;return(_o=ft(N.getFullYear()-Ne.getFullYear()))===0&&(_o=ft(N.getMonth()-Ne.getMonth()))===0&&(_o=ft(N.getDate()-Ne.getDate())),_o}function Ye(N){switch(N.getDay()){case 0:return new Date(N.getFullYear()-1,11,29);case 1:return N;case 2:return new Date(N.getFullYear(),0,3);case 3:return new Date(N.getFullYear(),0,2);case 4:return new Date(N.getFullYear(),0,1);case 5:return new Date(N.getFullYear()-1,11,31);case 6:return new Date(N.getFullYear()-1,11,30)}}function Wt(N){var Ne=N.Sa;for(N=new Date(new Date(N.Ta+1900,0,1).getTime());0<Ne;){var ft=N.getMonth(),_o=(Rs(N.getFullYear())?rT:iT)[ft];if(!(Ne>_o-N.getDate())){N.setDate(N.getDate()+Ne);break}Ne-=_o-N.getDate()+1,N.setDate(1),11>ft?N.setMonth(ft+1):(N.setMonth(0),N.setFullYear(N.getFullYear()+1))}return ft=new Date(N.getFullYear()+1,0,4),Ne=Ye(new Date(N.getFullYear(),0,4)),ft=Ye(ft),0>=Z(Ne,N)?0>=Z(ft,N)?N.getFullYear()+1:N.getFullYear():N.getFullYear()-1}m>>>=0,_>>>=0,S>>>=0,I>>>=0;var tn=i()[I+40>>>2>>>0];for(var fn in I={gb:t()[I>>>2>>>0],fb:t()[I+4>>>2>>>0],Va:t()[I+8>>>2>>>0],Ya:t()[I+12>>>2>>>0],Wa:t()[I+16>>>2>>>0],Ta:t()[I+20>>>2>>>0],Qa:t()[I+24>>>2>>>0],Sa:t()[I+28>>>2>>>0],ob:t()[I+32>>>2>>>0],eb:t()[I+36>>>2>>>0],hb:tn?Il(tn):""},S=Il(S),tn={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})S=S.replace(new RegExp(fn,"g"),tn[fn]);var dT="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),hT="January February March April May June July August September October November December".split(" ");for(fn in tn={"%a":N=>dT[N.Qa].substring(0,3),"%A":N=>dT[N.Qa],"%b":N=>hT[N.Wa].substring(0,3),"%B":N=>hT[N.Wa],"%C":N=>B((N.Ta+1900)/100|0,2),"%d":N=>B(N.Ya,2),"%e":N=>P(N.Ya,2," "),"%g":N=>Wt(N).toString().substring(2),"%G":Wt,"%H":N=>B(N.Va,2),"%I":N=>((N=N.Va)==0?N=12:12<N&&(N-=12),B(N,2)),"%j":N=>{for(var Ne=0,ft=0;ft<=N.Wa-1;Ne+=(Rs(N.Ta+1900)?rT:iT)[ft++]);return B(N.Ya+Ne,3)},"%m":N=>B(N.Wa+1,2),"%M":N=>B(N.fb,2),"%n":()=>`
`,"%p":N=>0<=N.Va&&12>N.Va?"AM":"PM","%S":N=>B(N.gb,2),"%t":()=>"	","%u":N=>N.Qa||7,"%U":N=>B(Math.floor((N.Sa+7-N.Qa)/7),2),"%V":N=>{var Ne=Math.floor((N.Sa+7-(N.Qa+6)%7)/7);if(2>=(N.Qa+371-N.Sa-2)%7&&Ne++,Ne)Ne==53&&((ft=(N.Qa+371-N.Sa)%7)==4||ft==3&&Rs(N.Ta)||(Ne=1));else{Ne=52;var ft=(N.Qa+7-N.Sa-1)%7;(ft==4||ft==5&&Rs(N.Ta%400-1))&&Ne++}return B(Ne,2)},"%w":N=>N.Qa,"%W":N=>B(Math.floor((N.Sa+7-(N.Qa+6)%7)/7),2),"%y":N=>(N.Ta+1900).toString().substring(2),"%Y":N=>N.Ta+1900,"%z":N=>{var Ne=0<=(N=N.eb);return N=Math.abs(N)/60,(Ne?"+":"-")+("0000"+(N/60*100+N%60)).slice(-4)},"%Z":N=>N.hb,"%%":()=>"%"},S=S.replace(/%%/g,"\0\0"),tn)S.includes(fn)&&(S=S.replace(new RegExp(fn,"g"),tn[fn](I)));return fn=function(N){var Ne=Array(P_(N)+1);return M_(N,Ne,0,Ne.length),Ne}(S=S.replace(/\0\0/g,"%")),fn.length>_?0:(mF(fn,m),fn.length-1)}function yF(m,_,S,I){return oT(m>>>0,_>>>0,S>>>0,I>>>0)}h||function(){for(var m=c.numThreads-1;m--;)x_();Tn.unshift(()=>{Qt++,function(_){h?_():Promise.all(xi.map(T_)).then(_)}(()=>ar())})}();var vF=[Yp,v_,E_,O_,A_,N_,R_,k_,F_,L_,B_,j_,V_,$_,U_,H_,W_,q_,Z_,J_,Q_,eT,tT,nT],re=function(){function m(S,I){return re=S.exports,re=function(){var P=re,B=Ye=>()=>Ye()>>>0,Z=Ye=>Wt=>Ye(Wt)>>>0;return(P=Object.assign({},P)).Ba=B(P.Ba),P.Ca=Z(P.Ca),P.emscripten_main_runtime_thread_id=B(P.emscripten_main_runtime_thread_id),P.Oa=Z(P.Oa),P.Pa=B(P.Pa),P}(),b_.push(re.Ea),S_=re.Fa,Bt.unshift(re.$),Ee=I,ar(),re}var _=g_();if(Qt++,c.instantiateWasm)try{return c.instantiateWasm(_,m)}catch(S){$(`Module.instantiateWasm callback failed with error: ${S}`),l(S)}return xt||=c.locateFile?qr("ort-wasm-simd-threaded.wasm")?"ort-wasm-simd-threaded.wasm":c.locateFile?c.locateFile("ort-wasm-simd-threaded.wasm",x):x+"ort-wasm-simd-threaded.wasm":new URL("ort-wasm-simd-threaded.wasm",import.meta.url).href,function(S,I){var P=xt;return A||typeof WebAssembly.instantiateStreaming!="function"||qr(P)||Dl(P)||typeof fetch!="function"?p_(P,S,I):fetch(P,{credentials:"same-origin"}).then(B=>WebAssembly.instantiateStreaming(B,S).then(I,function(Z){return $(`wasm streaming compile failed: ${Z}`),$("falling back to ArrayBuffer instantiation"),p_(P,S,I)}))}(_,function(S){m(S.instance,S.module)}).catch(l),{}}();c._OrtInit=(m,_)=>(c._OrtInit=re.aa)(m,_),c._OrtGetLastError=(m,_)=>(c._OrtGetLastError=re.ba)(m,_),c._OrtCreateSessionOptions=(m,_,S,I,P,B,Z,Ye,Wt,tn)=>(c._OrtCreateSessionOptions=re.ca)(m,_,S,I,P,B,Z,Ye,Wt,tn),c._OrtAppendExecutionProvider=(m,_)=>(c._OrtAppendExecutionProvider=re.da)(m,_),c._OrtAddFreeDimensionOverride=(m,_,S)=>(c._OrtAddFreeDimensionOverride=re.ea)(m,_,S),c._OrtAddSessionConfigEntry=(m,_,S)=>(c._OrtAddSessionConfigEntry=re.fa)(m,_,S),c._OrtReleaseSessionOptions=m=>(c._OrtReleaseSessionOptions=re.ga)(m),c._OrtCreateSession=(m,_,S)=>(c._OrtCreateSession=re.ha)(m,_,S),c._OrtReleaseSession=m=>(c._OrtReleaseSession=re.ia)(m),c._OrtGetInputOutputCount=(m,_,S)=>(c._OrtGetInputOutputCount=re.ja)(m,_,S),c._OrtGetInputName=(m,_)=>(c._OrtGetInputName=re.ka)(m,_),c._OrtGetOutputName=(m,_)=>(c._OrtGetOutputName=re.la)(m,_),c._OrtFree=m=>(c._OrtFree=re.ma)(m),c._OrtCreateTensor=(m,_,S,I,P,B)=>(c._OrtCreateTensor=re.na)(m,_,S,I,P,B),c._OrtGetTensorData=(m,_,S,I,P)=>(c._OrtGetTensorData=re.oa)(m,_,S,I,P),c._OrtReleaseTensor=m=>(c._OrtReleaseTensor=re.pa)(m),c._OrtCreateRunOptions=(m,_,S,I)=>(c._OrtCreateRunOptions=re.qa)(m,_,S,I),c._OrtAddRunConfigEntry=(m,_,S)=>(c._OrtAddRunConfigEntry=re.ra)(m,_,S),c._OrtReleaseRunOptions=m=>(c._OrtReleaseRunOptions=re.sa)(m),c._OrtCreateBinding=m=>(c._OrtCreateBinding=re.ta)(m),c._OrtBindInput=(m,_,S)=>(c._OrtBindInput=re.ua)(m,_,S),c._OrtBindOutput=(m,_,S,I)=>(c._OrtBindOutput=re.va)(m,_,S,I),c._OrtClearBoundOutputs=m=>(c._OrtClearBoundOutputs=re.wa)(m),c._OrtReleaseBinding=m=>(c._OrtReleaseBinding=re.xa)(m),c._OrtRunWithBinding=(m,_,S,I,P)=>(c._OrtRunWithBinding=re.ya)(m,_,S,I,P),c._OrtRun=(m,_,S,I,P,B,Z,Ye)=>(c._OrtRun=re.za)(m,_,S,I,P,B,Z,Ye),c._OrtEndProfiling=m=>(c._OrtEndProfiling=re.Aa)(m);var Fs=()=>(Fs=re.Ba)();c._malloc=m=>(c._malloc=re.Ca)(m),c._free=m=>(c._free=re.Da)(m);var Fu,tg=(m,_,S,I,P,B)=>(tg=re.Ga)(m,_,S,I,P,B),sT=()=>(sT=re.Ha)(),aT=(m,_,S,I,P)=>(aT=re.Ia)(m,_,S,I,P),ng=m=>(ng=re.Ja)(m),Lu=m=>(Lu=re.Ka)(m),lT=()=>(lT=re.La)(),cT=(m,_)=>(cT=re.Ma)(m,_),Bu=m=>(Bu=re.Na)(m),rg=m=>(rg=re.Oa)(m),ig=()=>(ig=re.Pa)();function uT(){0<Qt||(h?(s(c),h||Mu(Bt),startWorker(c)):(Mu(Tn),0<Qt||Fu||(Fu=!0,c.calledRun=!0,Je||(h||Mu(Bt),s(c),h||Mu(Wr)))))}return c.___start_em_js=838360,c.___stop_em_js=838421,c.stackSave=()=>ig(),c.stackRestore=m=>Bu(m),c.stackAlloc=m=>rg(m),c.UTF8ToString=Il,c.stringToUTF8=Ol,c.lengthBytesUTF8=P_,en=function m(){Fu||uT(),Fu||(en=m)},uT(),a})}),yR=V0,globalThis.self?.name==="em-pthread"&&V0()}),pl,VP,$P,UP,$0,vR,HP,bR,Bp=R(()=>{"use strict";Uw(),pl=import.meta.url??(typeof document<"u"?document.currentScript?.src:typeof self<"u"?self.location?.href:void 0),VP=typeof location>"u"?void 0:location.origin,$P=(r,e)=>{try{let n=e??pl;return(n?new URL(r,n):new URL(r)).origin===VP}catch{return!1}},UP=r=>F(void 0,null,function*(){let e=yield(yield fetch(r,{credentials:"same-origin"})).blob();return URL.createObjectURL(e)}),$0=(zq(),Dp(pR)).default,vR=()=>F(void 0,null,function*(){if(!pl)throw new Error("Failed to load proxy worker: cannot determine the script source URL.");if($P(pl))return[void 0,$0()];let r=yield UP(pl);return[r,$0(r)]}),HP=(Gq(),Dp(mR)).default,bR=(r,e,n)=>F(void 0,null,function*(){return[void 0,HP]})}),U0,_p,ru,H0,zP,GP,Hw,Jt,Sl=R(()=>{"use strict";Bp(),_p=!1,ru=!1,H0=!1,zP=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},GP=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},Hw=r=>F(void 0,null,function*(){if(_p)return Promise.resolve();if(ru)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(H0)throw new Error("previous call to 'initializeWebAssembly()' failed.");ru=!0;let e=r.initTimeout,n=r.numThreads;if(!GP())throw new Error("WebAssembly SIMD is not supported in the current environment.");let t=zP();n>1&&!t&&(typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+n+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),r.numThreads=n=1);let i=r.wasmPaths,o=typeof i=="string"?i:void 0,s=i?.mjs,l=s?.href??s,c=i?.wasm,a=c?.href??c,u=r.wasmBinary,[d,h]=yield bR(l,o,n>1),f=!1,p=[];if(e>0&&p.push(new Promise(g=>{setTimeout(()=>{f=!0,g()},e)})),p.push(new Promise((g,y)=>{let w={numThreads:n};u?w.wasmBinary=u:(a||o)&&(w.locateFile=(v,x)=>a??(o??x)+v),h(w).then(v=>{ru=!1,_p=!0,U0=v,g(),d&&URL.revokeObjectURL(d)},v=>{ru=!1,H0=!0,y(v)})})),yield Promise.race(p),f)throw new Error(`WebAssembly backend initializing failed due to timeout: ${e}ms`)}),Jt=()=>{if(_p&&U0)return U0;throw new Error("WebAssembly is not initialized yet.")}}),Ht,Pp,At,zw=R(()=>{"use strict";Sl(),Ht=(r,e)=>{let n=Jt(),t=n.lengthBytesUTF8(r)+1,i=n._malloc(t);return n.stringToUTF8(r,i,t),e.push(i),i},Pp=(r,e,n,t)=>{if(typeof r=="object"&&r!==null){if(n.has(r))throw new Error("Circular reference in options");n.add(r)}Object.entries(r).forEach(([i,o])=>{let s=e?e+i:i;if(typeof o=="object")Pp(o,s+".",n,t);else if(typeof o=="string"||typeof o=="number")t(s,o.toString());else if(typeof o=="boolean")t(s,o?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof o}`)})},At=r=>{let e=Jt(),n=e.stackSave();try{let t=e.stackAlloc(8);e._OrtGetLastError(t,t+4);let i=e.HEAP32[t/4],o=e.HEAPU32[t/4+1],s=o?e.UTF8ToString(o):"";throw new Error(`${r} ERROR_CODE: ${i}, ERROR_MESSAGE: ${s}`)}finally{e.stackRestore(n)}}}),wR,Wq=R(()=>{"use strict";Sl(),zw(),wR=r=>{let e=Jt(),n=0,t=[],i=r||{};try{if(r?.logSeverityLevel===void 0)i.logSeverityLevel=2;else if(typeof r.logSeverityLevel!="number"||!Number.isInteger(r.logSeverityLevel)||r.logSeverityLevel<0||r.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${r.logSeverityLevel}`);if(r?.logVerbosityLevel===void 0)i.logVerbosityLevel=0;else if(typeof r.logVerbosityLevel!="number"||!Number.isInteger(r.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${r.logVerbosityLevel}`);r?.terminate===void 0&&(i.terminate=!1);let o=0;return r?.tag!==void 0&&(o=Ht(r.tag,t)),n=e._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,o),n===0&&At("Can't create run options."),r?.extra!==void 0&&Pp(r.extra,"",new WeakSet,(s,l)=>{let c=Ht(s,t),a=Ht(l,t);e._OrtAddRunConfigEntry(n,c,a)!==0&&At(`Can't set a run config entry: ${s} - ${l}.`)}),[n,t]}catch(o){throw n!==0&&e._OrtReleaseRunOptions(n),t.forEach(s=>e._free(s)),o}}}),WP,qP,YP,XP,_R,qq=R(()=>{"use strict";Sl(),zw(),WP=r=>{switch(r){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${r}`)}},qP=r=>{switch(r){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${r}`)}},YP=r=>{r.extra||(r.extra={}),r.extra.session||(r.extra.session={});let e=r.extra.session;e.use_ort_model_bytes_directly||(e.use_ort_model_bytes_directly="1"),r.executionProviders&&r.executionProviders.some(n=>(typeof n=="string"?n:n.name)==="webgpu")&&(r.enableMemPattern=!1)},XP=(r,e,n)=>{for(let t of e){let i=typeof t=="string"?t:t.name;switch(i){case"webnn":if(i="WEBNN",typeof t!="string"){let s=t?.deviceType;if(s){let l=Ht("deviceType",n),c=Ht(s,n);Jt()._OrtAddSessionConfigEntry(r,l,c)!==0&&At(`Can't set a session config entry: 'deviceType' - ${s}.`)}}break;case"webgpu":if(i="JS",typeof t!="string"){let s=t;if(s?.preferredLayout){if(s.preferredLayout!=="NCHW"&&s.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${s.preferredLayout}`);let l=Ht("preferredLayout",n),c=Ht(s.preferredLayout,n);Jt()._OrtAddSessionConfigEntry(r,l,c)!==0&&At(`Can't set a session config entry: 'preferredLayout' - ${s.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${i}`)}let o=Ht(i,n);Jt()._OrtAppendExecutionProvider(r,o)!==0&&At(`Can't append execution provider: ${i}.`)}},_R=r=>{let e=Jt(),n=0,t=[],i=r||{};YP(i);try{let o=WP(i.graphOptimizationLevel??"all"),s=qP(i.executionMode??"sequential"),l=typeof i.logId=="string"?Ht(i.logId,t):0,c=i.logSeverityLevel??2;if(!Number.isInteger(c)||c<0||c>4)throw new Error(`log serverity level is not valid: ${c}`);let a=i.logVerbosityLevel??0;if(!Number.isInteger(a)||a<0||a>4)throw new Error(`log verbosity level is not valid: ${a}`);let u=typeof i.optimizedModelFilePath=="string"?Ht(i.optimizedModelFilePath,t):0;if(n=e._OrtCreateSessionOptions(o,!!i.enableCpuMemArena,!!i.enableMemPattern,s,!!i.enableProfiling,0,l,c,a,u),n===0&&At("Can't create session options."),i.executionProviders&&XP(n,i.executionProviders,t),i.enableGraphCapture!==void 0){if(typeof i.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${i.enableGraphCapture}`);let d=Ht("enableGraphCapture",t),h=Ht(i.enableGraphCapture.toString(),t);e._OrtAddSessionConfigEntry(n,d,h)!==0&&At(`Can't set a session config entry: 'enableGraphCapture' - ${i.enableGraphCapture}.`)}if(i.freeDimensionOverrides)for(let[d,h]of Object.entries(i.freeDimensionOverrides)){if(typeof d!="string")throw new Error(`free dimension override name must be a string: ${d}`);if(typeof h!="number"||!Number.isInteger(h)||h<0)throw new Error(`free dimension override value must be a non-negative integer: ${h}`);let f=Ht(d,t);e._OrtAddFreeDimensionOverride(n,f,h)!==0&&At(`Can't set a free dimension override: ${d} - ${h}.`)}return i.extra!==void 0&&Pp(i.extra,"",new WeakSet,(d,h)=>{let f=Ht(d,t),p=Ht(h,t);e._OrtAddSessionConfigEntry(n,f,p)!==0&&At(`Can't set a session config entry: ${d} - ${h}.`)}),[n,t]}catch(o){throw n!==0&&e._OrtReleaseSessionOptions(n),t.forEach(s=>e._free(s)),o}}}),fu,TR,pu,xR,SR,Gw,Ww,ER,DR=R(()=>{"use strict";fu=r=>{switch(r){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw new Error(`unsupported data type: ${r}`)}},TR=r=>{switch(r){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw new Error(`unsupported data type: ${r}`)}},pu=(r,e)=>{let n=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][r],t=typeof e=="number"?e:e.reduce((i,o)=>i*o,1);return n>0?Math.ceil(t*n):void 0},xR=r=>{switch(r){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${r}`)}},SR=r=>{switch(r){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${r}`)}},Gw=r=>r==="float32"||r==="float16"||r==="int32"||r==="int64"||r==="uint32"||r==="uint8"||r==="bool"||r==="uint4"||r==="int4",Ww=r=>r==="float32"||r==="float16"||r==="int32"||r==="int64"||r==="uint32"||r==="uint64"||r==="int8"||r==="uint8"||r==="bool",ER=r=>{switch(r){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw new Error(`unsupported data location: ${r}`)}}}),qw,CR=R(()=>{"use strict";Uw(),qw=r=>F(void 0,null,function*(){if(typeof r=="string")if(0)try{}catch(o){if(o.code==="ERR_FS_FILE_TOO_LARGE")try{for(var e=mne(l),n,t,i;n=!(t=yield e.next()).done;n=!1){let a=t.value;;}}catch(t){i=[t]}finally{try{n&&(t=e.return)&&(yield t.call(e))}finally{if(i)throw i[0]}}}else{let o=yield fetch(r);if(!o.ok)throw new Error(`failed to load external data file: ${r}`);let s=o.headers.get("Content-Length"),l=s?parseInt(s,10):0;if(l<1073741824)return new Uint8Array(yield o.arrayBuffer());{if(!o.body)throw new Error(`failed to load external data file: ${r}, no response body.`);let c=o.body.getReader(),a;try{a=new ArrayBuffer(l)}catch(d){if(d instanceof RangeError){let h=Math.ceil(l/65536);a=new WebAssembly.Memory({initial:h,maximum:h}).buffer}else throw d}let u=0;for(;;){let{done:d,value:h}=yield c.read();if(d)break;let f=h.byteLength;new Uint8Array(a,u,f).set(h),u+=f}return new Uint8Array(a,0,l)}}else return r instanceof Blob?new Uint8Array(yield r.arrayBuffer()):r instanceof Uint8Array?r:new Uint8Array(r)})}),KP,Yw,Xw,Ss,ZP,Mp,Kw,Zw,z0,Jw,Qw,e_,IR=R(()=>{"use strict";Wq(),qq(),DR(),Sl(),zw(),CR(),KP=(r,e)=>{Jt()._OrtInit(r,e)!==0&&At("Can't initialize onnxruntime.")},Yw=r=>F(void 0,null,function*(){KP(r.wasm.numThreads,SR(r.logLevel))}),Xw=(r,e)=>F(void 0,null,function*(){}),Ss=new Map,ZP=r=>{let e=Jt(),n=e.stackSave();try{let t=e.stackAlloc(8);return e._OrtGetInputOutputCount(r,t,t+4)!==0&&At("Can't get session input/output count."),[e.HEAP32[t/4],e.HEAP32[t/4+1]]}finally{e.stackRestore(n)}},Mp=r=>{let e=Jt(),n=e._malloc(r.byteLength);if(n===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${r.byteLength}.`);return e.HEAPU8.set(r,n),[n,r.byteLength]},Kw=(r,e)=>F(void 0,null,function*(){let n,t,i=Jt();Array.isArray(r)?[n,t]=r:r.buffer===i.HEAPU8.buffer?[n,t]=[r.byteOffset,r.byteLength]:[n,t]=Mp(r);let o=0,s=0,l=0,c=[],a=[],u=[];try{if([s,c]=_R(e),e?.externalData&&i.mountExternalData){let v=[];for(let x of e.externalData){let A=typeof x=="string"?x:x.path;v.push(qw(typeof x=="string"?x:x.data).then(L=>{i.mountExternalData(A,L)}))}yield Promise.all(v)}for(let v of e?.executionProviders??[])if((typeof v=="string"?v:v.name)==="webnn"){if(i.shouldTransferToMLTensor=!1,i.currentContext)throw new Error("WebNN execution provider is already set.");if(typeof v!="string"){let x=v,A=x?.context,L=x?.gpuDevice,H=x?.deviceType,q=x?.numThreads,$=x?.powerPreference;A?i.currentContext=A:L?i.currentContext=yield navigator.ml.createContext(L):i.currentContext=yield navigator.ml.createContext({deviceType:H,numThreads:q,powerPreference:$})}else i.currentContext=yield navigator.ml.createContext();break}o=yield i._OrtCreateSession(n,t,s),o===0&&At("Can't create a session."),i.currentContext&&(i.jsepRegisterMLContext(o,i.currentContext),i.currentContext=void 0,i.shouldTransferToMLTensor=!0);let[d,h]=ZP(o),f=!!e?.enableGraphCapture,p=[],g=[],y=[];for(let v=0;v<d;v++){let x=i._OrtGetInputName(o,v);x===0&&At("Can't get an input name."),a.push(x),p.push(i.UTF8ToString(x))}for(let v=0;v<h;v++){let x=i._OrtGetOutputName(o,v);x===0&&At("Can't get an output name."),u.push(x);let A=i.UTF8ToString(x);g.push(A)}return Ss.set(o,[o,a,u,null,f,!1]),[o,p,g]}catch(d){throw a.forEach(h=>i._OrtFree(h)),u.forEach(h=>i._OrtFree(h)),l!==0&&i._OrtReleaseBinding(l),o!==0&&i._OrtReleaseSession(o),d}finally{i._free(n),s!==0&&i._OrtReleaseSessionOptions(s),c.forEach(d=>i._free(d)),i.unmountExternalData?.()}}),Zw=r=>{let e=Jt(),n=Ss.get(r);if(!n)throw new Error(`cannot release session. invalid session id: ${r}`);let[t,i,o,s,l]=n;s&&(l&&e._OrtClearBoundOutputs(s.handle),e._OrtReleaseBinding(s.handle)),e.jsepOnReleaseSession?.(r),i.forEach(c=>e._OrtFree(c)),o.forEach(c=>e._OrtFree(c)),e._OrtReleaseSession(t),Ss.delete(r)},z0=(r,e,n,t,i,o=!1)=>{if(!r){e.push(0);return}let s=Jt(),l=r[0],c=r[1],a=r[3],u,d;if(l==="string"&&(a==="gpu-buffer"||a==="ml-tensor"))throw new Error("String tensor is not supported on GPU.");if(o&&a!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${i} when enableGraphCapture is true.`);if(a==="gpu-buffer"){let p=r[2].gpuBuffer;d=pu(fu(l),c);let g=s.jsepRegisterBuffer;if(!g)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');u=g(t,i,p,d)}else if(a==="ml-tensor"){let p=r[2].mlTensor;d=pu(fu(l),c);let g=s.jsepRegisterMLTensor;if(!g)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');u=g(p,fu(l),c)}else{let p=r[2];if(Array.isArray(p)){d=4*p.length,u=s._malloc(d),n.push(u);let g=u/4;for(let y=0;y<p.length;y++){if(typeof p[y]!="string")throw new TypeError(`tensor data at index ${y} is not a string`);s.HEAPU32[g++]=Ht(p[y],n)}}else d=p.byteLength,u=s._malloc(d),n.push(u),s.HEAPU8.set(new Uint8Array(p.buffer,p.byteOffset,d),u)}let h=s.stackSave(),f=s.stackAlloc(4*c.length);try{let p=f/4;c.forEach(y=>s.HEAP32[p++]=y);let g=s._OrtCreateTensor(fu(l),u,d,f,c.length,ER(a));g===0&&At(`Can't create tensor for input/output. session=${t}, index=${i}.`),e.push(g)}finally{s.stackRestore(h)}},Jw=(r,e,n,t,i,o)=>F(void 0,null,function*(){let s=Jt(),l=Ss.get(r);if(!l)throw new Error(`cannot run inference. invalid session id: ${r}`);let c=l[0],a=l[1],u=l[2],d=l[3],h=l[4],f=l[5],p=e.length,g=t.length,y=0,w=[],v=[],x=[],A=[],L=s.stackSave(),H=s.stackAlloc(p*4),q=s.stackAlloc(p*4),$=s.stackAlloc(g*4),we=s.stackAlloc(g*4);try{s.jsepOnRunStart?.(c),[y,w]=wR(o);for(let oe=0;oe<p;oe++)z0(n[oe],v,A,r,e[oe],h);for(let oe=0;oe<g;oe++)z0(i[oe],x,A,r,p+t[oe],h);let ne=H/4,He=q/4,_e=$/4,Ee=we/4;for(let oe=0;oe<p;oe++)s.HEAPU32[ne++]=v[oe],s.HEAPU32[He++]=a[e[oe]];for(let oe=0;oe<g;oe++)s.HEAPU32[_e++]=x[oe],s.HEAPU32[Ee++]=u[t[oe]];let Pe;Pe=yield s._OrtRun(c,q,H,p,we,g,$,y),Pe!==0&&At("failed to call OrtRun().");let Ve=[];for(let oe=0;oe<g;oe++){let yt=s.HEAPU32[$/4+oe];if(yt===x[oe]){Ve.push(i[oe]);continue}let $e=s.stackSave(),Ze=s.stackAlloc(4*4),Gt=!1,Je,rt=0;try{s._OrtGetTensorData(yt,Ze,Ze+4,Ze+8,Ze+12)!==0&&At(`Can't access output tensor data on index ${oe}.`);let Tn=Ze/4,Bt=s.HEAPU32[Tn++];rt=s.HEAPU32[Tn++];let Wr=s.HEAPU32[Tn++],Qt=s.HEAPU32[Tn++],jt=[];for(let ke=0;ke<Qt;ke++)jt.push(s.HEAPU32[Wr/4+ke]);s._OrtFree(Wr);let en=jt.reduce((ke,xt)=>ke*xt,1);Je=TR(Bt);let ar=d?.outputPreferredLocations[t[oe]];if(Je==="string"){if(ar==="gpu-buffer"||ar==="ml-tensor")throw new Error("String tensor is not supported on GPU.");let ke=[],xt=rt/4;for(let qr=0;qr<en;qr++){let Dl=s.HEAPU32[xt++],Pu=qr===en-1?void 0:s.HEAPU32[xt]-Dl;ke.push(s.UTF8ToString(Dl,Pu))}Ve.push([Je,jt,ke,"cpu"])}else if(ar==="gpu-buffer"&&en>0){let ke=s.jsepGetBuffer;if(!ke)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let xt=ke(rt),qr=pu(Bt,en);if(qr===void 0||!Gw(Je))throw new Error(`Unsupported data type: ${Je}`);Gt=!0,Ve.push([Je,jt,{gpuBuffer:xt,download:s.jsepCreateDownloader(xt,qr,Je),dispose:()=>{s._OrtReleaseTensor(yt)}},"gpu-buffer"])}else if(ar==="ml-tensor"&&en>0){let ke=s.jsepEnsureTensor;if(!ke)throw new Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(pu(Bt,en)===void 0||!Ww(Je))throw new Error(`Unsupported data type: ${Je}`);let xt=yield ke(rt,Bt,jt,!1);Gt=!0,Ve.push([Je,jt,{mlTensor:xt,download:s.jsepCreateMLTensorDownloader(rt,Je),dispose:()=>{s.jsepReleaseTensorId(rt),s._OrtReleaseTensor(yt)}},"ml-tensor"])}else{let ke=xR(Je),xt=new ke(en);new Uint8Array(xt.buffer,xt.byteOffset,xt.byteLength).set(s.HEAPU8.subarray(rt,rt+xt.byteLength)),Ve.push([Je,jt,xt,"cpu"])}}finally{s.stackRestore($e),Je==="string"&&rt&&s._free(rt),Gt||s._OrtReleaseTensor(yt)}}return d&&!h&&(s._OrtClearBoundOutputs(d.handle),Ss.set(r,[c,a,u,d,h,!1])),Ve}finally{s.stackRestore(L),v.forEach(ne=>s._OrtReleaseTensor(ne)),x.forEach(ne=>s._OrtReleaseTensor(ne)),A.forEach(ne=>s._free(ne)),y!==0&&s._OrtReleaseRunOptions(y),w.forEach(ne=>s._free(ne))}}),Qw=r=>{let e=Jt(),n=Ss.get(r);if(!n)throw new Error("invalid session id");let t=n[0],i=e._OrtEndProfiling(t);i===0&&At("Can't get an profile file name."),e._OrtFree(i)},e_=r=>{let e=[];for(let n of r){let t=n[2];!Array.isArray(t)&&"buffer"in t&&e.push(t.buffer)}return e}}),uo,tr,fl,iu,ou,Tp,G0,xp,Es,Ds,JP,OR,AR,PR,MR,NR,RR,kR,FR=R(()=>{"use strict";Hr(),IR(),Sl(),Bp(),uo=()=>!!me.wasm.proxy&&typeof document<"u",fl=!1,iu=!1,ou=!1,xp=new Map,Es=(r,e)=>{let n=xp.get(r);n?n.push(e):xp.set(r,[e])},Ds=()=>{if(fl||!iu||ou||!tr)throw new Error("worker not ready")},JP=r=>{switch(r.data.type){case"init-wasm":fl=!1,r.data.err?(ou=!0,G0[1](r.data.err)):(iu=!0,G0[0]()),Tp&&(URL.revokeObjectURL(Tp),Tp=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let e=xp.get(r.data.type);r.data.err?e.shift()[1](r.data.err):e.shift()[0](r.data.out);break}default:}},OR=()=>F(void 0,null,function*(){if(!iu){if(fl)throw new Error("multiple calls to 'initWasm()' detected.");if(ou)throw new Error("previous call to 'initWasm()' failed.");if(fl=!0,uo())return new Promise((r,e)=>{tr?.terminate(),vR().then(([n,t])=>{try{tr=t,tr.onerror=o=>e(o),tr.onmessage=JP,G0=[r,e];let i={type:"init-wasm",in:me};tr.postMessage(i),Tp=n}catch(i){e(i)}},e)});try{yield Hw(me.wasm),yield Yw(me),iu=!0}catch(r){throw ou=!0,r}finally{fl=!1}}}),AR=r=>F(void 0,null,function*(){if(uo())return Ds(),new Promise((e,n)=>{Es("init-ep",[e,n]);let t={type:"init-ep",in:{epName:r,env:me}};tr.postMessage(t)});yield Xw(me,r)}),PR=r=>F(void 0,null,function*(){return uo()?(Ds(),new Promise((e,n)=>{Es("copy-from",[e,n]);let t={type:"copy-from",in:{buffer:r}};tr.postMessage(t,[r.buffer])})):Mp(r)}),MR=(r,e)=>F(void 0,null,function*(){if(uo()){if(e?.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return Ds(),new Promise((n,t)=>{Es("create",[n,t]);let i={type:"create",in:{model:r,options:C({},e)}},o=[];r instanceof Uint8Array&&o.push(r.buffer),tr.postMessage(i,o)})}else return Kw(r,e)}),NR=r=>F(void 0,null,function*(){if(uo())return Ds(),new Promise((e,n)=>{Es("release",[e,n]);let t={type:"release",in:r};tr.postMessage(t)});Zw(r)}),RR=(r,e,n,t,i,o)=>F(void 0,null,function*(){if(uo()){if(n.some(s=>s[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(i.some(s=>s))throw new Error("pre-allocated output tensor is not supported for proxy.");return Ds(),new Promise((s,l)=>{Es("run",[s,l]);let c=n,a={type:"run",in:{sessionId:r,inputIndices:e,inputs:c,outputIndices:t,options:o}};tr.postMessage(a,e_(c))})}else return Jw(r,e,n,t,i,o)}),kR=r=>F(void 0,null,function*(){if(uo())return Ds(),new Promise((e,n)=>{Es("end-profiling",[e,n]);let t={type:"end-profiling",in:r};tr.postMessage(t)});Qw(r)})}),W0,QP,LR,Yq=R(()=>{"use strict";Hr(),FR(),DR(),Uw(),CR(),W0=(r,e)=>{switch(r.location){case"cpu":return[r.type,r.dims,r.data,"cpu"];case"gpu-buffer":return[r.type,r.dims,{gpuBuffer:r.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[r.type,r.dims,{mlTensor:r.mlTensor},"ml-tensor"];default:throw new Error(`invalid data location: ${r.location} for ${e()}`)}},QP=r=>{switch(r[3]){case"cpu":return new Ft(r[0],r[2],r[1]);case"gpu-buffer":{let e=r[0];if(!Gw(e))throw new Error(`not supported data type: ${e} for deserializing GPU tensor`);let{gpuBuffer:n,download:t,dispose:i}=r[2];return Ft.fromGpuBuffer(n,{dataType:e,dims:r[1],download:t,dispose:i})}case"ml-tensor":{let e=r[0];if(!Ww(e))throw new Error(`not supported data type: ${e} for deserializing MLTensor tensor`);let{mlTensor:n,download:t,dispose:i}=r[2];return Ft.fromMLTensor(n,{dataType:e,dims:r[1],download:t,dispose:i})}default:throw new Error(`invalid data location: ${r[3]}`)}},LR=class{fetchModelAndCopyToWasmMemory(r){return F(this,null,function*(){return PR(yield qw(r))})}loadModel(r,e){return F(this,null,function*(){yl();let n;typeof r=="string"?n=yield this.fetchModelAndCopyToWasmMemory(r):n=r,[this.sessionId,this.inputNames,this.outputNames]=yield MR(n,e),vl()})}dispose(){return F(this,null,function*(){return NR(this.sessionId)})}run(r,e,n){return F(this,null,function*(){yl();let t=[],i=[];Object.entries(r).forEach(d=>{let h=d[0],f=d[1],p=this.inputNames.indexOf(h);if(p===-1)throw new Error(`invalid input '${h}'`);t.push(f),i.push(p)});let o=[],s=[];Object.entries(e).forEach(d=>{let h=d[0],f=d[1],p=this.outputNames.indexOf(h);if(p===-1)throw new Error(`invalid output '${h}'`);o.push(f),s.push(p)});let l=t.map((d,h)=>W0(d,()=>`input "${this.inputNames[i[h]]}"`)),c=o.map((d,h)=>d?W0(d,()=>`output "${this.outputNames[s[h]]}"`):null),a=yield RR(this.sessionId,i,l,s,c,n),u={};for(let d=0;d<a.length;d++)u[this.outputNames[s[d]]]=o[d]??QP(a[d]);return vl(),u})}startProfiling(){}endProfiling(){kR(this.sessionId)}}}),BR={};xu(BR,{OnnxruntimeWebAssemblyBackend:()=>Iw,initializeFlags:()=>Cw,wasmBackend:()=>jR});var Cw,Iw,jR,Xq=R(()=>{"use strict";Hr(),FR(),Yq(),Bp(),Cw=()=>{if((typeof me.wasm.initTimeout!="number"||me.wasm.initTimeout<0)&&(me.wasm.initTimeout=0),me.wasm.simd===!1&&console.warn('Deprecated property "env.wasm.simd" is set to false. non-SIMD build is no longer provided, and this setting will be ignored.'),typeof me.wasm.proxy!="boolean"&&(me.wasm.proxy=!1),typeof me.wasm.trace!="boolean"&&(me.wasm.trace=!1),typeof me.wasm.numThreads!="number"||!Number.isInteger(me.wasm.numThreads)||me.wasm.numThreads<=0)if(typeof self<"u"&&!self.crossOriginIsolated)me.wasm.numThreads=1;else{let r=typeof navigator>"u"?Z5("node:os").cpus().length:navigator.hardwareConcurrency;me.wasm.numThreads=Math.min(4,Math.ceil((r||1)/2))}},Iw=class{init(r){return F(this,null,function*(){Cw(),yield OR(),yield AR(r)})}createInferenceSessionHandler(r,e){return F(this,null,function*(){let n=new LR;return yield n.loadModel(r,e),Promise.resolve(n)})}},jR=new Iw});Hr();Hr();Hr();var Kq="1.20.1",yne=bM;{let r=(Hq(),Dp(hR)).onnxjsBackend;bu("webgl",r,-10)}{let r=(Xq(),Dp(BR)).wasmBackend;bu("cpu",r,10),bu("wasm",r,10)}Object.defineProperty(me.versions,"web",{value:Kq,enumerable:!0});var jk=CF(Bk());var Hp=class r{constructor(e){this.downloadService=e;this.session=this.loadResources()}session;labels=[];parseMetaValue(e){return e.slice(1,-1).split(/\s*,\s*/).map(o=>o.split(/\s*:\s*/)[1].replace(/^'|'$/g,""))}loadLabels(e){let t=jk.onnx.ModelProto.decode(new Uint8Array(e)).metadataProps.find(i=>i.key==="names");if(t&&t.value)return this.parseMetaValue(t?.value);throw new Error("Names entry not found")}loadResources(){return F(this,null,function*(){let e="assets/onnxruntime-web/ort-wasm-simd-threaded.wasm",n="assets/models/best.onnx",[t,i]=yield this.downloadService.loadResources([e,n]);return me.wasm.wasmBinary=t,this.labels=this.loadLabels(i),Rp.create(i)})}annotate(e){return F(this,null,function*(){let[n,t,i]=yield this.prepare_input(e),o=new Ft(Float32Array.from(n),[1,3,640,640]),l=yield(yield this.session).run({images:o});return this.process_output(l.output0.data,t,i)})}iou(e,n){return this.intersection(e,n)/this.union(e,n)}union(e,n){let t=e.width*e.height,i=n.width*n.height;return t+i-this.intersection(e,n)}intersection(e,n){let t=e.x,i=e.y,o=e.x+e.width,s=e.y+e.height,l=n.x,c=n.y,a=n.x+n.width,u=n.y+n.height,d=Math.max(t,l),h=Math.max(i,c),f=Math.min(o,a),p=Math.min(s,u);return f<=d||p<=h?0:(f-d)*(p-h)}resizeAndPadTo640(e){return F(this,null,function*(){return new Promise((n,t)=>{let i=new Image;i.src=e,i.onload=()=>{let o=640/Math.max(i.width,i.height),s=Math.round(i.width*o),l=Math.round(i.height*o),c=document.createElement("canvas");c.width=640,c.height=640;let a=c.getContext("2d");if(!a){t("Canvas context is not supported");return}a.fillStyle="black",a.fillRect(0,0,640,640);let u=(640-s)/2,d=(640-l)/2;a.drawImage(i,u,d,s,l),n({imageData:a.getImageData(0,0,640,640),imgWidth:i.width,imgHeight:i.height})},i.onerror=o=>t(o)})})}prepare_input(e){return F(this,null,function*(){return new Promise(n=>{let t=new Image;t.src=e,t.onload=()=>{let[i,o]=[t.width,t.height],s=document.createElement("canvas");s.width=640,s.height=640;let l=s.getContext("2d");if(!l)throw new Error("Could not get context");l.drawImage(t,0,0,640,640);let a=l.getImageData(0,0,640,640).data,u=[],d=[],h=[];for(let p=0;p<a.length;p+=4)u.push(a[p]/255),d.push(a[p+1]/255),h.push(a[p+2]/255);let f=[...u,...d,...h];n([f,i,o])}})})}process_output(e,n,t){let i=[];for(let l=0;l<8400;l++){let[c,a]=[...Array(267).keys()].map(x=>[x,e[8400*(x+4)+l]]).reduce((x,A)=>A[1]>x[1]?A:x,[0,0]);if(a<.5)continue;let u=this.labels[c],d=e[l],h=e[8400+l],f=e[2*8400+l],p=e[3*8400+l],g=d/640*n,y=h/640*t,w=f/640*n,v=p/640*t;i.push({class:u,class_id:c,confidence:a,detection_id:"",x:g,y,width:w,height:v})}i=i.sort((l,c)=>c.class_id-l.class_id);let o=[];for(;i.length>0;)o.push(i[0]),i=i.filter(l=>this.iou(i[0],l)<.7);return{time:0,image:{width:n,height:t},predictions:o}}static \u0275fac=function(n){return new(n||r)(J(hl))};static \u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"})};var l7=r=>["/edit",r];function c7(r,e){if(r&1){let n=Ta();te(0,"button",34),Mt("click",function(){fr(n);let i=Ct().index,o=Ct();return pr(o.onRotateImage(i))}),et(1,"i",35),Q()}if(r&2){let n=Ct().$implicit;ge("disabled",n.annotating)}}function u7(r,e){r&1&&(te(0,"span",41),et(1,"i",42),Q())}function d7(r,e){r&1&&(te(0,"span",43)(1,"span",44),It(2,"Loading..."),Q()())}function h7(r,e){if(r&1&&(te(0,"div",36)(1,"a",37),et(2,"img",38),Ke(3,u7,2,0,"span",39)(4,d7,3,0,"span",40),Q()()),r&2){let n=Ct(),t=n.$implicit,i=n.index;ie(),ge("routerLink",t.annotations?ZE(4,l7,i):null),ie(),ge("src",t.boardGame,oy),ie(),ge("ngIf",t.annotations&&!t.annotating),ie(),ge("ngIf",t.annotating)}}function f7(r,e){if(r&1){let n=Ta();te(0,"tr")(1,"td")(2,"input",24),Jl("ngModelChange",function(i){let o=fr(n).$implicit;return xh(o.name,i)||(o.name=i),pr(i)}),Q()(),te(3,"td")(4,"button",25),Mt("click",function(){fr(n);let i=xy(7);return pr(i.click())}),et(5,"i",26),Q(),te(6,"input",27,0),Mt("change",function(i){let o=fr(n).index,s=Ct();return pr(s.onFileSelected(o,i))}),Q(),te(8,"button",28),Mt("click",function(){fr(n);let i=xy(11);return pr(i.click())}),et(9,"i",29),Q(),te(10,"input",30,1),Mt("change",function(i){let o=fr(n).index,s=Ct();return pr(s.onFileSelected(o,i))}),Q(),Ke(12,c7,2,1,"button",31)(13,h7,5,6,"div",32),Q(),te(14,"td")(15,"input",33),Jl("ngModelChange",function(i){let o=fr(n).$implicit;return xh(o.cardsInCave,i)||(o.cardsInCave=i),pr(i)}),Q()()()}if(r&2){let n=e.$implicit,t=e.index;ie(2),Zl("ngModel",n.name),ge("placeholder","Player"+(t+1)),ie(2),ge("disabled",n.annotating),ie(4),ge("disabled",n.annotating),ie(4),ge("ngIf",n.boardGame),ie(),ge("ngIf",n.boardGame),ie(2),Zl("ngModel",n.cardsInCave)}}function p7(r,e){if(r&1){let n=Ta();te(0,"div",8)(1,"div",45)(2,"input",46),Jl("ngModelChange",function(i){fr(n);let o=Ct();return xh(o.uploadData,i)||(o.uploadData=i),pr(i)}),Q(),te(3,"label",47),It(4," Upload Images to improve Card Detection "),Q()()()}if(r&2){let n=Ct();ie(2),Zl("ngModel",n.uploadData)}}function g7(r,e){r&1&&et(0,"span",48)}function m7(r,e){r&1&&(te(0,"span"),It(1,"Submit"),Q())}function y7(r,e){r&1&&(te(0,"span",44),It(1,"Loading..."),Q())}function v7(r,e){if(r&1&&(te(0,"th"),It(1),Q()),r&2){let n=e.$implicit;ie(),On(" ",n.playerName," ")}}function b7(r,e){if(r&1&&(te(0,"div"),It(1),Q()),r&2){let n=Ct().$implicit;ie(),On(" ",n.treePoints()," ")}}function w7(r,e){if(r&1&&(te(0,"td"),Ke(1,b7,2,1,"div",12),Q()),r&2){let n=e.$implicit;ie(),ge("ngIf",n)}}function _7(r,e){if(r&1&&(te(0,"div"),It(1),Q()),r&2){let n=Ct().$implicit;ie(),On(" ",n.topPoints()," ")}}function T7(r,e){if(r&1&&(te(0,"td"),Ke(1,_7,2,1,"div",12),Q()),r&2){let n=e.$implicit;ie(),ge("ngIf",n)}}function x7(r,e){if(r&1&&(te(0,"div"),It(1),Q()),r&2){let n=Ct().$implicit;ie(),On(" ",n.bottomPoints()," ")}}function S7(r,e){if(r&1&&(te(0,"td"),Ke(1,x7,2,1,"div",12),Q()),r&2){let n=e.$implicit;ie(),ge("ngIf",n)}}function E7(r,e){if(r&1&&(te(0,"div"),It(1),Q()),r&2){let n=Ct().$implicit;ie(),On(" ",n.sidePoints()," ")}}function D7(r,e){if(r&1&&(te(0,"td"),Ke(1,E7,2,1,"div",12),Q()),r&2){let n=e.$implicit;ie(),ge("ngIf",n)}}function C7(r,e){if(r&1&&(te(0,"div"),It(1),Q()),r&2){let n=Ct().$implicit;ie(),On(" ",n.caveCount," ")}}function I7(r,e){if(r&1&&(te(0,"td"),Ke(1,C7,2,1,"div",12),Q()),r&2){let n=e.$implicit;ie(),ge("ngIf",n)}}function O7(r,e){if(r&1&&(te(0,"div"),It(1),Q()),r&2){let n=Ct().$implicit;ie(),On(" ",n.points," ")}}function A7(r,e){if(r&1&&(te(0,"td"),Ke(1,O7,2,1,"div",12),Q()),r&2){let n=e.$implicit;ie(),ge("ngIf",n)}}var zp=class r{constructor(e,n,t,i){this.imageAnnotator=e;this.router=n;this.playerService=t;this.headerService=i}allForests=[];isLoading=!1;uploadData=!0;ngOnInit(){this.headerService.setButtons([{label:"",icon:"bi-question-circle",class:"btn-primary",action:this.showHelp,visible:!0}]);for(let[e,n]of this.playerService.players.entries())n.boardGame&&!n.annotations&&this.predictPlayer(e,n.boardGame)}showHelp(e){alert("Help dialog opened")}onFileSelected(e,n){let t=n.target.files[0];if(t){let i=new FileReader;i.onload=o=>F(this,null,function*(){yield this.predictPlayer(e,o.target.result)}),i.readAsDataURL(t)}}predictPlayer(e,n){return F(this,null,function*(){let t=this.playerService.players[e];try{t.annotating=!0,this.playerService.updatePlayerBoardGame(e,n),setTimeout(()=>F(this,null,function*(){let i=yield this.imageAnnotator.annotate(n);t.annotations=i,t.annotating=!1}),100)}catch(i){console.error("Error annotating image:",i),t.annotating=!1}})}rotateTimeouts=new Map;onRotateImage(e){return F(this,null,function*(){let n=this.playerService.getPlayer(e)?.boardGame;if(n){let t=yield this.rotateImage(n,90);this.playerService.updatePlayerBoardGame(e,t),this.rotateTimeouts.has(e)&&clearTimeout(this.rotateTimeouts.get(e)),this.rotateTimeouts.set(e,setTimeout(()=>F(this,null,function*(){yield this.predictPlayer(e,t),this.rotateTimeouts.delete(e)}),1e3))}})}rotateImage(e,n){return new Promise(t=>{let i=new Image;i.src=e,i.onload=()=>{let o=document.createElement("canvas"),s=o.getContext("2d");if(!s)throw new Error("Could not get context");n===90||n===270?(o.width=i.height,o.height=i.width):(o.width=i.width,o.height=i.height),s.translate(o.width/2,o.height/2),s.rotate(n*Math.PI/180),s.drawImage(i,-i.width/2,-i.height/2),t(o.toDataURL())}})}submit(){return F(this,null,function*(){this.allForests.length=0;try{this.isLoading=!0;let e=this.playerService.players;console.log("Submitted data:",e);for(let[n,t]of e.entries())if(t.annotations){let i=t.name||`Player${n+1}`,o=new pp(i,this.allForests);this.allForests.push(o);let s=dp.assembleForest(t.annotations);o.setCards(s),o.caveCount=t.cardsInCave}for(let n of this.allForests)n.updatePoints()}catch(e){alert(e)}finally{this.isLoading=!1,setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}})}static \u0275fac=function(n){return new(n||r)(se(Hp),se(Yn),se(ll),se(ao))};static \u0275cmp=Nr({type:r,selectors:[["app-home"]],decls:58,vars:14,consts:[["fileInputCamera",""],["fileInputImage",""],[1,"container"],[1,"table-responsive"],[1,"table","table-bordered"],["src","glImg/cave.png","alt","cave",1,"icon"],[4,"ngFor","ngForOf"],["class","d-flex justify-content-center mt-3",4,"ngIf"],[1,"d-flex","justify-content-center","mt-3"],[1,"ms-3"],[1,"btn","btn-success",3,"click","disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],[4,"ngIf"],["class","visually-hidden",4,"ngIf"],[1,"mt-3","points",3,"hidden"],["src","glImg/symbols/tree.png","alt","tree","height","24"],["src","glImg/symbols/shrub.png","alt","shrub","height","24"],[1,"point-icon","border","border-2","text-light","border-light","rounded","justify-content-center","align-items-center","d-flex"],[1,"bi","bi-arrow-up"],[1,"bi","bi-arrow-down"],[1,"bi","bi-arrows"],["src","glImg/cave.png","alt","cave"],[2,"border-top","2px solid #000"],["src","glImg/points.png","alt","Total Points"],["type","text",1,"form-control",3,"ngModelChange","ngModel","placeholder"],["title","Take picture",1,"btn","btn-primary",3,"click","disabled"],[1,"bi","bi-camera"],["type","file","accept","image/*","capture","environment",2,"display","none",3,"change"],["title","Upload picture",1,"btn","btn-primary",3,"click","disabled"],[1,"bi","bi-image"],["type","file","accept","image/*",2,"display","none",3,"change"],["class","btn btn-primary","title","Rotate image",3,"disabled","click",4,"ngIf"],["style","margin-top: 10px; position: relative;",4,"ngIf"],["type","number","min","0",1,"form-control",3,"ngModelChange","ngModel"],["title","Rotate image",1,"btn","btn-primary",3,"click","disabled"],[1,"bi","bi-arrow-clockwise"],[2,"margin-top","10px","position","relative"],[1,"d-flex","justify-content-center","align-items-center",3,"routerLink"],["alt","BoardGame","height","130",2,"border","1px solid #ccc","padding","4px",3,"src"],["class","position-absolute",4,"ngIf"],["class","spinner-border text-primary position-absolute","role","status",4,"ngIf"],[1,"position-absolute"],[1,"bi","bi-pencil-square","h2"],["role","status",1,"spinner-border","text-primary","position-absolute"],[1,"visually-hidden"],[1,"form-check","ms-3"],["disabled","","type","checkbox","id","saveDataCheckbox",1,"form-check-input",3,"ngModelChange","ngModel"],["for","saveDataCheckbox",1,"form-check-label"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(n,t){n&1&&(te(0,"div",2),et(1,"app-download-progress"),Q(),te(2,"div",3)(3,"table",4)(4,"thead")(5,"tr")(6,"th"),It(7,"Name"),Q(),te(8,"th"),It(9,"BoardGame (Picture/Upload)"),Q(),te(10,"th"),It(11,"Cards in Cave "),et(12,"img",5),Q()()(),te(13,"tbody"),Ke(14,f7,16,7,"tr",6),Q()()(),Ke(15,p7,5,1,"div",7),te(16,"div",8)(17,"div",9)(18,"button",10),Mt("click",function(){return t.submit()}),Ke(19,g7,1,0,"span",11)(20,m7,2,0,"span",12)(21,y7,2,0,"span",13),Q()()(),te(22,"div",14)(23,"table",4)(24,"thead")(25,"tr"),et(26,"th"),Ke(27,v7,2,1,"th",6),Q()(),te(28,"tbody")(29,"tr")(30,"td"),et(31,"img",15)(32,"img",16),Q(),Ke(33,w7,2,1,"td",6),Q(),te(34,"tr")(35,"td")(36,"div",17),et(37,"i",18),Q()(),Ke(38,T7,2,1,"td",6),Q(),te(39,"tr")(40,"td")(41,"div",17),et(42,"i",19),Q()(),Ke(43,S7,2,1,"td",6),Q(),te(44,"tr")(45,"td")(46,"div",17),et(47,"i",20),Q()(),Ke(48,D7,2,1,"td",6),Q(),te(49,"tr")(50,"td"),et(51,"img",21),Q(),Ke(52,I7,2,1,"td",6),Q(),te(53,"tr",22)(54,"td")(55,"div"),et(56,"img",23),Q()(),Ke(57,A7,2,1,"td",6),Q()()()()),n&2&&(ie(14),ge("ngForOf",t.playerService.players),ie(),ge("ngIf",!1),ie(3),ge("disabled",t.isLoading),ie(),ge("ngIf",t.isLoading),ie(),ge("ngIf",!t.isLoading),ie(),ge("ngIf",t.isLoading),ie(),ge("hidden",t.allForests.length==0),ie(5),ge("ngForOf",t.allForests),ie(6),ge("ngForOf",t.allForests),ie(5),ge("ngForOf",t.allForests),ie(5),ge("ngForOf",t.allForests),ie(5),ge("ngForOf",t.allForests),ie(4),ge("ngForOf",t.allForests),ie(5),ge("ngForOf",t.allForests))},dependencies:[di,Ih,Ca,up,lp,t0,Jb,nO,n0,e0,IC,rf,gp],styles:[".table[_ngcontent-%COMP%]{margin:20px auto;width:90%;max-width:800px}button[_ngcontent-%COMP%]{margin-right:1rem}.point-icon[_ngcontent-%COMP%]{width:24px;height:24px;background-color:#1d931d}.points[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], img.icon[_ngcontent-%COMP%]{max-width:24px;max-height:24px}.points[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:24px;height:24px;text-align:center}"]})};var Vk=[{path:"",component:zp},{path:"edit/:playerNumber",component:np}];var $k={providers:[eD({eventCoalescing:!0}),AC(Vk,Pv()),OD()]};function P7(r,e){if(r&1&&et(0,"i",6),r&2){let n=Ct().$implicit;ge("ngClass",n.icon)}}function M7(r,e){if(r&1){let n=Ta();_y(0),te(1,"button",4),Mt("click",function(){let i=fr(n).$implicit;return pr(i.action(i))}),Ke(2,P7,1,1,"i",5),It(3),Q(),Ty()}if(r&2){let n=e.$implicit;ie(),_a("visibility",n.visible?"visible":"hidden"),ge("ngClass",n.class),ie(),ge("ngIf",n.icon),ie(),On(" ",n.label," ")}}var Gp=class r{constructor(e){this.headerService=e}static \u0275fac=function(n){return new(n||r)(se(ao))};static \u0275cmp=Nr({type:r,selectors:[["app-root"]],decls:6,vars:3,consts:[["id","navBar",1,"navbar","navbar-expand-lg","navbar-light","bg-success"],[1,"container","container-fluid"],[1,"ms-auto"],[4,"ngFor","ngForOf"],[1,"btn","btn-outline-dark","me-4",3,"click","ngClass"],["class","bi",3,"ngClass",4,"ngIf"],[1,"bi",3,"ngClass"]],template:function(n,t){n&1&&(te(0,"nav",0)(1,"div",1)(2,"div",2),Ke(3,M7,4,5,"ng-container",3),Sa(4,"async"),Q()()(),et(5,"router-outlet")),n&2&&(ie(3),ge("ngForOf",Ea(4,1,t.headerService.buttons$)))},dependencies:[di,pD,Ih,Ca,Oh,up,rf,Ev],encapsulation:2})};jD(Gp,$k).catch(r=>console.error(r));
