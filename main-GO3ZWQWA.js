var O2=Object.defineProperty,A2=Object.defineProperties;var M2=Object.getOwnPropertyDescriptors;var C_=Object.getOwnPropertySymbols;var P2=Object.prototype.hasOwnProperty,N2=Object.prototype.propertyIsEnumerable;var S_=(t,e,n)=>e in t?O2(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,C=(t,e)=>{for(var n in e||={})P2.call(e,n)&&S_(t,n,e[n]);if(C_)for(var n of C_(e))N2.call(e,n)&&S_(t,n,e[n]);return t},N=(t,e)=>A2(t,M2(e));var no=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,n)=>(typeof require<"u"?require:e)[n]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var R=(t,e,n)=>new Promise((r,i)=>{var o=c=>{try{a(n.next(c))}catch(s){i(s)}},l=c=>{try{a(n.throw(c))}catch(s){i(s)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(o,l);a((n=n.apply(t,e)).next())});function Np(t,e){return Object.is(t,e)}var mt=null,pu=!1,Rp=1,hn=Symbol("SIGNAL");function _e(t){let e=mt;return mt=t,e}function D_(){return mt}var ll={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function mu(t){if(pu)throw new Error("");if(mt===null)return;mt.consumerOnSignalRead(t);let e=mt.nextProducerIndex++;if(bu(mt),e<mt.producerNode.length&&mt.producerNode[e]!==t&&al(mt)){let n=mt.producerNode[e];vu(n,mt.producerIndexOfThis[e])}mt.producerNode[e]!==t&&(mt.producerNode[e]=t,mt.producerIndexOfThis[e]=al(mt)?A_(t,mt,e):0),mt.producerLastReadVersion[e]=t.version}function R2(){Rp++}function kp(t){if(!(al(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===Rp)){if(!t.producerMustRecompute(t)&&!Lp(t)){Pp(t);return}t.producerRecomputeValue(t),Pp(t)}}function I_(t){if(t.liveConsumerNode===void 0)return;let e=pu;pu=!0;try{for(let n of t.liveConsumerNode)n.dirty||k2(n)}finally{pu=e}}function O_(){return mt?.consumerAllowSignalWrites!==!1}function k2(t){t.dirty=!0,I_(t),t.consumerMarkedDirty?.(t)}function Pp(t){t.dirty=!1,t.lastCleanEpoch=Rp}function yu(t){return t&&(t.nextProducerIndex=0),_e(t)}function Fp(t,e){if(_e(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(al(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)vu(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function Lp(t){bu(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(kp(n),r!==n.version))return!0}return!1}function Bp(t){if(bu(t),al(t))for(let e=0;e<t.producerNode.length;e++)vu(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function A_(t,e,n){if(M_(t),t.liveConsumerNode.length===0&&P_(t))for(let r=0;r<t.producerNode.length;r++)t.producerIndexOfThis[r]=A_(t.producerNode[r],t,r);return t.liveConsumerIndexOfThis.push(n),t.liveConsumerNode.push(e)-1}function vu(t,e){if(M_(t),t.liveConsumerNode.length===1&&P_(t))for(let r=0;r<t.producerNode.length;r++)vu(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];bu(i),i.producerIndexOfThis[r]=e}}function al(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function bu(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function M_(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function P_(t){return t.producerNode!==void 0}function N_(t){let e=Object.create(F2);e.computation=t;let n=()=>{if(kp(e),mu(e),e.value===gu)throw e.error;return e.value};return n[hn]=e,n}var Ap=Symbol("UNSET"),Mp=Symbol("COMPUTING"),gu=Symbol("ERRORED"),F2=N(C({},ll),{value:Ap,dirty:!0,error:null,equal:Np,kind:"computed",producerMustRecompute(t){return t.value===Ap||t.value===Mp},producerRecomputeValue(t){if(t.value===Mp)throw new Error("Detected cycle in computations.");let e=t.value;t.value=Mp;let n=yu(t),r,i=!1;try{r=t.computation(),_e(null),i=e!==Ap&&e!==gu&&r!==gu&&t.equal(e,r)}catch(o){r=gu,t.error=o}finally{Fp(t,n)}if(i){t.value=e;return}t.value=r,t.version++}});function L2(){throw new Error}var R_=L2;function k_(){R_()}function F_(t){R_=t}var B2=null;function L_(t){let e=Object.create(jp);e.value=t;let n=()=>(mu(e),e.value);return n[hn]=e,n}function wu(t,e){O_()||k_(),t.equal(t.value,e)||(t.value=e,j2(t))}function B_(t,e){O_()||k_(),wu(t,e(t.value))}var jp=N(C({},ll),{equal:Np,value:void 0,kind:"signal"});function j2(t){t.version++,R2(),I_(t),B2?.()}function re(t){return typeof t=="function"}function ms(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var _u=ms(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function ro(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Qe=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let o of n)o.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(re(r))try{r()}catch(o){e=o instanceof _u?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{j_(o)}catch(l){e=e??[],l instanceof _u?e=[...e,...l.errors]:e.push(l)}}if(e)throw new _u(e)}}add(e){var n;if(e&&e!==this)if(this.closed)j_(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&ro(n,e)}remove(e){let{_finalizers:n}=this;n&&ro(n,e),e instanceof t&&e._removeParent(this)}};Qe.EMPTY=(()=>{let t=new Qe;return t.closed=!0,t})();var Vp=Qe.EMPTY;function Tu(t){return t instanceof Qe||t&&"closed"in t&&re(t.remove)&&re(t.add)&&re(t.unsubscribe)}function j_(t){re(t)?t():t.unsubscribe()}var Kn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var ys={setTimeout(t,e,...n){let{delegate:r}=ys;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=ys;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function xu(t){ys.setTimeout(()=>{let{onUnhandledError:e}=Kn;if(e)e(t);else throw t})}function cl(){}var V_=$p("C",void 0,void 0);function $_(t){return $p("E",void 0,t)}function U_(t){return $p("N",t,void 0)}function $p(t,e,n){return{kind:t,value:e,error:n}}var io=null;function vs(t){if(Kn.useDeprecatedSynchronousErrorHandling){let e=!io;if(e&&(io={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=io;if(io=null,n)throw r}}else t()}function H_(t){Kn.useDeprecatedSynchronousErrorHandling&&io&&(io.errorThrown=!0,io.error=t)}var oo=class extends Qe{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Tu(e)&&e.add(this)):this.destination=U2}static create(e,n,r){return new bs(e,n,r)}next(e){this.isStopped?Hp(U_(e),this):this._next(e)}error(e){this.isStopped?Hp($_(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Hp(V_,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},V2=Function.prototype.bind;function Up(t,e){return V2.call(t,e)}var Gp=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){Eu(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){Eu(r)}else Eu(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Eu(n)}}},bs=class extends oo{constructor(e,n,r){super();let i;if(re(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let o;this&&Kn.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Up(e.next,o),error:e.error&&Up(e.error,o),complete:e.complete&&Up(e.complete,o)}):i=e}this.destination=new Gp(i)}};function Eu(t){Kn.useDeprecatedSynchronousErrorHandling?H_(t):xu(t)}function $2(t){throw t}function Hp(t,e){let{onStoppedNotification:n}=Kn;n&&ys.setTimeout(()=>n(t,e))}var U2={closed:!0,next:cl,error:$2,complete:cl};var ws=typeof Symbol=="function"&&Symbol.observable||"@@observable";function fn(t){return t}function zp(...t){return Wp(t)}function Wp(t){return t.length===0?fn:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var Ee=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let o=G2(n)?n:new bs(n,r,i);return vs(()=>{let{operator:l,source:a}=this;o.add(l?l.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=G_(r),new r((i,o)=>{let l=new bs({next:a=>{try{n(a)}catch(c){o(c),l.unsubscribe()}},error:o,complete:i});this.subscribe(l)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[ws](){return this}pipe(...n){return Wp(n)(this)}toPromise(n){return n=G_(n),new n((r,i)=>{let o;this.subscribe(l=>o=l,l=>i(l),()=>r(o))})}}return t.create=e=>new t(e),t})();function G_(t){var e;return(e=t??Kn.Promise)!==null&&e!==void 0?e:Promise}function H2(t){return t&&re(t.next)&&re(t.error)&&re(t.complete)}function G2(t){return t&&t instanceof oo||H2(t)&&Tu(t)}function qp(t){return re(t?.lift)}function ye(t){return e=>{if(qp(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function he(t,e,n,r,i){return new Yp(t,e,n,r,i)}var Yp=class extends oo{constructor(e,n,r,i,o,l){super(e),this.onFinalize=o,this.shouldUnsubscribe=l,this._next=n?function(a){try{n(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function _s(){return ye((t,e)=>{let n=null;t._refCount++;let r=he(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,o=n;n=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var Ts=class extends Ee{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,qp(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Qe;let n=this.getSubject();e.add(this.source.subscribe(he(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Qe.EMPTY)}return e}refCount(){return _s()(this)}};var z_=ms(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var yt=(()=>{class t extends Ee{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new Cu(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new z_}next(n){vs(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){vs(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){vs(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:o}=this;return r||i?Vp:(this.currentObservers=null,o.push(n),new Qe(()=>{this.currentObservers=null,ro(o,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:o}=this;r?n.error(i):o&&n.complete()}asObservable(){let n=new Ee;return n.source=this,n}}return t.create=(e,n)=>new Cu(e,n),t})(),Cu=class extends yt{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:Vp}};var Je=class extends yt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Xp={now(){return(Xp.delegate||Date).now()},delegate:void 0};var Su=class extends Qe{constructor(e,n){super()}schedule(e,n=0){return this}};var ul={setInterval(t,e,...n){let{delegate:r}=ul;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=ul;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var Du=class extends Su{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,n),this}requestAsyncId(e,n,r=0){return ul.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&ul.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,ro(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var xs=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};xs.now=Xp.now;var Iu=class extends xs{constructor(e,n=xs.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var W_=new Iu(Du);var pn=new Ee(t=>t.complete());function q_(t){return t&&re(t.schedule)}function Y_(t){return t[t.length-1]}function Ou(t){return re(Y_(t))?t.pop():void 0}function li(t){return q_(Y_(t))?t.pop():void 0}function K_(t,e,n,r){function i(o){return o instanceof n?o:new n(function(l){l(o)})}return new(n||(n=Promise))(function(o,l){function a(u){try{s(r.next(u))}catch(d){l(d)}}function c(u){try{s(r.throw(u))}catch(d){l(d)}}function s(u){u.done?o(u.value):i(u.value).then(a,c)}s((r=r.apply(t,e||[])).next())})}function X_(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function so(t){return this instanceof so?(this.v=t,this):new so(t)}function Z_(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",l),i[Symbol.asyncIterator]=function(){return this},i;function l(f){return function(p){return Promise.resolve(p).then(f,d)}}function a(f,p){r[f]&&(i[f]=function(g){return new Promise(function(y,b){o.push([f,g,y,b])>1||c(f,g)})},p&&(i[f]=p(i[f])))}function c(f,p){try{s(r[f](p))}catch(g){h(o[0][3],g)}}function s(f){f.value instanceof so?Promise.resolve(f.value.v).then(u,d):h(o[0][2],f)}function u(f){c("next",f)}function d(f){c("throw",f)}function h(f,p){f(p),o.shift(),o.length&&c(o[0][0],o[0][1])}}function Q_(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof X_=="function"?X_(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(l){return new Promise(function(a,c){l=t[o](l),i(a,c,l.done,l.value)})}}function i(o,l,a,c){Promise.resolve(c).then(function(s){o({value:s,done:a})},l)}}var Au=t=>t&&typeof t.length=="number"&&typeof t!="function";function Mu(t){return re(t?.then)}function Pu(t){return re(t[ws])}function Nu(t){return Symbol.asyncIterator&&re(t?.[Symbol.asyncIterator])}function Ru(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function z2(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ku=z2();function Fu(t){return re(t?.[ku])}function Lu(t){return Z_(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield so(n.read());if(i)return yield so(void 0);yield yield so(r)}}finally{n.releaseLock()}})}function Bu(t){return re(t?.getReader)}function ut(t){if(t instanceof Ee)return t;if(t!=null){if(Pu(t))return W2(t);if(Au(t))return q2(t);if(Mu(t))return Y2(t);if(Nu(t))return J_(t);if(Fu(t))return X2(t);if(Bu(t))return K2(t)}throw Ru(t)}function W2(t){return new Ee(e=>{let n=t[ws]();if(re(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function q2(t){return new Ee(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function Y2(t){return new Ee(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,xu)})}function X2(t){return new Ee(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function J_(t){return new Ee(e=>{Z2(t,e).catch(n=>e.error(n))})}function K2(t){return J_(Lu(t))}function Z2(t,e){var n,r,i,o;return K_(this,void 0,void 0,function*(){try{for(n=Q_(t);r=yield n.next(),!r.done;){let l=r.value;if(e.next(l),e.closed)return}}catch(l){i={error:l}}finally{try{r&&!r.done&&(o=n.return)&&(yield o.call(n))}finally{if(i)throw i.error}}e.complete()})}function rn(t,e,n,r=0,i=!1){let o=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!i)return o}function ju(t,e=0){return ye((n,r)=>{n.subscribe(he(r,i=>rn(r,t,()=>r.next(i),e),()=>rn(r,t,()=>r.complete(),e),i=>rn(r,t,()=>r.error(i),e)))})}function Vu(t,e=0){return ye((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function eT(t,e){return ut(t).pipe(Vu(e),ju(e))}function tT(t,e){return ut(t).pipe(Vu(e),ju(e))}function nT(t,e){return new Ee(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function rT(t,e){return new Ee(n=>{let r;return rn(n,e,()=>{r=t[ku](),rn(n,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(l){n.error(l);return}o?n.complete():n.next(i)},0,!0)}),()=>re(r?.return)&&r.return()})}function $u(t,e){if(!t)throw new Error("Iterable cannot be null");return new Ee(n=>{rn(n,e,()=>{let r=t[Symbol.asyncIterator]();rn(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function iT(t,e){return $u(Lu(t),e)}function oT(t,e){if(t!=null){if(Pu(t))return eT(t,e);if(Au(t))return nT(t,e);if(Mu(t))return tT(t,e);if(Nu(t))return $u(t,e);if(Fu(t))return rT(t,e);if(Bu(t))return iT(t,e)}throw Ru(t)}function He(t,e){return e?oT(t,e):ut(t)}function K(...t){let e=li(t);return He(t,e)}function Es(t,e){let n=re(t)?t:()=>t,r=i=>i.error(n());return new Ee(e?i=>e.schedule(r,0,i):r)}function Kp(t){return!!t&&(t instanceof Ee||re(t.lift)&&re(t.subscribe))}var Pr=ms(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function se(t,e){return ye((n,r)=>{let i=0;n.subscribe(he(r,o=>{r.next(t.call(e,o,i++))}))})}var{isArray:Q2}=Array;function J2(t,e){return Q2(e)?t(...e):t(e)}function Uu(t){return se(e=>J2(t,e))}var{isArray:ek}=Array,{getPrototypeOf:tk,prototype:nk,keys:rk}=Object;function Hu(t){if(t.length===1){let e=t[0];if(ek(e))return{args:e,keys:null};if(ik(e)){let n=rk(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function ik(t){return t&&typeof t=="object"&&tk(t)===nk}function Gu(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function dl(...t){let e=li(t),n=Ou(t),{args:r,keys:i}=Hu(t);if(r.length===0)return He([],e);let o=new Ee(ok(r,e,i?l=>Gu(i,l):fn));return n?o.pipe(Uu(n)):o}function ok(t,e,n=fn){return r=>{sT(e,()=>{let{length:i}=t,o=new Array(i),l=i,a=i;for(let c=0;c<i;c++)sT(e,()=>{let s=He(t[c],e),u=!1;s.subscribe(he(r,d=>{o[c]=d,u||(u=!0,a--),a||r.next(n(o.slice()))},()=>{--l||r.complete()}))},r)},r)}}function sT(t,e,n){t?rn(n,t,e):e()}function aT(t,e,n,r,i,o,l,a){let c=[],s=0,u=0,d=!1,h=()=>{d&&!c.length&&!s&&e.complete()},f=g=>s<r?p(g):c.push(g),p=g=>{o&&e.next(g),s++;let y=!1;ut(n(g,u++)).subscribe(he(e,b=>{i?.(b),o?f(b):e.next(b)},()=>{y=!0},void 0,()=>{if(y)try{for(s--;c.length&&s<r;){let b=c.shift();l?rn(e,l,()=>p(b)):p(b)}h()}catch(b){e.error(b)}}))};return t.subscribe(he(e,f,()=>{d=!0,h()})),()=>{a?.()}}function dt(t,e,n=1/0){return re(e)?dt((r,i)=>se((o,l)=>e(r,o,i,l))(ut(t(r,i))),n):(typeof e=="number"&&(n=e),ye((r,i)=>aT(r,i,t,n)))}function Cs(t=1/0){return dt(fn,t)}function lT(){return Cs(1)}function Ss(...t){return lT()(He(t,li(t)))}function zu(t){return new Ee(e=>{ut(t()).subscribe(e)})}function Zp(...t){let e=Ou(t),{args:n,keys:r}=Hu(t),i=new Ee(o=>{let{length:l}=n;if(!l){o.complete();return}let a=new Array(l),c=l,s=l;for(let u=0;u<l;u++){let d=!1;ut(n[u]).subscribe(he(o,h=>{d||(d=!0,s--),a[u]=h},()=>c--,void 0,()=>{(!c||!d)&&(s||o.next(r?Gu(r,a):a),o.complete())}))}});return e?i.pipe(Uu(e)):i}function Dt(t,e){return ye((n,r)=>{let i=0;n.subscribe(he(r,o=>t.call(e,o,i++)&&r.next(o)))})}function ci(t){return ye((e,n)=>{let r=null,i=!1,o;r=e.subscribe(he(n,void 0,void 0,l=>{o=ut(t(l,ci(t)(e))),r?(r.unsubscribe(),r=null,o.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(n))})}function cT(t,e,n,r,i){return(o,l)=>{let a=n,c=e,s=0;o.subscribe(he(l,u=>{let d=s++;c=a?t(c,u,d):(a=!0,u),r&&l.next(c)},i&&(()=>{a&&l.next(c),l.complete()})))}}function Nr(t,e){return re(e)?dt(t,e,1):dt(t,1)}function Qp(t,e=W_){return ye((n,r)=>{let i=null,o=null,l=null,a=()=>{if(i){i.unsubscribe(),i=null;let s=o;o=null,r.next(s)}};function c(){let s=l+t,u=e.now();if(u<s){i=this.schedule(void 0,s-u),r.add(i);return}a()}n.subscribe(he(r,s=>{o=s,l=e.now(),i||(i=e.schedule(c,t),r.add(i))},()=>{a(),r.complete()},void 0,()=>{o=i=null}))})}function ui(t){return ye((e,n)=>{let r=!1;e.subscribe(he(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function Rr(t){return t<=0?()=>pn:ye((e,n)=>{let r=0;e.subscribe(he(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function Wu(t=sk){return ye((e,n)=>{let r=!1;e.subscribe(he(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function sk(){return new Pr}function ao(t){return ye((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function kr(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Dt((i,o)=>t(i,o,r)):fn,Rr(1),n?ui(e):Wu(()=>new Pr))}function Ds(t){return t<=0?()=>pn:ye((e,n)=>{let r=[];e.subscribe(he(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function Jp(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Dt((i,o)=>t(i,o,r)):fn,Ds(1),n?ui(e):Wu(()=>new Pr))}function eg(t,e){return ye(cT(t,e,arguments.length>=2,!0))}function tg(...t){let e=li(t);return ye((n,r)=>{(e?Ss(t,n,e):Ss(t,n)).subscribe(r)})}function on(t,e){return ye((n,r)=>{let i=null,o=0,l=!1,a=()=>l&&!i&&r.complete();n.subscribe(he(r,c=>{i?.unsubscribe();let s=0,u=o++;ut(t(c,u)).subscribe(i=he(r,d=>r.next(e?e(c,d,u,s++):d),()=>{i=null,a()}))},()=>{l=!0,a()}))})}function ng(t){return ye((e,n)=>{ut(t).subscribe(he(n,()=>n.complete(),cl)),!n.closed&&e.subscribe(n)})}function _t(t,e,n){let r=re(t)||e||n?{next:t,error:e,complete:n}:t;return r?ye((i,o)=>{var l;(l=r.subscribe)===null||l===void 0||l.call(r);let a=!0;i.subscribe(he(o,c=>{var s;(s=r.next)===null||s===void 0||s.call(r,c),o.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),o.complete()},c=>{var s;a=!1,(s=r.error)===null||s===void 0||s.call(r,c),o.error(c)},()=>{var c,s;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(s=r.finalize)===null||s===void 0||s.call(r)}))}):fn}var KT="https://g.co/ng/security#xss",W=class extends Error{code;constructor(e,n){super(Dd(e,n)),this.code=e}};function Dd(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}var ZT=Symbol("InputSignalNode#UNSET"),ak=N(C({},jp),{transformFn:void 0,applyValueToInputSignal(t,e){wu(t,e)}});function QT(t,e){let n=Object.create(ak);n.value=t,n.transformFn=e?.transform;function r(){if(mu(n),n.value===ZT)throw new W(-950,!1);return n.value}return r[hn]=n,r}function _l(t){return{toString:t}.toString()}var qu="__parameters__";function lk(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function JT(t,e,n){return _l(()=>{let r=lk(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let l=new i(...o);return a.annotation=l,a;function a(c,s,u){let d=c.hasOwnProperty(qu)?c[qu]:Object.defineProperty(c,qu,{value:[]})[qu];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(l),c}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var gg=globalThis;function Le(t){for(let e in t)if(t[e]===Le)return e;throw Error("Could not find renamed property on target object.")}function ck(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function qt(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(qt).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function uT(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var uk=Le({__forward_ref__:Le});function bi(t){return t.__forward_ref__=bi,t.toString=function(){return qt(this())},t}function Wt(t){return ex(t)?t():t}function ex(t){return typeof t=="function"&&t.hasOwnProperty(uk)&&t.__forward_ref__===bi}function H(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Vr(t){return{providers:t.providers||[],imports:t.imports||[]}}function Id(t){return dT(t,nx)||dT(t,rx)}function tx(t){return Id(t)!==null}function dT(t,e){return t.hasOwnProperty(e)?t[e]:null}function dk(t){let e=t&&(t[nx]||t[rx]);return e||null}function hT(t){return t&&(t.hasOwnProperty(fT)||t.hasOwnProperty(hk))?t[fT]:null}var nx=Le({\u0275prov:Le}),fT=Le({\u0275inj:Le}),rx=Le({ngInjectableDef:Le}),hk=Le({ngInjectorDef:Le}),z=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,n){this._desc=e,this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=H({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function ix(t){return t&&!!t.\u0275providers}var fk=Le({\u0275cmp:Le}),pk=Le({\u0275dir:Le}),gk=Le({\u0275pipe:Le}),mk=Le({\u0275mod:Le}),nd=Le({\u0275fac:Le}),gl=Le({__NG_ELEMENT_ID__:Le}),pT=Le({__NG_ENV_ID__:Le});function Od(t){return typeof t=="string"?t:t==null?"":String(t)}function yk(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():Od(t)}function vk(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new W(-200,t)}function om(t,e){throw new W(-201,!1)}var ue=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(ue||{}),mg;function ox(){return mg}function sn(t){let e=mg;return mg=t,e}function sx(t,e,n){let r=Id(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&ue.Optional)return null;if(e!==void 0)return e;om(t,"Injector")}var bk={},ml=bk,yg="__NG_DI_FLAG__",rd="ngTempTokenPath",wk="ngTokenPath",_k=/\n/gm,Tk="\u0275",gT="__source",Ps;function xk(){return Ps}function di(t){let e=Ps;return Ps=t,e}function Ek(t,e=ue.Default){if(Ps===void 0)throw new W(-203,!1);return Ps===null?sx(t,void 0,e):Ps.get(t,e&ue.Optional?null:void 0,e)}function Y(t,e=ue.Default){return(ox()||Ek)(Wt(t),e)}function B(t,e=ue.Default){return Y(t,Ad(e))}function Ad(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function vg(t){let e=[];for(let n=0;n<t.length;n++){let r=Wt(t[n]);if(Array.isArray(r)){if(r.length===0)throw new W(900,!1);let i,o=ue.Default;for(let l=0;l<r.length;l++){let a=r[l],c=Ck(a);typeof c=="number"?c===-1?i=a.token:o|=c:i=a}e.push(Y(i,o))}else e.push(Y(r))}return e}function ax(t,e){return t[yg]=e,t.prototype[yg]=e,t}function Ck(t){return t[yg]}function Sk(t,e,n,r){let i=t[rd];throw e[gT]&&i.unshift(e[gT]),t.message=Dk(`
`+t.message,i,n,r),t[wk]=i,t[rd]=null,t}function Dk(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==Tk?t.slice(2):t;let i=qt(e);if(Array.isArray(e))i=e.map(qt).join(" -> ");else if(typeof e=="object"){let o=[];for(let l in e)if(e.hasOwnProperty(l)){let a=e[l];o.push(l+":"+(typeof a=="string"?JSON.stringify(a):qt(a)))}i=`{${o.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(_k,`
  `)}`}var lx=ax(JT("Optional"),8);var Ik=ax(JT("SkipSelf"),4);function co(t,e){let n=t.hasOwnProperty(nd);return n?t[nd]:null}function sm(t,e){t.forEach(n=>Array.isArray(n)?sm(n,e):e(n))}function cx(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function id(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function Ok(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let o=i-2;t[i]=t[o],i--}t[e]=n,t[e+1]=r}}function Ak(t,e,n){let r=Tl(t,e);return r>=0?t[r|1]=n:(r=~r,Ok(t,r,e,n)),r}function rg(t,e){let n=Tl(t,e);if(n>=0)return t[n|1]}function Tl(t,e){return Mk(t,e,1)}function Mk(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let o=r+(i-r>>1),l=t[o<<n];if(e===l)return o<<n;l>e?i=o:r=o+1}return~(i<<n)}var Rs={},Mn=[],ks=new z(""),ux=new z("",-1),dx=new z(""),od=class{get(e,n=ml){if(n===ml){let r=new Error(`NullInjectorError: No provider for ${qt(e)}!`);throw r.name="NullInjectorError",r}return n}};function hx(t,e){let n=t[mk]||null;if(!n&&e===!0)throw new Error(`Type ${qt(t)} does not have '\u0275mod' property.`);return n}function pi(t){return t[fk]||null}function fx(t){return t[pk]||null}function px(t){return t[gk]||null}function gx(t){let e=pi(t)||fx(t)||px(t);return e!==null&&e.standalone}function Ys(t){return{\u0275providers:t}}function Pk(...t){return{\u0275providers:mx(!0,t),\u0275fromNgModule:!0}}function mx(t,...e){let n=[],r=new Set,i,o=l=>{n.push(l)};return sm(e,l=>{let a=l;bg(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&yx(i,o),n}function yx(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];am(i,o=>{e(o,r)})}}function bg(t,e,n,r){if(t=Wt(t),!t)return!1;let i=null,o=hT(t),l=!o&&pi(t);if(!o&&!l){let c=t.ngModule;if(o=hT(c),o)i=c;else return!1}else{if(l&&!l.standalone)return!1;i=t}let a=r.has(i);if(l){if(a)return!1;if(r.add(i),l.dependencies){let c=typeof l.dependencies=="function"?l.dependencies():l.dependencies;for(let s of c)bg(s,e,n,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let s;try{sm(o.imports,u=>{bg(u,e,n,r)&&(s||=[],s.push(u))})}finally{}s!==void 0&&yx(s,e)}if(!a){let s=co(i)||(()=>new i);e({provide:i,useFactory:s,deps:Mn},i),e({provide:dx,useValue:i,multi:!0},i),e({provide:ks,useValue:()=>Y(i),multi:!0},i)}let c=o.providers;if(c!=null&&!a){let s=t;am(c,u=>{e(u,s)})}}else return!1;return i!==t&&t.providers!==void 0}function am(t,e){for(let n of t)ix(n)&&(n=n.\u0275providers),Array.isArray(n)?am(n,e):e(n)}var Nk=Le({provide:String,useValue:Le});function vx(t){return t!==null&&typeof t=="object"&&Nk in t}function Rk(t){return!!(t&&t.useExisting)}function kk(t){return!!(t&&t.useFactory)}function Fs(t){return typeof t=="function"}function Fk(t){return!!t.useClass}var Md=new z(""),Zu={},Lk={},ig;function lm(){return ig===void 0&&(ig=new od),ig}var Yt=class{},yl=class extends Yt{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,_g(e,l=>this.processProvider(l)),this.records.set(ux,Is(void 0,this)),i.has("environment")&&this.records.set(Yt,Is(void 0,this));let o=this.records.get(Md);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(dx,Mn,ue.Self))}destroy(){fl(this),this._destroyed=!0;let e=_e(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),_e(e)}}onDestroy(e){return fl(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){fl(this);let n=di(this),r=sn(void 0),i;try{return e()}finally{di(n),sn(r)}}get(e,n=ml,r=ue.Default){if(fl(this),e.hasOwnProperty(pT))return e[pT](this);r=Ad(r);let i,o=di(this),l=sn(void 0);try{if(!(r&ue.SkipSelf)){let c=this.records.get(e);if(c===void 0){let s=Uk(e)&&Id(e);s&&this.injectableDefInScope(s)?c=Is(wg(e),Zu):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ue.Self?lm():this.parent;return n=r&ue.Optional&&n===ml?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[rd]=a[rd]||[]).unshift(qt(e)),o)throw a;return Sk(a,e,"R3InjectorError",this.source)}else throw a}finally{sn(l),di(o)}}resolveInjectorInitializers(){let e=_e(null),n=di(this),r=sn(void 0),i;try{let o=this.get(ks,Mn,ue.Self);for(let l of o)l()}finally{di(n),sn(r),_e(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(qt(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=Wt(e);let n=Fs(e)?e:Wt(e&&e.provide),r=jk(e);if(!Fs(e)&&e.multi===!0){let i=this.records.get(n);i||(i=Is(void 0,Zu,!0),i.factory=()=>vg(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){let r=_e(null);try{return n.value===Zu&&(n.value=Lk,n.value=n.factory()),typeof n.value=="object"&&n.value&&$k(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{_e(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Wt(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function wg(t){let e=Id(t),n=e!==null?e.factory:co(t);if(n!==null)return n;if(t instanceof z)throw new W(204,!1);if(t instanceof Function)return Bk(t);throw new W(204,!1)}function Bk(t){if(t.length>0)throw new W(204,!1);let n=dk(t);return n!==null?()=>n.factory(t):()=>new t}function jk(t){if(vx(t))return Is(void 0,t.useValue);{let e=bx(t);return Is(e,Zu)}}function bx(t,e,n){let r;if(Fs(t)){let i=Wt(t);return co(i)||wg(i)}else if(vx(t))r=()=>Wt(t.useValue);else if(kk(t))r=()=>t.useFactory(...vg(t.deps||[]));else if(Rk(t))r=()=>Y(Wt(t.useExisting));else{let i=Wt(t&&(t.useClass||t.provide));if(Vk(t))r=()=>new i(...vg(t.deps));else return co(i)||wg(i)}return r}function fl(t){if(t.destroyed)throw new W(205,!1)}function Is(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function Vk(t){return!!t.deps}function $k(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function Uk(t){return typeof t=="function"||typeof t=="object"&&t instanceof z}function _g(t,e){for(let n of t)Array.isArray(n)?_g(n,e):n&&ix(n)?_g(n.\u0275providers,e):e(n)}function an(t,e){t instanceof yl&&fl(t);let n,r=di(t),i=sn(void 0);try{return e()}finally{di(r),sn(i)}}function wx(){return ox()!==void 0||xk()!=null}function Hk(t){if(!wx())throw new W(-203,!1)}function Gk(t){return typeof t=="function"}var $r=0,ve=1,ne=2,Xt=3,Qn=4,er=5,sd=6,ad=7,Jn=8,Ls=9,Fr=10,ht=11,vl=12,mT=13,Xs=14,pr=15,Bs=16,Os=17,js=18,Pd=19,_x=20,hi=21,og=22,ld=23,gn=24,mn=25,Tx=1;var uo=7,cd=8,ud=9,Nn=10;function fi(t){return Array.isArray(t)&&typeof t[Tx]=="object"}function Ur(t){return Array.isArray(t)&&t[Tx]===!0}function cm(t){return(t.flags&4)!==0}function Nd(t){return t.componentOffset>-1}function Rd(t){return(t.flags&1)===1}function gi(t){return!!t.template}function Tg(t){return(t[ne]&512)!==0}function xl(t){return(t[ne]&256)===256}var xg=class{previousValue;currentValue;firstChange;constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function xx(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}var yo=(()=>{let t=()=>Ex;return t.ngInherit=!0,t})();function Ex(t){return t.type.prototype.ngOnChanges&&(t.setInput=Wk),zk}function zk(){let t=Sx(this),e=t?.current;if(e){let n=t.previous;if(n===Rs)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function Wk(t,e,n,r,i){let o=this.declaredInputs[r],l=Sx(t)||qk(t,{previous:Rs,current:null}),a=l.current||(l.current={}),c=l.previous,s=c[o];a[o]=new xg(s&&s.currentValue,n,c===Rs),xx(t,e,i,n)}var Cx="__ngSimpleChanges__";function Sx(t){return t[Cx]||null}function qk(t,e){return t[Cx]=e}var yT=null;var Pn=function(t,e,n){yT?.(t,e,n)},Yk="svg",Xk="math";function gr(t){for(;Array.isArray(t);)t=t[$r];return t}function Dx(t,e){return gr(e[t])}function Rn(t,e){return gr(e[t.index])}function Ix(t,e){return t.data[e]}function Ox(t,e){return t[e]}function wi(t,e){let n=e[t];return fi(n)?n:n[$r]}function um(t){return(t[ne]&128)===128}function Kk(t){return Ur(t[Xt])}function Vs(t,e){return e==null?null:t[e]}function Ax(t){t[Os]=0}function dm(t){t[ne]&1024||(t[ne]|=1024,um(t)&&Fd(t))}function Zk(t,e){for(;t>0;)e=e[Xs],t--;return e}function kd(t){return!!(t[ne]&9216||t[gn]?.dirty)}function Eg(t){t[Fr].changeDetectionScheduler?.notify(9),t[ne]&64&&(t[ne]|=1024),kd(t)&&Fd(t)}function Fd(t){t[Fr].changeDetectionScheduler?.notify(0);let e=ho(t);for(;e!==null&&!(e[ne]&8192||(e[ne]|=8192,!um(e)));)e=ho(e)}function Mx(t,e){if(xl(t))throw new W(911,!1);t[hi]===null&&(t[hi]=[]),t[hi].push(e)}function Qk(t,e){if(t[hi]===null)return;let n=t[hi].indexOf(e);n!==-1&&t[hi].splice(n,1)}function ho(t){let e=t[Xt];return Ur(e)?e[Xt]:e}function Jk(t){return t[ad]??=[]}function eF(t){return t.cleanup??=[]}var fe={lFrame:Vx(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Cg=!1;function tF(){return fe.lFrame.elementDepthCount}function nF(){fe.lFrame.elementDepthCount++}function rF(){fe.lFrame.elementDepthCount--}function Px(){return fe.bindingsEnabled}function iF(){return fe.skipHydrationRootTNode!==null}function oF(t){return fe.skipHydrationRootTNode===t}function sF(){fe.skipHydrationRootTNode=null}function Re(){return fe.lFrame.lView}function kt(){return fe.lFrame.tView}function yr(t){return fe.lFrame.contextLView=t,t[Jn]}function vr(t){return fe.lFrame.contextLView=null,t}function Ft(){let t=Nx();for(;t!==null&&t.type===64;)t=t.parent;return t}function Nx(){return fe.lFrame.currentTNode}function aF(){let t=fe.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function vo(t,e){let n=fe.lFrame;n.currentTNode=t,n.isParent=e}function hm(){return fe.lFrame.isParent}function Rx(){fe.lFrame.isParent=!1}function lF(){return fe.lFrame.contextLView}function kx(){return Cg}function vT(t){let e=Cg;return Cg=t,e}function Fx(){let t=fe.lFrame,e=t.bindingRootIndex;return e===-1&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function cF(t){return fe.lFrame.bindingIndex=t}function Ld(){return fe.lFrame.bindingIndex++}function uF(t){let e=fe.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function dF(){return fe.lFrame.inI18n}function hF(t,e){let n=fe.lFrame;n.bindingIndex=n.bindingRootIndex=t,Sg(e)}function fF(){return fe.lFrame.currentDirectiveIndex}function Sg(t){fe.lFrame.currentDirectiveIndex=t}function pF(t){let e=fe.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function Lx(t){fe.lFrame.currentQueryIndex=t}function gF(t){let e=t[ve];return e.type===2?e.declTNode:e.type===1?t[er]:null}function Bx(t,e,n){if(n&ue.SkipSelf){let i=e,o=t;for(;i=i.parent,i===null&&!(n&ue.Host);)if(i=gF(o),i===null||(o=o[Xs],i.type&10))break;if(i===null)return!1;e=i,t=o}let r=fe.lFrame=jx();return r.currentTNode=e,r.lView=t,!0}function fm(t){let e=jx(),n=t[ve];fe.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function jx(){let t=fe.lFrame,e=t===null?null:t.child;return e===null?Vx(t):e}function Vx(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function $x(){let t=fe.lFrame;return fe.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var Ux=$x;function pm(){let t=$x();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function mF(t){return(fe.lFrame.contextLView=Zk(t,fe.lFrame.contextLView))[Jn]}function Ks(){return fe.lFrame.selectedIndex}function fo(t){fe.lFrame.selectedIndex=t}function gm(){let t=fe.lFrame;return Ix(t.tView,t.selectedIndex)}function yF(){return fe.lFrame.currentNamespace}var Hx=!0;function Bd(){return Hx}function jd(t){Hx=t}function vF(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let l=Ex(e);(n.preOrderHooks??=[]).push(t,l),(n.preOrderCheckHooks??=[]).push(t,l)}i&&(n.preOrderHooks??=[]).push(0-t,i),o&&((n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o))}function Vd(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let o=t.data[n].type.prototype,{ngAfterContentInit:l,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:s,ngOnDestroy:u}=o;l&&(t.contentHooks??=[]).push(-n,l),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),c&&(t.viewHooks??=[]).push(-n,c),s&&((t.viewHooks??=[]).push(n,s),(t.viewCheckHooks??=[]).push(n,s)),u!=null&&(t.destroyHooks??=[]).push(n,u)}}function Qu(t,e,n){Gx(t,e,3,n)}function Ju(t,e,n,r){(t[ne]&3)===n&&Gx(t,e,n,r)}function sg(t,e){let n=t[ne];(n&3)===e&&(n&=16383,n+=1,t[ne]=n)}function Gx(t,e,n,r){let i=r!==void 0?t[Os]&65535:0,o=r??-1,l=e.length-1,a=0;for(let c=i;c<l;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(t[Os]+=65536),(a<o||o==-1)&&(bF(t,n,e,c),t[Os]=(t[Os]&4294901760)+c+2),c++}function bT(t,e){Pn(4,t,e);let n=_e(null);try{e.call(t)}finally{_e(n),Pn(5,t,e)}}function bF(t,e,n,r){let i=n[r]<0,o=n[r+1],l=i?-n[r]:n[r],a=t[l];i?t[ne]>>14<t[Os]>>16&&(t[ne]&3)===e&&(t[ne]+=16384,bT(a,o)):bT(a,o)}var Ns=-1,po=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,n,r){this.factory=e,this.canSeeViewProviders=n,this.injectImpl=r}};function wF(t){return t instanceof po}function _F(t){return(t.flags&8)!==0}function TF(t){return(t.flags&16)!==0}function xF(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let o=n[r++],l=n[r++],a=n[r++];t.setAttribute(e,l,a,o)}else{let o=i,l=n[++r];EF(o)?t.setProperty(e,o,l):t.setAttribute(e,o,l),r++}}return r}function zx(t){return t===3||t===4||t===6}function EF(t){return t.charCodeAt(0)===64}function $s(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?wT(t,n,i,null,e[++r]):wT(t,n,i,null,null))}}return t}function wT(t,e,n,r,i){let o=0,l=t.length;if(e===-1)l=-1;else for(;o<t.length;){let a=t[o++];if(typeof a=="number"){if(a===e){l=-1;break}else if(a>e){l=o-1;break}}}for(;o<t.length;){let a=t[o];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[o+1]=i);return}else if(r===t[o+1]){t[o+2]=i;return}}o++,r!==null&&o++,i!==null&&o++}l!==-1&&(t.splice(l,0,e),o=l+1),t.splice(o++,0,n),r!==null&&t.splice(o++,0,r),i!==null&&t.splice(o++,0,i)}var ag={},Dg=class{injector;parentInjector;constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Ad(r);let i=this.injector.get(e,ag,r);return i!==ag||n===ag?i:this.parentInjector.get(e,n,r)}};function Wx(t){return t!==Ns}function dd(t){return t&32767}function CF(t){return t>>16}function hd(t,e){let n=CF(t),r=e;for(;n>0;)r=r[Xs],n--;return r}var Ig=!0;function fd(t){let e=Ig;return Ig=t,e}var SF=256,qx=SF-1,Yx=5,DF=0,fr={};function IF(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(gl)&&(r=n[gl]),r==null&&(r=n[gl]=DF++);let i=r&qx,o=1<<i;e.data[t+(i>>Yx)]|=o}function pd(t,e){let n=Xx(t,e);if(n!==-1)return n;let r=e[ve];r.firstCreatePass&&(t.injectorIndex=e.length,lg(r.data,t),lg(e,null),lg(r.blueprint,null));let i=mm(t,e),o=t.injectorIndex;if(Wx(i)){let l=dd(i),a=hd(i,e),c=a[ve].data;for(let s=0;s<8;s++)e[o+s]=a[l+s]|c[l+s]}return e[o+8]=i,o}function lg(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Xx(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function mm(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=eE(i),r===null)return Ns;if(n++,i=i[Xs],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Ns}function Og(t,e,n){IF(t,e,n)}function OF(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let o=n[i];if(zx(o))break;if(o===0)i=i+2;else if(typeof o=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(o===e)return n[i+1];i=i+2}}}return null}function Kx(t,e,n){if(n&ue.Optional||t!==void 0)return t;om(e,"NodeInjector")}function Zx(t,e,n,r){if(n&ue.Optional&&r===void 0&&(r=null),!(n&(ue.Self|ue.Host))){let i=t[Ls],o=sn(void 0);try{return i?i.get(e,r,n&ue.Optional):sx(e,r,n&ue.Optional)}finally{sn(o)}}return Kx(r,e,n)}function Qx(t,e,n,r=ue.Default,i){if(t!==null){if(e[ne]&2048&&!(r&ue.Self)){let l=RF(t,e,n,r,fr);if(l!==fr)return l}let o=Jx(t,e,n,r,fr);if(o!==fr)return o}return Zx(e,n,r,i)}function Jx(t,e,n,r,i){let o=PF(n);if(typeof o=="function"){if(!Bx(e,t,r))return r&ue.Host?Kx(i,n,r):Zx(e,n,r,i);try{let l;if(l=o(r),l==null&&!(r&ue.Optional))om(n);else return l}finally{Ux()}}else if(typeof o=="number"){let l=null,a=Xx(t,e),c=Ns,s=r&ue.Host?e[pr][er]:null;for((a===-1||r&ue.SkipSelf)&&(c=a===-1?mm(t,e):e[a+8],c===Ns||!TT(r,!1)?a=-1:(l=e[ve],a=dd(c),e=hd(c,e)));a!==-1;){let u=e[ve];if(_T(o,a,u.data)){let d=AF(a,e,n,l,r,s);if(d!==fr)return d}c=e[a+8],c!==Ns&&TT(r,e[ve].data[a+8]===s)&&_T(o,a,e)?(l=u,a=dd(c),e=hd(c,e)):a=-1}}return i}function AF(t,e,n,r,i,o){let l=e[ve],a=l.data[t+8],c=r==null?Nd(a)&&Ig:r!=l&&(a.type&3)!==0,s=i&ue.Host&&o===a,u=MF(a,l,n,c,s);return u!==null?Us(e,l,u,a):fr}function MF(t,e,n,r,i){let o=t.providerIndexes,l=e.data,a=o&1048575,c=t.directiveStart,s=t.directiveEnd,u=o>>20,d=r?a:a+u,h=i?a+u:s;for(let f=d;f<h;f++){let p=l[f];if(f<c&&n===p||f>=c&&p.type===n)return f}if(i){let f=l[c];if(f&&gi(f)&&f.type===n)return c}return null}function Us(t,e,n,r){let i=t[n],o=e.data;if(wF(i)){let l=i;l.resolving&&vk(yk(o[n]));let a=fd(l.canSeeViewProviders);l.resolving=!0;let c,s=l.injectImpl?sn(l.injectImpl):null,u=Bx(t,r,ue.Default);try{i=t[n]=l.factory(void 0,o,t,r),e.firstCreatePass&&n>=r.directiveStart&&vF(n,o[n],e)}finally{s!==null&&sn(s),fd(a),l.resolving=!1,Ux()}}return i}function PF(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(gl)?t[gl]:void 0;return typeof e=="number"?e>=0?e&qx:NF:e}function _T(t,e,n){let r=1<<t;return!!(n[e+(t>>Yx)]&r)}function TT(t,e){return!(t&ue.Self)&&!(t&ue.Host&&e)}var lo=class{_tNode;_lView;constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return Qx(this._tNode,this._lView,e,Ad(r),n)}};function NF(){return new lo(Ft(),Re())}function _i(t){return _l(()=>{let e=t.prototype.constructor,n=e[nd]||Ag(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let o=i[nd]||Ag(i);if(o&&o!==n)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function Ag(t){return ex(t)?()=>{let e=Ag(Wt(t));return e&&e()}:co(t)}function RF(t,e,n,r,i){let o=t,l=e;for(;o!==null&&l!==null&&l[ne]&2048&&!(l[ne]&512);){let a=Jx(o,l,n,r|ue.Self,fr);if(a!==fr)return a;let c=o.parent;if(!c){let s=l[_x];if(s){let u=s.get(n,fr,r);if(u!==fr)return u}c=eE(l),l=l[Xs]}o=c}return i}function eE(t){let e=t[ve],n=e.type;return n===2?e.declTNode:n===1?t[er]:null}function ym(t){return OF(Ft(),t)}function xT(t,e=null,n=null,r){let i=tE(t,e,n,r);return i.resolveInjectorInitializers(),i}function tE(t,e=null,n=null,r,i=new Set){let o=[n||Mn,Pk(t)];return r=r||(typeof t=="object"?void 0:qt(t)),new yl(o,e||lm(),r||null,i)}var yn=class t{static THROW_IF_NOT_FOUND=ml;static NULL=new od;static create(e,n){if(Array.isArray(e))return xT({name:""},n,e,"");{let r=e.name??"";return xT({name:r},e.parent,e.providers,r)}}static \u0275prov=H({token:t,providedIn:"any",factory:()=>Y(ux)});static __NG_ELEMENT_ID__=-1};var kF=new z("");kF.__NG_ELEMENT_ID__=t=>{let e=Ft();if(e===null)throw new W(204,!1);if(e.type&2)return e.value;if(t&ue.Optional)return null;throw new W(204,!1)};var nE=!1,vm=(()=>{class t{static __NG_ELEMENT_ID__=FF;static __NG_ENV_ID__=n=>n}return t})(),Mg=class extends vm{_lView;constructor(e){super(),this._lView=e}onDestroy(e){return Mx(this._lView,e),()=>Qk(this._lView,e)}};function FF(){return new Mg(Re())}var Hs=class{},$d=new z("",{providedIn:"root",factory:()=>!1});var rE=new z(""),iE=new z(""),Ti=(()=>{class t{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new Je(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let n=this.taskId++;return this.pendingTasks.add(n),n}has(n){return this.pendingTasks.has(n)}remove(n){this.pendingTasks.delete(n),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=H({token:t,providedIn:"root",factory:()=>new t})}return t})();var Pg=class extends yt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,wx()&&(this.destroyRef=B(vm,{optional:!0})??void 0,this.pendingTasks=B(Ti,{optional:!0})??void 0)}emit(e){let n=_e(null);try{super.next(e)}finally{_e(n)}}subscribe(e,n,r){let i=e,o=n||(()=>null),l=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),o=c.error?.bind(c),l=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),l&&(l=this.wrapInTimeout(l)));let a=super.subscribe({next:i,error:o,complete:l});return e instanceof Qe&&e.add(a),a}wrapInTimeout(e){return n=>{let r=this.pendingTasks?.add();setTimeout(()=>{e(n),r!==void 0&&this.pendingTasks?.remove(r)})}}},It=Pg;function gd(...t){}function oE(t){let e,n;function r(){t=gd;try{n!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(n),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{t(),r()}),typeof requestAnimationFrame=="function"&&(n=requestAnimationFrame(()=>{t(),r()})),()=>r()}function ET(t){return queueMicrotask(()=>t()),()=>{t=gd}}var bm="isAngularZone",md=bm+"_ID",LF=0,et=class t{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new It(!1);onMicrotaskEmpty=new It(!1);onStable=new It(!1);onError=new It(!1);constructor(e){let{enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=nE}=e;if(typeof Zone>"u")throw new W(908,!1);Zone.assertZonePatched();let l=this;l._nesting=0,l._outer=l._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(l._inner=l._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(l._inner=l._inner.fork(Zone.longStackTraceZoneSpec)),l.shouldCoalesceEventChangeDetection=!i&&r,l.shouldCoalesceRunChangeDetection=i,l.callbackScheduled=!1,l.scheduleInRootZone=o,VF(l)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(bm)===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new W(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new W(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let o=this._inner,l=o.scheduleEventTask("NgZoneEvent: "+i,e,BF,gd,gd);try{return o.runTask(l,n,r)}finally{o.cancelTask(l)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},BF={};function wm(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function jF(t){if(t.isCheckStableRunning||t.callbackScheduled)return;t.callbackScheduled=!0;function e(){oE(()=>{t.callbackScheduled=!1,Ng(t),t.isCheckStableRunning=!0,wm(t),t.isCheckStableRunning=!1})}t.scheduleInRootZone?Zone.root.run(()=>{e()}):t._outer.run(()=>{e()}),Ng(t)}function VF(t){let e=()=>{jF(t)},n=LF++;t._inner=t._inner.fork({name:"angular",properties:{[bm]:!0,[md]:n,[md+n]:!0},onInvokeTask:(r,i,o,l,a,c)=>{if($F(c))return r.invokeTask(o,l,a,c);try{return CT(t),r.invokeTask(o,l,a,c)}finally{(t.shouldCoalesceEventChangeDetection&&l.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),ST(t)}},onInvoke:(r,i,o,l,a,c,s)=>{try{return CT(t),r.invoke(o,l,a,c,s)}finally{t.shouldCoalesceRunChangeDetection&&!t.callbackScheduled&&!UF(c)&&e(),ST(t)}},onHasTask:(r,i,o,l)=>{r.hasTask(o,l),i===o&&(l.change=="microTask"?(t._hasPendingMicrotasks=l.microTask,Ng(t),wm(t)):l.change=="macroTask"&&(t.hasPendingMacrotasks=l.macroTask))},onHandleError:(r,i,o,l)=>(r.handleError(o,l),t.runOutsideAngular(()=>t.onError.emit(l)),!1)})}function Ng(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.callbackScheduled===!0?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function CT(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function ST(t){t._nesting--,wm(t)}var Rg=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new It;onMicrotaskEmpty=new It;onStable=new It;onError=new It;run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function $F(t){return sE(t,"__ignore_ng_zone__")}function UF(t){return sE(t,"__scheduler_tick__")}function sE(t,e){return!Array.isArray(t)||t.length!==1?!1:t[0]?.data?.[e]===!0}var Lr=class{_console=console;handleError(e){this._console.error("ERROR",e)}},HF=new z("",{providedIn:"root",factory:()=>{let t=B(et),e=B(Lr);return n=>t.runOutsideAngular(()=>e.handleError(n))}});function DT(t,e){return QT(t,e)}function GF(t){return QT(ZT,t)}var aE=(DT.required=GF,DT);function zF(){return Ud(Ft(),Re())}function Ud(t,e){return new Hr(Rn(t,e))}var Hr=(()=>{class t{nativeElement;constructor(n){this.nativeElement=n}static __NG_ELEMENT_ID__=zF}return t})();var IT=new Set;function bo(t){IT.has(t)||(IT.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function WF(t){return typeof t=="function"&&t[hn]!==void 0}function Hd(t,e){bo("NgSignals");let n=L_(t),r=n[hn];return e?.equal&&(r.equal=e.equal),n.set=i=>wu(r,i),n.update=i=>B_(r,i),n.asReadonly=qF.bind(n),n}function qF(){let t=this[hn];if(t.readonlyFn===void 0){let e=()=>this();e[hn]=t,t.readonlyFn=e}return t.readonlyFn}function lE(t){return WF(t)&&typeof t.set=="function"}function cE(t){return(t.flags&128)===128}var uE=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(uE||{}),dE=new Map,YF=0;function XF(){return YF++}function KF(t){dE.set(t[Pd],t)}function kg(t){dE.delete(t[Pd])}var OT="__ngContext__";function mi(t,e){fi(e)?(t[OT]=e[Pd],KF(e)):t[OT]=e}function hE(t){return pE(t[vl])}function fE(t){return pE(t[Qn])}function pE(t){for(;t!==null&&!Ur(t);)t=t[Qn];return t}var Fg;function gE(t){Fg=t}function ZF(){if(Fg!==void 0)return Fg;if(typeof document<"u")return document;throw new W(210,!1)}var _m=new z("",{providedIn:"root",factory:()=>QF}),QF="ng",Tm=new z(""),xi=new z("",{providedIn:"platform",factory:()=>"unknown"});var xm=new z("",{providedIn:"root",factory:()=>ZF().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var JF="h",eL="b";var mE=!1,tL=new z("",{providedIn:"root",factory:()=>mE});var Em=function(t){return t[t.CHANGE_DETECTION=0]="CHANGE_DETECTION",t[t.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",t}(Em||{}),Zs=new z("");var As=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(As||{}),yE=(()=>{class t{impl=null;execute(){this.impl?.execute()}static \u0275prov=H({token:t,providedIn:"root",factory:()=>new t})}return t})(),nL=[As.EarlyRead,As.Write,As.MixedReadWrite,As.Read],rL=(()=>{class t{ngZone=B(et);scheduler=B(Hs);errorHandler=B(Lr,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){B(Zs,{optional:!0})}execute(){this.executing=!0;for(let n of nL)for(let r of this.sequences)if(!(r.erroredOrDestroyed||!r.hooks[n]))try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>r.hooks[n](r.pipelinedValue),r.snapshot))}catch(i){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(i)}this.executing=!1;for(let n of this.sequences)n.afterRun(),n.once&&(this.sequences.delete(n),n.destroy());for(let n of this.deferredRegistrations)this.sequences.add(n);this.deferredRegistrations.size>0&&this.scheduler.notify(8),this.deferredRegistrations.clear()}register(n){this.executing?this.deferredRegistrations.add(n):(this.sequences.add(n),this.scheduler.notify(7))}unregister(n){this.executing&&this.sequences.has(n)?(n.erroredOrDestroyed=!0,n.pipelinedValue=void 0,n.once=!0):(this.sequences.delete(n),this.deferredRegistrations.delete(n))}maybeTrace(n,r){return r?r.run(Em.AFTER_NEXT_RENDER,n):n()}static \u0275prov=H({token:t,providedIn:"root",factory:()=>new t})}return t})(),Lg=class{impl;hooks;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,n,r,i,o=null){this.impl=e,this.hooks=n,this.once=r,this.snapshot=o,this.unregisterOnDestroy=i?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.()}};function Cm(t,e){!e?.injector&&Hk(Cm);let n=e?.injector??B(yn);return bo("NgAfterNextRender"),oL(t,n,e,!0)}function iL(t,e){if(t instanceof Function){let n=[void 0,void 0,void 0,void 0];return n[e]=t,n}else return[t.earlyRead,t.write,t.mixedReadWrite,t.read]}function oL(t,e,n,r){let i=e.get(yE);i.impl??=e.get(rL);let o=e.get(Zs,null,{optional:!0}),l=n?.phase??As.MixedReadWrite,a=n?.manualCleanup!==!0?e.get(vm):null,c=new Lg(i.impl,iL(t,l),r,a,o?.snapshot(null));return i.impl.register(c),c}var sL=()=>null;function Sm(t,e,n=!1){return sL(t,e,n)}function vE(t,e){let n=t.contentQueries;if(n!==null){let r=_e(null);try{for(let i=0;i<n.length;i+=2){let o=n[i],l=n[i+1];if(l!==-1){let a=t.data[l];Lx(o),a.contentQueries(2,e[l],l)}}}finally{_e(r)}}}function Bg(t,e,n){Lx(0);let r=_e(null);try{e(t,n)}finally{_e(r)}}function Dm(t,e,n){if(cm(e)){let r=_e(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let l=i;l<o;l++){let a=t.data[l];if(a.contentQueries){let c=n[l];a.contentQueries(1,c,l)}}}finally{_e(r)}}}var mr=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(mr||{});var Yu;function aL(){if(Yu===void 0&&(Yu=null,gg.trustedTypes))try{Yu=gg.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Yu}function AT(t){return aL()?.createScriptURL(t)||t}var yd=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${KT})`}};function El(t){return t instanceof yd?t.changingThisBreaksApplicationSecurity:t}function Im(t,e){let n=lL(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${KT})`)}return n===e}function lL(t){return t instanceof yd&&t.getTypeName()||null}var cL=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function bE(t){return t=String(t),t.match(cL)?t:"unsafe:"+t}var Gd=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Gd||{});function Om(t){let e=_E();return e?e.sanitize(Gd.URL,t)||"":Im(t,"URL")?El(t):bE(Od(t))}function uL(t){let e=_E();if(e)return AT(e.sanitize(Gd.RESOURCE_URL,t)||"");if(Im(t,"ResourceURL"))return AT(El(t));throw new W(904,!1)}function dL(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?uL:Om}function wE(t,e,n){return dL(e,n)(t)}function _E(){let t=Re();return t&&t[Fr].sanitizer}var hL=/^>|^->|<!--|-->|--!>|<!-$/g,fL=/(<|>)/g,pL="\u200B$1\u200B";function gL(t){return t.replace(hL,e=>e.replace(fL,pL))}function TE(t){return t.ownerDocument.defaultView}function xE(t){return t instanceof Function?t():t}var yi=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(yi||{});function mL(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||t.charCodeAt(i+o)<=32)return i}n=i+1}}var EE="ng-template";function yL(t,e,n,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&mL(e[i+1].toLowerCase(),n,0)!==-1)return!0}else if(Am(t))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===n)return!0}return!1}function Am(t){return t.type===4&&t.value!==EE}function vL(t,e,n){let r=t.type===4&&!n?EE:t.value;return e===r}function bL(t,e,n){let r=4,i=t.attrs,o=i!==null?TL(i):0,l=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!l&&!Zn(r)&&!Zn(c))return!1;if(l&&Zn(c))continue;l=!1,r=c|r&1;continue}if(!l)if(r&4){if(r=2|r&1,c!==""&&!vL(t,c,n)||c===""&&e.length===1){if(Zn(r))return!1;l=!0}}else if(r&8){if(i===null||!yL(t,i,c,n)){if(Zn(r))return!1;l=!0}}else{let s=e[++a],u=wL(c,i,Am(t),n);if(u===-1){if(Zn(r))return!1;l=!0;continue}if(s!==""){let d;if(u>o?d="":d=i[u+1].toLowerCase(),r&2&&s!==d){if(Zn(r))return!1;l=!0}}}}return Zn(r)||l}function Zn(t){return(t&1)===0}function wL(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let o=!1;for(;i<e.length;){let l=e[i];if(l===t)return i;if(l===3||l===6)o=!0;else if(l===1||l===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(l===4)break;if(l===0){i+=4;continue}}i+=o?1:2}return-1}else return xL(e,t)}function _L(t,e,n=!1){for(let r=0;r<e.length;r++)if(bL(t,e[r],n))return!0;return!1}function TL(t){for(let e=0;e<t.length;e++){let n=t[e];if(zx(n))return e}return t.length}function xL(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function MT(t,e){return t?":not("+e.trim()+")":e}function EL(t){let e=t[0],n=1,r=2,i="",o=!1;for(;n<t.length;){let l=t[n];if(typeof l=="string")if(r&2){let a=t[++n];i+="["+l+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+l:r&4&&(i+=" "+l);else i!==""&&!Zn(l)&&(e+=MT(o,i),i=""),r=l,o=o||!Zn(r);n++}return i!==""&&(e+=MT(o,i)),e}function CL(t){return t.map(EL).join(",")}function SL(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let o=t[r];if(typeof o=="string")i===2?o!==""&&e.push(o,t[++r]):i===8&&n.push(o);else{if(!Zn(i))break;i=o}r++}return{attrs:e,classes:n}}var wo={};function ie(t=1){CE(kt(),Re(),Ks()+t,!1)}function CE(t,e,n,r){if(!r)if((e[ne]&3)===3){let o=t.preOrderCheckHooks;o!==null&&Qu(e,o,n)}else{let o=t.preOrderHooks;o!==null&&Ju(e,o,0,n)}fo(n)}function te(t,e=ue.Default){let n=Re();if(n===null)return Y(t,e);let r=Ft();return Qx(r,n,Wt(t),e)}function SE(){let t="invalid";throw new Error(t)}function DE(t,e,n,r,i,o){let l=_e(null);try{let a=null;i&yi.SignalBased&&(a=e[r][hn]),a!==null&&a.transformFn!==void 0&&(o=a.transformFn(o)),i&yi.HasDecoratorInputTransform&&(o=t.inputTransforms[r].call(e,o)),t.setInput!==null?t.setInput(e,a,o,n,r):xx(e,a,r,o)}finally{_e(l)}}function DL(t,e){return t.createText(e)}function IL(t,e,n){t.setValue(e,n)}function OL(t,e){return t.createComment(gL(e))}function IE(t,e,n){return t.createElement(e,n)}function vd(t,e,n,r,i){t.insertBefore(e,n,r,i)}function OE(t,e,n){t.appendChild(e,n)}function PT(t,e,n,r,i){r!==null?vd(t,e,n,r,i):OE(t,e,n)}function AL(t,e,n){t.removeChild(null,e,n)}function ML(t,e,n){t.setAttribute(e,"style",n)}function PL(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function AE(t,e,n){let{mergedAttrs:r,classes:i,styles:o}=n;r!==null&&xF(t,e,r),i!==null&&PL(t,e,i),o!==null&&ML(t,e,o)}function zd(t,e,n,r,i,o,l,a,c,s,u){let d=e.blueprint.slice();return d[$r]=i,d[ne]=r|4|128|8|64|1024,(s!==null||t&&t[ne]&2048)&&(d[ne]|=2048),Ax(d),d[Xt]=d[Xs]=t,d[Jn]=n,d[Fr]=l||t&&t[Fr],d[ht]=a||t&&t[ht],d[Ls]=c||t&&t[Ls]||null,d[er]=o,d[Pd]=XF(),d[sd]=u,d[_x]=s,d[pr]=e.type==2?t[pr]:d,d}function ME(t,e,n,r){if(n===0)return-1;let i=e.length;for(let o=0;o<n;o++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function PE(t,e,n,r,i){let o=Ks(),l=r&2;try{fo(-1),l&&e.length>mn&&CE(t,e,mn,!1),Pn(l?2:0,i),n(r,i)}finally{fo(o),Pn(l?3:1,i)}}function Mm(t,e,n){Px()&&(UL(t,e,n,Rn(n,e)),(n.flags&64)===64&&FE(t,e,n))}function Pm(t,e,n=Rn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let l=r[o+1],a=l===-1?n(e,t):t[l];t[i++]=a}}}function NE(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=Nm(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function Nm(t,e,n,r,i,o,l,a,c,s,u){let d=mn+r,h=d+i,f=NL(d,h),p=typeof s=="function"?s():s;return f[ve]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof l=="function"?l():l,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}function NL(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:wo);return n}function RL(t,e,n,r){let o=r.get(tL,mE)||n===mr.ShadowDom,l=t.selectRootElement(e,o);return kL(l),l}function kL(t){FL(t)}var FL=()=>null;function NT(t,e,n,r,i){for(let o in e){if(!e.hasOwnProperty(o))continue;let l=e[o];if(l===void 0)continue;r??={};let a,c=yi.None;Array.isArray(l)?(a=l[0],c=l[1]):a=l;let s=o;if(i!==null){if(!i.hasOwnProperty(o))continue;s=i[o]}t===0?RT(r,n,s,a,c):RT(r,n,s,a)}return r}function RT(t,e,n,r,i){let o;t.hasOwnProperty(n)?(o=t[n]).push(e,r):o=t[n]=[e,r],i!==void 0&&o.push(i)}function LL(t,e,n){let r=e.directiveStart,i=e.directiveEnd,o=t.data,l=e.attrs,a=[],c=null,s=null;for(let u=r;u<i;u++){let d=o[u],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;c=NT(0,d.inputs,u,c,f),s=NT(1,d.outputs,u,s,p);let g=c!==null&&l!==null&&!Am(e)?JL(c,u,l):null;a.push(g)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=s}function BL(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function RE(t,e,n,r,i,o,l,a){let c=Rn(e,n),s=e.inputs,u;!a&&s!=null&&(u=s[r])?(km(t,n,u,r,i),Nd(e)&&jL(n,e.index)):e.type&3?(r=BL(r),i=l!=null?l(i,e.value||"",r):i,o.setProperty(c,r,i)):e.type&12}function jL(t,e){let n=wi(e,t);n[ne]&16||(n[ne]|=64)}function Rm(t,e,n,r){if(Px()){let i=r===null?null:{"":-1},o=GL(t,n),l,a;o===null?l=a=null:[l,a]=o,l!==null&&kE(t,e,n,l,i,a),i&&zL(n,r,i)}n.mergedAttrs=$s(n.mergedAttrs,n.attrs)}function kE(t,e,n,r,i,o){for(let s=0;s<r.length;s++)Og(pd(n,e),t,r[s].type);qL(n,t.data.length,r.length);for(let s=0;s<r.length;s++){let u=r[s];u.providersResolver&&u.providersResolver(u)}let l=!1,a=!1,c=ME(t,e,r.length,null);for(let s=0;s<r.length;s++){let u=r[s];n.mergedAttrs=$s(n.mergedAttrs,u.hostAttrs),YL(t,n,e,c,u),WL(c,u,i),u.contentQueries!==null&&(n.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(n.flags|=64);let d=u.type.prototype;!l&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),l=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),c++}LL(t,n,o)}function VL(t,e,n,r,i){let o=i.hostBindings;if(o){let l=t.hostBindingOpCodes;l===null&&(l=t.hostBindingOpCodes=[]);let a=~e.index;$L(l)!=a&&l.push(a),l.push(n,r,o)}}function $L(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function UL(t,e,n,r){let i=n.directiveStart,o=n.directiveEnd;Nd(n)&&XL(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||pd(n,e),mi(r,e);let l=n.initialInputs;for(let a=i;a<o;a++){let c=t.data[a],s=Us(e,t,a,n);if(mi(s,e),l!==null&&QL(e,a-i,s,c,n,l),gi(c)){let u=wi(n.index,e);u[Jn]=Us(e,t,a,n)}}}function FE(t,e,n){let r=n.directiveStart,i=n.directiveEnd,o=n.index,l=fF();try{fo(o);for(let a=r;a<i;a++){let c=t.data[a],s=e[a];Sg(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&HL(c,s)}}finally{fo(-1),Sg(l)}}function HL(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function GL(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let o=0;o<n.length;o++){let l=n[o];if(_L(e,l.selectors,!1))if(r||(r=[]),gi(l))if(l.findHostDirectiveDefs!==null){let a=[];i=i||new Map,l.findHostDirectiveDefs(l,a,i),r.unshift(...a,l);let c=a.length;jg(t,e,c)}else r.unshift(l),jg(t,e,0);else i=i||new Map,l.findHostDirectiveDefs?.(l,r,i),r.push(l)}return r===null?null:[r,i]}function jg(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function zL(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let o=n[e[i+1]];if(o==null)throw new W(-301,!1);r.push(e[i],o)}}}function WL(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;gi(e)&&(n[""]=t)}}function qL(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function YL(t,e,n,r,i){t.data[r]=i;let o=i.factory||(i.factory=co(i.type,!0)),l=new po(o,gi(i),te);t.blueprint[r]=l,n[r]=l,VL(t,e,r,ME(t,n,i.hostVars,wo),i)}function LE(t){let e=16;return t.signals?e=4096:t.onPush&&(e=64),e}function XL(t,e,n){let r=Rn(e,t),i=NE(n),o=t[Fr].rendererFactory,l=Wd(t,zd(t,i,null,LE(n),r,e,null,o.createRenderer(r,n),null,null,null));t[e.index]=l}function KL(t,e,n,r,i,o){let l=Rn(t,e);ZL(e[ht],l,o,t.value,n,r,i)}function ZL(t,e,n,r,i,o,l){if(o==null)t.removeAttribute(e,i,n);else{let a=l==null?Od(o):l(o,r||"",i);t.setAttribute(e,i,a,n)}}function QL(t,e,n,r,i,o){let l=o[e];if(l!==null)for(let a=0;a<l.length;){let c=l[a++],s=l[a++],u=l[a++],d=l[a++];DE(r,n,c,s,u,d)}}function JL(t,e,n){let r=null,i=0;for(;i<n.length;){let o=n[i];if(o===0){i+=4;continue}else if(o===5){i+=2;continue}if(typeof o=="number")break;if(t.hasOwnProperty(o)){r===null&&(r=[]);let l=t[o];for(let a=0;a<l.length;a+=3)if(l[a]===e){r.push(o,l[a+1],l[a+2],n[i+1]);break}}i+=2}return r}function BE(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function Wd(t,e){return t[vl]?t[mT][Qn]=e:t[vl]=e,t[mT]=e,e}function jE(t,e){let n=t[Ls],r=n?n.get(Lr,null):null;r&&r.handleError(e)}function km(t,e,n,r,i){for(let o=0;o<n.length;){let l=n[o++],a=n[o++],c=n[o++],s=e[l],u=t.data[l];DE(u,s,r,a,c,i)}}function eB(t,e){let n=wi(e,t),r=n[ve];tB(r,n);let i=n[$r];i!==null&&n[sd]===null&&(n[sd]=Sm(i,n[Ls])),Fm(r,n,n[Jn])}function tB(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function Fm(t,e,n){fm(e);try{let r=t.viewQuery;r!==null&&Bg(1,r,n);let i=t.template;i!==null&&PE(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[js]?.finishViewCreation(t),t.staticContentQueries&&vE(t,e),t.staticViewQueries&&Bg(2,t.viewQuery,n);let o=t.components;o!==null&&nB(e,o)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[ne]&=-5,pm()}}function nB(t,e){for(let n=0;n<e.length;n++)eB(t,e[n])}var Br=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Br||{}),rB;function Lm(t,e){return rB(t,e)}function Ms(t,e,n,r,i){if(r!=null){let o,l=!1;Ur(r)?o=r:fi(r)&&(l=!0,r=r[$r]);let a=gr(r);t===0&&n!==null?i==null?OE(e,n,a):vd(e,n,a,i||null,!0):t===1&&n!==null?vd(e,n,a,i||null,!0):t===2?AL(e,a,l):t===3&&e.destroyNode(a),o!=null&&mB(e,t,o,n,i)}}function iB(t,e){VE(t,e),e[$r]=null,e[er]=null}function oB(t,e,n,r,i,o){r[$r]=i,r[er]=e,Yd(t,r,n,1,i,o)}function VE(t,e){e[Fr].changeDetectionScheduler?.notify(10),Yd(t,e,e[ht],2,null,null)}function sB(t){let e=t[vl];if(!e)return cg(t[ve],t);for(;e;){let n=null;if(fi(e))n=e[vl];else{let r=e[Nn];r&&(n=r)}if(!n){for(;e&&!e[Qn]&&e!==t;)fi(e)&&cg(e[ve],e),e=e[Xt];e===null&&(e=t),fi(e)&&cg(e[ve],e),n=e&&e[Qn]}e=n}}function aB(t,e,n,r){let i=Nn+r,o=n.length;r>0&&(n[i-1][Qn]=e),r<o-Nn?(e[Qn]=n[i],cx(n,Nn+r,e)):(n.push(e),e[Qn]=null),e[Xt]=n;let l=e[Bs];l!==null&&n!==l&&$E(l,e);let a=e[js];a!==null&&a.insertView(t),Eg(e),e[ne]|=128}function $E(t,e){let n=t[ud],r=e[Xt];if(fi(r))t[ne]|=2;else{let i=r[Xt][pr];e[pr]!==i&&(t[ne]|=2)}n===null?t[ud]=[e]:n.push(e)}function Bm(t,e){let n=t[ud],r=n.indexOf(e);n.splice(r,1)}function Vg(t,e){if(t.length<=Nn)return;let n=Nn+e,r=t[n];if(r){let i=r[Bs];i!==null&&i!==t&&Bm(i,r),e>0&&(t[n-1][Qn]=r[Qn]);let o=id(t,Nn+e);iB(r[ve],r);let l=o[js];l!==null&&l.detachView(o[ve]),r[Xt]=null,r[Qn]=null,r[ne]&=-129}return r}function UE(t,e){if(xl(e))return;let n=e[ht];n.destroyNode&&Yd(t,e,n,3,null,null),sB(e)}function cg(t,e){if(xl(e))return;let n=_e(null);try{e[ne]&=-129,e[ne]|=256,e[gn]&&Bp(e[gn]),cB(t,e),lB(t,e),e[ve].type===1&&e[ht].destroy();let r=e[Bs];if(r!==null&&Ur(e[Xt])){r!==e[Xt]&&Bm(r,e);let i=e[js];i!==null&&i.detachView(t)}kg(e)}finally{_e(n)}}function lB(t,e){let n=t.cleanup,r=e[ad];if(n!==null)for(let l=0;l<n.length-1;l+=2)if(typeof n[l]=="string"){let a=n[l+3];a>=0?r[a]():r[-a].unsubscribe(),l+=2}else{let a=r[n[l+1]];n[l].call(a)}r!==null&&(e[ad]=null);let i=e[hi];if(i!==null){e[hi]=null;for(let l=0;l<i.length;l++){let a=i[l];a()}}let o=e[ld];if(o!==null){e[ld]=null;for(let l of o)l.destroy()}}function cB(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof po)){let o=n[r+1];if(Array.isArray(o))for(let l=0;l<o.length;l+=2){let a=i[o[l]],c=o[l+1];Pn(4,a,c);try{c.call(a)}finally{Pn(5,a,c)}}else{Pn(4,i,o);try{o.call(i)}finally{Pn(5,i,o)}}}}}function uB(t,e,n){return dB(t,e.parent,n)}function dB(t,e,n){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return n[$r];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:o}=t.data[r.directiveStart+i];if(o===mr.None||o===mr.Emulated)return null}return Rn(r,n)}}function hB(t,e,n){return pB(t,e,n)}function fB(t,e,n){return t.type&40?Rn(t,n):null}var pB=fB,kT;function qd(t,e,n,r){let i=uB(t,r,e),o=e[ht],l=r.parent||e[er],a=hB(l,r,e);if(i!=null)if(Array.isArray(n))for(let c=0;c<n.length;c++)PT(o,i,n[c],a,!1);else PT(o,i,n,a,!1);kT!==void 0&&kT(o,r,e,n,i)}function pl(t,e){if(e!==null){let n=e.type;if(n&3)return Rn(e,t);if(n&4)return $g(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return pl(t,r);{let i=t[e.index];return Ur(i)?$g(-1,i):gr(i)}}else{if(n&128)return pl(t,e.next);if(n&32)return Lm(e,t)()||gr(t[e.index]);{let r=HE(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=ho(t[pr]);return pl(i,r)}else return pl(t,e.next)}}}return null}function HE(t,e){if(e!==null){let r=t[pr][er],i=e.projection;return r.projection[i]}return null}function $g(t,e){let n=Nn+t+1;if(n<e.length){let r=e[n],i=r[ve].firstChild;if(i!==null)return pl(r,i)}return e[uo]}function jm(t,e,n,r,i,o,l){for(;n!=null;){if(n.type===128){n=n.next;continue}let a=r[n.index],c=n.type;if(l&&e===0&&(a&&mi(gr(a),r),n.flags|=2),(n.flags&32)!==32)if(c&8)jm(t,e,n.child,r,i,o,!1),Ms(e,t,i,a,o);else if(c&32){let s=Lm(n,r),u;for(;u=s();)Ms(e,t,i,u,o);Ms(e,t,i,a,o)}else c&16?gB(t,e,r,n,i,o):Ms(e,t,i,a,o);n=l?n.projectionNext:n.next}}function Yd(t,e,n,r,i,o){jm(n,r,t.firstChild,e,i,o,!1)}function gB(t,e,n,r,i,o){let l=n[pr],c=l[er].projection[r.projection];if(Array.isArray(c))for(let s=0;s<c.length;s++){let u=c[s];Ms(e,t,i,u,o)}else{let s=c,u=l[Xt];cE(r)&&(s.flags|=128),jm(t,e,s,u,i,o,!0)}}function mB(t,e,n,r,i){let o=n[uo],l=gr(n);o!==l&&Ms(e,t,r,o,i);for(let a=Nn;a<n.length;a++){let c=n[a];Yd(c[ve],c,t,e,r,o)}}function yB(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let o=r.indexOf("-")===-1?void 0:Br.DashCase;i==null?t.removeStyle(n,r,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=Br.Important),t.setStyle(n,r,i,o))}}function vB(t,e,n,r){let i=_e(null);try{let o=e.tView,a=t[ne]&4096?4096:16,c=zd(t,o,n,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),s=t[e.index];c[Bs]=s;let u=t[js];return u!==null&&(c[js]=u.createEmbeddedView(o)),Fm(o,c,n),c}finally{_e(i)}}function FT(t,e){return!e||e.firstChild===null||cE(t)}function bB(t,e,n,r=!0){let i=e[ve];if(aB(i,e,t,n),r){let l=$g(n,t),a=e[ht],c=a.parentNode(t[uo]);c!==null&&oB(i,t[er],a,e,c,l)}let o=e[sd];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function bd(t,e,n,r,i=!1){for(;n!==null;){if(n.type===128){n=i?n.projectionNext:n.next;continue}let o=e[n.index];o!==null&&r.push(gr(o)),Ur(o)&&wB(o,r);let l=n.type;if(l&8)bd(t,e,n.child,r);else if(l&32){let a=Lm(n,e),c;for(;c=a();)r.push(c)}else if(l&16){let a=HE(e,n);if(Array.isArray(a))r.push(...a);else{let c=ho(e[pr]);bd(c[ve],c,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function wB(t,e){for(let n=Nn;n<t.length;n++){let r=t[n],i=r[ve].firstChild;i!==null&&bd(r[ve],r,i,e)}t[uo]!==t[$r]&&e.push(t[uo])}var GE=[];function _B(t){return t[gn]??TB(t)}function TB(t){let e=GE.pop()??Object.create(EB);return e.lView=t,e}function xB(t){t.lView[gn]!==t&&(t.lView=null,GE.push(t))}var EB=N(C({},ll),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:t=>{Fd(t.lView)},consumerOnSignalRead(){this.lView[gn]=this}});function CB(t){let e=t[gn]??Object.create(SB);return e.lView=t,e}var SB=N(C({},ll),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:t=>{let e=ho(t.lView);for(;e&&!zE(e[ve]);)e=ho(e);e&&dm(e)},consumerOnSignalRead(){this.lView[gn]=this}});function zE(t){return t.type!==2}function WE(t){if(t[ld]===null)return;let e=!0;for(;e;){let n=!1;for(let r of t[ld])r.dirty&&(n=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=n&&!!(t[ne]&8192)}}var DB=100;function qE(t,e=!0,n=0){let i=t[Fr].rendererFactory,o=!1;o||i.begin?.();try{IB(t,n)}catch(l){throw e&&jE(t,l),l}finally{o||i.end?.()}}function IB(t,e){let n=kx();try{vT(!0),Ug(t,e);let r=0;for(;kd(t);){if(r===DB)throw new W(103,!1);r++,Ug(t,1)}}finally{vT(n)}}function OB(t,e,n,r){if(xl(e))return;let i=e[ne],o=!1,l=!1;fm(e);let a=!0,c=null,s=null;o||(zE(t)?(s=_B(e),c=yu(s)):D_()===null?(a=!1,s=CB(e),c=yu(s)):e[gn]&&(Bp(e[gn]),e[gn]=null));try{Ax(e),cF(t.bindingStartIndex),n!==null&&PE(t,e,n,2,r);let u=(i&3)===3;if(!o)if(u){let f=t.preOrderCheckHooks;f!==null&&Qu(e,f,null)}else{let f=t.preOrderHooks;f!==null&&Ju(e,f,0,null),sg(e,0)}if(l||AB(e),WE(e),YE(e,0),t.contentQueries!==null&&vE(t,e),!o)if(u){let f=t.contentCheckHooks;f!==null&&Qu(e,f)}else{let f=t.contentHooks;f!==null&&Ju(e,f,1),sg(e,1)}PB(t,e);let d=t.components;d!==null&&KE(e,d,0);let h=t.viewQuery;if(h!==null&&Bg(2,h,r),!o)if(u){let f=t.viewCheckHooks;f!==null&&Qu(e,f)}else{let f=t.viewHooks;f!==null&&Ju(e,f,2),sg(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[og]){for(let f of e[og])f();e[og]=null}o||(e[ne]&=-73)}catch(u){throw o||Fd(e),u}finally{s!==null&&(Fp(s,c),a&&xB(s)),pm()}}function YE(t,e){for(let n=hE(t);n!==null;n=fE(n))for(let r=Nn;r<n.length;r++){let i=n[r];XE(i,e)}}function AB(t){for(let e=hE(t);e!==null;e=fE(e)){if(!(e[ne]&2))continue;let n=e[ud];for(let r=0;r<n.length;r++){let i=n[r];dm(i)}}}function MB(t,e,n){let r=wi(e,t);XE(r,n)}function XE(t,e){um(t)&&Ug(t,e)}function Ug(t,e){let r=t[ve],i=t[ne],o=t[gn],l=!!(e===0&&i&16);if(l||=!!(i&64&&e===0),l||=!!(i&1024),l||=!!(o?.dirty&&Lp(o)),l||=!1,o&&(o.dirty=!1),t[ne]&=-9217,l)OB(r,t,r.template,t[Jn]);else if(i&8192){WE(t),YE(t,1);let a=r.components;a!==null&&KE(t,a,1)}}function KE(t,e,n){for(let r=0;r<e.length;r++)MB(t,e[r],n)}function PB(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)fo(~i);else{let o=i,l=n[++r],a=n[++r];hF(l,o);let c=e[o];Pn(24,c),a(2,c),Pn(25,c)}}}finally{fo(-1)}}function Vm(t,e){let n=kx()?64:1088;for(t[Fr].changeDetectionScheduler?.notify(e);t;){t[ne]|=n;let r=ho(t);if(Tg(t)&&!r)return t;t=r}return null}var go=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let e=this._lView,n=e[ve];return bd(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r}get context(){return this._lView[Jn]}get dirty(){return!!(this._lView[ne]&9280)||!!this._lView[gn]?.dirty}set context(e){this._lView[Jn]=e}get destroyed(){return xl(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Xt];if(Ur(e)){let n=e[cd],r=n?n.indexOf(this):-1;r>-1&&(Vg(e,r),id(n,r))}this._attachedToViewContainer=!1}UE(this._lView[ve],this._lView)}onDestroy(e){Mx(this._lView,e)}markForCheck(){Vm(this._cdRefInjectingView||this._lView,4)}markForRefresh(){dm(this._cdRefInjectingView||this._lView)}detach(){this._lView[ne]&=-129}reattach(){Eg(this._lView),this._lView[ne]|=128}detectChanges(){this._lView[ne]|=1024,qE(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new W(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Tg(this._lView),n=this._lView[Bs];n!==null&&!e&&Bm(n,this._lView),VE(this._lView[ve],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new W(902,!1);this._appRef=e;let n=Tg(this._lView),r=this._lView[Bs];r!==null&&!n&&$E(r,this._lView),Eg(this._lView)}},Xd=(()=>{class t{static __NG_ELEMENT_ID__=kB}return t})(),NB=Xd,RB=class extends NB{_declarationLView;_declarationTContainer;elementRef;constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=vB(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:n,dehydratedView:r});return new go(i)}};function kB(){return FB(Ft(),Re())}function FB(t,e){return t.type&4?new RB(e,t,Ud(t,e)):null}function Cl(t,e,n,r,i){let o=t.data[e];if(o===null)o=LB(t,e,n,r,i),dF()&&(o.flags|=32);else if(o.type&64){o.type=n,o.value=r,o.attrs=i;let l=aF();o.injectorIndex=l===null?-1:l.injectorIndex}return vo(o,!0),o}function LB(t,e,n,r,i){let o=Nx(),l=hm(),a=l?o:o&&o.parent,c=t.data[e]=jB(t,a,n,e,r,i);return BB(t,c,o,l),c}function BB(t,e,n,r){t.firstChild===null&&(t.firstChild=e),n!==null&&(r?n.child==null&&e.parent!==null&&(n.child=e):n.next===null&&(n.next=e,e.prev=n))}function jB(t,e,n,r,i,o){let l=e?e.injectorIndex:-1,a=0;return iF()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:l,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var FK=new RegExp(`^(\\d+)*(${eL}|${JF})*(.*)`);var VB=()=>null;function LT(t,e){return VB(t,e)}var Hg=class{},wd=class{},Gg=class{resolveComponentFactory(e){throw Error(`No component factory found for ${qt(e)}.`)}},Gs=class{static NULL=new Gg},zs=class{},Ei=(()=>{class t{destroyNode=null;static __NG_ELEMENT_ID__=()=>$B()}return t})();function $B(){let t=Re(),e=Ft(),n=wi(e.index,t);return(fi(n)?n:t)[ht]}var UB=(()=>{class t{static \u0275prov=H({token:t,providedIn:"root",factory:()=>null})}return t})();function _d(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,o=0;if(e!==null)for(let l=0;l<e.length;l++){let a=e[l];if(typeof a=="number")o=a;else if(o==1)i=uT(i,a);else if(o==2){let c=a,s=e[++l];r=uT(r,c+": "+s+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var Td=class extends Gs{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=pi(e);return new Ws(n,this.ngModule)}};function BT(t,e){let n=[];for(let r in t){if(!t.hasOwnProperty(r))continue;let i=t[r];if(i===void 0)continue;let o=Array.isArray(i),l=o?i[0]:i,a=o?i[1]:yi.None;e?n.push({propName:l,templateName:r,isSignal:(a&yi.SignalBased)!==0}):n.push({propName:l,templateName:r})}return n}function HB(t){let e=t.toLowerCase();return e==="svg"?Yk:e==="math"?Xk:null}function GB(t){let{attrs:e,classes:n}=SL(t),r=e;return n.length&&r.push(1,...n),r}var Ws=class extends wd{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;get inputs(){let e=this.componentDef,n=e.inputTransforms,r=BT(e.inputs,!0);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return BT(this.componentDef.outputs,!1)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=CL(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let o=_e(null);try{i=i||this.ngModule;let l=i instanceof Yt?i:i?.injector;l&&this.componentDef.getStandaloneInjector!==null&&(l=this.componentDef.getStandaloneInjector(l)||l);let a=l?new Dg(e,l):e,c=a.get(zs,null);if(c===null)throw new W(407,!1);let s=a.get(UB,null),u=a.get(Hs,null),d={rendererFactory:c,sanitizer:s,changeDetectionScheduler:u},h=c.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",p=r?RL(h,r,this.componentDef.encapsulation,a):IE(h,f,HB(f)),g=512;this.componentDef.signals?g|=4096:this.componentDef.onPush||(g|=16);let y=null;p!==null&&(y=Sm(p,a,!0));let b=Nm(0,null,null,1,0,null,null,null,null,null,null),v=zd(null,b,null,g,null,null,d,h,a,null,y);v[mn]=p,fm(v);let _,I=null;try{let V=this.componentDef,G,j=null;V.findHostDirectiveDefs?(G=[],j=new Map,V.findHostDirectiveDefs(V,G,j),G.push(V)):G=[V];let ge=r?["ng-version","19.1.3"]:GB(this.componentDef.selectors[0]),Z=Cl(b,mn,2,"#host",ge);for(let Be of G)Z.mergedAttrs=$s(Z.mergedAttrs,Be.hostAttrs);Z.mergedAttrs=$s(Z.mergedAttrs,ge),_d(Z,Z.mergedAttrs,!0),p&&AE(h,p,Z),I=zB(Z,p,V,G,v,d),n!==void 0&&qB(Z,this.ngContentSelectors,n),_=WB(I,V,G,j,v,[YB]),Fm(b,v,null)}catch(V){throw I!==null&&kg(I),kg(v),V}finally{pm()}let k=Ix(b,mn);return new zg(this.componentType,_,Ud(k,v),v,k)}finally{_e(o)}}},zg=class extends Hg{location;_rootLView;_tNode;instance;hostView;changeDetectorRef;componentType;previousInputValues=null;constructor(e,n,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.instance=n,this.hostView=this.changeDetectorRef=new go(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let o=this._rootLView;km(o[ve],o,i,e,n),this.previousInputValues.set(e,n);let l=wi(this._tNode.index,o);Vm(l,1)}}get injector(){return new lo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function zB(t,e,n,r,i,o){let l=i[ve],a=null;e!==null&&(a=Sm(e,i[Ls]));let c=o.rendererFactory.createRenderer(e,n),s=zd(i,NE(n),null,LE(n),i[t.index],t,o,c,null,null,a);return l.firstCreatePass&&jg(l,t,r.length-1),Wd(i,s),i[t.index]=s}function WB(t,e,n,r,i,o){let l=Ft(),a=i[ve],c=Rn(l,i);kE(a,i,l,n,null,r);for(let u=0;u<n.length;u++){let d=l.directiveStart+u,h=Us(i,a,d,l);mi(h,i)}FE(a,i,l),c&&mi(c,i);let s=Us(i,a,l.directiveStart+l.componentOffset,l);if(t[Jn]=i[Jn]=s,o!==null)for(let u of o)u(s,e);return Dm(a,l,i),s}function qB(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let o=n[i];r.push(o!=null&&o.length?Array.from(o):null)}}function YB(){let t=Ft();Vd(Re()[ve],t)}var Qs=(()=>{class t{static __NG_ELEMENT_ID__=XB}return t})();function XB(){let t=Ft();return ZB(t,Re())}var KB=Qs,ZE=class extends KB{_lContainer;_hostTNode;_hostLView;constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Ud(this._hostTNode,this._hostLView)}get injector(){return new lo(this._hostTNode,this._hostLView)}get parentInjector(){let e=mm(this._hostTNode,this._hostLView);if(Wx(e)){let n=hd(e,this._hostLView),r=dd(e),i=n[ve].data[r+8];return new lo(i,n)}else return new lo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=jT(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-Nn}createEmbeddedView(e,n,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let l=LT(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},o,l);return this.insertImpl(a,i,FT(this._hostTNode,l)),a}createComponent(e,n,r,i,o){let l=e&&!Gk(e),a;if(l)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,o=p.environmentInjector||p.ngModuleRef}let c=l?e:new Ws(pi(e)),s=r||this.parentInjector;if(!o&&c.ngModule==null){let g=(l?s:this.parentInjector).get(Yt,null);g&&(o=g)}let u=pi(c.componentType??{}),d=LT(this._lContainer,u?.id??null),h=d?.firstChild??null,f=c.create(s,i,h,o);return this.insertImpl(f.hostView,a,FT(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(Kk(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Xt],s=new ZE(c,c[er],c[Xt]);s.detach(s.indexOf(e))}}let o=this._adjustIndex(n),l=this._lContainer;return bB(l,i,o,r),e.attachToViewContainerRef(),cx(ug(l),o,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=jT(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=Vg(this._lContainer,n);r&&(id(ug(this._lContainer),n),UE(r[ve],r))}detach(e){let n=this._adjustIndex(e,-1),r=Vg(this._lContainer,n);return r&&id(ug(this._lContainer),n)!=null?new go(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function jT(t){return t[cd]}function ug(t){return t[cd]||(t[cd]=[])}function ZB(t,e){let n,r=e[t.index];return Ur(r)?n=r:(n=BE(r,e,null,t),e[t.index]=n,Wd(e,n)),JB(n,e,t,r),new ZE(n,t,e)}function QB(t,e){let n=t[ht],r=n.createComment(""),i=Rn(e,t),o=n.parentNode(i);return vd(n,o,r,n.nextSibling(i),!1),r}var JB=nj,ej=()=>!1;function tj(t,e,n){return ej(t,e,n)}function nj(t,e,n,r){if(t[uo])return;let i;n.type&8?i=gr(r):i=QB(e,n),t[uo]=i}var vi=class{},bl=class{};var Wg=class extends vi{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Td(this);constructor(e,n,r,i=!0){super(),this.ngModuleType=e,this._parent=n;let o=hx(e);this._bootstrapComponents=xE(o.bootstrap),this._r3Injector=tE(e,n,[{provide:vi,useValue:this},{provide:Gs,useValue:this.componentFactoryResolver},...r],qt(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},qg=class extends bl{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new Wg(this.moduleType,e,[])}};var xd=class extends vi{injector;componentFactoryResolver=new Td(this);instance=null;constructor(e){super();let n=new yl([...e.providers,{provide:vi,useValue:this},{provide:Gs,useValue:this.componentFactoryResolver}],e.parent||lm(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Kd(t,e,n=null){return new xd({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var rj=(()=>{class t{_injector;cachedInjectors=new Map;constructor(n){this._injector=n}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){let r=mx(!1,n.type),i=r.length>0?Kd([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,i)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(let n of this.cachedInjectors.values())n!==null&&n.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=H({token:t,providedIn:"environment",factory:()=>new t(Y(Yt))})}return t})();function br(t){return _l(()=>{let e=JE(t),n=N(C({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===uE.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(rj).getOrCreateStandaloneInjector(n):null,getExternalStyles:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||mr.Emulated,styles:t.styles||Mn,_:null,schemas:t.schemas||null,tView:null,id:""});e.standalone&&bo("NgStandalone"),eC(n);let r=t.dependencies;return n.directiveDefs=$T(r,!1),n.pipeDefs=$T(r,!0),n.id=sj(n),n})}function ij(t){return pi(t)||fx(t)}function oj(t){return t!==null}function Gr(t){return _l(()=>({type:t.type,bootstrap:t.bootstrap||Mn,declarations:t.declarations||Mn,imports:t.imports||Mn,exports:t.exports||Mn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function VT(t,e){if(t==null)return Rs;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],o,l,a=yi.None;Array.isArray(i)?(a=i[0],o=i[1],l=i[2]??o):(o=i,l=i),e?(n[o]=a!==yi.None?[r,a]:r,e[o]=l):n[o]=r}return n}function Ot(t){return _l(()=>{let e=JE(t);return eC(e),e})}function QE(t){return{type:t.type,name:t.name,factory:null,pure:t.pure!==!1,standalone:t.standalone??!0,onDestroy:t.type.prototype.ngOnDestroy||null}}function JE(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Rs,exportAs:t.exportAs||null,standalone:t.standalone??!0,signals:t.signals===!0,selectors:t.selectors||Mn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:VT(t.inputs,e),outputs:VT(t.outputs),debugInfo:null}}function eC(t){t.features?.forEach(e=>e(t))}function $T(t,e){if(!t)return null;let n=e?px:ij;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(oj)}function sj(t){let e=0,n=typeof t.consts=="function"?"":t.consts,r=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,n,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery];for(let o of r.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function aj(t){return Object.getPrototypeOf(t.prototype).constructor}function zr(t){let e=aj(t.type),n=!0,r=[t];for(;e;){let i;if(gi(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new W(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let l=t;l.inputs=Xu(t.inputs),l.inputTransforms=Xu(t.inputTransforms),l.declaredInputs=Xu(t.declaredInputs),l.outputs=Xu(t.outputs);let a=i.hostBindings;a&&hj(t,a);let c=i.viewQuery,s=i.contentQueries;if(c&&uj(t,c),s&&dj(t,s),lj(t,i),ck(t.outputs,i.outputs),gi(i)&&i.data.animation){let u=t.data;u.animation=(u.animation||[]).concat(i.data.animation)}}let o=i.features;if(o)for(let l=0;l<o.length;l++){let a=o[l];a&&a.ngInherit&&a(t),a===zr&&(n=!1)}}e=Object.getPrototypeOf(e)}cj(r)}function lj(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function cj(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=$s(i.hostAttrs,n=$s(n,i.hostAttrs))}}function Xu(t){return t===Rs?{}:t===Mn?[]:t}function uj(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function dj(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,o)=>{e(r,i,o),n(r,i,o)}:t.contentQueries=e}function hj(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function $m(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(n[r]=i[3])}t.inputTransforms=n}function tC(t){return pj(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function fj(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function pj(t){return t!==null&&(typeof t=="function"||typeof t=="object")}function gj(t,e,n){return t[e]=n}function Js(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function mj(t){return(t.flags&32)===32}function yj(t,e,n,r,i,o,l,a,c){let s=e.consts,u=Cl(e,t,4,l||null,a||null);Rm(e,n,u,Vs(s,c)),Vd(e,u);let d=u.tView=Nm(2,u,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,s,null);return e.queries!==null&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}function vj(t,e,n,r,i,o,l,a,c,s){let u=n+mn,d=e.firstCreatePass?yj(u,e,t,r,i,o,l,a,c):e.data[u];vo(d,!1);let h=bj(e,t,d,n);Bd()&&qd(e,t,h,d),mi(h,t);let f=BE(h,t,h,d);return t[u]=f,Wd(t,f),tj(f,d,t),Rd(d)&&Mm(e,t,d),c!=null&&Pm(t,d,s),d}function Ge(t,e,n,r,i,o,l,a){let c=Re(),s=kt(),u=Vs(s.consts,o);return vj(c,s,t,e,n,r,i,u,l,a),Ge}var bj=wj;function wj(t,e,n,r){return jd(!0),e[ht].createComment("")}var Um=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();var nC=new z("");function Ci(t){return!!t&&typeof t.then=="function"}function Hm(t){return!!t&&typeof t.subscribe=="function"}var Zd=new z("");var rC=(()=>{class t{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r});appInits=B(Zd,{optional:!0})??[];injector=B(yn);constructor(){}runInitializers(){if(this.initialized)return;let n=[];for(let i of this.appInits){let o=an(this.injector,i);if(Ci(o))n.push(o);else if(Hm(o)){let l=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});n.push(l)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(i=>{this.reject(i)}),n.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),_j=(()=>{class t{static \u0275prov=H({token:t,providedIn:"root",factory:()=>new Yg})}return t})(),Yg=class{queuedEffectCount=0;queues=new Map;schedule(e){this.enqueue(e)}remove(e){let n=e.zone,r=this.queues.get(n);r.has(e)&&(r.delete(e),this.queuedEffectCount--)}enqueue(e){let n=e.zone;this.queues.has(n)||this.queues.set(n,new Set);let r=this.queues.get(n);r.has(e)||(this.queuedEffectCount++,r.add(e))}flush(){for(;this.queuedEffectCount>0;)for(let[e,n]of this.queues)e===null?this.flushQueue(n):e.run(()=>this.flushQueue(n))}flushQueue(e){for(let n of e)e.delete(n),this.queuedEffectCount--,n.run()}},Sl=new z("");function Tj(){F_(()=>{throw new W(600,!1)})}function xj(t){return t.isBoundToModule}var Ej=10;function Cj(t,e,n){try{let r=n();return Ci(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}var jr=(()=>{class t{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=B(HF);afterRenderManager=B(yE);zonelessEnabled=B($d);rootEffectScheduler=B(_j);dirtyFlags=0;deferredDirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new yt;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=B(Ti).hasPendingTasks.pipe(se(n=>!n));constructor(){B(Zs,{optional:!0})}whenStable(){let n;return new Promise(r=>{n=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{n.unsubscribe()})}_injector=B(Yt);_rendererFactory=null;get injector(){return this._injector}bootstrap(n,r){let i=n instanceof wd;if(!this._injector.get(rC).done){let h=!i&&gx(n),f=!1;throw new W(405,f)}let l;i?l=n:l=this._injector.get(Gs).resolveComponentFactory(n),this.componentTypes.push(l.componentType);let a=xj(l)?void 0:this._injector.get(vi),c=r||l.selector,s=l.create(yn.NULL,[],c,a),u=s.location.nativeElement,d=s.injector.get(nC,null);return d?.registerApplication(u),s.onDestroy(()=>{this.detachView(s.hostView),ed(this.components,s),d?.unregisterApplication(u)}),this._loadComponent(s),s}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick=()=>{if(this.tracingSnapshot!==null){let r=this.tracingSnapshot;this.tracingSnapshot=null,r.run(Em.CHANGE_DETECTION,this._tick),r.dispose();return}if(this._runningTick)throw new W(101,!1);let n=_e(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,_e(n),this.afterTick.next()}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(zs,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let n=0;for(;this.dirtyFlags!==0&&n++<Ej;)this.synchronizeOnce()}synchronizeOnce(){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let n=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r,notifyErrorHandler:i}of this.allViews)Sj(r,i,n,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:n})=>kd(n))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(n){let r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){let r=n;ed(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(Sl,[]).forEach(i=>i(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>ed(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new W(406,!1);let n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function ed(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Sj(t,e,n,r){if(!n&&!kd(t))return;qE(t,e,n&&!r?0:1)}function Dl(t,e,n,r){let i=Re(),o=Ld();if(Js(i,o,e)){let l=kt(),a=gm();KL(a,i,t,e,n,r)}return Dl}function Dj(t,e,n,r){return Js(t,Ld(),n)?e+Od(n)+r:wo}function Ku(t,e){return t<<17|e<<2}function mo(t){return t>>17&32767}function Ij(t){return(t&2)==2}function Oj(t,e){return t&131071|e<<17}function Xg(t){return t|2}function qs(t){return(t&131068)>>2}function dg(t,e){return t&-131069|e<<2}function Aj(t){return(t&1)===1}function Kg(t){return t|1}function Mj(t,e,n,r,i,o){let l=o?e.classBindings:e.styleBindings,a=mo(l),c=qs(l);t[r]=n;let s=!1,u;if(Array.isArray(n)){let d=n;u=d[1],(u===null||Tl(d,u)>0)&&(s=!0)}else u=n;if(i)if(c!==0){let h=mo(t[a+1]);t[r+1]=Ku(h,a),h!==0&&(t[h+1]=dg(t[h+1],r)),t[a+1]=Oj(t[a+1],r)}else t[r+1]=Ku(a,0),a!==0&&(t[a+1]=dg(t[a+1],r)),a=r;else t[r+1]=Ku(c,0),a===0?a=r:t[c+1]=dg(t[c+1],r),c=r;s&&(t[r+1]=Xg(t[r+1])),UT(t,u,r,!0),UT(t,u,r,!1),Pj(e,u,t,r,o),l=Ku(a,c),o?e.classBindings=l:e.styleBindings=l}function Pj(t,e,n,r,i){let o=i?t.residualClasses:t.residualStyles;o!=null&&typeof e=="string"&&Tl(o,e)>=0&&(n[r+1]=Kg(n[r+1]))}function UT(t,e,n,r){let i=t[n+1],o=e===null,l=r?mo(i):qs(i),a=!1;for(;l!==0&&(a===!1||o);){let c=t[l],s=t[l+1];Nj(c,e)&&(a=!0,t[l+1]=r?Kg(s):Xg(s)),l=r?mo(s):qs(s)}a&&(t[n+1]=r?Xg(i):Kg(i))}function Nj(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?Tl(t,e)>=0:!1}function Te(t,e,n){let r=Re(),i=Ld();if(Js(r,i,e)){let o=kt(),l=gm();RE(o,l,r,t,e,r[ht],n,!1)}return Te}function HT(t,e,n,r,i){let o=e.inputs,l=i?"class":"style";km(t,n,o[l],l,r)}function ea(t,e,n){return iC(t,e,n,!1),ea}function Gm(t,e){return iC(t,e,null,!0),Gm}function iC(t,e,n,r){let i=Re(),o=kt(),l=uF(2);if(o.firstUpdatePass&&kj(o,t,l,r),e!==wo&&Js(i,l,e)){let a=o.data[Ks()];Vj(o,a,i,i[ht],t,i[l+1]=$j(e,n),r,l)}}function Rj(t,e){return e>=t.expandoStartIndex}function kj(t,e,n,r){let i=t.data;if(i[n+1]===null){let o=i[Ks()],l=Rj(t,n);Uj(o,r)&&e===null&&!l&&(e=!1),e=Fj(i,o,e,r),Mj(i,o,e,n,l,r)}}function Fj(t,e,n,r){let i=pF(t),o=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=hg(null,t,e,n,r),n=wl(n,e.attrs,r),o=null);else{let l=e.directiveStylingLast;if(l===-1||t[l]!==i)if(n=hg(i,t,e,n,r),o===null){let c=Lj(t,e,r);c!==void 0&&Array.isArray(c)&&(c=hg(null,t,e,c[1],r),c=wl(c,e.attrs,r),Bj(t,e,r,c))}else o=jj(t,e,r)}return o!==void 0&&(r?e.residualClasses=o:e.residualStyles=o),n}function Lj(t,e,n){let r=n?e.classBindings:e.styleBindings;if(qs(r)!==0)return t[mo(r)]}function Bj(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[mo(i)]=r}function jj(t,e,n){let r,i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++){let l=t[o].hostAttrs;r=wl(r,l,n)}return wl(r,e.attrs,n)}function hg(t,e,n,r,i){let o=null,l=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<l&&(o=e[a],r=wl(r,o.hostAttrs,i),o!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function wl(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let o=0;o<e.length;o++){let l=e[o];typeof l=="number"?i=l:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),Ak(t,l,n?!0:e[++o]))}return t===void 0?null:t}function Vj(t,e,n,r,i,o,l,a){if(!(e.type&3))return;let c=t.data,s=c[a+1],u=Aj(s)?GT(c,e,n,i,qs(s),l):void 0;if(!Ed(u)){Ed(o)||Ij(s)&&(o=GT(c,null,n,i,a,l));let d=Dx(Ks(),n);yB(r,l,d,i,o)}}function GT(t,e,n,r,i,o){let l=e===null,a;for(;i>0;){let c=t[i],s=Array.isArray(c),u=s?c[1]:c,d=u===null,h=n[i+1];h===wo&&(h=d?Mn:void 0);let f=d?rg(h,r):u===r?h:void 0;if(s&&!Ed(f)&&(f=rg(c,r)),Ed(f)&&(a=f,l))return a;let p=t[i+1];i=l?mo(p):qs(p)}if(e!==null){let c=o?e.residualClasses:e.residualStyles;c!=null&&(a=rg(c,r))}return a}function Ed(t){return t!==void 0}function $j(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=qt(El(t)))),t}function Uj(t,e){return(t.flags&(e?8:16))!==0}function Hj(t,e,n,r,i,o){let l=e.consts,a=Vs(l,i),c=Cl(e,t,2,r,a);return Rm(e,n,c,Vs(l,o)),c.attrs!==null&&_d(c,c.attrs,!1),c.mergedAttrs!==null&&_d(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function J(t,e,n,r){let i=Re(),o=kt(),l=mn+t,a=i[ht],c=o.firstCreatePass?Hj(l,o,i,e,n,r):o.data[l],s=Gj(o,i,c,a,e,t);i[l]=s;let u=Rd(c);return vo(c,!0),AE(a,s,c),!mj(c)&&Bd()&&qd(o,i,s,c),tF()===0&&mi(s,i),nF(),u&&(Mm(o,i,c),Dm(o,c,i)),r!==null&&Pm(i,c),J}function X(){let t=Ft();hm()?Rx():(t=t.parent,vo(t,!1));let e=t;oF(e)&&sF(),rF();let n=kt();return n.firstCreatePass&&(Vd(n,t),cm(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&_F(e)&&HT(n,e,Re(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&TF(e)&&HT(n,e,Re(),e.stylesWithoutHost,!1),X}function tt(t,e,n,r){return J(t,e,n,r),X(),tt}var Gj=(t,e,n,r,i,o)=>(jd(!0),IE(r,i,yF()));function zj(t,e,n,r,i){let o=e.consts,l=Vs(o,r),a=Cl(e,t,8,"ng-container",l);l!==null&&_d(a,l,!0);let c=Vs(o,i);return Rm(e,n,a,c),e.queries!==null&&e.queries.elementStart(e,a),a}function zm(t,e,n){let r=Re(),i=kt(),o=t+mn,l=i.firstCreatePass?zj(o,i,r,e,n):i.data[o];vo(l,!0);let a=Wj(i,r,l,t);return r[o]=a,Bd()&&qd(i,r,a,l),mi(a,r),Rd(l)&&(Mm(i,r,l),Dm(i,l,r)),n!=null&&Pm(r,l),zm}function Wm(){let t=Ft(),e=kt();return hm()?Rx():(t=t.parent,vo(t,!1)),e.firstCreatePass&&(Vd(e,t),cm(t)&&e.queries.elementEnd(t)),Wm}var Wj=(t,e,n,r)=>(jd(!0),OL(e[ht],""));function Il(){return Re()}var Cd="en-US";var qj=Cd;function Yj(t){typeof t=="string"&&(qj=t.toLowerCase().replace(/_/g,"-"))}var Xj=(t,e,n)=>{};function At(t,e,n,r){let i=Re(),o=kt(),l=Ft();return oC(o,i,i[ht],l,t,e,r),At}function Kj(t,e,n,r){let i=t.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let l=i[o];if(l===n&&i[o+1]===r){let a=e[ad],c=i[o+2];return a.length>c?a[c]:null}typeof l=="string"&&(o+=2)}return null}function oC(t,e,n,r,i,o,l){let a=Rd(r),s=t.firstCreatePass&&eF(t),u=e[Jn],d=Jk(e),h=!0;if(r.type&3||l){let g=Rn(r,e),y=l?l(g):g,b=d.length,v=l?I=>l(gr(I[r.index])):r.index,_=null;if(!l&&a&&(_=Kj(t,e,i,r.index)),_!==null){let I=_.__ngLastListenerFn__||_;I.__ngNextListenerFn__=o,_.__ngLastListenerFn__=o,h=!1}else{o=WT(r,e,u,o),Xj(g,i,o);let I=n.listen(y,i,o);d.push(o,I),s&&s.push(i,v,b,b+1)}}else o=WT(r,e,u,o);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let g=p.length;if(g)for(let y=0;y<g;y+=2){let b=p[y],v=p[y+1],k=e[b][v].subscribe(o),V=d.length;d.push(o,k),s&&s.push(i,r.index,V,-(V+1))}}}function zT(t,e,n,r){let i=_e(null);try{return Pn(6,e,n),n(r)!==!1}catch(o){return jE(t,o),!1}finally{Pn(7,e,n),_e(i)}}function WT(t,e,n,r){return function i(o){if(o===Function)return r;let l=t.componentOffset>-1?wi(t.index,e):e;Vm(l,5);let a=zT(e,n,r,o),c=i.__ngNextListenerFn__;for(;c;)a=zT(e,n,c,o)&&a,c=c.__ngNextListenerFn__;return a}}function Lt(t=1){return mF(t)}function Zj(t,e,n,r){n>=t.data.length&&(t.data[n]=null,t.blueprint[n]=null),e[n]=r}function qm(t){let e=lF();return Ox(e,mn+t)}function vt(t,e=""){let n=Re(),r=kt(),i=t+mn,o=r.firstCreatePass?Cl(r,i,1,e,null):r.data[i],l=Qj(r,n,o,e,t);n[i]=l,Bd()&&qd(r,n,l,o),vo(o,!1)}var Qj=(t,e,n,r,i)=>(jd(!0),DL(e[ht],r));function vn(t,e,n){let r=Re(),i=Dj(r,t,e,n);return i!==wo&&Jj(r,Ks(),i),vn}function Jj(t,e,n){let r=Dx(e,t);IL(t[ht],r,n)}function Ol(t,e,n){lE(e)&&(e=e());let r=Re(),i=Ld();if(Js(r,i,e)){let o=kt(),l=gm();RE(o,l,r,t,e,r[ht],n,!1)}return Ol}function Qd(t,e){let n=lE(t);return n&&t.set(e),n}function Al(t,e){let n=Re(),r=kt(),i=Ft();return oC(r,n,n[ht],i,t,e),Al}function eV(t,e,n){let r=kt();if(r.firstCreatePass){let i=gi(t);Zg(n,r.data,r.blueprint,i,!0),Zg(e,r.data,r.blueprint,i,!1)}}function Zg(t,e,n,r,i){if(t=Wt(t),Array.isArray(t))for(let o=0;o<t.length;o++)Zg(t[o],e,n,r,i);else{let o=kt(),l=Re(),a=Ft(),c=Fs(t)?t:Wt(t.provide),s=bx(t),u=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(Fs(t)||!t.multi){let f=new po(s,i,te),p=pg(c,e,i?u:u+h,d);p===-1?(Og(pd(a,l),o,c),fg(o,t,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),l.push(f)):(n[p]=f,l[p]=f)}else{let f=pg(c,e,u+h,d),p=pg(c,e,u,u+h),g=f>=0&&n[f],y=p>=0&&n[p];if(i&&!y||!i&&!g){Og(pd(a,l),o,c);let b=rV(i?nV:tV,n.length,i,r,s);!i&&y&&(n[p].providerFactory=b),fg(o,t,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(b),l.push(b)}else{let b=sC(n[i?p:f],s,!i&&r);fg(o,t,f>-1?f:p,b)}!i&&r&&y&&n[p].componentProviders++}}}function fg(t,e,n,r){let i=Fs(e),o=Fk(e);if(i||o){let c=(o?Wt(e.useClass):e).prototype.ngOnDestroy;if(c){let s=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let u=s.indexOf(n);u===-1?s.push(n,[r,c]):s[u+1].push(r,c)}else s.push(n,c)}}}function sC(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function pg(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function tV(t,e,n,r){return Qg(this.multi,[])}function nV(t,e,n,r){let i=this.multi,o;if(this.providerFactory){let l=this.providerFactory.componentProviders,a=Us(n,n[ve],this.providerFactory.index,r);o=a.slice(0,l),Qg(i,o);for(let c=l;c<a.length;c++)o.push(a[c])}else o=[],Qg(i,o);return o}function Qg(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function rV(t,e,n,r,i){let o=new po(t,n,te);return o.multi=[],o.index=e,o.componentProviders=0,sC(o,i,r&&!n),o}function ta(t,e=[]){return n=>{n.providersResolver=(r,i)=>eV(r,i?i(t):t,e)}}function aC(t,e,n,r){return lC(Re(),Fx(),t,e,n,r)}function iV(t,e){let n=t[e];return n===wo?void 0:n}function lC(t,e,n,r,i,o){let l=e+n;return Js(t,l,i)?gj(t,l+1,o?r.call(o,i):r(i)):iV(t,l+1)}function na(t,e){let n=kt(),r,i=t+mn;n.firstCreatePass?(r=oV(e,n.pipeRegistry),n.data[i]=r,r.onDestroy&&(n.destroyHooks??=[]).push(i,r.onDestroy)):r=n.data[i];let o=r.factory||(r.factory=co(r.type,!0)),l,a=sn(te);try{let c=fd(!1),s=o();return fd(c),Zj(n,Re(),i,s),s}finally{sn(a)}}function oV(t,e){if(e)for(let n=e.length-1;n>=0;n--){let r=e[n];if(t===r.name)return r}}function ra(t,e,n){let r=t+mn,i=Re(),o=Ox(i,r);return sV(i,r)?lC(i,Fx(),e,o.transform,n,o):o.transform(n)}function sV(t,e){return t[ve].data[e].pure}var Jg=class{ngModuleFactory;componentFactories;constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},Jd=(()=>{class t{compileModuleSync(n){return new qg(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){let r=this.compileModuleSync(n),i=hx(n),o=xE(i.declarations).reduce((l,a)=>{let c=pi(a);return c&&l.push(new Ws(c)),l},[]);return new Jg(r,o)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var aV=(()=>{class t{zone=B(et);changeDetectionScheduler=B(Hs);applicationRef=B(jr);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),lV=new z("",{factory:()=>!1});function cC({ngZoneFactory:t,ignoreChangesOutsideZone:e,scheduleInRootZone:n}){return t??=()=>new et(N(C({},dC()),{scheduleInRootZone:n})),[{provide:et,useFactory:t},{provide:ks,multi:!0,useFactory:()=>{let r=B(aV,{optional:!0});return()=>r.initialize()}},{provide:ks,multi:!0,useFactory:()=>{let r=B(cV);return()=>{r.initialize()}}},e===!0?{provide:rE,useValue:!0}:[],{provide:iE,useValue:n??nE}]}function uC(t){let e=t?.ignoreChangesOutsideZone,n=t?.scheduleInRootZone,r=cC({ngZoneFactory:()=>{let i=dC(t);return i.scheduleInRootZone=n,i.shouldCoalesceEventChangeDetection&&bo("NgZone_CoalesceEvent"),new et(i)},ignoreChangesOutsideZone:e,scheduleInRootZone:n});return Ys([{provide:lV,useValue:!0},{provide:$d,useValue:!1},r])}function dC(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var cV=(()=>{class t{subscription=new Qe;initialized=!1;zone=B(et);pendingTasks=B(Ti);initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{et.assertNotInAngularZone(),queueMicrotask(()=>{n!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{et.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var uV=(()=>{class t{appRef=B(jr);taskService=B(Ti);ngZone=B(et);zonelessEnabled=B($d);tracing=B(Zs,{optional:!0});disableScheduling=B(rE,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Qe;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(md):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(B(iE,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Rg||!this.zoneIsDefined)}notify(n){if(!this.zonelessEnabled&&n===5)return;let r=!1;switch(n){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 8:{this.appRef.deferredDirtyFlags|=8;break}case 6:{this.appRef.dirtyFlags|=2,r=!0;break}case 13:{this.appRef.dirtyFlags|=16,r=!0;break}case 14:{this.appRef.dirtyFlags|=2,r=!0;break}case 12:{r=!0;break}case 10:case 9:case 7:case 11:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;let i=this.useMicrotaskScheduler?ET:oE;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(n){return!(this.disableScheduling&&!n||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(md+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let n=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(n),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,ET(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(n)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let n=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(n)}}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function dV(){return typeof $localize<"u"&&$localize.locale||Cd}var Ym=new z("",{providedIn:"root",factory:()=>B(Ym,ue.Optional|ue.SkipSelf)||dV()});var em=new z(""),hV=new z("");function hl(t){return!t.moduleRef}function fV(t){let e=hl(t)?t.r3Injector:t.moduleRef.injector,n=e.get(et);return n.run(()=>{hl(t)?t.r3Injector.resolveInjectorInitializers():t.moduleRef.resolveInjectorInitializers();let r=e.get(Lr,null),i;if(n.runOutsideAngular(()=>{i=n.onError.subscribe({next:o=>{r.handleError(o)}})}),hl(t)){let o=()=>e.destroy(),l=t.platformInjector.get(em);l.add(o),e.onDestroy(()=>{i.unsubscribe(),l.delete(o)})}else{let o=()=>t.moduleRef.destroy(),l=t.platformInjector.get(em);l.add(o),t.moduleRef.onDestroy(()=>{ed(t.allPlatformModules,t.moduleRef),i.unsubscribe(),l.delete(o)})}return Cj(r,n,()=>{let o=e.get(rC);return o.runInitializers(),o.donePromise.then(()=>{let l=e.get(Ym,Cd);if(Yj(l||Cd),!e.get(hV,!0))return hl(t)?e.get(jr):(t.allPlatformModules.push(t.moduleRef),t.moduleRef);if(hl(t)){let c=e.get(jr);return t.rootComponent!==void 0&&c.bootstrap(t.rootComponent),c}else return pV(t.moduleRef,t.allPlatformModules),t.moduleRef})})})}function pV(t,e){let n=t.injector.get(jr);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>n.bootstrap(r));else if(t.instance.ngDoBootstrap)t.instance.ngDoBootstrap(n);else throw new W(-403,!1);e.push(t)}var td=null;function gV(t=[],e){return yn.create({name:e,providers:[{provide:Md,useValue:"platform"},{provide:em,useValue:new Set([()=>td=null])},...t]})}function mV(t=[]){if(td)return td;let e=gV(t);return td=e,Tj(),yV(e),e}function yV(t){let e=t.get(Tm,null);an(t,()=>{e?.forEach(n=>n())})}var Si=(()=>{class t{static __NG_ELEMENT_ID__=vV}return t})();function vV(t){return bV(Ft(),Re(),(t&16)===16)}function bV(t,e,n){if(Nd(t)&&!n){let r=wi(t.index,e);return new go(r,r)}else if(t.type&175){let r=e[pr];return new go(r,e)}return null}var tm=class{constructor(){}supports(e){return tC(e)}create(e){return new nm(e)}},wV=(t,e)=>e,nm=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||wV}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,o=null;for(;n||r;){let l=!r||n&&n.currentIndex<qT(r,i,o)?n:r,a=qT(l,i,o),c=l.currentIndex;if(l===r)i--,r=r._nextRemoved;else if(n=n._next,l.previousIndex==null)i++;else{o||(o=[]);let s=a-i,u=c-i;if(s!=u){for(let h=0;h<s;h++){let f=h<o.length?o[h]:o[h]=0,p=f+h;u<=p&&p<s&&(o[h]=f+1)}let d=l.previousIndex;o[d]=u-s}}a!==c&&e(l,a,c)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!tC(e))throw new W(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,o,l;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],l=this._trackByFn(a,o),n===null||!Object.is(n.trackById,l)?(n=this._mismatch(n,o,l,a),r=!0):(r&&(n=this._verifyReinsertion(n,o,l,a)),Object.is(n.item,o)||this._addIdentityChange(n,o)),n=n._next}else i=0,fj(e,a=>{l=this._trackByFn(i,a),n===null||!Object.is(n.trackById,l)?(n=this._mismatch(n,a,l,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,l,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,o,i)):e=this._addAfter(new rm(n,r),o,i)),e}_verifyReinsertion(e,n,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new Sd),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Sd),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},rm=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,n){this.item=e,this.trackById=n}},im=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},Sd=class{map=new Map;put(e){let n=e.trackById,r=this.map.get(n);r||(r=new im,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function qT(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function YT(){return new Xm([new tm])}var Xm=(()=>{class t{factories;static \u0275prov=H({token:t,providedIn:"root",factory:YT});constructor(n){this.factories=n}static create(n,r){if(r!=null){let i=r.factories.slice();n=n.concat(i)}return new t(n)}static extend(n){return{provide:t,useFactory:r=>t.create(n,r||YT()),deps:[[t,new Ik,new lx]]}}find(n){let r=this.factories.find(i=>i.supports(n));if(r!=null)return r;throw new W(901,!1)}}return t})();function hC(t){try{let{rootComponent:e,appProviders:n,platformProviders:r}=t,i=mV(r),o=[cC({}),{provide:Hs,useExisting:uV},...n||[]],l=new xd({providers:o,parent:i,debugName:"",runEnvironmentInitializers:!1});return fV({r3Injector:l.injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}}function _o(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function eh(t,e){bo("NgSignals");let n=N_(t);return e?.equal&&(n[hn].equal=e.equal),n}function wr(t){let e=_e(null);try{return t()}finally{_e(e)}}var XT=class{[hn];constructor(e){this[hn]=e}destroy(){this[hn].destroy()}};function fC(t){let e=pi(t);if(!e)return null;let n=new Ws(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var bC=null;function qr(){return bC}function wC(t){bC??=t}var th=class{};var Bt=new z(""),ry=(()=>{class t{historyGo(n){throw new Error("")}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:()=>B(_V),providedIn:"platform"})}return t})(),_C=new z(""),_V=(()=>{class t extends ry{_location;_history;_doc=B(Bt);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return qr().getBaseHref(this._doc)}onPopState(n){let r=qr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){let r=qr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,r,i){this._history.pushState(n,r,i)}replaceState(n,r,i){this._history.replaceState(n,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:()=>new t,providedIn:"platform"})}return t})();function iy(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function pC(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function Wr(t){return t&&t[0]!=="?"?"?"+t:t}var Yr=(()=>{class t{historyGo(n){throw new Error("")}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:()=>B(oy),providedIn:"root"})}return t})(),TC=new z(""),oy=(()=>{class t extends Yr{_platformLocation;_baseHref;_removeListenerFns=[];constructor(n,r){super(),this._platformLocation=n,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??B(Bt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return iy(this._baseHref,n)}path(n=!1){let r=this._platformLocation.pathname+Wr(this._platformLocation.search),i=this._platformLocation.hash;return i&&n?`${r}${i}`:r}pushState(n,r,i,o){let l=this.prepareExternalUrl(i+Wr(o));this._platformLocation.pushState(n,r,l)}replaceState(n,r,i,o){let l=this.prepareExternalUrl(i+Wr(o));this._platformLocation.replaceState(n,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static \u0275fac=function(r){return new(r||t)(Y(ry),Y(TC,8))};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),xC=(()=>{class t extends Yr{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(n,r){super(),this._platformLocation=n,r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(n){let r=iy(this._baseHref,n);return r.length>0?"#"+r:r}pushState(n,r,i,o){let l=this.prepareExternalUrl(i+Wr(o));l.length==0&&(l=this._platformLocation.pathname),this._platformLocation.pushState(n,r,l)}replaceState(n,r,i,o){let l=this.prepareExternalUrl(i+Wr(o));l.length==0&&(l=this._platformLocation.pathname),this._platformLocation.replaceState(n,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static \u0275fac=function(r){return new(r||t)(Y(ry),Y(TC,8))};static \u0275prov=H({token:t,factory:t.\u0275fac})}return t})(),Di=(()=>{class t{_subject=new yt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(n){this._locationStrategy=n;let r=this._locationStrategy.getBaseHref();this._basePath=EV(pC(gC(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+Wr(r))}normalize(n){return t.stripTrailingSlash(xV(this._basePath,gC(n)))}prepareExternalUrl(n){return n&&n[0]!=="/"&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",i=null){this._locationStrategy.pushState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Wr(r)),i)}replaceState(n,r="",i=null){this._locationStrategy.replaceState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Wr(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(i=>i(n,r))}subscribe(n,r,i){return this._subject.subscribe({next:n,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=Wr;static joinWithSlash=iy;static stripTrailingSlash=pC;static \u0275fac=function(r){return new(r||t)(Y(Yr))};static \u0275prov=H({token:t,factory:()=>TV(),providedIn:"root"})}return t})();function TV(){return new Di(Y(Yr))}function xV(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function gC(t){return t.replace(/\/index.html$/,"")}function EV(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function nh(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,o]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var Km=/\s+/,mC=[],EC=(()=>{class t{_ngEl;_renderer;initialClasses=mC;rawClass;stateMap=new Map;constructor(n,r){this._ngEl=n,this._renderer=r}set klass(n){this.initialClasses=n!=null?n.trim().split(Km):mC}set ngClass(n){this.rawClass=typeof n=="string"?n.trim().split(Km):n}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let n=this.rawClass;if(Array.isArray(n)||n instanceof Set)for(let r of n)this._updateState(r,!0);else if(n!=null)for(let r of Object.keys(n))this._updateState(r,!!n[r]);this._applyStateDiff()}_updateState(n,r){let i=this.stateMap.get(n);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(n,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let n of this.stateMap){let r=n[0],i=n[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(n,r){n=n.trim(),n.length>0&&n.split(Km).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static \u0275fac=function(r){return new(r||t)(te(Hr),te(Ei))};static \u0275dir=Ot({type:t,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return t})();var Zm=class{$implicit;ngForOf;index;count;constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},rh=(()=>{class t{_viewContainer;_template;_differs;set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(n,r,i){this._viewContainer=n,this._template=r,this._differs=i}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){let n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){let r=this._viewContainer;n.forEachOperation((i,o,l)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new Zm(i.item,this._ngForOf,-1,-1),l===null?void 0:l);else if(l==null)r.remove(o===null?void 0:o);else if(o!==null){let a=r.get(o);r.move(a,l),yC(a,i)}});for(let i=0,o=r.length;i<o;i++){let a=r.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}n.forEachIdentityChange(i=>{let o=r.get(i.currentIndex);yC(o,i)})}static ngTemplateContextGuard(n,r){return!0}static \u0275fac=function(r){return new(r||t)(te(Qs),te(Xd),te(Xm))};static \u0275dir=Ot({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return t})();function yC(t,e){t.context.$implicit=e.item}var oa=(()=>{class t{_viewContainer;_context=new Qm;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(n,r){this._viewContainer=n,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){vC("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){vC("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(n,r){return!0}static \u0275fac=function(r){return new(r||t)(te(Qs),te(Xd))};static \u0275dir=Ot({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return t})(),Qm=class{$implicit=null;ngIf=null};function vC(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${qt(e)}'.`)}function CV(t,e){return new W(2100,!1)}var Jm=class{createSubscription(e,n){return wr(()=>e.subscribe({next:n,error:r=>{throw r}}))}dispose(e){wr(()=>e.unsubscribe())}},ey=class{createSubscription(e,n){return e.then(n,r=>{throw r})}dispose(e){}},SV=new ey,DV=new Jm,ih=(()=>{class t{_ref;_latestValue=null;markForCheckOnValueUpdate=!0;_subscription=null;_obj=null;_strategy=null;constructor(n){this._ref=n}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(n){if(!this._obj){if(n)try{this.markForCheckOnValueUpdate=!1,this._subscribe(n)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return n!==this._obj?(this._dispose(),this.transform(n)):this._latestValue}_subscribe(n){this._obj=n,this._strategy=this._selectStrategy(n),this._subscription=this._strategy.createSubscription(n,r=>this._updateLatestValue(n,r))}_selectStrategy(n){if(Ci(n))return SV;if(Hm(n))return DV;throw CV(t,n)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(n,r){n===this._obj&&(this._latestValue=r,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static \u0275fac=function(r){return new(r||t)(te(Si,16))};static \u0275pipe=QE({name:"async",type:t,pure:!1})}return t})();var Xr=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Gr({type:t});static \u0275inj=Vr({})}return t})(),CC="browser",IV="server";function sy(t){return t===IV}var SC=(()=>{class t{static \u0275prov=H({token:t,providedIn:"root",factory:()=>new ty(B(Bt),window)})}return t})(),ty=class{document;window;offset=()=>[0,0];constructor(e,n){this.document=e,this.window=n}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=OV(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(r-o[0],i-o[1])}};function OV(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let o=i.shadowRoot;if(o){let l=o.getElementById(e)||o.querySelector(`[name="${e}"]`);if(l)return l}i=r.nextNode()}}return null}var ia=class{};var Pl=class{},sh=class{},To=class t{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(n=>{let r=n.indexOf(":");if(r>0){let i=n.slice(0,r),o=n.slice(r+1).trim();this.addHeaderEntry(i,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((n,r)=>{this.addHeaderEntry(r,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([n,r])=>{this.setHeaderEntries(n,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){let n=new t;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){let n=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,n);let i=(e.op==="a"?this.headers.get(n):void 0)||[];i.push(...r),this.headers.set(n,i);break;case"d":let o=e.value;if(!o)this.headers.delete(n),this.normalizedNames.delete(n);else{let l=this.headers.get(n);if(!l)return;l=l.filter(a=>o.indexOf(a)===-1),l.length===0?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,l)}break}}addHeaderEntry(e,n){let r=e.toLowerCase();this.maybeSetNormalizedName(e,r),this.headers.has(r)?this.headers.get(r).push(n):this.headers.set(r,[n])}setHeaderEntries(e,n){let r=(Array.isArray(n)?n:[n]).map(o=>o.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}};var ly=class{encodeKey(e){return DC(e)}encodeValue(e){return DC(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function AV(t,e){let n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(i=>{let o=i.indexOf("="),[l,a]=o==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,o)),e.decodeValue(i.slice(o+1))],c=n.get(l)||[];c.push(a),n.set(l,c)}),n}var MV=/%(\d[a-f0-9])/gi,PV={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function DC(t){return encodeURIComponent(t).replace(MV,(e,n)=>PV[n]??e)}function oh(t){return`${t}`}var Ii=class t{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new ly,e.fromString){if(e.fromObject)throw new W(2805,!1);this.map=AV(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(n=>{let r=e.fromObject[n],i=Array.isArray(r)?r.map(oh):[oh(r)];this.map.set(n,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let n=this.map.get(e);return n?n[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,n){return this.clone({param:e,value:n,op:"a"})}appendAll(e){let n=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(o=>{n.push({param:r,value:o,op:"a"})}):n.push({param:r,value:i,op:"a"})}),this.clone(n)}set(e,n){return this.clone({param:e,value:n,op:"s"})}delete(e,n){return this.clone({param:e,value:n,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let n=this.encoder.encodeKey(e);return this.map.get(e).map(r=>n+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let n=new t({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(e),n}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let n=(e.op==="a"?this.map.get(e.param):void 0)||[];n.push(oh(e.value)),this.map.set(e.param,n);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(oh(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var cy=class{map=new Map;set(e,n){return this.map.set(e,n),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function NV(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function IC(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function OC(t){return typeof Blob<"u"&&t instanceof Blob}function AC(t){return typeof FormData<"u"&&t instanceof FormData}function RV(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}var MC="Content-Type",RC="X-Request-URL",kC="text/plain",FC="application/json",kV=`${FC}, ${kC}, */*`,Ml=class t{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(e,n,r,i){this.url=n,this.method=e.toUpperCase();let o;if(NV(this.method)||i?(this.body=r!==void 0?r:null,o=i):o=r,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),this.transferCache=o.transferCache),this.headers??=new To,this.context??=new cy,!this.params)this.params=new Ii,this.urlWithParams=n;else{let l=this.params.toString();if(l.length===0)this.urlWithParams=n;else{let a=n.indexOf("?"),c=a===-1?"?":a<n.length-1?"&":"";this.urlWithParams=n+c+l}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||IC(this.body)||OC(this.body)||AC(this.body)||RV(this.body)?this.body:this.body instanceof Ii?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||AC(this.body)?null:OC(this.body)?this.body.type||null:IC(this.body)?null:typeof this.body=="string"?kC:this.body instanceof Ii?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?FC:null}clone(e={}){let n=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,o=e.transferCache??this.transferCache,l=e.body!==void 0?e.body:this.body,a=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress,s=e.headers||this.headers,u=e.params||this.params,d=e.context??this.context;return e.setHeaders!==void 0&&(s=Object.keys(e.setHeaders).reduce((h,f)=>h.set(f,e.setHeaders[f]),s)),e.setParams&&(u=Object.keys(e.setParams).reduce((h,f)=>h.set(f,e.setParams[f]),u)),new t(n,r,l,{params:u,headers:s,context:d,reportProgress:c,responseType:i,withCredentials:a,transferCache:o})}},aa=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(aa||{}),Nl=class{headers;status;statusText;url;ok;type;constructor(e,n=200,r="OK"){this.headers=e.headers||new To,this.status=e.status!==void 0?e.status:n,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},uy=class t extends Nl{constructor(e={}){super(e)}type=aa.ResponseHeader;clone(e={}){return new t({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},ah=class t extends Nl{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=aa.Response;clone(e={}){return new t({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},lh=class extends Nl{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},FV=200,LV=204;function ay(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}var BV=(()=>{class t{handler;constructor(n){this.handler=n}request(n,r,i={}){let o;if(n instanceof Ml)o=n;else{let c;i.headers instanceof To?c=i.headers:c=new To(i.headers);let s;i.params&&(i.params instanceof Ii?s=i.params:s=new Ii({fromObject:i.params})),o=new Ml(n,r,i.body!==void 0?i.body:null,{headers:c,context:i.context,params:s,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache})}let l=K(o).pipe(Nr(c=>this.handler.handle(c)));if(n instanceof Ml||i.observe==="events")return l;let a=l.pipe(Dt(c=>c instanceof ah));switch(i.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return a.pipe(se(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return a.pipe(se(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return a.pipe(se(c=>{if(c.body!==null&&typeof c.body!="string")throw new Error("Response is not a string.");return c.body}));case"json":default:return a.pipe(se(c=>c.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(n,r={}){return this.request("DELETE",n,r)}get(n,r={}){return this.request("GET",n,r)}head(n,r={}){return this.request("HEAD",n,r)}jsonp(n,r){return this.request("JSONP",n,{params:new Ii().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,r={}){return this.request("OPTIONS",n,r)}patch(n,r,i={}){return this.request("PATCH",n,ay(i,r))}post(n,r,i={}){return this.request("POST",n,ay(i,r))}put(n,r,i={}){return this.request("PUT",n,ay(i,r))}static \u0275fac=function(r){return new(r||t)(Y(Pl))};static \u0275prov=H({token:t,factory:t.\u0275fac})}return t})();var jV=new z("");function VV(t,e){return e(t)}function $V(t,e,n){return(r,i)=>an(n,()=>e(r,o=>t(o,i)))}var LC=new z(""),UV=new z(""),HV=new z("",{providedIn:"root",factory:()=>!0});var PC=(()=>{class t extends Pl{backend;injector;chain=null;pendingTasks=B(Ti);contributeToStability=B(HV);constructor(n,r){super(),this.backend=n,this.injector=r}handle(n){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(LC),...this.injector.get(UV,[])]));this.chain=r.reduceRight((i,o)=>$V(i,o,this.injector),VV)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(n,i=>this.backend.handle(i)).pipe(ao(()=>this.pendingTasks.remove(r)))}else return this.chain(n,r=>this.backend.handle(r))}static \u0275fac=function(r){return new(r||t)(Y(sh),Y(Yt))};static \u0275prov=H({token:t,factory:t.\u0275fac})}return t})();var GV=/^\)\]\}',?\n/,zV=RegExp(`^${RC}:`,"m");function WV(t){return"responseURL"in t&&t.responseURL?t.responseURL:zV.test(t.getAllResponseHeaders())?t.getResponseHeader(RC):null}var NC=(()=>{class t{xhrFactory;constructor(n){this.xhrFactory=n}handle(n){if(n.method==="JSONP")throw new W(-2800,!1);let r=this.xhrFactory;return(r.\u0275loadImpl?He(r.\u0275loadImpl()):K(null)).pipe(on(()=>new Ee(o=>{let l=r.build();if(l.open(n.method,n.urlWithParams),n.withCredentials&&(l.withCredentials=!0),n.headers.forEach((g,y)=>l.setRequestHeader(g,y.join(","))),n.headers.has("Accept")||l.setRequestHeader("Accept",kV),!n.headers.has(MC)){let g=n.detectContentTypeHeader();g!==null&&l.setRequestHeader(MC,g)}if(n.responseType){let g=n.responseType.toLowerCase();l.responseType=g!=="json"?g:"text"}let a=n.serializeBody(),c=null,s=()=>{if(c!==null)return c;let g=l.statusText||"OK",y=new To(l.getAllResponseHeaders()),b=WV(l)||n.url;return c=new uy({headers:y,status:l.status,statusText:g,url:b}),c},u=()=>{let{headers:g,status:y,statusText:b,url:v}=s(),_=null;y!==LV&&(_=typeof l.response>"u"?l.responseText:l.response),y===0&&(y=_?FV:0);let I=y>=200&&y<300;if(n.responseType==="json"&&typeof _=="string"){let k=_;_=_.replace(GV,"");try{_=_!==""?JSON.parse(_):null}catch(V){_=k,I&&(I=!1,_={error:V,text:_})}}I?(o.next(new ah({body:_,headers:g,status:y,statusText:b,url:v||void 0})),o.complete()):o.error(new lh({error:_,headers:g,status:y,statusText:b,url:v||void 0}))},d=g=>{let{url:y}=s(),b=new lh({error:g,status:l.status||0,statusText:l.statusText||"Unknown Error",url:y||void 0});o.error(b)},h=!1,f=g=>{h||(o.next(s()),h=!0);let y={type:aa.DownloadProgress,loaded:g.loaded};g.lengthComputable&&(y.total=g.total),n.responseType==="text"&&l.responseText&&(y.partialText=l.responseText),o.next(y)},p=g=>{let y={type:aa.UploadProgress,loaded:g.loaded};g.lengthComputable&&(y.total=g.total),o.next(y)};return l.addEventListener("load",u),l.addEventListener("error",d),l.addEventListener("timeout",d),l.addEventListener("abort",d),n.reportProgress&&(l.addEventListener("progress",f),a!==null&&l.upload&&l.upload.addEventListener("progress",p)),l.send(a),o.next({type:aa.Sent}),()=>{l.removeEventListener("error",d),l.removeEventListener("abort",d),l.removeEventListener("load",u),l.removeEventListener("timeout",d),n.reportProgress&&(l.removeEventListener("progress",f),a!==null&&l.upload&&l.upload.removeEventListener("progress",p)),l.readyState!==l.DONE&&l.abort()}})))}static \u0275fac=function(r){return new(r||t)(Y(ia))};static \u0275prov=H({token:t,factory:t.\u0275fac})}return t})(),BC=new z(""),qV="XSRF-TOKEN",YV=new z("",{providedIn:"root",factory:()=>qV}),XV="X-XSRF-TOKEN",KV=new z("",{providedIn:"root",factory:()=>XV}),ch=class{},ZV=(()=>{class t{doc;platform;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(n,r,i){this.doc=n,this.platform=r,this.cookieName=i}getToken(){if(this.platform==="server")return null;let n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=nh(n,this.cookieName),this.lastCookieString=n),this.lastToken}static \u0275fac=function(r){return new(r||t)(Y(Bt),Y(xi),Y(YV))};static \u0275prov=H({token:t,factory:t.\u0275fac})}return t})();function QV(t,e){let n=t.url.toLowerCase();if(!B(BC)||t.method==="GET"||t.method==="HEAD"||n.startsWith("http://")||n.startsWith("https://"))return e(t);let r=B(ch).getToken(),i=B(KV);return r!=null&&!t.headers.has(i)&&(t=t.clone({headers:t.headers.set(i,r)})),e(t)}function jC(...t){let e=[BV,NC,PC,{provide:Pl,useExisting:PC},{provide:sh,useFactory:()=>B(jV,{optional:!0})??B(NC)},{provide:LC,useValue:QV,multi:!0},{provide:BC,useValue:!0},{provide:ch,useClass:ZV}];for(let n of t)e.push(...n.\u0275providers);return Ys(e)}var hy=class extends th{supportsDOMEvents=!0},fy=class t extends hy{static makeCurrent(){wC(new t)}onAndCancel(e,n,r,i){return e.addEventListener(n,r,i),()=>{e.removeEventListener(n,r,i)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.remove()}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=JV();return n==null?null:e$(n)}resetBaseElement(){Rl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return nh(document.cookie,e)}},Rl=null;function JV(){return Rl=Rl||document.querySelector("base"),Rl?Rl.getAttribute("href"):null}function e$(t){return new URL(t,document.baseURI).pathname}var t$=(()=>{class t{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:t.\u0275fac})}return t})(),py=new z(""),zC=(()=>{class t{_zone;_plugins;_eventNameToPlugin=new Map;constructor(n,r){this._zone=r,n.forEach(i=>{i.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,i,o){return this._findPluginFor(r).addEventListener(n,r,i,o)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(o=>o.supports(n)),!r)throw new W(5101,!1);return this._eventNameToPlugin.set(n,r),r}static \u0275fac=function(r){return new(r||t)(Y(py),Y(et))};static \u0275prov=H({token:t,factory:t.\u0275fac})}return t})(),dh=class{_doc;constructor(e){this._doc=e}manager},uh="ng-app-id";function VC(t){for(let e of t)e.remove()}function $C(t,e){let n=e.createElement("style");return n.textContent=t,n}function n$(t,e,n,r){let i=t.head?.querySelectorAll(`style[${uh}="${e}"],link[${uh}="${e}"]`);if(i)for(let o of i)o.removeAttribute(uh),o instanceof HTMLLinkElement?r.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&n.set(o.textContent,{usage:0,elements:[o]})}function gy(t,e){let n=e.createElement("link");return n.setAttribute("rel","stylesheet"),n.setAttribute("href",t),n}var WC=(()=>{class t{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(n,r,i,o={}){this.doc=n,this.appId=r,this.nonce=i,this.isServer=sy(o),n$(n,r,this.inline,this.external),this.hosts.add(n.head)}addStyles(n,r){for(let i of n)this.addUsage(i,this.inline,$C);r?.forEach(i=>this.addUsage(i,this.external,gy))}removeStyles(n,r){for(let i of n)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(n,r,i){let o=r.get(n);o?o.usage++:r.set(n,{usage:1,elements:[...this.hosts].map(l=>this.addElement(l,i(n,this.doc)))})}removeUsage(n,r){let i=r.get(n);i&&(i.usage--,i.usage<=0&&(VC(i.elements),r.delete(n)))}ngOnDestroy(){for(let[,{elements:n}]of[...this.inline,...this.external])VC(n);this.hosts.clear()}addHost(n){this.hosts.add(n);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(n,$C(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(n,gy(r,this.doc)))}removeHost(n){this.hosts.delete(n)}addElement(n,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(uh,this.appId),n.appendChild(r)}static \u0275fac=function(r){return new(r||t)(Y(Bt),Y(_m),Y(xm,8),Y(xi))};static \u0275prov=H({token:t,factory:t.\u0275fac})}return t})(),dy={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},yy=/%COMP%/g,qC="%COMP%",r$=`_nghost-${qC}`,i$=`_ngcontent-${qC}`,o$=!0,s$=new z("",{providedIn:"root",factory:()=>o$});function a$(t){return i$.replace(yy,t)}function l$(t){return r$.replace(yy,t)}function YC(t,e){return e.map(n=>n.replace(yy,t))}var UC=(()=>{class t{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(n,r,i,o,l,a,c,s=null,u=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=l,this.platformId=a,this.ngZone=c,this.nonce=s,this.tracingService=u,this.platformIsServer=sy(a),this.defaultRenderer=new kl(n,l,c,this.platformIsServer,this.tracingService)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===mr.ShadowDom&&(r=N(C({},r),{encapsulation:mr.Emulated}));let i=this.getOrCreateRenderer(n,r);return i instanceof hh?i.applyToHost(n):i instanceof Fl&&i.applyStyles(),i}getOrCreateRenderer(n,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let l=this.doc,a=this.ngZone,c=this.eventManager,s=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(r.encapsulation){case mr.Emulated:o=new hh(c,s,r,this.appId,u,l,a,d,this.tracingService);break;case mr.ShadowDom:return new my(c,s,n,r,l,a,this.nonce,d,this.tracingService);default:o=new Fl(c,s,r,u,l,a,d,this.tracingService);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(n){this.rendererByCompId.delete(n)}static \u0275fac=function(r){return new(r||t)(Y(zC),Y(WC),Y(_m),Y(s$),Y(Bt),Y(xi),Y(et),Y(xm),Y(Zs,8))};static \u0275prov=H({token:t,factory:t.\u0275fac})}return t})(),kl=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,n,r,i,o){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,n){return n?this.doc.createElementNS(dy[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(HC(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(HC(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){n.remove()}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new W(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let o=dy[i];o?e.setAttributeNS(o,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=dy[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Br.DashCase|Br.Important)?e.style.setProperty(n,r,i&Br.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Br.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r,i){if(typeof e=="string"&&(e=qr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);let o=this.decoratePreventDefault(r);return this.tracingService!==null&&this.tracingService.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,n,o)),this.eventManager.addEventListener(e,n,o,i)}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function HC(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var my=class extends kl{sharedStylesHost;hostEl;shadowRoot;constructor(e,n,r,i,o,l,a,c,s){super(e,o,l,c,s),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=YC(i.id,i.styles);for(let h of u){let f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=h,this.shadowRoot.appendChild(f)}let d=i.getExternalStyles?.();if(d)for(let h of d){let f=gy(h,o);a&&f.setAttribute("nonce",a),this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(null,n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Fl=class extends kl{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,n,r,i,o,l,a,c,s){super(e,o,l,a,c),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=s?YC(s,r.styles):r.styles,this.styleUrls=r.getExternalStyles?.(s)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},hh=class extends Fl{contentAttr;hostAttr;constructor(e,n,r,i,o,l,a,c,s){let u=i+"-"+r.id;super(e,n,r,o,l,a,c,s,u),this.contentAttr=a$(u),this.hostAttr=l$(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},c$=(()=>{class t extends dh{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,i,o){return n.addEventListener(r,i,o),()=>this.removeEventListener(n,r,i,o)}removeEventListener(n,r,i,o){return n.removeEventListener(r,i,o)}static \u0275fac=function(r){return new(r||t)(Y(Bt))};static \u0275prov=H({token:t,factory:t.\u0275fac})}return t})(),GC=["alt","control","meta","shift"],u$={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},d$={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},h$=(()=>{class t extends dh{constructor(n){super(n)}supports(n){return t.parseEventName(n)!=null}addEventListener(n,r,i,o){let l=t.parseEventName(r),a=t.eventCallback(l.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>qr().onAndCancel(n,l.domEventName,a,o))}static parseEventName(n){let r=n.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=t._normalizeKey(r.pop()),l="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),l="code."),GC.forEach(s=>{let u=r.indexOf(s);u>-1&&(r.splice(u,1),l+=s+".")}),l+=o,r.length!=0||o.length===0)return null;let c={};return c.domEventName=i,c.fullKey=l,c}static matchEventFullKeyCode(n,r){let i=u$[n.key]||n.key,o="";return r.indexOf("code.")>-1&&(i=n.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),GC.forEach(l=>{if(l!==i){let a=d$[l];a(n)&&(o+=l+".")}}),o+=i,o===r)}static eventCallback(n,r,i){return o=>{t.matchEventFullKeyCode(o,n)&&i.runGuarded(()=>r(o))}}static _normalizeKey(n){return n==="esc"?"escape":n}static \u0275fac=function(r){return new(r||t)(Y(Bt))};static \u0275prov=H({token:t,factory:t.\u0275fac})}return t})();function XC(t,e){return hC(C({rootComponent:t},f$(e)))}function f$(t){return{appProviders:[...v$,...t?.providers??[]],platformProviders:y$}}function p$(){fy.makeCurrent()}function g$(){return new Lr}function m$(){return gE(document),document}var y$=[{provide:xi,useValue:CC},{provide:Tm,useValue:p$,multi:!0},{provide:Bt,useFactory:m$,deps:[]}];var v$=[{provide:Md,useValue:"root"},{provide:Lr,useFactory:g$,deps:[]},{provide:py,useClass:c$,multi:!0,deps:[Bt,et,xi]},{provide:py,useClass:h$,multi:!0,deps:[Bt]},UC,WC,zC,{provide:zs,useExisting:UC},{provide:ia,useClass:t$,deps:[]},[]];var KC=(()=>{class t{_doc;constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static \u0275fac=function(r){return new(r||t)(Y(Bt))};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var ae="primary",Kl=Symbol("RouteTitle"),Ty=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function fa(t){return new Ty(t)}function w$(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let o=0;o<r.length;o++){let l=r[o],a=t[o];if(l[0]===":")i[l.substring(1)]=a;else if(l!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function _$(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!_r(t[n],e[n]))return!1;return!0}function _r(t,e){let n=t?xy(t):void 0,r=e?xy(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let o=0;o<n.length;o++)if(i=n[o],!sS(t[i],e[i]))return!1;return!0}function xy(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function sS(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,o)=>r[o]===i)}else return t===e}function aS(t){return t.length>0?t[t.length-1]:null}function Mi(t){return Kp(t)?t:Ci(t)?He(Promise.resolve(t)):K(t)}var T$={exact:cS,subset:uS},lS={exact:x$,subset:E$,ignored:()=>!0};function ZC(t,e,n){return T$[n.paths](t.root,e.root,n.matrixParams)&&lS[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function x$(t,e){return _r(t,e)}function cS(t,e,n){if(!Eo(t.segments,e.segments)||!gh(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!cS(t.children[r],e.children[r],n))return!1;return!0}function E$(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>sS(t[n],e[n]))}function uS(t,e,n){return dS(t,e,e.segments,n)}function dS(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!Eo(i,n)||e.hasChildren()||!gh(i,n,r))}else if(t.segments.length===n.length){if(!Eo(t.segments,n)||!gh(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!uS(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),o=n.slice(t.segments.length);return!Eo(t.segments,i)||!gh(t.segments,i,r)||!t.children[ae]?!1:dS(t.children[ae],e,o,r)}}function gh(t,e,n){return e.every((r,i)=>lS[n](t[i].parameters,r.parameters))}var Zr=class{root;queryParams;fragment;_queryParamMap;constructor(e=new Me([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=fa(this.queryParams),this._queryParamMap}toString(){return D$.serialize(this)}},Me=class{segments;children;parent=null;constructor(e,n){this.segments=e,this.children=n,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return mh(this)}},xo=class{path;parameters;_parameterMap;constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=fa(this.parameters),this._parameterMap}toString(){return fS(this)}};function C$(t,e){return Eo(t,e)&&t.every((n,r)=>_r(n.parameters,e[r].parameters))}function Eo(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function S$(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===ae&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==ae&&(n=n.concat(e(i,r)))}),n}var Zl=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:()=>new pa,providedIn:"root"})}return t})(),pa=class{parse(e){let n=new Cy(e);return new Zr(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${Ll(e.root,!0)}`,r=A$(e.queryParams),i=typeof e.fragment=="string"?`#${I$(e.fragment)}`:"";return`${n}${r}${i}`}},D$=new pa;function mh(t){return t.segments.map(e=>fS(e)).join("/")}function Ll(t,e){if(!t.hasChildren())return mh(t);if(e){let n=t.children[ae]?Ll(t.children[ae],!1):"",r=[];return Object.entries(t.children).forEach(([i,o])=>{i!==ae&&r.push(`${i}:${Ll(o,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=S$(t,(r,i)=>i===ae?[Ll(t.children[ae],!1)]:[`${i}:${Ll(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[ae]!=null?`${mh(t)}/${n[0]}`:`${mh(t)}/(${n.join("//")})`}}function hS(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function fh(t){return hS(t).replace(/%3B/gi,";")}function I$(t){return encodeURI(t)}function Ey(t){return hS(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function yh(t){return decodeURIComponent(t)}function QC(t){return yh(t.replace(/\+/g,"%20"))}function fS(t){return`${Ey(t.path)}${O$(t.parameters)}`}function O$(t){return Object.entries(t).map(([e,n])=>`;${Ey(e)}=${Ey(n)}`).join("")}function A$(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${fh(n)}=${fh(i)}`).join("&"):`${fh(n)}=${fh(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var M$=/^[^\/()?;#]+/;function vy(t){let e=t.match(M$);return e?e[0]:""}var P$=/^[^\/()?;=#]+/;function N$(t){let e=t.match(P$);return e?e[0]:""}var R$=/^[^=?&#]+/;function k$(t){let e=t.match(R$);return e?e[0]:""}var F$=/^[^&#]+/;function L$(t){let e=t.match(F$);return e?e[0]:""}var Cy=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Me([],{}):new Me([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[ae]=new Me(e,n)),r}parseSegment(){let e=vy(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new W(4009,!1);return this.capture(e),new xo(yh(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=N$(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=vy(this.remaining);i&&(r=i,this.capture(r))}e[yh(n)]=yh(r)}parseQueryParam(e){let n=k$(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let l=L$(this.remaining);l&&(r=l,this.capture(r))}let i=QC(n),o=QC(r);if(e.hasOwnProperty(i)){let l=e[i];Array.isArray(l)||(l=[l],e[i]=l),l.push(o)}else e[i]=o}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=vy(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new W(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=ae);let l=this.parseChildren();n[o]=Object.keys(l).length===1?l[ae]:new Me([],l),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new W(4011,!1)}};function pS(t){return t.segments.length>0?new Me([],{[ae]:t}):t}function gS(t){let e={};for(let[r,i]of Object.entries(t.children)){let o=gS(i);if(r===ae&&o.segments.length===0&&o.hasChildren())for(let[l,a]of Object.entries(o.children))e[l]=a;else(o.segments.length>0||o.hasChildren())&&(e[r]=o)}let n=new Me(t.segments,e);return B$(n)}function B$(t){if(t.numberOfChildren===1&&t.children[ae]){let e=t.children[ae];return new Me(t.segments.concat(e.segments),e.children)}return t}function Co(t){return t instanceof Zr}function j$(t,e,n=null,r=null){let i=mS(t);return yS(i,e,n,r)}function mS(t){let e;function n(o){let l={};for(let c of o.children){let s=n(c);l[c.outlet]=s}let a=new Me(o.url,l);return o===t&&(e=a),a}let r=n(t.root),i=pS(r);return e??i}function yS(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return by(i,i,i,n,r);let o=V$(e);if(o.toRoot())return by(i,i,new Me([],{}),n,r);let l=$$(o,i,t),a=l.processChildren?jl(l.segmentGroup,l.index,o.commands):bS(l.segmentGroup,l.index,o.commands);return by(i,l.segmentGroup,a,n,r)}function vh(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function Ul(t){return typeof t=="object"&&t!=null&&t.outlets}function by(t,e,n,r,i){let o={};r&&Object.entries(r).forEach(([c,s])=>{o[c]=Array.isArray(s)?s.map(u=>`${u}`):`${s}`});let l;t===e?l=n:l=vS(t,e,n);let a=pS(gS(l));return new Zr(a,o,i)}function vS(t,e,n){let r={};return Object.entries(t.children).forEach(([i,o])=>{o===e?r[i]=n:r[i]=vS(o,e,n)}),new Me(t.segments,r)}var bh=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&vh(r[0]))throw new W(4003,!1);let i=r.find(Ul);if(i&&i!==aS(r))throw new W(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function V$(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new bh(!0,0,t);let e=0,n=!1,r=t.reduce((i,o,l)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([c,s])=>{a[c]=typeof s=="string"?s.split("/"):s}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:l===0?(o.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new bh(n,e,r)}var ua=class{segmentGroup;processChildren;index;constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function $$(t,e,n){if(t.isAbsolute)return new ua(e,!0,0);if(!n)return new ua(e,!1,NaN);if(n.parent===null)return new ua(n,!0,0);let r=vh(t.commands[0])?0:1,i=n.segments.length-1+r;return U$(n,i,t.numberOfDoubleDots)}function U$(t,e,n){let r=t,i=e,o=n;for(;o>i;){if(o-=i,r=r.parent,!r)throw new W(4005,!1);i=r.segments.length}return new ua(r,!1,i-o)}function H$(t){return Ul(t[0])?t[0].outlets:{[ae]:t}}function bS(t,e,n){if(t??=new Me([],{}),t.segments.length===0&&t.hasChildren())return jl(t,e,n);let r=G$(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let o=new Me(t.segments.slice(0,r.pathIndex),{});return o.children[ae]=new Me(t.segments.slice(r.pathIndex),t.children),jl(o,0,i)}else return r.match&&i.length===0?new Me(t.segments,{}):r.match&&!t.hasChildren()?Sy(t,e,n):r.match?jl(t,0,i):Sy(t,e,n)}function jl(t,e,n){if(n.length===0)return new Me(t.segments,{});{let r=H$(n),i={};if(Object.keys(r).some(o=>o!==ae)&&t.children[ae]&&t.numberOfChildren===1&&t.children[ae].segments.length===0){let o=jl(t.children[ae],e,n);return new Me(t.segments,o.children)}return Object.entries(r).forEach(([o,l])=>{typeof l=="string"&&(l=[l]),l!==null&&(i[o]=bS(t.children[o],e,l))}),Object.entries(t.children).forEach(([o,l])=>{r[o]===void 0&&(i[o]=l)}),new Me(t.segments,i)}}function G$(t,e,n){let r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return o;let l=t.segments[i],a=n[r];if(Ul(a))break;let c=`${a}`,s=r<n.length-1?n[r+1]:null;if(i>0&&c===void 0)break;if(c&&s&&typeof s=="object"&&s.outlets===void 0){if(!eS(c,s,l))return o;r+=2}else{if(!eS(c,{},l))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Sy(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let o=n[i];if(Ul(o)){let c=z$(o.outlets);return new Me(r,c)}if(i===0&&vh(n[0])){let c=t.segments[e];r.push(new xo(c.path,JC(n[0]))),i++;continue}let l=Ul(o)?o.outlets[ae]:`${o}`,a=i<n.length-1?n[i+1]:null;l&&a&&vh(a)?(r.push(new xo(l,JC(a))),i+=2):(r.push(new xo(l,{})),i++)}return new Me(r,{})}function z$(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=Sy(new Me([],{}),0,r))}),e}function JC(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function eS(t,e,n){return t==n.path&&_r(e,n.parameters)}var Vl="imperative",Tt=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(Tt||{}),kn=class{id;url;constructor(e,n){this.id=e,this.url=n}},ga=class extends kn{type=Tt.NavigationStart;navigationTrigger;restoredState;constructor(e,n,r="imperative",i=null){super(e,n),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Fn=class extends kn{urlAfterRedirects;type=Tt.NavigationEnd;constructor(e,n,r){super(e,n),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},_n=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(_n||{}),wh=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(wh||{}),Kr=class extends kn{reason;code;type=Tt.NavigationCancel;constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Oi=class extends kn{reason;code;type=Tt.NavigationSkipped;constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i}},Hl=class extends kn{error;target;type=Tt.NavigationError;constructor(e,n,r,i){super(e,n),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},_h=class extends kn{urlAfterRedirects;state;type=Tt.RoutesRecognized;constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Dy=class extends kn{urlAfterRedirects;state;type=Tt.GuardsCheckStart;constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Iy=class extends kn{urlAfterRedirects;state;shouldActivate;type=Tt.GuardsCheckEnd;constructor(e,n,r,i,o){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Oy=class extends kn{urlAfterRedirects;state;type=Tt.ResolveStart;constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ay=class extends kn{urlAfterRedirects;state;type=Tt.ResolveEnd;constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},My=class{route;type=Tt.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Py=class{route;type=Tt.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Ny=class{snapshot;type=Tt.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ry=class{snapshot;type=Tt.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ky=class{snapshot;type=Tt.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Fy=class{snapshot;type=Tt.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Th=class{routerEvent;position;anchor;type=Tt.Scroll;constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Gl=class{},ma=class{url;navigationBehaviorOptions;constructor(e,n){this.url=e,this.navigationBehaviorOptions=n}};function W$(t,e){return t.providers&&!t._injector&&(t._injector=Kd(t.providers,e,`Route: ${t.path}`)),t._injector??e}function tr(t){return t.outlet||ae}function q$(t,e){let n=t.filter(r=>tr(r)===e);return n.push(...t.filter(r=>tr(r)!==e)),n}function Ql(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var Ly=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Ql(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new Jl(this.rootInjector)}},Jl=(()=>{class t{rootInjector;contexts=new Map;constructor(n){this.rootInjector=n}onChildOutletCreated(n,r){let i=this.getOrCreateContext(n);i.outlet=r,this.contexts.set(n,i)}onChildOutletDestroyed(n){let r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new Ly(this.rootInjector),this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}static \u0275fac=function(r){return new(r||t)(Y(Yt))};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),xh=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=By(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=By(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=jy(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return jy(e,this._root).map(n=>n.value)}};function By(t,e){if(t===e.value)return e;for(let n of e.children){let r=By(t,n);if(r)return r}return null}function jy(t,e){if(t===e.value)return[e];for(let n of e.children){let r=jy(t,n);if(r.length)return r.unshift(e),r}return[]}var wn=class{value;children;constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function ca(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var Eh=class extends xh{snapshot;constructor(e,n){super(e),this.snapshot=n,Yy(this,e)}toString(){return this.snapshot.toString()}};function wS(t){let e=Y$(t),n=new Je([new xo("",{})]),r=new Je({}),i=new Je({}),o=new Je({}),l=new Je(""),a=new Ai(n,r,o,l,i,ae,t,e.root);return a.snapshot=e.root,new Eh(new wn(a,[]),e)}function Y$(t){let e={},n={},r={},i="",o=new da([],e,r,i,n,ae,t,null,{});return new Sh("",new wn(o,[]))}var Ai=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,n,r,i,o,l,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=l,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(se(s=>s[Kl]))??K(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(se(e=>fa(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(se(e=>fa(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Ch(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:C(C({},e.params),t.params),data:C(C({},e.data),t.data),resolve:C(C(C(C({},t.data),e.data),i?.data),t._resolvedData)}:r={params:C({},t.params),data:C({},t.data),resolve:C(C({},t.data),t._resolvedData??{})},i&&TS(i)&&(r.resolve[Kl]=i.title),r}var da=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Kl]}constructor(e,n,r,i,o,l,a,c,s){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=l,this.component=a,this.routeConfig=c,this._resolve=s}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=fa(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=fa(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},Sh=class extends xh{url;constructor(e,n){super(n),this.url=e,Yy(this,n)}toString(){return _S(this._root)}};function Yy(t,e){e.value._routerState=t,e.children.forEach(n=>Yy(t,n))}function _S(t){let e=t.children.length>0?` { ${t.children.map(_S).join(", ")} } `:"";return`${t.value}${e}`}function wy(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,_r(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),_r(e.params,n.params)||t.paramsSubject.next(n.params),_$(e.url,n.url)||t.urlSubject.next(n.url),_r(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function Vy(t,e){let n=_r(t.params,e.params)&&C$(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||Vy(t.parent,e.parent))}function TS(t){return typeof t.title=="string"||t.title===null}var X$=new z(""),Xy=(()=>{class t{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=ae;activateEvents=new It;deactivateEvents=new It;attachEvents=new It;detachEvents=new It;routerOutletData=aE(void 0);parentContexts=B(Jl);location=B(Qs);changeDetector=B(Si);inputBinder=B(Ah,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(n){if(n.name){let{firstChange:r,previousValue:i}=n.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new W(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new W(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new W(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new W(4013,!1);this._activatedRoute=n;let i=this.location,l=n.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new $y(n,a,i.injector,this.routerOutletData);this.activated=i.createComponent(l,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ot({type:t,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[yo]})}return t})(),$y=class t{route;childContexts;parent;outletData;__ngOutletInjector(e){return new t(this.route,this.childContexts,e,this.outletData)}constructor(e,n,r,i){this.route=e,this.childContexts=n,this.parent=r,this.outletData=i}get(e,n){return e===Ai?this.route:e===Jl?this.childContexts:e===X$?this.outletData:this.parent.get(e,n)}},Ah=new z(""),tS=(()=>{class t{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){let{activatedRoute:r}=n,i=dl([r.queryParams,r.params,r.data]).pipe(on(([o,l,a],c)=>(a=C(C(C({},o),l),a),c===0?K(a):Promise.resolve(a)))).subscribe(o=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(n);return}let l=fC(r.component);if(!l){this.unsubscribeFromRouteData(n);return}for(let{templateName:a}of l.inputs)n.activatedComponentRef.setInput(a,o[a])});this.outletDataSubscriptions.set(n,i)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:t.\u0275fac})}return t})();function K$(t,e,n){let r=zl(t,e._root,n?n._root:void 0);return new Eh(r,e)}function zl(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=Z$(t,e,n);return new wn(r,i)}else{if(t.shouldAttach(e.value)){let o=t.retrieve(e.value);if(o!==null){let l=o.route;return l.value._futureSnapshot=e.value,l.children=e.children.map(a=>zl(t,a)),l}}let r=Q$(e.value),i=e.children.map(o=>zl(t,o));return new wn(r,i)}}function Z$(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return zl(t,r,i);return zl(t,r)})}function Q$(t){return new Ai(new Je(t.url),new Je(t.params),new Je(t.queryParams),new Je(t.fragment),new Je(t.data),t.outlet,t.component,t)}var Wl=class{redirectTo;navigationBehaviorOptions;constructor(e,n){this.redirectTo=e,this.navigationBehaviorOptions=n}},xS="ngNavigationCancelingError";function Dh(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=Co(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=ES(!1,_n.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function ES(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[xS]=!0,n.cancellationCode=e,n}function J$(t){return CS(t)&&Co(t.url)}function CS(t){return!!t&&t[xS]}var e3=(t,e,n,r)=>se(i=>(new Uy(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),Uy=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,n,r,i,o){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),wy(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=ca(n);e.children.forEach(o=>{let l=o.value.outlet;this.deactivateRoutes(o,i[l],r),delete i[l]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,n,r){let i=e.value,o=n?n.value:null;if(i===o)if(i.component){let l=r.getContext(i.outlet);l&&this.deactivateChildRoutes(e,n,l.children)}else this.deactivateChildRoutes(e,n,r);else o&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,o=ca(e);for(let l of Object.values(o))this.deactivateRouteAndItsChildren(l,i);if(r&&r.outlet){let l=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:l,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,o=ca(e);for(let l of Object.values(o))this.deactivateRouteAndItsChildren(l,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=ca(n);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new Fy(o.value.snapshot))}),e.children.length&&this.forwardEvent(new Ry(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,o=n?n.value:null;if(wy(i),i===o)if(i.component){let l=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,l.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let l=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),l.children.onOutletReAttached(a.contexts),l.attachRef=a.componentRef,l.route=a.route.value,l.outlet&&l.outlet.attach(a.componentRef,a.route.value),wy(a.route.value),this.activateChildRoutes(e,null,l.children)}else l.attachRef=null,l.route=i,l.outlet&&l.outlet.activateWith(i,l.injector),this.activateChildRoutes(e,null,l.children)}else this.activateChildRoutes(e,null,r)}},Ih=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},ha=class{component;route;constructor(e,n){this.component=e,this.route=n}};function t3(t,e,n){let r=t._root,i=e?e._root:null;return Bl(r,i,n,[r.value])}function n3(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function va(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!tx(t)?t:e.get(t):r}function Bl(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=ca(e);return t.children.forEach(l=>{r3(l,o[l.value.outlet],n,r.concat([l.value]),i),delete o[l.value.outlet]}),Object.entries(o).forEach(([l,a])=>$l(a,n.getContext(l),i)),i}function r3(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=t.value,l=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(l&&o.routeConfig===l.routeConfig){let c=i3(l,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Ih(r)):(o.data=l.data,o._resolvedData=l._resolvedData),o.component?Bl(t,e,a?a.children:null,r,i):Bl(t,e,n,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new ha(a.outlet.component,l))}else l&&$l(e,a,i),i.canActivateChecks.push(new Ih(r)),o.component?Bl(t,null,a?a.children:null,r,i):Bl(t,null,n,r,i);return i}function i3(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Eo(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Eo(t.url,e.url)||!_r(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Vy(t,e)||!_r(t.queryParams,e.queryParams);case"paramsChange":default:return!Vy(t,e)}}function $l(t,e,n){let r=ca(t),i=t.value;Object.entries(r).forEach(([o,l])=>{i.component?e?$l(l,e.children.getContext(o),n):$l(l,null,n):$l(l,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new ha(e.outlet.component,i)):n.canDeactivateChecks.push(new ha(null,i)):n.canDeactivateChecks.push(new ha(null,i))}function ec(t){return typeof t=="function"}function o3(t){return typeof t=="boolean"}function s3(t){return t&&ec(t.canLoad)}function a3(t){return t&&ec(t.canActivate)}function l3(t){return t&&ec(t.canActivateChild)}function c3(t){return t&&ec(t.canDeactivate)}function u3(t){return t&&ec(t.canMatch)}function SS(t){return t instanceof Pr||t?.name==="EmptyError"}var ph=Symbol("INITIAL_VALUE");function ya(){return on(t=>dl(t.map(e=>e.pipe(Rr(1),tg(ph)))).pipe(se(e=>{for(let n of e)if(n!==!0){if(n===ph)return ph;if(n===!1||d3(n))return n}return!0}),Dt(e=>e!==ph),Rr(1)))}function d3(t){return Co(t)||t instanceof Wl}function h3(t,e){return dt(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:l}}=n;return l.length===0&&o.length===0?K(N(C({},n),{guardsResult:!0})):f3(l,r,i,t).pipe(dt(a=>a&&o3(a)?p3(r,o,t,e):K(a)),se(a=>N(C({},n),{guardsResult:a})))})}function f3(t,e,n,r){return He(t).pipe(dt(i=>b3(i.component,i.route,n,e,r)),kr(i=>i!==!0,!0))}function p3(t,e,n,r){return He(e).pipe(Nr(i=>Ss(m3(i.route.parent,r),g3(i.route,r),v3(t,i.path,n),y3(t,i.route,n))),kr(i=>i!==!0,!0))}function g3(t,e){return t!==null&&e&&e(new ky(t)),K(!0)}function m3(t,e){return t!==null&&e&&e(new Ny(t)),K(!0)}function y3(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return K(!0);let i=r.map(o=>zu(()=>{let l=Ql(e)??n,a=va(o,l),c=a3(a)?a.canActivate(e,t):an(l,()=>a(e,t));return Mi(c).pipe(kr())}));return K(i).pipe(ya())}function v3(t,e,n){let r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(l=>n3(l)).filter(l=>l!==null).map(l=>zu(()=>{let a=l.guards.map(c=>{let s=Ql(l.node)??n,u=va(c,s),d=l3(u)?u.canActivateChild(r,t):an(s,()=>u(r,t));return Mi(d).pipe(kr())});return K(a).pipe(ya())}));return K(o).pipe(ya())}function b3(t,e,n,r,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return K(!0);let l=o.map(a=>{let c=Ql(e)??i,s=va(a,c),u=c3(s)?s.canDeactivate(t,e,n,r):an(c,()=>s(t,e,n,r));return Mi(u).pipe(kr())});return K(l).pipe(ya())}function w3(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return K(!0);let o=i.map(l=>{let a=va(l,t),c=s3(a)?a.canLoad(e,n):an(t,()=>a(e,n));return Mi(c)});return K(o).pipe(ya(),DS(r))}function DS(t){return zp(_t(e=>{if(typeof e!="boolean")throw Dh(t,e)}),se(e=>e===!0))}function _3(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return K(!0);let o=i.map(l=>{let a=va(l,t),c=u3(a)?a.canMatch(e,n):an(t,()=>a(e,n));return Mi(c)});return K(o).pipe(ya(),DS(r))}var ql=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},Yl=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function la(t){return Es(new ql(t))}function T3(t){return Es(new W(4e3,!1))}function x3(t){return Es(ES(!1,_n.GuardRejected))}var Hy=class{urlSerializer;urlTree;constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return K(r);if(i.numberOfChildren>1||!i.children[ae])return T3(`${e.redirectTo}`);i=i.children[ae]}}applyRedirectCommands(e,n,r,i,o){if(typeof n!="string"){let a=n,{queryParams:c,fragment:s,routeConfig:u,url:d,outlet:h,params:f,data:p,title:g}=i,y=an(o,()=>a({params:f,data:p,queryParams:c,fragment:s,routeConfig:u,url:d,outlet:h,title:g}));if(y instanceof Zr)throw new Yl(y);n=y}let l=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n[0]==="/")throw new Yl(l);return l}applyRedirectCreateUrlTree(e,n,r,i){let o=this.createSegmentGroup(e,n.root,r,i);return new Zr(o,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);r[i]=n[a]}else r[i]=o}),r}createSegmentGroup(e,n,r,i){let o=this.createSegments(e,n.segments,r,i),l={};return Object.entries(n.children).forEach(([a,c])=>{l[a]=this.createSegmentGroup(e,c,r,i)}),new Me(o,l)}createSegments(e,n,r,i){return n.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new W(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},Gy={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function E3(t,e,n,r,i){let o=IS(t,e,n);return o.matched?(r=W$(e,r),_3(r,e,n,i).pipe(se(l=>l===!0?o:C({},Gy)))):K(o)}function IS(t,e,n){if(e.path==="**")return C3(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?C({},Gy):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||w$)(n,t,e);if(!i)return C({},Gy);let o={};Object.entries(i.posParams??{}).forEach(([a,c])=>{o[a]=c.path});let l=i.consumed.length>0?C(C({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:l,positionalParamSegments:i.posParams??{}}}function C3(t){return{matched:!0,parameters:t.length>0?aS(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function nS(t,e,n,r){return n.length>0&&I3(t,n,r)?{segmentGroup:new Me(e,D3(r,new Me(n,t.children))),slicedSegments:[]}:n.length===0&&O3(t,n,r)?{segmentGroup:new Me(t.segments,S3(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Me(t.segments,t.children),slicedSegments:n}}function S3(t,e,n,r){let i={};for(let o of n)if(Mh(t,e,o)&&!r[tr(o)]){let l=new Me([],{});i[tr(o)]=l}return C(C({},r),i)}function D3(t,e){let n={};n[ae]=e;for(let r of t)if(r.path===""&&tr(r)!==ae){let i=new Me([],{});n[tr(r)]=i}return n}function I3(t,e,n){return n.some(r=>Mh(t,e,r)&&tr(r)!==ae)}function O3(t,e,n){return n.some(r=>Mh(t,e,r))}function Mh(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function A3(t,e,n){return e.length===0&&!t.children[n]}var zy=class{};function M3(t,e,n,r,i,o,l="emptyOnly"){return new Wy(t,e,n,r,i,l,o).recognize()}var P3=31,Wy=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,n,r,i,o,l,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=l,this.urlSerializer=a,this.applyRedirects=new Hy(this.urlSerializer,this.urlTree)}noMatchError(e){return new W(4002,`'${e.segmentGroup}'`)}recognize(){let e=nS(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(se(({children:n,rootSnapshot:r})=>{let i=new wn(r,n),o=new Sh("",i),l=j$(r,[],this.urlTree.queryParams,this.urlTree.fragment);return l.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(l),{state:o,tree:l}}))}match(e){let n=new da([],Object.freeze({}),Object.freeze(C({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),ae,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,ae,n).pipe(se(r=>({children:r,rootSnapshot:n})),ci(r=>{if(r instanceof Yl)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof ql?this.noMatchError(r):r}))}processSegmentGroup(e,n,r,i,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r,o):this.processSegment(e,n,r,r.segments,i,!0,o).pipe(se(l=>l instanceof wn?[l]:[]))}processChildren(e,n,r,i){let o=[];for(let l of Object.keys(r.children))l==="primary"?o.unshift(l):o.push(l);return He(o).pipe(Nr(l=>{let a=r.children[l],c=q$(n,l);return this.processSegmentGroup(e,c,a,l,i)}),eg((l,a)=>(l.push(...a),l)),ui(null),Jp(),dt(l=>{if(l===null)return la(r);let a=OS(l);return N3(a),K(a)}))}processSegment(e,n,r,i,o,l,a){return He(n).pipe(Nr(c=>this.processSegmentAgainstRoute(c._injector??e,n,c,r,i,o,l,a).pipe(ci(s=>{if(s instanceof ql)return K(null);throw s}))),kr(c=>!!c),ci(c=>{if(SS(c))return A3(r,i,o)?K(new zy):la(r);throw c}))}processSegmentAgainstRoute(e,n,r,i,o,l,a,c){return tr(r)!==l&&(l===ae||!Mh(i,o,r))?la(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,o,l,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,o,l,c):la(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,o,l,a){let{matched:c,parameters:s,consumedSegments:u,positionalParamSegments:d,remainingSegments:h}=IS(n,i,o);if(!c)return la(n);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>P3&&(this.allowRedirects=!1));let f=new da(o,s,Object.freeze(C({},this.urlTree.queryParams)),this.urlTree.fragment,rS(i),tr(i),i.component??i._loadedComponent??null,i,iS(i)),p=Ch(f,a,this.paramsInheritanceStrategy);f.params=Object.freeze(p.params),f.data=Object.freeze(p.data);let g=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,d,f,e);return this.applyRedirects.lineralizeSegments(i,g).pipe(dt(y=>this.processSegment(e,r,n,y.concat(h),l,!1,a)))}matchSegmentAgainstRoute(e,n,r,i,o,l){let a=E3(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),a.pipe(on(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(on(({routes:s})=>{let u=r._loadedInjector??e,{parameters:d,consumedSegments:h,remainingSegments:f}=c,p=new da(h,d,Object.freeze(C({},this.urlTree.queryParams)),this.urlTree.fragment,rS(r),tr(r),r.component??r._loadedComponent??null,r,iS(r)),g=Ch(p,l,this.paramsInheritanceStrategy);p.params=Object.freeze(g.params),p.data=Object.freeze(g.data);let{segmentGroup:y,slicedSegments:b}=nS(n,h,f,s);if(b.length===0&&y.hasChildren())return this.processChildren(u,s,y,p).pipe(se(_=>new wn(p,_)));if(s.length===0&&b.length===0)return K(new wn(p,[]));let v=tr(r)===o;return this.processSegment(u,s,y,b,v?ae:o,!0,p).pipe(se(_=>new wn(p,_ instanceof wn?[_]:[])))}))):la(n)))}getChildConfig(e,n,r){return n.children?K({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?K({routes:n._loadedRoutes,injector:n._loadedInjector}):w3(e,n,r,this.urlSerializer).pipe(dt(i=>i?this.configLoader.loadChildren(e,n).pipe(_t(o=>{n._loadedRoutes=o.routes,n._loadedInjector=o.injector})):x3(n))):K({routes:[],injector:e})}};function N3(t){t.sort((e,n)=>e.value.outlet===ae?-1:n.value.outlet===ae?1:e.value.outlet.localeCompare(n.value.outlet))}function R3(t){let e=t.value.routeConfig;return e&&e.path===""}function OS(t){let e=[],n=new Set;for(let r of t){if(!R3(r)){e.push(r);continue}let i=e.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=OS(r.children);e.push(new wn(r.value,i))}return e.filter(r=>!n.has(r))}function rS(t){return t.data||{}}function iS(t){return t.resolve||{}}function k3(t,e,n,r,i,o){return dt(l=>M3(t,e,n,r,l.extractedUrl,i,o).pipe(se(({state:a,tree:c})=>N(C({},l),{targetSnapshot:a,urlAfterRedirects:c}))))}function F3(t,e){return dt(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return K(n);let o=new Set(i.map(c=>c.route)),l=new Set;for(let c of o)if(!l.has(c))for(let s of AS(c))l.add(s);let a=0;return He(l).pipe(Nr(c=>o.has(c)?L3(c,r,t,e):(c.data=Ch(c,c.parent,t).resolve,K(void 0))),_t(()=>a++),Ds(1),dt(c=>a===l.size?K(n):pn))})}function AS(t){let e=t.children.map(n=>AS(n)).flat();return[t,...e]}function L3(t,e,n,r){let i=t.routeConfig,o=t._resolve;return i?.title!==void 0&&!TS(i)&&(o[Kl]=i.title),B3(o,t,e,r).pipe(se(l=>(t._resolvedData=l,t.data=Ch(t,t.parent,n).resolve,null)))}function B3(t,e,n,r){let i=xy(t);if(i.length===0)return K({});let o={};return He(i).pipe(dt(l=>j3(t[l],e,n,r).pipe(kr(),_t(a=>{if(a instanceof Wl)throw Dh(new pa,a);o[l]=a}))),Ds(1),se(()=>o),ci(l=>SS(l)?pn:Es(l)))}function j3(t,e,n,r){let i=Ql(e)??r,o=va(t,i),l=o.resolve?o.resolve(e,n):an(i,()=>o(e,n));return Mi(l)}function _y(t){return on(e=>{let n=t(e);return n?He(n).pipe(se(()=>e)):K(e)})}var MS=(()=>{class t{buildTitle(n){let r,i=n.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===ae);return r}getResolvedTitleForRoute(n){return n.data[Kl]}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:()=>B(V3),providedIn:"root"})}return t})(),V3=(()=>{class t extends MS{title;constructor(n){super(),this.title=n}updateTitle(n){let r=this.buildTitle(n);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||t)(Y(KC))};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),tc=new z("",{providedIn:"root",factory:()=>({})}),$3=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275cmp=br({type:t,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&tt(0,"router-outlet")},dependencies:[Xy],encapsulation:2})}return t})();function Ky(t){let e=t.children&&t.children.map(Ky),n=e?N(C({},t),{children:e}):C({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==ae&&(n.component=$3),n}var Xl=new z(""),Zy=(()=>{class t{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=B(Jd);loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return K(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);let r=Mi(n.loadComponent()).pipe(se(PS),_t(o=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=o}),ao(()=>{this.componentLoaders.delete(n)})),i=new Ts(r,()=>new yt).pipe(_s());return this.componentLoaders.set(n,i),i}loadChildren(n,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return K({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=U3(r,this.compiler,n,this.onLoadEndListener).pipe(ao(()=>{this.childrenLoaders.delete(r)})),l=new Ts(o,()=>new yt).pipe(_s());return this.childrenLoaders.set(r,l),l}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function U3(t,e,n,r){return Mi(t.loadChildren()).pipe(se(PS),dt(i=>i instanceof bl||Array.isArray(i)?K(i):He(e.compileModuleAsync(i))),se(i=>{r&&r(t);let o,l,a=!1;return Array.isArray(i)?(l=i,a=!0):(o=i.create(n).injector,l=o.get(Xl,[],{optional:!0,self:!0}).flat()),{routes:l.map(Ky),injector:o}}))}function H3(t){return t&&typeof t=="object"&&"default"in t}function PS(t){return H3(t)?t.default:t}var Qy=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:()=>B(G3),providedIn:"root"})}return t})(),G3=(()=>{class t{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),NS=new z(""),RS=new z("");function z3(t,e,n){let r=t.get(RS),i=t.get(Bt);return t.get(et).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(s=>setTimeout(s));let o,l=new Promise(s=>{o=s}),a=i.startViewTransition(()=>(o(),W3(t))),{onViewTransitionCreated:c}=r;return c&&an(t,()=>c({transition:a,from:e,to:n})),l})}function W3(t){return new Promise(e=>{Cm({read:()=>setTimeout(e)},{injector:t})})}var kS=new z(""),Jy=(()=>{class t{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new yt;transitionAbortSubject=new yt;configLoader=B(Zy);environmentInjector=B(Yt);urlSerializer=B(Zl);rootContexts=B(Jl);location=B(Di);inputBindingEnabled=B(Ah,{optional:!0})!==null;titleStrategy=B(MS);options=B(tc,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=B(Qy);createViewTransition=B(NS,{optional:!0});navigationErrorHandler=B(kS,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>K(void 0);rootComponentType=null;constructor(){let n=i=>this.events.next(new My(i)),r=i=>this.events.next(new Py(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=n}complete(){this.transitions?.complete()}handleNavigationRequest(n){let r=++this.navigationId;this.transitions?.next(N(C(C({},this.transitions.value),n),{id:r}))}setupNavigations(n,r,i){return this.transitions=new Je({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Vl,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Dt(o=>o.id!==0),se(o=>N(C({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),on(o=>{let l=!1,a=!1;return K(o).pipe(on(c=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",_n.SupersededByNewNavigation),pn;this.currentTransition=o,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:typeof c.extras.browserUrl=="string"?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?N(C({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let s=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),u=c.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!s&&u!=="reload"){let d="";return this.events.next(new Oi(c.id,this.urlSerializer.serialize(c.rawUrl),d,wh.IgnoredSameUrlNavigation)),c.resolve(!1),pn}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return K(c).pipe(on(d=>{let h=this.transitions?.getValue();return this.events.next(new ga(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),h!==this.transitions?.getValue()?pn:Promise.resolve(d)}),k3(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),_t(d=>{o.targetSnapshot=d.targetSnapshot,o.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation=N(C({},this.currentNavigation),{finalUrl:d.urlAfterRedirects});let h=new _h(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}));if(s&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:d,extractedUrl:h,source:f,restoredState:p,extras:g}=c,y=new ga(d,this.urlSerializer.serialize(h),f,p);this.events.next(y);let b=wS(this.rootComponentType).snapshot;return this.currentTransition=o=N(C({},c),{targetSnapshot:b,urlAfterRedirects:h,extras:N(C({},g),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=h,K(o)}else{let d="";return this.events.next(new Oi(c.id,this.urlSerializer.serialize(c.extractedUrl),d,wh.IgnoredByUrlHandlingStrategy)),c.resolve(!1),pn}}),_t(c=>{let s=new Dy(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(s)}),se(c=>(this.currentTransition=o=N(C({},c),{guards:t3(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),h3(this.environmentInjector,c=>this.events.next(c)),_t(c=>{if(o.guardsResult=c.guardsResult,c.guardsResult&&typeof c.guardsResult!="boolean")throw Dh(this.urlSerializer,c.guardsResult);let s=new Iy(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(s)}),Dt(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",_n.GuardRejected),!1)),_y(c=>{if(c.guards.canActivateChecks.length)return K(c).pipe(_t(s=>{let u=new Oy(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(u)}),on(s=>{let u=!1;return K(s).pipe(F3(this.paramsInheritanceStrategy,this.environmentInjector),_t({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(s,"",_n.NoDataFromResolver)}}))}),_t(s=>{let u=new Ay(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(u)}))}),_y(c=>{let s=u=>{let d=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(u.routeConfig).pipe(_t(h=>{u.component=h}),se(()=>{})));for(let h of u.children)d.push(...s(h));return d};return dl(s(c.targetSnapshot.root)).pipe(ui(null),Rr(1))}),_y(()=>this.afterPreactivation()),on(()=>{let{currentSnapshot:c,targetSnapshot:s}=o,u=this.createViewTransition?.(this.environmentInjector,c.root,s.root);return u?He(u).pipe(se(()=>o)):K(o)}),se(c=>{let s=K$(n.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=N(C({},c),{targetRouterState:s}),this.currentNavigation.targetRouterState=s,o}),_t(()=>{this.events.next(new Gl)}),e3(this.rootContexts,n.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Rr(1),_t({next:c=>{l=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Fn(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{l=!0}}),ng(this.transitionAbortSubject.pipe(_t(c=>{throw c}))),ao(()=>{!l&&!a&&this.cancelNavigationTransition(o,"",_n.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),ci(c=>{if(a=!0,CS(c))this.events.next(new Kr(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),J$(c)?this.events.next(new ma(c.url,c.navigationBehaviorOptions)):o.resolve(!1);else{let s=new Hl(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0);try{let u=an(this.environmentInjector,()=>this.navigationErrorHandler?.(s));if(u instanceof Wl){let{message:d,cancellationCode:h}=Dh(this.urlSerializer,u);this.events.next(new Kr(o.id,this.urlSerializer.serialize(o.extractedUrl),d,h)),this.events.next(new ma(u.redirectTo,u.navigationBehaviorOptions))}else throw this.events.next(s),c}catch(u){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(u)}}return pn}))}))}cancelNavigationTransition(n,r,i){let o=new Kr(n.id,this.urlSerializer.serialize(n.extractedUrl),r,i);this.events.next(o),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let n=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return n.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function q3(t){return t!==Vl}var Y3=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:()=>B(X3),providedIn:"root"})}return t})(),qy=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},X3=(()=>{class t extends qy{static \u0275fac=(()=>{let n;return function(i){return(n||(n=_i(t)))(i||t)}})();static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),FS=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:()=>B(K3),providedIn:"root"})}return t})(),K3=(()=>{class t extends FS{location=B(Di);urlSerializer=B(Zl);options=B(tc,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";urlHandlingStrategy=B(Qy);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Zr;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}routerState=wS(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(r=>{r.type==="popstate"&&n(r.url,r.state)})}handleRouterEvent(n,r){if(n instanceof ga)this.stateMemento=this.createStateMemento();else if(n instanceof Oi)this.rawUrlTree=r.initialUrl;else if(n instanceof _h){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else n instanceof Gl?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):n instanceof Kr&&(n.code===_n.GuardRejected||n.code===_n.NoDataFromResolver)?this.restoreHistory(r):n instanceof Hl?this.restoreHistory(r,!0):n instanceof Fn&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,r){let i=n instanceof Zr?this.urlSerializer.serialize(n):n;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let o=this.browserPageId,l=C(C({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(i,"",l)}else{let o=C(C({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",o)}}restoreHistory(n,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.currentUrlTree===n.finalUrl&&o===0&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,r){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}static \u0275fac=(()=>{let n;return function(i){return(n||(n=_i(t)))(i||t)}})();static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function LS(t,e){t.events.pipe(Dt(n=>n instanceof Fn||n instanceof Kr||n instanceof Hl||n instanceof Oi),se(n=>n instanceof Fn||n instanceof Oi?0:(n instanceof Kr?n.code===_n.Redirect||n.code===_n.SupersededByNewNavigation:!1)?2:1),Dt(n=>n!==2),Rr(1)).subscribe(()=>{e()})}var Z3={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Q3={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ln=(()=>{class t{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=B(Um);stateManager=B(FS);options=B(tc,{optional:!0})||{};pendingTasks=B(Ti);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=B(Jy);urlSerializer=B(Zl);location=B(Di);urlHandlingStrategy=B(Qy);_events=new yt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=B(Y3);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=B(Xl,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!B(Ah,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Qe;subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof Kr&&r.code!==_n.Redirect&&r.code!==_n.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Fn)this.navigated=!0;else if(r instanceof ma){let l=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=C({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||q3(i.source)},l);this.scheduleNavigation(a,Vl,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}e4(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Vl,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",r)},0)})}navigateToSyncWithBrowser(n,r,i){let o={replaceUrl:!0},l=i?.navigationId?i:null;if(i){let c=C({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let a=this.parseUrl(n);this.scheduleNavigation(a,r,l,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(Ky),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,r={}){let{relativeTo:i,queryParams:o,fragment:l,queryParamsHandling:a,preserveFragment:c}=r,s=c?this.currentUrlTree.fragment:l,u=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":u=C(C({},this.currentUrlTree.queryParams),o);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=o||null}u!==null&&(u=this.removeEmptyProps(u));let d;try{let h=i?i.snapshot:this.routerState.snapshot.root;d=mS(h)}catch{(typeof n[0]!="string"||n[0][0]!=="/")&&(n=[]),d=this.currentUrlTree.root}return yS(d,n,u,s??null)}navigateByUrl(n,r={skipLocationChange:!1}){let i=Co(n)?n:this.parseUrl(n),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,Vl,null,r)}navigate(n,r={skipLocationChange:!1}){return J3(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,r){let i;if(r===!0?i=C({},Z3):r===!1?i=C({},Q3):i=r,Co(n))return ZC(this.currentUrlTree,n,i);let o=this.parseUrl(n);return ZC(this.currentUrlTree,o,i)}removeEmptyProps(n){return Object.entries(n).reduce((r,[i,o])=>(o!=null&&(r[i]=o),r),{})}scheduleNavigation(n,r,i,o,l){if(this.disposed)return Promise.resolve(!1);let a,c,s;l?(a=l.resolve,c=l.reject,s=l.promise):s=new Promise((d,h)=>{a=d,c=h});let u=this.pendingTasks.add();return LS(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:o,resolve:a,reject:c,promise:s,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),s.catch(d=>Promise.reject(d))}static \u0275fac=function(r){return new(r||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function J3(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new W(4008,!1)}function e4(t){return!(t instanceof Gl)&&!(t instanceof ma)}var BS=(()=>{class t{router;route;tabIndexAttribute;renderer;el;locationStrategy;href=null;target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new yt;constructor(n,r,i,o,l,a){this.router=n,this.route=r,this.tabIndexAttribute=i,this.renderer=o,this.el=l,this.locationStrategy=a;let c=l.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area",this.isAnchorElement?this.subscription=n.events.subscribe(s=>{s instanceof Fn&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(n){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(n){n==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Co(n)?this.routerLinkInput=n:this.routerLinkInput=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0"))}onClick(n,r,i,o,l){let a=this.urlTree;if(a===null||this.isAnchorElement&&(n!==0||r||i||o||l||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,c),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let n=this.urlTree;this.href=n!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(n)):null;let r=this.href===null?null:wE(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(n,r){let i=this.renderer,o=this.el.nativeElement;r!==null?i.setAttribute(o,n,r):i.removeAttribute(o,n)}get urlTree(){return this.routerLinkInput===null?null:Co(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(r){return new(r||t)(te(Ln),te(Ai),ym("tabindex"),te(Ei),te(Hr),te(Yr))};static \u0275dir=Ot({type:t,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,i){r&1&&At("click",function(l){return i.onClick(l.button,l.ctrlKey,l.shiftKey,l.altKey,l.metaKey)}),r&2&&Dl("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",_o],skipLocationChange:[2,"skipLocationChange","skipLocationChange",_o],replaceUrl:[2,"replaceUrl","replaceUrl",_o],routerLink:"routerLink"},features:[$m,yo]})}return t})();var Oh=class{};var t4=(()=>{class t{router;injector;preloadingStrategy;loader;subscription;constructor(n,r,i,o,l){this.router=n,this.injector=i,this.preloadingStrategy=o,this.loader=l}setUpPreloading(){this.subscription=this.router.events.pipe(Dt(n=>n instanceof Fn),Nr(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,r){let i=[];for(let o of r){o.providers&&!o._injector&&(o._injector=Kd(o.providers,n,`Route: ${o.path}`));let l=o._injector??n,a=o._loadedInjector??l;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&i.push(this.preloadConfig(l,o)),(o.children||o._loadedRoutes)&&i.push(this.processRoutes(a,o.children??o._loadedRoutes))}return He(i).pipe(Cs())}preloadConfig(n,r){return this.preloadingStrategy.preload(r,()=>{let i;r.loadChildren&&r.canLoad===void 0?i=this.loader.loadChildren(n,r):i=K(null);let o=i.pipe(dt(l=>l===null?K(void 0):(r._loadedRoutes=l.routes,r._loadedInjector=l.injector,this.processRoutes(l.injector??n,l.routes))));if(r.loadComponent&&!r._loadedComponent){let l=this.loader.loadComponent(r);return He([o,l]).pipe(Cs())}else return o})}static \u0275fac=function(r){return new(r||t)(Y(Ln),Y(Jd),Y(Yt),Y(Oh),Y(Zy))};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),jS=new z(""),n4=(()=>{class t{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(n,r,i,o,l={}){this.urlSerializer=n,this.transitions=r,this.viewportScroller=i,this.zone=o,this.options=l,l.scrollPositionRestoration||="disabled",l.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof ga?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof Fn?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof Oi&&n.code===wh.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof Th&&(n.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(n.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Th(n,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(r){SE()};static \u0275prov=H({token:t,factory:t.\u0275fac})}return t})();function VS(t,...e){return Ys([{provide:Xl,multi:!0,useValue:t},[],{provide:Ai,useFactory:$S,deps:[Ln]},{provide:Sl,multi:!0,useFactory:US},e.map(n=>n.\u0275providers)])}function $S(t){return t.routerState.root}function nc(t,e){return{\u0275kind:t,\u0275providers:e}}function US(){let t=B(yn);return e=>{let n=t.get(jr);if(e!==n.components[0])return;let r=t.get(Ln),i=t.get(HS);t.get(ev)===1&&r.initialNavigation(),t.get(GS,null,ue.Optional)?.setUpPreloading(),t.get(jS,null,ue.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var HS=new z("",{factory:()=>new yt}),ev=new z("",{providedIn:"root",factory:()=>1});function r4(){return nc(2,[{provide:ev,useValue:0},{provide:Zd,multi:!0,deps:[yn],useFactory:e=>{let n=e.get(_C,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(Ln),o=e.get(HS);LS(i,()=>{r(!0)}),e.get(Jy).afterPreactivation=()=>(r(!0),o.closed?K(void 0):o),i.initialNavigation()}))}}])}function i4(){return nc(3,[{provide:Zd,multi:!0,useFactory:()=>{let e=B(Ln);return()=>{e.setUpLocationChangeListener()}}},{provide:ev,useValue:2}])}var GS=new z("");function o4(t){return nc(0,[{provide:GS,useExisting:t4},{provide:Oh,useExisting:t}])}function tv(){return nc(8,[tS,{provide:Ah,useExisting:tS}])}function s4(t){let e=[{provide:NS,useValue:z3},{provide:RS,useValue:C({skipNextTransition:!!t?.skipInitialTransition},t)}];return nc(9,e)}var a4=[Di,{provide:Zl,useClass:pa},Ln,Jl,{provide:Ai,useFactory:$S,deps:[Ln]},Zy,[]],Ph=(()=>{class t{constructor(){}static forRoot(n,r){return{ngModule:t,providers:[a4,[],{provide:Xl,multi:!0,useValue:n},[],r?.errorHandler?{provide:kS,useValue:r.errorHandler}:[],{provide:tc,useValue:r||{}},r?.useHash?c4():u4(),l4(),r?.preloadingStrategy?o4(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?d4(r):[],r?.bindToComponentInputs?tv().\u0275providers:[],r?.enableViewTransitions?s4().\u0275providers:[],h4()]}}static forChild(n){return{ngModule:t,providers:[{provide:Xl,multi:!0,useValue:n}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Gr({type:t});static \u0275inj=Vr({})}return t})();function l4(){return{provide:jS,useFactory:()=>{let t=B(SC),e=B(et),n=B(tc),r=B(Jy),i=B(Zl);return n.scrollOffset&&t.setOffset(n.scrollOffset),new n4(i,r,t,e,n)}}}function c4(){return{provide:Yr,useClass:xC}}function u4(){return{provide:Yr,useClass:oy}}function d4(t){return[t.initialNavigation==="disabled"?i4().\u0275providers:[],t.initialNavigation==="enabledBlocking"?r4().\u0275providers:[]]}var oS=new z("");function h4(){return[{provide:oS,useFactory:US},{provide:Sl,multi:!0,useExisting:oS}]}function E(t,e,n){return(e=function(r){var i=function(o,l){if(typeof o!="object"||!o)return o;var a=o[Symbol.toPrimitive];if(a!==void 0){var c=a.call(o,l||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(o)}(r,"string");return typeof i=="symbol"?i:i+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?zS(Object(n),!0).forEach(function(r){E(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Xe(t,e){if(t==null)return{};var n,r,i=function(l,a){if(l==null)return{};var c={};for(var s in l)if({}.hasOwnProperty.call(l,s)){if(a.indexOf(s)>=0)continue;c[s]=l[s]}return c}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function Ui(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var Uh=class{constructor(){E(this,"browserShadowBlurConstant",1),E(this,"DPI",96),E(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),E(this,"perfLimitSizeTotal",2097152),E(this,"maxCacheSideLimit",4096),E(this,"minCacheSideLimit",256),E(this,"disableStyleCopyPaste",!1),E(this,"enableGLFiltering",!0),E(this,"textureSize",4096),E(this,"forceGLPutImageData",!1),E(this,"cachesBoundsOfCurve",!1),E(this,"fontPaths",{}),E(this,"NUM_FRACTION_DIGITS",4)}},Ce=new class extends Uh{constructor(t){super(),this.configure(t)}configure(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,t)}addFonts(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=x(x({},this.fontPaths),t)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(t=>{delete this.fontPaths[t]})}clearFonts(){this.fontPaths={}}restoreDefaults(t){let e=new Uh,n=t?.reduce((r,i)=>(r[i]=e[i],r),{})||e;this.configure(n)}},Bi=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return console[t]("fabric",...n)},Un=class extends Error{constructor(e,n){super("fabric: ".concat(e),n)}},Hh=class extends Un{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}},gv=class{},mv=class extends gv{testPrecision(e,n){let r="precision ".concat(n,` float;
void main(){}`),i=e.createShader(e.FRAGMENT_SHADER);return!!i&&(e.shaderSource(i,r),e.compileShader(i),!!e.getShaderParameter(i,e.COMPILE_STATUS))}queryWebGL(e){let n=e.getContext("webgl");n&&(this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(r=>this.testPrecision(n,r)),n.getExtension("WEBGL_lose_context").loseContext(),Bi("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}},f4={},WS;var Cr=()=>WS||(WS={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new mv,dispose(){},copyPasteData:f4}),ka=()=>Cr().document,yf=()=>Cr().window,_D=()=>{var t;return Math.max((t=Ce.devicePixelRatio)!==null&&t!==void 0?t:yf().devicePixelRatio,1)},sc=new class{constructor(){E(this,"charWidthsCache",{}),E(this,"boundsOfCurveCache",{})}getFontCache(t){let{fontFamily:e,fontStyle:n,fontWeight:r}=t;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});let i=this.charWidthsCache[e],o="".concat(n.toLowerCase(),"_").concat((r+"").toLowerCase());return i[o]||(i[o]={}),i[o]}clearFontCache(t){(t=(t||"").toLowerCase())?this.charWidthsCache[t]&&delete this.charWidthsCache[t]:this.charWidthsCache={}}limitDimsByArea(t){let{perfLimitSizeTotal:e}=Ce,n=Math.sqrt(e*t);return[Math.floor(n),Math.floor(e/n)]}},yv="6.5.4";function Wo(){}var ji=Math.PI/2,ni=2*Math.PI,qv=Math.PI/180,Qt=Object.freeze([1,0,0,1,0,0]),Yv=16,Pi=.4477152502,le="center",Pe="left",ln="top",vv="bottom",lt="right",cn="none",Xv=/\r?\n/,TD="moving",vf="scaling",xD="rotating",Kv="rotate",ED="skewing",hc="resizing",CD="modifyPoly",p4="modifyPath",Gh="changed",bf="scale",Jt="scaleX",En="scaleY",Fa="skewX",La="skewY",bt="fill",un="stroke",zh="modified",ba="json",rv="svg",U=new class{constructor(){this[ba]=new Map,this[rv]=new Map}has(t){return this[ba].has(t)}getClass(t){let e=this[ba].get(t);if(!e)throw new Un("No class registered for ".concat(t));return e}setClass(t,e){e?this[ba].set(e,t):(this[ba].set(t.type,t),this[ba].set(t.type.toLowerCase(),t))}getSVGClass(t){return this[rv].get(t)}setSVGClass(t,e){this[rv].set(e??t.type.toLowerCase(),t)}},Wh=new class extends Array{remove(t){let e=this.indexOf(t);e>-1&&this.splice(e,1)}cancelAll(){let t=this.splice(0);return t.forEach(e=>e.abort()),t}cancelByCanvas(t){if(!t)return[];let e=this.filter(n=>{var r;return n.target===t||typeof n.target=="object"&&((r=n.target)===null||r===void 0?void 0:r.canvas)===t});return e.forEach(n=>n.abort()),e}cancelByTarget(t){if(!t)return[];let e=this.filter(n=>n.target===t);return e.forEach(n=>n.abort()),e}},bv=class{constructor(){E(this,"__eventListeners",{})}on(e,n){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(r=>{let[i,o]=r;this.on(i,o)}),()=>this.off(e);if(n){let r=e;return this.__eventListeners[r]||(this.__eventListeners[r]=[]),this.__eventListeners[r].push(n),()=>this.off(r,n)}return()=>!1}once(e,n){if(typeof e=="object"){let r=[];return Object.entries(e).forEach(i=>{let[o,l]=i;r.push(this.once(o,l))}),()=>r.forEach(i=>i())}if(n){let r=this.on(e,function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];n.call(this,...o),r()});return r}return()=>!1}_removeEventListener(e,n){if(this.__eventListeners[e])if(n){let r=this.__eventListeners[e],i=r.indexOf(n);i>-1&&r.splice(i,1)}else this.__eventListeners[e]=[]}off(e,n){if(this.__eventListeners)if(e===void 0)for(let r in this.__eventListeners)this._removeEventListener(r);else typeof e=="object"?Object.entries(e).forEach(r=>{let[i,o]=r;this._removeEventListener(i,o)}):this._removeEventListener(e,n)}fire(e,n){var r;if(!this.__eventListeners)return;let i=(r=this.__eventListeners[e])===null||r===void 0?void 0:r.concat();if(i)for(let o=0;o<i.length;o++)i[o].call(this,n||{})}},So=(t,e)=>{let n=t.indexOf(e);return n!==-1&&t.splice(n,1),t},ar=t=>{if(t===0)return 1;switch(Math.abs(t)/ji){case 1:case 3:return 0;case 2:return-1}return Math.cos(t)},lr=t=>{if(t===0)return 0;let e=t/ji,n=Math.sign(t);switch(e){case 1:return n;case 2:return 0;case 3:return-n}return Math.sin(t)},A=class t{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=n)}add(e){return new t(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new t(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new t(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new t(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new t(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new t(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new t(this.x/e.x,this.y/e.y)}scalarDivide(e){return new t(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return n=Math.max(Math.min(1,n),0),new t(this.x+(e.x-this.x)*n,this.y+(e.y-this.y)*n)}distanceFrom(e){let n=this.x-e.x,r=this.y-e.y;return Math.sqrt(n*n+r*r)}midPointFrom(e){return this.lerp(e)}min(e){return new t(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new t(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,n){return this.x=e,this.y=n,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){let n=this.x,r=this.y;this.x=e.x,this.y=e.y,e.x=n,e.y=r}clone(){return new t(this.x,this.y)}rotate(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Zv,r=lr(e),i=ar(e),o=this.subtract(n);return new t(o.x*i-o.y*r,o.x*r+o.y*i).add(n)}transform(e){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new t(e[0]*this.x+e[2]*this.y+(n?0:e[4]),e[1]*this.x+e[3]*this.y+(n?0:e[5]))}},Zv=new A(0,0),Vh=t=>!!t&&Array.isArray(t._objects);function SD(t){class e extends t{constructor(){super(...arguments),E(this,"_objects",[])}_onObjectAdded(r){}_onObjectRemoved(r){}_onStackOrderChanged(r){}add(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];let l=this._objects.push(...i);return i.forEach(a=>this._onObjectAdded(a)),l}insertAt(r){for(var i=arguments.length,o=new Array(i>1?i-1:0),l=1;l<i;l++)o[l-1]=arguments[l];return this._objects.splice(r,0,...o),o.forEach(a=>this._onObjectAdded(a)),this._objects.length}remove(){let r=this._objects,i=[];for(var o=arguments.length,l=new Array(o),a=0;a<o;a++)l[a]=arguments[a];return l.forEach(c=>{let s=r.indexOf(c);s!==-1&&(r.splice(s,1),i.push(c),this._onObjectRemoved(c))}),i}forEachObject(r){this.getObjects().forEach((i,o,l)=>r(i,o,l))}getObjects(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length===0?[...this._objects]:this._objects.filter(l=>l.isType(...i))}item(r){return this._objects[r]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(r,i){return!!this._objects.includes(r)||!!i&&this._objects.some(o=>o instanceof e&&o.contains(r,!0))}complexity(){return this._objects.reduce((r,i)=>r+=i.complexity?i.complexity():0,0)}sendObjectToBack(r){return!(!r||r===this._objects[0])&&(So(this._objects,r),this._objects.unshift(r),this._onStackOrderChanged(r),!0)}bringObjectToFront(r){return!(!r||r===this._objects[this._objects.length-1])&&(So(this._objects,r),this._objects.push(r),this._onStackOrderChanged(r),!0)}sendObjectBackwards(r,i){if(!r)return!1;let o=this._objects.indexOf(r);if(o!==0){let l=this.findNewLowerIndex(r,o,i);return So(this._objects,r),this._objects.splice(l,0,r),this._onStackOrderChanged(r),!0}return!1}bringObjectForward(r,i){if(!r)return!1;let o=this._objects.indexOf(r);if(o!==this._objects.length-1){let l=this.findNewUpperIndex(r,o,i);return So(this._objects,r),this._objects.splice(l,0,r),this._onStackOrderChanged(r),!0}return!1}moveObjectTo(r,i){return r!==this._objects[i]&&(So(this._objects,r),this._objects.splice(i,0,r),this._onStackOrderChanged(r),!0)}findNewLowerIndex(r,i,o){let l;if(o){l=i;for(let a=i-1;a>=0;--a)if(r.isOverlapping(this._objects[a])){l=a;break}}else l=i-1;return l}findNewUpperIndex(r,i,o){let l;if(o){l=i;for(let a=i+1;a<this._objects.length;++a)if(r.isOverlapping(this._objects[a])){l=a;break}}else l=i+1;return l}collectObjects(r){let{left:i,top:o,width:l,height:a}=r,{includeIntersecting:c=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=[],u=new A(i,o),d=u.add(new A(l,a));for(let h=this._objects.length-1;h>=0;h--){let f=this._objects[h];f.selectable&&f.visible&&(c&&f.intersectsWithRect(u,d)||f.isContainedWithinRect(u,d)||c&&f.containsPoint(u)||c&&f.containsPoint(d))&&s.push(f)}return s}}return e}var qh=class extends bv{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(let n in e)this.set(n,e[n])}_setObject(e){for(let n in e)this._set(n,e[n])}set(e,n){return typeof e=="object"?this._setObject(e):this._set(e,n),this}_set(e,n){this[e]=n}toggle(e){let n=this.get(e);return typeof n=="boolean"&&this.set(e,!n),this}get(e){return this[e]}};function ac(t){return yf().requestAnimationFrame(t)}function DD(t){return yf().cancelAnimationFrame(t)}var g4=0,Vi=()=>g4++,Hn=()=>{let t=ka().createElement("canvas");if(!t||t.getContext===void 0)throw new Un("Failed to create `canvas` element");return t},ID=()=>ka().createElement("img"),cr=t=>{let e=Hn();return e.width=t.width,e.height=t.height,e},Qv=(t,e,n)=>t.toDataURL("image/".concat(e),n),nt=t=>t*qv,$i=t=>t/qv,OD=t=>t.every((e,n)=>e===Qt[n]),jt=(t,e,n)=>new A(t).transform(e,n),xn=t=>{let e=1/(t[0]*t[3]-t[1]*t[2]),n=[e*t[3],-e*t[1],-e*t[2],e*t[0],0,0],{x:r,y:i}=new A(t[4],t[5]).transform(n,!0);return n[4]=-r,n[5]=-i,n},rt=(t,e,n)=>[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],n?0:t[0]*e[4]+t[2]*e[5]+t[4],n?0:t[1]*e[4]+t[3]*e[5]+t[5]],wf=(t,e)=>t.reduceRight((n,r)=>r&&n?rt(r,n,e):r||n,void 0)||Qt.concat(),AD=t=>{let[e,n]=t;return Math.atan2(n,e)},Aa=t=>{let e=AD(t),n=Math.pow(t[0],2)+Math.pow(t[1],2),r=Math.sqrt(n),i=(t[0]*t[3]-t[2]*t[1])/r,o=Math.atan2(t[0]*t[2]+t[1]*t[3],n);return{angle:$i(e),scaleX:r,scaleY:i,skewX:$i(o),skewY:0,translateX:t[4]||0,translateY:t[5]||0}},Ba=function(t){return[1,0,0,1,t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function ja(){let{angle:t=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:n=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=nt(t),i=ar(r),o=lr(r);return[i,o,-o,i,e?e-(i*e-o*n):0,n?n-(o*e+i*n):0]}var _f=function(t){return[t,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,0,0]},MD=t=>Math.tan(nt(t)),Jv=t=>[1,0,MD(t),1,0,0],eb=t=>[1,MD(t),0,1,0,0],bc=t=>{let{scaleX:e=1,scaleY:n=1,flipX:r=!1,flipY:i=!1,skewX:o=0,skewY:l=0}=t,a=_f(r?-e:e,i?-n:n);return o&&(a=rt(a,Jv(o),!0)),l&&(a=rt(a,eb(l),!0)),a},PD=t=>{let{translateX:e=0,translateY:n=0,angle:r=0}=t,i=Ba(e,n);r&&(i=rt(i,ja({angle:r})));let o=bc(t);return OD(o)||(i=rt(i,o)),i},lc=function(t){let{signal:e,crossOrigin:n=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(r,i){if(e&&e.aborted)return i(new Hh("loadImage"));let o=ID(),l;e&&(l=function(c){o.src="",i(c)},e.addEventListener("abort",l,{once:!0}));let a=function(){o.onload=o.onerror=null,l&&e?.removeEventListener("abort",l),r(o)};t?(o.onload=a,o.onerror=function(){l&&e?.removeEventListener("abort",l),i(new Un("Error loading ".concat(o.src)))},n&&(o.crossOrigin=n),o.src=t):a()})},Ma=function(t){let{signal:e,reviver:n=Wo}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((r,i)=>{let o=[];e&&e.addEventListener("abort",i,{once:!0}),Promise.all(t.map(l=>U.getClass(l.type).fromObject(l,{signal:e}).then(a=>(n(l,a),o.push(a),a)))).then(r).catch(l=>{o.forEach(a=>{a.dispose&&a.dispose()}),i(l)}).finally(()=>{e&&e.removeEventListener("abort",i)})})},wc=function(t){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((n,r)=>{let i=[];e&&e.addEventListener("abort",r,{once:!0});let o=Object.values(t).map(a=>a&&a.type&&U.has(a.type)?Ma([a],{signal:e}).then(c=>{let[s]=c;return i.push(s),s}):a),l=Object.keys(t);Promise.all(o).then(a=>a.reduce((c,s,u)=>(c[l[u]]=s,c),{})).then(n).catch(a=>{i.forEach(c=>{c.dispose&&c.dispose()}),r(a)}).finally(()=>{e&&e.removeEventListener("abort",r)})})},Qo=function(t){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,n)=>(n in t&&(e[n]=t[n]),e),{})},tb=(t,e)=>Object.keys(t).reduce((n,r)=>(e(t[r],r,t)&&(n[r]=t[r]),n),{}),qS={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},iv=(t,e,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t),YS=(t,e,n,r)=>{t/=255,e/=255,n/=255;let i=Math.max(t,e,n),o=Math.min(t,e,n),l,a,c=(i+o)/2;if(i===o)l=a=0;else{let s=i-o;switch(a=c>.5?s/(2-i-o):s/(i+o),i){case t:l=(e-n)/s+(e<n?6:0);break;case e:l=(n-t)/s+2;break;case n:l=(t-e)/s+4}l/=6}return[Math.round(360*l),Math.round(100*a),Math.round(100*c),r]},XS=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(t)/(t.endsWith("%")?100:1)},Nh=t=>Math.min(Math.round(t),255).toString(16).toUpperCase().padStart(2,"0"),KS=t=>{let[e,n,r,i=1]=t,o=Math.round(.3*e+.59*n+.11*r);return[o,o,o,i]},en=class t{constructor(e){if(E(this,"isUnrecognised",!1),e)if(e instanceof t)this.setSource([...e._source]);else if(Array.isArray(e)){let[n,r,i,o=1]=e;this.setSource([n,r,i,o])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in qS&&(e=qS[e]),e==="transparent"?[255,255,255,0]:t.sourceFromHex(e)||t.sourceFromRgb(e)||t.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){let[e,n,r]=this.getSource();return"rgb(".concat(e,",").concat(n,",").concat(r,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){let[e,n,r]=YS(...this.getSource());return"hsl(".concat(e,",").concat(n,"%,").concat(r,"%)")}toHsla(){let[e,n,r,i]=YS(...this.getSource());return"hsla(".concat(e,",").concat(n,"%,").concat(r,"%,").concat(i,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){let[e,n,r,i]=this.getSource();return"".concat(Nh(e)).concat(Nh(n)).concat(Nh(r)).concat(Nh(Math.round(255*i)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(KS(this.getSource())),this}toBlackWhite(e){let[n,,,r]=KS(this.getSource()),i=n<(e||127)?0:255;return this.setSource([i,i,i,r]),this}overlayWith(e){e instanceof t||(e=new t(e));let n=this.getSource(),r=e.getSource(),[i,o,l]=n.map((a,c)=>Math.round(.5*a+.5*r[c]));return this.setSource([i,o,l,n[3]]),this}static fromRgb(e){return t.fromRgba(e)}static fromRgba(e){return new t(t.sourceFromRgb(e))}static sourceFromRgb(e){let n=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(n){let[r,i,o]=n.slice(1,4).map(l=>{let a=parseFloat(l);return l.endsWith("%")?Math.round(2.55*a):a});return[r,i,o,XS(n[4])]}}static fromHsl(e){return t.fromHsla(e)}static fromHsla(e){return new t(t.sourceFromHsl(e))}static sourceFromHsl(e){let n=e.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!n)return;let r=(t.parseAngletoDegrees(n[1])%360+360)%360/360,i=parseFloat(n[2])/100,o=parseFloat(n[3])/100,l,a,c;if(i===0)l=a=c=o;else{let s=o<=.5?o*(i+1):o+i-o*i,u=2*o-s;l=iv(u,s,r+1/3),a=iv(u,s,r),c=iv(u,s,r-1/3)}return[Math.round(255*l),Math.round(255*a),Math.round(255*c),XS(n[4])]}static fromHex(e){return new t(t.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){let n=e.slice(e.indexOf("#")+1),r;r=n.length<=4?n.split("").map(c=>c+c):n.match(/.{2}/g);let[i,o,l,a=255]=r.map(c=>parseInt(c,16));return[i,o,l,a/255]}}static parseAngletoDegrees(e){let n=e.toLowerCase(),r=parseFloat(n);return n.includes("rad")?$i(r):n.includes("turn")?360*r:r}},Ye=(t,e)=>parseFloat(Number(t).toFixed(e)),qo=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yv,n=/\D{0,2}$/.exec(t),r=parseFloat(t),i=Ce.DPI;switch(n?.[0]){case"mm":return r*i/25.4;case"cm":return r*i/2.54;case"in":return r*i;case"pt":return r*i/72;case"pc":return r*i/72*12;case"em":return r*e;default:return r}},ND=t=>{let[e,n]=t.trim().split(" "),[r,i]=(o=e)&&o!==cn?[o.slice(1,4),o.slice(5,8)]:o===cn?[o,o]:["Mid","Mid"];var o;return{meetOrSlice:n||"meet",alignX:r,alignY:i}},fc=t=>"matrix("+t.map(e=>Ye(e,Ce.NUM_FRACTION_DIGITS)).join(" ")+")",pc=function(t,e){let n,r,i=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)n="url(#SVGID_".concat(e.id,")");else{let o=new en(e),l=o.getAlpha();n=o.toRgb(),l!==1&&(r=l.toString())}else n="none";return i?"".concat(t,": ").concat(n,"; ").concat(r?"".concat(t,"-opacity: ").concat(r,"; "):""):"".concat(t,'="').concat(n,'" ').concat(r?"".concat(t,'-opacity="').concat(r,'" '):"")},$n=t=>!!t&&t.toLive!==void 0,ZS=t=>!!t&&typeof t.toObject=="function",QS=t=>!!t&&t.offsetX!==void 0&&"source"in t,Do=t=>!!t&&"multiSelectionStacking"in t;function RD(t){let e=t&&ir(t),n=0,r=0;if(!t||!e)return{left:n,top:r};let i=t,o=e.documentElement,l=e.body||{scrollLeft:0,scrollTop:0};for(;i&&(i.parentNode||i.host)&&(i=i.parentNode||i.host,i===e?(n=l.scrollLeft||o.scrollLeft||0,r=l.scrollTop||o.scrollTop||0):(n+=i.scrollLeft||0,r+=i.scrollTop||0),i.nodeType!==1||i.style.position!=="fixed"););return{left:n,top:r}}var ir=t=>t.ownerDocument||null,kD=t=>{var e;return((e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},FD=function(t,e,n){let{width:r,height:i}=n,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;t.width=r,t.height=i,o>1&&(t.setAttribute("width",(r*o).toString()),t.setAttribute("height",(i*o).toString()),e.scale(o,o))},wv=(t,e)=>{let{width:n,height:r}=e;n&&(t.style.width=typeof n=="number"?"".concat(n,"px"):n),r&&(t.style.height=typeof r=="number"?"".concat(r,"px"):r)};function JS(t){return t.onselectstart!==void 0&&(t.onselectstart=()=>!1),t.style.userSelect=cn,t}var Yh=class{constructor(e){E(this,"_originalCanvasStyle",void 0),E(this,"lower",void 0);let n=this.createLowerCanvas(e);this.lower={el:n,ctx:n.getContext("2d")}}createLowerCanvas(e){let n=(r=e)&&r.getContext!==void 0?e:e&&ka().getElementById(e)||Hn();var r;if(n.hasAttribute("data-fabric"))throw new Un("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=n.style.cssText,n.setAttribute("data-fabric","main"),n.classList.add("lower-canvas"),n}cleanupDOM(e){let{width:n,height:r}=e,{el:i}=this.lower;i.classList.remove("lower-canvas"),i.removeAttribute("data-fabric"),i.setAttribute("width","".concat(n)),i.setAttribute("height","".concat(r)),i.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,n){let{el:r,ctx:i}=this.lower;FD(r,i,e,n)}setCSSDimensions(e){wv(this.lower.el,e)}calcOffset(){return function(e){var n;let r=e&&ir(e),i={left:0,top:0};if(!r)return i;let o=((n=kD(e))===null||n===void 0?void 0:n.getComputedStyle(e,null))||{};i.left+=parseInt(o.borderLeftWidth,10)||0,i.top+=parseInt(o.borderTopWidth,10)||0,i.left+=parseInt(o.paddingLeft,10)||0,i.top+=parseInt(o.paddingTop,10)||0;let l={left:0,top:0},a=r.documentElement;e.getBoundingClientRect!==void 0&&(l=e.getBoundingClientRect());let c=RD(e);return{left:l.left+c.left-(a.clientLeft||0)+i.left,top:l.top+c.top-(a.clientTop||0)+i.top}}(this.lower.el)}dispose(){Cr().dispose(this.lower.el),delete this.lower}},m4={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...Qt]},gc=class t extends SD(qh){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return t.ownDefaults}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(n),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new Yh(e)}add(){let e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];let o=super.insertAt(e,...r);return r.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),o}remove(){let e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(Bi("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?_D():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,n){return this.setDimensions({width:e},n)}setHeight(e,n){return this.setDimensions({height:e},n)}_setDimensionsImpl(e){let{cssOnly:n=!1,backstoreOnly:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!n){let i=x({width:this.width,height:this.height},e);this.elements.setDimensions(i,this.getRetinaScaling()),this.hasLostContext=!0,this.width=i.width,this.height=i.height}r||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,n){this._setDimensionsImpl(e,n),n&&n.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,n){let r=e,i=[...this.viewportTransform],o=jt(e,xn(i));i[0]=n,i[3]=n;let l=jt(o,i);i[4]+=r.x-l.x,i[5]+=r.y-l.y,this.setViewportTransform(i)}setZoom(e){this.zoomToPoint(new A(0,0),e)}absolutePan(e){let n=[...this.viewportTransform];return n[4]=-e.x,n[5]=-e.y,this.setViewportTransform(n)}relativePan(e){return this.absolutePan(new A(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=ac(()=>this.renderAndReset()))}calcViewportBoundaries(){let e=this.width,n=this.height,r=xn(this.viewportTransform),i=jt({x:0,y:0},r),o=jt({x:e,y:n},r),l=i.min(o),a=i.max(o);return this.vptCoords={tl:l,tr:new A(a.x,l.y),bl:new A(l.x,a.y),br:a}}cancelRequestedRender(){this.nextRenderHandle&&(DD(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,n){if(this.destroyed)return;let r=this.viewportTransform,i=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._renderObjects(e,n),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),i&&(i._set("canvas",this),i.shouldCache(),i._transformDone=!0,i.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,i)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,n){let r=this.viewportTransform;e.save(),e.transform(...r),e.globalCompositeOperation="destination-in",n.transform(e),e.scale(1/n.zoomX,1/n.zoomY),e.drawImage(n._cacheCanvas,-n.cacheTranslationX,-n.cacheTranslationY),e.restore()}_renderObjects(e,n){for(let r=0,i=n.length;r<i;++r)n[r]&&n[r].render(e)}_renderBackgroundOrOverlay(e,n){let r=this["".concat(n,"Color")],i=this["".concat(n,"Image")],o=this.viewportTransform,l=this["".concat(n,"Vpt")];if(!r&&!i)return;let a=$n(r);if(r){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=a?r.toLive(e):r,l&&e.transform(...o),a){e.transform(1,0,0,1,r.offsetX||0,r.offsetY||0);let c=r.gradientTransform||r.patternTransform;c&&e.transform(...c)}e.fill(),e.restore()}if(i){e.save();let{skipOffscreen:c}=this;this.skipOffscreen=l,l&&e.transform(...o),i.render(e),this.skipOffscreen=c,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new A(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new A(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new A(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new A(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new A(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return jt(this.getCenterPoint(),xn(this.viewportTransform))}_centerObject(e,n){e.setXY(n,le,le),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,n){let r=this.clipPath,i=r&&!r.excludeFromExport?this._toObject(r,e,n):null;return x(x(x({version:yv},Qo(this,n)),{},{objects:this._objects.filter(o=>!o.excludeFromExport).map(o=>this._toObject(o,e,n))},this.__serializeBgOverlay(e,n)),i?{clipPath:i}:null)}_toObject(e,n,r){let i;this.includeDefaultValues||(i=e.includeDefaultValues,e.includeDefaultValues=!1);let o=e[n](r);return this.includeDefaultValues||(e.includeDefaultValues=!!i),o}__serializeBgOverlay(e,n){let r={},i=this.backgroundImage,o=this.overlayImage,l=this.backgroundColor,a=this.overlayColor;return $n(l)?l.excludeFromExport||(r.background=l.toObject(n)):l&&(r.background=l),$n(a)?a.excludeFromExport||(r.overlay=a.toObject(n)):a&&(r.overlay=a),i&&!i.excludeFromExport&&(r.backgroundImage=this._toObject(i,e,n)),o&&!o.excludeFromExport&&(r.overlayImage=this._toObject(o,e,n)),r}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;e.reviver=n;let r=[];return this._setSVGPreamble(r,e),this._setSVGHeader(r,e),this.clipPath&&r.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(r,"background"),this._setSVGBgOverlayImage(r,"backgroundImage",n),this._setSVGObjects(r,n),this.clipPath&&r.push(`</g>
`),this._setSVGBgOverlayColor(r,"overlay"),this._setSVGBgOverlayImage(r,"overlayImage",n),r.push("</svg>"),r.join("")}_setSVGPreamble(e,n){n.suppressPreamble||e.push('<?xml version="1.0" encoding="',n.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,n){let r=n.width||"".concat(this.width),i=n.height||"".concat(this.height),o=Ce.NUM_FRACTION_DIGITS,l=n.viewBox,a;if(l)a='viewBox="'.concat(l.x," ").concat(l.y," ").concat(l.width," ").concat(l.height,'" ');else if(this.svgViewportTransformation){let c=this.viewportTransform;a='viewBox="'.concat(Ye(-c[4]/c[0],o)," ").concat(Ye(-c[5]/c[3],o)," ").concat(Ye(this.width/c[0],o)," ").concat(Ye(this.height/c[3],o),'" ')}else a='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',r,'" ','height="',i,'" ',a,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",yv,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(n),`</defs>
`)}createSVGClipPathMarkup(e){let n=this.clipPath;return n?(n.clipPathId="CLIPPATH_".concat(Vi()),'<clipPath id="'.concat(n.clipPathId,`" >
`).concat(n.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{let n=this["".concat(e,"Color")];if($n(n)){let r=this["".concat(e,"Vpt")],i=this.viewportTransform,o={isType:()=>!1,width:this.width/(r?i[0]:1),height:this.height/(r?i[3]:1)};return n.toSVG(o,{additionalTransform:r?fc(i):""})}}).join("")}createSVGFontFacesMarkup(){let e=[],n={},r=Ce.fontPaths;this._objects.forEach(function o(l){e.push(l),Vh(l)&&l._objects.forEach(o)}),e.forEach(o=>{if(!(l=o)||typeof l._renderText!="function")return;var l;let{styles:a,fontFamily:c}=o;!n[c]&&r[c]&&(n[c]=!0,a&&Object.values(a).forEach(s=>{Object.values(s).forEach(u=>{let{fontFamily:d=""}=u;!n[d]&&r[d]&&(n[d]=!0)})}))});let i=Object.keys(n).map(o=>`		@font-face {
			font-family: '`.concat(o,`';
			src: url('`).concat(r[o],`');
		}
`)).join("");return i?`	<style type="text/css"><![CDATA[
`.concat(i,`]]></style>
`):""}_setSVGObjects(e,n){this.forEachObject(r=>{r.excludeFromExport||this._setSVGObject(e,r,n)})}_setSVGObject(e,n,r){e.push(n.toSVG(r))}_setSVGBgOverlayImage(e,n,r){let i=this[n];i&&!i.excludeFromExport&&i.toSVG&&e.push(i.toSVG(r))}_setSVGBgOverlayColor(e,n){let r=this["".concat(n,"Color")];if(r)if($n(r)){let i=r.repeat||"",o=this.width,l=this.height,a=this["".concat(n,"Vpt")]?fc(xn(this.viewportTransform)):"";e.push('<rect transform="'.concat(a," translate(").concat(o/2,",").concat(l/2,')" x="').concat(r.offsetX-o/2,'" y="').concat(r.offsetY-l/2,'" width="').concat(i!=="repeat-y"&&i!=="no-repeat"||!QS(r)?o:r.source.width,'" height="').concat(i!=="repeat-x"&&i!=="no-repeat"||!QS(r)?l:r.source.height,'" fill="url(#SVGID_').concat(r.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',r,'"',`></rect>
`)}loadFromJSON(e,n){let{signal:r}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new Un("`json` is undefined"));let i=typeof e=="string"?JSON.parse(e):e,{objects:o=[],backgroundImage:l,background:a,overlayImage:c,overlay:s,clipPath:u}=i,d=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Ma(o,{reviver:n,signal:r}),wc({backgroundImage:l,backgroundColor:a,overlayImage:c,overlayColor:s,clipPath:u},{signal:r})]).then(h=>{let[f,p]=h;return this.clear(),this.add(...f),this.set(i),this.set(p),this.renderOnAddRemove=d,this})}clone(e){let n=this.toObject(e);return this.cloneWithoutData().loadFromJSON(n)}cloneWithoutData(){let e=cr(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{format:n="png",quality:r=1,multiplier:i=1,enableRetinaScaling:o=!1}=e,l=i*(o?this.getRetinaScaling():1);return Qv(this.toCanvasElement(l,e),n,r)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:n,height:r,left:i,top:o,filter:l}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=(n||this.width)*e,c=(r||this.height)*e,s=this.getZoom(),u=this.width,d=this.height,h=this.skipControlsDrawing,f=s*e,p=this.viewportTransform,g=[f,0,0,f,(p[4]-(i||0))*e,(p[5]-(o||0))*e],y=this.enableRetinaScaling,b=cr({width:a,height:c}),v=l?this._objects.filter(_=>l(_)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=g,this.width=a,this.height=c,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(b.getContext("2d"),v),this.viewportTransform=p,this.width=u,this.height=d,this.calcViewportBoundaries(),this.enableRetinaScaling=y,this.skipControlsDrawing=h,b}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),Wh.cancelByCanvas(this),this.disposed=!0,new Promise((e,n)=>{let r=()=>{this.destroy(),e(!0)};r.kill=n,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=r:r()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}};E(gc,"ownDefaults",m4);var y4=["touchstart","touchmove","touchend"],LD=t=>{let e=RD(t.target),n=function(r){let i=r.changedTouches;return i&&i[0]?i[0]:r}(t);return new A(n.clientX+e.left,n.clientY+e.top)},Xh=t=>y4.includes(t.type)||t.pointerType==="touch",_v=t=>{t.preventDefault(),t.stopPropagation()},Er=t=>{let e=0,n=0,r=0,i=0;for(let o=0,l=t.length;o<l;o++){let{x:a,y:c}=t[o];(a>r||!o)&&(r=a),(a<e||!o)&&(e=a),(c>i||!o)&&(i=c),(c<n||!o)&&(n=c)}return{left:e,top:n,width:r-e,height:i-n}},v4=["translateX","translateY","scaleX","scaleY"],BD=(t,e)=>Pa(t,rt(e,t.calcOwnMatrix())),Pa=(t,e)=>{let n=Aa(e),{translateX:r,translateY:i,scaleX:o,scaleY:l}=n,a=Xe(n,v4),c=new A(r,i);t.flipX=!1,t.flipY=!1,Object.assign(t,a),t.set({scaleX:o,scaleY:l}),t.setPositionByOrigin(c,le,le)},jD=t=>{t.scaleX=1,t.scaleY=1,t.skewX=0,t.skewY=0,t.flipX=!1,t.flipY=!1,t.rotate(0)},nb=t=>({scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,angle:t.angle,left:t.left,flipX:t.flipX,flipY:t.flipY,top:t.top}),Tf=(t,e,n)=>{let r=t/2,i=e/2,o=[new A(-r,-i),new A(r,-i),new A(-r,i),new A(r,i)].map(a=>a.transform(n)),l=Er(o);return new A(l.width,l.height)},_c=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Qt;return rt(xn(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qt),t)},ti=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qt,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Qt;return t.transform(_c(e,n))},VD=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qt,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Qt;return t.transform(_c(e,n),!0)},Tv=(t,e,n)=>{let r=_c(e,n);return Pa(t,rt(r,t.calcOwnMatrix())),r},rb=(t,e)=>{var n;let{transform:{target:r}}=e;(n=r.canvas)===null||n===void 0||n.fire("object:".concat(t),x(x({},e),{},{target:r})),r.fire(t,e)},b4={left:-.5,top:-.5,center:0,bottom:.5,right:.5},ft=t=>typeof t=="string"?b4[t]:t-.5,Kh="not-allowed";function $D(t){return ft(t.originX)===ft(le)&&ft(t.originY)===ft(le)}function eD(t){return .5-ft(t)}var sr=(t,e)=>t[e],ib=(t,e,n,r)=>({e:t,transform:e,pointer:new A(n,r)});function UD(t,e){let n=t.getTotalAngle()+$i(Math.atan2(e.y,e.x))+360;return Math.round(n%360/45)}function xf(t,e,n,r,i){var o;let{target:l,corner:a}=t,c=l.controls[a],s=((o=l.canvas)===null||o===void 0?void 0:o.getZoom())||1,u=l.padding/s,d=function(h,f,p,g){let y=h.getRelativeCenterPoint(),b=p!==void 0&&g!==void 0?h.translateToGivenOrigin(y,le,le,p,g):new A(h.left,h.top);return(h.angle?f.rotate(-nt(h.angle),y):f).subtract(b)}(l,new A(r,i),e,n);return d.x>=u&&(d.x-=u),d.x<=-u&&(d.x+=u),d.y>=u&&(d.y-=u),d.y<=u&&(d.y+=u),d.x-=c.offsetX,d.y-=c.offsetY,d}var HD=(t,e,n,r)=>{let{target:i,offsetX:o,offsetY:l}=e,a=n-o,c=r-l,s=!sr(i,"lockMovementX")&&i.left!==a,u=!sr(i,"lockMovementY")&&i.top!==c;return s&&i.set(Pe,a),u&&i.set(ln,c),(s||u)&&rb(TD,ib(t,e,n,r)),s||u},Zh=class{getSvgStyles(e){let n=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",i=this.strokeDashArray?this.strokeDashArray.join(" "):cn,o=this.strokeDashOffset?this.strokeDashOffset:"0",l=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",c=this.strokeMiterLimit?this.strokeMiterLimit:"4",s=this.opacity!==void 0?this.opacity:"1",u=this.visible?"":" visibility: hidden;",d=e?"":this.getSvgFilter(),h=pc(bt,this.fill);return[pc(un,this.stroke),"stroke-width: ",r,"; ","stroke-dasharray: ",i,"; ","stroke-linecap: ",l,"; ","stroke-dashoffset: ",o,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",c,"; ",h,"fill-rule: ",n,"; ","opacity: ",s,";",d,u].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=e?this.calcTransformMatrix():this.calcOwnMatrix(),i='transform="'.concat(fc(r));return"".concat(i).concat(n,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:n,additionalTransform:r=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=[this.getSvgTransform(!0,r),this.getSvgCommons()].join(""),o=e.indexOf("COMMON_PARTS");return e[o]=i,n?n(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:n,reviver:r,withShadow:i,additionalTransform:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=n?"":'style="'.concat(this.getSvgStyles(),'" '),a=i?'style="'.concat(this.getSvgFilter(),'" '):"",c=this.clipPath,s=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=c&&c.absolutePositioned,d=this.stroke,h=this.fill,f=this.shadow,p=[],g=e.indexOf("COMMON_PARTS"),y;c&&(c.clipPathId="CLIPPATH_".concat(Vi()),y='<clipPath id="'.concat(c.clipPathId,`" >
`).concat(c.toClipPathSVG(r),`</clipPath>
`)),u&&p.push("<g ",a,this.getSvgCommons(),` >
`),p.push("<g ",this.getSvgTransform(!1),u?"":a+this.getSvgCommons(),` >
`);let b=[l,s,n?"":this.addPaintOrder()," ",o?'transform="'.concat(o,'" '):""].join("");return e[g]=b,$n(h)&&p.push(h.toSVG(this)),$n(d)&&p.push(d.toSVG(this)),f&&p.push(f.toSVG(this)),c&&p.push(y),p.push(e.join("")),p.push(`</g>
`),u&&p.push(`</g>
`),r?r(p.join("")):p.join("")}addPaintOrder(){return this.paintFirst!==bt?' paint-order="'.concat(this.paintFirst,'" '):""}};function Ef(t){return new RegExp("^("+t.join("|")+")\\b","i")}var tD,or=String.raw(tD||(tD=Ui(["(?:[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?)"],["(?:[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?)"])));var w4=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+or+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+or+"))?\\s+(.*)"),_4={cx:Pe,x:Pe,r:"radius",cy:ln,y:ln,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},ov="font-size",sv="clip-path",vQ=Ef(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),bQ=Ef(["symbol","image","marker","pattern","view","svg"]),nD=Ef(["symbol","g","a","svg","clipPath","defs"]),wQ=new RegExp("^\\s*("+or+"+)\\s*,?\\s*("+or+"+)\\s*,?\\s*("+or+"+)\\s*,?\\s*("+or+"+)\\s*$"),T4=new A(1,0),GD=new A,ob=(t,e)=>t.rotate(e),Qh=(t,e)=>new A(e).subtract(t),Jh=t=>t.distanceFrom(GD),ef=(t,e)=>Math.atan2(Ia(t,e),WD(t,e)),zD=t=>ef(T4,t),Cf=t=>t.eq(GD)?t:t.scalarDivide(Jh(t)),sb=function(t){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return Cf(new A(-t.y,t.x).scalarMultiply(e?1:-1))},Ia=(t,e)=>t.x*e.y-t.y*e.x,WD=(t,e)=>t.x*e.x+t.y*e.y,xv=(t,e,n)=>{if(t.eq(e)||t.eq(n))return!0;let r=Ia(e,n),i=Ia(e,t),o=Ia(n,t);return r>=0?i>=0&&o<=0:!(i<=0&&o>=0)},rD="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",iD=new RegExp("(?:\\s|^)"+rD+rD+"("+or+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)"),Yo=class t{constructor(e){let n=typeof e=="string"?t.parseShadow(e):e;Object.assign(this,t.ownDefaults,n),this.id=Vi()}static parseShadow(e){let n=e.trim(),[,r=0,i=0,o=0]=(iD.exec(n)||[]).map(l=>parseFloat(l)||0);return{color:(n.replace(iD,"")||"rgb(0,0,0)").trim(),offsetX:r,offsetY:i,blur:o}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){let n=ob(new A(this.offsetX,this.offsetY),nt(-e.angle)),r=new en(this.color),i=40,o=40;return e.width&&e.height&&(i=100*Ye((Math.abs(n.x)+this.blur)/e.width,Ce.NUM_FRACTION_DIGITS)+20,o=100*Ye((Math.abs(n.y)+this.blur)/e.height,Ce.NUM_FRACTION_DIGITS)+20),e.flipX&&(n.x*=-1),e.flipY&&(n.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(o,'%" height="').concat(100+2*o,'%" x="-').concat(i,'%" width="').concat(100+2*i,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(Ye(this.blur?this.blur/2:0,Ce.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(Ye(n.x,Ce.NUM_FRACTION_DIGITS),'" dy="').concat(Ye(n.y,Ce.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(r.toRgb(),'" flood-opacity="').concat(r.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){let e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},n=t.ownDefaults;return this.includeDefaultValues?e:tb(e,(r,i)=>r!==n[i])}static fromObject(e){return R(this,null,function*(){return new this(e)})}};E(Yo,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),E(Yo,"type","shadow"),U.setClass(Yo,"shadow");var Ko=(t,e,n)=>Math.max(t,Math.min(e,n)),x4=[ln,Pe,Jt,En,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",Fa,La],ri=[bt,un,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],E4={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:Pe,originY:ln,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:bt,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},av=(t,e,n,r)=>(t<Math.abs(e)?(t=e,r=n/4):r=e===0&&t===0?n/ni*Math.asin(1):n/ni*Math.asin(e/t),{a:t,c:e,p:n,s:r}),oD=(t,e,n,r,i)=>t*Math.pow(2,10*(r-=1))*Math.sin((r*i-e)*ni/n),qD=(t,e,n,r)=>-n*Math.cos(t/r*ji)+n+e,Ev=(t,e,n,r)=>(t/=r)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e,sD=(t,e,n,r)=>n-Ev(r-t,0,n,r)+e,C4=Object.freeze({__proto__:null,defaultEasing:qD,easeInBack:function(t,e,n,r){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return n*(t/=r)*t*((i+1)*t-i)+e},easeInBounce:sD,easeInCirc:(t,e,n,r)=>-n*(Math.sqrt(1-(t/=r)*t)-1)+e,easeInCubic:(t,e,n,r)=>n*(t/r)**3+e,easeInElastic:(t,e,n,r)=>{let i=n,o=0;if(t===0)return e;if((t/=r)===1)return e+n;o||(o=.3*r);let{a:l,s:a,p:c}=av(i,n,o,1.70158);return-oD(l,a,c,t,r)+e},easeInExpo:(t,e,n,r)=>t===0?e:n*2**(10*(t/r-1))+e,easeInOutBack:function(t,e,n,r){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(t/=r/2)<1?n/2*(t*t*((1+(i*=1.525))*t-i))+e:n/2*((t-=2)*t*((1+(i*=1.525))*t+i)+2)+e},easeInOutBounce:(t,e,n,r)=>t<r/2?.5*sD(2*t,0,n,r)+e:.5*Ev(2*t-r,0,n,r)+.5*n+e,easeInOutCirc:(t,e,n,r)=>(t/=r/2)<1?-n/2*(Math.sqrt(1-t**2)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e,easeInOutCubic:(t,e,n,r)=>(t/=r/2)<1?n/2*t**3+e:n/2*((t-2)**3+2)+e,easeInOutElastic:(t,e,n,r)=>{let i=n,o=0;if(t===0)return e;if((t/=r/2)===2)return e+n;o||(o=r*(.3*1.5));let{a:l,s:a,p:c,c:s}=av(i,n,o,1.70158);return t<1?-.5*oD(l,a,c,t,r)+e:l*Math.pow(2,-10*(t-=1))*Math.sin((t*r-a)*ni/c)*.5+s+e},easeInOutExpo:(t,e,n,r)=>t===0?e:t===r?e+n:(t/=r/2)<1?n/2*2**(10*(t-1))+e:n/2*-(2**(-10*--t)+2)+e,easeInOutQuad:(t,e,n,r)=>(t/=r/2)<1?n/2*t**2+e:-n/2*(--t*(t-2)-1)+e,easeInOutQuart:(t,e,n,r)=>(t/=r/2)<1?n/2*t**4+e:-n/2*((t-=2)*t**3-2)+e,easeInOutQuint:(t,e,n,r)=>(t/=r/2)<1?n/2*t**5+e:n/2*((t-2)**5+2)+e,easeInOutSine:(t,e,n,r)=>-n/2*(Math.cos(Math.PI*t/r)-1)+e,easeInQuad:(t,e,n,r)=>n*(t/=r)*t+e,easeInQuart:(t,e,n,r)=>n*(t/=r)*t**3+e,easeInQuint:(t,e,n,r)=>n*(t/r)**5+e,easeInSine:(t,e,n,r)=>-n*Math.cos(t/r*ji)+n+e,easeOutBack:function(t,e,n,r){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return n*((t=t/r-1)*t*((i+1)*t+i)+1)+e},easeOutBounce:Ev,easeOutCirc:(t,e,n,r)=>n*Math.sqrt(1-(t=t/r-1)*t)+e,easeOutCubic:(t,e,n,r)=>n*((t/r-1)**3+1)+e,easeOutElastic:(t,e,n,r)=>{let i=n,o=0;if(t===0)return e;if((t/=r)===1)return e+n;o||(o=.3*r);let{a:l,s:a,p:c,c:s}=av(i,n,o,1.70158);return l*2**(-10*t)*Math.sin((t*r-a)*ni/c)+s+e},easeOutExpo:(t,e,n,r)=>t===r?e+n:n*-(2**(-10*t/r)+1)+e,easeOutQuad:(t,e,n,r)=>-n*(t/=r)*(t-2)+e,easeOutQuart:(t,e,n,r)=>-n*((t=t/r-1)*t**3-1)+e,easeOutQuint:(t,e,n,r)=>n*((t/r-1)**5+1)+e,easeOutSine:(t,e,n,r)=>n*Math.sin(t/r*ji)+e}),S4=()=>!1,mc=class{constructor(e){let{startValue:n,byValue:r,duration:i=500,delay:o=0,easing:l=qD,onStart:a=Wo,onChange:c=Wo,onComplete:s=Wo,abort:u=S4,target:d}=e;E(this,"_state","pending"),E(this,"durationProgress",0),E(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=i,this.delay=o,this.easing=l,this._onStart=a,this._onChange=c,this._onComplete=s,this._abort=u,this.target=d,this.startValue=n,this.byValue=r,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){let e=n=>{this._state==="pending"&&(this.startTime=n||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>ac(e),this.delay):ac(e)}tick(e){let n=(e||+new Date)-this.startTime,r=Math.min(n,this.duration);this.durationProgress=r/this.duration;let{value:i,valueProgress:o}=this.calculate(r);this.value=Object.freeze(i),this.valueProgress=o,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):n>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),ac(this.tick)))}register(){Wh.push(this)}unregister(){Wh.remove(this)}abort(){this._state="aborted",this.unregister()}},D4=["startValue","endValue"],Cv=class extends mc{constructor(e){let{startValue:n=0,endValue:r=100}=e;super(x(x({},Xe(e,D4)),{},{startValue:n,byValue:r-n}))}calculate(e){let n=this.easing(e,this.startValue,this.byValue,this.duration);return{value:n,valueProgress:Math.abs((n-this.startValue)/this.byValue)}}},I4=["startValue","endValue"],Sv=class extends mc{constructor(e){let{startValue:n=[0],endValue:r=[100]}=e;super(x(x({},Xe(e,I4)),{},{startValue:n,byValue:r.map((i,o)=>i-n[o])}))}calculate(e){let n=this.startValue.map((r,i)=>this.easing(e,r,this.byValue[i],this.duration,i));return{value:n,valueProgress:Math.abs((n[0]-this.startValue[0])/this.byValue[0])}}},O4=["startValue","endValue","easing","onChange","onComplete","abort"],A4=(t,e,n,r)=>e+n*(1-Math.cos(t/r*ji)),lv=t=>t&&((e,n,r)=>t(new en(e).toRgba(),n,r)),Dv=class extends mc{constructor(e){let{startValue:n,endValue:r,easing:i=A4,onChange:o,onComplete:l,abort:a}=e,c=Xe(e,O4),s=new en(n).getSource(),u=new en(r).getSource();super(x(x({},c),{},{startValue:s,byValue:u.map((d,h)=>d-s[h]),easing:i,onChange:lv(o),onComplete:lv(l),abort:lv(a)}))}calculate(e){let[n,r,i,o]=this.startValue.map((a,c)=>this.easing(e,a,this.byValue[c],this.duration,c)),l=[...[n,r,i].map(Math.round),Ko(0,o,1)];return{value:l,valueProgress:l.map((a,c)=>this.byValue[c]!==0?Math.abs((a-this.startValue[c])/this.byValue[c]):0).find(a=>a!==0)||0}}};function ab(t){let e=(n=>Array.isArray(n.startValue)||Array.isArray(n.endValue))(t)?new Sv(t):new Cv(t);return e.start(),e}function YD(t){let e=new Dv(t);return e.start(),e}var Xo=class t{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(n=>n.eq(e))}append(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.points=this.points.concat(n.filter(i=>!this.includes(i))),this}static isPointContained(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(n.eq(r))return e.eq(n);if(n.x===r.x)return e.x===n.x&&(i||e.y>=Math.min(n.y,r.y)&&e.y<=Math.max(n.y,r.y));if(n.y===r.y)return e.y===n.y&&(i||e.x>=Math.min(n.x,r.x)&&e.x<=Math.max(n.x,r.x));{let o=Qh(n,r),l=Qh(n,e).divide(o);return i?Math.abs(l.x)===Math.abs(l.y):l.x===l.y&&l.x>=0&&l.x<=1}}static isPointInPolygon(e,n){let r=new A(e).setX(Math.min(e.x-1,...n.map(o=>o.x))),i=0;for(let o=0;o<n.length;o++){let l=this.intersectSegmentSegment(n[o],n[(o+1)%n.length],e,r);if(l.includes(e))return!0;i+=+(l.status==="Intersection")}return i%2==1}static intersectLineLine(e,n,r,i){let o=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],l=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],a=n.x-e.x,c=n.y-e.y,s=i.x-r.x,u=i.y-r.y,d=e.x-r.x,h=e.y-r.y,f=s*h-u*d,p=a*h-c*d,g=u*a-s*c;if(g!==0){let y=f/g,b=p/g;return(o||0<=y&&y<=1)&&(l||0<=b&&b<=1)?new t("Intersection").append(new A(e.x+y*a,e.y+y*c)):new t}if(f===0||p===0){let y=o||l||t.isPointContained(e,r,i)||t.isPointContained(n,r,i)||t.isPointContained(r,e,n)||t.isPointContained(i,e,n);return new t(y?"Coincident":void 0)}return new t("Parallel")}static intersectSegmentLine(e,n,r,i){return t.intersectLineLine(e,n,r,i,!1,!0)}static intersectSegmentSegment(e,n,r,i){return t.intersectLineLine(e,n,r,i,!1,!1)}static intersectLinePolygon(e,n,r){let i=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],o=new t,l=r.length;for(let a,c,s,u=0;u<l;u++){if(a=r[u],c=r[(u+1)%l],s=t.intersectLineLine(e,n,a,c,i,!1),s.status==="Coincident")return s;o.append(...s.points)}return o.points.length>0&&(o.status="Intersection"),o}static intersectSegmentPolygon(e,n,r){return t.intersectLinePolygon(e,n,r,!1)}static intersectPolygonPolygon(e,n){let r=new t,i=e.length,o=[];for(let l=0;l<i;l++){let a=e[l],c=e[(l+1)%i],s=t.intersectSegmentPolygon(a,c,n);s.status==="Coincident"?(o.push(s),r.append(a,c)):r.append(...s.points)}return o.length>0&&o.length===e.length?new t("Coincident"):(r.points.length>0&&(r.status="Intersection"),r)}static intersectPolygonRectangle(e,n,r){let i=n.min(r),o=n.max(r),l=new A(o.x,i.y),a=new A(i.x,o.y);return t.intersectPolygonPolygon(e,[i,l,o,a])}},Iv=class extends qh{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){let e=this.getRelativeXY();return this.group?jt(e,this.group.calcTransformMatrix()):e}setXY(e,n,r){this.group&&(e=jt(e,xn(this.group.calcTransformMatrix()))),this.setRelativeXY(e,n,r)}getRelativeXY(){return new A(this.left,this.top)}setRelativeXY(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,n,r)}isStrokeAccountedForInDimensions(){return!1}getCoords(){let{tl:e,tr:n,br:r,bl:i}=this.aCoords||(this.aCoords=this.calcACoords()),o=[e,n,r,i];if(this.group){let l=this.group.calcTransformMatrix();return o.map(a=>jt(a,l))}return o}intersectsWithRect(e,n){return Xo.intersectPolygonRectangle(this.getCoords(),e,n).status==="Intersection"}intersectsWithObject(e){let n=Xo.intersectPolygonPolygon(this.getCoords(),e.getCoords());return n.status==="Intersection"||n.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(n=>e.containsPoint(n))}isContainedWithinRect(e,n){let{left:r,top:i,width:o,height:l}=this.getBoundingRect();return r>=e.x&&r+o<=n.x&&i>=e.y&&i+l<=n.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return Xo.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;let{tl:e,br:n}=this.canvas.vptCoords;return!!this.getCoords().some(r=>r.x<=n.x&&r.x>=e.x&&r.y<=n.y&&r.y>=e.y)||!!this.intersectsWithRect(e,n)||this.containsPoint(e.midPointFrom(n))}isPartiallyOnScreen(){if(!this.canvas)return!1;let{tl:e,br:n}=this.canvas.vptCoords;return this.intersectsWithRect(e,n)?!0:this.getCoords().every(r=>(r.x>=n.x||r.x<=e.x)&&(r.y>=n.y||r.y<=e.y))&&this.containsPoint(e.midPointFrom(n))}getBoundingRect(){return Er(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(Jt,e),this._set(En,e),this.setCoords()}scaleToWidth(e){let n=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/n)}scaleToHeight(e){let n=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/n)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?$i(AD(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||Qt.concat()}calcACoords(){let e=ja({angle:this.angle}),{x:n,y:r}=this.getRelativeCenterPoint(),i=Ba(n,r),o=rt(i,e),l=this._getTransformedDimensions(),a=l.x/2,c=l.y/2;return{tl:jt({x:-a,y:-c},o),tr:jt({x:a,y:-c},o),bl:jt({x:-a,y:c},o),br:jt({x:a,y:c},o)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],n=[];return!e&&this.group&&(n=this.group.transformMatrixKey(e)),n.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,ft(this.originX),ft(this.originY)),n}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],n=this.calcOwnMatrix();if(e||!this.group)return n;let r=this.transformMatrixKey(e),i=this.matrixCache;return i&&i.key.every((o,l)=>o===r[l])?i.value:(this.group&&(n=rt(this.group.calcTransformMatrix(!1),n)),this.matrixCache={key:r,value:n},n)}calcOwnMatrix(){let e=this.transformMatrixKey(!0),n=this.ownMatrixCache;if(n&&n.key===e)return n.value;let r=this.getRelativeCenterPoint(),i={angle:this.angle,translateX:r.x,translateY:r.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},o=PD(i);return this.ownMatrixCache={key:e,value:o},o}_getNonTransformedDimensions(){return new A(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=x({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),r=n.strokeWidth,i=r,o=0;this.strokeUniform&&(i=0,o=r);let l=n.width+i,a=n.height+i,c;return c=n.skewX===0&&n.skewY===0?new A(l*n.scaleX,a*n.scaleY):Tf(l,a,bc(n)),c.scalarAdd(o)}translateToGivenOrigin(e,n,r,i,o){let l=e.x,a=e.y,c=ft(i)-ft(n),s=ft(o)-ft(r);if(c||s){let u=this._getTransformedDimensions();l+=c*u.x,a+=s*u.y}return new A(l,a)}translateToCenterPoint(e,n,r){if(n===le&&r===le)return e;let i=this.translateToGivenOrigin(e,n,r,le,le);return this.angle?i.rotate(nt(this.angle),e):i}translateToOriginPoint(e,n,r){let i=this.translateToGivenOrigin(e,le,le,n,r);return this.angle?i.rotate(nt(this.angle),e):i}getCenterPoint(){let e=this.getRelativeCenterPoint();return this.group?jt(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new A(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,n){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,n)}setPositionByOrigin(e,n,r){let i=this.translateToCenterPoint(e,n,r),o=this.translateToOriginPoint(i,this.originX,this.originY);this.set({left:o.x,top:o.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),Pe,ln)}},M4=["type"],P4=["extraParam"],Qr=class $h extends Iv{static getDefaults(){return $h.ownDefaults}get type(){let e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){Bi("warn","Setting type has no effect",e)}constructor(e){super(),E(this,"_cacheContext",null),Object.assign(this,$h.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=Hn(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){let n=e.width,r=e.height,i=Ce.maxCacheSideLimit,o=Ce.minCacheSideLimit;if(n<=i&&r<=i&&n*r<=Ce.perfLimitSizeTotal)return n<o&&(e.width=o),r<o&&(e.height=o),e;let l=n/r,[a,c]=sc.limitDimsByArea(l),s=Ko(o,a,i),u=Ko(o,c,i);return n>s&&(e.zoomX/=n/s,e.width=s,e.capped=!0),r>u&&(e.zoomY/=r/u,e.height=u,e.capped=!0),e}_getCacheCanvasDimensions(){let e=this.getTotalObjectScaling(),n=this._getTransformedDimensions({skewX:0,skewY:0}),r=n.x*e.x/this.scaleX,i=n.y*e.y/this.scaleY;return{width:Math.ceil(r+2),height:Math.ceil(i+2),zoomX:e.x,zoomY:e.y,x:r,y:i}}_updateCacheCanvas(){let e=this._cacheCanvas,n=this._cacheContext,{width:r,height:i,zoomX:o,zoomY:l,x:a,y:c}=this._limitCacheSize(this._getCacheCanvasDimensions()),s=r!==e.width||i!==e.height,u=this.zoomX!==o||this.zoomY!==l;if(!e||!n)return!1;if(s||u){r!==e.width||i!==e.height?(e.width=r,e.height=i):(n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,e.width,e.height));let d=a/2,h=c/2;return this.cacheTranslationX=Math.round(e.width/2-d)+d,this.cacheTranslationY=Math.round(e.height/2-h)+h,n.translate(this.cacheTranslationX,this.cacheTranslationY),n.scale(o,l),this.zoomX=o,this.zoomY=l,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){let n=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,r=this.calcTransformMatrix(!n);e.transform(r[0],r[1],r[2],r[3],r[4],r[5])}getObjectScaling(){if(!this.group)return new A(Math.abs(this.scaleX),Math.abs(this.scaleY));let e=Aa(this.calcTransformMatrix());return new A(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){let e=this.getObjectScaling();if(this.canvas){let n=this.canvas.getZoom(),r=this.getCanvasRetinaScaling();return e.scalarMultiply(n*r)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,n){e!==Jt&&e!==En||(n=this._constrainScale(n)),e===Jt&&n<0?(this.flipX=!this.flipX,n*=-1):e==="scaleY"&&n<0?(this.flipY=!this.flipY,n*=-1):e!=="shadow"||!n||n instanceof Yo||(n=new Yo(n));let r=this[e]!==n;return this[e]=n,r&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||r&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){let{zoomX:n,zoomY:r,cacheTranslationX:i,cacheTranslationY:o}=this,{width:l,height:a}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:n,zoomY:r,cacheTranslationX:i,cacheTranslationY:o,width:l,height:a,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===un&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,n,r){e.save(),n.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(r,0,0),e.restore()}drawObject(e,n,r){let i=this.fill,o=this.stroke;n?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,r),this.fill=i,this.stroke=o}createClipPathLayer(e,n){let r=cr(n),i=r.getContext("2d");if(i.translate(n.cacheTranslationX,n.cacheTranslationY),i.scale(n.zoomX,n.zoomY),e._cacheCanvas=r,n.parentClipPaths.forEach(o=>{o.transform(i)}),n.parentClipPaths.push(e),e.absolutePositioned){let o=xn(this.calcTransformMatrix());i.transform(o[0],o[1],o[2],o[3],o[4],o[5])}return e.transform(i),e.drawObject(i,!0,n),r}_drawClipPath(e,n,r){if(!n)return;n._transformDone=!0;let i=this.createClipPathLayer(n,r);this.drawClipPathOnCache(e,n,i)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;let n=this._cacheCanvas,r=this._cacheContext;return!(!n||!r||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(n&&r&&!e&&(r.save(),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,n.width,n.height),r.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;let n=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,n){let r=n.stroke;r&&(e.lineWidth=n.strokeWidth,e.lineCap=n.strokeLineCap,e.lineDashOffset=n.strokeDashOffset,e.lineJoin=n.strokeLineJoin,e.miterLimit=n.strokeMiterLimit,$n(r)?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?this._applyPatternForTransformedGradient(e,r):(e.strokeStyle=r.toLive(e),this._applyPatternGradientTransform(e,r)):e.strokeStyle=n.stroke)}_setFillStyles(e,n){let{fill:r}=n;r&&($n(r)?(e.fillStyle=r.toLive(e),this._applyPatternGradientTransform(e,r)):e.fillStyle=r)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,n){n&&n.length!==0&&e.setLineDash(n)}_setShadow(e){if(!this.shadow)return;let n=this.shadow,r=this.canvas,i=this.getCanvasRetinaScaling(),[o,,,l]=r?.viewportTransform||Qt,a=o*i,c=l*i,s=n.nonScaling?new A(1,1):this.getObjectScaling();e.shadowColor=n.color,e.shadowBlur=n.blur*Ce.browserShadowBlurConstant*(a+c)*(s.x+s.y)/4,e.shadowOffsetX=n.offsetX*a*s.x,e.shadowOffsetY=n.offsetY*c*s.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,n){if(!$n(n))return{offsetX:0,offsetY:0};let r=n.gradientTransform||n.patternTransform,i=-this.width/2+n.offsetX||0,o=-this.height/2+n.offsetY||0;return n.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,i,o):e.transform(1,0,0,1,i,o),r&&e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),{offsetX:i,offsetY:o}}_renderPaintInOrder(e){this.paintFirst===un?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){let n=this.getObjectScaling();e.scale(1/n.x,1/n.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,n){var r;let i=this._limitCacheSize(this._getCacheCanvasDimensions()),o=this.getCanvasRetinaScaling(),l=i.x/this.scaleX/o,a=i.y/this.scaleY/o,c=cr({width:Math.ceil(l),height:Math.ceil(a)}),s=c.getContext("2d");s&&(s.beginPath(),s.moveTo(0,0),s.lineTo(l,0),s.lineTo(l,a),s.lineTo(0,a),s.closePath(),s.translate(l/2,a/2),s.scale(i.zoomX/this.scaleX/o,i.zoomY/this.scaleY/o),this._applyPatternGradientTransform(s,n),s.fillStyle=n.toLive(e),s.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(o*this.scaleX/i.zoomX,o*this.scaleY/i.zoomY),e.strokeStyle=(r=s.createPattern(c,"no-repeat"))!==null&&r!==void 0?r:"")}_findCenterFromElement(){return new A(this.left+this.width/2,this.top+this.height/2)}clone(e){let n=this.toObject(e);return this.constructor.fromObject(n)}cloneAsImage(e){let n=this.toCanvasElement(e);return new(U.getClass("image"))(n)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=nb(this),r=this.group,i=this.shadow,o=Math.abs,l=e.enableRetinaScaling?_D():1,a=(e.multiplier||1)*l,c=e.canvasProvider||(v=>new gc(v,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&jD(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&Tv(this,this.getViewportTransform()),this.setCoords();let s=Hn(),u=this.getBoundingRect(),d=this.shadow,h=new A;if(d){let v=d.blur,_=d.nonScaling?new A(1,1):this.getObjectScaling();h.x=2*Math.round(o(d.offsetX)+v)*o(_.x),h.y=2*Math.round(o(d.offsetY)+v)*o(_.y)}let f=u.width+h.x,p=u.height+h.y;s.width=Math.ceil(f),s.height=Math.ceil(p);let g=c(s);e.format==="jpeg"&&(g.backgroundColor="#fff"),this.setPositionByOrigin(new A(g.width/2,g.height/2),le,le);let y=this.canvas;g._objects=[this],this.set("canvas",g),this.setCoords();let b=g.toCanvasElement(a||1,e);return this.set("canvas",y),this.shadow=i,r&&(this.group=r),this.set(n),this.setCoords(),g._objects=[],g.destroy(),b}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Qv(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.includes(this.constructor.type)||n.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){let{centeredRotation:n,originX:r,originY:i}=this;if(n){let{x:o,y:l}=this.getRelativeCenterPoint();this.originX=le,this.originY=le,this.left=o,this.top=l}if(this.set("angle",e),n){let{x:o,y:l}=this.translateToOriginPoint(this.getRelativeCenterPoint(),r,i);this.left=o,this.top=l,this.originX=r,this.originY=i}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){Wh.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&Cr().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,n){return Object.entries(e).reduce((r,i)=>{let[o,l]=i;return r[o]=this._animate(o,l,n),r},{})}_animate(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=e.split("."),o=this.constructor.colorProperties.includes(i[i.length-1]),{abort:l,startValue:a,onChange:c,onComplete:s}=r,u=x(x({},r),{},{target:this,startValue:a??i.reduce((d,h)=>d[h],this),endValue:n,abort:l?.bind(this),onChange:(d,h,f)=>{i.reduce((p,g,y)=>(y===i.length-1&&(p[g]=d),p[g]),this),c&&c(d,h,f)},onComplete:(d,h,f)=>{this.setCoords(),s&&s(d,h,f)}});return o?YD(u):ab(u)}isDescendantOf(e){let{parent:n,group:r}=this;return n===e||r===e||!!n&&n.isDescendantOf(e)||!!r&&r!==n&&r.isDescendantOf(e)}getAncestors(){let e=[],n=this;do n=n.parent,n&&e.push(n);while(n);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};let n=this.getAncestors(),r=e.getAncestors();if(n.length===0&&r.length>0&&this===r[r.length-1])return{fork:[],otherFork:[e,...r.slice(0,r.length-1)],common:[this]};for(let i,o=0;o<n.length;o++){if(i=n[o],i===e)return{fork:[this,...n.slice(0,o)],otherFork:[],common:n.slice(o)};for(let l=0;l<r.length;l++){if(this===r[l])return{fork:[],otherFork:[e,...r.slice(0,l)],common:[this,...n]};if(i===r[l])return{fork:[this,...n.slice(0,o)],otherFork:[e,...r.slice(0,l)],common:n.slice(o)}}}return{fork:[this,...n],otherFork:[e,...r],common:[]}}hasCommonAncestors(e){let n=this.findCommonAncestors(e);return n&&!!n.common.length}isInFrontOf(e){if(this===e)return;let n=this.findCommonAncestors(e);if(n.fork.includes(e))return!0;if(n.otherFork.includes(this))return!1;let r=n.common[0]||this.canvas;if(!r)return;let i=n.fork.pop(),o=n.otherFork.pop(),l=r._objects.indexOf(i),a=r._objects.indexOf(o);return l>-1&&l>a}toObject(){let e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat($h.customProperties,this.constructor.customProperties||[]),n,r=Ce.NUM_FRACTION_DIGITS,{clipPath:i,fill:o,stroke:l,shadow:a,strokeDashArray:c,left:s,top:u,originX:d,originY:h,width:f,height:p,strokeWidth:g,strokeLineCap:y,strokeDashOffset:b,strokeLineJoin:v,strokeUniform:_,strokeMiterLimit:I,scaleX:k,scaleY:V,angle:G,flipX:j,flipY:ge,opacity:Z,visible:Be,backgroundColor:me,fillRule:we,paintFirst:Se,globalCompositeOperation:ke,skewX:ee,skewY:ct}=this;i&&!i.excludeFromExport&&(n=i.toObject(e.concat("inverted","absolutePositioned")));let Fe=Nt=>Ye(Nt,r),ze=x(x({},Qo(this,e)),{},{type:this.constructor.type,version:yv,originX:d,originY:h,left:Fe(s),top:Fe(u),width:Fe(f),height:Fe(p),fill:ZS(o)?o.toObject():o,stroke:ZS(l)?l.toObject():l,strokeWidth:Fe(g),strokeDashArray:c&&c.concat(),strokeLineCap:y,strokeDashOffset:b,strokeLineJoin:v,strokeUniform:_,strokeMiterLimit:Fe(I),scaleX:Fe(k),scaleY:Fe(V),angle:Fe(G),flipX:j,flipY:ge,opacity:Fe(Z),shadow:a&&a.toObject(),visible:Be,backgroundColor:me,fillRule:we,paintFirst:Se,globalCompositeOperation:ke,skewX:Fe(ee),skewY:Fe(ct)},n?{clipPath:n}:null);return this.includeDefaultValues?ze:this._removeDefaultValues(ze)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){let n=this.constructor.getDefaults(),r=Object.keys(n).length>0?n:Object.getPrototypeOf(this);return tb(e,(i,o)=>{if(o===Pe||o===ln||o==="type")return!0;let l=r[o];return i!==l&&!(Array.isArray(i)&&Array.isArray(l)&&i.length===0&&l.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let n=Xe(e,M4),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:i}=r,o=Xe(r,P4);return wc(n,o).then(l=>i?(delete l[i],new this(n[i],l)):new this(l))}static fromObject(e,n){return this._fromObject(e,n)}};E(Qr,"stateProperties",x4),E(Qr,"cacheProperties",ri),E(Qr,"ownDefaults",E4),E(Qr,"type","FabricObject"),E(Qr,"colorProperties",[bt,un,"backgroundColor"]),E(Qr,"customProperties",[]),U.setClass(Qr),U.setClass(Qr,"object");var Hi=(t,e,n)=>(r,i,o,l)=>{let a=e(r,i,o,l);return a&&rb(t,x(x({},ib(r,i,o,l)),n)),a};function Jo(t){return(e,n,r,i)=>{let{target:o,originX:l,originY:a}=n,c=o.getRelativeCenterPoint(),s=o.translateToOriginPoint(c,l,a),u=t(e,n,r,i);return o.setPositionByOrigin(s,n.originX,n.originY),u}}var Ov=Hi(hc,Jo((t,e,n,r)=>{let i=xf(e,e.originX,e.originY,n,r);if(ft(e.originX)===ft(le)||ft(e.originX)===ft(lt)&&i.x<0||ft(e.originX)===ft(Pe)&&i.x>0){let{target:o}=e,l=o.strokeWidth/(o.strokeUniform?o.scaleX:1),a=$D(e)?2:1,c=o.width,s=Math.abs(i.x*a/o.scaleX)-l;return o.set("width",Math.max(s,1)),c!==o.width}return!1}));function XD(t,e,n,r,i){r=r||{};let o=this.sizeX||r.cornerSize||i.cornerSize,l=this.sizeY||r.cornerSize||i.cornerSize,a=r.transparentCorners!==void 0?r.transparentCorners:i.transparentCorners,c=a?un:bt,s=!a&&(r.cornerStrokeColor||i.cornerStrokeColor),u,d=e,h=n;t.save(),t.fillStyle=r.cornerColor||i.cornerColor||"",t.strokeStyle=r.cornerStrokeColor||i.cornerStrokeColor||"",o>l?(u=o,t.scale(1,l/o),h=n*o/l):l>o?(u=l,t.scale(o/l,1),d=e*l/o):u=o,t.beginPath(),t.arc(d,h,u/2,0,ni,!1),t[c](),s&&t.stroke(),t.restore()}function KD(t,e,n,r,i){r=r||{};let o=this.sizeX||r.cornerSize||i.cornerSize,l=this.sizeY||r.cornerSize||i.cornerSize,a=r.transparentCorners!==void 0?r.transparentCorners:i.transparentCorners,c=a?un:bt,s=!a&&(r.cornerStrokeColor||i.cornerStrokeColor),u=o/2,d=l/2;t.save(),t.fillStyle=r.cornerColor||i.cornerColor||"",t.strokeStyle=r.cornerStrokeColor||i.cornerStrokeColor||"",t.translate(e,n);let h=i.getTotalAngle();t.rotate(nt(h)),t["".concat(c,"Rect")](-u,-d,o,l),s&&t.strokeRect(-u,-d,o,l),t.restore()}var Kt=class{constructor(e){E(this,"visible",!0),E(this,"actionName",bf),E(this,"angle",0),E(this,"x",0),E(this,"y",0),E(this,"offsetX",0),E(this,"offsetY",0),E(this,"sizeX",0),E(this,"sizeY",0),E(this,"touchSizeX",0),E(this,"touchSizeY",0),E(this,"cursorStyle","crosshair"),E(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,n,r,i){var o;let{tl:l,tr:a,br:c,bl:s}=i;return((o=n.canvas)===null||o===void 0?void 0:o.getActiveObject())===n&&n.isControlVisible(e)&&Xo.isPointInPolygon(r,[l,a,c,s])}getActionHandler(e,n,r){return this.actionHandler}getMouseDownHandler(e,n,r){return this.mouseDownHandler}getMouseUpHandler(e,n,r){return this.mouseUpHandler}cursorStyleHandler(e,n,r){return n.cursorStyle}getActionName(e,n,r){return n.actionName}getVisibility(e,n){var r,i;return(r=(i=e._controlsVisibility)===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:this.visible}setVisibility(e,n,r){this.visible=e}positionHandler(e,n,r,i){return new A(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(n)}calcCornerCoords(e,n,r,i,o,l){let a=wf([Ba(r,i),ja({angle:e}),_f((o?this.touchSizeX:this.sizeX)||n,(o?this.touchSizeY:this.sizeY)||n)]);return{tl:new A(-.5,-.5).transform(a),tr:new A(.5,-.5).transform(a),br:new A(.5,.5).transform(a),bl:new A(-.5,.5).transform(a)}}render(e,n,r,i,o){((i=i||{}).cornerStyle||o.cornerStyle)==="circle"?XD.call(this,e,n,r,i,o):KD.call(this,e,n,r,i,o)}},ZD=(t,e,n)=>n.lockRotation?Kh:e.cursorStyle,QD=Hi(xD,Jo((t,e,n,r)=>{let{target:i,ex:o,ey:l,theta:a,originX:c,originY:s}=e,u=i.translateToOriginPoint(i.getRelativeCenterPoint(),c,s);if(sr(i,"lockRotation"))return!1;let d=Math.atan2(l-u.y,o-u.x),h=Math.atan2(r-u.y,n-u.x),f=$i(h-d+a);if(i.snapAngle&&i.snapAngle>0){let g=i.snapAngle,y=i.snapThreshold||g,b=Math.ceil(f/g)*g,v=Math.floor(f/g)*g;Math.abs(f-v)<y?f=v:Math.abs(f-b)<y&&(f=b)}f<0&&(f=360+f),f%=360;let p=i.angle!==f;return i.angle=f,p}));function JD(t,e){let n=e.canvas,r=t[n.uniScaleKey];return n.uniformScaling&&!r||!n.uniformScaling&&r}function e1(t,e,n){let r=sr(t,"lockScalingX"),i=sr(t,"lockScalingY");if(r&&i||!e&&(r||i)&&n||r&&e==="x"||i&&e==="y")return!0;let{width:o,height:l,strokeWidth:a}=t;return o===0&&a===0&&e!=="y"||l===0&&a===0&&e!=="x"}var N4=["e","se","s","sw","w","nw","n","ne","e"],_a=(t,e,n)=>{let r=JD(t,n);if(e1(n,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",r))return Kh;let i=UD(n,e);return"".concat(N4[i],"-resize")};function lb(t,e,n,r){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},o=e.target,l=i.by,a=JD(t,o),c,s,u,d,h,f;if(e1(o,l,a))return!1;if(e.gestureScale)s=e.scaleX*e.gestureScale,u=e.scaleY*e.gestureScale;else{if(c=xf(e,e.originX,e.originY,n,r),h=l!=="y"?Math.sign(c.x||e.signX||1):1,f=l!=="x"?Math.sign(c.y||e.signY||1):1,e.signX||(e.signX=h),e.signY||(e.signY=f),sr(o,"lockScalingFlip")&&(e.signX!==h||e.signY!==f))return!1;if(d=o._getTransformedDimensions(),a&&!l){let y=Math.abs(c.x)+Math.abs(c.y),{original:b}=e,v=y/(Math.abs(d.x*b.scaleX/o.scaleX)+Math.abs(d.y*b.scaleY/o.scaleY));s=b.scaleX*v,u=b.scaleY*v}else s=Math.abs(c.x*o.scaleX/d.x),u=Math.abs(c.y*o.scaleY/d.y);$D(e)&&(s*=2,u*=2),e.signX!==h&&l!=="y"&&(e.originX=eD(e.originX),s*=-1,e.signX=h),e.signY!==f&&l!=="x"&&(e.originY=eD(e.originY),u*=-1,e.signY=f)}let p=o.scaleX,g=o.scaleY;return l?(l==="x"&&o.set(Jt,s),l==="y"&&o.set(En,u)):(!sr(o,"lockScalingX")&&o.set(Jt,s),!sr(o,"lockScalingY")&&o.set(En,u)),p!==o.scaleX||g!==o.scaleY}var ic=Hi(vf,Jo((t,e,n,r)=>lb(t,e,n,r))),t1=Hi(vf,Jo((t,e,n,r)=>lb(t,e,n,r,{by:"x"}))),n1=Hi(vf,Jo((t,e,n,r)=>lb(t,e,n,r,{by:"y"}))),R4=["target","ex","ey","skewingSide"],cv={x:{counterAxis:"y",scale:Jt,skew:Fa,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:En,skew:La,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},k4=["ns","nesw","ew","nwse"],r1=(t,e,n)=>{if(e.x!==0&&sr(n,"lockSkewingY")||e.y!==0&&sr(n,"lockSkewingX"))return Kh;let r=UD(n,e)%4;return"".concat(k4[r],"-resize")};function i1(t,e,n,r,i){let{target:o}=n,{counterAxis:l,origin:a,lockSkewing:c,skew:s,flip:u}=cv[t];if(sr(o,c))return!1;let{origin:d,flip:h}=cv[l],f=ft(n[d])*(o[h]?-1:1),p=-Math.sign(f)*(o[u]?-1:1),g=.5*-((o[s]===0&&xf(n,le,le,r,i)[t]>0||o[s]>0?1:-1)*p)+.5;return Hi(ED,Jo((b,v,_,I)=>function(k,V,G){let{target:j,ex:ge,ey:Z,skewingSide:Be}=V,me=Xe(V,R4),{skew:we}=cv[k],Se=G.subtract(new A(ge,Z)).divide(new A(j.scaleX,j.scaleY))[k],ke=j[we],ee=me[we],ct=Math.tan(nt(ee)),Fe=k==="y"?j._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:j._getTransformedDimensions({scaleX:1,scaleY:1}).y,ze=2*Se*Be/Math.max(Fe,1)+ct,Nt=$i(Math.atan(ze));j.set(we,Nt);let We=ke!==j[we];if(We&&k==="y"){let{skewX:Ke,scaleX:dn}=j,Ct=j._getTransformedDimensions({skewY:ke}),Ar=j._getTransformedDimensions(),Ht=Ke!==0?Ct.x/Ar.x:1;Ht!==1&&j.set(Jt,Ht*dn)}return We}(t,v,new A(_,I))))(e,x(x({},n),{},{[a]:g,skewingSide:p}),r,i)}var o1=(t,e,n,r)=>i1("x",t,e,n,r),s1=(t,e,n,r)=>i1("y",t,e,n,r);function Sf(t,e){return t[e.canvas.altActionKey]}var oc=(t,e,n)=>{let r=Sf(t,n);return e.x===0?r?Fa:En:e.y===0?r?La:Jt:""},Ao=(t,e,n)=>Sf(t,n)?r1(0,e,n):_a(t,e,n),Av=(t,e,n,r)=>Sf(t,e.target)?s1(t,e,n,r):t1(t,e,n,r),Mv=(t,e,n,r)=>Sf(t,e.target)?o1(t,e,n,r):n1(t,e,n,r),cb=()=>({ml:new Kt({x:-.5,y:0,cursorStyleHandler:Ao,actionHandler:Av,getActionName:oc}),mr:new Kt({x:.5,y:0,cursorStyleHandler:Ao,actionHandler:Av,getActionName:oc}),mb:new Kt({x:0,y:.5,cursorStyleHandler:Ao,actionHandler:Mv,getActionName:oc}),mt:new Kt({x:0,y:-.5,cursorStyleHandler:Ao,actionHandler:Mv,getActionName:oc}),tl:new Kt({x:-.5,y:-.5,cursorStyleHandler:_a,actionHandler:ic}),tr:new Kt({x:.5,y:-.5,cursorStyleHandler:_a,actionHandler:ic}),bl:new Kt({x:-.5,y:.5,cursorStyleHandler:_a,actionHandler:ic}),br:new Kt({x:.5,y:.5,cursorStyleHandler:_a,actionHandler:ic}),mtr:new Kt({x:0,y:-.5,actionHandler:QD,cursorStyleHandler:ZD,offsetY:-40,withConnection:!0,actionName:Kv})}),a1=()=>({mr:new Kt({x:.5,y:0,actionHandler:Ov,cursorStyleHandler:Ao,actionName:hc}),ml:new Kt({x:-.5,y:0,actionHandler:Ov,cursorStyleHandler:Ao,actionName:hc})}),l1=()=>x(x({},cb()),a1()),tf=class t extends Qr{static getDefaults(){return x(x({},super.getDefaults()),t.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),t.ownDefaults),this.setOptions(e)}static createControls(){return{controls:cb()}}_updateCacheCanvas(){let e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){let n=e._currentTransform,r=n.target,i=n.action;if(this===r&&i&&i.startsWith(bf))return!1}return super._updateCacheCanvas()}getActiveControl(){let e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;let r=Object.entries(this.oCoords);for(let i=r.length-1;i>=0;i--){let[o,l]=r[i],a=this.controls[o];if(a.shouldActivate(o,this,e,n?l.touchCorner:l.corner))return this.__corner=o,{key:o,control:a,coord:this.oCoords[o]}}}calcOCoords(){let e=this.getViewportTransform(),n=this.getCenterPoint(),r=Ba(n.x,n.y),i=ja({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),o=rt(r,i),l=rt(e,o),a=rt(l,[1/e[0],0,0,1/e[3],0,0]),c=this.group?Aa(this.calcTransformMatrix()):void 0;c&&(c.scaleX=Math.abs(c.scaleX),c.scaleY=Math.abs(c.scaleY));let s=this._calculateCurrentDimensions(c),u={};return this.forEachControl((d,h)=>{let f=d.positionHandler(s,a,this,d);u[h]=Object.assign(f,this._calcCornerCoords(d,f))}),u}_calcCornerCoords(e,n){let r=this.getTotalAngle();return{corner:e.calcCornerCoords(r,this.cornerSize,n.x,n.y,!1,this),touchCorner:e.calcCornerCoords(r,this.touchCornerSize,n.x,n.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(let n in this.controls)e(this.controls[n],n,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();let n=this.getRelativeCenterPoint(),r=this._calculateCurrentDimensions(),i=this.getViewportTransform();e.translate(n.x,n.y),e.scale(1/i[0],1/i[3]),e.rotate(nt(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-r.x/2,-r.y/2,r.x,r.y),e.restore()}strokeBorders(e,n){e.strokeRect(-n.x/2,-n.y/2,n.x,n.y)}_drawBorders(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=x({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},r);e.save(),e.strokeStyle=i.borderColor,this._setLineDash(e,i.borderDashArray),this.strokeBorders(e,n),i.hasControls&&this.drawControlsConnectingLines(e,n),e.restore()}_renderControls(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{hasBorders:r,hasControls:i}=this,o=x({hasBorders:r,hasControls:i},n),l=this.getViewportTransform(),a=o.hasBorders,c=o.hasControls,s=rt(l,this.calcTransformMatrix()),u=Aa(s);e.save(),e.translate(u.translateX,u.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(u.angle-=180),e.rotate(nt(this.group?u.angle:this.angle)),a&&this.drawBorders(e,u,n),c&&this.drawControls(e,n),e.restore()}drawBorders(e,n,r){let i;if(r&&r.forActiveSelection||this.group){let o=Tf(this.width,this.height,bc(n)),l=this.isStrokeAccountedForInDimensions()?Zv:(this.strokeUniform?new A().scalarAdd(this.canvas?this.canvas.getZoom():1):new A(n.scaleX,n.scaleY)).scalarMultiply(this.strokeWidth);i=o.add(l).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else i=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,i,r)}drawControlsConnectingLines(e,n){let r=!1;e.beginPath(),this.forEachControl((i,o)=>{i.withConnection&&i.getVisibility(this,o)&&(r=!0,e.moveTo(i.x*n.x,i.y*n.y),e.lineTo(i.x*n.x+i.offsetX,i.y*n.y+i.offsetY))}),r&&e.stroke()}drawControls(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();let r=this.getCanvasRetinaScaling(),{cornerStrokeColor:i,cornerDashArray:o,cornerColor:l}=this,a=x({cornerStrokeColor:i,cornerDashArray:o,cornerColor:l},n);e.setTransform(r,0,0,r,0,0),e.strokeStyle=e.fillStyle=a.cornerColor,this.transparentCorners||(e.strokeStyle=a.cornerStrokeColor),this._setLineDash(e,a.cornerDashArray),this.forEachControl((c,s)=>{if(c.getVisibility(this,s)){let u=this.oCoords[s];c.render(e,u.x,u.y,a,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,n){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=n}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(n=>{let[r,i]=n;return this.setControlVisible(r,i)})}clearContextTop(e){if(!this.canvas)return;let n=this.canvas.contextTop;if(!n)return;let r=this.canvas.viewportTransform;n.save(),n.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this.transform(n);let i=this.width+4,o=this.height+4;return n.clearRect(-i/2,-o/2,i,o),e||n.restore(),n}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}};function c1(t,e){return e.forEach(n=>{Object.getOwnPropertyNames(n.prototype).forEach(r=>{r!=="constructor"&&Object.defineProperty(t.prototype,r,Object.getOwnPropertyDescriptor(n.prototype,r)||Object.create(null))})}),t}E(tf,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});var xt=class extends tf{};c1(xt,[Zh]),U.setClass(xt),U.setClass(xt,"object");var u1=(t,e,n,r)=>{let i=2*(r=Math.round(r))+1,{data:o}=t.getImageData(e-r,n-r,i,i);for(let l=3;l<o.length;l+=4)if(o[l]>0)return!1;return!0},nf=class{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new A(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new A(1/this.options.scaleX,1/this.options.scaleY):new A(1,1)}createSideVector(e,n){let r=Qh(e,n);return this.options.strokeUniform?r.multiply(this.scale):r}projectOrthogonally(e,n,r){return this.applySkew(e.add(this.calcOrthogonalProjection(e,n,r)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){let n=new A(e);return n.y+=n.x*Math.tan(nt(this.options.skewY)),n.x+=n.y*Math.tan(nt(this.options.skewX)),n}scaleUnitVector(e,n){return e.multiply(this.strokeUniformScalar).scalarMultiply(n)}},F4=new A,rf=class t extends nf{static getOrthogonalRotationFactor(e,n){let r=n?ef(e,n):zD(e);return Math.abs(r)<ji?-1:1}constructor(e,n,r,i){super(i),E(this,"AB",void 0),E(this,"AC",void 0),E(this,"alpha",void 0),E(this,"bisector",void 0),this.A=new A(e),this.B=new A(n),this.C=new A(r),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=ef(this.AB,this.AC),this.bisector=Cf(ob(this.AB.eq(F4)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude,i=this.createSideVector(e,n),o=sb(i),l=t.getOrthogonalRotationFactor(o,this.bisector);return this.scaleUnitVector(o,r*l)}projectBevel(){let e=[];return(this.alpha%ni==0?[this.B]:[this.B,this.C]).forEach(n=>{e.push(this.projectOrthogonally(this.A,n)),e.push(this.projectOrthogonally(this.A,n,-this.strokeProjectionMagnitude))}),e}projectMiter(){let e=[],n=Math.abs(this.alpha),r=1/Math.sin(n/2),i=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*r),o=this.options.strokeUniform?Jh(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return Jh(i)/this.strokeProjectionMagnitude<=o&&e.push(this.applySkew(this.A.add(i))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,n){let r=[],i=new A(t.getOrthogonalRotationFactor(this.bisector),t.getOrthogonalRotationFactor(new A(this.bisector.y,this.bisector.x)));return[new A(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(i),new A(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(i)].forEach(o=>{xv(o,e,n)&&r.push(this.A.add(o))}),r}projectRoundWithSkew(e,n){let r=[],{skewX:i,skewY:o,scaleX:l,scaleY:a,strokeUniform:c}=this.options,s=new A(Math.tan(nt(i)),Math.tan(nt(o))),u=this.strokeProjectionMagnitude,d=c?u/a/Math.sqrt(1/a**2+1/l**2*s.y**2):u/Math.sqrt(1+s.y**2),h=new A(Math.sqrt(Math.max(u**2-d**2,0)),d),f=c?u/Math.sqrt(1+s.x**2*(1/a)**2/(1/l+1/l*s.x*s.y)**2):u/Math.sqrt(1+s.x**2/(1+s.x*s.y)**2),p=new A(f,Math.sqrt(Math.max(u**2-f**2,0)));return[p,p.scalarMultiply(-1),h,h.scalarMultiply(-1)].map(g=>this.applySkew(c?g.multiply(this.strokeUniformScalar):g)).forEach(g=>{xv(g,e,n)&&r.push(this.applySkew(this.A).add(g))}),r}projectRound(){let e=[];e.push(...this.projectBevel());let n=this.alpha%ni==0,r=this.applySkew(this.A),i=e[n?0:2].subtract(r),o=e[n?1:0].subtract(r),l=n?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),a=Ia(i,l)>0,c=a?i:o,s=a?o:i;return this.isSkewed()?e.push(...this.projectRoundWithSkew(c,s)):e.push(...this.projectRoundNoSkew(c,s)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}},of=class extends nf{constructor(e,n,r){super(r),this.A=new A(e),this.T=new A(n)}calcOrthogonalProjection(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude,i=this.createSideVector(e,n);return this.scaleUnitVector(sb(i),r)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){let e=[];if(!this.isSkewed()&&this.A.eq(this.T)){let n=new A(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(n)),this.applySkew(this.A.subtract(n)))}else e.push(...new rf(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){let e=[];if(this.A.eq(this.T)){let n=new A(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(n),this.A.subtract(n))}else{let n=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),r=this.scaleUnitVector(Cf(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),i=this.A.add(r);e.push(i.add(n),i.subtract(n))}return e.map(n=>this.applySkew(n))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}},d1=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0&&arguments[2],r=[];if(t.length===0)return r;let i=t.reduce((o,l)=>(o[o.length-1].eq(l)||o.push(new A(l)),o),[new A(t[0])]);if(i.length===1)n=!0;else if(!n){let o=i[0],l=((a,c)=>{for(let s=a.length-1;s>=0;s--)if(c(a[s],s,a))return s;return-1})(i,a=>!a.eq(o));i.splice(l+1)}return i.forEach((o,l,a)=>{let c,s;l===0?(s=a[1],c=n?o:a[a.length-1]):l===a.length-1?(c=a[l-1],s=n?o:a[0]):(c=a[l-1],s=a[l+1]),n&&a.length===1?r.push(...new of(o,o,e).project()):!n||l!==0&&l!==a.length-1?r.push(...new rf(o,c,s,e).project()):r.push(...new of(o,l===0?s:c,e).project())}),r},ub=t=>{let e={};return Object.keys(t).forEach(n=>{e[n]={},Object.keys(t[n]).forEach(r=>{e[n][r]=x({},t[n][r])})}),e},h1=t=>t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Df=t=>{let e=[];for(let n,r=0;r<t.length;r++)(n=L4(t,r))!==!1&&e.push(n);return e},L4=(t,e)=>{let n=t.charCodeAt(e);if(isNaN(n))return"";if(n<55296||n>57343)return t.charAt(e);if(55296<=n&&n<=56319){if(t.length<=e+1)throw"High surrogate without following low surrogate";let i=t.charCodeAt(e+1);if(56320>i||i>57343)throw"High surrogate without following low surrogate";return t.charAt(e)+t.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";let r=t.charCodeAt(e-1);if(55296>r||r>56319)throw"Low surrogate without preceding high surrogate";return!1},B4=Object.freeze({__proto__:null,capitalize:function(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(t.charAt(0).toUpperCase()).concat(e?t.slice(1):t.slice(1).toLowerCase())},escapeXml:h1,graphemeSplit:Df}),If=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return t.fill!==e.fill||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth||t.fontSize!==e.fontSize||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle||t.textBackgroundColor!==e.textBackgroundColor||t.deltaY!==e.deltaY||n&&(t.overline!==e.overline||t.underline!==e.underline||t.linethrough!==e.linethrough)},f1=(t,e)=>{let n=e.split(`
`),r=[],i=-1,o={};t=ub(t);for(let l=0;l<n.length;l++){let a=Df(n[l]);if(t[l])for(let c=0;c<a.length;c++){i++;let s=t[l][c];s&&Object.keys(s).length>0&&(If(o,s,!0)?r.push({start:i,end:i+1,style:s}):r[r.length-1].end++),o=s||{}}else i+=a.length,o={}}return r},p1=(t,e)=>{if(!Array.isArray(t))return ub(t);let n=e.split(Xv),r={},i=-1,o=0;for(let l=0;l<n.length;l++){let a=Df(n[l]);for(let c=0;c<a.length;c++)i++,t[o]&&t[o].start<=i&&i<t[o].end&&(r[l]=r[l]||{},r[l][c]=x({},t[o].style),i===t[o].end-1&&o++)}return r},Gi=["display","transform",bt,"fill-opacity","fill-rule","opacity",un,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function aD(t,e){let n=t.nodeName,r=t.getAttribute("class"),i=t.getAttribute("id"),o="(?![a-zA-Z\\-]+)",l;if(l=new RegExp("^"+n,"i"),e=e.replace(l,""),i&&e.length&&(l=new RegExp("#"+i+o,"i"),e=e.replace(l,"")),r&&e.length){let a=r.split(" ");for(let c=a.length;c--;)l=new RegExp("\\."+a[c]+o,"i"),e=e.replace(l,"")}return e.length===0}function j4(t,e){let n=!0,r=aD(t,e.pop());return r&&e.length&&(n=function(i,o){let l,a=!0;for(;i.parentElement&&i.parentElement.nodeType===1&&o.length;)a&&(l=o.pop()),a=aD(i=i.parentElement,l);return o.length===0}(t,e)),r&&n&&e.length===0}var V4=t=>{var e;return(e=_4[t])!==null&&e!==void 0?e:t},$4=new RegExp("(".concat(or,")"),"gi"),U4=t=>t.replace($4," $1 ").replace(/,/gi," ").replace(/\s+/gi," "),lD,cD,uD,dD,hD,fD,pD,Zt="(".concat(or,")"),H4=String.raw(lD||(lD=Ui(["(skewX)(",")"],["(skewX)\\(","\\)"])),Zt),G4=String.raw(cD||(cD=Ui(["(skewY)(",")"],["(skewY)\\(","\\)"])),Zt),z4=String.raw(uD||(uD=Ui(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),Zt,Zt,Zt),W4=String.raw(dD||(dD=Ui(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),Zt,Zt),q4=String.raw(hD||(hD=Ui(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),Zt,Zt),Y4=String.raw(fD||(fD=Ui(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),Zt,Zt,Zt,Zt,Zt,Zt),db="(?:".concat(Y4,"|").concat(q4,"|").concat(z4,"|").concat(W4,"|").concat(H4,"|").concat(G4,")"),X4="(?:".concat(db,"*)"),K4=String.raw(pD||(pD=Ui(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),X4),Z4=new RegExp(K4),Q4=new RegExp(db),J4=new RegExp(db,"g");function Pv(t){let e=[];if(!(t=U4(t).replace(/\s*([()])\s*/gi,"$1"))||t&&!Z4.test(t))return[...Qt];for(let n of t.matchAll(J4)){let r=Q4.exec(n[0]);if(!r)continue;let i=Qt,o=r.filter(p=>!!p),[,l,...a]=o,[c,s,u,d,h,f]=a.map(p=>parseFloat(p));switch(l){case"translate":i=Ba(c,s);break;case Kv:i=ja({angle:c},{x:s,y:u});break;case bf:i=_f(c,s);break;case Fa:i=Jv(c);break;case La:i=eb(c);break;case"matrix":i=[c,s,u,d,h,f]}e.push(i)}return wf(e)}function eU(t,e,n,r){let i=Array.isArray(e),o,l=e;if(t!==bt&&t!==un||e!==cn){if(t==="strokeUniform")return e==="non-scaling-stroke";if(t==="strokeDashArray")l=e===cn?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(t==="transformMatrix")l=n&&n.transformMatrix?rt(n.transformMatrix,Pv(e)):Pv(e);else if(t==="visible")l=e!==cn&&e!=="hidden",n&&n.visible===!1&&(l=!1);else if(t==="opacity")l=parseFloat(e),n&&n.opacity!==void 0&&(l*=n.opacity);else if(t==="textAnchor")l=e==="start"?Pe:e==="end"?lt:le;else if(t==="charSpacing")o=qo(e,r)/r*1e3;else if(t==="paintFirst"){let a=e.indexOf(bt),c=e.indexOf(un);l=bt,(a>-1&&c>-1&&c<a||a===-1&&c>-1)&&(l=un)}else{if(t==="href"||t==="xlink:href"||t==="font"||t==="id")return e;if(t==="imageSmoothing")return e==="optimizeQuality";o=i?e.map(qo):qo(e,r)}}else l="";return!i&&isNaN(o)?l:o}function tU(t,e){let n=t.match(w4);if(!n)return;let r=n[1],i=n[3],o=n[4],l=n[5],a=n[6];r&&(e.fontStyle=r),i&&(e.fontWeight=isNaN(parseFloat(i))?i:parseFloat(i)),o&&(e.fontSize=qo(o)),a&&(e.fontFamily=a),l&&(e.lineHeight=l==="normal"?1:l)}function nU(t,e){t.replace(/;\s*$/,"").split(";").forEach(n=>{if(!n)return;let[r,i]=n.split(":");e[r.trim().toLowerCase()]=i.trim()})}function rU(t){let e={},n=t.getAttribute("style");return n&&(typeof n=="string"?nU(n,e):function(r,i){Object.entries(r).forEach(o=>{let[l,a]=o;a!==void 0&&(i[l.toLowerCase()]=a)})}(n,e)),e}var iU={stroke:"strokeOpacity",fill:"fillOpacity"};function ii(t,e,n){if(!t)return{};let r,i={},o=Yv;t.parentNode&&nD.test(t.parentNode.nodeName)&&(i=ii(t.parentElement,e,n),i.fontSize&&(r=o=qo(i.fontSize)));let l=x(x(x({},e.reduce((s,u)=>{let d=t.getAttribute(u);return d&&(s[u]=d),s},{})),function(s){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d={};for(let h in u)j4(s,h.split(" "))&&(d=x(x({},d),u[h]));return d}(t,n)),rU(t));l[sv]&&t.setAttribute(sv,l[sv]),l[ov]&&(r=qo(l[ov],o),l[ov]="".concat(r));let a={};for(let s in l){let u=V4(s),d=eU(u,l[s],i,r);a[u]=d}a&&a.font&&tU(a.font,a);let c=x(x({},i),a);return nD.test(t.nodeName)?c:function(s){let u=xt.getDefaults();return Object.entries(iU).forEach(d=>{let[h,f]=d;if(s[f]===void 0||s[h]==="")return;if(s[h]===void 0){if(!u[h])return;s[h]=u[h]}if(s[h].indexOf("url(")===0)return;let p=new en(s[h]);s[h]=p.setAlpha(Ye(p.getAlpha()*s[f],2)).toRgba()}),s}(c)}var oU=["left","top","width","height","visible"],g1=["rx","ry"],rr=class t extends xt{static getDefaults(){return x(x({},super.getDefaults()),t.ownDefaults)}constructor(e){super(),Object.assign(this,t.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){let{rx:e,ry:n}=this;e&&!n?this.ry=e:n&&!e&&(this.rx=n)}_render(e){let{width:n,height:r}=this,i=-n/2,o=-r/2,l=this.rx?Math.min(this.rx,n/2):0,a=this.ry?Math.min(this.ry,r/2):0,c=l!==0||a!==0;e.beginPath(),e.moveTo(i+l,o),e.lineTo(i+n-l,o),c&&e.bezierCurveTo(i+n-Pi*l,o,i+n,o+Pi*a,i+n,o+a),e.lineTo(i+n,o+r-a),c&&e.bezierCurveTo(i+n,o+r-Pi*a,i+n-Pi*l,o+r,i+n-l,o+r),e.lineTo(i+l,o+r),c&&e.bezierCurveTo(i+Pi*l,o+r,i,o+r-Pi*a,i,o+r-a),e.lineTo(i,o+a),c&&e.bezierCurveTo(i,o+Pi*a,i+Pi*l,o,i+l,o),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...g1,...e])}_toSVG(){let{width:e,height:n,rx:r,ry:i}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-n/2,'" rx="').concat(r,'" ry="').concat(i,'" width="').concat(e,'" height="').concat(n,`" />
`)]}static fromElement(e,n,r){return R(this,null,function*(){let i=ii(e,this.ATTRIBUTE_NAMES,r),{left:o=0,top:l=0,width:a=0,height:c=0,visible:s=!0}=i,u=Xe(i,oU);return new this(x(x(x({},n),u),{},{left:o,top:l,width:a,height:c,visible:!!(s&&a&&c)}))})}};E(rr,"type","Rect"),E(rr,"cacheProperties",[...ri,...g1]),E(rr,"ownDefaults",{rx:0,ry:0}),E(rr,"ATTRIBUTE_NAMES",[...Gi,"x","y","rx","ry","width","height"]),U.setClass(rr),U.setSVGClass(rr);var Jr="initialization",sf="added",hb="removed",af="imperative",m1=(t,e)=>{let{strokeUniform:n,strokeWidth:r,width:i,height:o,group:l}=e,a=l&&l!==t?_c(l.calcTransformMatrix(),t.calcTransformMatrix()):null,c=a?e.getRelativeCenterPoint().transform(a):e.getRelativeCenterPoint(),s=!e.isStrokeAccountedForInDimensions(),u=n&&s?VD(new A(r,r),void 0,t.calcTransformMatrix()):Zv,d=!n&&s?r:0,h=Tf(i+d,o+d,wf([a,e.calcOwnMatrix()],!0)).add(u).scalarDivide(2);return[c.subtract(h),c.add(h)]},Na=class{calcLayoutResult(e,n){if(this.shouldPerformLayout(e))return this.calcBoundingBox(n,e)}shouldPerformLayout(e){let{type:n,prevStrategy:r,strategy:i}=e;return n===Jr||n===af||!!r&&i!==r}shouldLayoutClipPath(e){let{type:n,target:{clipPath:r}}=e;return n!==Jr&&r&&!r.absolutePositioned}getInitialSize(e,n){return n.size}calcBoundingBox(e,n){let{type:r,target:i}=n;if(r===af&&n.overrides)return n.overrides;if(e.length===0)return;let{left:o,top:l,width:a,height:c}=Er(e.map(d=>m1(i,d)).reduce((d,h)=>d.concat(h),[])),s=new A(a,c),u=new A(o,l).add(s.scalarDivide(2));if(r===Jr){let d=this.getInitialSize(n,{size:s,center:u});return{center:u,relativeCorrection:new A(0,0),size:d}}return{center:u.transform(i.calcOwnMatrix()),size:s}}};E(Na,"type","strategy");var yc=class extends Na{shouldPerformLayout(e){return!0}};E(yc,"type","fit-content"),U.setClass(yc);var sU=["strategy"],aU=["target","strategy","bubbles","prevStrategy"],y1="layoutManager",Zo=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new yc;E(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){let n=x(x({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(n);let r=this.getLayoutResult(n);r&&this.commitLayout(n,r),this.onAfterLayout(n,r),this._prevLayoutStrategy=n.strategy}attachHandlers(e,n){let{target:r}=n;return[zh,TD,hc,xD,vf,ED,Gh,CD,p4].map(i=>e.on(i,o=>this.performLayout(i===zh?{type:"object_modified",trigger:i,e:o,target:r}:{type:"object_modifying",trigger:i,e:o,target:r})))}subscribe(e,n){this.unsubscribe(e,n);let r=this.attachHandlers(e,n);this._subscriptions.set(e,r)}unsubscribe(e,n){(this._subscriptions.get(e)||[]).forEach(r=>r()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(n=>this.unsubscribe(n,e))}subscribeTargets(e){e.targets.forEach(n=>this.subscribe(n,e))}onBeforeLayout(e){let{target:n,type:r}=e,{canvas:i}=n;if(r===Jr||r===sf?this.subscribeTargets(e):r===hb&&this.unsubscribeTargets(e),n.fire("layout:before",{context:e}),i&&i.fire("object:layout:before",{target:n,context:e}),r===af&&e.deep){let o=Xe(e,sU);n.forEachObject(l=>l.layoutManager&&l.layoutManager.performLayout(x(x({},o),{},{bubbles:!1,target:l})))}}getLayoutResult(e){let{target:n,strategy:r,type:i}=e,o=r.calcLayoutResult(e,n.getObjects());if(!o)return;let l=i===Jr?new A:n.getRelativeCenterPoint(),{center:a,correction:c=new A,relativeCorrection:s=new A}=o,u=l.subtract(a).add(c).transform(i===Jr?Qt:xn(n.calcOwnMatrix()),!0).add(s);return{result:o,prevCenter:l,nextCenter:a,offset:u}}commitLayout(e,n){let{target:r}=e,{result:{size:i},nextCenter:o}=n;var l,a;r.set({width:i.x,height:i.y}),this.layoutObjects(e,n),e.type===Jr?r.set({left:(l=e.x)!==null&&l!==void 0?l:o.x+i.x*ft(r.originX),top:(a=e.y)!==null&&a!==void 0?a:o.y+i.y*ft(r.originY)}):(r.setPositionByOrigin(o,le,le),r.setCoords(),r.set("dirty",!0))}layoutObjects(e,n){let{target:r}=e;r.forEachObject(i=>{i.group===r&&this.layoutObject(e,n,i)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,n,r.clipPath)}layoutObject(e,n,r){let{offset:i}=n;r.set({left:r.left+i.x,top:r.top+i.y})}onAfterLayout(e,n){let{target:r,strategy:i,bubbles:o,prevStrategy:l}=e,a=Xe(e,aU),{canvas:c}=r;r.fire("layout:after",{context:e,result:n}),c&&c.fire("object:layout:after",{context:e,result:n,target:r});let s=r.parent;o&&s!=null&&s.layoutManager&&((a.path||(a.path=[])).push(r),s.layoutManager.performLayout(x(x({},a),{},{target:s}))),r.set("dirty",!0)}dispose(){let{_subscriptions:e}=this;e.forEach(n=>n.forEach(r=>r())),e.clear()}toObject(){return{type:y1,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}};U.setClass(Zo,y1);var lU=["type","objects","layoutManager"],Nv=class extends Zo{performLayout(){}},Li=class t extends SD(xt){static getDefaults(){return x(x({},super.getDefaults()),t.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),E(this,"_activeObjects",[]),E(this,"__objectSelectionTracker",void 0),E(this,"__objectSelectionDisposer",void 0),Object.assign(this,t.ownDefaults),this.setOptions(n),this.groupInit(e,n)}groupInit(e,n){var r;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(i=>{this.enterGroup(i,!1)}),this.layoutManager=(r=n.layoutManager)!==null&&r!==void 0?r:new Zo,this.layoutManager.performLayout({type:Jr,target:this,targets:[...e],x:n.left,y:n.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(Bi("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(Bi("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((n,r,i)=>this.canEnterGroup(n)&&i.indexOf(n)===r)}add(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=this._filterObjectsBeforeEnteringGroup(n),o=super.add(...i);return this._onAfterObjectsChange(sf,i),o}insertAt(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];let o=this._filterObjectsBeforeEnteringGroup(r),l=super.insertAt(e,...o);return this._onAfterObjectsChange(sf,o),l}remove(){let e=super.remove(...arguments);return this._onAfterObjectsChange(hb,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,n){this.exitGroup(e,n),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,n){this.layoutManager.performLayout({type:e,targets:n,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,n){let r=this[e];return super._set(e,n),e==="canvas"&&r!==n&&(this._objects||[]).forEach(i=>{i._set(e,n)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,n){let{target:r}=n,i=this._activeObjects;if(e)i.push(r),this._set("dirty",!0);else if(i.length>0){let o=i.indexOf(r);o>-1&&(i.splice(o,1),this._set("dirty",!0))}}_watchObject(e,n){e&&this._watchObject(!1,n),e?(n.on("selected",this.__objectSelectionTracker),n.on("deselected",this.__objectSelectionDisposer)):(n.off("selected",this.__objectSelectionTracker),n.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,n){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,n)}_enterGroup(e,n){n&&Pa(e,rt(xn(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);let r=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();r&&(r===e||e.isDescendantOf(r))&&this._activeObjects.push(e)}exitGroup(e,n){this._exitGroup(e,n),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,n){e._set("group",void 0),n||(Pa(e,rt(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);let r=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;r>-1&&this._activeObjects.splice(r,1)}shouldCache(){let e=xt.prototype.shouldCache.call(this);if(e){for(let n=0;n<this._objects.length;n++)if(this._objects[n].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,n,r){this._renderBackground(e);for(let o=0;o<this._objects.length;o++){var i;let l=this._objects[o];(i=this.canvas)!==null&&i!==void 0&&i.preserveObjectStacking&&l.group!==this?(e.save(),e.transform(...xn(this.calcTransformMatrix())),l.render(e),e.restore()):l.group===this&&l.render(e)}this._drawClipPath(e,this.clipPath,r)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(x({target:this,type:af},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,n){let r=this.includeDefaultValues;return this._objects.filter(function(i){return!i.excludeFromExport}).map(function(i){let o=i.includeDefaultValues;i.includeDefaultValues=r;let l=i[e||"toObject"](n);return i.includeDefaultValues=o,l})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=this.layoutManager.toObject();return x(x(x({},super.toObject(["subTargetCheck","interactive",...e])),n.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:n}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";let n=rr.prototype._toSVG.call(this),r=n.indexOf("COMMON_PARTS");n[r]='for="group" ';let i=n.join("");return e?e(i):i}_toSVG(e){let n=["<g ","COMMON_PARTS",` >
`],r=this._createSVGBgRect(e);r&&n.push("		",r);for(let i=0;i<this._objects.length;i++)n.push("		",this._objects[i].toSVG(e));return n.push(`</g>
`),n}getSvgStyles(){let e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",n=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),n].join("")}toClipPathSVG(e){let n=[],r=this._createSVGBgRect(e);r&&n.push("	",r);for(let i=0;i<this._objects.length;i++)n.push("	",this._objects[i].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(n,{reviver:e})}static fromObject(e,n){let{type:r,objects:i=[],layoutManager:o}=e,l=Xe(e,lU);return Promise.all([Ma(i,n),wc(l,n)]).then(a=>{let[c,s]=a,u=new this(c,x(x(x({},l),s),{},{layoutManager:new Nv}));if(o){let d=U.getClass(o.type),h=U.getClass(o.strategy);u.layoutManager=new d(new h)}else u.layoutManager=new Zo;return u.layoutManager.subscribeTargets({type:Jr,target:u,targets:u.getObjects()}),u.setCoords(),u})}};E(Li,"type","Group"),E(Li,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),U.setClass(Li);var v1=(t,e)=>Math.min(e.width/t.width,e.height/t.height),b1=(t,e)=>Math.max(e.width/t.width,e.height/t.height),Rv="\\s*,?\\s*",rc="".concat(Rv,"(").concat(or,")"),cU="".concat(rc).concat(rc).concat(rc).concat(Rv,"([01])").concat(Rv,"([01])").concat(rc).concat(rc),uU={m:"l",M:"L"},dU=(t,e,n,r,i,o,l,a,c,s,u)=>{let d=ar(t),h=lr(t),f=ar(e),p=lr(e),g=n*i*f-r*o*p+l,y=r*i*f+n*o*p+a;return["C",s+c*(-n*i*h-r*o*d),u+c*(-r*i*h+n*o*d),g+c*(n*i*p+r*o*f),y+c*(r*i*p-n*o*f),g,y]},gD=(t,e,n,r)=>{let i=Math.atan2(e,t),o=Math.atan2(r,n);return o>=i?o-i:2*Math.PI-(i-o)};function kv(t,e,n,r,i,o,l,a){let c;if(Ce.cachesBoundsOfCurve&&(c=[...arguments].join(),sc.boundsOfCurveCache[c]))return sc.boundsOfCurveCache[c];let s=Math.sqrt,u=Math.abs,d=[],h=[[0,0],[0,0]],f=6*t-12*n+6*i,p=-3*t+9*n-9*i+3*l,g=3*n-3*t;for(let I=0;I<2;++I){if(I>0&&(f=6*e-12*r+6*o,p=-3*e+9*r-9*o+3*a,g=3*r-3*e),u(p)<1e-12){if(u(f)<1e-12)continue;let ge=-g/f;0<ge&&ge<1&&d.push(ge);continue}let k=f*f-4*g*p;if(k<0)continue;let V=s(k),G=(-f+V)/(2*p);0<G&&G<1&&d.push(G);let j=(-f-V)/(2*p);0<j&&j<1&&d.push(j)}let y=d.length,b=y,v=_1(t,e,n,r,i,o,l,a);for(;y--;){let{x:I,y:k}=v(d[y]);h[0][y]=I,h[1][y]=k}h[0][b]=t,h[1][b]=e,h[0][b+1]=l,h[1][b+1]=a;let _=[new A(Math.min(...h[0]),Math.min(...h[1])),new A(Math.max(...h[0]),Math.max(...h[1]))];return Ce.cachesBoundsOfCurve&&(sc.boundsOfCurveCache[c]=_),_}var hU=(t,e,n)=>{let[r,i,o,l,a,c,s,u]=n,d=((h,f,p,g,y,b,v)=>{if(p===0||g===0)return[];let _=0,I=0,k=0,V=Math.PI,G=v*qv,j=lr(G),ge=ar(G),Z=.5*(-ge*h-j*f),Be=.5*(-ge*f+j*h),me=p**2,we=g**2,Se=Be**2,ke=Z**2,ee=me*we-me*Se-we*ke,ct=Math.abs(p),Fe=Math.abs(g);if(ee<0){let Ae=Math.sqrt(1-ee/(me*we));ct*=Ae,Fe*=Ae}else k=(y===b?-1:1)*Math.sqrt(ee/(me*Se+we*ke));let ze=k*ct*Be/Fe,Nt=-k*Fe*Z/ct,We=ge*ze-j*Nt+.5*h,Ke=j*ze+ge*Nt+.5*f,dn=gD(1,0,(Z-ze)/ct,(Be-Nt)/Fe),Ct=gD((Z-ze)/ct,(Be-Nt)/Fe,(-Z-ze)/ct,(-Be-Nt)/Fe);b===0&&Ct>0?Ct-=2*V:b===1&&Ct<0&&(Ct+=2*V);let Ar=Math.ceil(Math.abs(Ct/V*2)),Ht=[],St=Ct/Ar,Gt=8/3*Math.sin(St/4)*Math.sin(St/4)/Math.sin(St/2),Xn=dn+St;for(let Ae=0;Ae<Ar;Ae++)Ht[Ae]=dU(dn,Xn,ge,j,ct,Fe,We,Ke,Gt,_,I),_=Ht[Ae][5],I=Ht[Ae][6],dn=Xn,Xn+=St;return Ht})(s-t,u-e,i,o,a,c,l);for(let h=0,f=d.length;h<f;h++)d[h][1]+=t,d[h][2]+=e,d[h][3]+=t,d[h][4]+=e,d[h][5]+=t,d[h][6]+=e;return d},w1=t=>{let e=0,n=0,r=0,i=0,o=[],l,a=0,c=0;for(let s of t){let u=[...s],d;switch(u[0]){case"l":u[1]+=e,u[2]+=n;case"L":e=u[1],n=u[2],d=["L",e,n];break;case"h":u[1]+=e;case"H":e=u[1],d=["L",e,n];break;case"v":u[1]+=n;case"V":n=u[1],d=["L",e,n];break;case"m":u[1]+=e,u[2]+=n;case"M":e=u[1],n=u[2],r=u[1],i=u[2],d=["M",e,n];break;case"c":u[1]+=e,u[2]+=n,u[3]+=e,u[4]+=n,u[5]+=e,u[6]+=n;case"C":a=u[3],c=u[4],e=u[5],n=u[6],d=["C",u[1],u[2],a,c,e,n];break;case"s":u[1]+=e,u[2]+=n,u[3]+=e,u[4]+=n;case"S":l==="C"?(a=2*e-a,c=2*n-c):(a=e,c=n),e=u[3],n=u[4],d=["C",a,c,u[1],u[2],e,n],a=d[3],c=d[4];break;case"q":u[1]+=e,u[2]+=n,u[3]+=e,u[4]+=n;case"Q":a=u[1],c=u[2],e=u[3],n=u[4],d=["Q",a,c,e,n];break;case"t":u[1]+=e,u[2]+=n;case"T":l==="Q"?(a=2*e-a,c=2*n-c):(a=e,c=n),e=u[1],n=u[2],d=["Q",a,c,e,n];break;case"a":u[6]+=e,u[7]+=n;case"A":hU(e,n,u).forEach(h=>o.push(h)),e=u[6],n=u[7];break;case"z":case"Z":e=r,n=i,d=["Z"]}d?(o.push(d),l=d[0]):l=""}return o},lf=(t,e,n,r)=>Math.sqrt((n-t)**2+(r-e)**2),_1=(t,e,n,r,i,o,l,a)=>c=>{let s=c**3,u=(f=>3*f**2*(1-f))(c),d=(f=>3*f*(1-f)**2)(c),h=(f=>(1-f)**3)(c);return new A(l*s+i*u+n*d+t*h,a*s+o*u+r*d+e*h)},T1=t=>t**2,x1=t=>2*t*(1-t),E1=t=>(1-t)**2,fU=(t,e,n,r,i,o,l,a)=>c=>{let s=T1(c),u=x1(c),d=E1(c),h=3*(d*(n-t)+u*(i-n)+s*(l-i)),f=3*(d*(r-e)+u*(o-r)+s*(a-o));return Math.atan2(f,h)},pU=(t,e,n,r,i,o)=>l=>{let a=T1(l),c=x1(l),s=E1(l);return new A(i*a+n*c+t*s,o*a+r*c+e*s)},gU=(t,e,n,r,i,o)=>l=>{let a=1-l,c=2*(a*(n-t)+l*(i-n)),s=2*(a*(r-e)+l*(o-r));return Math.atan2(s,c)},mD=(t,e,n)=>{let r=new A(e,n),i=0;for(let o=1;o<=100;o+=1){let l=t(o/100);i+=lf(r.x,r.y,l.x,l.y),r=l}return i},mU=(t,e)=>{let n,r=0,i=0,o={x:t.x,y:t.y},l=x({},o),a=.01,c=0,s=t.iterator,u=t.angleFinder;for(;i<e&&a>1e-4;)l=s(r),c=r,n=lf(o.x,o.y,l.x,l.y),n+i>e?(r-=a,a/=2):(o=l,r+=a,i+=n);return x(x({},l),{},{angle:u(c)})},fb=t=>{let e,n,r=0,i=0,o=0,l=0,a=0,c=[];for(let s of t){let u={x:i,y:o,command:s[0],length:0};switch(s[0]){case"M":n=u,n.x=l=i=s[1],n.y=a=o=s[2];break;case"L":n=u,n.length=lf(i,o,s[1],s[2]),i=s[1],o=s[2];break;case"C":e=_1(i,o,s[1],s[2],s[3],s[4],s[5],s[6]),n=u,n.iterator=e,n.angleFinder=fU(i,o,s[1],s[2],s[3],s[4],s[5],s[6]),n.length=mD(e,i,o),i=s[5],o=s[6];break;case"Q":e=pU(i,o,s[1],s[2],s[3],s[4]),n=u,n.iterator=e,n.angleFinder=gU(i,o,s[1],s[2],s[3],s[4]),n.length=mD(e,i,o),i=s[3],o=s[4];break;case"Z":n=u,n.destX=l,n.destY=a,n.length=lf(i,o,l,a),i=l,o=a}r+=n.length,c.push(n)}return c.push({length:r,x:i,y:o}),c},C1=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:fb(t),r=0;for(;e-n[r].length>0&&r<n.length-2;)e-=n[r].length,r++;let i=n[r],o=e/i.length,l=t[r];switch(i.command){case"M":return{x:i.x,y:i.y,angle:0};case"Z":return x(x({},new A(i.x,i.y).lerp(new A(i.destX,i.destY),o)),{},{angle:Math.atan2(i.destY-i.y,i.destX-i.x)});case"L":return x(x({},new A(i.x,i.y).lerp(new A(l[1],l[2]),o)),{},{angle:Math.atan2(l[2]-i.y,l[1]-i.x)});case"C":case"Q":return mU(i,e)}},yU=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),yD=new RegExp(cU,"g"),vU=new RegExp(or,"gi"),bU={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},S1=t=>{var e;let n=[],r=(e=t.match(yU))!==null&&e!==void 0?e:[];for(let i of r){let o=i[0];if(o==="z"||o==="Z"){n.push([o]);continue}let l=bU[o.toLowerCase()],a=[];if(o==="a"||o==="A"){yD.lastIndex=0;for(let c=null;c=yD.exec(i);)a.push(...c.slice(1))}else a=i.match(vU)||[];for(let c=0;c<a.length;c+=l){let s=new Array(l),u=uU[o];s[0]=c>0&&u?u:o;for(let d=0;d<l;d++)s[d+1]=parseFloat(a[c+d]);n.push(s)}}return n},wU=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=new A(t[0]),r=new A(t[1]),i=1,o=0,l=[],a=t.length,c=a>2,s;for(c&&(i=t[2].x<r.x?-1:t[2].x===r.x?0:1,o=t[2].y<r.y?-1:t[2].y===r.y?0:1),l.push(["M",n.x-i*e,n.y-o*e]),s=1;s<a;s++){if(!n.eq(r)){let u=n.midPointFrom(r);l.push(["Q",n.x,n.y,u.x,u.y])}n=t[s],s+1<t.length&&(r=t[s+1])}return c&&(i=n.x>t[s-2].x?1:n.x===t[s-2].x?0:-1,o=n.y>t[s-2].y?1:n.y===t[s-2].y?0:-1),l.push(["L",n.x+i*e,n.y+o*e]),l},D1=(t,e)=>t.map(n=>n.map((r,i)=>i===0||e===void 0?r:Ye(r,e)).join(" ")).join(" ");function cf(t,e){let n=t.style;n&&e&&(typeof e=="string"?n.cssText+=";"+e:Object.entries(e).forEach(r=>{let[i,o]=r;return n.setProperty(i,o)}))}var _U=(t,e)=>Math.floor(Math.random()*(e-t+1))+t;function TU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.onComplete||Wo,r=new(yf()).XMLHttpRequest,i=e.signal,o=function(){r.abort()},l=function(){i&&i.removeEventListener("abort",o),r.onerror=r.ontimeout=Wo};if(i&&i.aborted)throw new Hh("request");return i&&i.addEventListener("abort",o,{once:!0}),r.onreadystatechange=function(){r.readyState===4&&(l(),n(r),r.onreadystatechange=Wo)},r.onerror=r.ontimeout=l,r.open("get",t,!0),r.send(),r}var xU=(t,e)=>{let n=t._findCenterFromElement();t.transformMatrix&&((r=>{if(r.transformMatrix){let{scaleX:i,scaleY:o,angle:l,skewX:a}=Aa(r.transformMatrix);r.flipX=!1,r.flipY=!1,r.set(Jt,i),r.set(En,o),r.angle=l,r.skewX=a,r.skewY=0}})(t),n=n.transform(t.transformMatrix)),delete t.transformMatrix,e&&(t.scaleX*=e.scaleX,t.scaleY*=e.scaleY,t.cropX=e.cropX,t.cropY=e.cropY,n.x+=e.offsetLeft,n.y+=e.offsetTop,t.width=e.width,t.height=e.height),t.setPositionByOrigin(n,le,le)},_Q=Object.freeze({__proto__:null,addTransformToObject:BD,animate:ab,animateColor:YD,applyTransformToObject:Pa,calcAngleBetweenVectors:ef,calcDimensionsMatrix:bc,calcPlaneChangeMatrix:_c,calcVectorRotation:zD,cancelAnimFrame:DD,capValue:Ko,composeMatrix:PD,copyCanvasElement:t=>{var e;let n=cr(t);return(e=n.getContext("2d"))===null||e===void 0||e.drawImage(t,0,0),n},cos:ar,createCanvasElement:Hn,createImage:ID,createRotateMatrix:ja,createScaleMatrix:_f,createSkewXMatrix:Jv,createSkewYMatrix:eb,createTranslateMatrix:Ba,createVector:Qh,crossProduct:Ia,degreesToRadians:nt,dotProduct:WD,ease:C4,enlivenObjectEnlivables:wc,enlivenObjects:Ma,findScaleToCover:b1,findScaleToFit:v1,getBoundsOfCurve:kv,getOrthonormalVector:sb,getPathSegmentsInfo:fb,getPointOnPath:C1,getPointer:LD,getRandomInt:_U,getRegularPolygonPath:(t,e)=>{let n=2*Math.PI/t,r=-ji;t%2==0&&(r+=n/2);let i=new Array(t+1);for(let o=0;o<t;o++){let l=o*n+r,{x:a,y:c}=new A(ar(l),lr(l)).scalarMultiply(e);i[o]=[o===0?"M":"L",a,c]}return i[t]=["Z"],i},getSmoothPathFromPoints:wU,getSvgAttributes:t=>{let e=["instantiated_by_use","style","id","class"];switch(t){case"linearGradient":return e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return e.concat(["offset","stop-color","stop-opacity"])}return e},getUnitVector:Cf,groupSVGElements:(t,e)=>t&&t.length===1?t[0]:new Li(t,e),hasStyleChanged:If,invertTransform:xn,isBetweenVectors:xv,isIdentityMatrix:OD,isTouchEvent:Xh,isTransparent:u1,joinPath:D1,loadImage:lc,magnitude:Jh,makeBoundingBoxFromPoints:Er,makePathSimpler:w1,matrixToSVG:fc,mergeClipPaths:(t,e)=>{var n;let r=t,i=e;r.inverted&&!i.inverted&&(r=e,i=t),Tv(i,(n=i.group)===null||n===void 0?void 0:n.calcTransformMatrix(),r.calcTransformMatrix());let o=r.inverted&&i.inverted;return o&&(r.inverted=i.inverted=!1),new Li([r],{clipPath:i,inverted:o})},multiplyTransformMatrices:rt,multiplyTransformMatrixArray:wf,parsePath:S1,parsePreserveAspectRatioAttribute:ND,parseUnit:qo,pick:Qo,projectStrokeOnPoints:d1,qrDecompose:Aa,radiansToDegrees:$i,removeFromArray:So,removeTransformFromObject:(t,e)=>{let n=xn(e),r=rt(n,t.calcOwnMatrix());Pa(t,r)},removeTransformMatrixForSvgParsing:xU,request:TU,requestAnimFrame:ac,resetObjectTransform:jD,rotatePoint:(t,e,n)=>t.rotate(n,e),rotateVector:ob,saveObjectTransform:nb,sendObjectToPlane:Tv,sendPointToPlane:ti,sendVectorToPlane:VD,setStyle:cf,sin:lr,sizeAfterTransform:Tf,string:B4,stylesFromArray:p1,stylesToArray:f1,toDataURL:Qv,toFixed:Ye,transformPath:(t,e,n)=>(n&&(e=rt(e,[1,0,0,1,-n.x,-n.y])),t.map(r=>{let i=[...r];for(let o=1;o<r.length-1;o+=2){let{x:l,y:a}=jt({x:r[o],y:r[o+1]},e);i[o]=l,i[o+1]=a}return i})),transformPoint:jt}),Fv=class extends Yh{constructor(e){let{allowTouchScrolling:n=!1,containerClass:r=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),E(this,"upper",void 0),E(this,"container",void 0);let{el:i}=this.lower,o=this.createUpperCanvas();this.upper={el:o,ctx:o.getContext("2d")},this.applyCanvasStyle(i,{allowTouchScrolling:n}),this.applyCanvasStyle(o,{allowTouchScrolling:n,styles:{position:"absolute",left:"0",top:"0"}});let l=this.createContainerElement();l.classList.add(r),i.parentNode&&i.parentNode.replaceChild(l,i),l.append(i,o),this.container=l}createUpperCanvas(){let{el:e}=this.lower,n=Hn();return n.className=e.className,n.classList.remove("lower-canvas"),n.classList.add("upper-canvas"),n.setAttribute("data-fabric","top"),n.style.cssText=e.style.cssText,n.setAttribute("draggable","true"),n}createContainerElement(){let e=ka().createElement("div");return e.setAttribute("data-fabric","wrapper"),cf(e,{position:"relative"}),JS(e),e}applyCanvasStyle(e,n){let{styles:r,allowTouchScrolling:i}=n;cf(e,x(x({},r),{},{"touch-action":i?"manipulation":cn})),JS(e)}setDimensions(e,n){super.setDimensions(e,n);let{el:r,ctx:i}=this.upper;FD(r,i,e,n)}setCSSDimensions(e){super.setCSSDimensions(e),wv(this.upper.el,e),wv(this.container,e)}cleanupDOM(e){let n=this.container,{el:r}=this.lower,{el:i}=this.upper;super.cleanupDOM(e),n.removeChild(i),n.removeChild(r),n.parentNode&&n.parentNode.replaceChild(r,n)}dispose(){super.dispose(),Cr().dispose(this.upper.el),delete this.upper,delete this.container}},uf=class t extends gc{constructor(){super(...arguments),E(this,"targets",[]),E(this,"_hoveredTargets",[]),E(this,"_objectsToRender",void 0),E(this,"_currentTransform",null),E(this,"_groupSelector",null),E(this,"contextTopDirty",!1)}static getDefaults(){return x(x({},super.getDefaults()),t.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new Fv(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){let e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(n=>!n.group&&n!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){let e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;let n=this.getRetinaScaling(),r=Math.ceil((2*e+1)*n);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=r,this.pixelFindContext.scale(n,n)}isTargetTransparent(e,n,r){let i=this.targetFindTolerance,o=this.pixelFindContext;this.clearContext(o),o.save(),o.translate(-n+i,-r+i),o.transform(...this.viewportTransform);let l=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(o),e.selectionBackgroundColor=l,o.restore();let a=Math.round(i*this.getRetinaScaling());return u1(o,a,a,a)}_isSelectionKeyPressed(e){let n=this.selectionKey;return!!n&&(Array.isArray(n)?!!n.find(r=>!!r&&e[r]===!0):e[n])}_shouldClearSelection(e,n){let r=this.getActiveObjects(),i=this._activeObject;return!!(!n||n&&i&&r.length>1&&r.indexOf(n)===-1&&i!==n&&!this._isSelectionKeyPressed(e)||n&&!n.evented||n&&!n.selectable&&i&&i!==n)}_shouldCenterTransform(e,n,r){if(!e)return;let i;return n===bf||n===Jt||n===En||n===hc?i=this.centeredScaling||e.centeredScaling:n===Kv&&(i=this.centeredRotation||e.centeredRotation),i?!r:r}_getOriginFromCorner(e,n){let r={x:e.originX,y:e.originY};return n&&(["ml","tl","bl"].includes(n)?r.x=lt:["mr","tr","br"].includes(n)&&(r.x=Pe),["tl","mt","tr"].includes(n)?r.y=vv:["bl","mb","br"].includes(n)&&(r.y=ln)),r}_setupCurrentTransform(e,n,r){var i;let o=n.group?ti(this.getScenePoint(e),void 0,n.group.calcTransformMatrix()):this.getScenePoint(e),{key:l="",control:a}=n.getActiveControl()||{},c=r&&a?(i=a.getActionHandler(e,n,a))===null||i===void 0?void 0:i.bind(a):HD,s=((f,p,g,y)=>{if(!p||!f)return"drag";let b=y.controls[p];return b.getActionName(g,b,y)})(r,l,e,n),u=e[this.centeredKey],d=this._shouldCenterTransform(n,s,u)?{x:le,y:le}:this._getOriginFromCorner(n,l),h={target:n,action:s,actionHandler:c,actionPerformed:!1,corner:l,scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,offsetX:o.x-n.left,offsetY:o.y-n.top,originX:d.x,originY:d.y,ex:o.x,ey:o.y,lastX:o.x,lastY:o.y,theta:nt(n.angle),width:n.width,height:n.height,shiftKey:e.shiftKey,altKey:u,original:x(x({},nb(n)),{},{originX:d.x,originY:d.y})};this._currentTransform=h,this.fire("before:transform",{e,transform:h})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){let{x:n,y:r,deltaX:i,deltaY:o}=this._groupSelector,l=new A(n,r).transform(this.viewportTransform),a=new A(n+i,r+o).transform(this.viewportTransform),c=this.selectionLineWidth/2,s=Math.min(l.x,a.x),u=Math.min(l.y,a.y),d=Math.max(l.x,a.x),h=Math.max(l.y,a.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(s,u,d-s,h-u)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,s+=c,u+=c,d-=c,h-=c,xt.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(s,u,d-s,h-u))}findTarget(e){if(this.skipTargetFind)return;let n=this.getViewportPoint(e),r=this._activeObject,i=this.getActiveObjects();if(this.targets=[],r&&i.length>=1){if(r.findControl(n,Xh(e))||i.length>1&&this.searchPossibleTargets([r],n))return r;if(r===this.searchPossibleTargets([r],n)){if(this.preserveObjectStacking){let o=this.targets;this.targets=[];let l=this.searchPossibleTargets(this._objects,n);return e[this.altSelectionKey]&&l&&l!==r?(this.targets=o,r):l}return r}}return this.searchPossibleTargets(this._objects,n)}_pointIsInObjectSelectionArea(e,n){let r=e.getCoords(),i=this.getZoom(),o=e.padding/i;if(o){let[l,a,c,s]=r,u=Math.atan2(a.y-l.y,a.x-l.x),d=ar(u)*o,h=lr(u)*o,f=d+h,p=d-h;r=[new A(l.x-p,l.y-f),new A(a.x+f,a.y-p),new A(c.x+p,c.y+f),new A(s.x-f,s.y+p)]}return Xo.isPointInPolygon(n,r)}_checkTarget(e,n){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,ti(n,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,n.x,n.y)))}_searchPossibleTargets(e,n){let r=e.length;for(;r--;){let i=e[r];if(this._checkTarget(i,n)){if(Vh(i)&&i.subTargetCheck){let o=this._searchPossibleTargets(i._objects,n);o&&this.targets.push(o)}return i}}}searchPossibleTargets(e,n){let r=this._searchPossibleTargets(e,n);if(r&&Vh(r)&&r.interactive&&this.targets[0]){let i=this.targets;for(let o=i.length-1;o>0;o--){let l=i[o];if(!Vh(l)||!l.interactive)return l}return i[0]}return r}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1],r=this.upperCanvasEl,i=r.getBoundingClientRect(),o=LD(e),l=i.width||0,a=i.height||0;l&&a||(ln in i&&vv in i&&(a=Math.abs(i.top-i.bottom)),lt in i&&Pe in i&&(l=Math.abs(i.right-i.left))),this.calcOffset(),o.x=o.x-this._offset.left,o.y=o.y-this._offset.top,n||(o=ti(o,void 0,this.viewportTransform));let c=this.getRetinaScaling();c!==1&&(o.x/=c,o.y/=c);let s=l===0||a===0?new A(1,1):new A(r.width/l,r.height/a);return o.multiply(s)}_setDimensionsImpl(e,n){this._resetTransformEventData(),super._setDimensionsImpl(e,n),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Hn(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){let e=this._activeObject;return Do(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,n){let r=!1,i=!1,o=this.getActiveObjects(),l=[],a=[];e.forEach(c=>{o.includes(c)||(r=!0,c.fire("deselected",{e:n,target:c}),a.push(c))}),o.forEach(c=>{e.includes(c)||(r=!0,c.fire("selected",{e:n,target:c}),l.push(c))}),e.length>0&&o.length>0?(i=!0,r&&this.fire("selection:updated",{e:n,selected:l,deselected:a})):o.length>0?(i=!0,this.fire("selection:created",{e:n,selected:l})):e.length>0&&(i=!0,this.fire("selection:cleared",{e:n,deselected:a})),i&&(this._objectsToRender=void 0)}setActiveObject(e,n){let r=this.getActiveObjects(),i=this._setActiveObject(e,n);return this._fireSelectionEvents(r,n),i}_setActiveObject(e,n){let r=this._activeObject;return r!==e&&!(!this._discardActiveObject(n,e)&&this._activeObject)&&!e.onSelect({e:n})&&(this._activeObject=e,Do(e)&&r!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,n){let r=this._activeObject;return!!r&&!r.onDeselect({e,object:n})&&(this._currentTransform&&this._currentTransform.target===r&&this.endCurrentTransform(e),Do(r)&&r===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){let n=this.getActiveObjects(),r=this.getActiveObject();n.length&&this.fire("before:selection:cleared",{e,deselected:[r]});let i=this._discardActiveObject(e);return this._fireSelectionEvents(n,e),i}endCurrentTransform(e){let n=this._currentTransform;this._finalizeCurrentTransform(e),n&&n.target&&(n.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){let n=this._currentTransform,r=n.target,i={e,target:r,transform:n,action:n.action};r._scaling&&(r._scaling=!1),r.setCoords(),n.actionPerformed&&(this.fire("object:modified",i),r.fire(zh,i))}setViewportTransform(e){super.setViewportTransform(e);let n=this._activeObject;n&&n.setCoords()}destroy(){let e=this._activeObject;Do(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){let n=this._activeObject;n&&n._renderControls(e)}_toObject(e,n,r){let i=this._realizeGroupTransformOnObject(e),o=super._toObject(e,n,r);return e.set(i),o}_realizeGroupTransformOnObject(e){let{group:n}=e;if(n&&Do(n)&&this._activeObject===n){let r=Qo(e,["angle","flipX","flipY",Pe,Jt,En,Fa,La,ln]);return BD(e,n.calcOwnMatrix()),r}return{}}_setSVGObject(e,n,r){let i=this._realizeGroupTransformOnObject(n);super._setSVGObject(e,n,r),n.set(i)}};E(uf,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});var Lv=class{constructor(e){E(this,"targets",[]),E(this,"__disposer",void 0);let n=()=>{let{hiddenTextarea:i}=e.getActiveObject()||{};i&&i.focus()},r=e.upperCanvasEl;r.addEventListener("click",n),this.__disposer=()=>r.removeEventListener("click",n)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),So(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var n;!((n=this.target)===null||n===void 0)&&n.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}},EU=["target","oldTarget","fireCanvas","e"],Tn={passive:!1},wa=(t,e)=>{let n=t.getViewportPoint(e),r=t.getScenePoint(e);return{viewportPoint:n,scenePoint:r,pointer:n,absolutePointer:r}},Ni=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.addEventListener(...n)},Bn=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.removeEventListener(...n)},CU={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}},Ra=class extends uf{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),E(this,"_isClick",void 0),E(this,"textEditingManager",new Lv(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onDoubleClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(n=>{this[n]=this[n].bind(this)}),this.addOrRemove(Ni,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,n){let r=this.upperCanvasEl,i=this._getEventPrefix();e(kD(r),"resize",this._onResize),e(r,i+"down",this._onMouseDown),e(r,"".concat(i,"move"),this._onMouseMove,Tn),e(r,"".concat(i,"out"),this._onMouseOut),e(r,"".concat(i,"enter"),this._onMouseEnter),e(r,"wheel",this._onMouseWheel),e(r,"contextmenu",this._onContextMenu),e(r,"dblclick",this._onDoubleClick),e(r,"dragstart",this._onDragStart),e(r,"dragend",this._onDragEnd),e(r,"dragover",this._onDragOver),e(r,"dragenter",this._onDragEnter),e(r,"dragleave",this._onDragLeave),e(r,"drop",this._onDrop),this.enablePointerEvents||e(r,"touchstart",this._onTouchStart,Tn)}removeListeners(){this.addOrRemove(Bn,"remove");let e=this._getEventPrefix(),n=ir(this.upperCanvasEl);Bn(n,"".concat(e,"up"),this._onMouseUp),Bn(n,"touchend",this._onTouchEnd,Tn),Bn(n,"".concat(e,"move"),this._onMouseMove,Tn),Bn(n,"touchmove",this._onMouseMove,Tn),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){let n=this._hoveredTarget,r=x({e},wa(this,e));this.fire("mouse:out",x(x({},r),{},{target:n})),this._hoveredTarget=void 0,n&&n.fire("mouseout",x({},r)),this._hoveredTargets.forEach(i=>{this.fire("mouse:out",x(x({},r),{},{target:i})),i&&i.fire("mouseout",x({},r))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",x({e},wa(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;let n=this.getActiveObject();if(n&&n.onDragStart(e)){this._dragSource=n;let r={e,target:n};return this.fire("dragstart",r),n.fire("dragstart",r),void Ni(this.upperCanvasEl,"drag",this._onDragProgress)}_v(e)}_renderDragEffects(e,n,r){let i=!1,o=this._dropTarget;o&&o!==n&&o!==r&&(o.clearContextTop(),i=!0),n?.clearContextTop(),r!==n&&r?.clearContextTop();let l=this.contextTop;l.save(),l.transform(...this.viewportTransform),n&&(l.save(),n.transform(l),n.renderDragSourceEffect(e),l.restore(),i=!0),r&&(l.save(),r.transform(l),r.renderDropTargetEffect(e),l.restore(),i=!0),l.restore(),i&&(this.contextTopDirty=!0)}_onDragEnd(e){let n=!!e.dataTransfer&&e.dataTransfer.dropEffect!==cn,r=n?this._activeObject:void 0,i={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:n,dropTarget:r};Bn(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",i),this._dragSource&&this._dragSource.fire("dragend",i),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){let n={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",n),this._dragSource&&this._dragSource.fire("drag",n)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){let n="dragover",{target:r,targets:i}=this.findDragTargets(e),o=this._dragSource,l={e,target:r,subTargets:i,dragSource:o,canDrop:!1,dropTarget:void 0},a;this.fire(n,l),this._fireEnterLeaveEvents(r,l),r&&(r.canDrop(e)&&(a=r),r.fire(n,l));for(let c=0;c<i.length;c++){let s=i[c];s.canDrop(e)&&(a=s),s.fire(n,l)}this._renderDragEffects(e,o,a),this._dropTarget=a}_onDragEnter(e){let{target:n,targets:r}=this.findDragTargets(e),i={e,target:n,subTargets:r,dragSource:this._dragSource};this.fire("dragenter",i),this._fireEnterLeaveEvents(n,i)}_onDragLeave(e){let n={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",n),this._fireEnterLeaveEvents(void 0,n),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){let{target:n,targets:r}=this.findDragTargets(e),i=this._basicEventHandler("drop:before",x({e,target:n,subTargets:r,dragSource:this._dragSource},wa(this,e)));i.didDrop=!1,i.dropTarget=void 0,this._basicEventHandler("drop",i),this.fire("drop:after",i)}_onContextMenu(e){let n=this.findTarget(e),r=this.targets||[],i=this._basicEventHandler("contextmenu:before",{e,target:n,subTargets:r});return this.stopContextMenu&&_v(e),this._basicEventHandler("contextmenu",i),!1}_onDoubleClick(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData()}getPointerId(e){let n=e.changedTouches;return n?n[0]&&n[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let n=!this.allowTouchScrolling,r=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||r&&this._target===r)&&(n=!0),n&&e.preventDefault(),this._resetTransformEventData();let i=this.upperCanvasEl,o=this._getEventPrefix(),l=ir(i);Ni(l,"touchend",this._onTouchEnd,Tn),n&&Ni(l,"touchmove",this._onMouseMove,Tn),Bn(i,"".concat(o,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();let n=this.upperCanvasEl,r=this._getEventPrefix();Bn(n,"".concat(r,"move"),this._onMouseMove,Tn);let i=ir(n);Ni(i,"".concat(r,"up"),this._onMouseUp),Ni(i,"".concat(r,"move"),this._onMouseMove,Tn)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;let n=this._getEventPrefix(),r=ir(this.upperCanvasEl);Bn(r,"touchend",this._onTouchEnd,Tn),Bn(r,"touchmove",this._onMouseMove,Tn),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{Ni(this.upperCanvasEl,"".concat(n,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();let n=this.upperCanvasEl,r=this._getEventPrefix();if(this._isMainEvent(e)){let i=ir(this.upperCanvasEl);Bn(i,"".concat(r,"up"),this._onMouseUp),Bn(i,"".concat(r,"move"),this._onMouseMove,Tn),Ni(n,"".concat(r,"move"),this._onMouseMove,Tn)}}_onMouseMove(e){let n=this.getActiveObject();!this.allowTouchScrolling&&(!n||!n.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){let n=this.getActiveObject();return!!n!=!!e||n&&e&&n!==e}__onMouseUp(e){var n;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");let r=this._currentTransform,i=this._isClick,o=this._target,{button:l}=e;if(l)return(this.fireMiddleClick&&l===1||this.fireRightClick&&l===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let a,c,s=!1;if(r&&(this._finalizeCurrentTransform(e),s=r.actionPerformed),!i){let u=o===this._activeObject;this.handleSelection(e),s||(s=this._shouldRender(o)||!u&&o===this._activeObject)}if(o){let u=o.findControl(this.getViewportPoint(e),Xh(e)),{key:d,control:h}=u||{};if(c=d,o.selectable&&o!==this._activeObject&&o.activeOn==="up")this.setActiveObject(o,e),s=!0;else if(h){let f=h.getMouseUpHandler(e,o,h);f&&(a=this.getScenePoint(e),f.call(h,e,r,a.x,a.y))}o.isMoving=!1}if(r&&(r.target!==o||r.corner!==c)){let u=r.target&&r.target.controls[r.corner],d=u&&u.getMouseUpHandler(e,r.target,u);a=a||this.getScenePoint(e),d&&d.call(u,e,r,a.x,a.y)}this._setCursorFromEvent(e,o),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,o&&(o.__corner=void 0),s?this.requestRenderAll():i||(n=this._activeObject)!==null&&n!==void 0&&n.isEditing||this.renderTop()}_basicEventHandler(e,n){let{target:r,subTargets:i=[]}=n;this.fire(e,n),r&&r.fire(e,n);for(let o=0;o<i.length;o++)i[o]!==r&&i[o].fire(e,n);return n}_handleEvent(e,n){let r=this._target,i=this.targets||[],o=x(x({e,target:r,subTargets:i},wa(this,e)),{},{transform:this._currentTransform},n==="up:before"||n==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{});this.fire("mouse:".concat(n),o),r&&r.fire("mouse".concat(n),o);for(let l=0;l<i.length;l++)i[l]!==r&&i[l].fire("mouse".concat(n),o)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());let n=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(n,{e,pointer:n}),this._handleEvent(e,"down")}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){let n=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(n,{e,pointer:n})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){let n=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:n}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let n=this._target,{button:r}=e;if(r)return(this.fireMiddleClick&&r===1||this.fireRightClick&&r===2)&&this._handleEvent(e,"down"),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let i=this._shouldRender(n),o=!1;if(this.handleMultiSelection(e,n)?(n=this._activeObject,o=!0,i=!0):this._shouldClearSelection(e,n)&&this.discardActiveObject(e),this.selection&&(!n||!n.selectable&&!n.isEditing&&n!==this._activeObject)){let l=this.getScenePoint(e);this._groupSelector={x:l.x,y:l.y,deltaY:0,deltaX:0}}if(n){let l=n===this._activeObject;n.selectable&&n.activeOn==="down"&&this.setActiveObject(n,e);let a=n.findControl(this.getViewportPoint(e),Xh(e));if(n===this._activeObject&&(a||!o)){this._setupCurrentTransform(e,n,l);let c=a?a.control:void 0,s=this.getScenePoint(e),u=c&&c.getMouseDownHandler(e,n,c);u&&u.call(c,e,this._currentTransform,s.x,s.y)}}i&&(this._objectsToRender=void 0),this._handleEvent(e,"down"),i&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=ti(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;let n=this._groupSelector;if(n){let r=this.getScenePoint(e);n.deltaX=r.x-n.x,n.deltaY=r.y-n.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{let r=this.findTarget(e);this._setCursorFromEvent(e,r),this._fireOverOutEvents(e,r)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,n){let r=this._hoveredTarget,i=this._hoveredTargets,o=this.targets,l=Math.max(i.length,o.length);this.fireSyntheticInOutEvents("mouse",{e,target:n,oldTarget:r,fireCanvas:!0});for(let a=0;a<l;a++)this.fireSyntheticInOutEvents("mouse",{e,target:o[a],oldTarget:i[a]});this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,n){let r=this._draggedoverTarget,i=this._hoveredTargets,o=this.targets,l=Math.max(i.length,o.length);this.fireSyntheticInOutEvents("drag",x(x({},n),{},{target:e,oldTarget:r,fireCanvas:!0}));for(let a=0;a<l;a++)this.fireSyntheticInOutEvents("drag",x(x({},n),{},{target:o[a],oldTarget:i[a]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,n){let{target:r,oldTarget:i,fireCanvas:o,e:l}=n,a=Xe(n,EU),{targetIn:c,targetOut:s,canvasIn:u,canvasOut:d}=CU[e],h=i!==r;if(i&&h){let f=x(x({},a),{},{e:l,target:i,nextTarget:r},wa(this,l));o&&this.fire(d,f),i.fire(s,f)}if(r&&h){let f=x(x({},a),{},{e:l,target:r,previousTarget:i},wa(this,l));o&&this.fire(u,f),r.fire(c,f)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){let n=this.getScenePoint(e),r=this._currentTransform,i=r.target,o=i.group?ti(n,void 0,i.group.calcTransformMatrix()):n;r.shiftKey=e.shiftKey,r.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,r,o),r.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,n,r){let{action:i,actionHandler:o,target:l}=n,a=!!o&&o(e,n,r.x,r.y);a&&l.setCoords(),i==="drag"&&a&&(n.target.isMoving=!0,this.setCursor(n.target.moveCursor||this.moveCursor)),n.actionPerformed=n.actionPerformed||a}_setCursorFromEvent(e,n){if(!n)return void this.setCursor(this.defaultCursor);let r=n.hoverCursor||this.hoverCursor,i=Do(this._activeObject)?this._activeObject:null,o=(!i||n.group!==i)&&n.findControl(this.getViewportPoint(e));if(o){let l=o.control;this.setCursor(l.cursorStyleHandler(e,l,n))}else n.subTargetCheck&&this.targets.concat().reverse().map(l=>{r=l.hoverCursor||r}),this.setCursor(r)}handleMultiSelection(e,n){let r=this._activeObject,i=Do(r);if(r&&this._isSelectionKeyPressed(e)&&this.selection&&n&&n.selectable&&(r!==n||i)&&(i||!n.isDescendantOf(r)&&!r.isDescendantOf(n))&&!n.onSelect({e})&&!r.getActiveControl()){if(i){let o=r.getObjects();if(n===r){let l=this.getViewportPoint(e);if(!(n=this.searchPossibleTargets(o,l)||this.searchPossibleTargets(this._objects,l))||!n.selectable)return!1}n.group===r?(r.remove(n),this._hoveredTarget=n,this._hoveredTargets=[...this.targets],r.size()===1&&this._setActiveObject(r.item(0),e)):(r.multiSelectAdd(n),this._hoveredTarget=r,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(o,e)}else{r.isEditing&&r.exitEditing();let o=new(U.getClass("ActiveSelection"))([],{canvas:this});o.multiSelectAdd(r,n),this._hoveredTarget=o,this._setActiveObject(o,e),this._fireSelectionEvents([r],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;let{x:n,y:r,deltaX:i,deltaY:o}=this._groupSelector,l=new A(n,r),a=l.add(new A(i,o)),c=l.min(a),s=l.max(a).subtract(c),u=this.collectObjects({left:c.x,top:c.y,width:s.x,height:s.y},{includeIntersecting:!this.selectionFullyContained}),d=l.eq(a)?u[0]?[u[0]]:[]:u.length>1?u.filter(h=>!h.onSelect({e})).reverse():u;if(d.length===1)this.setActiveObject(d[0],e);else if(d.length>1){let h=U.getClass("ActiveSelection");this.setActiveObject(new h(d,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}},I1={x1:0,y1:0,x2:0,y2:0},SU=x(x({},I1),{},{r1:0,r2:0}),Ta=(t,e)=>isNaN(t)&&typeof e=="number"?e:t,DU=/^(\d+\.\d+)%|(\d+)%$/;function O1(t){return t&&DU.test(t)}function A1(t,e){let n=typeof t=="number"?t:typeof t=="string"?parseFloat(t)/(O1(t)?100:1):NaN;return Ko(0,Ta(n,e),1)}var IU=/\s*;\s*/,OU=/\s*:\s*/;function AU(t,e){let n,r,i=t.getAttribute("style");if(i){let l=i.split(IU);l[l.length-1]===""&&l.pop();for(let a=l.length;a--;){let[c,s]=l[a].split(OU).map(u=>u.trim());c==="stop-color"?n=s:c==="stop-opacity"&&(r=s)}}let o=new en(n||t.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:A1(t.getAttribute("offset"),0),color:o.toRgb(),opacity:Ta(parseFloat(r||t.getAttribute("stop-opacity")||""),1)*o.getAlpha()*e}}function MU(t,e){let n=[],r=t.getElementsByTagName("stop"),i=A1(e,1);for(let o=r.length;o--;)n.push(AU(r[o],i));return n}function M1(t){return t.nodeName==="linearGradient"||t.nodeName==="LINEARGRADIENT"?"linear":"radial"}function P1(t){return t.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function nr(t,e){return t.getAttribute(e)}function PU(t,e){return function(n,r){let i,{width:o,height:l,gradientUnits:a}=r;return Object.keys(n).reduce((c,s)=>{let u=n[s];return u==="Infinity"?i=1:u==="-Infinity"?i=0:(i=typeof u=="string"?parseFloat(u):u,typeof u=="string"&&O1(u)&&(i*=.01,a==="pixels"&&(s!=="x1"&&s!=="x2"&&s!=="r2"||(i*=o),s!=="y1"&&s!=="y2"||(i*=l)))),c[s]=i,c},{})}(M1(t)==="linear"?function(n){return{x1:nr(n,"x1")||0,y1:nr(n,"y1")||0,x2:nr(n,"x2")||"100%",y2:nr(n,"y2")||0}}(t):function(n){return{x1:nr(n,"fx")||nr(n,"cx")||"50%",y1:nr(n,"fy")||nr(n,"cy")||"50%",r1:0,x2:nr(n,"cx")||"50%",y2:nr(n,"cy")||"50%",r2:nr(n,"r")||"50%"}}(t),x(x({},e),{},{gradientUnits:P1(t)}))}var xa=class{constructor(e){let{type:n="linear",gradientUnits:r="pixels",coords:i={},colorStops:o=[],offsetX:l=0,offsetY:a=0,gradientTransform:c,id:s}=e||{};Object.assign(this,{type:n,gradientUnits:r,coords:x(x({},n==="radial"?SU:I1),i),colorStops:o,offsetX:l,offsetY:a,gradientTransform:c,id:s?"".concat(s,"_").concat(Vi()):Vi()})}addColorStop(e){for(let n in e){let r=new en(e[n]);this.colorStops.push({offset:parseFloat(n),color:r.toRgb(),opacity:r.getAlpha()})}return this}toObject(e){return x(x({},Qo(this,e)),{},{type:this.type,coords:x({},this.coords),colorStops:this.colorStops.map(n=>x({},n)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=[],i=this.gradientTransform?this.gradientTransform.concat():Qt.concat(),o=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",l=this.colorStops.map(d=>x({},d)).sort((d,h)=>d.offset-h.offset),a=-this.offsetX,c=-this.offsetY;var s;o==="objectBoundingBox"?(a/=e.width,c/=e.height):(a+=e.width/2,c+=e.height/2),(s=e)&&typeof s._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(a-=e.pathOffset.x,c-=e.pathOffset.y),i[4]-=a,i[5]-=c;let u=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(o,'"'),'gradientTransform="'.concat(n?n+" ":"").concat(fc(i),'"'),""].join(" ");if(this.type==="linear"){let{x1:d,y1:h,x2:f,y2:p}=this.coords;r.push("<linearGradient ",u,' x1="',d,'" y1="',h,'" x2="',f,'" y2="',p,`">
`)}else if(this.type==="radial"){let{x1:d,y1:h,x2:f,y2:p,r1:g,r2:y}=this.coords,b=g>y;r.push("<radialGradient ",u,' cx="',b?d:f,'" cy="',b?h:p,'" r="',b?g:y,'" fx="',b?f:d,'" fy="',b?p:h,`">
`),b&&(l.reverse(),l.forEach(_=>{_.offset=1-_.offset}));let v=Math.min(g,y);if(v>0){let _=v/Math.max(g,y);l.forEach(I=>{I.offset+=_*(1-I.offset)})}}return l.forEach(d=>{let{color:h,offset:f,opacity:p}=d;r.push("<stop ",'offset="',100*f+"%",'" style="stop-color:',h,p!==void 0?";stop-opacity: "+p:";",`"/>
`)}),r.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),r.join("")}toLive(e){let{x1:n,y1:r,x2:i,y2:o,r1:l,r2:a}=this.coords,c=this.type==="linear"?e.createLinearGradient(n,r,i,o):e.createRadialGradient(n,r,l,i,o,a);return this.colorStops.forEach(s=>{let{color:u,opacity:d,offset:h}=s;c.addColorStop(h,d!==void 0?new en(u).setAlpha(d).toRgba():u)}),c}static fromObject(e){return R(this,null,function*(){let{colorStops:n,gradientTransform:r}=e;return new this(x(x({},e),{},{colorStops:n?n.map(i=>x({},i)):void 0,gradientTransform:r?[...r]:void 0}))})}static fromElement(e,n,r){let i=P1(e),o=n._findCenterFromElement();return new this(x({id:e.getAttribute("id")||void 0,type:M1(e),coords:PU(e,{width:r.viewBoxWidth||r.width,height:r.viewBoxHeight||r.height}),colorStops:MU(e,r.opacity),gradientUnits:i,gradientTransform:Pv(e.getAttribute("gradientTransform")||"")},i==="pixels"?{offsetX:n.width/2-o.x,offsetY:n.height/2-o.y}:{offsetX:0,offsetY:0}))}};E(xa,"type","Gradient"),U.setClass(xa,"gradient"),U.setClass(xa,"linear"),U.setClass(xa,"radial");var NU=["type","source","patternTransform"],cc=class{get type(){return"pattern"}set type(e){Bi("warn","Setting type has no effect",e)}constructor(e){E(this,"repeat","repeat"),E(this,"offsetX",0),E(this,"offsetY",0),E(this,"crossOrigin",""),this.id=Vi(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],{repeat:n,crossOrigin:r}=this;return x(x({},Qo(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:n,crossOrigin:r,offsetX:Ye(this.offsetX,Ce.NUM_FRACTION_DIGITS),offsetY:Ye(this.offsetY,Ce.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:n,height:r}=e,{source:i,repeat:o,id:l}=this,a=Ta(this.offsetX/n,0),c=Ta(this.offsetY/r,0),s=o==="repeat-y"||o==="no-repeat"?1+Math.abs(a||0):Ta(i.width/n,0),u=o==="repeat-x"||o==="no-repeat"?1+Math.abs(c||0):Ta(i.height/r,0);return['<pattern id="SVGID_'.concat(l,'" x="').concat(a,'" y="').concat(c,'" width="').concat(s,'" height="').concat(u,'">'),'<image x="0" y="0" width="'.concat(i.width,'" height="').concat(i.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static fromObject(e,n){return R(this,null,function*(){let{type:r,source:i,patternTransform:o}=e,l=Xe(e,NU),a=yield lc(i,x(x({},n),{},{crossOrigin:l.crossOrigin}));return new this(x(x({},l),{},{patternTransform:o&&o.slice(0),source:a}))})}};E(cc,"type","Pattern"),U.setClass(cc),U.setClass(cc,"pattern");var RU=["path","left","top"],kU=["d"],Io=class t extends xt{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:r,left:i,top:o}=n,l=Xe(n,RU);super(),Object.assign(this,t.ownDefaults),this.setOptions(l),this._setPath(e||[],!0),typeof i=="number"&&this.set(Pe,i),typeof o=="number"&&this.set(ln,o)}_setPath(e,n){this.path=w1(Array.isArray(e)?e:S1(e)),this.setBoundingBox(n)}_findCenterFromElement(){let e=this._calcBoundsFromPath();return new A(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){let n=-this.pathOffset.x,r=-this.pathOffset.y;e.beginPath();for(let i of this.path)switch(i[0]){case"L":e.lineTo(i[1]+n,i[2]+r);break;case"M":e.moveTo(i[1]+n,i[2]+r);break;case"C":e.bezierCurveTo(i[1]+n,i[2]+r,i[3]+n,i[4]+r,i[5]+n,i[6]+r);break;case"Q":e.quadraticCurveTo(i[1]+n,i[2]+r,i[3]+n,i[4]+r);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return x(x({},super.toObject(e)),{},{path:this.path.map(n=>n.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=this.toObject(e);return this.sourcePath&&(delete n.path,n.sourcePath=this.sourcePath),n}_toSVG(){let e=D1(this.path,Ce.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){let e=Ce.NUM_FRACTION_DIGITS;return" translate(".concat(Ye(-this.pathOffset.x,e),", ").concat(Ye(-this.pathOffset.y,e),")")}toClipPathSVG(e){let n=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:n})}toSVG(e){let n=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:n})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){let{width:n,height:r,pathOffset:i}=this._calcDimensions();this.set({width:n,height:r,pathOffset:i}),e&&this.setPositionByOrigin(i,le,le)}_calcBoundsFromPath(){let e=[],n=0,r=0,i=0,o=0;for(let l of this.path)switch(l[0]){case"L":i=l[1],o=l[2],e.push({x:n,y:r},{x:i,y:o});break;case"M":i=l[1],o=l[2],n=i,r=o;break;case"C":e.push(...kv(i,o,l[1],l[2],l[3],l[4],l[5],l[6])),i=l[5],o=l[6];break;case"Q":e.push(...kv(i,o,l[1],l[2],l[1],l[2],l[3],l[4])),i=l[3],o=l[4];break;case"Z":i=n,o=r}return Er(e)}_calcDimensions(){let e=this._calcBoundsFromPath();return x(x({},e),{},{pathOffset:new A(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static fromElement(e,n,r){return R(this,null,function*(){let i=ii(e,this.ATTRIBUTE_NAMES,r),{d:o}=i;return new this(o,x(x(x({},Xe(i,kU)),n),{},{left:void 0,top:void 0}))})}};E(Io,"type","Path"),E(Io,"cacheProperties",[...ri,"path","fillRule"]),E(Io,"ATTRIBUTE_NAMES",[...Gi,"d"]),U.setClass(Io),U.setSVGClass(Io);var FU=["left","top","radius"],N1=["radius","startAngle","endAngle","counterClockwise"],Ri=class t extends xt{static getDefaults(){return x(x({},super.getDefaults()),t.ownDefaults)}constructor(e){super(),Object.assign(this,t.ownDefaults),this.setOptions(e)}_set(e,n){return super._set(e,n),e==="radius"&&this.setRadius(n),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,nt(this.startAngle),nt(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(Jt)}getRadiusY(){return this.get("radius")*this.get(En)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...N1,...e])}_toSVG(){let e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{let{radius:n}=this,r=nt(this.startAngle),i=nt(this.endAngle),o=ar(r)*n,l=lr(r)*n,a=ar(i)*n,c=lr(i)*n,s=e>180?1:0,u=this.counterClockwise?0:1;return['<path d="M '.concat(o," ").concat(l," A ").concat(n," ").concat(n," 0 ").concat(s," ").concat(u," ").concat(a," ").concat(c,'" '),"COMMON_PARTS",` />
`]}}static fromElement(e,n,r){return R(this,null,function*(){let i=ii(e,this.ATTRIBUTE_NAMES,r),{left:o=0,top:l=0,radius:a=0}=i;return new this(x(x({},Xe(i,FU)),{},{radius:a,left:o-a,top:l-a}))})}static fromObject(e){return super._fromObject(e)}};E(Ri,"type","Circle"),E(Ri,"cacheProperties",[...ri,...N1]),E(Ri,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),E(Ri,"ATTRIBUTE_NAMES",["cx","cy","r",...Gi]),U.setClass(Ri),U.setSVGClass(Ri);var LU=["x1","y1","x2","y2"],BU=["x1","y1","x2","y2"],Bv=["x1","x2","y1","y2"],Oo=class t extends xt{constructor(){let[e,n,r,i]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,t.ownDefaults),this.setOptions(o),this.x1=e,this.x2=r,this.y1=n,this.y2=i,this._setWidthHeight();let{left:l,top:a}=o;typeof l=="number"&&this.set(Pe,l),typeof a=="number"&&this.set(ln,a)}_setWidthHeight(){let{x1:e,y1:n,x2:r,y2:i}=this;this.width=Math.abs(r-e),this.height=Math.abs(i-n);let{left:o,top:l,width:a,height:c}=Er([{x:e,y:n},{x:r,y:i}]),s=new A(o+a/2,l+c/2);this.setPositionByOrigin(s,le,le)}_set(e,n){return super._set(e,n),Bv.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();let n=this.calcLinePoints();e.moveTo(n.x1,n.y1),e.lineTo(n.x2,n.y2),e.lineWidth=this.strokeWidth;let r=e.strokeStyle;var i;$n(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(i=this.stroke)!==null&&i!==void 0?i:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=r}_findCenterFromElement(){return new A((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return x(x({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){let e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){let{x1:e,x2:n,y1:r,y2:i,width:o,height:l}=this,a=e<=n?-1:1,c=r<=i?-1:1;return{x1:a*o/2,x2:a*-o/2,y1:c*l/2,y2:c*-l/2}}_toSVG(){let{x1:e,x2:n,y1:r,y2:i}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(r,'" x2="').concat(n,'" y2="').concat(i,`" />
`)]}static fromElement(e,n,r){return R(this,null,function*(){let i=ii(e,this.ATTRIBUTE_NAMES,r),{x1:o=0,y1:l=0,x2:a=0,y2:c=0}=i;return new this([o,l,a,c],Xe(i,LU))})}static fromObject(e){let{x1:n,y1:r,x2:i,y2:o}=e,l=Xe(e,BU);return this._fromObject(x(x({},l),{},{points:[n,r,i,o]}),{extraParam:"points"})}};E(Oo,"type","Line"),E(Oo,"cacheProperties",[...ri,...Bv]),E(Oo,"ATTRIBUTE_NAMES",Gi.concat(Bv)),U.setClass(Oo),U.setSVGClass(Oo);var Ea=class t extends xt{static getDefaults(){return x(x({},super.getDefaults()),t.ownDefaults)}constructor(e){super(),Object.assign(this,t.ownDefaults),this.setOptions(e)}_render(e){let n=this.width/2,r=this.height/2;e.beginPath(),e.moveTo(-n,r),e.lineTo(0,-r),e.lineTo(n,r),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){let e=this.width/2,n=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(n,",0 ").concat(-n,",").concat(e," ").concat(n),'" />']}};E(Ea,"type","Triangle"),E(Ea,"ownDefaults",{width:100,height:100}),U.setClass(Ea),U.setSVGClass(Ea);var R1=["rx","ry"],ki=class t extends xt{static getDefaults(){return x(x({},super.getDefaults()),t.ownDefaults)}constructor(e){super(),Object.assign(this,t.ownDefaults),this.setOptions(e)}_set(e,n){switch(super._set(e,n),e){case"rx":this.rx=n,this.set("width",2*n);break;case"ry":this.ry=n,this.set("height",2*n)}return this}getRx(){return this.get("rx")*this.get(Jt)}getRy(){return this.get("ry")*this.get(En)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...R1,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,ni,!1),e.restore(),this._renderPaintInOrder(e)}static fromElement(e,n,r){return R(this,null,function*(){let i=ii(e,this.ATTRIBUTE_NAMES,r);return i.left=(i.left||0)-i.rx,i.top=(i.top||0)-i.ry,new this(i)})}};function jU(t){if(!t)return[];let e=t.replace(/,/g," ").trim().split(/\s+/),n=[];for(let r=0;r<e.length;r+=2)n.push({x:parseFloat(e[r]),y:parseFloat(e[r+1])});return n}E(ki,"type","Ellipse"),E(ki,"cacheProperties",[...ri,...R1]),E(ki,"ownDefaults",{rx:0,ry:0}),E(ki,"ATTRIBUTE_NAMES",[...Gi,"cx","cy","rx","ry"]),U.setClass(ki),U.setSVGClass(ki);var VU=["left","top"],k1={exactBoundingBox:!1},Tr=class t extends xt{static getDefaults(){return x(x({},super.getDefaults()),t.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),E(this,"strokeDiff",void 0),Object.assign(this,t.ownDefaults),this.setOptions(n),this.points=e;let{left:r,top:i}=n;this.initialized=!0,this.setBoundingBox(!0),typeof r=="number"&&this.set(Pe,r),typeof i=="number"&&this.set(ln,i)}isOpen(){return!0}_projectStrokeOnPoints(e){return d1(this.points,e,this.isOpen())}_calcDimensions(e){e=x({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});let n=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(s=>s.projectedPoint):this.points;if(n.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new A,strokeOffset:new A,strokeDiff:new A};let r=Er(n),i=bc(x(x({},e),{},{scaleX:1,scaleY:1})),o=Er(this.points.map(s=>jt(s,i,!0))),l=new A(this.scaleX,this.scaleY),a=r.left+r.width/2,c=r.top+r.height/2;return this.exactBoundingBox&&(a-=c*Math.tan(nt(this.skewX)),c-=a*Math.tan(nt(this.skewY))),x(x({},r),{},{pathOffset:new A(a,c),strokeOffset:new A(o.left,o.top).subtract(new A(r.left,r.top)).multiply(l),strokeDiff:new A(r.width,r.height).subtract(new A(o.width,o.height)).multiply(l)})}_findCenterFromElement(){let e=Er(this.points);return new A(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){let{left:n,top:r,width:i,height:o,pathOffset:l,strokeOffset:a,strokeDiff:c}=this._calcDimensions();this.set({width:i,height:o,pathOffset:l,strokeOffset:a,strokeDiff:c}),e&&this.setPositionByOrigin(new A(n+i/2,r+o/2),le,le)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new A(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let l;if(Object.keys(e).some(a=>this.strokeUniform||this.constructor.layoutProperties.includes(a))){var n,r;let{width:a,height:c}=this._calcDimensions(e);l=new A((n=e.width)!==null&&n!==void 0?n:a,(r=e.height)!==null&&r!==void 0?r:c)}else{var i,o;l=new A((i=e.width)!==null&&i!==void 0?i:this.width,(o=e.height)!==null&&o!==void 0?o:this.height)}return l.multiply(new A(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,n){let r=this.initialized&&this[e]!==n,i=super._set(e,n);return this.exactBoundingBox&&r&&((e===Jt||e===En)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),i}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return x(x({},super.toObject(e)),{},{points:this.points.map(n=>{let{x:r,y:i}=n;return{x:r,y:i}})})}_toSVG(){let e=[],n=this.pathOffset.x,r=this.pathOffset.y,i=Ce.NUM_FRACTION_DIGITS;for(let o=0,l=this.points.length;o<l;o++)e.push(Ye(this.points[o].x-n,i),",",Ye(this.points[o].y-r,i)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){let n=this.points.length,r=this.pathOffset.x,i=this.pathOffset.y;if(n&&!isNaN(this.points[n-1].y)){e.beginPath(),e.moveTo(this.points[0].x-r,this.points[0].y-i);for(let o=0;o<n;o++){let l=this.points[o];e.lineTo(l.x-r,l.y-i)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static fromElement(e,n,r){return R(this,null,function*(){return new this(jU(e.getAttribute("points")),x(x({},Xe(ii(e,this.ATTRIBUTE_NAMES,r),VU)),n))})}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}};E(Tr,"ownDefaults",k1),E(Tr,"type","Polyline"),E(Tr,"layoutProperties",[Fa,La,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),E(Tr,"cacheProperties",[...ri,"points"]),E(Tr,"ATTRIBUTE_NAMES",[...Gi]),U.setClass(Tr),U.setSVGClass(Tr);var Ca=class extends Tr{isOpen(){return!1}};E(Ca,"ownDefaults",k1),E(Ca,"type","Polygon"),U.setClass(Ca),U.setSVGClass(Ca);var F1=["fontSize","fontWeight","fontFamily","fontStyle"],L1=["underline","overline","linethrough"],B1=[...F1,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],j1=[...B1,...L1,"textBackgroundColor","direction"],$U=[...F1,...L1,un,"strokeWidth",bt,"deltaY","textBackgroundColor"],UU={_reNewline:Xv,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:Pe,fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:Pe,pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2},xr="justify",df="justify-left",uc="justify-right",dc="justify-center",hf=class extends xt{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;let n=e===void 0?this.styles:{line:this.styles[e]};for(let r in n)for(let i in n[r])for(let o in n[r][i])return!1;return!0}styleHas(e,n){if(!this.styles||n!==void 0&&!this.styles[n])return!1;let r=n===void 0?this.styles:{0:this.styles[n]};for(let i in r)for(let o in r[i])if(r[i][o][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;let n=this.styles,r,i,o=0,l=!0,a=0;for(let c in n){r=0;for(let s in n[c]){let u=n[c][s]||{};o++,u[e]!==void 0?(i?u[e]!==i&&(l=!1):i=u[e],u[e]===this[e]&&delete u[e]):l=!1,Object.keys(u).length!==0?r++:delete n[c][s]}r===0&&delete n[c]}for(let c=0;c<this._textLines.length;c++)a+=this._textLines[c].length;l&&o===a&&(this[e]=i,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;let n=this.styles,r,i,o;for(i in n){for(o in r=n[i],r)delete r[o][e],Object.keys(r[o]).length===0&&delete r[o];Object.keys(r).length===0&&delete n[i]}}_extendStyles(e,n){let{lineIndex:r,charIndex:i}=this.get2DCursorLocation(e);this._getLineStyle(r)||this._setLineStyle(r);let o=tb(x(x({},this._getStyleDeclaration(r,i)),n),l=>l!==void 0);this._setStyleDeclaration(r,i,o)}getSelectionStyles(e,n,r){let i=[];for(let o=e;o<(n||e);o++)i.push(this.getStyleAtPosition(o,r));return i}getStyleAtPosition(e,n){let{lineIndex:r,charIndex:i}=this.get2DCursorLocation(e);return n?this.getCompleteStyleDeclaration(r,i):this._getStyleDeclaration(r,i)}setSelectionStyles(e,n,r){for(let i=n;i<(r||n);i++)this._extendStyles(i,e);this._forceClearCache=!0}_getStyleDeclaration(e,n){var r;let i=this.styles&&this.styles[e];return i&&(r=i[n])!==null&&r!==void 0?r:{}}getCompleteStyleDeclaration(e,n){return x(x({},Qo(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,n))}_setStyleDeclaration(e,n,r){this.styles[e][n]=r}_deleteStyleDeclaration(e,n){delete this.styles[e][n]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}};E(hf,"_styleProperties",$U);var HU=/  +/g,GU=/"/g;function uv(t,e,n,r,i){return"		".concat(function(o,l){let{left:a,top:c,width:s,height:u}=l,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ce.NUM_FRACTION_DIGITS,h=pc(bt,o,!1),[f,p,g,y]=[a,c,s,u].map(b=>Ye(b,d));return"<rect ".concat(h,' x="').concat(f,'" y="').concat(p,'" width="').concat(g,'" height="').concat(y,'"></rect>')}(t,{left:e,top:n,width:r,height:i}),`
`)}var zU=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"],dv,jn=class t extends hf{static getDefaults(){return x(x({},super.getDefaults()),t.ownDefaults)}constructor(e,n){super(),E(this,"__charBounds",[]),Object.assign(this,t.ownDefaults),this.setOptions(n),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){let e=this.path;e&&(e.segmentsInfo=fb(e.path))}_splitText(){let e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(xr)&&this.enlargeSpaces()}enlargeSpaces(){let e,n,r,i,o,l,a;for(let c=0,s=this._textLines.length;c<s;c++)if((this.textAlign===xr||c!==s-1&&!this.isEndOfWrapping(c))&&(i=0,o=this._textLines[c],n=this.getLineWidth(c),n<this.width&&(a=this.textLines[c].match(this._reSpacesAndTabs)))){r=a.length,e=(this.width-n)/r;for(let u=0;u<=o.length;u++)l=this.__charBounds[c][u],this._reSpaceAndTab.test(o[u])?(l.width+=e,l.kernedWidth+=e,l.left+=i,i+=e):l.left+=i}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,n){let r=n?this._unwrappedTextLines:this._textLines,i;for(i=0;i<r.length;i++){if(e<=r[i].length)return{lineIndex:i,charIndex:e};e-=r[i].length+this.missingNewlineOffset(i,n)}return{lineIndex:i-1,charIndex:r[i-1].length<e?r[i-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){let e=super._getCacheCanvasDimensions(),n=this.fontSize;return e.width+=n*e.zoomX,e.height+=n*e.zoomY,e}_render(e){let n=this.path;n&&!n.isNotVisible()&&n._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===un?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,n,r){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case le:e.textBaseline="middle";break;case"ascender":e.textBaseline=ln;break;case"descender":e.textBaseline=vv}e.font=this._getFontDeclaration(n,r)}calcTextWidth(){let e=this.getLineWidth(0);for(let n=1,r=this._textLines.length;n<r;n++){let i=this.getLineWidth(n);i>e&&(e=i)}return e}_renderTextLine(e,n,r,i,o,l){this._renderChars(e,n,r,i,o,l)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;let n=e.fillStyle,r=this._getLeftOffset(),i=this._getTopOffset();for(let o=0,l=this._textLines.length;o<l;o++){let a=this.getHeightOfLine(o);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",o)){i+=a;continue}let c=this._textLines[o].length,s=this._getLineLeftOffset(o),u,d,h=0,f=0,p=this.getValueOfPropertyAt(o,0,"textBackgroundColor");for(let g=0;g<c;g++){let y=this.__charBounds[o][g];d=this.getValueOfPropertyAt(o,g,"textBackgroundColor"),this.path?(e.save(),e.translate(y.renderLeft,y.renderTop),e.rotate(y.angle),e.fillStyle=d,d&&e.fillRect(-y.width/2,-a/this.lineHeight*(1-this._fontSizeFraction),y.width,a/this.lineHeight),e.restore()):d!==p?(u=r+s+f,this.direction==="rtl"&&(u=this.width-u-h),e.fillStyle=p,p&&e.fillRect(u,i,h,a/this.lineHeight),f=y.left,h=y.width,p=d):h+=y.kernedWidth}d&&!this.path&&(u=r+s+f,this.direction==="rtl"&&(u=this.width-u-h),e.fillStyle=d,e.fillRect(u,i,h,a/this.lineHeight)),i+=a}e.fillStyle=n,this._removeShadow(e)}_measureChar(e,n,r,i){let o=sc.getFontCache(n),l=this._getFontDeclaration(n),a=r+e,c=r&&l===this._getFontDeclaration(i),s=n.fontSize/this.CACHE_FONT_SIZE,u,d,h,f;if(r&&o[r]!==void 0&&(h=o[r]),o[e]!==void 0&&(f=u=o[e]),c&&o[a]!==void 0&&(d=o[a],f=d-h),u===void 0||h===void 0||d===void 0){let p=function(){return dv||(dv=cr({width:0,height:0}).getContext("2d")),dv}();this._setTextStyles(p,n,!0),u===void 0&&(f=u=p.measureText(e).width,o[e]=u),h===void 0&&c&&r&&(h=p.measureText(r).width,o[r]=h),c&&d===void 0&&(d=p.measureText(a).width,o[a]=d,f=d-h)}return{width:u*s,kernedWidth:f*s}}getHeightOfChar(e,n){return this.getValueOfPropertyAt(e,n,"fontSize")}measureLine(e){let n=this._measureLine(e);return this.charSpacing!==0&&(n.width-=this._getWidthOfCharSpacing()),n.width<0&&(n.width=0),n}_measureLine(e){let n,r,i=0,o=this.pathSide===lt,l=this.path,a=this._textLines[e],c=a.length,s=new Array(c);this.__charBounds[e]=s;for(let u=0;u<c;u++){let d=a[u];r=this._getGraphemeBox(d,e,u,n),s[u]=r,i+=r.kernedWidth,n=d}if(s[c]={left:r?r.left+r.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},l&&l.segmentsInfo){let u=0,d=l.segmentsInfo[l.segmentsInfo.length-1].length;switch(this.textAlign){case Pe:u=o?d-i:0;break;case le:u=(d-i)/2;break;case lt:u=o?0:d-i}u+=this.pathStartOffset*(o?-1:1);for(let h=o?c-1:0;o?h>=0:h<c;o?h--:h++)r=s[h],u>d?u%=d:u<0&&(u+=d),this._setGraphemeOnPath(u,r),u+=r.kernedWidth}return{width:i,numOfSpaces:0}}_setGraphemeOnPath(e,n){let r=e+n.kernedWidth/2,i=this.path,o=C1(i.path,r,i.segmentsInfo);n.renderLeft=o.x-i.pathOffset.x,n.renderTop=o.y-i.pathOffset.y,n.angle=o.angle+(this.pathSide===lt?Math.PI:0)}_getGraphemeBox(e,n,r,i,o){let l=this.getCompleteStyleDeclaration(n,r),a=i?this.getCompleteStyleDeclaration(n,r-1):{},c=this._measureChar(e,l,i,a),s,u=c.kernedWidth,d=c.width;this.charSpacing!==0&&(s=this._getWidthOfCharSpacing(),d+=s,u+=s);let h={width:d,left:0,height:l.fontSize,kernedWidth:u,deltaY:l.deltaY};if(r>0&&!o){let f=this.__charBounds[n][r-1];h.left=f.left+f.width+c.kernedWidth-c.width}return h}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let n=this.getHeightOfChar(e,0);for(let r=1,i=this._textLines[e].length;r<i;r++)n=Math.max(this.getHeightOfChar(e,r),n);return this.__lineHeights[e]=n*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,n=0;for(let r=0,i=this._textLines.length;r<i;r++)e=this.getHeightOfLine(r),n+=r===i-1?e/this.lineHeight:e;return n}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,n){e.save();let r=0,i=this._getLeftOffset(),o=this._getTopOffset();for(let l=0,a=this._textLines.length;l<a;l++){let c=this.getHeightOfLine(l),s=c/this.lineHeight,u=this._getLineLeftOffset(l);this._renderTextLine(n,e,this._textLines[l],i+u,o+r+s,l),r+=c}e.restore()}_renderTextFill(e){(this.fill||this.styleHas(bt))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,n,r,i,o,l){let a=this.getHeightOfLine(l),c=this.textAlign.includes(xr),s=this.path,u=!c&&this.charSpacing===0&&this.isEmptyStyles(l)&&!s,d=this.direction==="ltr",h=this.direction==="ltr"?1:-1,f=n.direction,p,g,y,b,v,_="",I=0;if(n.save(),f!==this.direction&&(n.canvas.setAttribute("dir",d?"ltr":"rtl"),n.direction=d?"ltr":"rtl",n.textAlign=d?Pe:lt),o-=a*this._fontSizeFraction/this.lineHeight,u)return this._renderChar(e,n,l,0,r.join(""),i,o),void n.restore();for(let k=0,V=r.length-1;k<=V;k++)b=k===V||this.charSpacing||s,_+=r[k],y=this.__charBounds[l][k],I===0?(i+=h*(y.kernedWidth-y.width),I+=y.width):I+=y.kernedWidth,c&&!b&&this._reSpaceAndTab.test(r[k])&&(b=!0),b||(p=p||this.getCompleteStyleDeclaration(l,k),g=this.getCompleteStyleDeclaration(l,k+1),b=If(p,g,!1)),b&&(s?(n.save(),n.translate(y.renderLeft,y.renderTop),n.rotate(y.angle),this._renderChar(e,n,l,k,_,-I/2,0),n.restore()):(v=i,this._renderChar(e,n,l,k,_,v,o)),_="",p=g,i+=h*I,I=0);n.restore()}_applyPatternGradientTransformText(e){let n=this.width+this.strokeWidth,r=this.height+this.strokeWidth,i=cr({width:n,height:r}),o=i.getContext("2d");return i.width=n,i.height=r,o.beginPath(),o.moveTo(0,0),o.lineTo(n,0),o.lineTo(n,r),o.lineTo(0,r),o.closePath(),o.translate(n/2,r/2),o.fillStyle=e.toLive(o),this._applyPatternGradientTransform(o,e),o.fill(),o.createPattern(i,"no-repeat")}handleFiller(e,n,r){let i,o;return $n(r)?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?(i=-this.width/2,o=-this.height/2,e.translate(i,o),e[n]=this._applyPatternGradientTransformText(r),{offsetX:i,offsetY:o}):(e[n]=r.toLive(e),this._applyPatternGradientTransform(e,r)):(e[n]=r,{offsetX:0,offsetY:0})}_setStrokeStyles(e,n){let{stroke:r,strokeWidth:i}=n;return e.lineWidth=i,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",r)}_setFillStyles(e,n){let{fill:r}=n;return this.handleFiller(e,"fillStyle",r)}_renderChar(e,n,r,i,o,l,a){let c=this._getStyleDeclaration(r,i),s=this.getCompleteStyleDeclaration(r,i),u=e==="fillText"&&s.fill,d=e==="strokeText"&&s.stroke&&s.strokeWidth;if(d||u){if(n.save(),n.font=this._getFontDeclaration(s),c.textBackgroundColor&&this._removeShadow(n),c.deltaY&&(a+=c.deltaY),u){let h=this._setFillStyles(n,s);n.fillText(o,l-h.offsetX,a-h.offsetY)}if(d){let h=this._setStrokeStyles(n,s);n.strokeText(o,l-h.offsetX,a-h.offsetY)}n.restore()}}setSuperscript(e,n){this._setScript(e,n,this.superscript)}setSubscript(e,n){this._setScript(e,n,this.subscript)}_setScript(e,n,r){let i=this.get2DCursorLocation(e,!0),o=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"fontSize"),l=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"deltaY"),a={fontSize:o*r.size,deltaY:l+o*r.baseline};this.setSelectionStyles(a,e,n)}_getLineLeftOffset(e){let n=this.getLineWidth(e),r=this.width-n,i=this.textAlign,o=this.direction,l=this.isEndOfWrapping(e),a=0;return i===xr||i===dc&&!l||i===uc&&!l||i===df&&!l?0:(i===le&&(a=r/2),i===lt&&(a=r),i===dc&&(a=r/2),i===uc&&(a=r),o==="rtl"&&(i===lt||i===xr||i===uc?a=0:i===Pe||i===df?a=-r:i!==le&&i!==dc||(a=-r/2)),a)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];let{width:n}=this.measureLine(e);return this.__lineWidths[e]=n,n}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,n,r){var i;return(i=this._getStyleDeclaration(e,n)[r])!==null&&i!==void 0?i:this[r]}_renderTextDecoration(e,n){if(!this[n]&&!this.styleHas(n))return;let r=this._getTopOffset(),i=this._getLeftOffset(),o=this.path,l=this._getWidthOfCharSpacing(),a=this.offsets[n];for(let c=0,s=this._textLines.length;c<s;c++){let u=this.getHeightOfLine(c);if(!this[n]&&!this.styleHas(n,c)){r+=u;continue}let d=this._textLines[c],h=u/this.lineHeight,f=this._getLineLeftOffset(c),p,g,y=0,b=0,v=this.getValueOfPropertyAt(c,0,n),_=this.getValueOfPropertyAt(c,0,bt),I=r+h*(1-this._fontSizeFraction),k=this.getHeightOfChar(c,0),V=this.getValueOfPropertyAt(c,0,"deltaY");for(let j=0,ge=d.length;j<ge;j++){let Z=this.__charBounds[c][j];p=this.getValueOfPropertyAt(c,j,n),g=this.getValueOfPropertyAt(c,j,bt);let Be=this.getHeightOfChar(c,j),me=this.getValueOfPropertyAt(c,j,"deltaY");if(o&&p&&g)e.save(),e.fillStyle=_,e.translate(Z.renderLeft,Z.renderTop),e.rotate(Z.angle),e.fillRect(-Z.kernedWidth/2,a*Be+me,Z.kernedWidth,this.fontSize/15),e.restore();else if((p!==v||g!==_||Be!==k||me!==V)&&b>0){let we=i+f+y;this.direction==="rtl"&&(we=this.width-we-b),v&&_&&(e.fillStyle=_,e.fillRect(we,I+a*k+V,b,this.fontSize/15)),y=Z.left,b=Z.width,v=p,_=g,k=Be,V=me}else b+=Z.kernedWidth}let G=i+f+y;this.direction==="rtl"&&(G=this.width-G-b),e.fillStyle=g,p&&g&&e.fillRect(G,I+a*k+V,b-l,this.fontSize/15),r+=u}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:n=this.fontStyle,fontWeight:r=this.fontWeight,fontSize:i=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0,l=e.includes("'")||e.includes('"')||e.includes(",")||t.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[n,r,"".concat(o?this.CACHE_FONT_SIZE:i,"px"),l].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return Df(e)}_splitTextIntoLines(e){let n=e.split(this._reNewline),r=new Array(n.length),i=[`
`],o=[];for(let l=0;l<n.length;l++)r[l]=this.graphemeSplit(n[l]),o=o.concat(r[l],i);return o.pop(),{_unwrappedLines:r,lines:n,graphemeText:o,graphemeLines:r}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return x(x({},super.toObject([...j1,...e])),{},{styles:f1(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,n){let{textLayoutProperties:r}=this.constructor;super.set(e,n);let i=!1,o=!1;if(typeof e=="object")for(let l in e)l==="path"&&this.setPathInfo(),i=i||r.includes(l),o=o||l==="path";else i=r.includes(e),o=e==="path";return o&&this.setPathInfo(),i&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static fromElement(e,n,r){return R(this,null,function*(){let i=ii(e,t.ATTRIBUTE_NAMES,r),o=x(x({},n),i),{textAnchor:l=Pe,textDecoration:a="",dx:c=0,dy:s=0,top:u=0,left:d=0,fontSize:h=Yv,strokeWidth:f=1}=o,p=Xe(o,zU),g=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),x({left:d+c,top:u+s,underline:a.includes("underline"),overline:a.includes("overline"),linethrough:a.includes("line-through"),strokeWidth:0,fontSize:h},p)),y=g.getScaledHeight()/g.height,b=((g.height+g.strokeWidth)*g.lineHeight-g.height)*y,v=g.getScaledHeight()+b,_=0;return l===le&&(_=g.getScaledWidth()/2),l===lt&&(_=g.getScaledWidth()),g.set({left:g.left-_,top:g.top-(v-g.fontSize*(.07+g._fontSizeFraction))/g.lineHeight,strokeWidth:f}),g})}static fromObject(e){return this._fromObject(x(x({},e),{},{styles:p1(e.styles||{},e.text)}),{extraParam:"text"})}};E(jn,"textLayoutProperties",B1),E(jn,"cacheProperties",[...ri,...j1]),E(jn,"ownDefaults",UU),E(jn,"type","Text"),E(jn,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),E(jn,"ATTRIBUTE_NAMES",Gi.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),c1(jn,[class extends Zh{_toSVG(){let t=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(t.textTop,t.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(t){return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,noStyle:!0,withShadow:!0})}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(t){let{textBgRects:e,textSpans:n}=t,r=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'.concat(this.fontFamily.replace(GU,"'"),'" '):"",this.fontSize?'font-size="'.concat(this.fontSize,'" '):"",this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",r?'text-decoration="'.concat(r,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",n.join(""),`</text>
`]}_getSVGTextAndBg(t,e){let n=[],r=[],i,o=t;this.backgroundColor&&r.push(...uv(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let l=0,a=this._textLines.length;l<a;l++)i=this._getLineLeftOffset(l),this.direction==="rtl"&&(i+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",l))&&this._setSVGTextLineBg(r,l,e+i,o),this._setSVGTextLineText(n,l,e+i,o),o+=this.getHeightOfLine(l);return{textSpans:n,textBgRects:r}}_createTextCharSpan(t,e,n,r){let i=this.getSvgSpanStyles(e,t!==t.trim()||!!t.match(HU)),o=i?'style="'.concat(i,'"'):"",l=e.deltaY,a=l?' dy="'.concat(Ye(l,Ce.NUM_FRACTION_DIGITS),'" '):"";return'<tspan x="'.concat(Ye(n,Ce.NUM_FRACTION_DIGITS),'" y="').concat(Ye(r,Ce.NUM_FRACTION_DIGITS),'" ').concat(a).concat(o,">").concat(h1(t),"</tspan>")}_setSVGTextLineText(t,e,n,r){let i=this.getHeightOfLine(e),o=this.textAlign.includes(xr),l=this._textLines[e],a,c,s,u,d,h="",f=0;r+=i*(1-this._fontSizeFraction)/this.lineHeight;for(let p=0,g=l.length-1;p<=g;p++)d=p===g||this.charSpacing,h+=l[p],s=this.__charBounds[e][p],f===0?(n+=s.kernedWidth-s.width,f+=s.width):f+=s.kernedWidth,o&&!d&&this._reSpaceAndTab.test(l[p])&&(d=!0),d||(a=a||this.getCompleteStyleDeclaration(e,p),c=this.getCompleteStyleDeclaration(e,p+1),d=If(a,c,!0)),d&&(u=this._getStyleDeclaration(e,p),t.push(this._createTextCharSpan(h,u,n,r)),h="",a=c,this.direction==="rtl"?n-=f:n+=f,f=0)}_setSVGTextLineBg(t,e,n,r){let i=this._textLines[e],o=this.getHeightOfLine(e)/this.lineHeight,l,a=0,c=0,s=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let u=0;u<i.length;u++){let{left:d,width:h,kernedWidth:f}=this.__charBounds[e][u];l=this.getValueOfPropertyAt(e,u,"textBackgroundColor"),l!==s?(s&&t.push(...uv(s,n+c,r,a,o)),c=d,a=h,s=l):a+=f}l&&t.push(...uv(s,n+c,r,a,o))}_getSVGLineTopOffset(t){let e,n=0;for(e=0;e<t;e++)n+=this.getHeightOfLine(e);let r=this.getHeightOfLine(e);return{lineTop:n,offset:(this._fontSizeMult-this._fontSizeFraction)*r/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(t){return"".concat(super.getSvgStyles(t)," white-space: pre;")}getSvgSpanStyles(t,e){let{fontFamily:n,strokeWidth:r,stroke:i,fill:o,fontSize:l,fontStyle:a,fontWeight:c,deltaY:s}=t,u=this.getSvgTextDecoration(t);return[i?pc(un,i):"",r?"stroke-width: ".concat(r,"; "):"",n?"font-family: ".concat(n.includes("'")||n.includes('"')?n:"'".concat(n,"'"),"; "):"",l?"font-size: ".concat(l,"px; "):"",a?"font-style: ".concat(a,"; "):"",c?"font-weight: ".concat(c,"; "):"",u&&"text-decoration: ".concat(u,"; "),o?pc(bt,o):"",s?"baseline-shift: ".concat(-s,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(t){return["overline","underline","line-through"].filter(e=>t[e.replace("-","")]).join(" ")}}]),U.setClass(jn),U.setSVGClass(jn);var jv=class{constructor(e){E(this,"target",void 0),E(this,"__mouseDownInPlace",!1),E(this,"__dragStartFired",!1),E(this,"__isDraggingOver",!1),E(this,"__dragStartSelection",void 0),E(this,"__dragImageDisposer",void 0),E(this,"_dispose",void 0),this.target=e;let n=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{n.forEach(r=>r()),this._dispose=void 0}}isPointerOverSelection(e){let n=this.target,r=n.getSelectionStartFromPointer(e);return n.isEditing&&r>=n.selectionStart&&r<=n.selectionEnd&&n.selectionStart<n.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){let n=this.isActive();return n&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,n}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,n){var r;let{selectionStart:i,selectionEnd:o}=n,l=this.target,a=l.canvas,c=new A(l.flipX?-1:1,l.flipY?-1:1),s=l._getCursorBoundaries(i),u=new A(s.left+s.leftOffset,s.top+s.topOffset).multiply(c).transform(l.calcTransformMatrix()),d=a.getScenePoint(e).subtract(u),h=l.getCanvasRetinaScaling(),f=l.getBoundingRect(),p=u.subtract(new A(f.left,f.top)),g=a.viewportTransform,y=p.add(d).transform(g,!0),b=l.backgroundColor,v=ub(l.styles);l.backgroundColor="";let _={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};l.setSelectionStyles(_,0,i),l.setSelectionStyles(_,o,l.text.length),l.dirty=!0;let I=l.toCanvasElement({enableRetinaScaling:a.enableRetinaScaling,viewportTransform:!0});l.backgroundColor=b,l.styles=v,l.dirty=!0,cf(I,{position:"fixed",left:"".concat(-I.width,"px"),border:cn,width:"".concat(I.width/h,"px"),height:"".concat(I.height/h,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{I.remove()},ir(e.target||this.target.hiddenTextarea).body.appendChild(I),(r=e.dataTransfer)===null||r===void 0||r.setDragImage(I,y.x,y.y)}onDragStart(e){this.__dragStartFired=!0;let n=this.target,r=this.isActive();if(r&&e.dataTransfer){let i=this.__dragStartSelection={selectionStart:n.selectionStart,selectionEnd:n.selectionEnd},o=n._text.slice(i.selectionStart,i.selectionEnd).join(""),l=x({text:n.text,value:o},i);e.dataTransfer.setData("text/plain",o),e.dataTransfer.setData("application/fabric",JSON.stringify({value:o,styles:n.getSelectionStyles(i.selectionStart,i.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,l)}return n.abortCursorAnimation(),r}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){let n=this.target.getSelectionStartFromPointer(e),r=this.__dragStartSelection;return n<r.selectionStart||n>r.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:n}=e,r=this.targetCanDrop(n);!this.__isDraggingOver&&r&&(this.__isDraggingOver=!0)}dragOverHandler(e){let{e:n}=e,r=this.targetCanDrop(n);!this.__isDraggingOver&&r?this.__isDraggingOver=!0:this.__isDraggingOver&&!r&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(n.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var n;let{e:r}=e,i=r.defaultPrevented;this.__isDraggingOver=!1,r.preventDefault();let o=(n=r.dataTransfer)===null||n===void 0?void 0:n.getData("text/plain");if(o&&!i){let l=this.target,a=l.canvas,c=l.getSelectionStartFromPointer(r),{styles:s}=r.dataTransfer.types.includes("application/fabric")?JSON.parse(r.dataTransfer.getData("application/fabric")):{},u=o[Math.max(0,o.length-1)],d=0;if(this.__dragStartSelection){let h=this.__dragStartSelection.selectionStart,f=this.__dragStartSelection.selectionEnd;c>h&&c<=f?c=h:c>f&&(c-=f-h),l.removeChars(h,f),delete this.__dragStartSelection}l._reNewline.test(u)&&(l._reNewline.test(l._text[c])||c===l._text.length)&&(o=o.trimEnd()),e.didDrop=!0,e.dropTarget=l,l.insertChars(o,s,c),a.setActiveObject(l),l.enterEditing(r),l.selectionStart=Math.min(c+d,l._text.length),l.selectionEnd=Math.min(l.selectionStart+o.length,l._text.length),l.hiddenTextarea.value=l.text,l._updateTextarea(),l.hiddenTextarea.focus(),l.fire(Gh,{index:c+d,action:"drop"}),a.fire("text:changed",{target:l}),a.contextTopDirty=!0,a.requestRenderAll()}}dragEndHandler(e){let{e:n}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var r;let i=this.target,o=this.target.canvas,{selectionStart:l,selectionEnd:a}=this.__dragStartSelection,c=((r=n.dataTransfer)===null||r===void 0?void 0:r.dropEffect)||cn;c===cn?(i.selectionStart=l,i.selectionEnd=a,i._updateTextarea(),i.hiddenTextarea.focus()):(i.clearContextTop(),c==="move"&&(i.removeChars(l,a),i.selectionStart=i.selectionEnd=l,i.hiddenTextarea&&(i.hiddenTextarea.value=i.text),i._updateTextarea(),i.fire(Gh,{index:l,action:"dragend"}),o.fire("text:changed",{target:i}),o.requestRenderAll()),i.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}},vD=/[ \n\.,;!\?\-]/,Vv=class extends jn{constructor(){super(...arguments),E(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:n,duration:r,delay:i,onComplete:o}=e;return ab({startValue:this._currentCursorOpacity,endValue:n,duration:r,delay:i,onComplete:o,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:l=>{this._currentCursorOpacity=l,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(n=>{n&&!n.isDone()&&(e=!0,n.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let n=0,r=e-1;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)n++,r--;for(;/\S/.test(this._text[r])&&r>-1;)n++,r--;return e-n}findWordBoundaryRight(e){let n=0,r=e;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)n++,r++;for(;/\S/.test(this._text[r])&&r<this._text.length;)n++,r++;return e+n}findLineBoundaryLeft(e){let n=0,r=e-1;for(;!/\n/.test(this._text[r])&&r>-1;)n++,r--;return e-n}findLineBoundaryRight(e){let n=0,r=e;for(;!/\n/.test(this._text[r])&&r<this._text.length;)n++,r++;return e+n}searchWordBoundary(e,n){let r=this._text,i=e>0&&this._reSpace.test(r[e])&&(n===-1||!Xv.test(r[e-1]))?e-1:e,o=r[i];for(;i>0&&i<r.length&&!vD.test(o);)i+=n,o=r[i];return n===-1&&vD.test(o)&&i++,i}selectWord(e){e=e||this.selectionStart;let n=this.searchWordBoundary(e,-1),r=Math.max(n,this.searchWordBoundary(e,1));this.selectionStart=n,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){e=e||this.selectionStart;let n=this.findLineBoundaryLeft(e),r=this.findLineBoundaryRight(e);return this.selectionStart=n,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;let n=this.hiddenTextarea;ir(n).activeElement!==n&&n.focus();let r=this.getSelectionStartFromPointer(e),i=this.selectionStart,o=this.selectionEnd;(r===this.__selectionStartOnMouseDown&&i!==o||i!==r&&o!==r)&&(r>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=r):(this.selectionStart=r,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===i&&this.selectionEnd===o||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,n,r){let i=r.slice(0,e),o=this.graphemeSplit(i).length;if(e===n)return{selectionStart:o,selectionEnd:o};let l=r.slice(e,n);return{selectionStart:o,selectionEnd:o+this.graphemeSplit(l).length}}fromGraphemeToStringSelection(e,n,r){let i=r.slice(0,e).join("").length;return e===n?{selectionStart:i,selectionEnd:i}:{selectionStart:i,selectionEnd:i+r.slice(e,n).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){let e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};let e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();let n=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=n.selectionEnd,this.inCompositionMode||(this.selectionStart=n.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){let e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};let e=this.inCompositionMode?this.compositionStart:this.selectionStart,n=this._getCursorBoundaries(e),r=this.get2DCursorLocation(e),i=r.lineIndex,o=r.charIndex,l=this.getValueOfPropertyAt(i,o,"fontSize")*this.lineHeight,a=n.leftOffset,c=this.getCanvasRetinaScaling(),s=this.canvas.upperCanvasEl,u=s.width/c,d=s.height/c,h=u-l,f=d-l,p=new A(n.left+a,n.top+n.topOffset+l).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new A(s.clientWidth/u,s.clientHeight/d));return p.x<0&&(p.x=0),p.x>h&&(p.x=h),p.y<0&&(p.y=0),p.y>f&&(p.y=f),p.x+=this.canvas._offset.left,p.y+=this.canvas._offset.top,{left:"".concat(p.x,"px"),top:"".concat(p.y,"px"),fontSize:"".concat(l,"px"),charHeight:l}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){let e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){let e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(zh),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(let e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,n){let{lineIndex:r,charIndex:i}=this.get2DCursorLocation(e,!0),{lineIndex:o,charIndex:l}=this.get2DCursorLocation(n,!0);if(r!==o){if(this.styles[r])for(let a=i;a<this._unwrappedTextLines[r].length;a++)delete this.styles[r][a];if(this.styles[o])for(let a=l;a<this._unwrappedTextLines[o].length;a++){let c=this.styles[o][a];c&&(this.styles[r]||(this.styles[r]={}),this.styles[r][i+a-l]=c)}for(let a=r+1;a<=o;a++)delete this.styles[a];this.shiftLineStyles(o,r-o)}else if(this.styles[r]){let a=this.styles[r],c=l-i;for(let s=i;s<l;s++)delete a[s];for(let s in this.styles[r]){let u=parseInt(s,10);u>=l&&(a[u-c]=a[s],delete a[s])}}}shiftLineStyles(e,n){let r=Object.assign({},this.styles);for(let i in this.styles){let o=parseInt(i,10);o>e&&(this.styles[o+n]=r[o],r[o-n]||delete this.styles[o])}}insertNewlineStyleObject(e,n,r,i){let o={},l=this._unwrappedTextLines[e].length,a=l===n,c=!1;r||(r=1),this.shiftLineStyles(e,r);let s=this.styles[e]?this.styles[e][n===0?n:n-1]:void 0;for(let d in this.styles[e]){let h=parseInt(d,10);h>=n&&(c=!0,o[h-n]=this.styles[e][d],a&&n===0||delete this.styles[e][d])}let u=!1;for(c&&!a&&(this.styles[e+r]=o,u=!0),(u||l>n)&&r--;r>0;)i&&i[r-1]?this.styles[e+r]={0:x({},i[r-1])}:s?this.styles[e+r]={0:x({},s)}:delete this.styles[e+r],r--;this._forceClearCache=!0}insertCharStyleObject(e,n,r,i){this.styles||(this.styles={});let o=this.styles[e],l=o?x({},o):{};r||(r=1);for(let c in l){let s=parseInt(c,10);s>=n&&(o[s+r]=l[s],l[s-r]||delete o[s])}if(this._forceClearCache=!0,i){for(;r--;)Object.keys(i[r]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][n+r]=x({},i[r]));return}if(!o)return;let a=o[n?n-1:1];for(;a&&r--;)this.styles[e][n+r]=x({},a)}insertNewStyleBlock(e,n,r){let i=this.get2DCursorLocation(n,!0),o=[0],l,a=0;for(let c=0;c<e.length;c++)e[c]===`
`?(a++,o[a]=0):o[a]++;for(o[0]>0&&(this.insertCharStyleObject(i.lineIndex,i.charIndex,o[0],r),r=r&&r.slice(o[0]+1)),a&&this.insertNewlineStyleObject(i.lineIndex,i.charIndex+o[0],a),l=1;l<a;l++)o[l]>0?this.insertCharStyleObject(i.lineIndex+l,0,o[l],r):r&&this.styles[i.lineIndex+l]&&r[0]&&(this.styles[i.lineIndex+l][0]=r[0]),r=r&&r.slice(o[l]+1);o[l]>0&&this.insertCharStyleObject(i.lineIndex+l,0,o[l],r)}removeChars(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,n),this._text.splice(e,n-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r;i>r&&this.removeStyleFromTo(r,i);let o=this.graphemeSplit(e);this.insertNewStyleBlock(o,r,n),this._text=[...this._text.slice(0,r),...o,...this._text.slice(i)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,n,r){r<=e?(n===e?this._selectionDirection=Pe:this._selectionDirection===lt&&(this._selectionDirection=Pe,this.selectionEnd=e),this.selectionStart=r):r>e&&r<n?this._selectionDirection===lt?this.selectionEnd=r:this.selectionStart=r:(n===e?this._selectionDirection=lt:this._selectionDirection===Pe&&(this._selectionDirection=lt,this.selectionStart=n),this.selectionEnd=r)}},$v=class extends Vv{initHiddenTextarea(){let e=this.canvas&&ir(this.canvas.getElement())||ka(),n=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(l=>{let[a,c]=l;return n.setAttribute(a,c)});let{top:r,left:i,fontSize:o}=this._calcTextareaPosition();n.style.cssText="position: absolute; top: ".concat(r,"; left: ").concat(i,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(o,";"),(this.hiddenTextareaContainer||e.body).appendChild(n),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(l=>{let[a,c]=l;return n.addEventListener(a,this[c].bind(this))}),this.hiddenTextarea=n}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;let n=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in n)this[n[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){let n=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;let r=()=>{this.updateFromTextArea(),this.fire(Gh),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void r();let i=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,o=this._text.length,l=i.length,a=this.selectionStart,c=this.selectionEnd,s=a!==c,u,d,h,f,p=l-o,g=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),y=a>g.selectionStart;s?(d=this._text.slice(a,c),p+=c-a):l<o&&(d=y?this._text.slice(c+p,c):this._text.slice(a,a-p));let b=i.slice(g.selectionEnd-p,g.selectionEnd);if(d&&d.length&&(b.length&&(u=this.getSelectionStyles(a,a+1,!1),u=b.map(()=>u[0])),s?(h=a,f=c):y?(h=c-d.length,f=c):(h=c,f=c+d.length),this.removeStyleFromTo(h,f)),b.length){let{copyPasteData:v}=Cr();n&&b.join("")===v.copiedText&&!Ce.disableStyleCopyPaste&&(u=v.copiedTextStyle),this.insertNewStyleBlock(b,a,u)}r()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:n}=e,{selectionStart:r,selectionEnd:i}=n;this.compositionStart=r,this.compositionEnd=i,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;let{copyPasteData:e}=Cr();e.copiedText=this.getSelectedText(),Ce.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,n){let r,i=this._getLineLeftOffset(e);return n>0&&(r=this.__charBounds[e][n-1],i+=r.left+r.width),i}getDownCursorOffset(e,n){let r=this._getSelectionForOffset(e,n),i=this.get2DCursorLocation(r),o=i.lineIndex;if(o===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-r;let l=i.charIndex,a=this._getWidthBeforeCursor(o,l),c=this._getIndexOnLine(o+1,a);return this._textLines[o].slice(l).length+c+1+this.missingNewlineOffset(o)}_getSelectionForOffset(e,n){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&n?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,n){let r=this._getSelectionForOffset(e,n),i=this.get2DCursorLocation(r),o=i.lineIndex;if(o===0||e.metaKey||e.keyCode===33)return-r;let l=i.charIndex,a=this._getWidthBeforeCursor(o,l),c=this._getIndexOnLine(o-1,a),s=this._textLines[o].slice(0,l),u=this.missingNewlineOffset(o-1);return-this._textLines[o-1].length+c-s.length+(1-u)}_getIndexOnLine(e,n){let r=this._textLines[e],i,o,l=this._getLineLeftOffset(e),a=0;for(let c=0,s=r.length;c<s;c++)if(i=this.__charBounds[e][c].width,l+=i,l>n){o=!0;let u=l-i,d=l,h=Math.abs(u-n);a=Math.abs(d-n)<h?c:c-1;break}return o||(a=r.length-1),a}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,n){let r=this["get".concat(e,"CursorOffset")](n,this._selectionDirection===lt);if(n.shiftKey?this.moveCursorWithShift(r):this.moveCursorWithoutShift(r),r!==0){let i=this.text.length;this.selectionStart=Ko(0,this.selectionStart,i),this.selectionEnd=Ko(0,this.selectionEnd,i),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){let n=this._selectionDirection===Pe?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,n),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,n,r){let i;if(e.altKey)i=this["findWordBoundary".concat(r)](this[n]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[n]+=r==="Left"?-1:1,!0;i=this["findLineBoundary".concat(r)](this[n])}return i!==void 0&&this[n]!==i&&(this[n]=i,!0)}_moveLeft(e,n){return this._move(e,n,"Left")}_moveRight(e,n){return this._move(e,n,"Right")}moveCursorLeftWithoutShift(e){let n=!0;return this._selectionDirection=Pe,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(n=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,n}moveCursorLeftWithShift(e){return this._selectionDirection===lt&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=Pe,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,n){let r="moveCursor".concat(e).concat(n.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[r](n)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===Pe&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=lt,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let n=!0;return this._selectionDirection=lt,this.selectionStart===this.selectionEnd?(n=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,n}},hv=t=>!!t.button,Uv=class extends $v{constructor(){super(...arguments),E(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler),this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown),this.draggableTextDelegate=new jv(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}onMouseDown(e){if(!this.canvas)return;this.__newClickTime=+new Date;let n=e.pointer;this.isTripleClick(n)&&(this.fire("tripleclick",e),_v(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=n,this.__lastSelected=this.selected&&!this.getActiveControl()}isTripleClick(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y}doubleClickHandler(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))}tripleClickHandler(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))}_mouseDownHandler(e){let{e:n}=e;this.canvas&&this.editable&&!hv(n)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(n)||(this.canvas.textEditingManager.register(this),this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(n)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())))}_mouseDownHandlerBefore(e){let{e:n}=e;this.canvas&&this.editable&&!hv(n)&&(this.selected=this===this.canvas._activeObject)}mouseUpHandler(e){let{e:n,transform:r}=e,i=this.draggableTextDelegate.end(n);if(this.canvas){this.canvas.textEditingManager.unregister(this);let o=this.canvas._activeObject;if(o&&o!==this)return}!this.editable||this.group&&!this.group.interactive||r&&r.actionPerformed||hv(n)||i||(this.__lastSelected&&!this.getActiveControl()?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(n),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0)}setCursorByClick(e){let n=this.getSelectionStartFromPointer(e),r=this.selectionStart,i=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(r,i,n):(this.selectionStart=n,this.selectionEnd=n),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){let n=this.canvas.getScenePoint(e).transform(xn(this.calcTransformMatrix())).add(new A(-this._getLeftOffset(),-this._getTopOffset())),r=0,i=0,o=0;for(let s=0;s<this._textLines.length&&r<=n.y;s++)r+=this.getHeightOfLine(s),o=s,s>0&&(i+=this._textLines[s-1].length+this.missingNewlineOffset(s-1));let l=Math.abs(this._getLineLeftOffset(o)),a=this._textLines[o].length,c=this.__charBounds[o];for(let s=0;s<a;s++){let u=l+c[s].kernedWidth;if(n.x<=u){Math.abs(n.x-u)<=Math.abs(n.x-l)&&i++;break}l=u,i++}return Math.min(this.flipX?a-i:i,this._text.length)}},Rh="moveCursorUp",kh="moveCursorDown",Fh="moveCursorLeft",Lh="moveCursorRight",Bh="exitEditing",WU=x({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:Bh,27:Bh,33:Rh,34:kh,35:Lh,36:Fh,37:Fh,38:Rh,39:Lh,40:kh},keysMapRtl:{9:Bh,27:Bh,33:Rh,34:kh,35:Fh,36:Lh,37:Lh,38:Rh,39:Fh,40:kh},ctrlKeysMapDown:{65:"selectAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1}),Fi=class t extends Uv{static getDefaults(){return x(x({},super.getDefaults()),t.ownDefaults)}get type(){let e=super.type;return e==="itext"?"i-text":e}constructor(e,n){super(e,x(x({},t.ownDefaults),n)),this.initBehavior()}_set(e,n){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=n,this):(e==="canvas"&&(this.canvas instanceof Ra&&this.canvas.textEditingManager.remove(this),n instanceof Ra&&n.textEditingManager.add(this)),super._set(e,n))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,n){this[e]!==n&&(this._fireSelectionChanged(),this[e]=n),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,r=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,n,r)}setSelectionStyles(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,n,r)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,n=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,n)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){let n=this.isEditing;this.isEditing=!1;let r=super.toCanvasElement(e);return this.isEditing=n,r}renderCursorOrSelection(){if(!this.isEditing)return;let e=this.clearContextTop(!0);if(!e)return;let n=this._getCursorBoundaries();this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(e,n):this.renderCursor(e,n),this.canvas.contextTopDirty=!0,e.restore()}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,n=arguments.length>1?arguments[1]:void 0,r=this._getLeftOffset(),i=this._getTopOffset(),o=this._getCursorBoundariesOffsets(e,n);return{left:r,top:i,leftOffset:o.left,topOffset:o.top}}_getCursorBoundariesOffsets(e,n){return n?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let n=0,r=0,{charIndex:i,lineIndex:o}=this.get2DCursorLocation(e);for(let s=0;s<o;s++)n+=this.getHeightOfLine(s);let l=this._getLineLeftOffset(o),a=this.__charBounds[o][i];a&&(r=a.left),this.charSpacing!==0&&i===this._textLines[o].length&&(r-=this._getWidthOfCharSpacing());let c={top:n,left:l+(r>0?r:0)};return this.direction==="rtl"&&(this.textAlign===lt||this.textAlign===xr||this.textAlign===uc?c.left*=-1:this.textAlign===Pe||this.textAlign===df?c.left=l-(r>0?r:0):this.textAlign!==le&&this.textAlign!==dc||(c.left=l-(r>0?r:0))),c}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,n){this._renderCursor(e,n,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e),r=this.get2DCursorLocation(e),i=r.lineIndex,o=r.charIndex>0?r.charIndex-1:0,l=this.getValueOfPropertyAt(i,o,"fontSize"),a=this.getObjectScaling().x*this.canvas.getZoom(),c=this.cursorWidth/a,s=this.getValueOfPropertyAt(i,o,"deltaY"),u=n.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-l*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(i,o,"fill"),opacity:this._currentCursorOpacity,left:n.left+n.leftOffset-c/2,top:u+n.top+s,width:c,height:l}}_renderCursor(e,n,r){let{color:i,opacity:o,left:l,top:a,width:c,height:s}=this.getCursorRenderingData(r,n);e.fillStyle=i,e.globalAlpha=o,e.fillRect(l,a,c,s)}renderSelection(e,n){let r={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,r,n)}renderDragSourceEffect(){let e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){let n=this.getSelectionStartFromPointer(e);this.renderCursorAt(n)}_renderSelection(e,n,r){let i=n.selectionStart,o=n.selectionEnd,l=this.textAlign.includes(xr),a=this.get2DCursorLocation(i),c=this.get2DCursorLocation(o),s=a.lineIndex,u=c.lineIndex,d=a.charIndex<0?0:a.charIndex,h=c.charIndex<0?0:c.charIndex;for(let f=s;f<=u;f++){let p=this._getLineLeftOffset(f)||0,g=this.getHeightOfLine(f),y=0,b=0,v=0;if(f===s&&(b=this.__charBounds[s][d].left),f>=s&&f<u)v=l&&!this.isEndOfWrapping(f)?this.width:this.getLineWidth(f)||5;else if(f===u)if(h===0)v=this.__charBounds[u][h].left;else{let G=this._getWidthOfCharSpacing();v=this.__charBounds[u][h-1].left+this.__charBounds[u][h-1].width-G}y=g,(this.lineHeight<1||f===u&&this.lineHeight>1)&&(g/=this.lineHeight);let _=r.left+p+b,I=g,k=0,V=v-b;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",I=1,k=g):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===lt||this.textAlign===xr||this.textAlign===uc?_=this.width-_-V:this.textAlign===Pe||this.textAlign===df?_=r.left+p-v:this.textAlign!==le&&this.textAlign!==dc||(_=r.left+p-v)),e.fillRect(_,r.top+r.topOffset+k,V,I),r.topOffset+=y}}getCurrentCharFontSize(){let e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){let e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,bt)}_getCurrentCharIndex(){let e=this.get2DCursorLocation(this.selectionStart,!0),n=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:n}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}};E(Fi,"ownDefaults",WU),E(Fi,"type","IText"),U.setClass(Fi),U.setClass(Fi,"i-text");var Sa=class t extends Fi{static getDefaults(){return x(x({},super.getDefaults()),t.ownDefaults)}constructor(e,n){super(e,x(x({},t.ownDefaults),n))}static createControls(){return{controls:l1()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(xr)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let n=0,r=0,i=0,o={};for(let l=0;l<e.graphemeLines.length;l++)e.graphemeText[i]===`
`&&l>0?(r=0,i++,n++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[i])&&l>0&&(r++,i++),o[l]={line:n,offset:r},i+=e.graphemeLines[l].length,r+=e.graphemeLines[l].length;return o}styleHas(e,n){if(this._styleMap&&!this.isWrapping){let r=this._styleMap[n];r&&(n=r.line)}return super.styleHas(e,n)}isEmptyStyles(e){if(!this.styles)return!0;let n,r=0,i=e+1,o=!1,l=this._styleMap[e],a=this._styleMap[e+1];l&&(e=l.line,r=l.offset),a&&(i=a.line,o=i===e,n=a.offset);let c=e===void 0?this.styles:{line:this.styles[e]};for(let s in c)for(let u in c[s]){let d=parseInt(u,10);if(d>=r&&(!o||d<n))for(let h in c[s][u])return!1}return!0}_getStyleDeclaration(e,n){if(this._styleMap&&!this.isWrapping){let r=this._styleMap[e];if(!r)return{};e=r.line,n=r.offset+n}return super._getStyleDeclaration(e,n)}_setStyleDeclaration(e,n,r){let i=this._styleMap[e];super._setStyleDeclaration(i.line,i.offset+n,r)}_deleteStyleDeclaration(e,n){let r=this._styleMap[e];super._deleteStyleDeclaration(r.line,r.offset+n)}_getLineStyle(e){let n=this._styleMap[e];return!!this.styles[n.line]}_setLineStyle(e){let n=this._styleMap[e];super._setLineStyle(n.line)}_wrapText(e,n){this.isWrapping=!0;let r=this.getGraphemeDataForRender(e),i=[];for(let o=0;o<r.wordsData.length;o++)i.push(...this._wrapLine(o,n,r));return this.isWrapping=!1,i}getGraphemeDataForRender(e){let n=this.splitByGrapheme,r=n?"":" ",i=0;return{wordsData:e.map((o,l)=>{let a=0,c=n?this.graphemeSplit(o):this.wordSplit(o);return c.length===0?[{word:[],width:0}]:c.map(s=>{let u=n?[s]:this.graphemeSplit(s),d=this._measureWord(u,l,a);return i=Math.max(d,i),a+=u.length+r.length,{word:u,width:d}})}),largestWordWidth:i}}_measureWord(e,n){let r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=0;for(let l=0,a=e.length;l<a;l++)o+=this._getGraphemeBox(e[l],n,l+i,r,!0).kernedWidth,r=e[l];return o}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,n,r){let{largestWordWidth:i,wordsData:o}=r,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=this._getWidthOfCharSpacing(),c=this.splitByGrapheme,s=[],u=c?"":" ",d=0,h=[],f=0,p=0,g=!0;n-=l;let y=Math.max(n,i,this.dynamicMinWidth),b=o[e],v;for(f=0,v=0;v<b.length;v++){let{word:_,width:I}=b[v];f+=_.length,d+=p+I-a,d>y&&!g?(s.push(h),h=[],d=I,g=!0):d+=a,g||c||h.push(u),h=h.concat(_),p=c?0:this._measureWord([u],e,f),f++,g=!1}return v&&s.push(h),i+l>this.dynamicMinWidth&&(this.dynamicMinWidth=i-a+l),s}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,n){return this.splitByGrapheme&&!n?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){let n=super._splitTextIntoLines(e),r=this._wrapText(n.lines,this.width),i=new Array(r.length);for(let o=0;o<r.length;o++)i[o]=r[o].join("");return n.lines=i,n.graphemeLines=r,n}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){let e=new Map;for(let n in this._styleMap){let r=parseInt(n,10);if(this._textLines[r]){let i=this._styleMap[n].line;e.set("".concat(i),!0)}}for(let n in this.styles)e.has(n)||delete this.styles[n]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}};E(Sa,"type","Textbox"),E(Sa,"textLayoutProperties",[...Fi.textLayoutProperties,"width"]),E(Sa,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),U.setClass(Sa);var ff=class extends Na{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,n){let{target:r}=e,{clipPath:i,group:o}=r;if(!i||!this.shouldPerformLayout(e))return;let{width:l,height:a}=Er(m1(r,i)),c=new A(l,a);if(i.absolutePositioned)return{center:ti(i.getRelativeCenterPoint(),void 0,o?o.calcTransformMatrix():void 0),size:c};{let s=i.getRelativeCenterPoint().transform(r.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){let{center:u=new A,correction:d=new A}=this.calcBoundingBox(n,e)||{};return{center:u.add(s),correction:d.subtract(s),size:c}}return{center:r.getRelativeCenterPoint().add(s),size:c}}}};E(ff,"type","clip-path"),U.setClass(ff);var pf=class extends Na{getInitialSize(e,n){let{target:r}=e,{size:i}=n;return new A(r.width||i.x,r.height||i.y)}};E(pf,"type","fixed"),U.setClass(pf);var Hv=class extends Zo{subscribeTargets(e){let n=e.target;e.targets.reduce((r,i)=>(i.parent&&r.add(i.parent),r),new Set).forEach(r=>{r.layoutManager.subscribeTargets({target:r,targets:[n]})})}unsubscribeTargets(e){let n=e.target,r=n.getObjects();e.targets.reduce((i,o)=>(o.parent&&i.add(o.parent),i),new Set).forEach(i=>{!r.some(o=>o.parent===i)&&i.layoutManager.unsubscribeTargets({target:i,targets:[n]})})}},Da=class t extends Li{static getDefaults(){return x(x({},super.getDefaults()),t.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,t.ownDefaults),this.setOptions(n);let{left:r,top:i,layoutManager:o}=n;this.groupInit(e,{left:r,top:i,layoutManager:o??new Hv})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.multiSelectionStacking==="selection-order"?this.add(...n):n.forEach(i=>{let o=this._objects.findIndex(a=>a.isInFrontOf(i)),l=o===-1?this.size():o;this.insertAt(l,i)})}canEnterGroup(e){return this.getObjects().some(n=>n.isDescendantOf(e)||e.isDescendantOf(n))?(Bi("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,n){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,n)}exitGroup(e,n){this._exitGroup(e,n),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,n){super._onAfterObjectsChange(e,n);let r=new Set;n.forEach(i=>{let{parent:o}=i;o&&r.add(o)}),e===hb?r.forEach(i=>{i._onAfterObjectsChange(sf,n)}):r.forEach(i=>{i._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,n,r){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;let i=x(x({hasControls:!1},r),{},{forActiveSelection:!0});for(let o=0;o<this._objects.length;o++)this._objects[o]._renderControls(e,i);super._renderControls(e,n),e.restore()}};E(Da,"type","ActiveSelection"),E(Da,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),U.setClass(Da),U.setClass(Da,"activeSelection");var Gv=class{constructor(){E(this,"resources",{})}applyFilters(e,n,r,i,o){let l=o.getContext("2d");if(!l)return;l.drawImage(n,0,0,r,i);let a={sourceWidth:r,sourceHeight:i,imageData:l.getImageData(0,0,r,i),originalEl:n,originalImageData:l.getImageData(0,0,r,i),canvasEl:o,ctx:l,filterBackend:this};e.forEach(s=>{s.applyTo(a)});let{imageData:c}=a;return c.width===r&&c.height===i||(o.width=c.width,o.height=c.height),l.putImageData(c,0,0),a}},gf=class{constructor(){let{tileSize:e=Ce.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};E(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),E(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,n){this.dispose(),this.createWebGLCanvas(e,n)}createWebGLCanvas(e,n){let r=cr({width:e,height:n}),i=r.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});i&&(i.clearColor(0,0,0,0),this.canvas=r,this.gl=i)}applyFilters(e,n,r,i,o,l){let a=this.gl,c=o.getContext("2d");if(!a||!c)return;let s;l&&(s=this.getCachedTexture(l,n));let u={originalWidth:n.width||n.naturalWidth||0,originalHeight:n.height||n.naturalHeight||0,sourceWidth:r,sourceHeight:i,destinationWidth:r,destinationHeight:i,context:a,sourceTexture:this.createTexture(a,r,i,s?void 0:n),targetTexture:this.createTexture(a,r,i),originalTexture:s||this.createTexture(a,r,i,s?void 0:n),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:o},d=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,d),e.forEach(h=>{h&&h.applyTo(u)}),function(h){let f=h.targetCanvas,p=f.width,g=f.height,y=h.destinationWidth,b=h.destinationHeight;p===y&&g===b||(f.width=y,f.height=b)}(u),this.copyGLTo2D(a,u),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(u.sourceTexture),a.deleteTexture(u.targetTexture),a.deleteFramebuffer(d),c.setTransform(1,0,0,1,0,0),u}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,n,r,i,o){let{NEAREST:l,TEXTURE_2D:a,RGBA:c,UNSIGNED_BYTE:s,CLAMP_TO_EDGE:u,TEXTURE_MAG_FILTER:d,TEXTURE_MIN_FILTER:h,TEXTURE_WRAP_S:f,TEXTURE_WRAP_T:p}=e,g=e.createTexture();return e.bindTexture(a,g),e.texParameteri(a,d,o||l),e.texParameteri(a,h,o||l),e.texParameteri(a,f,u),e.texParameteri(a,p,u),i?e.texImage2D(a,0,c,c,s,i):e.texImage2D(a,0,c,n,r,0,c,s,null),g}getCachedTexture(e,n,r){let{textureCache:i}=this;if(i[e])return i[e];{let o=this.createTexture(this.gl,n.width,n.height,n,r);return o&&(i[e]=o),o}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,n){let r=e.canvas,i=n.targetCanvas,o=i.getContext("2d");if(!o)return;o.translate(0,i.height),o.scale(1,-1);let l=r.height-i.height;o.drawImage(r,0,l,i.width,i.height,0,0,i.width,i.height)}copyGLTo2DPutImageData(e,n){let r=n.targetCanvas.getContext("2d"),i=n.destinationWidth,o=n.destinationHeight,l=i*o*4;if(!r)return;let a=new Uint8Array(this.imageBuffer,0,l),c=new Uint8ClampedArray(this.imageBuffer,0,l);e.readPixels(0,0,i,o,e.RGBA,e.UNSIGNED_BYTE,a);let s=new ImageData(c,i,o);r.putImageData(s,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;let e=this.gl,n={renderer:"",vendor:""};if(!e)return n;let r=e.getExtension("WEBGL_debug_renderer_info");if(r){let i=e.getParameter(r.UNMASKED_RENDERER_WEBGL),o=e.getParameter(r.UNMASKED_VENDOR_WEBGL);i&&(n.renderer=i.toLowerCase()),o&&(n.vendor=o.toLowerCase())}return this.gpuInfo=n,n}},fv;function qU(){let{WebGLProbe:t}=Cr();return t.queryWebGL(Hn()),Ce.enableGLFiltering&&t.isSupported(Ce.textureSize)?new gf({tileSize:Ce.textureSize}):new Gv}function pv(){return!fv&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(fv=qU()),fv}var YU=["filters","resizeFilter","src","crossOrigin","type"],V1=["cropX","cropY"],Vn=class t extends xt{static getDefaults(){return x(x({},super.getDefaults()),t.ownDefaults)}constructor(e,n){super(),E(this,"_lastScaleX",1),E(this,"_lastScaleY",1),E(this,"_filterScalingX",1),E(this,"_filterScalingY",1),this.filters=[],Object.assign(this,t.ownDefaults),this.setOptions(n),this.cacheKey="texture".concat(Vi()),this.setElement(typeof e=="string"?(this.canvas&&ir(this.canvas.getElement())||ka()).getElementById(e):e,n)}getElement(){return this._element}setElement(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(n),e.classList.add(t.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){let n=pv(!1);n instanceof gf&&n.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{let n=this[e];n&&Cr().dispose(n),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){let e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;let n=this.width/2,r=this.height/2;e.beginPath(),e.moveTo(-n,-r),e.lineTo(n,-r),e.lineTo(n,r),e.lineTo(-n,r),e.lineTo(-n,-r),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[];return this.filters.forEach(r=>{r&&n.push(r.toObject())}),x(x({},super.toObject([...V1,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:n},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){let e=[],n=this._element,r=-this.width/2,i=-this.height/2,o=[],l=[],a="",c="";if(!n)return[];if(this.hasCrop()){let s=Vi();o.push('<clipPath id="imageCrop_'+s+`">
`,'	<rect x="'+r+'" y="'+i+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),a=' clip-path="url(#imageCrop_'+s+')" '}if(this.imageSmoothing||(c=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(r-this.cropX,'" y="').concat(i-this.cropY,'" width="').concat(n.width||n.naturalWidth,'" height="').concat(n.height||n.naturalHeight,'"').concat(c).concat(a,`></image>
`)),this.stroke||this.strokeDashArray){let s=this.fill;this.fill=null,l=['	<rect x="'.concat(r,'" y="').concat(i,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=s}return o=this.paintFirst!==bt?o.concat(l,e):o.concat(e,l),o}getSrc(e){let n=e?this._element:this._originalElement;return n?n.toDataURL?n.toDataURL():this.srcFromAttribute?n.getAttribute("src")||"":n.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:n,signal:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return lc(e,{crossOrigin:n,signal:r}).then(i=>{n!==void 0&&this.set({crossOrigin:n}),this.setElement(i)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){let e=this.resizeFilter,n=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),i=r.x,o=r.y,l=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||i>n&&o>n)return this._element=l,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,void(this._lastScaleY=o);let a=cr(l),{width:c,height:s}=l;this._element=a,this._lastScaleX=e.scaleX=i,this._lastScaleY=e.scaleY=o,pv().applyFilters([e],l,c,s,this._element),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(o=>o&&!o.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);let n=this._originalElement,r=n.naturalWidth||n.width,i=n.naturalHeight||n.height;if(this._element===this._originalElement){let o=cr({width:r,height:i});this._element=o,this._filteredEl=o}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,i),this._lastScaleX=1,this._lastScaleY=1);pv().applyFilters(e,this._originalElement,r,i,this._element),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){let n=this._element;if(!n)return;let r=this._filterScalingX,i=this._filterScalingY,o=this.width,l=this.height,a=Math.max(this.cropX,0),c=Math.max(this.cropY,0),s=n.naturalWidth||n.width,u=n.naturalHeight||n.height,d=a*r,h=c*i,f=Math.min(o*r,s-d),p=Math.min(l*i,u-h),g=-o/2,y=-l/2,b=Math.min(o,s/r-a),v=Math.min(l,u/i-c);n&&e.drawImage(n,d,h,f,p,g,y,b,v)}_needsResize(){let e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=this.getOriginalSize();this.width=e||r.width,this.height=n||r.height}parsePreserveAspectRatioAttribute(){let e=ND(this.preserveAspectRatio||""),n=this.width,r=this.height,i={width:n,height:r},o,l=this._element.width,a=this._element.height,c=1,s=1,u=0,d=0,h=0,f=0;return!e||e.alignX===cn&&e.alignY===cn?(c=n/l,s=r/a):(e.meetOrSlice==="meet"&&(c=s=v1(this._element,i),o=(n-l*c)/2,e.alignX==="Min"&&(u=-o),e.alignX==="Max"&&(u=o),o=(r-a*s)/2,e.alignY==="Min"&&(d=-o),e.alignY==="Max"&&(d=o)),e.meetOrSlice==="slice"&&(c=s=b1(this._element,i),o=l-n/c,e.alignX==="Mid"&&(h=o/2),e.alignX==="Max"&&(h=o),o=a-r/s,e.alignY==="Mid"&&(f=o/2),e.alignY==="Max"&&(f=o),l=n/c,a=r/s)),{width:l,height:a,scaleX:c,scaleY:s,offsetLeft:u,offsetTop:d,cropX:h,cropY:f}}static fromObject(e,n){let{filters:r,resizeFilter:i,src:o,crossOrigin:l,type:a}=e,c=Xe(e,YU);return Promise.all([lc(o,x(x({},n),{},{crossOrigin:l})),r&&Ma(r,n),i&&Ma([i],n),wc(c,n)]).then(s=>{let[u,d=[],[h]=[],f={}]=s;return new this(u,x(x({},c),{},{src:o,filters:d,resizeFilter:h},f))})}static fromURL(e){let{crossOrigin:n=null,signal:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;return lc(e,{crossOrigin:n,signal:r}).then(o=>new this(o,i))}static fromElement(n){return R(this,arguments,function*(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,o=ii(e,this.ATTRIBUTE_NAMES,i);return this.fromURL(o["xlink:href"],r,o).catch(l=>(Bi("log","Unable to parse Image",l),null))})}};E(Vn,"type","Image"),E(Vn,"cacheProperties",[...ri,...V1]),E(Vn,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),E(Vn,"CSS_CANVAS","canvas-img"),E(Vn,"ATTRIBUTE_NAMES",[...Gi,"x","y","width","height","preserveAspectRatio","xlink:href","crossOrigin","image-rendering"]),U.setClass(Vn),U.setSVGClass(Vn);var TQ=Ef(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);var $1=CD,bD=t=>function(e,n,r){let{points:i,pathOffset:o}=r;return new A(i[t]).subtract(o).transform(rt(r.getViewportTransform(),r.calcTransformMatrix()))},U1=(t,e,n,r)=>{let{target:i,pointIndex:o}=e,l=i,a=ti(new A(n,r),void 0,l.calcOwnMatrix());return l.points[o]=a.add(l.pathOffset),l.setDimensions(),!0},H1=(t,e)=>function(n,r,i,o){let l=r.target,a=new A(l.points[(t>0?t:l.points.length)-1]),c=a.subtract(l.pathOffset).transform(l.calcOwnMatrix()),s=e(n,x(x({},r),{},{pointIndex:t}),i,o),u=a.subtract(l.pathOffset).transform(l.calcOwnMatrix()).subtract(c);return l.left-=u.x,l.top-=u.y,s},wD=t=>Hi($1,H1(t,U1)),zv=(t,e,n)=>{let{path:r,pathOffset:i}=t,o=r[e];return new A(o[n]-i.x,o[n+1]-i.y).transform(rt(t.getViewportTransform(),t.calcTransformMatrix()))};function XU(t,e,n){let{commandIndex:r,pointIndex:i}=this;return zv(n,r,i)}function KU(t,e,n,r){let{target:i}=e,{commandIndex:o,pointIndex:l}=this,a=((c,s,u,d,h)=>{let{path:f,pathOffset:p}=c,g=f[(d>0?d:f.length)-1],y=new A(g[h],g[h+1]),b=y.subtract(p).transform(c.calcOwnMatrix()),v=ti(new A(s,u),void 0,c.calcOwnMatrix());f[d][h]=v.x+p.x,f[d][h+1]=v.y+p.y,c.setDimensions();let _=y.subtract(c.pathOffset).transform(c.calcOwnMatrix()).subtract(b);return c.left-=_.x,c.top-=_.y,c.set("dirty",!0),!0})(i,n,r,o,l);return rb(this.actionName,x(x({},ib(t,e,n,r)),{},{commandIndex:o,pointIndex:l})),a}var mf=class extends Kt{constructor(e){super(e)}render(e,n,r,i,o){let l=x(x({},i),{},{cornerColor:this.controlFill,cornerStrokeColor:this.controlStroke,transparentCorners:!this.controlFill});super.render(e,n,r,l,o)}},Wv=class extends mf{constructor(e){super(e)}render(e,n,r,i,o){let{path:l}=o,{commandIndex:a,pointIndex:c,connectToCommandIndex:s,connectToPointIndex:u}=this;e.save(),e.strokeStyle=this.controlStroke,this.connectionDashArray&&e.setLineDash(this.connectionDashArray);let[d]=l[a],h=zv(o,s,u);if(d==="Q"){let f=zv(o,a,c+2);e.moveTo(f.x,f.y),e.lineTo(n,r)}else e.moveTo(n,r);e.lineTo(h.x,h.y),e.stroke(),e.restore(),super.render(e,n,r,i,o)}},jh=(t,e,n,r,i,o)=>new(n?Wv:mf)(x(x({commandIndex:t,pointIndex:e,actionName:"modifyPath",positionHandler:XU,actionHandler:KU,connectToCommandIndex:i,connectToPointIndex:o},r),n?r.controlPointStyle:r.pointStyle)),xQ=Object.freeze({__proto__:null,changeWidth:Ov,createObjectDefaultControls:cb,createPathControls:function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n={},r="M";return t.path.forEach((i,o)=>{let l=i[0];switch(l!=="Z"&&(n["c_".concat(o,"_").concat(l)]=jh(o,i.length-2,!1,e)),l){case"C":n["c_".concat(o,"_C_CP_1")]=jh(o,1,!0,e,o-1,(a=>a==="C"?5:a==="Q"?3:1)(r)),n["c_".concat(o,"_C_CP_2")]=jh(o,3,!0,e,o,5);break;case"Q":n["c_".concat(o,"_Q_CP_1")]=jh(o,1,!0,e,o,3)}r=l}),n},createPolyActionHandler:wD,createPolyControls:function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n={};for(let r=0;r<(typeof t=="number"?t:t.points.length);r++)n["p".concat(r)]=new Kt(x({actionName:$1,positionHandler:bD(r),actionHandler:wD(r)},e));return n},createPolyPositionHandler:bD,createResizeControls:a1,createTextboxDefaultControls:l1,dragHandler:HD,factoryPolyActionHandler:H1,getLocalPoint:xf,polyActionHandler:U1,renderCircleControl:XD,renderSquareControl:KD,rotationStyleHandler:ZD,rotationWithSnapping:QD,scaleCursorStyleHandler:_a,scaleOrSkewActionName:oc,scaleSkewCursorStyleHandler:Ao,scalingEqually:ic,scalingX:t1,scalingXOrSkewingY:Av,scalingY:n1,scalingYOrSkewingX:Mv,skewCursorStyleHandler:r1,skewHandlerX:o1,skewHandlerY:s1,wrapWithFireEvent:Hi,wrapWithFixedAnchor:Jo}),Of=t=>t.webgl!==void 0;var pb="precision highp float",ZU=`
    `.concat(pb,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),QU=["type"],JU=["type"],eH=new RegExp(pb,"g"),it=class{get type(){return this.constructor.type}constructor(){let e=Xe(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},QU);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return ZU}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource(),{WebGLProbe:{GLPrecision:i="highp"}}=Cr();i!=="highp"&&(n=n.replace(eH,pb.replace("highp",i)));let o=e.createShader(e.VERTEX_SHADER),l=e.createShader(e.FRAGMENT_SHADER),a=e.createProgram();if(!o||!l||!a)throw new Un("Vertex, fragment shader or program creation error");if(e.shaderSource(o,r),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new Un("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(o)));if(e.shaderSource(l,n),e.compileShader(l),!e.getShaderParameter(l,e.COMPILE_STATUS))throw new Un("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(l)));if(e.attachShader(a,o),e.attachShader(a,l),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new Un('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(a)));let c=this.getUniformLocations(e,a)||{};return c.uStepW=e.getUniformLocation(a,"uStepW"),c.uStepH=e.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:this.getAttributeLocations(e,a),uniformLocations:c}}getAttributeLocations(e,n){return{aPosition:e.getAttribLocation(n,"aPosition")}}getUniformLocations(e,n){let r=this.constructor.uniformLocations,i={};for(let o=0;o<r.length;o++)i[r[o]]=e.getUniformLocation(n,r[o]);return i}sendAttributeData(e,n,r){let i=n.aPosition,o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW)}_setupFrameBuffer(e){let n=e.context;if(e.passes>1){let r=e.destinationWidth,i=e.destinationHeight;e.sourceWidth===r&&e.sourceHeight===i||(n.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(n,r,i)),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e.targetTexture,0)}else n.bindFramebuffer(n.FRAMEBUFFER,null),n.finish()}_swapTextures(e){e.passes--,e.pass++;let n=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=n}isNeutralState(e){return!1}applyTo(e){Of(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){let n=this.getCacheKey();return e.programCache[n]||(e.programCache[n]=this.createProgram(e.context)),e.programCache[n]}applyToWebGL(e){let n=e.context,r=this.retrieveShader(e);e.pass===0&&e.originalTexture?n.bindTexture(n.TEXTURE_2D,e.originalTexture):n.bindTexture(n.TEXTURE_2D,e.sourceTexture),n.useProgram(r.program),this.sendAttributeData(n,r.attributeLocations,e.aPosition),n.uniform1f(r.uniformLocations.uStepW,1/e.sourceWidth),n.uniform1f(r.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(n,r.uniformLocations),n.viewport(0,0,e.destinationWidth,e.destinationHeight),n.drawArrays(n.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,n,r){e.activeTexture(r),e.bindTexture(e.TEXTURE_2D,n),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,n){}createHelpLayer(e){if(!e.helpLayer){let{sourceWidth:n,sourceHeight:r}=e,i=cr({width:n,height:r});e.helpLayer=i}}toObject(){let e=Object.keys(this.constructor.defaults||{});return x({type:this.type},e.reduce((n,r)=>(n[r]=this[r],n),{}))}toJSON(){return this.toObject()}static fromObject(e,n){return R(this,null,function*(){return new this(Xe(e,JU))})}};E(it,"type","BaseFilter"),E(it,"uniformLocations",[]);var tH={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `},Mo=class extends it{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(tH[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:n}}=e,r=new en(this.color).getSource(),i=this.alpha,o=r[0]*i,l=r[1]*i,a=r[2]*i,c=1-i;for(let s=0;s<n.length;s+=4){let u=n[s],d=n[s+1],h=n[s+2],f,p,g;switch(this.mode){case"multiply":f=u*o/255,p=d*l/255,g=h*a/255;break;case"screen":f=255-(255-u)*(255-o)/255,p=255-(255-d)*(255-l)/255,g=255-(255-h)*(255-a)/255;break;case"add":f=u+o,p=d+l,g=h+a;break;case"difference":f=Math.abs(u-o),p=Math.abs(d-l),g=Math.abs(h-a);break;case"subtract":f=u-o,p=d-l,g=h-a;break;case"darken":f=Math.min(u,o),p=Math.min(d,l),g=Math.min(h,a);break;case"lighten":f=Math.max(u,o),p=Math.max(d,l),g=Math.max(h,a);break;case"overlay":f=o<128?2*u*o/255:255-2*(255-u)*(255-o)/255,p=l<128?2*d*l/255:255-2*(255-d)*(255-l)/255,g=a<128?2*h*a/255:255-2*(255-h)*(255-a)/255;break;case"exclusion":f=o+u-2*o*u/255,p=l+d-2*l*d/255,g=a+h-2*a*h/255;break;case"tint":f=o+u*c,p=l+d*c,g=a+h*c}n[s]=f,n[s+1]=p,n[s+2]=g}}sendUniformData(e,n){let r=new en(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,e.uniform4fv(n.uColor,r)}};E(Mo,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),E(Mo,"type","BlendColor"),E(Mo,"uniformLocations",["uColor"]),U.setClass(Mo);var nH={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},rH=["type","image"],Po=class extends it{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return nH[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){let n=e.context,r=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(n,r,n.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(n,n.TEXTURE1)}createTexture(e,n){return e.getCachedTexture(n.cacheKey,n.getElement())}calculateMatrix(){let e=this.image,{width:n,height:r}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/n,-e.top/r,1]}applyTo2d(e){let{imageData:{data:n,width:r,height:i},filterBackend:{resources:o}}=e,l=this.image;o.blendImage||(o.blendImage=Hn());let a=o.blendImage,c=a.getContext("2d");a.width!==r||a.height!==i?(a.width=r,a.height=i):c.clearRect(0,0,r,i),c.setTransform(l.scaleX,0,0,l.scaleY,l.left,l.top),c.drawImage(l.getElement(),0,0,r,i);let s=c.getImageData(0,0,r,i).data;for(let u=0;u<n.length;u+=4){let d=n[u],h=n[u+1],f=n[u+2],p=n[u+3],g=s[u],y=s[u+1],b=s[u+2],v=s[u+3];switch(this.mode){case"multiply":n[u]=d*g/255,n[u+1]=h*y/255,n[u+2]=f*b/255,n[u+3]=p*v/255;break;case"mask":n[u+3]=v}}}sendUniformData(e,n){let r=this.calculateMatrix();e.uniform1i(n.uImage,1),e.uniformMatrix3fv(n.uTransformMatrix,!1,r)}toObject(){return x(x({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static fromObject(e,n){return R(this,null,function*(){let{type:r,image:i}=e,o=Xe(e,rH);return Vn.fromObject(i,n).then(l=>new this(x(x({},o),{},{image:l})))})}};E(Po,"type","BlendImage"),E(Po,"defaults",{mode:"multiply",alpha:1}),E(Po,"uniformLocations",["uTransformMatrix","uImage"]),U.setClass(Po);var No=class extends it{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float total = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        float weight = 1.0 - abs(percent);
        color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
        total += weight;
      }
      gl_FragColor = color / total;
    }
  `}applyTo(e){Of(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){e.imageData=this.simpleBlur(e)}simpleBlur(e){let{ctx:n,imageData:r,filterBackend:{resources:i}}=e,{width:o,height:l}=r;i.blurLayer1||(i.blurLayer1=Hn(),i.blurLayer2=Hn());let a=i.blurLayer1,c=i.blurLayer2;a.width===o&&a.height===l||(c.width=a.width=o,c.height=a.height=l);let s=a.getContext("2d"),u=c.getContext("2d"),d=15,h=.06*this.blur*.5,f,p,g,y;for(s.putImageData(r,0,0),u.clearRect(0,0,o,l),y=-15;y<=d;y++)f=(Math.random()-.5)/4,p=y/d,g=h*p*o+f,u.globalAlpha=1-Math.abs(p),u.drawImage(a,g,f),s.drawImage(c,0,0),u.globalAlpha=1,u.clearRect(0,0,c.width,c.height);for(y=-15;y<=d;y++)f=(Math.random()-.5)/4,p=y/d,g=h*p*l+f,u.globalAlpha=1-Math.abs(p),u.drawImage(a,f,g),s.drawImage(c,0,0),u.globalAlpha=1,u.clearRect(0,0,c.width,c.height);n.drawImage(a,0,0);let b=n.getImageData(0,0,a.width,a.height);return s.globalAlpha=1,s.clearRect(0,0,a.width,a.height),b}sendUniformData(e,n){let r=this.chooseRightDelta();e.uniform2fv(n.uDelta,r)}isNeutralState(){return this.blur===0}chooseRightDelta(){let e=1,n=[0,0];this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio);let r=e*this.blur*.12;return this.horizontal?n[0]=r:n[1]=r,n}};E(No,"type","Blur"),E(No,"defaults",{blur:0}),E(No,"uniformLocations",["uDelta"]),U.setClass(No);var Ro=class extends it{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:n}}=e,r=Math.round(255*this.brightness);for(let i=0;i<n.length;i+=4)n[i]+=r,n[i+1]+=r,n[i+2]+=r}isNeutralState(){return this.brightness===0}sendUniformData(e,n){e.uniform1f(n.uBrightness,this.brightness)}};E(Ro,"type","Brightness"),E(Ro,"defaults",{brightness:0}),E(Ro,"uniformLocations",["uBrightness"]),U.setClass(Ro);var G1={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0},ei=class extends it{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){let n=e.imageData.data,r=this.matrix,i=this.colorsOnly;for(let o=0;o<n.length;o+=4){let l=n[o],a=n[o+1],c=n[o+2];if(n[o]=l*r[0]+a*r[1]+c*r[2]+255*r[4],n[o+1]=l*r[5]+a*r[6]+c*r[7]+255*r[9],n[o+2]=l*r[10]+a*r[11]+c*r[12]+255*r[14],!i){let s=n[o+3];n[o]+=s*r[3],n[o+1]+=s*r[8],n[o+2]+=s*r[13],n[o+3]=l*r[15]+a*r[16]+c*r[17]+s*r[18]+255*r[19]}}}sendUniformData(e,n){let r=this.matrix,i=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],o=[r[4],r[9],r[14],r[19]];e.uniformMatrix4fv(n.uColorMatrix,!1,i),e.uniform4fv(n.uConstants,o)}toObject(){return x(x({},super.toObject()),{},{matrix:[...this.matrix]})}};function es(t,e){var n;let r=(E(n=class extends ei{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",t),E(n,"defaults",{colorsOnly:!1,matrix:e}),n);return U.setClass(r,t),r}E(ei,"type","ColorMatrix"),E(ei,"defaults",G1),E(ei,"uniformLocations",["uColorMatrix","uConstants"]),U.setClass(ei);var iH=es("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]),oH=es("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]),sH=es("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]),aH=es("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]),lH=es("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]),cH=es("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]),uH=es("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]),vc=class extends it{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){Of(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(n=>{n.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,n){return Promise.all((e.subFilters||[]).map(r=>U.getClass(r.type).fromObject(r,n))).then(r=>new this({subFilters:r}))}};E(vc,"type","Composed"),U.setClass(vc);var ko=class extends it{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:n}}=e,r=Math.floor(255*this.contrast),i=259*(r+255)/(255*(259-r));for(let o=0;o<n.length;o+=4)n[o]=i*(n[o]-128)+128,n[o+1]=i*(n[o+1]-128)+128,n[o+2]=i*(n[o+2]-128)+128}sendUniformData(e,n){e.uniform1f(n.uContrast,this.contrast)}};E(ko,"type","Contrast"),E(ko,"defaults",{contrast:0}),E(ko,"uniformLocations",["uContrast"]),U.setClass(ko);var dH={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `},Fo=class extends it{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return dH[this.getCacheKey()]}applyTo2d(e){let n=e.imageData,r=n.data,i=this.matrix,o=Math.round(Math.sqrt(i.length)),l=Math.floor(o/2),a=n.width,c=n.height,s=e.ctx.createImageData(a,c),u=s.data,d=this.opaque?1:0,h,f,p,g,y,b,v,_,I,k,V,G,j;for(V=0;V<c;V++)for(k=0;k<a;k++){for(y=4*(V*a+k),h=0,f=0,p=0,g=0,j=0;j<o;j++)for(G=0;G<o;G++)v=V+j-l,b=k+G-l,v<0||v>=c||b<0||b>=a||(_=4*(v*a+b),I=i[j*o+G],h+=r[_]*I,f+=r[_+1]*I,p+=r[_+2]*I,d||(g+=r[_+3]*I));u[y]=h,u[y+1]=f,u[y+2]=p,u[y+3]=d?r[y+3]:g}e.imageData=s}sendUniformData(e,n){e.uniform1fv(n.uMatrix,this.matrix)}toObject(){return x(x({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}};E(Fo,"type","Convolute"),E(Fo,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),E(Fo,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),U.setClass(Fo);var z1="Gamma",Lo=class extends it{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:n}}=e,r=this.gamma,i=1/r[0],o=1/r[1],l=1/r[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});let a=this.rgbValues;for(let c=0;c<256;c++)a.r[c]=255*Math.pow(c/255,i),a.g[c]=255*Math.pow(c/255,o),a.b[c]=255*Math.pow(c/255,l);for(let c=0;c<n.length;c+=4)n[c]=a.r[n[c]],n[c+1]=a.g[n[c+1]],n[c+2]=a.b[n[c+2]]}sendUniformData(e,n){e.uniform3fv(n.uGamma,this.gamma)}isNeutralState(){let{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:z1,gamma:this.gamma.concat()}}};E(Lo,"type",z1),E(Lo,"defaults",{gamma:[1,1,1]}),E(Lo,"uniformLocations",["uGamma"]),U.setClass(Lo);var hH={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `},Bo=class extends it{applyTo2d(e){let{imageData:{data:n}}=e;for(let r,i=0;i<n.length;i+=4){let o=n[i],l=n[i+1],a=n[i+2];switch(this.mode){case"average":r=(o+l+a)/3;break;case"lightness":r=(Math.min(o,l,a)+Math.max(o,l,a))/2;break;case"luminosity":r=.21*o+.72*l+.07*a}n[i+2]=n[i+1]=n[i]=r}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return hH[this.mode]}sendUniformData(e,n){e.uniform1i(n.uMode,1)}isNeutralState(){return!1}};E(Bo,"type","Grayscale"),E(Bo,"defaults",{mode:"average"}),E(Bo,"uniformLocations",["uMode"]),U.setClass(Bo);var fH=x(x({},G1),{},{rotation:0}),Oa=class extends ei{calculateMatrix(){let e=this.rotation*Math.PI,n=ar(e),r=lr(e),i=1/3,o=Math.sqrt(i)*r,l=1-n;this.matrix=[n+l/3,i*l-o,i*l+o,0,0,i*l+o,n+i*l,i*l-o,0,0,i*l-o,i*l+o,n+i*l,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}};E(Oa,"type","HueRotation"),E(Oa,"defaults",fH),U.setClass(Oa);var jo=class extends it{applyTo2d(e){let{imageData:{data:n}}=e;for(let r=0;r<n.length;r+=4)n[r]=255-n[r],n[r+1]=255-n[r+1],n[r+2]=255-n[r+2],this.alpha&&(n[r+3]=255-n[r+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,n){e.uniform1i(n.uInvert,Number(this.invert)),e.uniform1i(n.uAlpha,Number(this.alpha))}};E(jo,"type","Invert"),E(jo,"defaults",{alpha:!1,invert:!0}),E(jo,"uniformLocations",["uInvert","uAlpha"]),U.setClass(jo);var Vo=class extends it{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:n}}=e,r=this.noise;for(let i=0;i<n.length;i+=4){let o=(.5-Math.random())*r;n[i]+=o,n[i+1]+=o,n[i+2]+=o}}sendUniformData(e,n){e.uniform1f(n.uNoise,this.noise/255),e.uniform1f(n.uSeed,Math.random())}isNeutralState(){return this.noise===0}};E(Vo,"type","Noise"),E(Vo,"defaults",{noise:0}),E(Vo,"uniformLocations",["uNoise","uSeed"]),U.setClass(Vo);var $o=class extends it{applyTo2d(e){let{imageData:{data:n,width:r,height:i}}=e;for(let o=0;o<i;o+=this.blocksize)for(let l=0;l<r;l+=this.blocksize){let a=4*o*r+4*l,c=n[a],s=n[a+1],u=n[a+2],d=n[a+3];for(let h=o;h<Math.min(o+this.blocksize,i);h++)for(let f=l;f<Math.min(l+this.blocksize,r);f++){let p=4*h*r+4*f;n[p]=c,n[p+1]=s,n[p+2]=u,n[p+3]=d}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,n){e.uniform1f(n.uBlocksize,this.blocksize)}};E($o,"type","Pixelate"),E($o,"defaults",{blocksize:4}),E($o,"uniformLocations",["uBlocksize"]),U.setClass($o);var Uo=class extends it{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:n}}=e,r=255*this.distance,i=new en(this.color).getSource(),o=[i[0]-r,i[1]-r,i[2]-r],l=[i[0]+r,i[1]+r,i[2]+r];for(let a=0;a<n.length;a+=4){let c=n[a],s=n[a+1],u=n[a+2];c>o[0]&&s>o[1]&&u>o[2]&&c<l[0]&&s<l[1]&&u<l[2]&&(n[a+3]=0)}}sendUniformData(e,n){let r=new en(this.color).getSource(),i=this.distance,o=[0+r[0]/255-i,0+r[1]/255-i,0+r[2]/255-i,1],l=[r[0]/255+i,r[1]/255+i,r[2]/255+i,1];e.uniform4fv(n.uLow,o),e.uniform4fv(n.uHigh,l)}};E(Uo,"type","RemoveColor"),E(Uo,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),E(Uo,"uniformLocations",["uLow","uHigh"]),U.setClass(Uo);var Ho=class extends it{sendUniformData(e,n){e.uniform2fv(n.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(n.uTaps,this.taps)}getFilterWindow(){let e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){let e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){let e=this.getFilterWindow();return this.generateShader(e)}getTaps(){let e=this.lanczosCreate(this.lanczosLobes),n=this.tempScale,r=this.getFilterWindow(),i=new Array(r);for(let o=1;o<=r;o++)i[o-1]=e(o*n);return i}generateShader(e){let n=new Array(e);for(let r=1;r<=e;r++)n[r-1]="".concat(r,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(n.map((r,i)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(r,") * uTaps[").concat(i,"] + texture2D(uTexture, vTexCoord - ").concat(r,") * uTaps[").concat(i,`];
              sum += 2.0 * uTaps[`).concat(i,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){Of(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return n=>{if(n>=e||n<=-e)return 0;if(n<11920929e-14&&n>-11920929e-14)return 1;let r=(n*=Math.PI)/e;return Math.sin(n)/n*Math.sin(r)/r}}applyTo2d(e){let n=e.imageData,r=this.scaleX,i=this.scaleY;this.rcpScaleX=1/r,this.rcpScaleY=1/i;let o=n.width,l=n.height,a=Math.round(o*r),c=Math.round(l*i),s;s=this.resizeType==="sliceHack"?this.sliceByTwo(e,o,l,a,c):this.resizeType==="hermite"?this.hermiteFastResize(e,o,l,a,c):this.resizeType==="bilinear"?this.bilinearFiltering(e,o,l,a,c):this.resizeType==="lanczos"?this.lanczosResize(e,o,l,a,c):new ImageData(a,c),e.imageData=s}sliceByTwo(e,n,r,i,o){let l=e.imageData,a=.5,c=!1,s=!1,u=n*a,d=r*a,h=e.filterBackend.resources,f=0,p=0,g=n,y=0;h.sliceByTwo||(h.sliceByTwo=Hn());let b=h.sliceByTwo;(b.width<1.5*n||b.height<r)&&(b.width=1.5*n,b.height=r);let v=b.getContext("2d");for(v.clearRect(0,0,1.5*n,r),v.putImageData(l,0,0),i=Math.floor(i),o=Math.floor(o);!c||!s;)n=u,r=d,i<Math.floor(u*a)?u=Math.floor(u*a):(u=i,c=!0),o<Math.floor(d*a)?d=Math.floor(d*a):(d=o,s=!0),v.drawImage(b,f,p,n,r,g,y,u,d),f=g,p=y,y+=d;return v.getImageData(f,p,i,o)}lanczosResize(e,n,r,i,o){let l=e.imageData.data,a=e.ctx.createImageData(i,o),c=a.data,s=this.lanczosCreate(this.lanczosLobes),u=this.rcpScaleX,d=this.rcpScaleY,h=2/this.rcpScaleX,f=2/this.rcpScaleY,p=Math.ceil(u*this.lanczosLobes/2),g=Math.ceil(d*this.lanczosLobes/2),y={},b={x:0,y:0},v={x:0,y:0};return function _(I){let k,V,G,j,ge,Z,Be,me,we,Se,ke;for(b.x=(I+.5)*u,v.x=Math.floor(b.x),k=0;k<o;k++){for(b.y=(k+.5)*d,v.y=Math.floor(b.y),ge=0,Z=0,Be=0,me=0,we=0,V=v.x-p;V<=v.x+p;V++)if(!(V<0||V>=n)){Se=Math.floor(1e3*Math.abs(V-b.x)),y[Se]||(y[Se]={});for(let ee=v.y-g;ee<=v.y+g;ee++)ee<0||ee>=r||(ke=Math.floor(1e3*Math.abs(ee-b.y)),y[Se][ke]||(y[Se][ke]=s(Math.sqrt(Math.pow(Se*h,2)+Math.pow(ke*f,2))/1e3)),G=y[Se][ke],G>0&&(j=4*(ee*n+V),ge+=G,Z+=G*l[j],Be+=G*l[j+1],me+=G*l[j+2],we+=G*l[j+3]))}j=4*(k*i+I),c[j]=Z/ge,c[j+1]=Be/ge,c[j+2]=me/ge,c[j+3]=we/ge}return++I<i?_(I):a}(0)}bilinearFiltering(e,n,r,i,o){let l,a,c,s,u,d,h,f,p,g,y,b,v,_=0,I=this.rcpScaleX,k=this.rcpScaleY,V=4*(n-1),G=e.imageData.data,j=e.ctx.createImageData(i,o),ge=j.data;for(h=0;h<o;h++)for(f=0;f<i;f++)for(u=Math.floor(I*f),d=Math.floor(k*h),p=I*f-u,g=k*h-d,v=4*(d*n+u),y=0;y<4;y++)l=G[v+y],a=G[v+4+y],c=G[v+V+y],s=G[v+V+4+y],b=l*(1-p)*(1-g)+a*p*(1-g)+c*g*(1-p)+s*p*g,ge[_++]=b;return j}hermiteFastResize(e,n,r,i,o){let l=this.rcpScaleX,a=this.rcpScaleY,c=Math.ceil(l/2),s=Math.ceil(a/2),u=e.imageData.data,d=e.ctx.createImageData(i,o),h=d.data;for(let f=0;f<o;f++)for(let p=0;p<i;p++){let g=4*(p+f*i),y=0,b=0,v=0,_=0,I=0,k=0,V=0,G=(f+.5)*a;for(let j=Math.floor(f*a);j<(f+1)*a;j++){let ge=Math.abs(G-(j+.5))/s,Z=(p+.5)*l,Be=ge*ge;for(let me=Math.floor(p*l);me<(p+1)*l;me++){let we=Math.abs(Z-(me+.5))/c,Se=Math.sqrt(Be+we*we);Se>1&&Se<-1||(y=2*Se*Se*Se-3*Se*Se+1,y>0&&(we=4*(me+j*n),V+=y*u[we+3],v+=y,u[we+3]<255&&(y=y*u[we+3]/250),_+=y*u[we],I+=y*u[we+1],k+=y*u[we+2],b+=y))}}h[g]=_/b,h[g+1]=I/b,h[g+2]=k/b,h[g+3]=V/v}return d}};E(Ho,"type","Resize"),E(Ho,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),E(Ho,"uniformLocations",["uDelta","uTaps"]),U.setClass(Ho);var Go=class extends it{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:n}}=e,r=-this.saturation;for(let i=0;i<n.length;i+=4){let o=n[i],l=n[i+1],a=n[i+2],c=Math.max(o,l,a);n[i]+=c!==o?(c-o)*r:0,n[i+1]+=c!==l?(c-l)*r:0,n[i+2]+=c!==a?(c-a)*r:0}}sendUniformData(e,n){e.uniform1f(n.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}};E(Go,"type","Saturation"),E(Go,"defaults",{saturation:0}),E(Go,"uniformLocations",["uSaturation"]),U.setClass(Go);var zo=class extends it{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:n}}=e,r=-this.vibrance;for(let i=0;i<n.length;i+=4){let o=n[i],l=n[i+1],a=n[i+2],c=Math.max(o,l,a),s=(o+l+a)/3,u=2*Math.abs(c-s)/255*r;n[i]+=c!==o?(c-o)*u:0,n[i+1]+=c!==l?(c-l)*u:0,n[i+2]+=c!==a?(c-a)*u:0}}sendUniformData(e,n){e.uniform1f(n.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}};E(zo,"type","Vibrance"),E(zo,"defaults",{vibrance:0}),E(zo,"uniformLocations",["uVibrance"]),U.setClass(zo);var EQ=Object.freeze({__proto__:null,BaseFilter:it,BlackWhite:uH,BlendColor:Mo,BlendImage:Po,Blur:No,Brightness:Ro,Brownie:iH,ColorMatrix:ei,Composed:vc,Contrast:ko,Convolute:Fo,Gamma:Lo,Grayscale:Bo,HueRotation:Oa,Invert:jo,Kodachrome:sH,Noise:Vo,Pixelate:$o,Polaroid:lH,RemoveColor:Uo,Resize:Ho,Saturation:Go,Sepia:cH,Technicolor:aH,Vibrance:zo,Vintage:oH});var Af={api_key:"",image_player1:"",annotation_player1:void 0};var Va=class t{PLAYER_COUNT=5;players=[];constructor(){this.initializePlayers(this.PLAYER_COUNT),this.players[0].boardGame=Af.image_player1,this.players[1].boardGame=Af.image_player1,this.players[1].annotations=Af.annotation_player1}initializePlayers(e){this.players=[];for(let n=0;n<e;n++)this.players.push({name:"",cardsInCave:0})}getPlayer(e){return this.players[e]}updatePlayerBoardGame(e,n){this.players[e]&&(this.players[e].boardGame=n)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})};var zi=class t{constructor(e){this.router=e;this.router.events.pipe(Dt(n=>n instanceof Fn)).subscribe(n=>{this.buttonsSubject.next([this.emptyButton])})}emptyButton={label:"Hello",action:this.noAction,visible:!1};buttonsSubject=new Je([this.emptyButton]);buttons$=this.buttonsSubject.asObservable();setButtons(e){setTimeout(()=>{this.buttonsSubject.next(e)})}getButtons(){return this.buttonsSubject.getValue()}noAction(e){}static \u0275fac=function(n){return new(n||t)(Y(Ln))};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})};var Mf=class t{constructor(e,n,r){this.playerService=e;this.headerService=n;this.location=r}player;canvas;currentPredictions=[];currentWidth=0;currentHeight=0;dragActive=!1;lastPosX=0;lastPosY=0;startZoom=1;initialDistance=0;pinchCenter={x:0,y:0};activeTouchId=null;set playerNumber(e){this.player=this.playerService.getPlayer(e)}ngOnInit(){return R(this,null,function*(){console.log(this.player?.annotations),this.headerService.setButtons([{label:"Cancel",class:"btn-secondary",action:this.cancelEdit.bind(this),visible:!0},{label:"Save",class:"btn-primary",action:this.saveEdit.bind(this),visible:!0}]),yield this.initCanvas(),this.updateCanvas()})}onResize(){this.updateCanvas()}getCanvasSize(){let e=Math.min(document.documentElement.clientWidth,window.innerWidth||0),n=Math.min(document.documentElement.clientHeight,window.innerHeight||0),r=document.getElementById("navBar")?.offsetHeight||0;return console.log("PageSize",e,n,r),n-=r,{width:e,height:n}}loadImage(e){return R(this,null,function*(){return new Promise((n,r)=>{let i=new Image;i.src=e,i.onload=()=>n(i),i.onerror=r})})}initCanvas(){return R(this,null,function*(){if(!this.player?.boardGame||!this.player?.annotations?.predictions)throw console.error("Init: Missing image or annotations:",this.player?.boardGame,this.player?.annotations?.predictions),new Error("Init: Missing image or annotations:");let e=yield this.loadImage(this.player.boardGame),n=new Ra("annotationCanvas",{selection:!1}),r=new Vn(e,{originX:"left",originY:"top"});n.backgroundImage=r,this.currentPredictions=this.player?.annotations?.predictions,this.canvas=n,n.on("mouse:down",this.mouseDown.bind(this)),n.on("mouse:move",this.mouseMove.bind(this)),n.on("mouse:up",this.mouseUp.bind(this)),n.on("mouse:wheel",this.zoomCanvasMouseWheel.bind(this)),this.registerTouchEventHandler();for(let i of this.currentPredictions){let o=new rr({left:i.x-i.width/2,top:i.y-i.height/2,width:i.width,height:i.height,fill:"rgba(255, 0, 0, 0.3)",stroke:"red",strokeWidth:2,cornerStyle:"circle"});this.canvas.add(o)}})}updateCanvas(){if(!this.player?.boardGame||!this.player?.annotations?.predictions||!this.canvas||!this.canvas.backgroundImage)throw console.error("Update: Missing image or annotations:",this.player?.boardGame,this.player?.annotations?.predictions,this.canvas,this.canvas?.backgroundImage),new Error("Update: Missing image or annotations:");if(!this.canvas?.getElement()){console.error("Canvas element not found");return}let{width:n,height:r}=this.getCanvasSize();this.canvas.setDimensions({width:n,height:r});let i=this.player.annotations.image,o=n/i.width,l=r/i.height,a=Math.min(o,l);this.canvas.setZoom(a),this.canvas.absolutePan(new A(0,0))}saveEdit(e){alert("Not implemented!")}cancelEdit(e){this.location.back()}getTransformVals(e){let n=window.getComputedStyle(e),r=new DOMMatrixReadOnly(n.transform);return{scaleX:r.m11,scaleY:r.m22,translateX:r.m41,translateY:r.m42,width:e.getBoundingClientRect().width,height:e.getBoundingClientRect().height}}getPinchCoordinates(e,n){return{x1:e.clientX,y1:e.clientY,x2:n.clientX,y2:n.clientY}}getPinchDistance(e,n){let r=this.getPinchCoordinates(e,n);return Math.sqrt(Math.pow(r.x2-r.x1,2)+Math.pow(r.y2-r.y1,2))}setPinchCenter(e,n){let r=this.getPinchCoordinates(e,n),i=(r.x1+r.x2)/2,o=(r.y1+r.y2)/2;if(this.canvas){let l=this.getTransformVals(this.canvas.wrapperEl);this.pinchCenter={x:i-l.translateX,y:o-l.translateY}}}registerTouchEventHandler(){this.canvas&&(this.canvas.upperCanvasEl.addEventListener("touchstart",e=>{console.log("touchstart",e),e.preventDefault(),this.pinchCanvasStart(e),this.dragCanvasStart(e)}),this.canvas.upperCanvasEl.addEventListener("touchmove",e=>{e.preventDefault(),this.pinchCanvas(e),this.dragCanvas(e)}))}dragCanvasStart(e){let n=e.e||e;if(this.canvas?._activeObject)return;this.activeTouchId===null&&e.targetTouches.length>0&&(this.activeTouchId=e.targetTouches[0].identifier);let r=Array.from(e.targetTouches).find(i=>i.identifier===this.activeTouchId);r&&(this.lastPosX=r.clientX,this.lastPosY=r.clientY,this.dragActive=!0)}dragCanvas(e){if(!this.canvas)return;let n=e.e||e;if(!this.dragActive)return;let r=Array.from(n.targetTouches).find(i=>i.identifier===this.activeTouchId);r||this.dragCanvasStart(e),r=Array.from(e.targetTouches).find(i=>i.identifier===this.activeTouchId),r&&this.redrawCanvas(r)}mouseDown(e){let n=e.e||e;!e.target&&!this.dragActive&&(this.lastPosX=n.clientX,this.lastPosY=n.clientY,this.dragActive=!0)}mouseMove(e){let n=e.e||e;this.dragActive&&n.buttons===1&&this.redrawCanvas(n)}mouseUp(e){this.dragActive=!1}redrawCanvas(e){if(this.canvas){let n=this.canvas.viewportTransform,r=n[4]+e.clientX-(this.lastPosX||0),i=n[5]+e.clientY-(this.lastPosY||0);n[4]=r,n[5]=i,this.lastPosX=e.clientX,this.lastPosY=e.clientY,this.canvas.setViewportTransform(n)}}pinchCanvasStart(e){if(this.canvas){if(e.touches.length!==2)return;this.canvas?.discardActiveObject(e),this.startZoom=this.canvas?.getZoom(),this.initialDistance=this.getPinchDistance(e.touches[0],e.touches[1])}}pinchCanvas(e){if(e.touches.length!==2)return;this.canvas?.discardActiveObject(e),this.setPinchCenter(e.touches[0],e.touches[1]);let r=this.getPinchDistance(e.touches[0],e.touches[1])/this.initialDistance;this.zoomCanvas(r*this.startZoom,this.pinchCenter)}zoomCanvasMouseWheel(e){if(this.canvas){var n=e.e.deltaY,r=this.canvas.getZoom();r*=.999**n,r>20&&(r=20),r<.1&&(r=.1),this.canvas.zoomToPoint(new A(e.e.offsetX,e.e.offsetY),r),e.e.preventDefault(),e.e.stopPropagation()}}zoomCanvas(e,n){this.canvas&&(e>20&&(e=20),e<.1&&(e=.1),this.canvas.zoomToPoint(n,e),this.canvas.renderAll())}static \u0275fac=function(n){return new(n||t)(te(Va),te(zi),te(Di))};static \u0275cmp=br({type:t,selectors:[["app-annotation-editor"]],hostBindings:function(n,r){n&1&&At("resize",function(){return r.onResize()},!1,TE)},inputs:{playerNumber:"playerNumber"},decls:1,vars:0,consts:[["id","annotationCanvas"]],template:function(n,r){n&1&&tt(0,"canvas",0)},dependencies:[Xr],encapsulation:2})};var nI=(()=>{class t{_renderer;_elementRef;onChange=n=>{};onTouched=()=>{};constructor(n,r){this._renderer=n,this._elementRef=r}setProperty(n,r){this._renderer.setProperty(this._elementRef.nativeElement,n,r)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}static \u0275fac=function(r){return new(r||t)(te(Ei),te(Hr))};static \u0275dir=Ot({type:t})}return t})(),_b=(()=>{class t extends nI{static \u0275fac=(()=>{let n;return function(i){return(n||(n=_i(t)))(i||t)}})();static \u0275dir=Ot({type:t,features:[zr]})}return t})(),Ff=new z(""),gH={provide:Ff,useExisting:bi(()=>Tb),multi:!0},Tb=(()=>{class t extends _b{writeValue(n){this.setProperty("checked",n)}static \u0275fac=(()=>{let n;return function(i){return(n||(n=_i(t)))(i||t)}})();static \u0275dir=Ot({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(r,i){r&1&&At("change",function(l){return i.onChange(l.target.checked)})("blur",function(){return i.onTouched()})},standalone:!1,features:[ta([gH]),zr]})}return t})(),mH={provide:Ff,useExisting:bi(()=>Lf),multi:!0};function yH(){let t=qr()?qr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var vH=new z(""),Lf=(()=>{class t extends nI{_compositionMode;_composing=!1;constructor(n,r,i){super(n,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!yH())}writeValue(n){let r=n??"";this.setProperty("value",r)}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}static \u0275fac=function(r){return new(r||t)(te(Ei),te(Hr),te(vH,8))};static \u0275dir=Ot({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&At("input",function(l){return i._handleInput(l.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(l){return i._compositionEnd(l.target.value)})},standalone:!1,features:[ta([mH]),zr]})}return t})();function q1(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}var rI=new z(""),bH=new z("");function wH(t){return e=>{if(q1(e.value)||q1(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}function Y1(t){return null}function iI(t){return t!=null}function oI(t){return Ci(t)?He(t):t}function sI(t){let e={};return t.forEach(n=>{e=n!=null?C(C({},e),n):e}),Object.keys(e).length===0?null:e}function aI(t,e){return e.map(n=>n(t))}function _H(t){return!t.validate}function lI(t){return t.map(e=>_H(e)?e:n=>e.validate(n))}function TH(t){if(!t)return null;let e=t.filter(iI);return e.length==0?null:function(n){return sI(aI(n,e))}}function cI(t){return t!=null?TH(lI(t)):null}function xH(t){if(!t)return null;let e=t.filter(iI);return e.length==0?null:function(n){let r=aI(n,e).map(oI);return Zp(r).pipe(se(sI))}}function uI(t){return t!=null?xH(lI(t)):null}function X1(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function EH(t){return t._rawValidators}function CH(t){return t._rawAsyncValidators}function yb(t){return t?Array.isArray(t)?t:[t]:[]}function Nf(t,e){return Array.isArray(t)?t.includes(e):t===e}function K1(t,e){let n=yb(e);return yb(t).forEach(i=>{Nf(n,i)||n.push(i)}),n}function Z1(t,e){return yb(e).filter(n=>!Nf(t,n))}var Rf=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=cI(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=uI(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},vb=class extends Rf{name;get formDirective(){return null}get path(){return null}},Sc=class extends Rf{_parent=null;name=null;valueAccessor=null},bb=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},SH={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},tJ=N(C({},SH),{"[class.ng-submitted]":"isSubmitted"}),dI=(()=>{class t extends bb{constructor(n){super(n)}static \u0275fac=function(r){return new(r||t)(te(Sc,2))};static \u0275dir=Ot({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Gm("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[zr]})}return t})();var Tc="VALID",Pf="INVALID",$a="PENDING",xc="DISABLED",Ha=class{},kf=class extends Ha{value;source;constructor(e,n){super(),this.value=e,this.source=n}},Ec=class extends Ha{pristine;source;constructor(e,n){super(),this.pristine=e,this.source=n}},Cc=class extends Ha{touched;source;constructor(e,n){super(),this.touched=e,this.source=n}},Ua=class extends Ha{status;source;constructor(e,n){super(),this.status=e,this.source=n}};function DH(t){return(Bf(t)?t.validators:t)||null}function IH(t){return Array.isArray(t)?cI(t):t||null}function OH(t,e){return(Bf(e)?e.asyncValidators:t)||null}function AH(t){return Array.isArray(t)?uI(t):t||null}function Bf(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}var wb=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,n){this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return wr(this.statusReactive)}set status(e){wr(()=>this.statusReactive.set(e))}_status=eh(()=>this.statusReactive());statusReactive=Hd(void 0);get valid(){return this.status===Tc}get invalid(){return this.status===Pf}get pending(){return this.status==$a}get disabled(){return this.status===xc}get enabled(){return this.status!==xc}errors;get pristine(){return wr(this.pristineReactive)}set pristine(e){wr(()=>this.pristineReactive.set(e))}_pristine=eh(()=>this.pristineReactive());pristineReactive=Hd(!0);get dirty(){return!this.pristine}get touched(){return wr(this.touchedReactive)}set touched(e){wr(()=>this.touchedReactive.set(e))}_touched=eh(()=>this.touchedReactive());touchedReactive=Hd(!1);get untouched(){return!this.touched}_events=new yt;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(K1(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(K1(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Z1(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Z1(e,this._rawAsyncValidators))}hasValidator(e){return Nf(this._rawValidators,e)}hasAsyncValidator(e){return Nf(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let n=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(N(C({},e),{sourceControl:r})),n&&e.emitEvent!==!1&&this._events.next(new Cc(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(n=>n.markAllAsTouched(e))}markAsUntouched(e={}){let n=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),n&&e.emitEvent!==!1&&this._events.next(new Cc(!1,r))}markAsDirty(e={}){let n=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(N(C({},e),{sourceControl:r})),n&&e.emitEvent!==!1&&this._events.next(new Ec(!1,r))}markAsPristine(e={}){let n=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),n&&e.emitEvent!==!1&&this._events.next(new Ec(!0,r))}markAsPending(e={}){this.status=$a;let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ua(this.status,n)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(N(C({},e),{sourceControl:n}))}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=xc,this.errors=null,this._forEachChild(i=>{i.disable(N(C({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new kf(this.value,r)),this._events.next(new Ua(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(N(C({},e),{skipPristineCheck:n}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Tc,this._forEachChild(r=>{r.enable(N(C({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(N(C({},e),{skipPristineCheck:n}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,n){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},n),this._parent._updateTouched({},n))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Tc||this.status===$a)&&this._runAsyncValidator(r,e.emitEvent)}let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new kf(this.value,n)),this._events.next(new Ua(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(N(C({},e),{sourceControl:n}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?xc:Tc}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,n){if(this.asyncValidator){this.status=$a,this._hasOwnPendingAsyncValidator={emitEvent:n!==!1};let r=oI(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:n,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1,this,n.shouldHaveEmitted)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,n,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Ua(this.status,n)),this._parent&&this._parent._updateControlsErrors(e,n,r)}_initObservables(){this.valueChanges=new It,this.statusChanges=new It}_calculateStatus(){return this._allControlsDisabled()?xc:this.errors?Pf:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus($a)?$a:this._anyControlsHaveStatus(Pf)?Pf:Tc}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,n){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,n),i&&this._events.next(new Ec(this.pristine,n))}_updateTouched(e={},n){this.touched=this._anyControlsTouched(),this._events.next(new Cc(this.touched,n)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,n)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Bf(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=IH(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=AH(this._rawAsyncValidators)}};var hI=new z("",{providedIn:"root",factory:()=>xb}),xb="always";function MH(t,e){return[...e.path,t]}function PH(t,e,n=xb){RH(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),kH(t,e),LH(t,e),FH(t,e),NH(t,e)}function Q1(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function NH(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function RH(t,e){let n=EH(t);e.validator!==null?t.setValidators(X1(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=CH(t);e.asyncValidator!==null?t.setAsyncValidators(X1(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();Q1(e._rawValidators,i),Q1(e._rawAsyncValidators,i)}function kH(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&fI(t,e)})}function FH(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&fI(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function fI(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function LH(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function BH(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function jH(t){return Object.getPrototypeOf(t.constructor)===_b}function VH(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(o=>{o.constructor===Lf?n=o:jH(o)?r=o:i=o}),i||r||n||null}function J1(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function eI(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var $H=class extends wb{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,n,r){super(DH(n),OH(r,n)),this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Bf(n)&&(n.nonNullable||n.initialValueIsDefault)&&(eI(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){J1(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){J1(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){eI(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var UH={provide:Sc,useExisting:bi(()=>Eb)},tI=Promise.resolve(),Eb=(()=>{class t extends Sc{_changeDetectorRef;callSetDisabledState;control=new $H;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new It;constructor(n,r,i,o,l,a){super(),this._changeDetectorRef=l,this.callSetDisabledState=a,this._parent=n,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=VH(this,o)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){let r=n.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),BH(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){PH(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(n){tI.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){let r=n.isDisabled.currentValue,i=r!==0&&_o(r);tI.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?MH(n,this._parent):[n]}static \u0275fac=function(r){return new(r||t)(te(vb,9),te(rI,10),te(bH,10),te(Ff,10),te(Si,8),te(hI,8))};static \u0275dir=Ot({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[ta([UH]),zr,yo]})}return t})();var HH={provide:Ff,useExisting:bi(()=>Cb),multi:!0},Cb=(()=>{class t extends _b{writeValue(n){let r=n??"";this.setProperty("value",r)}registerOnChange(n){this.onChange=r=>{n(r==""?null:parseFloat(r))}}static \u0275fac=(()=>{let n;return function(i){return(n||(n=_i(t)))(i||t)}})();static \u0275dir=Ot({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(r,i){r&1&&At("input",function(l){return i.onChange(l.target.value)})("blur",function(){return i.onTouched()})},standalone:!1,features:[ta([HH]),zr]})}return t})();function GH(t){return typeof t=="number"?t:parseFloat(t)}var zH=(()=>{class t{_validator=Y1;_onChange;_enabled;ngOnChanges(n){if(this.inputName in n){let r=this.normalizeInput(n[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):Y1,this._onChange&&this._onChange()}}validate(n){return this._validator(n)}registerOnValidatorChange(n){this._onChange=n}enabled(n){return n!=null}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ot({type:t,features:[yo]})}return t})();var WH={provide:rI,useExisting:bi(()=>Sb),multi:!0},Sb=(()=>{class t extends zH{min;inputName="min";normalizeInput=n=>GH(n);createValidator=n=>wH(n);static \u0275fac=(()=>{let n;return function(i){return(n||(n=_i(t)))(i||t)}})();static \u0275dir=Ot({type:t,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(r,i){r&2&&Dl("min",i._enabled?i.min:null)},inputs:{min:"min"},standalone:!1,features:[ta([WH]),zr]})}return t})();var qH=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Gr({type:t});static \u0275inj=Vr({})}return t})();var jf=(()=>{class t{static withConfig(n){return{ngModule:t,providers:[{provide:hI,useValue:n.callSetDisabledState??xb}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Gr({type:t});static \u0275inj=Vr({imports:[qH]})}return t})();function pI(t){return{"":"NONE",Yellow:"linden",Brown:"oak",Blue:"silverFir",LightGreen:"birch",Green:"beech",Red:"sycamore",Grey:"douglasFir",Orange:"horseChestnut",Lila:"europeanLarch",Pink:"stonePine"}[t]}var ts=(o=>(o.BASE="BASE",o.TOP="TOP",o.BOTTOM="BOTTOM",o.LEFT="LEFT",o.RIGHT="RIGHT",o))(ts||{});var Vt={Baumsproessling:{speci:"Baumsproessling",color:"",position:"BASE",glCardName:"treeSaplings"},Linde:{speci:"Linde",color:"Yellow",position:"BASE",glCardName:"linden"},Eiche:{speci:"Eiche",color:"Brown",position:"BASE",glCardName:"oak"},Tanne:{speci:"Tanne",color:"Blue",position:"BASE",glCardName:"silverFir"},Birke:{speci:"Birke",color:"LightGreen",position:"BASE",glCardName:"birch"},Buche:{speci:"Buche",color:"Green",position:"BASE",glCardName:"beech"},Ahorn:{speci:"Ahorn",color:"Red",position:"BASE",glCardName:"sycamore"},Douglasie:{speci:"Douglasie",color:"Grey",position:"BASE",glCardName:"douglasFir"},Kastanie:{speci:"Kastanie",color:"Orange",position:"BASE",glCardName:"horseChestnut"},Feldhase_Left_Yellow:{speci:"Feldhase",color:"Yellow",position:"LEFT",glCardName:"europeanHare"},Dachs_Right_Grey:{speci:"Dachs",color:"Grey",position:"RIGHT",glCardName:"europeanBadger"},Feldhase_Left_Brown:{speci:"Feldhase",color:"Brown",position:"LEFT",glCardName:"europeanHare"},Hufeisennase_Right_Yellow:{speci:"Hufeisennase",color:"Yellow",position:"RIGHT",glCardName:"greaterHorseshoeBat"},Feldhase_Left_Blue:{speci:"Feldhase",color:"Blue",position:"LEFT",glCardName:"europeanHare"},Fuchs_Right_Brown:{speci:"Fuchs",color:"Brown",position:"RIGHT",glCardName:"redFox"},Waschbaer_Left_Grey:{speci:"Waschbaer",color:"Grey",position:"LEFT",glCardName:"raccoon"},Feldhase_Right_Red:{speci:"Feldhase",color:"Red",position:"RIGHT",glCardName:"europeanHare"},Wildschwein_Left_Red:{speci:"Wildschwein",color:"Red",position:"LEFT",glCardName:"wildBoar"},Feldhase_Right_Blue:{speci:"Feldhase",color:"Blue",position:"RIGHT",glCardName:"europeanHare"},"Braunes-Langohr_Left_Red":{speci:"Braunes-Langohr",color:"Red",position:"LEFT",glCardName:"brownLongEaredBat"},Feldhase_Right_Yellow:{speci:"Feldhase",color:"Yellow",position:"RIGHT",glCardName:"europeanHare"},Waschbaer_Left_Blue:{speci:"Waschbaer",color:"Blue",position:"LEFT",glCardName:"raccoon"},Reh_Right_Green:{speci:"Reh",color:"Green",position:"RIGHT",glCardName:"roeDeerBeech"},Mopsfledermaus_Left_Orange:{speci:"Mopsfledermaus",color:"Orange",position:"LEFT",glCardName:"barbastelleBat"},Wildschwein_Right_Brown:{speci:"Wildschwein",color:"Brown",position:"RIGHT",glCardName:"wildBoar"},Braunbaer_Left_Yellow:{speci:"Braunbaer",color:"Yellow",position:"LEFT",glCardName:"brownBear"},Waschbaer_Right_Blue:{speci:"Waschbaer",color:"Blue",position:"RIGHT",glCardName:"raccoon"},Steinmarder_Left_Red:{speci:"Steinmarder",color:"Red",position:"LEFT",glCardName:"beechMarten"},Braunbaer_Right_Orange:{speci:"Braunbaer",color:"Orange",position:"RIGHT",glCardName:"brownBear"},Rothirsch_Left_Yellow:{speci:"Rothirsch",color:"Yellow",position:"LEFT",glCardName:"redDeer"},Braunbaer_Right_Green:{speci:"Braunbaer",color:"Green",position:"RIGHT",glCardName:"brownBear"},Mopsfledermaus_Left_Blue:{speci:"Mopsfledermaus",color:"Blue",position:"LEFT",glCardName:"barbastelleBat"},Steinmarder_Right_Orange:{speci:"Steinmarder",color:"Orange",position:"RIGHT",glCardName:"beechMarten"},Luchs_Left_Grey:{speci:"Luchs",color:"Grey",position:"LEFT",glCardName:"lynx"},Feldhase_Right_LightGreen:{speci:"Feldhase",color:"LightGreen",position:"RIGHT",glCardName:"europeanHare"},Wildschwein_Left_LightGreen:{speci:"Wildschwein",color:"LightGreen",position:"LEFT",glCardName:"wildBoar"},Steinmarder_Right_Brown:{speci:"Steinmarder",color:"Brown",position:"RIGHT",glCardName:"beechMarten"},Dachs_Left_Orange:{speci:"Dachs",color:"Orange",position:"LEFT",glCardName:"europeanBadger"},Stechmuecke_Right_Brown:{speci:"Stechmuecke",color:"Brown",position:"RIGHT",glCardName:"gnat"},Fuchs_Left_Yellow:{speci:"Fuchs",color:"Yellow",position:"LEFT",glCardName:"redFox"},Holzbiene_Right_Grey:{speci:"Holzbiene",color:"Grey",position:"RIGHT",glCardName:"violetCarpenterBee"},Reh_Right_Orange:{speci:"Reh",color:"Orange",position:"RIGHT",glCardName:"roeDeerHorseChestnut"},Damhirsch_Left_Yellow:{speci:"Damhirsch",color:"Yellow",position:"LEFT",glCardName:"fallowDeer"},Wildschwein_Right_Grey:{speci:"Wildschwein",color:"Grey",position:"RIGHT",glCardName:"wildBoar"},Reh_Right_LightGreen:{speci:"Reh",color:"LightGreen",position:"RIGHT",glCardName:"roeDeerBirch"},Rothirsch_Left_Blue:{speci:"Rothirsch",color:"Blue",position:"LEFT",glCardName:"redDeer"},Damhirsch_Right_Red:{speci:"Damhirsch",color:"Red",position:"RIGHT",glCardName:"fallowDeer"},Holzbiene_Left_Grey:{speci:"Holzbiene",color:"Grey",position:"LEFT",glCardName:"violetCarpenterBee"},Luchs_Right_Green:{speci:"Luchs",color:"Green",position:"RIGHT",glCardName:"lynx"},Siebenschlaefer_Left_Green:{speci:"Siebenschlaefer",color:"Green",position:"LEFT",glCardName:"europeanFatDormouse"},Mopsfledermaus_Right_Brown:{speci:"Mopsfledermaus",color:"Brown",position:"RIGHT",glCardName:"barbastelleBat"},Hufeisennase_Left_Green:{speci:"Hufeisennase",color:"Green",position:"LEFT",glCardName:"greaterHorseshoeBat"},Siebenschlaefer_Right_Grey:{speci:"Siebenschlaefer",color:"Grey",position:"RIGHT",glCardName:"europeanFatDormouse"},Wolf_Right_Blue:{speci:"Wolf",color:"Blue",position:"RIGHT",glCardName:"wolf"},Siebenschlaefer_Left_Blue:{speci:"Siebenschlaefer",color:"Blue",position:"LEFT",glCardName:"europeanFatDormouse"},"Braunes-Langohr_Right_Green":{speci:"Braunes-Langohr",color:"Green",position:"RIGHT",glCardName:"brownLongEaredBat"},Bechsteinfledermaus_Left_Green:{speci:"Bechsteinfledermaus",color:"Green",position:"LEFT",glCardName:"bechsteinsBat"},Siebenschlaefer_Right_Brown:{speci:"Siebenschlaefer",color:"Brown",position:"RIGHT",glCardName:"europeanFatDormouse"},Stechmuecke_Left_LightGreen:{speci:"Stechmuecke",color:"LightGreen",position:"LEFT",glCardName:"gnat"},Wolf_Left_Grey:{speci:"Wolf",color:"Grey",position:"LEFT",glCardName:"wolf"},Stechmuecke_Right_Orange:{speci:"Stechmuecke",color:"Orange",position:"RIGHT",glCardName:"gnat"},Reh_Left_Yellow:{speci:"Reh",color:"Yellow",position:"LEFT",glCardName:"roeDeerLinden"},Frischling_Right_Red:{speci:"Frischling",color:"Red",position:"RIGHT",glCardName:"squeaker"},Bechsteinfledermaus_Left_Brown:{speci:"Bechsteinfledermaus",color:"Brown",position:"LEFT",glCardName:"bechsteinsBat"},Reh_Left_Blue:{speci:"Reh",color:"Blue",position:"LEFT",glCardName:"roeDeerSilverFir"},Luchs_Right_Yellow:{speci:"Luchs",color:"Yellow",position:"RIGHT",glCardName:"lynx"},Steinmarder_Left_Green:{speci:"Steinmarder",color:"Green",position:"LEFT",glCardName:"beechMarten"},Bechsteinfledermaus_Right_LightGreen:{speci:"Bechsteinfledermaus",color:"LightGreen",position:"RIGHT",glCardName:"bechsteinsBat"},Feldhase_Left_Green:{speci:"Feldhase",color:"Green",position:"LEFT",glCardName:"europeanHare"},Rothirsch_Right_Orange:{speci:"Rothirsch",color:"Orange",position:"RIGHT",glCardName:"redDeer"},Wolf_Left_Red:{speci:"Wolf",color:"Red",position:"LEFT",glCardName:"wolf"},Frischling_Left_Orange:{speci:"Frischling",color:"Orange",position:"LEFT",glCardName:"squeaker"},Rothirsch_Right_Brown:{speci:"Rothirsch",color:"Brown",position:"RIGHT",glCardName:"redDeer"},Fuchs_Left_Green:{speci:"Fuchs",color:"Green",position:"LEFT",glCardName:"redFox"},Frischling_Right_Brown:{speci:"Frischling",color:"Brown",position:"RIGHT",glCardName:"squeaker"},Waschbaer_Right_LightGreen:{speci:"Waschbaer",color:"LightGreen",position:"RIGHT",glCardName:"raccoon"},Frischling_Left_Brown:{speci:"Frischling",color:"Brown",position:"LEFT",glCardName:"squeaker"},Luchs_Right_Blue:{speci:"Luchs",color:"Blue",position:"RIGHT",glCardName:"lynx"},Feldhase_Left_LightGreen:{speci:"Feldhase",color:"LightGreen",position:"LEFT",glCardName:"europeanHare"},Luchs_Left_Orange:{speci:"Luchs",color:"Orange",position:"LEFT",glCardName:"lynx"},Fuchs_Right_Grey:{speci:"Fuchs",color:"Grey",position:"RIGHT",glCardName:"redFox"},Holzbiene_Left_Blue:{speci:"Holzbiene",color:"Blue",position:"LEFT",glCardName:"violetCarpenterBee"},Damhirsch_Right_LightGreen:{speci:"Damhirsch",color:"LightGreen",position:"RIGHT",glCardName:"fallowDeer"},Habicht_Grey:{speci:"Habicht",color:"Grey",position:"TOP",glCardName:"goshawk"},Moos_Yellow:{speci:"Moos",color:"Yellow",position:"BOTTOM",glCardName:"moss"},Buntspecht_Yellow:{speci:"Buntspecht",color:"Yellow",position:"TOP",glCardName:"greatSpottedWoodpecker"},Waldameise_LightGreen:{speci:"Waldameise",color:"LightGreen",position:"BOTTOM",glCardName:"woodAnt"},Buchfink_LightGreen:{speci:"Buchfink",color:"LightGreen",position:"TOP",glCardName:"chaffinch"},Waldameise_Green:{speci:"Waldameise",color:"Green",position:"BOTTOM",glCardName:"woodAnt"},Waldkauz_Green:{speci:"Waldkauz",color:"Green",position:"TOP",glCardName:"tawnyOwl"},Hirschkaefer_Red:{speci:"Hirschkaefer",color:"Red",position:"BOTTOM",glCardName:"stagBeetle"},Kaisermantel_Brown:{speci:"Kaisermantel",color:"Brown",position:"TOP",glCardName:"silverWashedFritillary"},Feuersalamander_Orange:{speci:"Feuersalamander",color:"Orange",position:"BOTTOM",glCardName:"fireSalamander"},Schillerfalter_Orange:{speci:"Schillerfalter",color:"Orange",position:"TOP",glCardName:"purpleEmperor"},Sumpfschildkroete_Red:{speci:"Sumpfschildkroete",color:"Red",position:"BOTTOM",glCardName:"pondTurtle"},Trauermantel_Red:{speci:"Trauermantel",color:"Red",position:"TOP",glCardName:"camberwellBeauty"},Sumpfschildkroete_LightGreen:{speci:"Sumpfschildkroete",color:"LightGreen",position:"BOTTOM",glCardName:"pondTurtle"},"Groser-Fuchs_Blue":{speci:"Groser-Fuchs",color:"Blue",position:"TOP",glCardName:"largeTortoiseshell"},Feuersalamander_Grey:{speci:"Feuersalamander",color:"Grey",position:"BOTTOM",glCardName:"fireSalamander"},Gimpel_Grey:{speci:"Gimpel",color:"Grey",position:"TOP",glCardName:"bullfinch"},Laubfrosch_Yellow:{speci:"Laubfrosch",color:"Yellow",position:"BOTTOM",glCardName:"treeFrog"},Buchfink_Red:{speci:"Buchfink",color:"Red",position:"TOP",glCardName:"chaffinch"},Hirschkaefer_LightGreen:{speci:"Hirschkaefer",color:"LightGreen",position:"BOTTOM",glCardName:"stagBeetle"},Habicht_Blue:{speci:"Habicht",color:"Blue",position:"TOP",glCardName:"goshawk"},Erdkroete_Brown:{speci:"Erdkroete",color:"Brown",position:"BOTTOM",glCardName:"commonToad"},Eichelhaeher_LightGreen:{speci:"Eichelhaeher",color:"LightGreen",position:"TOP",glCardName:"eurasianJay"},Baumfarn_Orange:{speci:"Baumfarn",color:"Orange",position:"BOTTOM",glCardName:"treeFerns"},Walderdbeeren_Red:{speci:"Walderdbeeren",color:"Red",position:"BOTTOM",glCardName:"wildStrawberries"},Brombeeren_Blue:{speci:"Brombeeren",color:"Blue",position:"BOTTOM",glCardName:"blackberries"},Moos_Grey:{speci:"Moos",color:"Grey",position:"BOTTOM",glCardName:"moss"},Gluehwuermchen_Yellow:{speci:"Gluehwuermchen",color:"Yellow",position:"BOTTOM",glCardName:"fireflies"},Brombeeren_LightGreen:{speci:"Brombeeren",color:"LightGreen",position:"BOTTOM",glCardName:"blackberries"},Igel_Green:{speci:"Igel",color:"Green",position:"BOTTOM",glCardName:"hedgehog"},Tagpfauenauge_Blue:{speci:"Tagpfauenauge",color:"Blue",position:"TOP",glCardName:"peacockButterfly"},Igel_Brown:{speci:"Igel",color:"Brown",position:"BOTTOM",glCardName:"hedgehog"},Eichhoernchen_Grey:{speci:"Eichhoernchen",color:"Grey",position:"TOP",glCardName:"redSquirrel"},Erdkroete_Orange:{speci:"Erdkroete",color:"Orange",position:"BOTTOM",glCardName:"commonToad"},Eichhoernchen_Orange:{speci:"Eichhoernchen",color:"Orange",position:"TOP",glCardName:"redSquirrel"},Gluehwuermchen_Red:{speci:"Gluehwuermchen",color:"Red",position:"BOTTOM",glCardName:"fireflies"},Buchfink_Green:{speci:"Buchfink",color:"Green",position:"TOP",glCardName:"chaffinch"},Erdkroete_Blue:{speci:"Erdkroete",color:"Blue",position:"BOTTOM",glCardName:"commonToad"},Gluehwuermchen_Grey:{speci:"Gluehwuermchen",color:"Grey",position:"BOTTOM",glCardName:"fireflies"},Kaisermantel_Green:{speci:"Kaisermantel",color:"Green",position:"TOP",glCardName:"silverWashedFritillary"},Tagpfauenauge_Brown:{speci:"Tagpfauenauge",color:"Brown",position:"TOP",glCardName:"peacockButterfly"},Pfifferling_Blue:{speci:"Pfifferling",color:"Blue",position:"BOTTOM",glCardName:"chanterelle"},Tagpfauenauge_Orange:{speci:"Tagpfauenauge",color:"Orange",position:"TOP",glCardName:"peacockButterfly"},Gluehwuermchen_Green:{speci:"Gluehwuermchen",color:"Green",position:"BOTTOM",glCardName:"fireflies"},"Groser-Fuchs_Red":{speci:"Groser-Fuchs",color:"Red",position:"TOP",glCardName:"largeTortoiseshell"},Maulwurf_Brown:{speci:"Maulwurf",color:"Brown",position:"BOTTOM",glCardName:"mole"},Igel_Orange:{speci:"Igel",color:"Orange",position:"BOTTOM",glCardName:"hedgehog"},Buntspecht_Grey:{speci:"Buntspecht",color:"Grey",position:"TOP",glCardName:"greatSpottedWoodpecker"},Eichelhaeher_Red:{speci:"Eichelhaeher",color:"Red",position:"TOP",glCardName:"eurasianJay"},Fliegenpilz_Blue:{speci:"Fliegenpilz",color:"Blue",position:"BOTTOM",glCardName:"flyagaric"},Waldkauz_LightGreen:{speci:"Waldkauz",color:"LightGreen",position:"TOP",glCardName:"tawnyOwl"},Steinpilz_Grey:{speci:"Steinpilz",color:"Grey",position:"BOTTOM",glCardName:"pennyBun"},Eichhoernchen_Green:{speci:"Eichhoernchen",color:"Green",position:"TOP",glCardName:"redSquirrel"},Feuersalamander_Yellow:{speci:"Feuersalamander",color:"Yellow",position:"BOTTOM",glCardName:"fireSalamander"},Schillerfalter_LightGreen:{speci:"Schillerfalter",color:"LightGreen",position:"TOP",glCardName:"purpleEmperor"},Laubfrosch_Brown:{speci:"Laubfrosch",color:"Brown",position:"BOTTOM",glCardName:"treeFrog"},Tagpfauenauge_Yellow:{speci:"Tagpfauenauge",color:"Yellow",position:"TOP",glCardName:"peacockButterfly"},Erdkroete_Green:{speci:"Erdkroete",color:"Green",position:"BOTTOM",glCardName:"commonToad"},Trauermantel_LightGreen:{speci:"Trauermantel",color:"LightGreen",position:"TOP",glCardName:"camberwellBeauty"},Parasol_Orange:{speci:"Parasol",color:"Orange",position:"BOTTOM",glCardName:"parasolMushroom"},Habicht_Brown:{speci:"Habicht",color:"Brown",position:"TOP",glCardName:"goshawk"},Erdkroete_Red:{speci:"Erdkroete",color:"Red",position:"BOTTOM",glCardName:"commonToad"},Eichelhaeher_Orange:{speci:"Eichelhaeher",color:"Orange",position:"TOP",glCardName:"eurasianJay"},Baumfarn_Blue:{speci:"Baumfarn",color:"Blue",position:"BOTTOM",glCardName:"treeFerns"},Waldkauz_Red:{speci:"Waldkauz",color:"Red",position:"TOP",glCardName:"tawnyOwl"},Erdkroete_Grey:{speci:"Erdkroete",color:"Grey",position:"BOTTOM",glCardName:"commonToad"},Gimpel_Blue:{speci:"Gimpel",color:"Blue",position:"TOP",glCardName:"bullfinch"},Baumfarn_Yellow:{speci:"Baumfarn",color:"Yellow",position:"BOTTOM",glCardName:"treeFerns"},Eichhoernchen_Brown:{speci:"Eichhoernchen",color:"Brown",position:"TOP",glCardName:"redSquirrel"},Walderdbeeren_LightGreen:{speci:"Walderdbeeren",color:"LightGreen",position:"BOTTOM",glCardName:"wildStrawberries"},Brombeeren_Green:{speci:"Brombeeren",color:"Green",position:"BOTTOM",glCardName:"blackberries"},Schillerfalter_Yellow:{speci:"Schillerfalter",color:"Yellow",position:"TOP",glCardName:"purpleEmperor"},Fliegenpilz_Brown:{speci:"Fliegenpilz",color:"Brown",position:"BOTTOM",glCardName:"flyagaric"},Trauermantel_Orange:{speci:"Trauermantel",color:"Orange",position:"TOP",glCardName:"camberwellBeauty"},Pfifferling_LightGreen:{speci:"Pfifferling",color:"LightGreen",position:"BOTTOM",glCardName:"chanterelle"},"Groser-Fuchs_Green":{speci:"Groser-Fuchs",color:"Green",position:"TOP",glCardName:"largeTortoiseshell"},Maulwurf_Red:{speci:"Maulwurf",color:"Red",position:"BOTTOM",glCardName:"mole"},Parasol_Blue:{speci:"Parasol",color:"Blue",position:"BOTTOM",glCardName:"parasolMushroom"},"Europaeische-Laerche":{speci:"Europaeische-Laerche",color:"Lila",position:"BASE",glCardName:"europeanLarch"},Zirbelkiefer:{speci:"Zirbelkiefer",color:"Pink",position:"BASE",glCardName:"stonePine"},Alpenmurmeltier_Left_Green:{speci:"Alpenmurmeltier",color:"Green",position:"LEFT",glCardName:"alpineMarmot"},Gaemse_Right_Pink:{speci:"Gaemse",color:"Pink",position:"RIGHT",glCardName:"chamoisStonePine"},Alpenmurmeltier_Left_Lila:{speci:"Alpenmurmeltier",color:"Lila",position:"LEFT",glCardName:"alpineMarmot"},Auerhuhn_Right_Grey:{speci:"Auerhuhn",color:"Grey",position:"RIGHT",glCardName:"capercaillie"},Schneehase_Left_Blue:{speci:"Schneehase",color:"Blue",position:"LEFT",glCardName:"mountainHare"},Alpenmurmeltier_Right_Pink:{speci:"Alpenmurmeltier",color:"Pink",position:"RIGHT",glCardName:"alpineMarmot"},Steinbock_Left_Lila:{speci:"Steinbock",color:"Lila",position:"LEFT",glCardName:"steinbock"},Alpenmurmeltier_Right_LightGreen:{speci:"Alpenmurmeltier",color:"LightGreen",position:"RIGHT",glCardName:"alpineMarmot"},Gaemse_Left_Lila:{speci:"Gaemse",color:"Lila",position:"LEFT",glCardName:"chamoisEuropeanLarch"},Auerhuhn_Right_Green:{speci:"Auerhuhn",color:"Green",position:"RIGHT",glCardName:"capercaillie"},Schneehase_Left_Lila:{speci:"Schneehase",color:"Lila",position:"LEFT",glCardName:"mountainHare"},Gaemse_Right_Grey:{speci:"Gaemse",color:"Grey",position:"RIGHT",glCardName:"chamoisDouglasFir"},Alpenfledermaus_Left_Blue:{speci:"Alpenfledermaus",color:"Blue",position:"LEFT",glCardName:"savisPipistrelle"},Steinbock_Right_Pink:{speci:"Steinbock",color:"Pink",position:"RIGHT",glCardName:"steinbock"},Auerhuhn_Left_Lila:{speci:"Auerhuhn",color:"Lila",position:"LEFT",glCardName:"capercaillie"},Alpenfledermaus_Right_Pink:{speci:"Alpenfledermaus",color:"Pink",position:"RIGHT",glCardName:"savisPipistrelle"},Auerhuhn_Left_Pink:{speci:"Auerhuhn",color:"Pink",position:"LEFT",glCardName:"capercaillie"},Steinbock_Right_Grey:{speci:"Steinbock",color:"Grey",position:"RIGHT",glCardName:"steinbock"},"Alpen-Apollofalter_Pink":{speci:"Alpen-Apollofalter",color:"Pink",position:"TOP",glCardName:"phoebusApollo"},Herbsttrompete_Lila:{speci:"Herbsttrompete",color:"Lila",position:"BOTTOM",glCardName:"blackTrumpet"},"Alpen-Apollofalter_Grey":{speci:"Alpen-Apollofalter",color:"Grey",position:"TOP",glCardName:"phoebusApollo"},Edelweis_Pink:{speci:"Edelweis",color:"Pink",position:"BOTTOM",glCardName:"edelweiss"},"Alpen-Apollofalter_Lila":{speci:"Alpen-Apollofalter",color:"Lila",position:"TOP",glCardName:"phoebusApollo"},Heidelbeere_LightGreen:{speci:"Heidelbeere",color:"LightGreen",position:"BOTTOM",glCardName:"blueberry"},"Alpen-Apollofalter_Blue":{speci:"Alpen-Apollofalter",color:"Blue",position:"TOP",glCardName:"phoebusApollo"},Bergmolch_Pink:{speci:"Bergmolch",color:"Pink",position:"BOTTOM",glCardName:"alpineNewt"},Steinadler_Green:{speci:"Steinadler",color:"Green",position:"TOP",glCardName:"goldenEagle"},Herbsttrompete_Pink:{speci:"Herbsttrompete",color:"Pink",position:"BOTTOM",glCardName:"blackTrumpet"},Bartgeier_Blue:{speci:"Bartgeier",color:"Blue",position:"TOP",glCardName:"beardedVulture"},Enzian_Lila:{speci:"Enzian",color:"Lila",position:"BOTTOM",glCardName:"gentian"},Steinadler_Lila:{speci:"Steinadler",color:"Lila",position:"TOP",glCardName:"goldenEagle"},Bergmolch_Grey:{speci:"Bergmolch",color:"Grey",position:"BOTTOM",glCardName:"alpineNewt"},Kolkrabe_Lila:{speci:"Kolkrabe",color:"Lila",position:"TOP",glCardName:"commonRaven"},Enzian_Green:{speci:"Enzian",color:"Green",position:"BOTTOM",glCardName:"gentian"},Kolkrabe_Grey:{speci:"Kolkrabe",color:"Grey",position:"TOP",glCardName:"commonRaven"},Heidelbeere_Pink:{speci:"Heidelbeere",color:"Pink",position:"BOTTOM",glCardName:"blueberry"},Bartgeier_Lila:{speci:"Bartgeier",color:"Lila",position:"TOP",glCardName:"beardedVulture"},Bergmolch_Blue:{speci:"Bergmolch",color:"Blue",position:"BOTTOM",glCardName:"alpineNewt"},Bartgeier_Pink:{speci:"Bartgeier",color:"Pink",position:"TOP",glCardName:"beardedVulture"},Edelweis_Lila:{speci:"Edelweis",color:"Lila",position:"BOTTOM",glCardName:"edelweiss"},Steinadler_Blue:{speci:"Steinadler",color:"Blue",position:"TOP",glCardName:"goldenEagle"},Enzian_Pink:{speci:"Enzian",color:"Pink",position:"BOTTOM",glCardName:"gentian"},Alpenfledermaus_Left_Lila:{speci:"Alpenfledermaus",color:"Lila",position:"LEFT",glCardName:"savisPipistrelle"},Schneehase_Right_Pink:{speci:"Schneehase",color:"Pink",position:"RIGHT",glCardName:"mountainHare"},Holunder_Yellow:{speci:"Holunder",color:"Yellow",position:"BASE",glCardName:"elderberry"},Holunder_Red:{speci:"Holunder",color:"Red",position:"BASE",glCardName:"elderberry"},Holunder_LightGreen:{speci:"Holunder",color:"LightGreen",position:"BASE",glCardName:"elderberry"},Holunder_Brown:{speci:"Holunder",color:"Brown",position:"BASE",glCardName:"elderberry"},Haselnuss_Orange:{speci:"Haselnuss",color:"Orange",position:"BASE",glCardName:"commonHazel"},Haselnuss_Brown:{speci:"Haselnuss",color:"Brown",position:"BASE",glCardName:"commonHazel"},Haselnuss_Green:{speci:"Haselnuss",color:"Green",position:"BASE",glCardName:"commonHazel"},Haselnuss_LightGreen:{speci:"Haselnuss",color:"LightGreen",position:"BASE",glCardName:"commonHazel"},Schlehdorn_Grey:{speci:"Schlehdorn",color:"Grey",position:"BASE",glCardName:"blackthorn"},Schlehdorn_LightGreen:{speci:"Schlehdorn",color:"LightGreen",position:"BASE",glCardName:"blackthorn"},Schlehdorn_Blue:{speci:"Schlehdorn",color:"Blue",position:"BASE",glCardName:"blackthorn"},Schlehdorn_Red:{speci:"Schlehdorn",color:"Red",position:"BASE",glCardName:"blackthorn"},Landkaertchen_Yellow:{speci:"Landkaertchen",color:"Yellow",position:"TOP",glCardName:"mapButterfly"},Fingerhut_Grey:{speci:"Fingerhut",color:"Grey",position:"BOTTOM",glCardName:"digitalis"},Landkaertchen_Red:{speci:"Landkaertchen",color:"Red",position:"TOP",glCardName:"mapButterfly"},Brennnessel_LightGreen:{speci:"Brennnessel",color:"LightGreen",position:"BOTTOM",glCardName:"stingingNettle"},Landkaertchen_Brown:{speci:"Landkaertchen",color:"Brown",position:"TOP",glCardName:"mapButterfly"},"Gruenes-Heupferd_Blue":{speci:"Gruenes-Heupferd",color:"Blue",position:"BOTTOM",glCardName:"greatGreenBushCricket"},Landkaertchen_Blue:{speci:"Landkaertchen",color:"Blue",position:"TOP",glCardName:"mapButterfly"},Schermaus_Red:{speci:"Schermaus",color:"Red",position:"BOTTOM",glCardName:"waterVole"},Elster_Green:{speci:"Elster",color:"Green",position:"TOP",glCardName:"eurasianMagpie"},Fingerhut_LightGreen:{speci:"Fingerhut",color:"LightGreen",position:"BOTTOM",glCardName:"digitalis"},Elster_Blue:{speci:"Elster",color:"Blue",position:"TOP",glCardName:"eurasianMagpie"},Brennnessel_Orange:{speci:"Brennnessel",color:"Orange",position:"BOTTOM",glCardName:"stingingNettle"},Elster_LightGreen:{speci:"Elster",color:"LightGreen",position:"TOP",glCardName:"eurasianMagpie"},"Gruenes-Heupferd_Green":{speci:"Gruenes-Heupferd",color:"Green",position:"BOTTOM",glCardName:"greatGreenBushCricket"},Nachtigall_Green:{speci:"Nachtigall",color:"Green",position:"TOP",glCardName:"nightingale"},Fingerhut_Red:{speci:"Fingerhut",color:"Red",position:"BOTTOM",glCardName:"digitalis"},Nachtigall_Brown:{speci:"Nachtigall",color:"Brown",position:"TOP",glCardName:"nightingale"},Brennnessel_Red:{speci:"Brennnessel",color:"Red",position:"BOTTOM",glCardName:"stingingNettle"},Nachtigall_Orange:{speci:"Nachtigall",color:"Orange",position:"TOP",glCardName:"nightingale"},Schermaus_Green:{speci:"Schermaus",color:"Green",position:"BOTTOM",glCardName:"waterVole"},Schleiereule_LightGreen:{speci:"Schleiereule",color:"LightGreen",position:"TOP",glCardName:"barnOwl"},Fingerhut_Brown:{speci:"Fingerhut",color:"Brown",position:"BOTTOM",glCardName:"digitalis"},Schleiereule_Red:{speci:"Schleiereule",color:"Red",position:"TOP",glCardName:"barnOwl"},"Gruenes-Heupferd_Brown":{speci:"Gruenes-Heupferd",color:"Brown",position:"BOTTOM",glCardName:"greatGreenBushCricket"},Bache_Left_LightGreen:{speci:"Bache",color:"LightGreen",position:"LEFT",glCardName:"wildBoarFemale"},Bienenschwarm_Right_Red:{speci:"Bienenschwarm",color:"Red",position:"RIGHT",glCardName:"beeSwarm"},Wisent_Left_Brown:{speci:"Wisent",color:"Brown",position:"LEFT",glCardName:"europeanBison"},Bache_Right_Red:{speci:"Bache",color:"Red",position:"RIGHT",glCardName:"wildBoarFemale"},Bache_Left_Blue:{speci:"Bache",color:"Blue",position:"LEFT",glCardName:"wildBoarFemale"},Wildkatze_Right_Orange:{speci:"Wildkatze",color:"Orange",position:"RIGHT",glCardName:"europeanWildcat"},Zwergfledermaus_Left_Yellow:{speci:"Zwergfledermaus",color:"Yellow",position:"LEFT",glCardName:"commonPipistrelle"},"Frischling-Waldrand_Right_Blue":{speci:"Frischling-Waldrand",color:"Blue",position:"RIGHT",glCardName:"squeakerWE"},"Frischling-Waldrand_Left_Orange":{speci:"Frischling-Waldrand",color:"Orange",position:"LEFT",glCardName:"squeakerWE"},Schnake_Right_Green:{speci:"Schnake",color:"Green",position:"RIGHT",glCardName:"craneFly"},Waldiltis_Left_Blue:{speci:"Waldiltis",color:"Blue",position:"LEFT",glCardName:"europeanPolecat"},"Frischling-Waldrand_Right_Grey":{speci:"Frischling-Waldrand",color:"Grey",position:"RIGHT",glCardName:"squeakerWE"},Bienenschwarm_Left_Green:{speci:"Bienenschwarm",color:"Green",position:"LEFT",glCardName:"beeSwarm"},Zwergfledermaus_Right_Red:{speci:"Zwergfledermaus",color:"Red",position:"RIGHT",glCardName:"commonPipistrelle"},Wildkatze_Left_Brown:{speci:"Wildkatze",color:"Brown",position:"LEFT",glCardName:"europeanWildcat"},Bienenschwarm_Right_LightGreen:{speci:"Bienenschwarm",color:"LightGreen",position:"RIGHT",glCardName:"beeSwarm"},Zwergfledermaus_Left_LightGreen:{speci:"Zwergfledermaus",color:"LightGreen",position:"LEFT",glCardName:"commonPipistrelle"},Wisent_Right_Green:{speci:"Wisent",color:"Green",position:"RIGHT",glCardName:"europeanBison"},Wisent_Left_Green:{speci:"Wisent",color:"Green",position:"LEFT",glCardName:"europeanBison"},Waldiltis_Right_Red:{speci:"Waldiltis",color:"Red",position:"RIGHT",glCardName:"europeanPolecat"},Schnake_Left_LightGreen:{speci:"Schnake",color:"LightGreen",position:"LEFT",glCardName:"craneFly"},Waldiltis_Right_Brown:{speci:"Waldiltis",color:"Brown",position:"RIGHT",glCardName:"europeanPolecat"},Wildkatze_Left_Red:{speci:"Wildkatze",color:"Red",position:"LEFT",glCardName:"europeanWildcat"},Schnake_Right_Brown:{speci:"Schnake",color:"Brown",position:"RIGHT",glCardName:"craneFly"}};var gI={BASE:0,LEFT:1,RIGHT:2,TOP:3,BOTTOM:4},Vf=class t{static compareCards(e,n){if(e.position!==n.position)return gI[e.position]-gI[n.position];switch(e.position){case"BASE":return Math.abs(e.y-n.y)<e.height/2?e.x-n.x:e.y-n.y;case"LEFT":return n.x-e.x;case"RIGHT":return e.x-n.x;case"TOP":return n.y-e.y;case"BOTTOM":return e.y-n.y;default:return 0}}static findNearestCard(e,n){let r=null,i=1/0;for(let o of n){if(o===e||!["BASE",e.position].includes(o.position))continue;switch(e.position){case"LEFT":if(o.x<=e.x)continue;break;case"RIGHT":if(o.x>=e.x)continue;break;case"TOP":if(o.y<=e.y)continue;break;case"BOTTOM":if(o.y>=e.y)continue;break}let l=Math.pow(e.x-o.x,2)+Math.pow(e.y-o.y,2);l<i&&(i=l,r=o)}return r}static assembleForest(e){let n=[],r=[];for(let o of e.predictions){let l=Vt[o.class];r.push(C(C({},o),l))}r.sort(t.compareCards);let i=0;for(let o of r)if(o.position=="BASE")o.baseIndex=i,i++;else{let l=t.findNearestCard(o,r);if(l===null)throw new Error(`No nearest card found for card at position (${o?.x}, ${o?.y})`);if(l.baseIndex===void 0||l.baseIndex===null)throw new Error(`Base index not defined for nearest card at position (${l?.x}, ${l?.y})`);o.baseIndex=l.baseIndex}for(let o of r){let l={id:o.class,color:o.color,baseIndex:o.baseIndex};n.push(l)}return n}};var KH={name:"beech",type:"beech",symbols:["tree","beech"],recalculatePoints(t){let e=this.count,r=t.cards.find(i=>i.name==="violetCarpenterBee").params[0].value;e+r>=4?this.points=e*5:this.points=0}},ZH={name:"birch",type:"birch",symbols:["tree","birch"],recalculatePoints(t){this.points=this.count}},QH={name:"douglasFir",type:"douglasFir",symbols:["tree","douglasFir"],recalculatePoints(t){this.points=this.count*5}},JH={name:"horseChestnut",type:"horseChestnut",symbols:["tree","horseChestnut"],recalculatePoints(t){let e=t.cards.find(r=>r.name==="violetCarpenterBee"),n=this.count+e.params[1].value;this.points=Math.min(n*n,49)}},eG={name:"linden",type:"linden",symbols:["tree","linden"],params:[{name:"hasMostLindens",type:"boolean",distributed:!0,value:!1}],recalculatePoints(t){let e=t.distributedScoring?this.params[0].value:t.hasMostOfName("linden");this.points=this.count*(e?3:1)}},tG={name:"oak",type:"oak",symbols:["tree","oak"],recalculatePoints(t){t.cards.filter(n=>n.symbols.indexOf("tree")>=0&&n.name!=="treeSaplings"&&n.count>0).length>=8?this.points=this.count*10:this.points=0}},nG={name:"silverFir",type:"silverFir",symbols:["tree","silverFir"],params:[{name:"cardsAttachedToSilverFirs",type:"number",value:0,unrestricted:!0}],recalculatePoints(t){this.points=this.params[0].value*2}},rG={name:"sycamore",type:"sycamore",symbols:["tree","sycamore"],recalculatePoints(t){this.points=t.countByName("sycamore")*t.countBySymbol("tree")}},iG={name:"treeSaplings",type:"none",symbols:["tree"],recalculatePoints(t){}},oG={name:"europeanLarch",type:"alpineLarch",symbols:["tree","europeanLarch","alps"],recalculatePoints(t){this.points=this.count*3}},sG={name:"stonePine",type:"stonePine",symbols:["tree","stonePine","alps"],recalculatePoints(t){this.points=this.count*t.countBySymbol("alps")}},aG={name:"downyBirch",symbols:["tree"],hide:t=>!t.hobbyPromo,recalculatePoints(t){this.points=this.count}},mI=[KH,ZH,QH,JH,eG,tG,nG,rG,oG,sG,iG,aG];var lG={name:"bullfinch",position:"top",symbols:["bird"],recalculatePoints(t){this.points=this.count*t.countBySymbol("insect")*2}},cG={name:"chaffinch",position:"top",symbols:["bird"],params:[{name:"chaffinchesAtopABeech",type:"number",value:0}],recalculatePoints(t){this.points=this.params[0].value*5}},uG={name:"eurasianJay",position:"top",symbols:["bird"],recalculatePoints(t){this.points=this.count*3}},dG={name:"goshawk",position:"top",symbols:["bird"],recalculatePoints(t){this.points=this.count*t.countBySymbol("bird")*3}},hG={name:"greatSpottedWoodpecker",position:"top",symbols:["bird"],params:[{name:"hasMostTrees",type:"boolean",distributed:!0,value:!1}],recalculatePoints(t){let e=t.distributedScoring?this.params[0].value:t.hasMostTrees();this.points=e?this.count*10:0}},fG={name:"tawnyOwl",position:"top",symbols:["bird"],recalculatePoints(t){this.points=this.count*5}},pG={name:"capercaillie",position:"side",symbols:["bird","alps"],recalculatePoints(t){this.points=this.count*t.countBySymbol("plant")}},gG={name:"goldenEagle",position:"top",symbols:["bird","alps"],recalculatePoints(t){this.points=this.count*(t.countBySymbol("pawedAnimal")+t.countBySymbol("amphibian"))}},mG={name:"beardedVulture",position:"top",symbols:["bird","alps"],recalculatePoints(t){this.points=this.count*t.caveCount}},yG={name:"commonRaven",position:"top",symbols:["bird","alps"],recalculatePoints(t){this.points=this.count*5}},vG={name:"eurasianMagpie",position:"top",symbols:["bird","woodlandEdge"],recalculatePoints(t){this.points=this.count*3}},bG={name:"nightingale",position:"top",symbols:["bird","woodlandEdge"],params:[{name:"nightingalesAtopAShrub",type:"number",value:0}],recalculatePoints(t){this.points=this.params[0].value*5}},wG={name:"barnOwl",position:"top",symbols:["bird","woodlandEdge"],recalculatePoints(t){this.points=3*this.count*t.countBySymbol("bat")}},_G={name:"whinchat",symbols:["bird"],hide:t=>!t.hobbyPromo,recalculatePoints(t){this.points=this.count*t.countBySymbol("plant")}},yI=[lG,cG,uG,dG,hG,fG,pG,gG,mG,yG,vG,bG,wG,_G];var TG=[0,0,3,6,12,20,35,55];function vI(t){let e=t.cards.filter(r=>r.symbols.indexOf("butterfly")>=0&&r.count>0).map(r=>r.count),n=0;for(;e.length>0;)n+=TG[e.length],e=e.map(r=>r-1).filter(r=>r>0);return n}var xG={name:"camberwellBeauty",position:"top",symbols:["butterfly","insect"],recalculatePoints(t){}},EG={name:"peacockButterfly",position:"top",symbols:["butterfly","insect"],recalculatePoints(t){}},CG={name:"silverWashedFritillary",position:"top",symbols:["butterfly","insect"],recalculatePoints(t){}},SG={name:"purpleEmperor",position:"top",symbols:["butterfly","insect"],recalculatePoints(t){}},DG={name:"largeTortoiseshell",position:"top",symbols:["butterfly","insect"],recalculatePoints(t){}},IG={name:"phoebusApollo",position:"top",symbols:["butterfly","insect","alps"],recalculatePoints(t){}},OG={name:"mapButterfly",position:"top",symbols:["butterfly","insect","woodlandEdge"],recalculatePoints(t){}},bI=[xG,EG,CG,SG,DG,IG,OG];var AG={name:"redSquirrel",position:"top",symbols:["pawedAnimal"],params:[{name:"redSquirrelsAtopAnOak",type:"number",value:0}],recalculatePoints(t){this.points=this.params[0].value*5}},wI=[AG];var MG={name:"blackberries",position:"bottom",symbols:["plant"],recalculatePoints(t){this.points=this.count*t.countBySymbol("plant")*2}},PG={name:"moss",position:"bottom",symbols:["plant"],recalculatePoints(t){t.countTreesIncludingVioletCarpenterBee()>=10?this.points=this.count*10:this.points=0}},NG={name:"treeFerns",position:"bottom",symbols:["plant"],recalculatePoints(t){this.points=this.count*t.countBySymbol("amphibian")*6}},RG={name:"wildStrawberries",position:"bottom",symbols:["plant"],recalculatePoints(t){t.cards.filter(n=>n.symbols.indexOf("tree")>=0&&n.name!=="treeSaplings"&&n.count>0).length>=8?this.points=this.count*10:this.points=0}},kG={name:"edelweiss",position:"bottom",symbols:["plant","alps"],recalculatePoints(t){this.points=this.count*3}},FG={name:"blueberry",position:"bottom",symbols:["plant","alps"],recalculatePoints(t){this.points=this.count*2*t.countDistinctBySymbol("bird")}},LG={name:"gentian",position:"bottom",symbols:["plant","alps"],recalculatePoints(t){this.points=this.count*3*t.countBySymbol("butterfly")}},BG={name:"digitalis",position:"bottom",symbols:["plant","woodlandEdge"],recalculatePoints(t){let e=[0,1,3,6,10,15];this.points=this.count*e[Math.min(5,t.countDistinctBySymbol("plant"))]}},jG={name:"stingingNettle",position:"bottom",symbols:["plant","woodlandEdge"],recalculatePoints(t){this.points=2*this.count*t.countBySymbol("butterfly")}},VG={name:"maretak",position:"top",symbols:["plant","woodlandEdge"],hide:t=>!t.maretakPromo,recalculatePoints(t){this.points=this.count*t.countBySymbol("plant")}},$G={name:"bostulp",position:"bottom",symbols:["plant","woodlandEdge"],hide:t=>!t.maretakPromo,recalculatePoints(t){this.points=3*this.count}},_I=[MG,NG,RG,PG,kG,FG,LG,BG,jG,VG,$G];var UG={name:"chanterelle",position:"bottom",symbols:["mushroom"],recalculatePoints(t){}},HG={name:"flyagaric",position:"bottom",symbols:["mushroom"],recalculatePoints(t){}},GG={name:"parasolMushroom",position:"bottom",symbols:["mushroom"],recalculatePoints(t){}},zG={name:"pennyBun",position:"bottom",symbols:["mushroom"],recalculatePoints(t){}},WG={name:"blackTrumpet",position:"bottom",symbols:["mushroom","alps"],recalculatePoints(t){}},TI=[UG,HG,GG,zG,WG];var qG={name:"commonToad",position:"bottom",symbols:["amphibian"],params:[{name:"sharingACardSlot",type:"number",value:0}],recalculatePoints(t){this.points=this.params[0].value*5}},YG={name:"pondTurtle",position:"bottom",symbols:["amphibian"],recalculatePoints(t){this.points=this.count*5}},XG={name:"treeFrog",position:"bottom",symbols:["amphibian"],recalculatePoints(t){this.points=this.count*t.countByName("gnat")*5}},KG={name:"fireSalamander",position:"bottom",symbols:["amphibian"],recalculatePoints(t){this.points=[0,5,15,25][Math.min(3,this.count)]}},ZG={name:"alpineNewt",position:"bottom",symbols:["amphibian","alps"],recalculatePoints(t){this.points=this.count*2*t.countBySymbol("insect")}},xI=[qG,YG,XG,KG,ZG];var QG={name:"gnat",position:"side",symbols:["insect"],recalculatePoints(t){this.points=t.countByName("gnat")*t.countBySymbol("bat")}},JG={name:"fireflies",position:"bottom",symbols:["insect"],recalculatePoints(t){this.points=[0,0,10,15,20][Math.min(4,this.count)]}},e6={name:"woodAnt",position:"bottom",symbols:["insect"],recalculatePoints(t){this.points=this.count*t.countByPosition("bottom")*2}},t6={name:"stagBeetle",position:"bottom",symbols:["insect"],recalculatePoints(t){this.points=this.count*t.countBySymbol("pawedAnimal")}},n6={name:"violetCarpenterBee",position:"side",symbols:["insect"],params:[{name:"onABeech",type:"number",value:0},{name:"onAHorseChestnut",type:"number",value:0},{name:"onALinden",type:"number",value:0}],recalculatePoints(t){}},r6={name:"greatGreenBushCricket",position:"bottom",symbols:["insect","woodlandEdge"],recalculatePoints(t){this.points=this.count*t.countBySymbol("insect")}},i6={name:"beeSwarm",position:"side",symbols:["insect","woodlandEdge"],recalculatePoints(t){this.points=this.count*t.countBySymbol("plant")}},o6={name:"craneFly",position:"side",symbols:["insect","woodlandEdge"],recalculatePoints(t){this.points=this.count*t.countBySymbol("bat")}},EI=[QG,JG,e6,t6,n6,r6,i6,o6];var s6={name:"hedgehog",position:"bottom",symbols:["pawedAnimal"],recalculatePoints(t){this.points=this.count*t.countBySymbol("butterfly")*2}},a6={name:"mole",position:"bottom",symbols:["pawedAnimal"],recalculatePoints(t){}},l6={name:"beechMarten",position:"side",symbols:["pawedAnimal"],params:[{name:"fullyOccupiedTrees",type:"number",value:0,unrestricted:!0}],recalculatePoints(t){this.points=this.count*5*this.params[0].value}},c6={name:"brownBear",position:"side",symbols:["pawedAnimal"],recalculatePoints(t){}},u6={name:"europeanBadger",position:"side",symbols:["pawedAnimal"],recalculatePoints(t){this.points=this.count*2}},d6={name:"europeanFatDormouse",position:"side",symbols:["pawedAnimal"],params:[{name:"batOnTheOtherSide",type:"number",value:0}],recalculatePoints(t){this.points=this.params[0].value*15}},Db=t=>t.countByName("europeanHare")+t.countByName("mountainHare"),h6={name:"europeanHare",position:"side",symbols:["pawedAnimal"],recalculatePoints(t){this.points=this.count*Db(t)}},f6={name:"lynx",position:"side",symbols:["pawedAnimal"],recalculatePoints(t){t.countByName("roeDeerBeech")+t.countByName("roeDeerBirch")+t.countByName("roeDeerHorseChestnut")+t.countByName("roeDeerLinden")+t.countByName("roeDeerSilverFir")>0?this.points=this.count*10:this.points=0}},p6={name:"raccoon",position:"side",symbols:["pawedAnimal"],recalculatePoints(t){}},g6={name:"redFox",position:"side",symbols:["pawedAnimal"],recalculatePoints(t){this.points=this.count*Db(t)*2}},m6={name:"wolf",position:"side",symbols:["pawedAnimal"],recalculatePoints(t){this.points=this.count*5*t.countBySymbol("deer")}},y6={name:"alpineMarmot",position:"side",symbols:["pawedAnimal","alps"],recalculatePoints(t){this.points=this.count*3*t.countDistinctBySymbol("plant")}},v6={name:"mountainHare",position:"side",symbols:["pawedAnimal","alps"],recalculatePoints(t){this.points=this.count*Db(t)}},b6={name:"waterVole",position:"bottom",symbols:["pawedAnimal","woodlandEdge"],recalculatePoints(t){}},w6={name:"europeanWildcat",position:"side",symbols:["pawedAnimal","woodlandEdge"],recalculatePoints(t){this.points=this.count*t.countBySymbol("woodlandEdge")}},_6={name:"europeanPolecat",position:"side",symbols:["pawedAnimal","woodlandEdge"],params:[{name:"europeanPolecatAloneOnTreeOrShrub",type:"number",value:0}],recalculatePoints(){this.points=10*this.params[0].value}},T6={name:"meeps",position:"side",symbols:["pawedAnimal","woodlandEdge"],hide:t=>!t.spiel24Promo,recalculatePoints(t){this.points=this.count*t.countBySymbol("woodlandEdge")}},CI=[s6,a6,l6,c6,u6,d6,h6,f6,p6,g6,m6,y6,v6,b6,w6,_6,T6];var ns=(t,e)=>t.countDistinctBySymbol("bat")>=3?t.countByName(e)*5:0,x6={name:"barbastelleBat",position:"side",symbols:["bat"],recalculatePoints(t){this.points=ns(t,this.name)}},E6={name:"bechsteinsBat",position:"side",symbols:["bat"],recalculatePoints(t){this.points=ns(t,this.name)}},C6={name:"brownLongEaredBat",position:"side",symbols:["bat"],recalculatePoints(t){this.points=ns(t,this.name)}},S6={name:"greaterHorseshoeBat",position:"side",symbols:["bat"],recalculatePoints(t){this.points=ns(t,this.name)}},D6={name:"savisPipistrelle",position:"side",symbols:["bat","alps"],recalculatePoints(t){this.points=ns(t,this.name)}},I6={name:"duererBat",position:"side",symbols:["bat"],hide:t=>!t.duererExpansion,recalculatePoints(t){this.points=ns(t,this.name)}},O6={name:"commonPipistrelle",position:"side",symbols:["bat","woodlandEdge"],recalculatePoints(t){this.points=ns(t,this.name)}},SI=[x6,E6,C6,S6,D6,I6,O6];var A6={name:"fallowDeer",position:"side",symbols:["deer","clovenHoofedAnimal"],recalculatePoints(t){this.points=t.countByName("fallowDeer")*3*t.countBySymbol("clovenHoofedAnimal")}},M6={name:"redDeer",position:"side",symbols:["deer","clovenHoofedAnimal"],recalculatePoints(t){this.points=t.countByName("redDeer")*(t.countBySymbol("plant")+t.countBySymbol("tree"))}},P6={name:"roeDeerBeech",type:"beech",position:"side",symbols:["deer","clovenHoofedAnimal"],params:[{name:"beechCount",type:"type",symbol:"beech",value:0,unrestricted:!0}],recalculatePoints(t){this.points=this.count*t.beechCount*3}},N6={name:"roeDeerBirch",type:"birch",position:"side",symbols:["deer","clovenHoofedAnimal"],params:[{name:"birchCount",type:"type",symbol:"birch",value:0,unrestricted:!0}],recalculatePoints(t){this.points=this.count*t.birchCount*3}},R6={name:"roeDeerHorseChestnut",type:"horseChestnut",position:"side",symbols:["deer","clovenHoofedAnimal"],params:[{name:"horseChestnutCount",type:"type",symbol:"horseChestnut",value:0,unrestricted:!0}],recalculatePoints(t){this.points=this.count*t.horseChestnutCount*3}},k6={name:"roeDeerLinden",type:"linden",position:"side",symbols:["deer","clovenHoofedAnimal"],params:[{name:"lindenCount",type:"type",symbol:"linden",value:0,unrestricted:!0}],recalculatePoints(t){this.points=this.count*t.lindenCount*3}},F6={name:"roeDeerSilverFir",type:"silverFir",position:"side",symbols:["deer","clovenHoofedAnimal"],params:[{name:"silverFirCount",type:"type",symbol:"silverFir",value:0,unrestricted:!0}],recalculatePoints(t){this.points=this.count*t.silverFirCount*3}},L6={name:"squeaker",position:"side",symbols:["clovenHoofedAnimal"],recalculatePoints(t){this.points=this.count}},B6={name:"squeakerWE",position:"side",symbols:["clovenHoofedAnimal","woodlandEdge"],recalculatePoints(t){this.points=this.count}},j6={name:"wildBoar",position:"side",symbols:["clovenHoofedAnimal"],recalculatePoints(t){let e=t.countByName("squeaker")+t.countByName("squeakerWE")>0;this.points=this.count*10*(e?1:0)}},V6={name:"wildBoarFemale",position:"side",symbols:["clovenHoofedAnimal","woodlandEdge"],recalculatePoints(t){this.points=this.count*10*(t.countByName("squeaker")+t.countByName("squeakerWE"))}},$6={name:"chamoisStonePine",position:"side",symbols:["clovenHoofedAnimal","alps","stonePine"],params:[{name:"stonePineCount",type:"type",symbol:"stonePine",value:0,unrestricted:!0}],recalculatePoints(t){this.points=this.count*t.stonePineCount*3}},U6={name:"chamoisEuropeanLarch",position:"side",symbols:["clovenHoofedAnimal","alps","europeanLarch"],params:[{name:"europeanLarchCount",type:"type",symbol:"europeanLarch",value:0,unrestricted:!0}],recalculatePoints(t){this.points=this.count*t.europeanLarchCount*3}},H6={name:"chamoisDouglasFir",position:"side",symbols:["clovenHoofedAnimal","alps","douglasFir"],params:[{name:"douglasFirCount",type:"type",symbol:"douglasFir",value:0,unrestricted:!0}],recalculatePoints(t){this.points=this.count*t.douglasFirCount*3}},G6={name:"steinbock",position:"side",symbols:["clovenHoofedAnimal","alps"],recalculatePoints(t){this.points=this.count*10}},z6={name:"europeanBison",position:"side",symbols:["clovenHoofedAnimal","woodlandEdge"],params:[{name:"beechCount",type:"type",symbol:"beech",value:0,unrestricted:!0},{name:"oakCount",type:"type",symbol:"oak",value:0,unrestricted:!0}],recalculatePoints(t){this.points=2*this.count*(t.beechCount+t.oakCount)}},DI=[A6,M6,P6,k6,F6,R6,N6,L6,B6,j6,V6,H6,U6,$6,G6,z6];var W6={name:"elderberry",position:"tree",symbols:["shrub","woodlandEdge"],recalculatePoints(t){}},q6={name:"commonHazel",position:"tree",symbols:["shrub","woodlandEdge"],recalculatePoints(t){}},Y6={name:"blackthorn",position:"tree",symbols:["shrub","woodlandEdge"],recalculatePoints(t){}},II=[W6,q6,Y6];var X6=[...mI,...yI,...bI,...wI,..._I,...TI,...xI,...EI,...CI,...SI,...DI,...II],OI=X6;var $f=class{distributedScoring=!1;constructor(e,n){this.playerName=e,this.allForests=n,this.reset()}reset(){this.butterflyPoints=0,this.silverFirCount=0,this.lindenCount=0,this.horseChestnutCount=0,this.birchCount=0,this.beechCount=0,this.sycamoreCount=0,this.douglasFirCount=0,this.oakCount=0,this.europeanLarchCount=0,this.stonePineCount=0,this.caveCount=0,this.points=0,this.cards=[];for(let e of OI){let n=C({},e);e.params&&(n.params=e.params.map(r=>C({},r))),this.cards.push(N(C({},n),{count:0,points:0}))}}getSymbolCount(e){return this[e+"Count"]}setSymbolCount(e,n){this[e+"Count"]=n,this.updatePoints()}findCard(e){return this.cards[this.cards.findIndex(n=>n.name===e)]}addCard(e){++this.findCard(e).count}removeCard(e){let n=this.findCard(e);n.count=Math.max(0,--n.count),n.count===0&&n.params&&n.params.forEach(r=>r.value=0)}addParam(e,n){let r=this.findCard(e),i=r.params.find(o=>o.name===n);i.value=Math.min(i.unrestricted?99:r.count,i.value+1)}subParam(e,n){let i=this.findCard(e).params.find(o=>o.name===n);i.value=Math.max(0,i.value-1)}toggleParam(e,n){let i=this.findCard(e).params.find(o=>o.name===n);i.value=!i.value}updatePoints(){let e=0;for(let n of this.cards)n.recalculatePoints(this),e+=n.points;this.butterflyPoints=vI(this),this.points=e+this.butterflyPoints+this.caveCount}countByName(e){let n=this.cards.find(r=>r.name===e).count;return e==="linden"&&(n+=this.cards.find(r=>r.name==="violetCarpenterBee").params[2].value),n}countBySymbol(e){return this.cards.filter(n=>n.symbols.filter(r=>r===e).length>0).reduce((n,r)=>n+=r.count,0)}countTreesIncludingVioletCarpenterBee(){let e=this.countBySymbol("tree"),n=this.cards.find(r=>r.name==="violetCarpenterBee");for(let r of n.params)e+=r.value;return e}countByPosition(e){return this.cards.filter(n=>n.position===e).reduce((n,r)=>n+=r.count,0)}countDistinctBySymbol(e){return this.cards.filter(n=>n.symbols.filter(r=>r===e).length>0).filter(n=>n.count>0).length}hasMostOfName(e){let n=this.countByName(e),r=!0,i=this.allForests.filter(o=>o.playerName!==this.playerName);for(let o of i)o.countByName(e)>n&&(r=!1);return r}hasMostOfSymbol(e){let n=this.countBySymbol(e),r=!0,i=this.allForests.filter(o=>o.playerName!==this.playerName);for(let o of i)o.countBySymbol(e)>n&&(r=!1);return r}hasMostTrees(){let e=this.countTreesIncludingVioletCarpenterBee(),n=!0,r=this.allForests.filter(i=>i.playerName!==this.playerName);for(let i of r)i.countTreesIncludingVioletCarpenterBee()>e&&(n=!1);return n}treeCount(){return this.countBySymbol("tree")}treeCardsCount(){return this.cards.filter(e=>e.symbols.filter(n=>n==="tree").length>0||e.symbols.filter(n=>n==="shrub").length>0).reduce((e,n)=>e+=n.count,0)}topCount(){return this.countByPosition("top")}bottomCount(){return this.countByPosition("bottom")}sideCount(){return this.countByPosition("side")}treePoints(){return this.cards.filter(e=>e.symbols.indexOf("tree")>=0||e.symbols.indexOf("shrub")>=0).map(e=>e.points).reduce((e,n)=>n+=e)}bottomPoints(){return this.cards.filter(e=>e.position==="bottom").map(e=>e.points).reduce((e,n)=>n+=e)}topPoints(){return this.cards.filter(n=>n.position==="top").map(n=>n.points).reduce((n,r)=>r+=n)+this.butterflyPoints}sidePoints(){return this.cards.filter(e=>e.position==="side").map(e=>e.points).reduce((e,n)=>n+=e)}};var Uf=class{handleNothingToDo(e,n,r){}handleFullyOccupiedTree(e,n){let r=Object.keys(ts).length,i=new Array(r).fill(!1),o=e.getCardsOnBase(n,void 0,!0);for(let l of o){if(l.baseIndex!=n)continue;let a=Vt[l.id],c=Object.values(ts).indexOf(a.position);i[c]=!0}return i.every(l=>l)}handleFullyOccupiedTrees(e,n,r){for(let i of r.forestCards)Vt[i.id].position=="BASE"&&this.handleFullyOccupiedTree(r,i.baseIndex)&&n.value++}handleCardsAttachedToSilverFirs(e,n,r){for(let i of r.forestCards)if(Vt[i.id].speci=="Tanne"){let l=r.getCardsOnBase(i.baseIndex);n.value+=l.length}}handleSharingACardSlot(e,n,r){for(let i of r.forestCards)Vt[i.id].speci=="Erdkroete"&&r.getCardsOnBase(i.baseIndex,"Erdkroete").length>1&&n.value++}handleEuropeanPolecatAloneOnTreeOrShrub(e,n,r){for(let i of r.forestCards)Vt[i.id].speci=="Waldiltis"&&r.getCardsOnBase(i.baseIndex).length==1&&n.value++}countCardsOnBase(e,n,r){let i=0,o=Array.isArray(r)?r:[r];for(let l of e.forestCards)if(Vt[l.id].speci==n){let c=e.getBase(l.baseIndex),s=Vt[c.id];o.includes(s.speci)&&i++}return i}handleChaffinchesAtopABeech(e,n,r){n.value+=this.countCardsOnBase(r,"Buchfink","Buche")}handleNightingalesAtopAShrub(e,n,r){n.value+=this.countCardsOnBase(r,"Buchfink",["Holunder","Haselnuss","Schlehdorn"])}handleRedSquirrelsAtopAnOak(e,n,r){n.value+=this.countCardsOnBase(r,"Eichhoernchen","Eiche")}handleBatOnTheOtherSide(e,n,r){for(let i of r.forestCards)if(Vt[i.id].speci=="Siebenschlaefer"){let l=r.getCardsOnBase(i.baseIndex);for(let a of l){let c=Vt[i.id];r.findCard(c.glCardName).symbols?.includes("bat")&&n.value++}}}handleVioletCarpenterBeeOnABeech(e,n,r){n.value+=this.countCardsOnBase(r,"Holzbiene","Buche")}handleVioletCarpenterBeeOnAHorseChestnut(e,n,r){n.value+=this.countCardsOnBase(r,"Holzbiene","Kastanie")}handleVioletCarpenterBeeOnALinden(e,n,r){n.value+=this.countCardsOnBase(r,"Holzbiene","Linde")}paramHandlers={hasMostLindens:this.handleNothingToDo.bind(this),hasMostTrees:this.handleNothingToDo.bind(this),fullyOccupiedTrees:this.handleFullyOccupiedTrees.bind(this),cardsAttachedToSilverFirs:this.handleCardsAttachedToSilverFirs.bind(this),sharingACardSlot:this.handleSharingACardSlot.bind(this),europeanPolecatAloneOnTreeOrShrub:this.handleEuropeanPolecatAloneOnTreeOrShrub.bind(this),chaffinchesAtopABeech:this.handleChaffinchesAtopABeech.bind(this),nightingalesAtopAShrub:this.handleNightingalesAtopAShrub.bind(this),redSquirrelsAtopAnOak:this.handleRedSquirrelsAtopAnOak.bind(this),batOnTheOtherSide:this.handleBatOnTheOtherSide.bind(this),onABeech:this.handleVioletCarpenterBeeOnABeech.bind(this),onAHorseChestnut:this.handleVioletCarpenterBeeOnAHorseChestnut.bind(this),onALinden:this.handleVioletCarpenterBeeOnALinden.bind(this),beechCount:this.handleNothingToDo.bind(this),oakCount:this.handleNothingToDo.bind(this),birchCount:this.handleNothingToDo.bind(this),horseChestnutCount:this.handleNothingToDo.bind(this),lindenCount:this.handleNothingToDo.bind(this),silverFirCount:this.handleNothingToDo.bind(this),stonePineCount:this.handleNothingToDo.bind(this),europeanLarchCount:this.handleNothingToDo.bind(this),douglasFirCount:this.handleNothingToDo.bind(this)};handleParam(e,n,r){let i=this.paramHandlers[n.name];if(!i)throw RangeError(`Parameter '${n.name}' has no handler defined in ParamHandler`);i(e,n,r)}};var Hf=class extends $f{forestCards=[];getCardsOnBase(e,n,r=!1){let i=[];for(let o of this.forestCards){if(o.baseIndex!=e)continue;let l=Vt[o.id];n!=null&&n!=l.speci||(r||l.position!="BASE")&&i.push(o)}return i}getBase(e){for(let n of this.forestCards){if(n.baseIndex!=e)continue;if(Vt[n.id].position=="BASE")return n}throw new Error(`No base found with index: '${e}'!`)}addCardColor(e){let n=pI(e);this[n+"Count"]++}handleParams(){let e=new Uf;for(let n of this.cards)if(n.params)for(let r of n.params)e.handleParam(n,r,this)}setCards(e){this.forestCards=e;for(let n of e){let r=Vt[n.id],i=r.glCardName;try{let o=this.findCard(i);o.count++}catch(o){if(o instanceof Error){let l=`Adding Card '${i}' cause an error '${o.message}'`;console.error(l)}else console.error(o)}this.addCardColor(r.color)}this.handleParams()}};var Ga=class t{loadingProgress=new Je(0);isLoading=new Je(!1);progressMap={};expectedSizes={};constructor(){}fetchAndCache(e,n){return R(this,null,function*(){if(yield this.isFileCached(e)){console.log(`Loading ${e} from Cache Storage...`);let d=yield this.getCachedFile(e);return n(this.expectedSizes[e]||1,this.expectedSizes[e]||1),d}console.log(`Downloading ${e}...`);let r=yield fetch(e);if(!r.ok)throw new Error(`Failed to fetch ${e}: ${r.statusText}`);let i=r.headers.get("Content-Length"),o=i?parseInt(i,10):0;this.expectedSizes[e]=o||1;let l=r.body?.getReader();if(!l)throw new Error("ReadableStream not supported in this browser.");let a=0,c=[];for(;;){let{done:d,value:h}=yield l.read();if(d)break;h&&(c.push(h),a+=h.length,n(a,this.expectedSizes[e]))}let s=new Uint8Array(a),u=0;for(let d of c)s.set(d,u),u+=d.length;return yield this.cacheFile(e,s),s.buffer})}cacheFile(e,n){return R(this,null,function*(){let r=yield caches.open("download-cache"),i=new Response(n,{headers:{"Content-Type":"application/octet-stream"}});yield r.put(e,i)})}getCachedFile(e){return R(this,null,function*(){let r=yield(yield caches.open("download-cache")).match(e);if(!r)throw new Error(`Cached file not found for ${e}`);return r.arrayBuffer()})}isFileCached(e){return R(this,null,function*(){return!!(yield(yield caches.open("download-cache")).match(e))})}clearCache(){return R(this,null,function*(){yield caches.delete("download-cache"),console.log("Cache cleared"),window.location.reload()})}loadResources(e){return R(this,null,function*(){this.isLoading.next(!0);for(let l of e)if(this.expectedSizes[l]=1,this.progressMap[l]=1,!(yield this.isFileCached(l))){this.progressMap[l]=0;try{let c=(yield fetch(l,{method:"HEAD"})).headers.get("Content-Length");this.expectedSizes[l]=c?parseInt(c,10):1}catch{console.warn(`HEAD request failed for ${l}, using default size 1.`),this.expectedSizes[l]=1}}let n=e.reduce((l,a)=>l+(this.expectedSizes[a]||1),0),r=()=>{let l=Object.values(this.progressMap).reduce((c,s)=>c+s,0),a=Math.min(100,Math.round(l/n*100));this.loadingProgress.next(a)},i={};e.forEach(l=>{i[l]=(a,c)=>{this.progressMap[l]=a,r()}});let o=yield Promise.all(e.map(l=>this.fetchAndCache(l,i[l])));return this.loadingProgress.next(100),this.isLoading.next(!1),console.log("All files loaded successfully using cached/downloaded data."),o})}static \u0275fac=function(n){return new(n||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})};function K6(t,e){if(t&1&&(J(0,"div",1)(1,"div",2),na(2,"async"),vt(3),na(4,"async"),X()()),t&2){let n=Lt();ie(),ea("width",ra(2,3,n.loadingProgress$),"%"),ie(2),vn("Downloading card detection models: ",ra(4,5,n.loadingProgress$),"%")}}var Gf=class t{constructor(e){this.downloadService=e;this.loadingProgress$=this.downloadService.loadingProgress,this.isLoading$=this.downloadService.isLoading.asObservable().pipe(Qp(1e3))}isLoading$;loadingProgress$;static \u0275fac=function(n){return new(n||t)(te(Ga))};static \u0275cmp=br({type:t,selectors:[["app-download-progress"]],decls:2,vars:3,consts:[["class","progress","role","progressbar","aria-label","Example with label","aria-valuenow","25","aria-valuemin","0","aria-valuemax","100",4,"ngIf"],["role","progressbar","aria-label","Example with label","aria-valuenow","25","aria-valuemin","0","aria-valuemax","100",1,"progress"],[1,"progress-bar",2,"width","25%"]],template:function(n,r){n&1&&(Ge(0,K6,5,7,"div",0),na(1,"async")),n&2&&Te("ngIf",ra(1,1,r.isLoading$))},dependencies:[Xr,oa,ih],encapsulation:2})};var Z6=Object.create,lp=Object.defineProperty,Q6=Object.getOwnPropertyDescriptor,J6=Object.getOwnPropertyNames,ez=Object.getPrototypeOf,tz=Object.prototype.hasOwnProperty,nz=(t=>typeof no<"u"?no:typeof Proxy<"u"?new Proxy(t,{get:(e,n)=>(typeof no<"u"?no:e)[n]}):t)(function(t){if(typeof no<"u")return no.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')}),P=(t,e)=>()=>(t&&(e=t(t=0)),e),pt=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),tu=(t,e)=>{for(var n in e)lp(t,n,{get:e[n],enumerable:!0})},uM=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of J6(e))!tz.call(t,i)&&i!==n&&lp(t,i,{get:()=>e[i],enumerable:!(r=Q6(e,i))||r.enumerable});return t},Ya=(t,e,n)=>(n=t!=null?Z6(ez(t)):{},uM(e||!t||!t.__esModule?lp(n,"default",{value:t,enumerable:!0}):n,t)),tp=t=>uM(lp({},"__esModule",{value:!0}),t),Dc,Wi,Zc,MI,J0,ew=P(()=>{"use strict";Dc=new Map,Wi=[],Zc=(t,e,n)=>{if(e&&typeof e.init=="function"&&typeof e.createInferenceSessionHandler=="function"){let r=Dc.get(t);if(r===void 0)Dc.set(t,{backend:e,priority:n});else{if(r.priority>n)return;if(r.priority===n&&r.backend!==e)throw new Error(`cannot register backend "${t}" using priority ${n}`)}if(n>=0){let i=Wi.indexOf(t);i!==-1&&Wi.splice(i,1);for(let o=0;o<Wi.length;o++)if(Dc.get(Wi[o]).priority<=n){Wi.splice(o,0,t);return}Wi.push(t)}return}throw new TypeError("not a valid backend")},MI=t=>R(void 0,null,function*(){let e=Dc.get(t);if(!e)return"backend not found.";if(e.initialized)return e.backend;if(e.aborted)return e.error;{let n=!!e.initPromise;try{return n||(e.initPromise=e.backend.init(t)),yield e.initPromise,e.initialized=!0,e.backend}catch(r){return n||(e.error=`${r}`,e.aborted=!0),e.error}finally{delete e.initPromise}}}),J0=t=>R(void 0,null,function*(){let e=t.executionProviders||[],n=e.map(c=>typeof c=="string"?c:c.name),r=n.length===0?Wi:n,i,o=[],l=new Set;for(let c of r){let s=yield MI(c);typeof s=="string"?o.push({name:c,err:s}):(i||(i=s),i===s&&l.add(c))}if(!i)throw new Error(`no available backend found. ERR: ${o.map(c=>`[${c.name}] ${c.err}`).join(", ")}`);for(let{name:c,err:s}of o)n.includes(c)&&console.warn(`removing requested execution provider "${c}" from session options because it is not available: ${s}`);let a=e.filter(c=>l.has(typeof c=="string"?c:c.name));return[i,new Proxy(t,{get:(c,s)=>s==="executionProviders"?a:Reflect.get(c,s)})]})}),rz=P(()=>{"use strict";ew()}),dM,iz=P(()=>{"use strict";dM="1.20.1"}),Ib,zn,hM=P(()=>{"use strict";iz(),Ib="warning",zn={wasm:{},webgl:{},webgpu:{},versions:{common:dM},set logLevel(t){if(t!==void 0){if(typeof t!="string"||["verbose","info","warning","error","fatal"].indexOf(t)===-1)throw new Error(`Unsupported logging level: ${t}`);Ib=t}},get logLevel(){return Ib}},Object.defineProperty(zn,"logLevel",{enumerable:!0})}),de,oz=P(()=>{"use strict";hM(),de=zn}),fM,pM,sz=P(()=>{"use strict";fM=(t,e)=>{let n=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);n.width=t.dims[3],n.height=t.dims[2];let r=n.getContext("2d");if(r!=null){let i,o;e?.tensorLayout!==void 0&&e.tensorLayout==="NHWC"?(i=t.dims[2],o=t.dims[3]):(i=t.dims[3],o=t.dims[2]);let l=e?.format!==void 0?e.format:"RGB",a=e?.norm,c,s;a===void 0||a.mean===void 0?c=[255,255,255,255]:typeof a.mean=="number"?c=[a.mean,a.mean,a.mean,a.mean]:(c=[a.mean[0],a.mean[1],a.mean[2],0],a.mean[3]!==void 0&&(c[3]=a.mean[3])),a===void 0||a.bias===void 0?s=[0,0,0,0]:typeof a.bias=="number"?s=[a.bias,a.bias,a.bias,a.bias]:(s=[a.bias[0],a.bias[1],a.bias[2],0],a.bias[3]!==void 0&&(s[3]=a.bias[3]));let u=o*i,d=0,h=u,f=u*2,p=-1;l==="RGBA"?(d=0,h=u,f=u*2,p=u*3):l==="RGB"?(d=0,h=u,f=u*2):l==="RBG"&&(d=0,f=u,h=u*2);for(let g=0;g<o;g++)for(let y=0;y<i;y++){let b=(t.data[d++]-s[0])*c[0],v=(t.data[h++]-s[1])*c[1],_=(t.data[f++]-s[2])*c[2],I=p===-1?255:(t.data[p++]-s[3])*c[3];r.fillStyle="rgba("+b+","+v+","+_+","+I+")",r.fillRect(y,g,1,1)}if("toDataURL"in n)return n.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},pM=(t,e)=>{let n=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),r;if(n!=null){let i,o,l;e?.tensorLayout!==void 0&&e.tensorLayout==="NHWC"?(i=t.dims[2],o=t.dims[1],l=t.dims[3]):(i=t.dims[3],o=t.dims[2],l=t.dims[1]);let a=e!==void 0&&e.format!==void 0?e.format:"RGB",c=e?.norm,s,u;c===void 0||c.mean===void 0?s=[255,255,255,255]:typeof c.mean=="number"?s=[c.mean,c.mean,c.mean,c.mean]:(s=[c.mean[0],c.mean[1],c.mean[2],255],c.mean[3]!==void 0&&(s[3]=c.mean[3])),c===void 0||c.bias===void 0?u=[0,0,0,0]:typeof c.bias=="number"?u=[c.bias,c.bias,c.bias,c.bias]:(u=[c.bias[0],c.bias[1],c.bias[2],0],c.bias[3]!==void 0&&(u[3]=c.bias[3]));let d=o*i;if(e!==void 0&&(e.format!==void 0&&l===4&&e.format!=="RGBA"||l===3&&e.format!=="RGB"&&e.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let h=4,f=0,p=1,g=2,y=3,b=0,v=d,_=d*2,I=-1;a==="RGBA"?(b=0,v=d,_=d*2,I=d*3):a==="RGB"?(b=0,v=d,_=d*2):a==="RBG"&&(b=0,_=d,v=d*2),r=n.createImageData(i,o);for(let k=0;k<o*i;f+=h,p+=h,g+=h,y+=h,k++)r.data[f]=(t.data[b++]-u[0])*s[0],r.data[p]=(t.data[v++]-u[1])*s[1],r.data[g]=(t.data[_++]-u[2])*s[2],r.data[y]=I===-1?255:(t.data[I++]-u[3])*s[3]}else throw new Error("Can not access image data");return r}}),zf,gM,mM,yM,vM,bM,az=P(()=>{"use strict";tw(),zf=(t,e)=>{if(t===void 0)throw new Error("Image buffer must be defined");if(e.height===void 0||e.width===void 0)throw new Error("Image height and width must be defined");if(e.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:n,width:r}=e,i=e.norm??{mean:255,bias:0},o,l;typeof i.mean=="number"?o=[i.mean,i.mean,i.mean,i.mean]:o=[i.mean[0],i.mean[1],i.mean[2],i.mean[3]??255],typeof i.bias=="number"?l=[i.bias,i.bias,i.bias,i.bias]:l=[i.bias[0],i.bias[1],i.bias[2],i.bias[3]??0];let a=e.format!==void 0?e.format:"RGBA",c=e.tensorFormat!==void 0&&e.tensorFormat!==void 0?e.tensorFormat:"RGB",s=n*r,u=c==="RGBA"?new Float32Array(s*4):new Float32Array(s*3),d=4,h=0,f=1,p=2,g=3,y=0,b=s,v=s*2,_=-1;a==="RGB"&&(d=3,h=0,f=1,p=2,g=-1),c==="RGBA"?_=s*3:c==="RBG"?(y=0,v=s,b=s*2):c==="BGR"&&(v=0,b=s,y=s*2);for(let I=0;I<s;I++,h+=d,p+=d,f+=d,g+=d)u[y++]=(t[h]+l[0])/o[0],u[b++]=(t[f]+l[1])/o[1],u[v++]=(t[p]+l[2])/o[2],_!==-1&&g!==-1&&(u[_++]=(t[g]+l[3])/o[3]);return c==="RGBA"?new On("float32",u,[1,4,n,r]):new On("float32",u,[1,3,n,r])},gM=(t,e)=>R(void 0,null,function*(){let n=typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement,r=typeof ImageData<"u"&&t instanceof ImageData,i=typeof ImageBitmap<"u"&&t instanceof ImageBitmap,o=typeof t=="string",l,a=e??{},c=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},s=u=>typeof HTMLCanvasElement<"u"&&u instanceof HTMLCanvasElement||u instanceof OffscreenCanvas?u.getContext("2d"):null;if(n){let u=c();u.width=t.width,u.height=t.height;let d=s(u);if(d!=null){let h=t.height,f=t.width;if(e!==void 0&&e.resizedHeight!==void 0&&e.resizedWidth!==void 0&&(h=e.resizedHeight,f=e.resizedWidth),e!==void 0){if(a=e,e.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");a.tensorFormat="RGBA",a.height=h,a.width=f}else a.tensorFormat="RGBA",a.height=h,a.width=f;d.drawImage(t,0,0),l=d.getImageData(0,0,f,h).data}else throw new Error("Can not access image data")}else if(r){let u,d;if(e!==void 0&&e.resizedWidth!==void 0&&e.resizedHeight!==void 0?(u=e.resizedHeight,d=e.resizedWidth):(u=t.height,d=t.width),e!==void 0&&(a=e),a.format="RGBA",a.height=u,a.width=d,e!==void 0){let h=c();h.width=d,h.height=u;let f=s(h);if(f!=null)f.putImageData(t,0,0),l=f.getImageData(0,0,d,u).data;else throw new Error("Can not access image data")}else l=t.data}else if(i){if(e===void 0)throw new Error("Please provide image config with format for Imagebitmap");let u=c();u.width=t.width,u.height=t.height;let d=s(u);if(d!=null){let h=t.height,f=t.width;return d.drawImage(t,0,0,f,h),l=d.getImageData(0,0,f,h).data,a.height=h,a.width=f,zf(l,a)}else throw new Error("Can not access image data")}else{if(o)return new Promise((u,d)=>{let h=c(),f=s(h);if(!t||!f)return d();let p=new Image;p.crossOrigin="Anonymous",p.src=t,p.onload=()=>{h.width=p.width,h.height=p.height,f.drawImage(p,0,0,h.width,h.height);let g=f.getImageData(0,0,h.width,h.height);a.height=h.height,a.width=h.width,u(zf(g.data,a))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(l!==void 0)return zf(l,a);throw new Error("Input data provided is not supported - aborted tensor creation")}),mM=(t,e)=>{let{width:n,height:r,download:i,dispose:o}=e,l=[1,r,n,4];return new On({location:"texture",type:"float32",texture:t,dims:l,download:i,dispose:o})},yM=(t,e)=>{let{dataType:n,dims:r,download:i,dispose:o}=e;return new On({location:"gpu-buffer",type:n??"float32",gpuBuffer:t,dims:r,download:i,dispose:o})},vM=(t,e)=>{let{dataType:n,dims:r,download:i,dispose:o}=e;return new On({location:"ml-tensor",type:n??"float32",mlTensor:t,dims:r,download:i,dispose:o})},bM=(t,e,n)=>new On({location:"cpu-pinned",type:t,data:e,dims:n??[e.length]})}),cs,Bc,Ob,wM,lz=P(()=>{"use strict";cs=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),Bc=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),Ob=!1,wM=()=>{if(!Ob){Ob=!0;let t=typeof BigInt64Array<"u"&&BigInt64Array.from,e=typeof BigUint64Array<"u"&&BigUint64Array.from,n=typeof Float16Array<"u"&&Float16Array.from;t&&(cs.set("int64",BigInt64Array),Bc.set(BigInt64Array,"int64")),e&&(cs.set("uint64",BigUint64Array),Bc.set(BigUint64Array,"uint64")),n?(cs.set("float16",Float16Array),Bc.set(Float16Array,"float16")):cs.set("float16",Uint16Array)}}}),_M,TM,cz=P(()=>{"use strict";tw(),_M=t=>{let e=1;for(let n=0;n<t.length;n++){let r=t[n];if(typeof r!="number"||!Number.isSafeInteger(r))throw new TypeError(`dims[${n}] must be an integer, got: ${r}`);if(r<0)throw new RangeError(`dims[${n}] must be a non-negative integer, got: ${r}`);e*=r}return e},TM=(t,e)=>{switch(t.location){case"cpu":return new On(t.type,t.data,e);case"cpu-pinned":return new On({location:"cpu-pinned",data:t.data,type:t.type,dims:e});case"texture":return new On({location:"texture",texture:t.texture,type:t.type,dims:e});case"gpu-buffer":return new On({location:"gpu-buffer",gpuBuffer:t.gpuBuffer,type:t.type,dims:e});case"ml-tensor":return new On({location:"ml-tensor",mlTensor:t.mlTensor,type:t.type,dims:e});default:throw new Error(`tensorReshape: tensor location ${t.location} is not supported`)}}}),On,tw=P(()=>{"use strict";sz(),az(),lz(),cz(),On=class{constructor(t,e,n){wM();let r,i;if(typeof t=="object"&&"location"in t)switch(this.dataLocation=t.location,r=t.type,i=t.dims,t.location){case"cpu-pinned":{let l=cs.get(r);if(!l)throw new TypeError(`unsupported type "${r}" to create tensor from pinned buffer`);if(!(t.data instanceof l))throw new TypeError(`buffer should be of type ${l.name}`);this.cpuData=t.data;break}case"texture":{if(r!=="float32")throw new TypeError(`unsupported type "${r}" to create tensor from texture`);this.gpuTextureData=t.texture,this.downloader=t.download,this.disposer=t.dispose;break}case"gpu-buffer":{if(r!=="float32"&&r!=="float16"&&r!=="int32"&&r!=="int64"&&r!=="uint32"&&r!=="uint8"&&r!=="bool"&&r!=="uint4"&&r!=="int4")throw new TypeError(`unsupported type "${r}" to create tensor from gpu buffer`);this.gpuBufferData=t.gpuBuffer,this.downloader=t.download,this.disposer=t.dispose;break}case"ml-tensor":{if(r!=="float32"&&r!=="float16"&&r!=="int32"&&r!=="int64"&&r!=="uint32"&&r!=="uint64"&&r!=="int8"&&r!=="uint8"&&r!=="bool")throw new TypeError(`unsupported type "${r}" to create tensor from MLTensor`);this.mlTensorData=t.mlTensor,this.downloader=t.download,this.disposer=t.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let l,a;if(typeof t=="string")if(r=t,a=n,t==="string"){if(!Array.isArray(e))throw new TypeError("A string tensor's data must be a string array.");l=e}else{let c=cs.get(t);if(c===void 0)throw new TypeError(`Unsupported tensor type: ${t}.`);if(Array.isArray(e)){if(t==="float16"&&c===Uint16Array||t==="uint4"||t==="int4")throw new TypeError(`Creating a ${t} tensor from number array is not supported. Please use ${c.name} as data.`);t==="uint64"||t==="int64"?l=c.from(e,BigInt):l=c.from(e)}else if(e instanceof c)l=e;else if(e instanceof Uint8ClampedArray)if(t==="uint8")l=Uint8Array.from(e);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else throw new TypeError(`A ${r} tensor's data must be type of ${c}`)}else if(a=e,Array.isArray(t)){if(t.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let c=typeof t[0];if(c==="string")r="string",l=t;else if(c==="boolean")r="bool",l=Uint8Array.from(t);else throw new TypeError(`Invalid element type of data array: ${c}.`)}else if(t instanceof Uint8ClampedArray)r="uint8",l=Uint8Array.from(t);else{let c=Bc.get(t.constructor);if(c===void 0)throw new TypeError(`Unsupported type for tensor data: ${t.constructor}.`);r=c,l=t}if(a===void 0)a=[l.length];else if(!Array.isArray(a))throw new TypeError("A tensor's dims must be a number array");i=a,this.cpuData=l,this.dataLocation="cpu"}let o=_M(i);if(this.cpuData&&o!==this.cpuData.length&&!((r==="uint4"||r==="int4")&&Math.ceil(o/2)===this.cpuData.length))throw new Error(`Tensor's size(${o}) does not match data length(${this.cpuData.length}).`);this.type=r,this.dims=i,this.size=o}static fromImage(t,e){return R(this,null,function*(){return gM(t,e)})}static fromTexture(t,e){return mM(t,e)}static fromGpuBuffer(t,e){return yM(t,e)}static fromMLTensor(t,e){return vM(t,e)}static fromPinnedBuffer(t,e,n){return bM(t,e,n)}toDataURL(t){return fM(this,t)}toImageData(t){return pM(this,t)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}getData(t){return R(this,null,function*(){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let e=yield this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=e,t&&this.disposer&&(this.disposer(),this.disposer=void 0),e}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}})}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(t){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return TM(this,t)}}}),Et,nw=P(()=>{"use strict";tw(),Et=On}),y0,Ab,Xa,Ka,xM=P(()=>{"use strict";hM(),y0=(t,e)=>{(typeof zn.trace>"u"?!zn.wasm.trace:!zn.trace)||console.timeStamp(`${t}::ORT::${e}`)},Ab=(t,e)=>{let n=new Error().stack?.split(/\r\n|\r|\n/g)||[],r=!1;for(let i=0;i<n.length;i++){if(r&&!n[i].includes("TRACE_FUNC")){let o=`FUNC_${t}::${n[i].trim().split(" ")[1]}`;e&&(o+=`::${e}`),y0("CPU",o);return}n[i].includes("TRACE_FUNC")&&(r=!0)}},Xa=t=>{(typeof zn.trace>"u"?!zn.wasm.trace:!zn.trace)||Ab("BEGIN",t)},Ka=t=>{(typeof zn.trace>"u"?!zn.wasm.trace:!zn.trace)||Ab("END",t)}}),EM,uz=P(()=>{"use strict";ew(),nw(),xM(),EM=class CM{constructor(e){this.handler=e}run(e,n,r){return R(this,null,function*(){Xa();let i={},o={};if(typeof e!="object"||e===null||e instanceof Et||Array.isArray(e))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let l=!0;if(typeof n=="object"){if(n===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof Et)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(n.length===0)throw new TypeError("'fetches' cannot be an empty array.");l=!1;for(let s of n){if(typeof s!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(s)===-1)throw new RangeError(`'fetches' contains invalid output name: ${s}.`);i[s]=null}if(typeof r=="object"&&r!==null)o=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{let s=!1,u=Object.getOwnPropertyNames(n);for(let d of this.outputNames)if(u.indexOf(d)!==-1){let h=n[d];(h===null||h instanceof Et)&&(s=!0,l=!1,i[d]=h)}if(s){if(typeof r=="object"&&r!==null)o=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else o=n}}else if(typeof n<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let s of this.inputNames)if(typeof e[s]>"u")throw new Error(`input '${s}' is missing in 'feeds'.`);if(l)for(let s of this.outputNames)i[s]=null;let a=yield this.handler.run(e,i,o),c={};for(let s in a)if(Object.hasOwnProperty.call(a,s)){let u=a[s];u instanceof Et?c[s]=u:c[s]=new Et(u.type,u.data,u.dims)}return Ka(),c})}release(){return R(this,null,function*(){return this.handler.dispose()})}static create(e,n,r,i){return R(this,null,function*(){Xa();let o,l={};if(typeof e=="string"){if(o=e,typeof n=="object"&&n!==null)l=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(e instanceof Uint8Array){if(o=e,typeof n=="object"&&n!==null)l=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer){let u=e,d=0,h=e.byteLength;if(typeof n=="object"&&n!==null)l=n;else if(typeof n=="number"){if(d=n,!Number.isSafeInteger(d))throw new RangeError("'byteOffset' must be an integer.");if(d<0||d>=u.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${u.byteLength}).`);if(h=e.byteLength-d,typeof r=="number"){if(h=r,!Number.isSafeInteger(h))throw new RangeError("'byteLength' must be an integer.");if(h<=0||d+h>u.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${u.byteLength-d}].`);if(typeof i=="object"&&i!==null)l=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(typeof r<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof n<"u")throw new TypeError("'options' must be an object.");o=new Uint8Array(u,d,h)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[a,c]=yield J0(l),s=yield a.createInferenceSessionHandler(o,c);return Ka(),new CM(s)})}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}}),cp,dz=P(()=>{"use strict";uz(),cp=EM}),hz=P(()=>{"use strict"}),fz=P(()=>{"use strict"}),pz=P(()=>{"use strict"}),gz=P(()=>{"use strict"}),PI,SM,mz=P(()=>{"use strict";ew(),nw(),PI="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",SM=class DM{constructor(e,n,r){this.handler=e,this.hasOptimizerModel=n,this.hasEvalModel=r}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static create(e,n){return R(this,null,function*(){let r=e.evalModel||"",i=e.optimizerModel||"",o=n||{},[l,a]=yield J0(o);if(l.createTrainingSessionHandler){let c=yield l.createTrainingSessionHandler(e.checkpointState,e.trainModel,r,i,a);return new DM(c,!!e.optimizerModel,!!e.evalModel)}else throw new Error(PI)})}typeNarrowingForRunStep(e,n,r,i,o){let l={},a={};if(typeof r!="object"||r===null||r instanceof Et||Array.isArray(r))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let c=!0;if(typeof i=="object"){if(i===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(i instanceof Et)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(i)){if(i.length===0)throw new TypeError("'fetches' cannot be an empty array.");c=!1;for(let s of i){if(typeof s!="string")throw new TypeError("'fetches' must be a string array or an object.");if(n.indexOf(s)===-1)throw new RangeError(`'fetches' contains invalid output name: ${s}.`);l[s]=null}if(typeof o=="object"&&o!==null)a=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else{let s=!1,u=Object.getOwnPropertyNames(i);for(let d of n)if(u.indexOf(d)!==-1){let h=i[d];(h===null||h instanceof Et)&&(s=!0,c=!1,l[d]=h)}if(s){if(typeof o=="object"&&o!==null)a=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else a=i}}else if(typeof i<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let s of e)if(typeof r[s]>"u")throw new Error(`input '${s}' is missing in 'feeds'.`);if(c)for(let s of n)l[s]=null;return[l,a]}convertHandlerReturnTypeToMapOfTensors(e){let n={};for(let r in e)if(Object.hasOwnProperty.call(e,r)){let i=e[r];i instanceof Et?n[r]=i:n[r]=new Et(i.type,i.data,i.dims)}return n}lazyResetGrad(){return R(this,null,function*(){yield this.handler.lazyResetGrad()})}runTrainStep(e,n,r){return R(this,null,function*(){let[i,o]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,e,n,r),l=yield this.handler.runTrainStep(e,i,o);return this.convertHandlerReturnTypeToMapOfTensors(l)})}runOptimizerStep(e){return R(this,null,function*(){if(this.hasOptimizerModel)yield this.handler.runOptimizerStep(e||{});else throw new Error("This TrainingSession has no OptimizerModel loaded.")})}runEvalStep(e,n,r){return R(this,null,function*(){if(this.hasEvalModel){let[i,o]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,e,n,r),l=yield this.handler.runEvalStep(e,i,o);return this.convertHandlerReturnTypeToMapOfTensors(l)}else throw new Error("This TrainingSession has no EvalModel loaded.")})}getParametersSize(e=!0){return R(this,null,function*(){return this.handler.getParametersSize(e)})}loadParametersBuffer(e,n=!0){return R(this,null,function*(){let r=yield this.getParametersSize(n);if(e.length!==4*r)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(e,n)})}getContiguousParameters(e=!0){return R(this,null,function*(){return this.handler.getContiguousParameters(e)})}release(){return R(this,null,function*(){return this.handler.dispose()})}}}),IM,yz=P(()=>{"use strict";mz(),IM=SM}),OM={};tu(OM,{InferenceSession:()=>cp,TRACE:()=>y0,TRACE_FUNC_BEGIN:()=>Xa,TRACE_FUNC_END:()=>Ka,Tensor:()=>Et,TrainingSession:()=>IM,env:()=>de,registerBackend:()=>Zc});var Or=P(()=>{"use strict";rz(),oz(),dz(),nw(),hz(),fz(),xM(),pz(),gz(),yz()});function us(t,e,n,r){if(e===void 0)return vz(t);if(n===void 0)Wf(t,e,1);else if(typeof n=="number"&&r===void 0)Wf(t,e,n);else if(typeof n=="string"&&r===void 0)Wf(t,n,1,e);else if(typeof n=="string"&&typeof r=="number")Wf(t,n,r,e);else throw new TypeError("input is valid")}function vz(t){return{verbose:us.verbose.bind(null,t),info:us.info.bind(null,t),warning:us.warning.bind(null,t),error:us.error.bind(null,t),fatal:us.fatal.bind(null,t)}}function Wf(t,e,n,r){let i=qa[r||""]||qa[""];v0[t]<v0[i.minimalSeverity]||(i.logDateTime&&(e=`${new Date().toISOString()}|${e}`),i.logSourceLocation,AM[i.provider].log(t,e,r))}var NI,RI,v0,AM,Mb,qa,st,Pb,Nb,MM,Ic,dr=P(()=>{"use strict";NI=class{log(t,e,n){}},RI=class{log(t,e,n){console.log(`${this.color(t)} ${n?"\x1B[35m"+n+"\x1B[0m ":""}${e}`)}color(t){switch(t){case"verbose":return"\x1B[34;40mv\x1B[0m";case"info":return"\x1B[32mi\x1B[0m";case"warning":return"\x1B[30;43mw\x1B[0m";case"error":return"\x1B[31;40me\x1B[0m";case"fatal":return"\x1B[101mf\x1B[0m";default:throw new Error(`unsupported severity: ${t}`)}}},v0={verbose:1e3,info:2e3,warning:4e3,error:5e3,fatal:6e3},AM={none:new NI,console:new RI},Mb={provider:"console",minimalSeverity:"warning",logDateTime:!0,logSourceLocation:!1},qa={"":Mb},(t=>{function e(s,u){t("verbose",s,u)}t.verbose=e;function n(s,u){t("info",s,u)}t.info=n;function r(s,u){t("warning",s,u)}t.warning=r;function i(s,u){t("error",s,u)}t.error=i;function o(s,u){t("fatal",s,u)}t.fatal=o;function l(s){qa={},a("",s||{})}t.reset=l;function a(s,u){if(s==="*")l(u);else{let d=qa[s]||Mb;qa[s]={provider:u.provider||d.provider,minimalSeverity:u.minimalSeverity||d.minimalSeverity,logDateTime:u.logDateTime===void 0?d.logDateTime:u.logDateTime,logSourceLocation:u.logSourceLocation===void 0?d.logSourceLocation:u.logSourceLocation}}}t.set=a;function c(s){let u={};s.logLevel&&(u.minimalSeverity=s.logLevel),a("",u)}t.setWithEnv=c})(us||={}),st=us,Pb=class{constructor(t,e,n,r,i,o){this.category=t,this.name=e,this.startTime=n,this.endCallback=r,this.timer=i,this.ctx=o}end(){return R(this,null,function*(){return this.endCallback(this)})}checkTimer(){return R(this,null,function*(){if(this.ctx===void 0||this.timer===void 0)throw new Error("No webgl timer found");return this.ctx.endTimer(),this.ctx.waitForQueryAndGetTime(this.timer)})}},Nb=class{constructor(t,e,n,r){this.category=t,this.name=e,this.startTime=n,this.endTime=r}},MM=class{constructor(t,e,n){this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=t===void 0?1e4:t,this._flushBatchSize=e===void 0?10:e,this._flushIntervalInMilliseconds=n===void 0?5e3:n}static create(t){return t===void 0?new this:new this(t.maxNumberEvents,t.flushBatchSize,t.flushIntervalInMilliseconds)}start(){this._started=!0,this._timingEvents=[],this._flushTime=Ic(),this._flushPointer=0}stop(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer])}event(t,e,n,r){let i=this._started?this.begin(t,e,r):void 0,o=!1,l=n();if(l&&typeof l.then=="function")return o=!0,new Promise((a,c)=>{l.then(s=>R(this,null,function*(){i&&(yield i.end()),a(s)}),s=>R(this,null,function*(){i&&(yield i.end()),c(s)}))});if(!o&&i){let a=i.end();if(a&&typeof a.then=="function")return new Promise((c,s)=>{a.then(()=>{c(l)},u=>{s(u)})})}return l}begin(t,e,n){if(!this._started)throw new Error("profiler is not started yet");if(n===void 0){let r=Ic();return this.flush(r),new Pb(t,e,r,i=>this.endSync(i))}else{let r=n.beginTimer();return new Pb(t,e,0,i=>R(this,null,function*(){return this.end(i)}),r,n)}}end(t){return R(this,null,function*(){let e=yield t.checkTimer();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new Nb(t.category,t.name,t.startTime,e)),this.flush(e))})}endSync(t){let e=Ic();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new Nb(t.category,t.name,t.startTime,e)),this.flush(e))}logOneEvent(t){st.verbose(`Profiler.${t.category}`,`${(t.endTime-t.startTime).toFixed(2)}ms on event '${t.name}' at ${t.endTime.toFixed(2)}`)}flush(t){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||t-this._flushTime>=this._flushIntervalInMilliseconds){for(let e=this._flushPointer;this._flushPointer<e+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=Ic()}}get started(){return this._started}},Ic=typeof performance<"u"&&performance.now?()=>performance.now():Date.now});function bz(t,e,n){for(let r of n){let i=r[0],o=r[1],l=r[2],a=r[3],c=r[4];if(t.opType===i){for(let s of e)if((s.domain===o||s.domain==="ai.onnx"&&o==="")&&wz(s.version,l))return{opImpl:a,opInit:c}}}throw new TypeError(`cannot resolve operator '${t.opType}' with opsets: ${e.map(r=>`${r.domain||"ai.onnx"} v${r.version}`).join(", ")}`)}function wz(t,e){if(e.endsWith("+")){let n=Number.parseInt(e.substring(0,e.length-1),10);return!isNaN(n)&&n<=t}else if(e.split("-").length===2){let n=e.split("-"),r=Number.parseInt(n[0],10),i=Number.parseInt(n[1],10);return!isNaN(r)&&!isNaN(i)&&r<=t&&t<=i}else return Number.parseInt(e,10)===t}var _z=P(()=>{"use strict"}),Tz=pt(t=>{"use strict";t.__esModule=!0;var e=function(){function n(r){if(!r)throw new TypeError("Invalid argument; `value` has no value.");this.value=n.EMPTY,r&&n.isGuid(r)&&(this.value=r)}return n.isGuid=function(r){var i=r.toString();return r&&(r instanceof n||n.validator.test(i))},n.create=function(){return new n([n.gen(2),n.gen(1),n.gen(1),n.gen(1),n.gen(3)].join("-"))},n.createEmpty=function(){return new n("emptyguid")},n.parse=function(r){return new n(r)},n.raw=function(){return[n.gen(2),n.gen(1),n.gen(1),n.gen(1),n.gen(3)].join("-")},n.gen=function(r){for(var i="",o=0;o<r;o++)i+=((1+Math.random())*65536|0).toString(16).substring(1);return i},n.prototype.equals=function(r){return n.isGuid(r)&&this.value===r.toString()},n.prototype.isEmpty=function(){return this.value===n.EMPTY},n.prototype.toString=function(){return this.value},n.prototype.toJSON=function(){return{value:this.value}},n.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),n.EMPTY="00000000-0000-0000-0000-000000000000",n}();t.Guid=e});function Ve(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}function $t(t){return(t&&t.__isLong__)===!0}function kI(t){var e=Math.clz32(t&-t);return t?31-e:e}function rs(t,e){var n,r,i;return e?(t>>>=0,(i=0<=t&&t<256)&&(r=w0[t],r)?r:(n=De(t,0,!0),i&&(w0[t]=n),n)):(t|=0,(i=-128<=t&&t<128)&&(r=b0[t],r)?r:(n=De(t,t<0?-1:0,!1),i&&(b0[t]=n),n))}function qn(t,e){if(isNaN(t))return e?Sr:Wn;if(e){if(t<0)return Sr;if(t>=_0)return E0}else{if(t<=-T0)return tn;if(t+1>=T0)return x0}return t<0?qn(-t,e).neg():De(t%ds|0,t/ds|0,e)}function De(t,e,n){return new Ve(t,e,n)}function rw(t,e,n){if(t.length===0)throw Error("empty string");if(typeof e=="number"?(n=e,e=!1):e=!!e,t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return e?Sr:Wn;if(n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return rw(t.substring(1),e,n).neg();for(var i=qn(qc(n,8)),o=Wn,l=0;l<t.length;l+=8){var a=Math.min(8,t.length-l),c=parseInt(t.substring(l,l+a),n);if(a<8){var s=qn(qc(n,a));o=o.mul(s).add(qn(c))}else o=o.mul(i),o=o.add(qn(c))}return o.unsigned=e,o}function ur(t,e){return typeof t=="number"?qn(t,e):typeof t=="string"?rw(t,e):De(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}var Cn,b0,w0,qc,Rb,FI,ds,_0,T0,kb,Wn,Sr,is,Fb,qf,x0,E0,tn,L,Zi,PM=P(()=>{Cn=null;try{Cn=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}Ve.prototype.__isLong__,Object.defineProperty(Ve.prototype,"__isLong__",{value:!0}),Ve.isLong=$t,b0={},w0={},Ve.fromInt=rs,Ve.fromNumber=qn,Ve.fromBits=De,qc=Math.pow,Ve.fromString=rw,Ve.fromValue=ur,Rb=65536,FI=1<<24,ds=Rb*Rb,_0=ds*ds,T0=_0/2,kb=rs(FI),Wn=rs(0),Ve.ZERO=Wn,Sr=rs(0,!0),Ve.UZERO=Sr,is=rs(1),Ve.ONE=is,Fb=rs(1,!0),Ve.UONE=Fb,qf=rs(-1),Ve.NEG_ONE=qf,x0=De(-1,2147483647,!1),Ve.MAX_VALUE=x0,E0=De(-1,-1,!0),Ve.MAX_UNSIGNED_VALUE=E0,tn=De(0,-2147483648,!1),Ve.MIN_VALUE=tn,L=Ve.prototype,L.toInt=function(){return this.unsigned?this.low>>>0:this.low},L.toNumber=function(){return this.unsigned?(this.high>>>0)*ds+(this.low>>>0):this.high*ds+(this.low>>>0)},L.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(tn)){var e=qn(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var i=qn(qc(t,6),this.unsigned),o=this,l="";;){var a=o.div(i),c=o.sub(a.mul(i)).toInt()>>>0,s=c.toString(t);if(o=a,o.isZero())return s+l;for(;s.length<6;)s="0"+s;l=""+s+l}},L.getHighBits=function(){return this.high},L.getHighBitsUnsigned=function(){return this.high>>>0},L.getLowBits=function(){return this.low},L.getLowBitsUnsigned=function(){return this.low>>>0},L.getNumBitsAbs=function(){if(this.isNegative())return this.eq(tn)?64:this.neg().getNumBitsAbs();for(var t=this.high!=0?this.high:this.low,e=31;e>0&&!(t&1<<e);e--);return this.high!=0?e+33:e+1},L.isZero=function(){return this.high===0&&this.low===0},L.eqz=L.isZero,L.isNegative=function(){return!this.unsigned&&this.high<0},L.isPositive=function(){return this.unsigned||this.high>=0},L.isOdd=function(){return(this.low&1)===1},L.isEven=function(){return(this.low&1)===0},L.equals=function(t){return $t(t)||(t=ur(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low},L.eq=L.equals,L.notEquals=function(t){return!this.eq(t)},L.neq=L.notEquals,L.ne=L.notEquals,L.lessThan=function(t){return this.comp(t)<0},L.lt=L.lessThan,L.lessThanOrEqual=function(t){return this.comp(t)<=0},L.lte=L.lessThanOrEqual,L.le=L.lessThanOrEqual,L.greaterThan=function(t){return this.comp(t)>0},L.gt=L.greaterThan,L.greaterThanOrEqual=function(t){return this.comp(t)>=0},L.gte=L.greaterThanOrEqual,L.ge=L.greaterThanOrEqual,L.compare=function(t){if($t(t)||(t=ur(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},L.comp=L.compare,L.negate=function(){return!this.unsigned&&this.eq(tn)?tn:this.not().add(is)},L.neg=L.negate,L.add=function(t){$t(t)||(t=ur(t));var e=this.high>>>16,n=this.high&65535,r=this.low>>>16,i=this.low&65535,o=t.high>>>16,l=t.high&65535,a=t.low>>>16,c=t.low&65535,s=0,u=0,d=0,h=0;return h+=i+c,d+=h>>>16,h&=65535,d+=r+a,u+=d>>>16,d&=65535,u+=n+l,s+=u>>>16,u&=65535,s+=e+o,s&=65535,De(d<<16|h,s<<16|u,this.unsigned)},L.subtract=function(t){return $t(t)||(t=ur(t)),this.add(t.neg())},L.sub=L.subtract,L.multiply=function(t){if(this.isZero())return this;if($t(t)||(t=ur(t)),Cn){var e=Cn.mul(this.low,this.high,t.low,t.high);return De(e,Cn.get_high(),this.unsigned)}if(t.isZero())return this.unsigned?Sr:Wn;if(this.eq(tn))return t.isOdd()?tn:Wn;if(t.eq(tn))return this.isOdd()?tn:Wn;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(kb)&&t.lt(kb))return qn(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,r=this.high&65535,i=this.low>>>16,o=this.low&65535,l=t.high>>>16,a=t.high&65535,c=t.low>>>16,s=t.low&65535,u=0,d=0,h=0,f=0;return f+=o*s,h+=f>>>16,f&=65535,h+=i*s,d+=h>>>16,h&=65535,h+=o*c,d+=h>>>16,h&=65535,d+=r*s,u+=d>>>16,d&=65535,d+=i*c,u+=d>>>16,d&=65535,d+=o*a,u+=d>>>16,d&=65535,u+=n*s+r*c+i*a+o*l,u&=65535,De(h<<16|f,u<<16|d,this.unsigned)},L.mul=L.multiply,L.divide=function(t){if($t(t)||(t=ur(t)),t.isZero())throw Error("division by zero");if(Cn){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var e=(this.unsigned?Cn.div_u:Cn.div_s)(this.low,this.high,t.low,t.high);return De(e,Cn.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Sr:Wn;var n,r,i;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return Sr;if(t.gt(this.shru(1)))return Fb;i=Sr}else{if(this.eq(tn)){if(t.eq(is)||t.eq(qf))return tn;if(t.eq(tn))return is;var o=this.shr(1);return n=o.div(t).shl(1),n.eq(Wn)?t.isNegative()?is:qf:(r=this.sub(t.mul(n)),i=n.add(r.div(t)),i)}else if(t.eq(tn))return this.unsigned?Sr:Wn;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=Wn}for(r=this;r.gte(t);){n=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var l=Math.ceil(Math.log(n)/Math.LN2),a=l<=48?1:qc(2,l-48),c=qn(n),s=c.mul(t);s.isNegative()||s.gt(r);)n-=a,c=qn(n,this.unsigned),s=c.mul(t);c.isZero()&&(c=is),i=i.add(c),r=r.sub(s)}return i},L.div=L.divide,L.modulo=function(t){if($t(t)||(t=ur(t)),Cn){var e=(this.unsigned?Cn.rem_u:Cn.rem_s)(this.low,this.high,t.low,t.high);return De(e,Cn.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))},L.mod=L.modulo,L.rem=L.modulo,L.not=function(){return De(~this.low,~this.high,this.unsigned)},L.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},L.clz=L.countLeadingZeros,L.countTrailingZeros=function(){return this.low?kI(this.low):kI(this.high)+32},L.ctz=L.countTrailingZeros,L.and=function(t){return $t(t)||(t=ur(t)),De(this.low&t.low,this.high&t.high,this.unsigned)},L.or=function(t){return $t(t)||(t=ur(t)),De(this.low|t.low,this.high|t.high,this.unsigned)},L.xor=function(t){return $t(t)||(t=ur(t)),De(this.low^t.low,this.high^t.high,this.unsigned)},L.shiftLeft=function(t){return $t(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?De(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):De(0,this.low<<t-32,this.unsigned)},L.shl=L.shiftLeft,L.shiftRight=function(t){return $t(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?De(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):De(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},L.shr=L.shiftRight,L.shiftRightUnsigned=function(t){return $t(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?De(this.low>>>t|this.high<<32-t,this.high>>>t,this.unsigned):t===32?De(this.high,0,this.unsigned):De(this.high>>>t-32,0,this.unsigned)},L.shru=L.shiftRightUnsigned,L.shr_u=L.shiftRightUnsigned,L.rotateLeft=function(t){var e;return $t(t)&&(t=t.toInt()),(t&=63)===0?this:t===32?De(this.high,this.low,this.unsigned):t<32?(e=32-t,De(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned)):(t-=32,e=32-t,De(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned))},L.rotl=L.rotateLeft,L.rotateRight=function(t){var e;return $t(t)&&(t=t.toInt()),(t&=63)===0?this:t===32?De(this.high,this.low,this.unsigned):t<32?(e=32-t,De(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned)):(t-=32,e=32-t,De(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned))},L.rotr=L.rotateRight,L.toSigned=function(){return this.unsigned?De(this.low,this.high,!1):this},L.toUnsigned=function(){return this.unsigned?this:De(this.low,this.high,!0)},L.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},L.toBytesLE=function(){var t=this.high,e=this.low;return[e&255,e>>>8&255,e>>>16&255,e>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]},L.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,e>>>24,e>>>16&255,e>>>8&255,e&255]},Ve.fromBytes=function(t,e,n){return n?Ve.fromBytesLE(t,e):Ve.fromBytesBE(t,e)},Ve.fromBytesLE=function(t,e){return new Ve(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},Ve.fromBytesBE=function(t,e){return new Ve(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)},Zi=Ve}),D,iw=P(()=>{D={},D.Offset,D.Table,D.SIZEOF_SHORT=2,D.SIZEOF_INT=4,D.FILE_IDENTIFIER_LENGTH=4,D.SIZE_PREFIX_LENGTH=4,D.Encoding={UTF8_BYTES:1,UTF16_STRING:2},D.int32=new Int32Array(2),D.float32=new Float32Array(D.int32.buffer),D.float64=new Float64Array(D.int32.buffer),D.isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1,D.Long=function(t,e){this.low=t|0,this.high=e|0},D.Long.create=function(t,e){return t==0&&e==0?D.Long.ZERO:new D.Long(t,e)},D.Long.prototype.toFloat64=function(){return(this.low>>>0)+this.high*4294967296},D.Long.prototype.equals=function(t){return this.low==t.low&&this.high==t.high},D.Long.ZERO=new D.Long(0,0),D.Builder=function(t){if(t)var e=t;else var e=1024;this.bb=D.ByteBuffer.allocate(e),this.space=e,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},D.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},D.Builder.prototype.forceDefaults=function(t){this.force_defaults=t},D.Builder.prototype.dataBuffer=function(){return this.bb},D.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},D.Builder.prototype.prep=function(t,e){t>this.minalign&&(this.minalign=t);for(var n=~(this.bb.capacity()-this.space+e)+1&t-1;this.space<n+t+e;){var r=this.bb.capacity();this.bb=D.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-r}this.pad(n)},D.Builder.prototype.pad=function(t){for(var e=0;e<t;e++)this.bb.writeInt8(--this.space,0)},D.Builder.prototype.writeInt8=function(t){this.bb.writeInt8(this.space-=1,t)},D.Builder.prototype.writeInt16=function(t){this.bb.writeInt16(this.space-=2,t)},D.Builder.prototype.writeInt32=function(t){this.bb.writeInt32(this.space-=4,t)},D.Builder.prototype.writeInt64=function(t){this.bb.writeInt64(this.space-=8,t)},D.Builder.prototype.writeFloat32=function(t){this.bb.writeFloat32(this.space-=4,t)},D.Builder.prototype.writeFloat64=function(t){this.bb.writeFloat64(this.space-=8,t)},D.Builder.prototype.addInt8=function(t){this.prep(1,0),this.writeInt8(t)},D.Builder.prototype.addInt16=function(t){this.prep(2,0),this.writeInt16(t)},D.Builder.prototype.addInt32=function(t){this.prep(4,0),this.writeInt32(t)},D.Builder.prototype.addInt64=function(t){this.prep(8,0),this.writeInt64(t)},D.Builder.prototype.addFloat32=function(t){this.prep(4,0),this.writeFloat32(t)},D.Builder.prototype.addFloat64=function(t){this.prep(8,0),this.writeFloat64(t)},D.Builder.prototype.addFieldInt8=function(t,e,n){(this.force_defaults||e!=n)&&(this.addInt8(e),this.slot(t))},D.Builder.prototype.addFieldInt16=function(t,e,n){(this.force_defaults||e!=n)&&(this.addInt16(e),this.slot(t))},D.Builder.prototype.addFieldInt32=function(t,e,n){(this.force_defaults||e!=n)&&(this.addInt32(e),this.slot(t))},D.Builder.prototype.addFieldInt64=function(t,e,n){(this.force_defaults||!e.equals(n))&&(this.addInt64(e),this.slot(t))},D.Builder.prototype.addFieldFloat32=function(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat32(e),this.slot(t))},D.Builder.prototype.addFieldFloat64=function(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat64(e),this.slot(t))},D.Builder.prototype.addFieldOffset=function(t,e,n){(this.force_defaults||e!=n)&&(this.addOffset(e),this.slot(t))},D.Builder.prototype.addFieldStruct=function(t,e,n){e!=n&&(this.nested(e),this.slot(t))},D.Builder.prototype.nested=function(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},D.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},D.Builder.prototype.slot=function(t){this.vtable[t]=this.offset()},D.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},D.Builder.growByteBuffer=function(t){var e=t.capacity();if(e&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var n=e<<1,r=D.ByteBuffer.allocate(n);return r.setPosition(n-e),r.bytes().set(t.bytes(),n-e),r},D.Builder.prototype.addOffset=function(t){this.prep(D.SIZEOF_INT,0),this.writeInt32(this.offset()-t+D.SIZEOF_INT)},D.Builder.prototype.startObject=function(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(var e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()},D.Builder.prototype.endObject=function(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var t=this.offset(),e=this.vtable_in_use-1;e>=0&&this.vtable[e]==0;e--);for(var n=e+1;e>=0;e--)this.addInt16(this.vtable[e]!=0?t-this.vtable[e]:0);var r=2;this.addInt16(t-this.object_start);var i=(n+r)*D.SIZEOF_SHORT;this.addInt16(i);var o=0,l=this.space;e:for(e=0;e<this.vtables.length;e++){var a=this.bb.capacity()-this.vtables[e];if(i==this.bb.readInt16(a)){for(var c=D.SIZEOF_SHORT;c<i;c+=D.SIZEOF_SHORT)if(this.bb.readInt16(l+c)!=this.bb.readInt16(a+c))continue e;o=this.vtables[e];break}}return o?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,o-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t},D.Builder.prototype.finish=function(t,e,n){var r=n?D.SIZE_PREFIX_LENGTH:0;if(e){var i=e;if(this.prep(this.minalign,D.SIZEOF_INT+D.FILE_IDENTIFIER_LENGTH+r),i.length!=D.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+D.FILE_IDENTIFIER_LENGTH);for(var o=D.FILE_IDENTIFIER_LENGTH-1;o>=0;o--)this.writeInt8(i.charCodeAt(o))}this.prep(this.minalign,D.SIZEOF_INT+r),this.addOffset(t),r&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)},D.Builder.prototype.finishSizePrefixed=function(t,e){this.finish(t,e,!0)},D.Builder.prototype.requiredField=function(t,e){var n=this.bb.capacity()-t,r=n-this.bb.readInt32(n),i=this.bb.readInt16(r+e)!=0;if(!i)throw new Error("FlatBuffers: field "+e+" must be set")},D.Builder.prototype.startVector=function(t,e,n){this.notNested(),this.vector_num_elems=e,this.prep(D.SIZEOF_INT,t*e),this.prep(n,t*e)},D.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},D.Builder.prototype.createString=function(t){if(t instanceof Uint8Array)var e=t;else for(var e=[],n=0;n<t.length;){var r,i=t.charCodeAt(n++);if(i<55296||i>=56320)r=i;else{var o=t.charCodeAt(n++);r=(i<<10)+o+-56613888}r<128?e.push(r):(r<2048?e.push(r>>6&31|192):(r<65536?e.push(r>>12&15|224):e.push(r>>18&7|240,r>>12&63|128),e.push(r>>6&63|128)),e.push(r&63|128))}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(var n=0,l=this.space,a=this.bb.bytes();n<e.length;n++)a[l++]=e[n];return this.endVector()},D.Builder.prototype.createLong=function(t,e){return D.Long.create(t,e)},D.ByteBuffer=function(t){this.bytes_=t,this.position_=0},D.ByteBuffer.allocate=function(t){return new D.ByteBuffer(new Uint8Array(t))},D.ByteBuffer.prototype.clear=function(){this.position_=0},D.ByteBuffer.prototype.bytes=function(){return this.bytes_},D.ByteBuffer.prototype.position=function(){return this.position_},D.ByteBuffer.prototype.setPosition=function(t){this.position_=t},D.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},D.ByteBuffer.prototype.readInt8=function(t){return this.readUint8(t)<<24>>24},D.ByteBuffer.prototype.readUint8=function(t){return this.bytes_[t]},D.ByteBuffer.prototype.readInt16=function(t){return this.readUint16(t)<<16>>16},D.ByteBuffer.prototype.readUint16=function(t){return this.bytes_[t]|this.bytes_[t+1]<<8},D.ByteBuffer.prototype.readInt32=function(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24},D.ByteBuffer.prototype.readUint32=function(t){return this.readInt32(t)>>>0},D.ByteBuffer.prototype.readInt64=function(t){return new D.Long(this.readInt32(t),this.readInt32(t+4))},D.ByteBuffer.prototype.readUint64=function(t){return new D.Long(this.readUint32(t),this.readUint32(t+4))},D.ByteBuffer.prototype.readFloat32=function(t){return D.int32[0]=this.readInt32(t),D.float32[0]},D.ByteBuffer.prototype.readFloat64=function(t){return D.int32[D.isLittleEndian?0:1]=this.readInt32(t),D.int32[D.isLittleEndian?1:0]=this.readInt32(t+4),D.float64[0]},D.ByteBuffer.prototype.writeInt8=function(t,e){this.bytes_[t]=e},D.ByteBuffer.prototype.writeUint8=function(t,e){this.bytes_[t]=e},D.ByteBuffer.prototype.writeInt16=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8},D.ByteBuffer.prototype.writeUint16=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8},D.ByteBuffer.prototype.writeInt32=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24},D.ByteBuffer.prototype.writeUint32=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24},D.ByteBuffer.prototype.writeInt64=function(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)},D.ByteBuffer.prototype.writeUint64=function(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)},D.ByteBuffer.prototype.writeFloat32=function(t,e){D.float32[0]=e,this.writeInt32(t,D.int32[0])},D.ByteBuffer.prototype.writeFloat64=function(t,e){D.float64[0]=e,this.writeInt32(t,D.int32[D.isLittleEndian?0:1]),this.writeInt32(t+4,D.int32[D.isLittleEndian?1:0])},D.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+D.SIZEOF_INT+D.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var t="",e=0;e<D.FILE_IDENTIFIER_LENGTH;e++)t+=String.fromCharCode(this.readInt8(this.position_+D.SIZEOF_INT+e));return t},D.ByteBuffer.prototype.__offset=function(t,e){var n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0},D.ByteBuffer.prototype.__union=function(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t},D.ByteBuffer.prototype.__string=function(t,e){t+=this.readInt32(t);var n=this.readInt32(t),r="",i=0;if(t+=D.SIZEOF_INT,e===D.Encoding.UTF8_BYTES)return this.bytes_.subarray(t,t+n);for(;i<n;){var o,l=this.readUint8(t+i++);if(l<192)o=l;else{var a=this.readUint8(t+i++);if(l<224)o=(l&31)<<6|a&63;else{var c=this.readUint8(t+i++);if(l<240)o=(l&15)<<12|(a&63)<<6|c&63;else{var s=this.readUint8(t+i++);o=(l&7)<<18|(a&63)<<12|(c&63)<<6|s&63}}}o<65536?r+=String.fromCharCode(o):(o-=65536,r+=String.fromCharCode((o>>10)+55296,(o&1023)+56320))}return r},D.ByteBuffer.prototype.__indirect=function(t){return t+this.readInt32(t)},D.ByteBuffer.prototype.__vector=function(t){return t+this.readInt32(t)+D.SIZEOF_INT},D.ByteBuffer.prototype.__vector_len=function(t){return this.readInt32(t+this.readInt32(t))},D.ByteBuffer.prototype.__has_identifier=function(t){if(t.length!=D.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+D.FILE_IDENTIFIER_LENGTH);for(var e=0;e<D.FILE_IDENTIFIER_LENGTH;e++)if(t.charCodeAt(e)!=this.readInt8(this.position_+D.SIZEOF_INT+e))return!1;return!0},D.ByteBuffer.prototype.createLong=function(t,e){return D.Long.create(t,e)}}),Ne,up=P(()=>{"use strict";iw(),(t=>{let e;(n=>{let r;(i=>{let o;(l=>(l[l.UNDEFINED=0]="UNDEFINED",l[l.FLOAT=1]="FLOAT",l[l.INT=2]="INT",l[l.STRING=3]="STRING",l[l.TENSOR=4]="TENSOR",l[l.GRAPH=5]="GRAPH",l[l.FLOATS=6]="FLOATS",l[l.INTS=7]="INTS",l[l.STRINGS=8]="STRINGS",l[l.TENSORS=9]="TENSORS",l[l.GRAPHS=10]="GRAPHS",l[l.SPARSE_TENSOR=11]="SPARSE_TENSOR",l[l.SPARSE_TENSORS=12]="SPARSE_TENSORS"))(o=i.AttributeType||={})})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{let o;(l=>(l[l.UNKNOWN=0]="UNKNOWN",l[l.VALUE=1]="VALUE",l[l.PARAM=2]="PARAM"))(o=i.DimensionValueType||={})})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{let o;(l=>(l[l.UNDEFINED=0]="UNDEFINED",l[l.FLOAT=1]="FLOAT",l[l.UINT8=2]="UINT8",l[l.INT8=3]="INT8",l[l.UINT16=4]="UINT16",l[l.INT16=5]="INT16",l[l.INT32=6]="INT32",l[l.INT64=7]="INT64",l[l.STRING=8]="STRING",l[l.BOOL=9]="BOOL",l[l.FLOAT16=10]="FLOAT16",l[l.DOUBLE=11]="DOUBLE",l[l.UINT32=12]="UINT32",l[l.UINT64=13]="UINT64",l[l.COMPLEX64=14]="COMPLEX64",l[l.COMPLEX128=15]="COMPLEX128",l[l.BFLOAT16=16]="BFLOAT16",l[l.FLOAT8E4M3FN=17]="FLOAT8E4M3FN",l[l.FLOAT8E4M3FNUZ=18]="FLOAT8E4M3FNUZ",l[l.FLOAT8E5M2=19]="FLOAT8E5M2",l[l.FLOAT8E5M2FNUZ=20]="FLOAT8E5M2FNUZ"))(o=i.TensorDataType||={})})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{let o;(l=>(l[l.Primitive=0]="Primitive",l[l.Fused=1]="Fused"))(o=i.NodeType||={})})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{let o;(l=>(l[l.NONE=0]="NONE",l[l.tensor_type=1]="tensor_type",l[l.sequence_type=2]="sequence_type",l[l.map_type=3]="map_type"))(o=i.TypeInfoValue||={})})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsShape(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsShape(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}dim(a,c){let s=this.bb.__offset(this.bb_pos,4);return s?(c||new t.experimental.fbs.Dimension).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+a*4),this.bb):null}dimLength(){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.__vector_len(this.bb_pos+a):0}static startShape(a){a.startObject(1)}static addDim(a,c){a.addFieldOffset(0,c,0)}static createDimVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startDimVector(a,c){a.startVector(4,c,4)}static endShape(a){return a.endObject()}static createShape(a,c){return o.startShape(a),o.addDim(a,c),o.endShape(a)}}i.Shape=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsDimension(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsDimension(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}value(a){let c=this.bb.__offset(this.bb_pos,4);return c?(a||new t.experimental.fbs.DimensionValue).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}denotation(a){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,a):null}static startDimension(a){a.startObject(2)}static addValue(a,c){a.addFieldOffset(0,c,0)}static addDenotation(a,c){a.addFieldOffset(1,c,0)}static endDimension(a){return a.endObject()}static createDimension(a,c,s){return o.startDimension(a),o.addValue(a,c),o.addDenotation(a,s),o.endDimension(a)}}i.Dimension=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsDimensionValue(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsDimensionValue(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}dimType(){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt8(this.bb_pos+a):0}dimValue(){let a=this.bb.__offset(this.bb_pos,6);return a?this.bb.readInt64(this.bb_pos+a):this.bb.createLong(0,0)}dimParam(a){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.__string(this.bb_pos+c,a):null}static startDimensionValue(a){a.startObject(3)}static addDimType(a,c){a.addFieldInt8(0,c,0)}static addDimValue(a,c){a.addFieldInt64(1,c,a.createLong(0,0))}static addDimParam(a,c){a.addFieldOffset(2,c,0)}static endDimensionValue(a){return a.endObject()}static createDimensionValue(a,c,s,u){return o.startDimensionValue(a),o.addDimType(a,c),o.addDimValue(a,s),o.addDimParam(a,u),o.endDimensionValue(a)}}i.DimensionValue=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsTensorTypeAndShape(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsTensorTypeAndShape(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}elemType(){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt32(this.bb_pos+a):0}shape(a){let c=this.bb.__offset(this.bb_pos,6);return c?(a||new t.experimental.fbs.Shape).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startTensorTypeAndShape(a){a.startObject(2)}static addElemType(a,c){a.addFieldInt32(0,c,0)}static addShape(a,c){a.addFieldOffset(1,c,0)}static endTensorTypeAndShape(a){return a.endObject()}static createTensorTypeAndShape(a,c,s){return o.startTensorTypeAndShape(a),o.addElemType(a,c),o.addShape(a,s),o.endTensorTypeAndShape(a)}}i.TensorTypeAndShape=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsMapType(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsMapType(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}keyType(){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt32(this.bb_pos+a):0}valueType(a){let c=this.bb.__offset(this.bb_pos,6);return c?(a||new t.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startMapType(a){a.startObject(2)}static addKeyType(a,c){a.addFieldInt32(0,c,0)}static addValueType(a,c){a.addFieldOffset(1,c,0)}static endMapType(a){return a.endObject()}static createMapType(a,c,s){return o.startMapType(a),o.addKeyType(a,c),o.addValueType(a,s),o.endMapType(a)}}i.MapType=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsSequenceType(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsSequenceType(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}elemType(a){let c=this.bb.__offset(this.bb_pos,4);return c?(a||new t.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startSequenceType(a){a.startObject(1)}static addElemType(a,c){a.addFieldOffset(0,c,0)}static endSequenceType(a){return a.endObject()}static createSequenceType(a,c){return o.startSequenceType(a),o.addElemType(a,c),o.endSequenceType(a)}}i.SequenceType=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}nodeIndex(){return this.bb.readUint32(this.bb_pos)}srcArgIndex(){return this.bb.readInt32(this.bb_pos+4)}dstArgIndex(){return this.bb.readInt32(this.bb_pos+8)}static createEdgeEnd(a,c,s,u){return a.prep(4,12),a.writeInt32(u),a.writeInt32(s),a.writeInt32(c),a.offset()}}i.EdgeEnd=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsNodeEdge(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsNodeEdge(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}nodeIndex(){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readUint32(this.bb_pos+a):0}inputEdges(a,c){let s=this.bb.__offset(this.bb_pos,6);return s?(c||new t.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+s)+a*12,this.bb):null}inputEdgesLength(){let a=this.bb.__offset(this.bb_pos,6);return a?this.bb.__vector_len(this.bb_pos+a):0}outputEdges(a,c){let s=this.bb.__offset(this.bb_pos,8);return s?(c||new t.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+s)+a*12,this.bb):null}outputEdgesLength(){let a=this.bb.__offset(this.bb_pos,8);return a?this.bb.__vector_len(this.bb_pos+a):0}static startNodeEdge(a){a.startObject(3)}static addNodeIndex(a,c){a.addFieldInt32(0,c,0)}static addInputEdges(a,c){a.addFieldOffset(1,c,0)}static startInputEdgesVector(a,c){a.startVector(12,c,4)}static addOutputEdges(a,c){a.addFieldOffset(2,c,0)}static startOutputEdgesVector(a,c){a.startVector(12,c,4)}static endNodeEdge(a){return a.endObject()}static createNodeEdge(a,c,s,u){return o.startNodeEdge(a),o.addNodeIndex(a,c),o.addInputEdges(a,s),o.addOutputEdges(a,u),o.endNodeEdge(a)}}i.NodeEdge=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsNode(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsNode(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}name(a){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,a):null}docString(a){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,a):null}domain(a){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.__string(this.bb_pos+c,a):null}sinceVersion(){let a=this.bb.__offset(this.bb_pos,10);return a?this.bb.readInt32(this.bb_pos+a):0}index(){let a=this.bb.__offset(this.bb_pos,12);return a?this.bb.readUint32(this.bb_pos+a):0}opType(a){let c=this.bb.__offset(this.bb_pos,14);return c?this.bb.__string(this.bb_pos+c,a):null}type(){let a=this.bb.__offset(this.bb_pos,16);return a?this.bb.readInt32(this.bb_pos+a):0}executionProviderType(a){let c=this.bb.__offset(this.bb_pos,18);return c?this.bb.__string(this.bb_pos+c,a):null}inputs(a,c){let s=this.bb.__offset(this.bb_pos,20);return s?this.bb.__string(this.bb.__vector(this.bb_pos+s)+a*4,c):null}inputsLength(){let a=this.bb.__offset(this.bb_pos,20);return a?this.bb.__vector_len(this.bb_pos+a):0}outputs(a,c){let s=this.bb.__offset(this.bb_pos,22);return s?this.bb.__string(this.bb.__vector(this.bb_pos+s)+a*4,c):null}outputsLength(){let a=this.bb.__offset(this.bb_pos,22);return a?this.bb.__vector_len(this.bb_pos+a):0}attributes(a,c){let s=this.bb.__offset(this.bb_pos,24);return s?(c||new t.experimental.fbs.Attribute).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+a*4),this.bb):null}attributesLength(){let a=this.bb.__offset(this.bb_pos,24);return a?this.bb.__vector_len(this.bb_pos+a):0}inputArgCounts(a){let c=this.bb.__offset(this.bb_pos,26);return c?this.bb.readInt32(this.bb.__vector(this.bb_pos+c)+a*4):0}inputArgCountsLength(){let a=this.bb.__offset(this.bb_pos,26);return a?this.bb.__vector_len(this.bb_pos+a):0}inputArgCountsArray(){let a=this.bb.__offset(this.bb_pos,26);return a?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+a),this.bb.__vector_len(this.bb_pos+a)):null}implicitInputs(a,c){let s=this.bb.__offset(this.bb_pos,28);return s?this.bb.__string(this.bb.__vector(this.bb_pos+s)+a*4,c):null}implicitInputsLength(){let a=this.bb.__offset(this.bb_pos,28);return a?this.bb.__vector_len(this.bb_pos+a):0}static startNode(a){a.startObject(13)}static addName(a,c){a.addFieldOffset(0,c,0)}static addDocString(a,c){a.addFieldOffset(1,c,0)}static addDomain(a,c){a.addFieldOffset(2,c,0)}static addSinceVersion(a,c){a.addFieldInt32(3,c,0)}static addIndex(a,c){a.addFieldInt32(4,c,0)}static addOpType(a,c){a.addFieldOffset(5,c,0)}static addType(a,c){a.addFieldInt32(6,c,0)}static addExecutionProviderType(a,c){a.addFieldOffset(7,c,0)}static addInputs(a,c){a.addFieldOffset(8,c,0)}static createInputsVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startInputsVector(a,c){a.startVector(4,c,4)}static addOutputs(a,c){a.addFieldOffset(9,c,0)}static createOutputsVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startOutputsVector(a,c){a.startVector(4,c,4)}static addAttributes(a,c){a.addFieldOffset(10,c,0)}static createAttributesVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startAttributesVector(a,c){a.startVector(4,c,4)}static addInputArgCounts(a,c){a.addFieldOffset(11,c,0)}static createInputArgCountsVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addInt32(c[s]);return a.endVector()}static startInputArgCountsVector(a,c){a.startVector(4,c,4)}static addImplicitInputs(a,c){a.addFieldOffset(12,c,0)}static createImplicitInputsVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startImplicitInputsVector(a,c){a.startVector(4,c,4)}static endNode(a){return a.endObject()}static createNode(a,c,s,u,d,h,f,p,g,y,b,v,_,I){return o.startNode(a),o.addName(a,c),o.addDocString(a,s),o.addDomain(a,u),o.addSinceVersion(a,d),o.addIndex(a,h),o.addOpType(a,f),o.addType(a,p),o.addExecutionProviderType(a,g),o.addInputs(a,y),o.addOutputs(a,b),o.addAttributes(a,v),o.addInputArgCounts(a,_),o.addImplicitInputs(a,I),o.endNode(a)}}i.Node=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsValueInfo(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsValueInfo(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}name(a){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,a):null}docString(a){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,a):null}type(a){let c=this.bb.__offset(this.bb_pos,8);return c?(a||new t.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startValueInfo(a){a.startObject(3)}static addName(a,c){a.addFieldOffset(0,c,0)}static addDocString(a,c){a.addFieldOffset(1,c,0)}static addType(a,c){a.addFieldOffset(2,c,0)}static endValueInfo(a){return a.endObject()}static createValueInfo(a,c,s,u){return o.startValueInfo(a),o.addName(a,c),o.addDocString(a,s),o.addType(a,u),o.endValueInfo(a)}}i.ValueInfo=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsTypeInfo(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsTypeInfo(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}denotation(a){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,a):null}valueType(){let a=this.bb.__offset(this.bb_pos,6);return a?this.bb.readUint8(this.bb_pos+a):0}value(a){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.__union(a,this.bb_pos+c):null}static startTypeInfo(a){a.startObject(3)}static addDenotation(a,c){a.addFieldOffset(0,c,0)}static addValueType(a,c){a.addFieldInt8(1,c,0)}static addValue(a,c){a.addFieldOffset(2,c,0)}static endTypeInfo(a){return a.endObject()}static createTypeInfo(a,c,s,u){return o.startTypeInfo(a),o.addDenotation(a,c),o.addValueType(a,s),o.addValue(a,u),o.endTypeInfo(a)}}i.TypeInfo=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsOperatorSetId(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsOperatorSetId(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}domain(a){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,a):null}version(){let a=this.bb.__offset(this.bb_pos,6);return a?this.bb.readInt64(this.bb_pos+a):this.bb.createLong(0,0)}static startOperatorSetId(a){a.startObject(2)}static addDomain(a,c){a.addFieldOffset(0,c,0)}static addVersion(a,c){a.addFieldInt64(1,c,a.createLong(0,0))}static endOperatorSetId(a){return a.endObject()}static createOperatorSetId(a,c,s){return o.startOperatorSetId(a),o.addDomain(a,c),o.addVersion(a,s),o.endOperatorSetId(a)}}i.OperatorSetId=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsTensor(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsTensor(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}name(a){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,a):null}docString(a){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,a):null}dims(a){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.readInt64(this.bb.__vector(this.bb_pos+c)+a*8):this.bb.createLong(0,0)}dimsLength(){let a=this.bb.__offset(this.bb_pos,8);return a?this.bb.__vector_len(this.bb_pos+a):0}dataType(){let a=this.bb.__offset(this.bb_pos,10);return a?this.bb.readInt32(this.bb_pos+a):0}rawData(a){let c=this.bb.__offset(this.bb_pos,12);return c?this.bb.readUint8(this.bb.__vector(this.bb_pos+c)+a):0}rawDataLength(){let a=this.bb.__offset(this.bb_pos,12);return a?this.bb.__vector_len(this.bb_pos+a):0}rawDataArray(){let a=this.bb.__offset(this.bb_pos,12);return a?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+a),this.bb.__vector_len(this.bb_pos+a)):null}stringData(a,c){let s=this.bb.__offset(this.bb_pos,14);return s?this.bb.__string(this.bb.__vector(this.bb_pos+s)+a*4,c):null}stringDataLength(){let a=this.bb.__offset(this.bb_pos,14);return a?this.bb.__vector_len(this.bb_pos+a):0}static startTensor(a){a.startObject(6)}static addName(a,c){a.addFieldOffset(0,c,0)}static addDocString(a,c){a.addFieldOffset(1,c,0)}static addDims(a,c){a.addFieldOffset(2,c,0)}static createDimsVector(a,c){a.startVector(8,c.length,8);for(let s=c.length-1;s>=0;s--)a.addInt64(c[s]);return a.endVector()}static startDimsVector(a,c){a.startVector(8,c,8)}static addDataType(a,c){a.addFieldInt32(3,c,0)}static addRawData(a,c){a.addFieldOffset(4,c,0)}static createRawDataVector(a,c){a.startVector(1,c.length,1);for(let s=c.length-1;s>=0;s--)a.addInt8(c[s]);return a.endVector()}static startRawDataVector(a,c){a.startVector(1,c,1)}static addStringData(a,c){a.addFieldOffset(5,c,0)}static createStringDataVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startStringDataVector(a,c){a.startVector(4,c,4)}static endTensor(a){return a.endObject()}static createTensor(a,c,s,u,d,h,f){return o.startTensor(a),o.addName(a,c),o.addDocString(a,s),o.addDims(a,u),o.addDataType(a,d),o.addRawData(a,h),o.addStringData(a,f),o.endTensor(a)}}i.Tensor=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsSparseTensor(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsSparseTensor(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}values(a){let c=this.bb.__offset(this.bb_pos,4);return c?(a||new t.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}indices(a){let c=this.bb.__offset(this.bb_pos,6);return c?(a||new t.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}dims(a){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.readInt64(this.bb.__vector(this.bb_pos+c)+a*8):this.bb.createLong(0,0)}dimsLength(){let a=this.bb.__offset(this.bb_pos,8);return a?this.bb.__vector_len(this.bb_pos+a):0}static startSparseTensor(a){a.startObject(3)}static addValues(a,c){a.addFieldOffset(0,c,0)}static addIndices(a,c){a.addFieldOffset(1,c,0)}static addDims(a,c){a.addFieldOffset(2,c,0)}static createDimsVector(a,c){a.startVector(8,c.length,8);for(let s=c.length-1;s>=0;s--)a.addInt64(c[s]);return a.endVector()}static startDimsVector(a,c){a.startVector(8,c,8)}static endSparseTensor(a){return a.endObject()}static createSparseTensor(a,c,s,u){return o.startSparseTensor(a),o.addValues(a,c),o.addIndices(a,s),o.addDims(a,u),o.endSparseTensor(a)}}i.SparseTensor=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsAttribute(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsAttribute(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}name(a){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,a):null}docString(a){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,a):null}type(){let a=this.bb.__offset(this.bb_pos,8);return a?this.bb.readInt32(this.bb_pos+a):0}f(){let a=this.bb.__offset(this.bb_pos,10);return a?this.bb.readFloat32(this.bb_pos+a):0}i(){let a=this.bb.__offset(this.bb_pos,12);return a?this.bb.readInt64(this.bb_pos+a):this.bb.createLong(0,0)}s(a){let c=this.bb.__offset(this.bb_pos,14);return c?this.bb.__string(this.bb_pos+c,a):null}t(a){let c=this.bb.__offset(this.bb_pos,16);return c?(a||new t.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}g(a){let c=this.bb.__offset(this.bb_pos,18);return c?(a||new t.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}floats(a){let c=this.bb.__offset(this.bb_pos,20);return c?this.bb.readFloat32(this.bb.__vector(this.bb_pos+c)+a*4):0}floatsLength(){let a=this.bb.__offset(this.bb_pos,20);return a?this.bb.__vector_len(this.bb_pos+a):0}floatsArray(){let a=this.bb.__offset(this.bb_pos,20);return a?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+a),this.bb.__vector_len(this.bb_pos+a)):null}ints(a){let c=this.bb.__offset(this.bb_pos,22);return c?this.bb.readInt64(this.bb.__vector(this.bb_pos+c)+a*8):this.bb.createLong(0,0)}intsLength(){let a=this.bb.__offset(this.bb_pos,22);return a?this.bb.__vector_len(this.bb_pos+a):0}strings(a,c){let s=this.bb.__offset(this.bb_pos,24);return s?this.bb.__string(this.bb.__vector(this.bb_pos+s)+a*4,c):null}stringsLength(){let a=this.bb.__offset(this.bb_pos,24);return a?this.bb.__vector_len(this.bb_pos+a):0}tensors(a,c){let s=this.bb.__offset(this.bb_pos,26);return s?(c||new t.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+a*4),this.bb):null}tensorsLength(){let a=this.bb.__offset(this.bb_pos,26);return a?this.bb.__vector_len(this.bb_pos+a):0}graphs(a,c){let s=this.bb.__offset(this.bb_pos,28);return s?(c||new t.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+a*4),this.bb):null}graphsLength(){let a=this.bb.__offset(this.bb_pos,28);return a?this.bb.__vector_len(this.bb_pos+a):0}static startAttribute(a){a.startObject(13)}static addName(a,c){a.addFieldOffset(0,c,0)}static addDocString(a,c){a.addFieldOffset(1,c,0)}static addType(a,c){a.addFieldInt32(2,c,0)}static addF(a,c){a.addFieldFloat32(3,c,0)}static addI(a,c){a.addFieldInt64(4,c,a.createLong(0,0))}static addS(a,c){a.addFieldOffset(5,c,0)}static addT(a,c){a.addFieldOffset(6,c,0)}static addG(a,c){a.addFieldOffset(7,c,0)}static addFloats(a,c){a.addFieldOffset(8,c,0)}static createFloatsVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addFloat32(c[s]);return a.endVector()}static startFloatsVector(a,c){a.startVector(4,c,4)}static addInts(a,c){a.addFieldOffset(9,c,0)}static createIntsVector(a,c){a.startVector(8,c.length,8);for(let s=c.length-1;s>=0;s--)a.addInt64(c[s]);return a.endVector()}static startIntsVector(a,c){a.startVector(8,c,8)}static addStrings(a,c){a.addFieldOffset(10,c,0)}static createStringsVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startStringsVector(a,c){a.startVector(4,c,4)}static addTensors(a,c){a.addFieldOffset(11,c,0)}static createTensorsVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startTensorsVector(a,c){a.startVector(4,c,4)}static addGraphs(a,c){a.addFieldOffset(12,c,0)}static createGraphsVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startGraphsVector(a,c){a.startVector(4,c,4)}static endAttribute(a){return a.endObject()}static createAttribute(a,c,s,u,d,h,f,p,g,y,b,v,_,I){return o.startAttribute(a),o.addName(a,c),o.addDocString(a,s),o.addType(a,u),o.addF(a,d),o.addI(a,h),o.addS(a,f),o.addT(a,p),o.addG(a,g),o.addFloats(a,y),o.addInts(a,b),o.addStrings(a,v),o.addTensors(a,_),o.addGraphs(a,I),o.endAttribute(a)}}i.Attribute=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsGraph(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsGraph(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}initializers(a,c){let s=this.bb.__offset(this.bb_pos,4);return s?(c||new t.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+a*4),this.bb):null}initializersLength(){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.__vector_len(this.bb_pos+a):0}nodeArgs(a,c){let s=this.bb.__offset(this.bb_pos,6);return s?(c||new t.experimental.fbs.ValueInfo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+a*4),this.bb):null}nodeArgsLength(){let a=this.bb.__offset(this.bb_pos,6);return a?this.bb.__vector_len(this.bb_pos+a):0}nodes(a,c){let s=this.bb.__offset(this.bb_pos,8);return s?(c||new t.experimental.fbs.Node).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+a*4),this.bb):null}nodesLength(){let a=this.bb.__offset(this.bb_pos,8);return a?this.bb.__vector_len(this.bb_pos+a):0}maxNodeIndex(){let a=this.bb.__offset(this.bb_pos,10);return a?this.bb.readUint32(this.bb_pos+a):0}nodeEdges(a,c){let s=this.bb.__offset(this.bb_pos,12);return s?(c||new t.experimental.fbs.NodeEdge).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+a*4),this.bb):null}nodeEdgesLength(){let a=this.bb.__offset(this.bb_pos,12);return a?this.bb.__vector_len(this.bb_pos+a):0}inputs(a,c){let s=this.bb.__offset(this.bb_pos,14);return s?this.bb.__string(this.bb.__vector(this.bb_pos+s)+a*4,c):null}inputsLength(){let a=this.bb.__offset(this.bb_pos,14);return a?this.bb.__vector_len(this.bb_pos+a):0}outputs(a,c){let s=this.bb.__offset(this.bb_pos,16);return s?this.bb.__string(this.bb.__vector(this.bb_pos+s)+a*4,c):null}outputsLength(){let a=this.bb.__offset(this.bb_pos,16);return a?this.bb.__vector_len(this.bb_pos+a):0}sparseInitializers(a,c){let s=this.bb.__offset(this.bb_pos,18);return s?(c||new t.experimental.fbs.SparseTensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+a*4),this.bb):null}sparseInitializersLength(){let a=this.bb.__offset(this.bb_pos,18);return a?this.bb.__vector_len(this.bb_pos+a):0}static startGraph(a){a.startObject(8)}static addInitializers(a,c){a.addFieldOffset(0,c,0)}static createInitializersVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startInitializersVector(a,c){a.startVector(4,c,4)}static addNodeArgs(a,c){a.addFieldOffset(1,c,0)}static createNodeArgsVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startNodeArgsVector(a,c){a.startVector(4,c,4)}static addNodes(a,c){a.addFieldOffset(2,c,0)}static createNodesVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startNodesVector(a,c){a.startVector(4,c,4)}static addMaxNodeIndex(a,c){a.addFieldInt32(3,c,0)}static addNodeEdges(a,c){a.addFieldOffset(4,c,0)}static createNodeEdgesVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startNodeEdgesVector(a,c){a.startVector(4,c,4)}static addInputs(a,c){a.addFieldOffset(5,c,0)}static createInputsVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startInputsVector(a,c){a.startVector(4,c,4)}static addOutputs(a,c){a.addFieldOffset(6,c,0)}static createOutputsVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startOutputsVector(a,c){a.startVector(4,c,4)}static addSparseInitializers(a,c){a.addFieldOffset(7,c,0)}static createSparseInitializersVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startSparseInitializersVector(a,c){a.startVector(4,c,4)}static endGraph(a){return a.endObject()}static createGraph(a,c,s,u,d,h,f,p,g){return o.startGraph(a),o.addInitializers(a,c),o.addNodeArgs(a,s),o.addNodes(a,u),o.addMaxNodeIndex(a,d),o.addNodeEdges(a,h),o.addInputs(a,f),o.addOutputs(a,p),o.addSparseInitializers(a,g),o.endGraph(a)}}i.Graph=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsModel(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsModel(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}irVersion(){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt64(this.bb_pos+a):this.bb.createLong(0,0)}opsetImport(a,c){let s=this.bb.__offset(this.bb_pos,6);return s?(c||new t.experimental.fbs.OperatorSetId).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+a*4),this.bb):null}opsetImportLength(){let a=this.bb.__offset(this.bb_pos,6);return a?this.bb.__vector_len(this.bb_pos+a):0}producerName(a){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.__string(this.bb_pos+c,a):null}producerVersion(a){let c=this.bb.__offset(this.bb_pos,10);return c?this.bb.__string(this.bb_pos+c,a):null}domain(a){let c=this.bb.__offset(this.bb_pos,12);return c?this.bb.__string(this.bb_pos+c,a):null}modelVersion(){let a=this.bb.__offset(this.bb_pos,14);return a?this.bb.readInt64(this.bb_pos+a):this.bb.createLong(0,0)}docString(a){let c=this.bb.__offset(this.bb_pos,16);return c?this.bb.__string(this.bb_pos+c,a):null}graph(a){let c=this.bb.__offset(this.bb_pos,18);return c?(a||new t.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}graphDocString(a){let c=this.bb.__offset(this.bb_pos,20);return c?this.bb.__string(this.bb_pos+c,a):null}static startModel(a){a.startObject(9)}static addIrVersion(a,c){a.addFieldInt64(0,c,a.createLong(0,0))}static addOpsetImport(a,c){a.addFieldOffset(1,c,0)}static createOpsetImportVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startOpsetImportVector(a,c){a.startVector(4,c,4)}static addProducerName(a,c){a.addFieldOffset(2,c,0)}static addProducerVersion(a,c){a.addFieldOffset(3,c,0)}static addDomain(a,c){a.addFieldOffset(4,c,0)}static addModelVersion(a,c){a.addFieldInt64(5,c,a.createLong(0,0))}static addDocString(a,c){a.addFieldOffset(6,c,0)}static addGraph(a,c){a.addFieldOffset(7,c,0)}static addGraphDocString(a,c){a.addFieldOffset(8,c,0)}static endModel(a){return a.endObject()}static createModel(a,c,s,u,d,h,f,p,g,y){return o.startModel(a),o.addIrVersion(a,c),o.addOpsetImport(a,s),o.addProducerName(a,u),o.addProducerVersion(a,d),o.addDomain(a,h),o.addModelVersion(a,f),o.addDocString(a,p),o.addGraph(a,g),o.addGraphDocString(a,y),o.endModel(a)}}i.Model=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsKernelCreateInfos(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsKernelCreateInfos(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}nodeIndices(a){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.readUint32(this.bb.__vector(this.bb_pos+c)+a*4):0}nodeIndicesLength(){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.__vector_len(this.bb_pos+a):0}nodeIndicesArray(){let a=this.bb.__offset(this.bb_pos,4);return a?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+a),this.bb.__vector_len(this.bb_pos+a)):null}kernelDefHashes(a){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.readUint64(this.bb.__vector(this.bb_pos+c)+a*8):this.bb.createLong(0,0)}kernelDefHashesLength(){let a=this.bb.__offset(this.bb_pos,6);return a?this.bb.__vector_len(this.bb_pos+a):0}static startKernelCreateInfos(a){a.startObject(2)}static addNodeIndices(a,c){a.addFieldOffset(0,c,0)}static createNodeIndicesVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addInt32(c[s]);return a.endVector()}static startNodeIndicesVector(a,c){a.startVector(4,c,4)}static addKernelDefHashes(a,c){a.addFieldOffset(1,c,0)}static createKernelDefHashesVector(a,c){a.startVector(8,c.length,8);for(let s=c.length-1;s>=0;s--)a.addInt64(c[s]);return a.endVector()}static startKernelDefHashesVector(a,c){a.startVector(8,c,8)}static endKernelCreateInfos(a){return a.endObject()}static createKernelCreateInfos(a,c,s){return o.startKernelCreateInfos(a),o.addNodeIndices(a,c),o.addKernelDefHashes(a,s),o.endKernelCreateInfos(a)}}i.KernelCreateInfos=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsSubGraphSessionState(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsSubGraphSessionState(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}graphId(a){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,a):null}sessionState(a){let c=this.bb.__offset(this.bb_pos,6);return c?(a||new t.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startSubGraphSessionState(a){a.startObject(2)}static addGraphId(a,c){a.addFieldOffset(0,c,0)}static addSessionState(a,c){a.addFieldOffset(1,c,0)}static endSubGraphSessionState(a){let c=a.endObject();return a.requiredField(c,4),c}static createSubGraphSessionState(a,c,s){return o.startSubGraphSessionState(a),o.addGraphId(a,c),o.addSessionState(a,s),o.endSubGraphSessionState(a)}}i.SubGraphSessionState=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsSessionState(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsSessionState(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}kernels(a){let c=this.bb.__offset(this.bb_pos,4);return c?(a||new t.experimental.fbs.KernelCreateInfos).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}subGraphSessionStates(a,c){let s=this.bb.__offset(this.bb_pos,6);return s?(c||new t.experimental.fbs.SubGraphSessionState).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+a*4),this.bb):null}subGraphSessionStatesLength(){let a=this.bb.__offset(this.bb_pos,6);return a?this.bb.__vector_len(this.bb_pos+a):0}static startSessionState(a){a.startObject(2)}static addKernels(a,c){a.addFieldOffset(0,c,0)}static addSubGraphSessionStates(a,c){a.addFieldOffset(1,c,0)}static createSubGraphSessionStatesVector(a,c){a.startVector(4,c.length,4);for(let s=c.length-1;s>=0;s--)a.addOffset(c[s]);return a.endVector()}static startSubGraphSessionStatesVector(a,c){a.startVector(4,c,4)}static endSessionState(a){return a.endObject()}static createSessionState(a,c,s){return o.startSessionState(a),o.addKernels(a,c),o.addSubGraphSessionStates(a,s),o.endSessionState(a)}}i.SessionState=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={}),(t=>{let e;(n=>{let r;(i=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(a,c){return this.bb_pos=a,this.bb=c,this}static getRootAsInferenceSession(a,c){return(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsInferenceSession(a,c){return a.setPosition(a.position()+D.SIZE_PREFIX_LENGTH),(c||new o).__init(a.readInt32(a.position())+a.position(),a)}static bufferHasIdentifier(a){return a.__has_identifier("ORTM")}ortVersion(a){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,a):null}model(a){let c=this.bb.__offset(this.bb_pos,6);return c?(a||new t.experimental.fbs.Model).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}sessionState(a){let c=this.bb.__offset(this.bb_pos,8);return c?(a||new t.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}static startInferenceSession(a){a.startObject(3)}static addOrtVersion(a,c){a.addFieldOffset(0,c,0)}static addModel(a,c){a.addFieldOffset(1,c,0)}static addSessionState(a,c){a.addFieldOffset(2,c,0)}static endInferenceSession(a){return a.endObject()}static finishInferenceSessionBuffer(a,c){a.finish(c,"ORTM")}static finishSizePrefixedInferenceSessionBuffer(a,c){a.finish(c,"ORTM",!0)}static createInferenceSession(a,c,s,u){return o.startInferenceSession(a),o.addOrtVersion(a,c),o.addModel(a,s),o.addSessionState(a,u),o.endInferenceSession(a)}}i.InferenceSession=o})(r=n.fbs||={})})(e=t.experimental||={})})(Ne||={})}),xz=pt((t,e)=>{"use strict";e.exports=n;function n(r,i){for(var o=new Array(arguments.length-1),l=0,a=2,c=!0;a<arguments.length;)o[l++]=arguments[a++];return new Promise(function(s,u){o[l]=function(d){if(c)if(c=!1,d)u(d);else{for(var h=new Array(arguments.length-1),f=0;f<h.length;)h[f++]=arguments[f];s.apply(null,h)}};try{r.apply(i||null,o)}catch(d){c&&(c=!1,u(d))}})}}),Ez=pt(t=>{"use strict";var e=t;e.length=function(l){var a=l.length;if(!a)return 0;for(var c=0;--a%4>1&&l.charAt(a)==="=";)++c;return Math.ceil(l.length*3)/4-c};var n=new Array(64),r=new Array(123);for(i=0;i<64;)r[n[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;var i;e.encode=function(l,a,c){for(var s=null,u=[],d=0,h=0,f;a<c;){var p=l[a++];switch(h){case 0:u[d++]=n[p>>2],f=(p&3)<<4,h=1;break;case 1:u[d++]=n[f|p>>4],f=(p&15)<<2,h=2;break;case 2:u[d++]=n[f|p>>6],u[d++]=n[p&63],h=0;break}d>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,u)),d=0)}return h&&(u[d++]=n[f],u[d++]=61,h===1&&(u[d++]=61)),s?(d&&s.push(String.fromCharCode.apply(String,u.slice(0,d))),s.join("")):String.fromCharCode.apply(String,u.slice(0,d))};var o="invalid encoding";e.decode=function(l,a,c){for(var s=c,u=0,d,h=0;h<l.length;){var f=l.charCodeAt(h++);if(f===61&&u>1)break;if((f=r[f])===void 0)throw Error(o);switch(u){case 0:d=f,u=1;break;case 1:a[c++]=d<<2|(f&48)>>4,d=f,u=2;break;case 2:a[c++]=(d&15)<<4|(f&60)>>2,d=f,u=3;break;case 3:a[c++]=(d&3)<<6|f,u=0;break}}if(u===1)throw Error(o);return c-s},e.test=function(l){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(l)}}),Cz=pt((t,e)=>{"use strict";e.exports=n;function n(){this._listeners={}}n.prototype.on=function(r,i,o){return(this._listeners[r]||(this._listeners[r]=[])).push({fn:i,ctx:o||this}),this},n.prototype.off=function(r,i){if(r===void 0)this._listeners={};else if(i===void 0)this._listeners[r]=[];else for(var o=this._listeners[r],l=0;l<o.length;)o[l].fn===i?o.splice(l,1):++l;return this},n.prototype.emit=function(r){var i=this._listeners[r];if(i){for(var o=[],l=1;l<arguments.length;)o.push(arguments[l++]);for(l=0;l<i.length;)i[l].fn.apply(i[l++].ctx,o)}return this}}),Sz=pt((t,e)=>{"use strict";e.exports=n(n);function n(a){return typeof Float32Array<"u"?function(){var c=new Float32Array([-0]),s=new Uint8Array(c.buffer),u=s[3]===128;function d(g,y,b){c[0]=g,y[b]=s[0],y[b+1]=s[1],y[b+2]=s[2],y[b+3]=s[3]}function h(g,y,b){c[0]=g,y[b]=s[3],y[b+1]=s[2],y[b+2]=s[1],y[b+3]=s[0]}a.writeFloatLE=u?d:h,a.writeFloatBE=u?h:d;function f(g,y){return s[0]=g[y],s[1]=g[y+1],s[2]=g[y+2],s[3]=g[y+3],c[0]}function p(g,y){return s[3]=g[y],s[2]=g[y+1],s[1]=g[y+2],s[0]=g[y+3],c[0]}a.readFloatLE=u?f:p,a.readFloatBE=u?p:f}():function(){function c(u,d,h,f){var p=d<0?1:0;if(p&&(d=-d),d===0)u(1/d>0?0:2147483648,h,f);else if(isNaN(d))u(2143289344,h,f);else if(d>34028234663852886e22)u((p<<31|2139095040)>>>0,h,f);else if(d<11754943508222875e-54)u((p<<31|Math.round(d/1401298464324817e-60))>>>0,h,f);else{var g=Math.floor(Math.log(d)/Math.LN2),y=Math.round(d*Math.pow(2,-g)*8388608)&8388607;u((p<<31|g+127<<23|y)>>>0,h,f)}}a.writeFloatLE=c.bind(null,r),a.writeFloatBE=c.bind(null,i);function s(u,d,h){var f=u(d,h),p=(f>>31)*2+1,g=f>>>23&255,y=f&8388607;return g===255?y?NaN:p*(1/0):g===0?p*1401298464324817e-60*y:p*Math.pow(2,g-150)*(y+8388608)}a.readFloatLE=s.bind(null,o),a.readFloatBE=s.bind(null,l)}(),typeof Float64Array<"u"?function(){var c=new Float64Array([-0]),s=new Uint8Array(c.buffer),u=s[7]===128;function d(g,y,b){c[0]=g,y[b]=s[0],y[b+1]=s[1],y[b+2]=s[2],y[b+3]=s[3],y[b+4]=s[4],y[b+5]=s[5],y[b+6]=s[6],y[b+7]=s[7]}function h(g,y,b){c[0]=g,y[b]=s[7],y[b+1]=s[6],y[b+2]=s[5],y[b+3]=s[4],y[b+4]=s[3],y[b+5]=s[2],y[b+6]=s[1],y[b+7]=s[0]}a.writeDoubleLE=u?d:h,a.writeDoubleBE=u?h:d;function f(g,y){return s[0]=g[y],s[1]=g[y+1],s[2]=g[y+2],s[3]=g[y+3],s[4]=g[y+4],s[5]=g[y+5],s[6]=g[y+6],s[7]=g[y+7],c[0]}function p(g,y){return s[7]=g[y],s[6]=g[y+1],s[5]=g[y+2],s[4]=g[y+3],s[3]=g[y+4],s[2]=g[y+5],s[1]=g[y+6],s[0]=g[y+7],c[0]}a.readDoubleLE=u?f:p,a.readDoubleBE=u?p:f}():function(){function c(u,d,h,f,p,g){var y=f<0?1:0;if(y&&(f=-f),f===0)u(0,p,g+d),u(1/f>0?0:2147483648,p,g+h);else if(isNaN(f))u(0,p,g+d),u(2146959360,p,g+h);else if(f>17976931348623157e292)u(0,p,g+d),u((y<<31|2146435072)>>>0,p,g+h);else{var b;if(f<22250738585072014e-324)b=f/5e-324,u(b>>>0,p,g+d),u((y<<31|b/4294967296)>>>0,p,g+h);else{var v=Math.floor(Math.log(f)/Math.LN2);v===1024&&(v=1023),b=f*Math.pow(2,-v),u(b*4503599627370496>>>0,p,g+d),u((y<<31|v+1023<<20|b*1048576&1048575)>>>0,p,g+h)}}}a.writeDoubleLE=c.bind(null,r,0,4),a.writeDoubleBE=c.bind(null,i,4,0);function s(u,d,h,f,p){var g=u(f,p+d),y=u(f,p+h),b=(y>>31)*2+1,v=y>>>20&2047,_=4294967296*(y&1048575)+g;return v===2047?_?NaN:b*(1/0):v===0?b*5e-324*_:b*Math.pow(2,v-1075)*(_+4503599627370496)}a.readDoubleLE=s.bind(null,o,0,4),a.readDoubleBE=s.bind(null,l,4,0)}(),a}function r(a,c,s){c[s]=a&255,c[s+1]=a>>>8&255,c[s+2]=a>>>16&255,c[s+3]=a>>>24}function i(a,c,s){c[s]=a>>>24,c[s+1]=a>>>16&255,c[s+2]=a>>>8&255,c[s+3]=a&255}function o(a,c){return(a[c]|a[c+1]<<8|a[c+2]<<16|a[c+3]<<24)>>>0}function l(a,c){return(a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3])>>>0}}),Dz=pt((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}}),Iz=pt(t=>{"use strict";var e=t;e.length=function(n){for(var r=0,i=0,o=0;o<n.length;++o)i=n.charCodeAt(o),i<128?r+=1:i<2048?r+=2:(i&64512)===55296&&(n.charCodeAt(o+1)&64512)===56320?(++o,r+=4):r+=3;return r},e.read=function(n,r,i){var o=i-r;if(o<1)return"";for(var l=null,a=[],c=0,s;r<i;)s=n[r++],s<128?a[c++]=s:s>191&&s<224?a[c++]=(s&31)<<6|n[r++]&63:s>239&&s<365?(s=((s&7)<<18|(n[r++]&63)<<12|(n[r++]&63)<<6|n[r++]&63)-65536,a[c++]=55296+(s>>10),a[c++]=56320+(s&1023)):a[c++]=(s&15)<<12|(n[r++]&63)<<6|n[r++]&63,c>8191&&((l||(l=[])).push(String.fromCharCode.apply(String,a)),c=0);return l?(c&&l.push(String.fromCharCode.apply(String,a.slice(0,c))),l.join("")):String.fromCharCode.apply(String,a.slice(0,c))},e.write=function(n,r,i){for(var o=i,l,a,c=0;c<n.length;++c)l=n.charCodeAt(c),l<128?r[i++]=l:l<2048?(r[i++]=l>>6|192,r[i++]=l&63|128):(l&64512)===55296&&((a=n.charCodeAt(c+1))&64512)===56320?(l=65536+((l&1023)<<10)+(a&1023),++c,r[i++]=l>>18|240,r[i++]=l>>12&63|128,r[i++]=l>>6&63|128,r[i++]=l&63|128):(r[i++]=l>>12|224,r[i++]=l>>6&63|128,r[i++]=l&63|128);return i-o}}),Oz=pt((t,e)=>{"use strict";e.exports=n;function n(r,i,o){var l=o||8192,a=l>>>1,c=null,s=l;return function(u){if(u<1||u>a)return r(u);s+u>l&&(c=r(l),s=0);var d=i.call(c,s,s+=u);return s&7&&(s=(s|7)+1),d}}}),Az=pt((t,e)=>{"use strict";e.exports=r;var n=hs();function r(a,c){this.lo=a>>>0,this.hi=c>>>0}var i=r.zero=new r(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var o=r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function(a){if(a===0)return i;var c=a<0;c&&(a=-a);var s=a>>>0,u=(a-s)/4294967296>>>0;return c&&(u=~u>>>0,s=~s>>>0,++s>4294967295&&(s=0,++u>4294967295&&(u=0))),new r(s,u)},r.from=function(a){if(typeof a=="number")return r.fromNumber(a);if(n.isString(a))if(n.Long)a=n.Long.fromString(a);else return r.fromNumber(parseInt(a,10));return a.low||a.high?new r(a.low>>>0,a.high>>>0):i},r.prototype.toNumber=function(a){if(!a&&this.hi>>>31){var c=~this.lo+1>>>0,s=~this.hi>>>0;return c||(s=s+1>>>0),-(c+s*4294967296)}return this.lo+this.hi*4294967296},r.prototype.toLong=function(a){return n.Long?new n.Long(this.lo|0,this.hi|0,!!a):{low:this.lo|0,high:this.hi|0,unsigned:!!a}};var l=String.prototype.charCodeAt;r.fromHash=function(a){return a===o?i:new r((l.call(a,0)|l.call(a,1)<<8|l.call(a,2)<<16|l.call(a,3)<<24)>>>0,(l.call(a,4)|l.call(a,5)<<8|l.call(a,6)<<16|l.call(a,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var a=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^a)>>>0,this.lo=(this.lo<<1^a)>>>0,this},r.prototype.zzDecode=function(){var a=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^a)>>>0,this.hi=(this.hi>>>1^a)>>>0,this},r.prototype.length=function(){var a=this.lo,c=(this.lo>>>28|this.hi<<4)>>>0,s=this.hi>>>24;return s===0?c===0?a<16384?a<128?1:2:a<2097152?3:4:c<16384?c<128?5:6:c<2097152?7:8:s<128?9:10}}),hs=pt(t=>{"use strict";var e=t;e.asPromise=xz(),e.base64=Ez(),e.EventEmitter=Cz(),e.float=Sz(),e.inquire=Dz(),e.utf8=Iz(),e.pool=Oz(),e.LongBits=Az(),e.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node),e.global=e.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||t,e.emptyArray=Object.freeze?Object.freeze([]):[],e.emptyObject=Object.freeze?Object.freeze({}):{},e.isInteger=Number.isInteger||function(i){return typeof i=="number"&&isFinite(i)&&Math.floor(i)===i},e.isString=function(i){return typeof i=="string"||i instanceof String},e.isObject=function(i){return i&&typeof i=="object"},e.isset=e.isSet=function(i,o){var l=i[o];return l!=null&&i.hasOwnProperty(o)?typeof l!="object"||(Array.isArray(l)?l.length:Object.keys(l).length)>0:!1},e.Buffer=function(){try{var i=e.inquire("buffer").Buffer;return i.prototype.utf8Write?i:null}catch{return null}}(),e._Buffer_from=null,e._Buffer_allocUnsafe=null,e.newBuffer=function(i){return typeof i=="number"?e.Buffer?e._Buffer_allocUnsafe(i):new e.Array(i):e.Buffer?e._Buffer_from(i):typeof Uint8Array>"u"?i:new Uint8Array(i)},e.Array=typeof Uint8Array<"u"?Uint8Array:Array,e.Long=e.global.dcodeIO&&e.global.dcodeIO.Long||e.global.Long||e.inquire("long"),e.key2Re=/^true|false|0|1$/,e.key32Re=/^-?(?:0|[1-9][0-9]*)$/,e.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,e.longToHash=function(i){return i?e.LongBits.from(i).toHash():e.LongBits.zeroHash},e.longFromHash=function(i,o){var l=e.LongBits.fromHash(i);return e.Long?e.Long.fromBits(l.lo,l.hi,o):l.toNumber(!!o)};function n(i,o,l){for(var a=Object.keys(o),c=0;c<a.length;++c)(i[a[c]]===void 0||!l)&&(i[a[c]]=o[a[c]]);return i}e.merge=n,e.lcFirst=function(i){return i.charAt(0).toLowerCase()+i.substring(1)};function r(i){function o(l,a){if(!(this instanceof o))return new o(l,a);Object.defineProperty(this,"message",{get:function(){return l}}),Error.captureStackTrace?Error.captureStackTrace(this,o):Object.defineProperty(this,"stack",{value:new Error().stack||""}),a&&n(this,a)}return o.prototype=Object.create(Error.prototype,{constructor:{value:o,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return i},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),o}e.newError=r,e.ProtocolError=r("ProtocolError"),e.oneOfGetter=function(i){for(var o={},l=0;l<i.length;++l)o[i[l]]=1;return function(){for(var a=Object.keys(this),c=a.length-1;c>-1;--c)if(o[a[c]]===1&&this[a[c]]!==void 0&&this[a[c]]!==null)return a[c]}},e.oneOfSetter=function(i){return function(o){for(var l=0;l<i.length;++l)i[l]!==o&&delete this[i[l]]}},e.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},e._configure=function(){var i=e.Buffer;if(!i){e._Buffer_from=e._Buffer_allocUnsafe=null;return}e._Buffer_from=i.from!==Uint8Array.from&&i.from||function(o,l){return new i(o,l)},e._Buffer_allocUnsafe=i.allocUnsafe||function(o){return new i(o)}}}),NM=pt((t,e)=>{"use strict";e.exports=u;var n=hs(),r,i=n.LongBits,o=n.base64,l=n.utf8;function a(v,_,I){this.fn=v,this.len=_,this.next=void 0,this.val=I}function c(){}function s(v){this.head=v.head,this.tail=v.tail,this.len=v.len,this.next=v.states}function u(){this.len=0,this.head=new a(c,0,0),this.tail=this.head,this.states=null}var d=function(){return n.Buffer?function(){return(u.create=function(){return new r})()}:function(){return new u}};u.create=d(),u.alloc=function(v){return new n.Array(v)},n.Array!==Array&&(u.alloc=n.pool(u.alloc,n.Array.prototype.subarray)),u.prototype._push=function(v,_,I){return this.tail=this.tail.next=new a(v,_,I),this.len+=_,this};function h(v,_,I){_[I]=v&255}function f(v,_,I){for(;v>127;)_[I++]=v&127|128,v>>>=7;_[I]=v}function p(v,_){this.len=v,this.next=void 0,this.val=_}p.prototype=Object.create(a.prototype),p.prototype.fn=f,u.prototype.uint32=function(v){return this.len+=(this.tail=this.tail.next=new p((v=v>>>0)<128?1:v<16384?2:v<2097152?3:v<268435456?4:5,v)).len,this},u.prototype.int32=function(v){return v<0?this._push(g,10,i.fromNumber(v)):this.uint32(v)},u.prototype.sint32=function(v){return this.uint32((v<<1^v>>31)>>>0)};function g(v,_,I){for(;v.hi;)_[I++]=v.lo&127|128,v.lo=(v.lo>>>7|v.hi<<25)>>>0,v.hi>>>=7;for(;v.lo>127;)_[I++]=v.lo&127|128,v.lo=v.lo>>>7;_[I++]=v.lo}u.prototype.uint64=function(v){var _=i.from(v);return this._push(g,_.length(),_)},u.prototype.int64=u.prototype.uint64,u.prototype.sint64=function(v){var _=i.from(v).zzEncode();return this._push(g,_.length(),_)},u.prototype.bool=function(v){return this._push(h,1,v?1:0)};function y(v,_,I){_[I]=v&255,_[I+1]=v>>>8&255,_[I+2]=v>>>16&255,_[I+3]=v>>>24}u.prototype.fixed32=function(v){return this._push(y,4,v>>>0)},u.prototype.sfixed32=u.prototype.fixed32,u.prototype.fixed64=function(v){var _=i.from(v);return this._push(y,4,_.lo)._push(y,4,_.hi)},u.prototype.sfixed64=u.prototype.fixed64,u.prototype.float=function(v){return this._push(n.float.writeFloatLE,4,v)},u.prototype.double=function(v){return this._push(n.float.writeDoubleLE,8,v)};var b=n.Array.prototype.set?function(v,_,I){_.set(v,I)}:function(v,_,I){for(var k=0;k<v.length;++k)_[I+k]=v[k]};u.prototype.bytes=function(v){var _=v.length>>>0;if(!_)return this._push(h,1,0);if(n.isString(v)){var I=u.alloc(_=o.length(v));o.decode(v,I,0),v=I}return this.uint32(_)._push(b,_,v)},u.prototype.string=function(v){var _=l.length(v);return _?this.uint32(_)._push(l.write,_,v):this._push(h,1,0)},u.prototype.fork=function(){return this.states=new s(this),this.head=this.tail=new a(c,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new a(c,0,0),this.len=0),this},u.prototype.ldelim=function(){var v=this.head,_=this.tail,I=this.len;return this.reset().uint32(I),I&&(this.tail.next=v.next,this.tail=_,this.len+=I),this},u.prototype.finish=function(){for(var v=this.head.next,_=this.constructor.alloc(this.len),I=0;v;)v.fn(v.val,_,I),I+=v.len,v=v.next;return _},u._configure=function(v){r=v,u.create=d(),r._configure()}}),Mz=pt((t,e)=>{"use strict";e.exports=i;var n=NM();(i.prototype=Object.create(n.prototype)).constructor=i;var r=hs();function i(){n.call(this)}i._configure=function(){i.alloc=r._Buffer_allocUnsafe,i.writeBytesBuffer=r.Buffer&&r.Buffer.prototype instanceof Uint8Array&&r.Buffer.prototype.set.name==="set"?function(l,a,c){a.set(l,c)}:function(l,a,c){if(l.copy)l.copy(a,c,0,l.length);else for(var s=0;s<l.length;)a[c++]=l[s++]}},i.prototype.bytes=function(l){r.isString(l)&&(l=r._Buffer_from(l,"base64"));var a=l.length>>>0;return this.uint32(a),a&&this._push(i.writeBytesBuffer,a,l),this};function o(l,a,c){l.length<40?r.utf8.write(l,a,c):a.utf8Write?a.utf8Write(l,c):a.write(l,c)}i.prototype.string=function(l){var a=r.Buffer.byteLength(l);return this.uint32(a),a&&this._push(o,a,l),this},i._configure()}),RM=pt((t,e)=>{"use strict";e.exports=a;var n=hs(),r,i=n.LongBits,o=n.utf8;function l(f,p){return RangeError("index out of range: "+f.pos+" + "+(p||1)+" > "+f.len)}function a(f){this.buf=f,this.pos=0,this.len=f.length}var c=typeof Uint8Array<"u"?function(f){if(f instanceof Uint8Array||Array.isArray(f))return new a(f);throw Error("illegal buffer")}:function(f){if(Array.isArray(f))return new a(f);throw Error("illegal buffer")},s=function(){return n.Buffer?function(f){return(a.create=function(p){return n.Buffer.isBuffer(p)?new r(p):c(p)})(f)}:c};a.create=s(),a.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice,a.prototype.uint32=function(){var f=4294967295;return function(){if(f=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(f=(f|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(f=(f|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(f=(f|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(f=(f|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return f;if((this.pos+=5)>this.len)throw this.pos=this.len,l(this,10);return f}}(),a.prototype.int32=function(){return this.uint32()|0},a.prototype.sint32=function(){var f=this.uint32();return f>>>1^-(f&1)|0};function u(){var f=new i(0,0),p=0;if(this.len-this.pos>4){for(;p<4;++p)if(f.lo=(f.lo|(this.buf[this.pos]&127)<<p*7)>>>0,this.buf[this.pos++]<128)return f;if(f.lo=(f.lo|(this.buf[this.pos]&127)<<28)>>>0,f.hi=(f.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return f;p=0}else{for(;p<3;++p){if(this.pos>=this.len)throw l(this);if(f.lo=(f.lo|(this.buf[this.pos]&127)<<p*7)>>>0,this.buf[this.pos++]<128)return f}return f.lo=(f.lo|(this.buf[this.pos++]&127)<<p*7)>>>0,f}if(this.len-this.pos>4){for(;p<5;++p)if(f.hi=(f.hi|(this.buf[this.pos]&127)<<p*7+3)>>>0,this.buf[this.pos++]<128)return f}else for(;p<5;++p){if(this.pos>=this.len)throw l(this);if(f.hi=(f.hi|(this.buf[this.pos]&127)<<p*7+3)>>>0,this.buf[this.pos++]<128)return f}throw Error("invalid varint encoding")}a.prototype.bool=function(){return this.uint32()!==0};function d(f,p){return(f[p-4]|f[p-3]<<8|f[p-2]<<16|f[p-1]<<24)>>>0}a.prototype.fixed32=function(){if(this.pos+4>this.len)throw l(this,4);return d(this.buf,this.pos+=4)},a.prototype.sfixed32=function(){if(this.pos+4>this.len)throw l(this,4);return d(this.buf,this.pos+=4)|0};function h(){if(this.pos+8>this.len)throw l(this,8);return new i(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}a.prototype.float=function(){if(this.pos+4>this.len)throw l(this,4);var f=n.float.readFloatLE(this.buf,this.pos);return this.pos+=4,f},a.prototype.double=function(){if(this.pos+8>this.len)throw l(this,4);var f=n.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,f},a.prototype.bytes=function(){var f=this.uint32(),p=this.pos,g=this.pos+f;if(g>this.len)throw l(this,f);if(this.pos+=f,Array.isArray(this.buf))return this.buf.slice(p,g);if(p===g){var y=n.Buffer;return y?y.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,p,g)},a.prototype.string=function(){var f=this.bytes();return o.read(f,0,f.length)},a.prototype.skip=function(f){if(typeof f=="number"){if(this.pos+f>this.len)throw l(this,f);this.pos+=f}else do if(this.pos>=this.len)throw l(this);while(this.buf[this.pos++]&128);return this},a.prototype.skipType=function(f){switch(f){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(f=this.uint32()&7)!==4;)this.skipType(f);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+f+" at offset "+this.pos)}return this},a._configure=function(f){r=f,a.create=s(),r._configure();var p=n.Long?"toLong":"toNumber";n.merge(a.prototype,{int64:function(){return u.call(this)[p](!1)},uint64:function(){return u.call(this)[p](!0)},sint64:function(){return u.call(this).zzDecode()[p](!1)},fixed64:function(){return h.call(this)[p](!0)},sfixed64:function(){return h.call(this)[p](!1)}})}}),Pz=pt((t,e)=>{"use strict";e.exports=i;var n=RM();(i.prototype=Object.create(n.prototype)).constructor=i;var r=hs();function i(o){n.call(this,o)}i._configure=function(){r.Buffer&&(i.prototype._slice=r.Buffer.prototype.slice)},i.prototype.string=function(){var o=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+o,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+o,this.len))},i._configure()}),Nz=pt((t,e)=>{"use strict";e.exports=r;var n=hs();(r.prototype=Object.create(n.EventEmitter.prototype)).constructor=r;function r(i,o,l){if(typeof i!="function")throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=i,this.requestDelimited=!!o,this.responseDelimited=!!l}r.prototype.rpcCall=function i(o,l,a,c,s){if(!c)throw TypeError("request must be specified");var u=this;if(!s)return n.asPromise(i,u,o,l,a,c);if(!u.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return u.rpcImpl(o,l[u.requestDelimited?"encodeDelimited":"encode"](c).finish(),function(d,h){if(d)return u.emit("error",d,o),s(d);if(h===null){u.end(!0);return}if(!(h instanceof a))try{h=a[u.responseDelimited?"decodeDelimited":"decode"](h)}catch(f){return u.emit("error",f,o),s(f)}return u.emit("data",h,o),s(null,h)})}catch(d){u.emit("error",d,o),setTimeout(function(){s(d)},0);return}},r.prototype.end=function(i){return this.rpcImpl&&(i||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}}),Rz=pt(t=>{"use strict";var e=t;e.Service=Nz()}),kz=pt((t,e)=>{"use strict";e.exports={}}),Fz=pt(t=>{"use strict";var e=t;e.build="minimal",e.Writer=NM(),e.BufferWriter=Mz(),e.Reader=RM(),e.BufferReader=Pz(),e.util=hs(),e.rpc=Rz(),e.roots=kz(),e.configure=n;function n(){e.util._configure(),e.Writer._configure(e.BufferWriter),e.Reader._configure(e.BufferReader)}n()}),Lz=pt((t,e)=>{"use strict";e.exports=Fz()}),nu=pt((t,e)=>{"use strict";var n=Lz(),r=n.Reader,i=n.Writer,o=n.util,l=n.roots.default||(n.roots.default={});l.onnx=function(){var a={};return a.Version=function(){var c={},s=Object.create(c);return s[c[0]="_START_VERSION"]=0,s[c[1]="IR_VERSION_2017_10_10"]=1,s[c[2]="IR_VERSION_2017_10_30"]=2,s[c[3]="IR_VERSION_2017_11_3"]=3,s[c[4]="IR_VERSION_2019_1_22"]=4,s[c[5]="IR_VERSION_2019_3_18"]=5,s[c[6]="IR_VERSION_2019_9_19"]=6,s[c[7]="IR_VERSION_2020_5_8"]=7,s[c[8]="IR_VERSION_2021_7_30"]=8,s[c[9]="IR_VERSION"]=9,s}(),a.AttributeProto=function(){function c(s){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],this.sparseTensors=[],this.typeProtos=[],s)for(var u=Object.keys(s),d=0;d<u.length;++d)s[u[d]]!=null&&(this[u[d]]=s[u[d]])}return c.prototype.name="",c.prototype.refAttrName="",c.prototype.docString="",c.prototype.type=0,c.prototype.f=0,c.prototype.i=o.Long?o.Long.fromBits(0,0,!1):0,c.prototype.s=o.newBuffer([]),c.prototype.t=null,c.prototype.g=null,c.prototype.sparseTensor=null,c.prototype.tp=null,c.prototype.floats=o.emptyArray,c.prototype.ints=o.emptyArray,c.prototype.strings=o.emptyArray,c.prototype.tensors=o.emptyArray,c.prototype.graphs=o.emptyArray,c.prototype.sparseTensors=o.emptyArray,c.prototype.typeProtos=o.emptyArray,c.create=function(s){return new c(s)},c.encode=function(s,u){if(u||(u=i.create()),s.name!=null&&Object.hasOwnProperty.call(s,"name")&&u.uint32(10).string(s.name),s.f!=null&&Object.hasOwnProperty.call(s,"f")&&u.uint32(21).float(s.f),s.i!=null&&Object.hasOwnProperty.call(s,"i")&&u.uint32(24).int64(s.i),s.s!=null&&Object.hasOwnProperty.call(s,"s")&&u.uint32(34).bytes(s.s),s.t!=null&&Object.hasOwnProperty.call(s,"t")&&l.onnx.TensorProto.encode(s.t,u.uint32(42).fork()).ldelim(),s.g!=null&&Object.hasOwnProperty.call(s,"g")&&l.onnx.GraphProto.encode(s.g,u.uint32(50).fork()).ldelim(),s.floats!=null&&s.floats.length){u.uint32(58).fork();for(var d=0;d<s.floats.length;++d)u.float(s.floats[d]);u.ldelim()}if(s.ints!=null&&s.ints.length){u.uint32(66).fork();for(var d=0;d<s.ints.length;++d)u.int64(s.ints[d]);u.ldelim()}if(s.strings!=null&&s.strings.length)for(var d=0;d<s.strings.length;++d)u.uint32(74).bytes(s.strings[d]);if(s.tensors!=null&&s.tensors.length)for(var d=0;d<s.tensors.length;++d)l.onnx.TensorProto.encode(s.tensors[d],u.uint32(82).fork()).ldelim();if(s.graphs!=null&&s.graphs.length)for(var d=0;d<s.graphs.length;++d)l.onnx.GraphProto.encode(s.graphs[d],u.uint32(90).fork()).ldelim();if(s.docString!=null&&Object.hasOwnProperty.call(s,"docString")&&u.uint32(106).string(s.docString),s.tp!=null&&Object.hasOwnProperty.call(s,"tp")&&l.onnx.TypeProto.encode(s.tp,u.uint32(114).fork()).ldelim(),s.typeProtos!=null&&s.typeProtos.length)for(var d=0;d<s.typeProtos.length;++d)l.onnx.TypeProto.encode(s.typeProtos[d],u.uint32(122).fork()).ldelim();if(s.type!=null&&Object.hasOwnProperty.call(s,"type")&&u.uint32(160).int32(s.type),s.refAttrName!=null&&Object.hasOwnProperty.call(s,"refAttrName")&&u.uint32(170).string(s.refAttrName),s.sparseTensor!=null&&Object.hasOwnProperty.call(s,"sparseTensor")&&l.onnx.SparseTensorProto.encode(s.sparseTensor,u.uint32(178).fork()).ldelim(),s.sparseTensors!=null&&s.sparseTensors.length)for(var d=0;d<s.sparseTensors.length;++d)l.onnx.SparseTensorProto.encode(s.sparseTensors[d],u.uint32(186).fork()).ldelim();return u},c.encodeDelimited=function(s,u){return this.encode(s,u).ldelim()},c.decode=function(s,u){s instanceof r||(s=r.create(s));for(var d=u===void 0?s.len:s.pos+u,h=new l.onnx.AttributeProto;s.pos<d;){var f=s.uint32();switch(f>>>3){case 1:{h.name=s.string();break}case 21:{h.refAttrName=s.string();break}case 13:{h.docString=s.string();break}case 20:{h.type=s.int32();break}case 2:{h.f=s.float();break}case 3:{h.i=s.int64();break}case 4:{h.s=s.bytes();break}case 5:{h.t=l.onnx.TensorProto.decode(s,s.uint32());break}case 6:{h.g=l.onnx.GraphProto.decode(s,s.uint32());break}case 22:{h.sparseTensor=l.onnx.SparseTensorProto.decode(s,s.uint32());break}case 14:{h.tp=l.onnx.TypeProto.decode(s,s.uint32());break}case 7:{if(h.floats&&h.floats.length||(h.floats=[]),(f&7)===2)for(var p=s.uint32()+s.pos;s.pos<p;)h.floats.push(s.float());else h.floats.push(s.float());break}case 8:{if(h.ints&&h.ints.length||(h.ints=[]),(f&7)===2)for(var p=s.uint32()+s.pos;s.pos<p;)h.ints.push(s.int64());else h.ints.push(s.int64());break}case 9:{h.strings&&h.strings.length||(h.strings=[]),h.strings.push(s.bytes());break}case 10:{h.tensors&&h.tensors.length||(h.tensors=[]),h.tensors.push(l.onnx.TensorProto.decode(s,s.uint32()));break}case 11:{h.graphs&&h.graphs.length||(h.graphs=[]),h.graphs.push(l.onnx.GraphProto.decode(s,s.uint32()));break}case 23:{h.sparseTensors&&h.sparseTensors.length||(h.sparseTensors=[]),h.sparseTensors.push(l.onnx.SparseTensorProto.decode(s,s.uint32()));break}case 15:{h.typeProtos&&h.typeProtos.length||(h.typeProtos=[]),h.typeProtos.push(l.onnx.TypeProto.decode(s,s.uint32()));break}default:s.skipType(f&7);break}}return h},c.decodeDelimited=function(s){return s instanceof r||(s=new r(s)),this.decode(s,s.uint32())},c.verify=function(s){if(typeof s!="object"||s===null)return"object expected";if(s.name!=null&&s.hasOwnProperty("name")&&!o.isString(s.name))return"name: string expected";if(s.refAttrName!=null&&s.hasOwnProperty("refAttrName")&&!o.isString(s.refAttrName))return"refAttrName: string expected";if(s.docString!=null&&s.hasOwnProperty("docString")&&!o.isString(s.docString))return"docString: string expected";if(s.type!=null&&s.hasOwnProperty("type"))switch(s.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 11:case 13:case 6:case 7:case 8:case 9:case 10:case 12:case 14:break}if(s.f!=null&&s.hasOwnProperty("f")&&typeof s.f!="number")return"f: number expected";if(s.i!=null&&s.hasOwnProperty("i")&&!o.isInteger(s.i)&&!(s.i&&o.isInteger(s.i.low)&&o.isInteger(s.i.high)))return"i: integer|Long expected";if(s.s!=null&&s.hasOwnProperty("s")&&!(s.s&&typeof s.s.length=="number"||o.isString(s.s)))return"s: buffer expected";if(s.t!=null&&s.hasOwnProperty("t")){var u=l.onnx.TensorProto.verify(s.t);if(u)return"t."+u}if(s.g!=null&&s.hasOwnProperty("g")){var u=l.onnx.GraphProto.verify(s.g);if(u)return"g."+u}if(s.sparseTensor!=null&&s.hasOwnProperty("sparseTensor")){var u=l.onnx.SparseTensorProto.verify(s.sparseTensor);if(u)return"sparseTensor."+u}if(s.tp!=null&&s.hasOwnProperty("tp")){var u=l.onnx.TypeProto.verify(s.tp);if(u)return"tp."+u}if(s.floats!=null&&s.hasOwnProperty("floats")){if(!Array.isArray(s.floats))return"floats: array expected";for(var d=0;d<s.floats.length;++d)if(typeof s.floats[d]!="number")return"floats: number[] expected"}if(s.ints!=null&&s.hasOwnProperty("ints")){if(!Array.isArray(s.ints))return"ints: array expected";for(var d=0;d<s.ints.length;++d)if(!o.isInteger(s.ints[d])&&!(s.ints[d]&&o.isInteger(s.ints[d].low)&&o.isInteger(s.ints[d].high)))return"ints: integer|Long[] expected"}if(s.strings!=null&&s.hasOwnProperty("strings")){if(!Array.isArray(s.strings))return"strings: array expected";for(var d=0;d<s.strings.length;++d)if(!(s.strings[d]&&typeof s.strings[d].length=="number"||o.isString(s.strings[d])))return"strings: buffer[] expected"}if(s.tensors!=null&&s.hasOwnProperty("tensors")){if(!Array.isArray(s.tensors))return"tensors: array expected";for(var d=0;d<s.tensors.length;++d){var u=l.onnx.TensorProto.verify(s.tensors[d]);if(u)return"tensors."+u}}if(s.graphs!=null&&s.hasOwnProperty("graphs")){if(!Array.isArray(s.graphs))return"graphs: array expected";for(var d=0;d<s.graphs.length;++d){var u=l.onnx.GraphProto.verify(s.graphs[d]);if(u)return"graphs."+u}}if(s.sparseTensors!=null&&s.hasOwnProperty("sparseTensors")){if(!Array.isArray(s.sparseTensors))return"sparseTensors: array expected";for(var d=0;d<s.sparseTensors.length;++d){var u=l.onnx.SparseTensorProto.verify(s.sparseTensors[d]);if(u)return"sparseTensors."+u}}if(s.typeProtos!=null&&s.hasOwnProperty("typeProtos")){if(!Array.isArray(s.typeProtos))return"typeProtos: array expected";for(var d=0;d<s.typeProtos.length;++d){var u=l.onnx.TypeProto.verify(s.typeProtos[d]);if(u)return"typeProtos."+u}}return null},c.fromObject=function(s){if(s instanceof l.onnx.AttributeProto)return s;var u=new l.onnx.AttributeProto;switch(s.name!=null&&(u.name=String(s.name)),s.refAttrName!=null&&(u.refAttrName=String(s.refAttrName)),s.docString!=null&&(u.docString=String(s.docString)),s.type){default:if(typeof s.type=="number"){u.type=s.type;break}break;case"UNDEFINED":case 0:u.type=0;break;case"FLOAT":case 1:u.type=1;break;case"INT":case 2:u.type=2;break;case"STRING":case 3:u.type=3;break;case"TENSOR":case 4:u.type=4;break;case"GRAPH":case 5:u.type=5;break;case"SPARSE_TENSOR":case 11:u.type=11;break;case"TYPE_PROTO":case 13:u.type=13;break;case"FLOATS":case 6:u.type=6;break;case"INTS":case 7:u.type=7;break;case"STRINGS":case 8:u.type=8;break;case"TENSORS":case 9:u.type=9;break;case"GRAPHS":case 10:u.type=10;break;case"SPARSE_TENSORS":case 12:u.type=12;break;case"TYPE_PROTOS":case 14:u.type=14;break}if(s.f!=null&&(u.f=Number(s.f)),s.i!=null&&(o.Long?(u.i=o.Long.fromValue(s.i)).unsigned=!1:typeof s.i=="string"?u.i=parseInt(s.i,10):typeof s.i=="number"?u.i=s.i:typeof s.i=="object"&&(u.i=new o.LongBits(s.i.low>>>0,s.i.high>>>0).toNumber())),s.s!=null&&(typeof s.s=="string"?o.base64.decode(s.s,u.s=o.newBuffer(o.base64.length(s.s)),0):s.s.length>=0&&(u.s=s.s)),s.t!=null){if(typeof s.t!="object")throw TypeError(".onnx.AttributeProto.t: object expected");u.t=l.onnx.TensorProto.fromObject(s.t)}if(s.g!=null){if(typeof s.g!="object")throw TypeError(".onnx.AttributeProto.g: object expected");u.g=l.onnx.GraphProto.fromObject(s.g)}if(s.sparseTensor!=null){if(typeof s.sparseTensor!="object")throw TypeError(".onnx.AttributeProto.sparseTensor: object expected");u.sparseTensor=l.onnx.SparseTensorProto.fromObject(s.sparseTensor)}if(s.tp!=null){if(typeof s.tp!="object")throw TypeError(".onnx.AttributeProto.tp: object expected");u.tp=l.onnx.TypeProto.fromObject(s.tp)}if(s.floats){if(!Array.isArray(s.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");u.floats=[];for(var d=0;d<s.floats.length;++d)u.floats[d]=Number(s.floats[d])}if(s.ints){if(!Array.isArray(s.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");u.ints=[];for(var d=0;d<s.ints.length;++d)o.Long?(u.ints[d]=o.Long.fromValue(s.ints[d])).unsigned=!1:typeof s.ints[d]=="string"?u.ints[d]=parseInt(s.ints[d],10):typeof s.ints[d]=="number"?u.ints[d]=s.ints[d]:typeof s.ints[d]=="object"&&(u.ints[d]=new o.LongBits(s.ints[d].low>>>0,s.ints[d].high>>>0).toNumber())}if(s.strings){if(!Array.isArray(s.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");u.strings=[];for(var d=0;d<s.strings.length;++d)typeof s.strings[d]=="string"?o.base64.decode(s.strings[d],u.strings[d]=o.newBuffer(o.base64.length(s.strings[d])),0):s.strings[d].length>=0&&(u.strings[d]=s.strings[d])}if(s.tensors){if(!Array.isArray(s.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");u.tensors=[];for(var d=0;d<s.tensors.length;++d){if(typeof s.tensors[d]!="object")throw TypeError(".onnx.AttributeProto.tensors: object expected");u.tensors[d]=l.onnx.TensorProto.fromObject(s.tensors[d])}}if(s.graphs){if(!Array.isArray(s.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");u.graphs=[];for(var d=0;d<s.graphs.length;++d){if(typeof s.graphs[d]!="object")throw TypeError(".onnx.AttributeProto.graphs: object expected");u.graphs[d]=l.onnx.GraphProto.fromObject(s.graphs[d])}}if(s.sparseTensors){if(!Array.isArray(s.sparseTensors))throw TypeError(".onnx.AttributeProto.sparseTensors: array expected");u.sparseTensors=[];for(var d=0;d<s.sparseTensors.length;++d){if(typeof s.sparseTensors[d]!="object")throw TypeError(".onnx.AttributeProto.sparseTensors: object expected");u.sparseTensors[d]=l.onnx.SparseTensorProto.fromObject(s.sparseTensors[d])}}if(s.typeProtos){if(!Array.isArray(s.typeProtos))throw TypeError(".onnx.AttributeProto.typeProtos: array expected");u.typeProtos=[];for(var d=0;d<s.typeProtos.length;++d){if(typeof s.typeProtos[d]!="object")throw TypeError(".onnx.AttributeProto.typeProtos: object expected");u.typeProtos[d]=l.onnx.TypeProto.fromObject(s.typeProtos[d])}}return u},c.toObject=function(s,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.floats=[],d.ints=[],d.strings=[],d.tensors=[],d.graphs=[],d.typeProtos=[],d.sparseTensors=[]),u.defaults){if(d.name="",d.f=0,o.Long){var h=new o.Long(0,0,!1);d.i=u.longs===String?h.toString():u.longs===Number?h.toNumber():h}else d.i=u.longs===String?"0":0;u.bytes===String?d.s="":(d.s=[],u.bytes!==Array&&(d.s=o.newBuffer(d.s))),d.t=null,d.g=null,d.docString="",d.tp=null,d.type=u.enums===String?"UNDEFINED":0,d.refAttrName="",d.sparseTensor=null}if(s.name!=null&&s.hasOwnProperty("name")&&(d.name=s.name),s.f!=null&&s.hasOwnProperty("f")&&(d.f=u.json&&!isFinite(s.f)?String(s.f):s.f),s.i!=null&&s.hasOwnProperty("i")&&(typeof s.i=="number"?d.i=u.longs===String?String(s.i):s.i:d.i=u.longs===String?o.Long.prototype.toString.call(s.i):u.longs===Number?new o.LongBits(s.i.low>>>0,s.i.high>>>0).toNumber():s.i),s.s!=null&&s.hasOwnProperty("s")&&(d.s=u.bytes===String?o.base64.encode(s.s,0,s.s.length):u.bytes===Array?Array.prototype.slice.call(s.s):s.s),s.t!=null&&s.hasOwnProperty("t")&&(d.t=l.onnx.TensorProto.toObject(s.t,u)),s.g!=null&&s.hasOwnProperty("g")&&(d.g=l.onnx.GraphProto.toObject(s.g,u)),s.floats&&s.floats.length){d.floats=[];for(var f=0;f<s.floats.length;++f)d.floats[f]=u.json&&!isFinite(s.floats[f])?String(s.floats[f]):s.floats[f]}if(s.ints&&s.ints.length){d.ints=[];for(var f=0;f<s.ints.length;++f)typeof s.ints[f]=="number"?d.ints[f]=u.longs===String?String(s.ints[f]):s.ints[f]:d.ints[f]=u.longs===String?o.Long.prototype.toString.call(s.ints[f]):u.longs===Number?new o.LongBits(s.ints[f].low>>>0,s.ints[f].high>>>0).toNumber():s.ints[f]}if(s.strings&&s.strings.length){d.strings=[];for(var f=0;f<s.strings.length;++f)d.strings[f]=u.bytes===String?o.base64.encode(s.strings[f],0,s.strings[f].length):u.bytes===Array?Array.prototype.slice.call(s.strings[f]):s.strings[f]}if(s.tensors&&s.tensors.length){d.tensors=[];for(var f=0;f<s.tensors.length;++f)d.tensors[f]=l.onnx.TensorProto.toObject(s.tensors[f],u)}if(s.graphs&&s.graphs.length){d.graphs=[];for(var f=0;f<s.graphs.length;++f)d.graphs[f]=l.onnx.GraphProto.toObject(s.graphs[f],u)}if(s.docString!=null&&s.hasOwnProperty("docString")&&(d.docString=s.docString),s.tp!=null&&s.hasOwnProperty("tp")&&(d.tp=l.onnx.TypeProto.toObject(s.tp,u)),s.typeProtos&&s.typeProtos.length){d.typeProtos=[];for(var f=0;f<s.typeProtos.length;++f)d.typeProtos[f]=l.onnx.TypeProto.toObject(s.typeProtos[f],u)}if(s.type!=null&&s.hasOwnProperty("type")&&(d.type=u.enums===String?l.onnx.AttributeProto.AttributeType[s.type]===void 0?s.type:l.onnx.AttributeProto.AttributeType[s.type]:s.type),s.refAttrName!=null&&s.hasOwnProperty("refAttrName")&&(d.refAttrName=s.refAttrName),s.sparseTensor!=null&&s.hasOwnProperty("sparseTensor")&&(d.sparseTensor=l.onnx.SparseTensorProto.toObject(s.sparseTensor,u)),s.sparseTensors&&s.sparseTensors.length){d.sparseTensors=[];for(var f=0;f<s.sparseTensors.length;++f)d.sparseTensors[f]=l.onnx.SparseTensorProto.toObject(s.sparseTensors[f],u)}return d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/onnx.AttributeProto"},c.AttributeType=function(){var s={},u=Object.create(s);return u[s[0]="UNDEFINED"]=0,u[s[1]="FLOAT"]=1,u[s[2]="INT"]=2,u[s[3]="STRING"]=3,u[s[4]="TENSOR"]=4,u[s[5]="GRAPH"]=5,u[s[11]="SPARSE_TENSOR"]=11,u[s[13]="TYPE_PROTO"]=13,u[s[6]="FLOATS"]=6,u[s[7]="INTS"]=7,u[s[8]="STRINGS"]=8,u[s[9]="TENSORS"]=9,u[s[10]="GRAPHS"]=10,u[s[12]="SPARSE_TENSORS"]=12,u[s[14]="TYPE_PROTOS"]=14,u}(),c}(),a.ValueInfoProto=function(){function c(s){if(s)for(var u=Object.keys(s),d=0;d<u.length;++d)s[u[d]]!=null&&(this[u[d]]=s[u[d]])}return c.prototype.name="",c.prototype.type=null,c.prototype.docString="",c.create=function(s){return new c(s)},c.encode=function(s,u){return u||(u=i.create()),s.name!=null&&Object.hasOwnProperty.call(s,"name")&&u.uint32(10).string(s.name),s.type!=null&&Object.hasOwnProperty.call(s,"type")&&l.onnx.TypeProto.encode(s.type,u.uint32(18).fork()).ldelim(),s.docString!=null&&Object.hasOwnProperty.call(s,"docString")&&u.uint32(26).string(s.docString),u},c.encodeDelimited=function(s,u){return this.encode(s,u).ldelim()},c.decode=function(s,u){s instanceof r||(s=r.create(s));for(var d=u===void 0?s.len:s.pos+u,h=new l.onnx.ValueInfoProto;s.pos<d;){var f=s.uint32();switch(f>>>3){case 1:{h.name=s.string();break}case 2:{h.type=l.onnx.TypeProto.decode(s,s.uint32());break}case 3:{h.docString=s.string();break}default:s.skipType(f&7);break}}return h},c.decodeDelimited=function(s){return s instanceof r||(s=new r(s)),this.decode(s,s.uint32())},c.verify=function(s){if(typeof s!="object"||s===null)return"object expected";if(s.name!=null&&s.hasOwnProperty("name")&&!o.isString(s.name))return"name: string expected";if(s.type!=null&&s.hasOwnProperty("type")){var u=l.onnx.TypeProto.verify(s.type);if(u)return"type."+u}return s.docString!=null&&s.hasOwnProperty("docString")&&!o.isString(s.docString)?"docString: string expected":null},c.fromObject=function(s){if(s instanceof l.onnx.ValueInfoProto)return s;var u=new l.onnx.ValueInfoProto;if(s.name!=null&&(u.name=String(s.name)),s.type!=null){if(typeof s.type!="object")throw TypeError(".onnx.ValueInfoProto.type: object expected");u.type=l.onnx.TypeProto.fromObject(s.type)}return s.docString!=null&&(u.docString=String(s.docString)),u},c.toObject=function(s,u){u||(u={});var d={};return u.defaults&&(d.name="",d.type=null,d.docString=""),s.name!=null&&s.hasOwnProperty("name")&&(d.name=s.name),s.type!=null&&s.hasOwnProperty("type")&&(d.type=l.onnx.TypeProto.toObject(s.type,u)),s.docString!=null&&s.hasOwnProperty("docString")&&(d.docString=s.docString),d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/onnx.ValueInfoProto"},c}(),a.NodeProto=function(){function c(s){if(this.input=[],this.output=[],this.attribute=[],s)for(var u=Object.keys(s),d=0;d<u.length;++d)s[u[d]]!=null&&(this[u[d]]=s[u[d]])}return c.prototype.input=o.emptyArray,c.prototype.output=o.emptyArray,c.prototype.name="",c.prototype.opType="",c.prototype.domain="",c.prototype.attribute=o.emptyArray,c.prototype.docString="",c.create=function(s){return new c(s)},c.encode=function(s,u){if(u||(u=i.create()),s.input!=null&&s.input.length)for(var d=0;d<s.input.length;++d)u.uint32(10).string(s.input[d]);if(s.output!=null&&s.output.length)for(var d=0;d<s.output.length;++d)u.uint32(18).string(s.output[d]);if(s.name!=null&&Object.hasOwnProperty.call(s,"name")&&u.uint32(26).string(s.name),s.opType!=null&&Object.hasOwnProperty.call(s,"opType")&&u.uint32(34).string(s.opType),s.attribute!=null&&s.attribute.length)for(var d=0;d<s.attribute.length;++d)l.onnx.AttributeProto.encode(s.attribute[d],u.uint32(42).fork()).ldelim();return s.docString!=null&&Object.hasOwnProperty.call(s,"docString")&&u.uint32(50).string(s.docString),s.domain!=null&&Object.hasOwnProperty.call(s,"domain")&&u.uint32(58).string(s.domain),u},c.encodeDelimited=function(s,u){return this.encode(s,u).ldelim()},c.decode=function(s,u){s instanceof r||(s=r.create(s));for(var d=u===void 0?s.len:s.pos+u,h=new l.onnx.NodeProto;s.pos<d;){var f=s.uint32();switch(f>>>3){case 1:{h.input&&h.input.length||(h.input=[]),h.input.push(s.string());break}case 2:{h.output&&h.output.length||(h.output=[]),h.output.push(s.string());break}case 3:{h.name=s.string();break}case 4:{h.opType=s.string();break}case 7:{h.domain=s.string();break}case 5:{h.attribute&&h.attribute.length||(h.attribute=[]),h.attribute.push(l.onnx.AttributeProto.decode(s,s.uint32()));break}case 6:{h.docString=s.string();break}default:s.skipType(f&7);break}}return h},c.decodeDelimited=function(s){return s instanceof r||(s=new r(s)),this.decode(s,s.uint32())},c.verify=function(s){if(typeof s!="object"||s===null)return"object expected";if(s.input!=null&&s.hasOwnProperty("input")){if(!Array.isArray(s.input))return"input: array expected";for(var u=0;u<s.input.length;++u)if(!o.isString(s.input[u]))return"input: string[] expected"}if(s.output!=null&&s.hasOwnProperty("output")){if(!Array.isArray(s.output))return"output: array expected";for(var u=0;u<s.output.length;++u)if(!o.isString(s.output[u]))return"output: string[] expected"}if(s.name!=null&&s.hasOwnProperty("name")&&!o.isString(s.name))return"name: string expected";if(s.opType!=null&&s.hasOwnProperty("opType")&&!o.isString(s.opType))return"opType: string expected";if(s.domain!=null&&s.hasOwnProperty("domain")&&!o.isString(s.domain))return"domain: string expected";if(s.attribute!=null&&s.hasOwnProperty("attribute")){if(!Array.isArray(s.attribute))return"attribute: array expected";for(var u=0;u<s.attribute.length;++u){var d=l.onnx.AttributeProto.verify(s.attribute[u]);if(d)return"attribute."+d}}return s.docString!=null&&s.hasOwnProperty("docString")&&!o.isString(s.docString)?"docString: string expected":null},c.fromObject=function(s){if(s instanceof l.onnx.NodeProto)return s;var u=new l.onnx.NodeProto;if(s.input){if(!Array.isArray(s.input))throw TypeError(".onnx.NodeProto.input: array expected");u.input=[];for(var d=0;d<s.input.length;++d)u.input[d]=String(s.input[d])}if(s.output){if(!Array.isArray(s.output))throw TypeError(".onnx.NodeProto.output: array expected");u.output=[];for(var d=0;d<s.output.length;++d)u.output[d]=String(s.output[d])}if(s.name!=null&&(u.name=String(s.name)),s.opType!=null&&(u.opType=String(s.opType)),s.domain!=null&&(u.domain=String(s.domain)),s.attribute){if(!Array.isArray(s.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");u.attribute=[];for(var d=0;d<s.attribute.length;++d){if(typeof s.attribute[d]!="object")throw TypeError(".onnx.NodeProto.attribute: object expected");u.attribute[d]=l.onnx.AttributeProto.fromObject(s.attribute[d])}}return s.docString!=null&&(u.docString=String(s.docString)),u},c.toObject=function(s,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.input=[],d.output=[],d.attribute=[]),u.defaults&&(d.name="",d.opType="",d.docString="",d.domain=""),s.input&&s.input.length){d.input=[];for(var h=0;h<s.input.length;++h)d.input[h]=s.input[h]}if(s.output&&s.output.length){d.output=[];for(var h=0;h<s.output.length;++h)d.output[h]=s.output[h]}if(s.name!=null&&s.hasOwnProperty("name")&&(d.name=s.name),s.opType!=null&&s.hasOwnProperty("opType")&&(d.opType=s.opType),s.attribute&&s.attribute.length){d.attribute=[];for(var h=0;h<s.attribute.length;++h)d.attribute[h]=l.onnx.AttributeProto.toObject(s.attribute[h],u)}return s.docString!=null&&s.hasOwnProperty("docString")&&(d.docString=s.docString),s.domain!=null&&s.hasOwnProperty("domain")&&(d.domain=s.domain),d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/onnx.NodeProto"},c}(),a.TrainingInfoProto=function(){function c(s){if(this.initializationBinding=[],this.updateBinding=[],s)for(var u=Object.keys(s),d=0;d<u.length;++d)s[u[d]]!=null&&(this[u[d]]=s[u[d]])}return c.prototype.initialization=null,c.prototype.algorithm=null,c.prototype.initializationBinding=o.emptyArray,c.prototype.updateBinding=o.emptyArray,c.create=function(s){return new c(s)},c.encode=function(s,u){if(u||(u=i.create()),s.initialization!=null&&Object.hasOwnProperty.call(s,"initialization")&&l.onnx.GraphProto.encode(s.initialization,u.uint32(10).fork()).ldelim(),s.algorithm!=null&&Object.hasOwnProperty.call(s,"algorithm")&&l.onnx.GraphProto.encode(s.algorithm,u.uint32(18).fork()).ldelim(),s.initializationBinding!=null&&s.initializationBinding.length)for(var d=0;d<s.initializationBinding.length;++d)l.onnx.StringStringEntryProto.encode(s.initializationBinding[d],u.uint32(26).fork()).ldelim();if(s.updateBinding!=null&&s.updateBinding.length)for(var d=0;d<s.updateBinding.length;++d)l.onnx.StringStringEntryProto.encode(s.updateBinding[d],u.uint32(34).fork()).ldelim();return u},c.encodeDelimited=function(s,u){return this.encode(s,u).ldelim()},c.decode=function(s,u){s instanceof r||(s=r.create(s));for(var d=u===void 0?s.len:s.pos+u,h=new l.onnx.TrainingInfoProto;s.pos<d;){var f=s.uint32();switch(f>>>3){case 1:{h.initialization=l.onnx.GraphProto.decode(s,s.uint32());break}case 2:{h.algorithm=l.onnx.GraphProto.decode(s,s.uint32());break}case 3:{h.initializationBinding&&h.initializationBinding.length||(h.initializationBinding=[]),h.initializationBinding.push(l.onnx.StringStringEntryProto.decode(s,s.uint32()));break}case 4:{h.updateBinding&&h.updateBinding.length||(h.updateBinding=[]),h.updateBinding.push(l.onnx.StringStringEntryProto.decode(s,s.uint32()));break}default:s.skipType(f&7);break}}return h},c.decodeDelimited=function(s){return s instanceof r||(s=new r(s)),this.decode(s,s.uint32())},c.verify=function(s){if(typeof s!="object"||s===null)return"object expected";if(s.initialization!=null&&s.hasOwnProperty("initialization")){var u=l.onnx.GraphProto.verify(s.initialization);if(u)return"initialization."+u}if(s.algorithm!=null&&s.hasOwnProperty("algorithm")){var u=l.onnx.GraphProto.verify(s.algorithm);if(u)return"algorithm."+u}if(s.initializationBinding!=null&&s.hasOwnProperty("initializationBinding")){if(!Array.isArray(s.initializationBinding))return"initializationBinding: array expected";for(var d=0;d<s.initializationBinding.length;++d){var u=l.onnx.StringStringEntryProto.verify(s.initializationBinding[d]);if(u)return"initializationBinding."+u}}if(s.updateBinding!=null&&s.hasOwnProperty("updateBinding")){if(!Array.isArray(s.updateBinding))return"updateBinding: array expected";for(var d=0;d<s.updateBinding.length;++d){var u=l.onnx.StringStringEntryProto.verify(s.updateBinding[d]);if(u)return"updateBinding."+u}}return null},c.fromObject=function(s){if(s instanceof l.onnx.TrainingInfoProto)return s;var u=new l.onnx.TrainingInfoProto;if(s.initialization!=null){if(typeof s.initialization!="object")throw TypeError(".onnx.TrainingInfoProto.initialization: object expected");u.initialization=l.onnx.GraphProto.fromObject(s.initialization)}if(s.algorithm!=null){if(typeof s.algorithm!="object")throw TypeError(".onnx.TrainingInfoProto.algorithm: object expected");u.algorithm=l.onnx.GraphProto.fromObject(s.algorithm)}if(s.initializationBinding){if(!Array.isArray(s.initializationBinding))throw TypeError(".onnx.TrainingInfoProto.initializationBinding: array expected");u.initializationBinding=[];for(var d=0;d<s.initializationBinding.length;++d){if(typeof s.initializationBinding[d]!="object")throw TypeError(".onnx.TrainingInfoProto.initializationBinding: object expected");u.initializationBinding[d]=l.onnx.StringStringEntryProto.fromObject(s.initializationBinding[d])}}if(s.updateBinding){if(!Array.isArray(s.updateBinding))throw TypeError(".onnx.TrainingInfoProto.updateBinding: array expected");u.updateBinding=[];for(var d=0;d<s.updateBinding.length;++d){if(typeof s.updateBinding[d]!="object")throw TypeError(".onnx.TrainingInfoProto.updateBinding: object expected");u.updateBinding[d]=l.onnx.StringStringEntryProto.fromObject(s.updateBinding[d])}}return u},c.toObject=function(s,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.initializationBinding=[],d.updateBinding=[]),u.defaults&&(d.initialization=null,d.algorithm=null),s.initialization!=null&&s.hasOwnProperty("initialization")&&(d.initialization=l.onnx.GraphProto.toObject(s.initialization,u)),s.algorithm!=null&&s.hasOwnProperty("algorithm")&&(d.algorithm=l.onnx.GraphProto.toObject(s.algorithm,u)),s.initializationBinding&&s.initializationBinding.length){d.initializationBinding=[];for(var h=0;h<s.initializationBinding.length;++h)d.initializationBinding[h]=l.onnx.StringStringEntryProto.toObject(s.initializationBinding[h],u)}if(s.updateBinding&&s.updateBinding.length){d.updateBinding=[];for(var h=0;h<s.updateBinding.length;++h)d.updateBinding[h]=l.onnx.StringStringEntryProto.toObject(s.updateBinding[h],u)}return d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/onnx.TrainingInfoProto"},c}(),a.ModelProto=function(){function c(s){if(this.opsetImport=[],this.metadataProps=[],this.trainingInfo=[],this.functions=[],s)for(var u=Object.keys(s),d=0;d<u.length;++d)s[u[d]]!=null&&(this[u[d]]=s[u[d]])}return c.prototype.irVersion=o.Long?o.Long.fromBits(0,0,!1):0,c.prototype.opsetImport=o.emptyArray,c.prototype.producerName="",c.prototype.producerVersion="",c.prototype.domain="",c.prototype.modelVersion=o.Long?o.Long.fromBits(0,0,!1):0,c.prototype.docString="",c.prototype.graph=null,c.prototype.metadataProps=o.emptyArray,c.prototype.trainingInfo=o.emptyArray,c.prototype.functions=o.emptyArray,c.create=function(s){return new c(s)},c.encode=function(s,u){if(u||(u=i.create()),s.irVersion!=null&&Object.hasOwnProperty.call(s,"irVersion")&&u.uint32(8).int64(s.irVersion),s.producerName!=null&&Object.hasOwnProperty.call(s,"producerName")&&u.uint32(18).string(s.producerName),s.producerVersion!=null&&Object.hasOwnProperty.call(s,"producerVersion")&&u.uint32(26).string(s.producerVersion),s.domain!=null&&Object.hasOwnProperty.call(s,"domain")&&u.uint32(34).string(s.domain),s.modelVersion!=null&&Object.hasOwnProperty.call(s,"modelVersion")&&u.uint32(40).int64(s.modelVersion),s.docString!=null&&Object.hasOwnProperty.call(s,"docString")&&u.uint32(50).string(s.docString),s.graph!=null&&Object.hasOwnProperty.call(s,"graph")&&l.onnx.GraphProto.encode(s.graph,u.uint32(58).fork()).ldelim(),s.opsetImport!=null&&s.opsetImport.length)for(var d=0;d<s.opsetImport.length;++d)l.onnx.OperatorSetIdProto.encode(s.opsetImport[d],u.uint32(66).fork()).ldelim();if(s.metadataProps!=null&&s.metadataProps.length)for(var d=0;d<s.metadataProps.length;++d)l.onnx.StringStringEntryProto.encode(s.metadataProps[d],u.uint32(114).fork()).ldelim();if(s.trainingInfo!=null&&s.trainingInfo.length)for(var d=0;d<s.trainingInfo.length;++d)l.onnx.TrainingInfoProto.encode(s.trainingInfo[d],u.uint32(162).fork()).ldelim();if(s.functions!=null&&s.functions.length)for(var d=0;d<s.functions.length;++d)l.onnx.FunctionProto.encode(s.functions[d],u.uint32(202).fork()).ldelim();return u},c.encodeDelimited=function(s,u){return this.encode(s,u).ldelim()},c.decode=function(s,u){s instanceof r||(s=r.create(s));for(var d=u===void 0?s.len:s.pos+u,h=new l.onnx.ModelProto;s.pos<d;){var f=s.uint32();switch(f>>>3){case 1:{h.irVersion=s.int64();break}case 8:{h.opsetImport&&h.opsetImport.length||(h.opsetImport=[]),h.opsetImport.push(l.onnx.OperatorSetIdProto.decode(s,s.uint32()));break}case 2:{h.producerName=s.string();break}case 3:{h.producerVersion=s.string();break}case 4:{h.domain=s.string();break}case 5:{h.modelVersion=s.int64();break}case 6:{h.docString=s.string();break}case 7:{h.graph=l.onnx.GraphProto.decode(s,s.uint32());break}case 14:{h.metadataProps&&h.metadataProps.length||(h.metadataProps=[]),h.metadataProps.push(l.onnx.StringStringEntryProto.decode(s,s.uint32()));break}case 20:{h.trainingInfo&&h.trainingInfo.length||(h.trainingInfo=[]),h.trainingInfo.push(l.onnx.TrainingInfoProto.decode(s,s.uint32()));break}case 25:{h.functions&&h.functions.length||(h.functions=[]),h.functions.push(l.onnx.FunctionProto.decode(s,s.uint32()));break}default:s.skipType(f&7);break}}return h},c.decodeDelimited=function(s){return s instanceof r||(s=new r(s)),this.decode(s,s.uint32())},c.verify=function(s){if(typeof s!="object"||s===null)return"object expected";if(s.irVersion!=null&&s.hasOwnProperty("irVersion")&&!o.isInteger(s.irVersion)&&!(s.irVersion&&o.isInteger(s.irVersion.low)&&o.isInteger(s.irVersion.high)))return"irVersion: integer|Long expected";if(s.opsetImport!=null&&s.hasOwnProperty("opsetImport")){if(!Array.isArray(s.opsetImport))return"opsetImport: array expected";for(var u=0;u<s.opsetImport.length;++u){var d=l.onnx.OperatorSetIdProto.verify(s.opsetImport[u]);if(d)return"opsetImport."+d}}if(s.producerName!=null&&s.hasOwnProperty("producerName")&&!o.isString(s.producerName))return"producerName: string expected";if(s.producerVersion!=null&&s.hasOwnProperty("producerVersion")&&!o.isString(s.producerVersion))return"producerVersion: string expected";if(s.domain!=null&&s.hasOwnProperty("domain")&&!o.isString(s.domain))return"domain: string expected";if(s.modelVersion!=null&&s.hasOwnProperty("modelVersion")&&!o.isInteger(s.modelVersion)&&!(s.modelVersion&&o.isInteger(s.modelVersion.low)&&o.isInteger(s.modelVersion.high)))return"modelVersion: integer|Long expected";if(s.docString!=null&&s.hasOwnProperty("docString")&&!o.isString(s.docString))return"docString: string expected";if(s.graph!=null&&s.hasOwnProperty("graph")){var d=l.onnx.GraphProto.verify(s.graph);if(d)return"graph."+d}if(s.metadataProps!=null&&s.hasOwnProperty("metadataProps")){if(!Array.isArray(s.metadataProps))return"metadataProps: array expected";for(var u=0;u<s.metadataProps.length;++u){var d=l.onnx.StringStringEntryProto.verify(s.metadataProps[u]);if(d)return"metadataProps."+d}}if(s.trainingInfo!=null&&s.hasOwnProperty("trainingInfo")){if(!Array.isArray(s.trainingInfo))return"trainingInfo: array expected";for(var u=0;u<s.trainingInfo.length;++u){var d=l.onnx.TrainingInfoProto.verify(s.trainingInfo[u]);if(d)return"trainingInfo."+d}}if(s.functions!=null&&s.hasOwnProperty("functions")){if(!Array.isArray(s.functions))return"functions: array expected";for(var u=0;u<s.functions.length;++u){var d=l.onnx.FunctionProto.verify(s.functions[u]);if(d)return"functions."+d}}return null},c.fromObject=function(s){if(s instanceof l.onnx.ModelProto)return s;var u=new l.onnx.ModelProto;if(s.irVersion!=null&&(o.Long?(u.irVersion=o.Long.fromValue(s.irVersion)).unsigned=!1:typeof s.irVersion=="string"?u.irVersion=parseInt(s.irVersion,10):typeof s.irVersion=="number"?u.irVersion=s.irVersion:typeof s.irVersion=="object"&&(u.irVersion=new o.LongBits(s.irVersion.low>>>0,s.irVersion.high>>>0).toNumber())),s.opsetImport){if(!Array.isArray(s.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");u.opsetImport=[];for(var d=0;d<s.opsetImport.length;++d){if(typeof s.opsetImport[d]!="object")throw TypeError(".onnx.ModelProto.opsetImport: object expected");u.opsetImport[d]=l.onnx.OperatorSetIdProto.fromObject(s.opsetImport[d])}}if(s.producerName!=null&&(u.producerName=String(s.producerName)),s.producerVersion!=null&&(u.producerVersion=String(s.producerVersion)),s.domain!=null&&(u.domain=String(s.domain)),s.modelVersion!=null&&(o.Long?(u.modelVersion=o.Long.fromValue(s.modelVersion)).unsigned=!1:typeof s.modelVersion=="string"?u.modelVersion=parseInt(s.modelVersion,10):typeof s.modelVersion=="number"?u.modelVersion=s.modelVersion:typeof s.modelVersion=="object"&&(u.modelVersion=new o.LongBits(s.modelVersion.low>>>0,s.modelVersion.high>>>0).toNumber())),s.docString!=null&&(u.docString=String(s.docString)),s.graph!=null){if(typeof s.graph!="object")throw TypeError(".onnx.ModelProto.graph: object expected");u.graph=l.onnx.GraphProto.fromObject(s.graph)}if(s.metadataProps){if(!Array.isArray(s.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");u.metadataProps=[];for(var d=0;d<s.metadataProps.length;++d){if(typeof s.metadataProps[d]!="object")throw TypeError(".onnx.ModelProto.metadataProps: object expected");u.metadataProps[d]=l.onnx.StringStringEntryProto.fromObject(s.metadataProps[d])}}if(s.trainingInfo){if(!Array.isArray(s.trainingInfo))throw TypeError(".onnx.ModelProto.trainingInfo: array expected");u.trainingInfo=[];for(var d=0;d<s.trainingInfo.length;++d){if(typeof s.trainingInfo[d]!="object")throw TypeError(".onnx.ModelProto.trainingInfo: object expected");u.trainingInfo[d]=l.onnx.TrainingInfoProto.fromObject(s.trainingInfo[d])}}if(s.functions){if(!Array.isArray(s.functions))throw TypeError(".onnx.ModelProto.functions: array expected");u.functions=[];for(var d=0;d<s.functions.length;++d){if(typeof s.functions[d]!="object")throw TypeError(".onnx.ModelProto.functions: object expected");u.functions[d]=l.onnx.FunctionProto.fromObject(s.functions[d])}}return u},c.toObject=function(s,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.opsetImport=[],d.metadataProps=[],d.trainingInfo=[],d.functions=[]),u.defaults){if(o.Long){var h=new o.Long(0,0,!1);d.irVersion=u.longs===String?h.toString():u.longs===Number?h.toNumber():h}else d.irVersion=u.longs===String?"0":0;if(d.producerName="",d.producerVersion="",d.domain="",o.Long){var h=new o.Long(0,0,!1);d.modelVersion=u.longs===String?h.toString():u.longs===Number?h.toNumber():h}else d.modelVersion=u.longs===String?"0":0;d.docString="",d.graph=null}if(s.irVersion!=null&&s.hasOwnProperty("irVersion")&&(typeof s.irVersion=="number"?d.irVersion=u.longs===String?String(s.irVersion):s.irVersion:d.irVersion=u.longs===String?o.Long.prototype.toString.call(s.irVersion):u.longs===Number?new o.LongBits(s.irVersion.low>>>0,s.irVersion.high>>>0).toNumber():s.irVersion),s.producerName!=null&&s.hasOwnProperty("producerName")&&(d.producerName=s.producerName),s.producerVersion!=null&&s.hasOwnProperty("producerVersion")&&(d.producerVersion=s.producerVersion),s.domain!=null&&s.hasOwnProperty("domain")&&(d.domain=s.domain),s.modelVersion!=null&&s.hasOwnProperty("modelVersion")&&(typeof s.modelVersion=="number"?d.modelVersion=u.longs===String?String(s.modelVersion):s.modelVersion:d.modelVersion=u.longs===String?o.Long.prototype.toString.call(s.modelVersion):u.longs===Number?new o.LongBits(s.modelVersion.low>>>0,s.modelVersion.high>>>0).toNumber():s.modelVersion),s.docString!=null&&s.hasOwnProperty("docString")&&(d.docString=s.docString),s.graph!=null&&s.hasOwnProperty("graph")&&(d.graph=l.onnx.GraphProto.toObject(s.graph,u)),s.opsetImport&&s.opsetImport.length){d.opsetImport=[];for(var f=0;f<s.opsetImport.length;++f)d.opsetImport[f]=l.onnx.OperatorSetIdProto.toObject(s.opsetImport[f],u)}if(s.metadataProps&&s.metadataProps.length){d.metadataProps=[];for(var f=0;f<s.metadataProps.length;++f)d.metadataProps[f]=l.onnx.StringStringEntryProto.toObject(s.metadataProps[f],u)}if(s.trainingInfo&&s.trainingInfo.length){d.trainingInfo=[];for(var f=0;f<s.trainingInfo.length;++f)d.trainingInfo[f]=l.onnx.TrainingInfoProto.toObject(s.trainingInfo[f],u)}if(s.functions&&s.functions.length){d.functions=[];for(var f=0;f<s.functions.length;++f)d.functions[f]=l.onnx.FunctionProto.toObject(s.functions[f],u)}return d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/onnx.ModelProto"},c}(),a.StringStringEntryProto=function(){function c(s){if(s)for(var u=Object.keys(s),d=0;d<u.length;++d)s[u[d]]!=null&&(this[u[d]]=s[u[d]])}return c.prototype.key="",c.prototype.value="",c.create=function(s){return new c(s)},c.encode=function(s,u){return u||(u=i.create()),s.key!=null&&Object.hasOwnProperty.call(s,"key")&&u.uint32(10).string(s.key),s.value!=null&&Object.hasOwnProperty.call(s,"value")&&u.uint32(18).string(s.value),u},c.encodeDelimited=function(s,u){return this.encode(s,u).ldelim()},c.decode=function(s,u){s instanceof r||(s=r.create(s));for(var d=u===void 0?s.len:s.pos+u,h=new l.onnx.StringStringEntryProto;s.pos<d;){var f=s.uint32();switch(f>>>3){case 1:{h.key=s.string();break}case 2:{h.value=s.string();break}default:s.skipType(f&7);break}}return h},c.decodeDelimited=function(s){return s instanceof r||(s=new r(s)),this.decode(s,s.uint32())},c.verify=function(s){return typeof s!="object"||s===null?"object expected":s.key!=null&&s.hasOwnProperty("key")&&!o.isString(s.key)?"key: string expected":s.value!=null&&s.hasOwnProperty("value")&&!o.isString(s.value)?"value: string expected":null},c.fromObject=function(s){if(s instanceof l.onnx.StringStringEntryProto)return s;var u=new l.onnx.StringStringEntryProto;return s.key!=null&&(u.key=String(s.key)),s.value!=null&&(u.value=String(s.value)),u},c.toObject=function(s,u){u||(u={});var d={};return u.defaults&&(d.key="",d.value=""),s.key!=null&&s.hasOwnProperty("key")&&(d.key=s.key),s.value!=null&&s.hasOwnProperty("value")&&(d.value=s.value),d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/onnx.StringStringEntryProto"},c}(),a.TensorAnnotation=function(){function c(s){if(this.quantParameterTensorNames=[],s)for(var u=Object.keys(s),d=0;d<u.length;++d)s[u[d]]!=null&&(this[u[d]]=s[u[d]])}return c.prototype.tensorName="",c.prototype.quantParameterTensorNames=o.emptyArray,c.create=function(s){return new c(s)},c.encode=function(s,u){if(u||(u=i.create()),s.tensorName!=null&&Object.hasOwnProperty.call(s,"tensorName")&&u.uint32(10).string(s.tensorName),s.quantParameterTensorNames!=null&&s.quantParameterTensorNames.length)for(var d=0;d<s.quantParameterTensorNames.length;++d)l.onnx.StringStringEntryProto.encode(s.quantParameterTensorNames[d],u.uint32(18).fork()).ldelim();return u},c.encodeDelimited=function(s,u){return this.encode(s,u).ldelim()},c.decode=function(s,u){s instanceof r||(s=r.create(s));for(var d=u===void 0?s.len:s.pos+u,h=new l.onnx.TensorAnnotation;s.pos<d;){var f=s.uint32();switch(f>>>3){case 1:{h.tensorName=s.string();break}case 2:{h.quantParameterTensorNames&&h.quantParameterTensorNames.length||(h.quantParameterTensorNames=[]),h.quantParameterTensorNames.push(l.onnx.StringStringEntryProto.decode(s,s.uint32()));break}default:s.skipType(f&7);break}}return h},c.decodeDelimited=function(s){return s instanceof r||(s=new r(s)),this.decode(s,s.uint32())},c.verify=function(s){if(typeof s!="object"||s===null)return"object expected";if(s.tensorName!=null&&s.hasOwnProperty("tensorName")&&!o.isString(s.tensorName))return"tensorName: string expected";if(s.quantParameterTensorNames!=null&&s.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(s.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var u=0;u<s.quantParameterTensorNames.length;++u){var d=l.onnx.StringStringEntryProto.verify(s.quantParameterTensorNames[u]);if(d)return"quantParameterTensorNames."+d}}return null},c.fromObject=function(s){if(s instanceof l.onnx.TensorAnnotation)return s;var u=new l.onnx.TensorAnnotation;if(s.tensorName!=null&&(u.tensorName=String(s.tensorName)),s.quantParameterTensorNames){if(!Array.isArray(s.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");u.quantParameterTensorNames=[];for(var d=0;d<s.quantParameterTensorNames.length;++d){if(typeof s.quantParameterTensorNames[d]!="object")throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");u.quantParameterTensorNames[d]=l.onnx.StringStringEntryProto.fromObject(s.quantParameterTensorNames[d])}}return u},c.toObject=function(s,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.quantParameterTensorNames=[]),u.defaults&&(d.tensorName=""),s.tensorName!=null&&s.hasOwnProperty("tensorName")&&(d.tensorName=s.tensorName),s.quantParameterTensorNames&&s.quantParameterTensorNames.length){d.quantParameterTensorNames=[];for(var h=0;h<s.quantParameterTensorNames.length;++h)d.quantParameterTensorNames[h]=l.onnx.StringStringEntryProto.toObject(s.quantParameterTensorNames[h],u)}return d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/onnx.TensorAnnotation"},c}(),a.GraphProto=function(){function c(s){if(this.node=[],this.initializer=[],this.sparseInitializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],s)for(var u=Object.keys(s),d=0;d<u.length;++d)s[u[d]]!=null&&(this[u[d]]=s[u[d]])}return c.prototype.node=o.emptyArray,c.prototype.name="",c.prototype.initializer=o.emptyArray,c.prototype.sparseInitializer=o.emptyArray,c.prototype.docString="",c.prototype.input=o.emptyArray,c.prototype.output=o.emptyArray,c.prototype.valueInfo=o.emptyArray,c.prototype.quantizationAnnotation=o.emptyArray,c.create=function(s){return new c(s)},c.encode=function(s,u){if(u||(u=i.create()),s.node!=null&&s.node.length)for(var d=0;d<s.node.length;++d)l.onnx.NodeProto.encode(s.node[d],u.uint32(10).fork()).ldelim();if(s.name!=null&&Object.hasOwnProperty.call(s,"name")&&u.uint32(18).string(s.name),s.initializer!=null&&s.initializer.length)for(var d=0;d<s.initializer.length;++d)l.onnx.TensorProto.encode(s.initializer[d],u.uint32(42).fork()).ldelim();if(s.docString!=null&&Object.hasOwnProperty.call(s,"docString")&&u.uint32(82).string(s.docString),s.input!=null&&s.input.length)for(var d=0;d<s.input.length;++d)l.onnx.ValueInfoProto.encode(s.input[d],u.uint32(90).fork()).ldelim();if(s.output!=null&&s.output.length)for(var d=0;d<s.output.length;++d)l.onnx.ValueInfoProto.encode(s.output[d],u.uint32(98).fork()).ldelim();if(s.valueInfo!=null&&s.valueInfo.length)for(var d=0;d<s.valueInfo.length;++d)l.onnx.ValueInfoProto.encode(s.valueInfo[d],u.uint32(106).fork()).ldelim();if(s.quantizationAnnotation!=null&&s.quantizationAnnotation.length)for(var d=0;d<s.quantizationAnnotation.length;++d)l.onnx.TensorAnnotation.encode(s.quantizationAnnotation[d],u.uint32(114).fork()).ldelim();if(s.sparseInitializer!=null&&s.sparseInitializer.length)for(var d=0;d<s.sparseInitializer.length;++d)l.onnx.SparseTensorProto.encode(s.sparseInitializer[d],u.uint32(122).fork()).ldelim();return u},c.encodeDelimited=function(s,u){return this.encode(s,u).ldelim()},c.decode=function(s,u){s instanceof r||(s=r.create(s));for(var d=u===void 0?s.len:s.pos+u,h=new l.onnx.GraphProto;s.pos<d;){var f=s.uint32();switch(f>>>3){case 1:{h.node&&h.node.length||(h.node=[]),h.node.push(l.onnx.NodeProto.decode(s,s.uint32()));break}case 2:{h.name=s.string();break}case 5:{h.initializer&&h.initializer.length||(h.initializer=[]),h.initializer.push(l.onnx.TensorProto.decode(s,s.uint32()));break}case 15:{h.sparseInitializer&&h.sparseInitializer.length||(h.sparseInitializer=[]),h.sparseInitializer.push(l.onnx.SparseTensorProto.decode(s,s.uint32()));break}case 10:{h.docString=s.string();break}case 11:{h.input&&h.input.length||(h.input=[]),h.input.push(l.onnx.ValueInfoProto.decode(s,s.uint32()));break}case 12:{h.output&&h.output.length||(h.output=[]),h.output.push(l.onnx.ValueInfoProto.decode(s,s.uint32()));break}case 13:{h.valueInfo&&h.valueInfo.length||(h.valueInfo=[]),h.valueInfo.push(l.onnx.ValueInfoProto.decode(s,s.uint32()));break}case 14:{h.quantizationAnnotation&&h.quantizationAnnotation.length||(h.quantizationAnnotation=[]),h.quantizationAnnotation.push(l.onnx.TensorAnnotation.decode(s,s.uint32()));break}default:s.skipType(f&7);break}}return h},c.decodeDelimited=function(s){return s instanceof r||(s=new r(s)),this.decode(s,s.uint32())},c.verify=function(s){if(typeof s!="object"||s===null)return"object expected";if(s.node!=null&&s.hasOwnProperty("node")){if(!Array.isArray(s.node))return"node: array expected";for(var u=0;u<s.node.length;++u){var d=l.onnx.NodeProto.verify(s.node[u]);if(d)return"node."+d}}if(s.name!=null&&s.hasOwnProperty("name")&&!o.isString(s.name))return"name: string expected";if(s.initializer!=null&&s.hasOwnProperty("initializer")){if(!Array.isArray(s.initializer))return"initializer: array expected";for(var u=0;u<s.initializer.length;++u){var d=l.onnx.TensorProto.verify(s.initializer[u]);if(d)return"initializer."+d}}if(s.sparseInitializer!=null&&s.hasOwnProperty("sparseInitializer")){if(!Array.isArray(s.sparseInitializer))return"sparseInitializer: array expected";for(var u=0;u<s.sparseInitializer.length;++u){var d=l.onnx.SparseTensorProto.verify(s.sparseInitializer[u]);if(d)return"sparseInitializer."+d}}if(s.docString!=null&&s.hasOwnProperty("docString")&&!o.isString(s.docString))return"docString: string expected";if(s.input!=null&&s.hasOwnProperty("input")){if(!Array.isArray(s.input))return"input: array expected";for(var u=0;u<s.input.length;++u){var d=l.onnx.ValueInfoProto.verify(s.input[u]);if(d)return"input."+d}}if(s.output!=null&&s.hasOwnProperty("output")){if(!Array.isArray(s.output))return"output: array expected";for(var u=0;u<s.output.length;++u){var d=l.onnx.ValueInfoProto.verify(s.output[u]);if(d)return"output."+d}}if(s.valueInfo!=null&&s.hasOwnProperty("valueInfo")){if(!Array.isArray(s.valueInfo))return"valueInfo: array expected";for(var u=0;u<s.valueInfo.length;++u){var d=l.onnx.ValueInfoProto.verify(s.valueInfo[u]);if(d)return"valueInfo."+d}}if(s.quantizationAnnotation!=null&&s.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(s.quantizationAnnotation))return"quantizationAnnotation: array expected";for(var u=0;u<s.quantizationAnnotation.length;++u){var d=l.onnx.TensorAnnotation.verify(s.quantizationAnnotation[u]);if(d)return"quantizationAnnotation."+d}}return null},c.fromObject=function(s){if(s instanceof l.onnx.GraphProto)return s;var u=new l.onnx.GraphProto;if(s.node){if(!Array.isArray(s.node))throw TypeError(".onnx.GraphProto.node: array expected");u.node=[];for(var d=0;d<s.node.length;++d){if(typeof s.node[d]!="object")throw TypeError(".onnx.GraphProto.node: object expected");u.node[d]=l.onnx.NodeProto.fromObject(s.node[d])}}if(s.name!=null&&(u.name=String(s.name)),s.initializer){if(!Array.isArray(s.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");u.initializer=[];for(var d=0;d<s.initializer.length;++d){if(typeof s.initializer[d]!="object")throw TypeError(".onnx.GraphProto.initializer: object expected");u.initializer[d]=l.onnx.TensorProto.fromObject(s.initializer[d])}}if(s.sparseInitializer){if(!Array.isArray(s.sparseInitializer))throw TypeError(".onnx.GraphProto.sparseInitializer: array expected");u.sparseInitializer=[];for(var d=0;d<s.sparseInitializer.length;++d){if(typeof s.sparseInitializer[d]!="object")throw TypeError(".onnx.GraphProto.sparseInitializer: object expected");u.sparseInitializer[d]=l.onnx.SparseTensorProto.fromObject(s.sparseInitializer[d])}}if(s.docString!=null&&(u.docString=String(s.docString)),s.input){if(!Array.isArray(s.input))throw TypeError(".onnx.GraphProto.input: array expected");u.input=[];for(var d=0;d<s.input.length;++d){if(typeof s.input[d]!="object")throw TypeError(".onnx.GraphProto.input: object expected");u.input[d]=l.onnx.ValueInfoProto.fromObject(s.input[d])}}if(s.output){if(!Array.isArray(s.output))throw TypeError(".onnx.GraphProto.output: array expected");u.output=[];for(var d=0;d<s.output.length;++d){if(typeof s.output[d]!="object")throw TypeError(".onnx.GraphProto.output: object expected");u.output[d]=l.onnx.ValueInfoProto.fromObject(s.output[d])}}if(s.valueInfo){if(!Array.isArray(s.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");u.valueInfo=[];for(var d=0;d<s.valueInfo.length;++d){if(typeof s.valueInfo[d]!="object")throw TypeError(".onnx.GraphProto.valueInfo: object expected");u.valueInfo[d]=l.onnx.ValueInfoProto.fromObject(s.valueInfo[d])}}if(s.quantizationAnnotation){if(!Array.isArray(s.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");u.quantizationAnnotation=[];for(var d=0;d<s.quantizationAnnotation.length;++d){if(typeof s.quantizationAnnotation[d]!="object")throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");u.quantizationAnnotation[d]=l.onnx.TensorAnnotation.fromObject(s.quantizationAnnotation[d])}}return u},c.toObject=function(s,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.node=[],d.initializer=[],d.input=[],d.output=[],d.valueInfo=[],d.quantizationAnnotation=[],d.sparseInitializer=[]),u.defaults&&(d.name="",d.docString=""),s.node&&s.node.length){d.node=[];for(var h=0;h<s.node.length;++h)d.node[h]=l.onnx.NodeProto.toObject(s.node[h],u)}if(s.name!=null&&s.hasOwnProperty("name")&&(d.name=s.name),s.initializer&&s.initializer.length){d.initializer=[];for(var h=0;h<s.initializer.length;++h)d.initializer[h]=l.onnx.TensorProto.toObject(s.initializer[h],u)}if(s.docString!=null&&s.hasOwnProperty("docString")&&(d.docString=s.docString),s.input&&s.input.length){d.input=[];for(var h=0;h<s.input.length;++h)d.input[h]=l.onnx.ValueInfoProto.toObject(s.input[h],u)}if(s.output&&s.output.length){d.output=[];for(var h=0;h<s.output.length;++h)d.output[h]=l.onnx.ValueInfoProto.toObject(s.output[h],u)}if(s.valueInfo&&s.valueInfo.length){d.valueInfo=[];for(var h=0;h<s.valueInfo.length;++h)d.valueInfo[h]=l.onnx.ValueInfoProto.toObject(s.valueInfo[h],u)}if(s.quantizationAnnotation&&s.quantizationAnnotation.length){d.quantizationAnnotation=[];for(var h=0;h<s.quantizationAnnotation.length;++h)d.quantizationAnnotation[h]=l.onnx.TensorAnnotation.toObject(s.quantizationAnnotation[h],u)}if(s.sparseInitializer&&s.sparseInitializer.length){d.sparseInitializer=[];for(var h=0;h<s.sparseInitializer.length;++h)d.sparseInitializer[h]=l.onnx.SparseTensorProto.toObject(s.sparseInitializer[h],u)}return d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/onnx.GraphProto"},c}(),a.TensorProto=function(){function c(s){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],s)for(var u=Object.keys(s),d=0;d<u.length;++d)s[u[d]]!=null&&(this[u[d]]=s[u[d]])}return c.prototype.dims=o.emptyArray,c.prototype.dataType=0,c.prototype.segment=null,c.prototype.floatData=o.emptyArray,c.prototype.int32Data=o.emptyArray,c.prototype.stringData=o.emptyArray,c.prototype.int64Data=o.emptyArray,c.prototype.name="",c.prototype.docString="",c.prototype.rawData=o.newBuffer([]),c.prototype.externalData=o.emptyArray,c.prototype.dataLocation=0,c.prototype.doubleData=o.emptyArray,c.prototype.uint64Data=o.emptyArray,c.create=function(s){return new c(s)},c.encode=function(s,u){if(u||(u=i.create()),s.dims!=null&&s.dims.length){u.uint32(10).fork();for(var d=0;d<s.dims.length;++d)u.int64(s.dims[d]);u.ldelim()}if(s.dataType!=null&&Object.hasOwnProperty.call(s,"dataType")&&u.uint32(16).int32(s.dataType),s.segment!=null&&Object.hasOwnProperty.call(s,"segment")&&l.onnx.TensorProto.Segment.encode(s.segment,u.uint32(26).fork()).ldelim(),s.floatData!=null&&s.floatData.length){u.uint32(34).fork();for(var d=0;d<s.floatData.length;++d)u.float(s.floatData[d]);u.ldelim()}if(s.int32Data!=null&&s.int32Data.length){u.uint32(42).fork();for(var d=0;d<s.int32Data.length;++d)u.int32(s.int32Data[d]);u.ldelim()}if(s.stringData!=null&&s.stringData.length)for(var d=0;d<s.stringData.length;++d)u.uint32(50).bytes(s.stringData[d]);if(s.int64Data!=null&&s.int64Data.length){u.uint32(58).fork();for(var d=0;d<s.int64Data.length;++d)u.int64(s.int64Data[d]);u.ldelim()}if(s.name!=null&&Object.hasOwnProperty.call(s,"name")&&u.uint32(66).string(s.name),s.rawData!=null&&Object.hasOwnProperty.call(s,"rawData")&&u.uint32(74).bytes(s.rawData),s.doubleData!=null&&s.doubleData.length){u.uint32(82).fork();for(var d=0;d<s.doubleData.length;++d)u.double(s.doubleData[d]);u.ldelim()}if(s.uint64Data!=null&&s.uint64Data.length){u.uint32(90).fork();for(var d=0;d<s.uint64Data.length;++d)u.uint64(s.uint64Data[d]);u.ldelim()}if(s.docString!=null&&Object.hasOwnProperty.call(s,"docString")&&u.uint32(98).string(s.docString),s.externalData!=null&&s.externalData.length)for(var d=0;d<s.externalData.length;++d)l.onnx.StringStringEntryProto.encode(s.externalData[d],u.uint32(106).fork()).ldelim();return s.dataLocation!=null&&Object.hasOwnProperty.call(s,"dataLocation")&&u.uint32(112).int32(s.dataLocation),u},c.encodeDelimited=function(s,u){return this.encode(s,u).ldelim()},c.decode=function(s,u){s instanceof r||(s=r.create(s));for(var d=u===void 0?s.len:s.pos+u,h=new l.onnx.TensorProto;s.pos<d;){var f=s.uint32();switch(f>>>3){case 1:{if(h.dims&&h.dims.length||(h.dims=[]),(f&7)===2)for(var p=s.uint32()+s.pos;s.pos<p;)h.dims.push(s.int64());else h.dims.push(s.int64());break}case 2:{h.dataType=s.int32();break}case 3:{h.segment=l.onnx.TensorProto.Segment.decode(s,s.uint32());break}case 4:{if(h.floatData&&h.floatData.length||(h.floatData=[]),(f&7)===2)for(var p=s.uint32()+s.pos;s.pos<p;)h.floatData.push(s.float());else h.floatData.push(s.float());break}case 5:{if(h.int32Data&&h.int32Data.length||(h.int32Data=[]),(f&7)===2)for(var p=s.uint32()+s.pos;s.pos<p;)h.int32Data.push(s.int32());else h.int32Data.push(s.int32());break}case 6:{h.stringData&&h.stringData.length||(h.stringData=[]),h.stringData.push(s.bytes());break}case 7:{if(h.int64Data&&h.int64Data.length||(h.int64Data=[]),(f&7)===2)for(var p=s.uint32()+s.pos;s.pos<p;)h.int64Data.push(s.int64());else h.int64Data.push(s.int64());break}case 8:{h.name=s.string();break}case 12:{h.docString=s.string();break}case 9:{h.rawData=s.bytes();break}case 13:{h.externalData&&h.externalData.length||(h.externalData=[]),h.externalData.push(l.onnx.StringStringEntryProto.decode(s,s.uint32()));break}case 14:{h.dataLocation=s.int32();break}case 10:{if(h.doubleData&&h.doubleData.length||(h.doubleData=[]),(f&7)===2)for(var p=s.uint32()+s.pos;s.pos<p;)h.doubleData.push(s.double());else h.doubleData.push(s.double());break}case 11:{if(h.uint64Data&&h.uint64Data.length||(h.uint64Data=[]),(f&7)===2)for(var p=s.uint32()+s.pos;s.pos<p;)h.uint64Data.push(s.uint64());else h.uint64Data.push(s.uint64());break}default:s.skipType(f&7);break}}return h},c.decodeDelimited=function(s){return s instanceof r||(s=new r(s)),this.decode(s,s.uint32())},c.verify=function(s){if(typeof s!="object"||s===null)return"object expected";if(s.dims!=null&&s.hasOwnProperty("dims")){if(!Array.isArray(s.dims))return"dims: array expected";for(var u=0;u<s.dims.length;++u)if(!o.isInteger(s.dims[u])&&!(s.dims[u]&&o.isInteger(s.dims[u].low)&&o.isInteger(s.dims[u].high)))return"dims: integer|Long[] expected"}if(s.dataType!=null&&s.hasOwnProperty("dataType")&&!o.isInteger(s.dataType))return"dataType: integer expected";if(s.segment!=null&&s.hasOwnProperty("segment")){var d=l.onnx.TensorProto.Segment.verify(s.segment);if(d)return"segment."+d}if(s.floatData!=null&&s.hasOwnProperty("floatData")){if(!Array.isArray(s.floatData))return"floatData: array expected";for(var u=0;u<s.floatData.length;++u)if(typeof s.floatData[u]!="number")return"floatData: number[] expected"}if(s.int32Data!=null&&s.hasOwnProperty("int32Data")){if(!Array.isArray(s.int32Data))return"int32Data: array expected";for(var u=0;u<s.int32Data.length;++u)if(!o.isInteger(s.int32Data[u]))return"int32Data: integer[] expected"}if(s.stringData!=null&&s.hasOwnProperty("stringData")){if(!Array.isArray(s.stringData))return"stringData: array expected";for(var u=0;u<s.stringData.length;++u)if(!(s.stringData[u]&&typeof s.stringData[u].length=="number"||o.isString(s.stringData[u])))return"stringData: buffer[] expected"}if(s.int64Data!=null&&s.hasOwnProperty("int64Data")){if(!Array.isArray(s.int64Data))return"int64Data: array expected";for(var u=0;u<s.int64Data.length;++u)if(!o.isInteger(s.int64Data[u])&&!(s.int64Data[u]&&o.isInteger(s.int64Data[u].low)&&o.isInteger(s.int64Data[u].high)))return"int64Data: integer|Long[] expected"}if(s.name!=null&&s.hasOwnProperty("name")&&!o.isString(s.name))return"name: string expected";if(s.docString!=null&&s.hasOwnProperty("docString")&&!o.isString(s.docString))return"docString: string expected";if(s.rawData!=null&&s.hasOwnProperty("rawData")&&!(s.rawData&&typeof s.rawData.length=="number"||o.isString(s.rawData)))return"rawData: buffer expected";if(s.externalData!=null&&s.hasOwnProperty("externalData")){if(!Array.isArray(s.externalData))return"externalData: array expected";for(var u=0;u<s.externalData.length;++u){var d=l.onnx.StringStringEntryProto.verify(s.externalData[u]);if(d)return"externalData."+d}}if(s.dataLocation!=null&&s.hasOwnProperty("dataLocation"))switch(s.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:break}if(s.doubleData!=null&&s.hasOwnProperty("doubleData")){if(!Array.isArray(s.doubleData))return"doubleData: array expected";for(var u=0;u<s.doubleData.length;++u)if(typeof s.doubleData[u]!="number")return"doubleData: number[] expected"}if(s.uint64Data!=null&&s.hasOwnProperty("uint64Data")){if(!Array.isArray(s.uint64Data))return"uint64Data: array expected";for(var u=0;u<s.uint64Data.length;++u)if(!o.isInteger(s.uint64Data[u])&&!(s.uint64Data[u]&&o.isInteger(s.uint64Data[u].low)&&o.isInteger(s.uint64Data[u].high)))return"uint64Data: integer|Long[] expected"}return null},c.fromObject=function(s){if(s instanceof l.onnx.TensorProto)return s;var u=new l.onnx.TensorProto;if(s.dims){if(!Array.isArray(s.dims))throw TypeError(".onnx.TensorProto.dims: array expected");u.dims=[];for(var d=0;d<s.dims.length;++d)o.Long?(u.dims[d]=o.Long.fromValue(s.dims[d])).unsigned=!1:typeof s.dims[d]=="string"?u.dims[d]=parseInt(s.dims[d],10):typeof s.dims[d]=="number"?u.dims[d]=s.dims[d]:typeof s.dims[d]=="object"&&(u.dims[d]=new o.LongBits(s.dims[d].low>>>0,s.dims[d].high>>>0).toNumber())}if(s.dataType!=null&&(u.dataType=s.dataType|0),s.segment!=null){if(typeof s.segment!="object")throw TypeError(".onnx.TensorProto.segment: object expected");u.segment=l.onnx.TensorProto.Segment.fromObject(s.segment)}if(s.floatData){if(!Array.isArray(s.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");u.floatData=[];for(var d=0;d<s.floatData.length;++d)u.floatData[d]=Number(s.floatData[d])}if(s.int32Data){if(!Array.isArray(s.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");u.int32Data=[];for(var d=0;d<s.int32Data.length;++d)u.int32Data[d]=s.int32Data[d]|0}if(s.stringData){if(!Array.isArray(s.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");u.stringData=[];for(var d=0;d<s.stringData.length;++d)typeof s.stringData[d]=="string"?o.base64.decode(s.stringData[d],u.stringData[d]=o.newBuffer(o.base64.length(s.stringData[d])),0):s.stringData[d].length>=0&&(u.stringData[d]=s.stringData[d])}if(s.int64Data){if(!Array.isArray(s.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");u.int64Data=[];for(var d=0;d<s.int64Data.length;++d)o.Long?(u.int64Data[d]=o.Long.fromValue(s.int64Data[d])).unsigned=!1:typeof s.int64Data[d]=="string"?u.int64Data[d]=parseInt(s.int64Data[d],10):typeof s.int64Data[d]=="number"?u.int64Data[d]=s.int64Data[d]:typeof s.int64Data[d]=="object"&&(u.int64Data[d]=new o.LongBits(s.int64Data[d].low>>>0,s.int64Data[d].high>>>0).toNumber())}if(s.name!=null&&(u.name=String(s.name)),s.docString!=null&&(u.docString=String(s.docString)),s.rawData!=null&&(typeof s.rawData=="string"?o.base64.decode(s.rawData,u.rawData=o.newBuffer(o.base64.length(s.rawData)),0):s.rawData.length>=0&&(u.rawData=s.rawData)),s.externalData){if(!Array.isArray(s.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");u.externalData=[];for(var d=0;d<s.externalData.length;++d){if(typeof s.externalData[d]!="object")throw TypeError(".onnx.TensorProto.externalData: object expected");u.externalData[d]=l.onnx.StringStringEntryProto.fromObject(s.externalData[d])}}switch(s.dataLocation){default:if(typeof s.dataLocation=="number"){u.dataLocation=s.dataLocation;break}break;case"DEFAULT":case 0:u.dataLocation=0;break;case"EXTERNAL":case 1:u.dataLocation=1;break}if(s.doubleData){if(!Array.isArray(s.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");u.doubleData=[];for(var d=0;d<s.doubleData.length;++d)u.doubleData[d]=Number(s.doubleData[d])}if(s.uint64Data){if(!Array.isArray(s.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");u.uint64Data=[];for(var d=0;d<s.uint64Data.length;++d)o.Long?(u.uint64Data[d]=o.Long.fromValue(s.uint64Data[d])).unsigned=!0:typeof s.uint64Data[d]=="string"?u.uint64Data[d]=parseInt(s.uint64Data[d],10):typeof s.uint64Data[d]=="number"?u.uint64Data[d]=s.uint64Data[d]:typeof s.uint64Data[d]=="object"&&(u.uint64Data[d]=new o.LongBits(s.uint64Data[d].low>>>0,s.uint64Data[d].high>>>0).toNumber(!0))}return u},c.toObject=function(s,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.dims=[],d.floatData=[],d.int32Data=[],d.stringData=[],d.int64Data=[],d.doubleData=[],d.uint64Data=[],d.externalData=[]),u.defaults&&(d.dataType=0,d.segment=null,d.name="",u.bytes===String?d.rawData="":(d.rawData=[],u.bytes!==Array&&(d.rawData=o.newBuffer(d.rawData))),d.docString="",d.dataLocation=u.enums===String?"DEFAULT":0),s.dims&&s.dims.length){d.dims=[];for(var h=0;h<s.dims.length;++h)typeof s.dims[h]=="number"?d.dims[h]=u.longs===String?String(s.dims[h]):s.dims[h]:d.dims[h]=u.longs===String?o.Long.prototype.toString.call(s.dims[h]):u.longs===Number?new o.LongBits(s.dims[h].low>>>0,s.dims[h].high>>>0).toNumber():s.dims[h]}if(s.dataType!=null&&s.hasOwnProperty("dataType")&&(d.dataType=s.dataType),s.segment!=null&&s.hasOwnProperty("segment")&&(d.segment=l.onnx.TensorProto.Segment.toObject(s.segment,u)),s.floatData&&s.floatData.length){d.floatData=[];for(var h=0;h<s.floatData.length;++h)d.floatData[h]=u.json&&!isFinite(s.floatData[h])?String(s.floatData[h]):s.floatData[h]}if(s.int32Data&&s.int32Data.length){d.int32Data=[];for(var h=0;h<s.int32Data.length;++h)d.int32Data[h]=s.int32Data[h]}if(s.stringData&&s.stringData.length){d.stringData=[];for(var h=0;h<s.stringData.length;++h)d.stringData[h]=u.bytes===String?o.base64.encode(s.stringData[h],0,s.stringData[h].length):u.bytes===Array?Array.prototype.slice.call(s.stringData[h]):s.stringData[h]}if(s.int64Data&&s.int64Data.length){d.int64Data=[];for(var h=0;h<s.int64Data.length;++h)typeof s.int64Data[h]=="number"?d.int64Data[h]=u.longs===String?String(s.int64Data[h]):s.int64Data[h]:d.int64Data[h]=u.longs===String?o.Long.prototype.toString.call(s.int64Data[h]):u.longs===Number?new o.LongBits(s.int64Data[h].low>>>0,s.int64Data[h].high>>>0).toNumber():s.int64Data[h]}if(s.name!=null&&s.hasOwnProperty("name")&&(d.name=s.name),s.rawData!=null&&s.hasOwnProperty("rawData")&&(d.rawData=u.bytes===String?o.base64.encode(s.rawData,0,s.rawData.length):u.bytes===Array?Array.prototype.slice.call(s.rawData):s.rawData),s.doubleData&&s.doubleData.length){d.doubleData=[];for(var h=0;h<s.doubleData.length;++h)d.doubleData[h]=u.json&&!isFinite(s.doubleData[h])?String(s.doubleData[h]):s.doubleData[h]}if(s.uint64Data&&s.uint64Data.length){d.uint64Data=[];for(var h=0;h<s.uint64Data.length;++h)typeof s.uint64Data[h]=="number"?d.uint64Data[h]=u.longs===String?String(s.uint64Data[h]):s.uint64Data[h]:d.uint64Data[h]=u.longs===String?o.Long.prototype.toString.call(s.uint64Data[h]):u.longs===Number?new o.LongBits(s.uint64Data[h].low>>>0,s.uint64Data[h].high>>>0).toNumber(!0):s.uint64Data[h]}if(s.docString!=null&&s.hasOwnProperty("docString")&&(d.docString=s.docString),s.externalData&&s.externalData.length){d.externalData=[];for(var h=0;h<s.externalData.length;++h)d.externalData[h]=l.onnx.StringStringEntryProto.toObject(s.externalData[h],u)}return s.dataLocation!=null&&s.hasOwnProperty("dataLocation")&&(d.dataLocation=u.enums===String?l.onnx.TensorProto.DataLocation[s.dataLocation]===void 0?s.dataLocation:l.onnx.TensorProto.DataLocation[s.dataLocation]:s.dataLocation),d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/onnx.TensorProto"},c.DataType=function(){var s={},u=Object.create(s);return u[s[0]="UNDEFINED"]=0,u[s[1]="FLOAT"]=1,u[s[2]="UINT8"]=2,u[s[3]="INT8"]=3,u[s[4]="UINT16"]=4,u[s[5]="INT16"]=5,u[s[6]="INT32"]=6,u[s[7]="INT64"]=7,u[s[8]="STRING"]=8,u[s[9]="BOOL"]=9,u[s[10]="FLOAT16"]=10,u[s[11]="DOUBLE"]=11,u[s[12]="UINT32"]=12,u[s[13]="UINT64"]=13,u[s[14]="COMPLEX64"]=14,u[s[15]="COMPLEX128"]=15,u[s[16]="BFLOAT16"]=16,u[s[17]="FLOAT8E4M3FN"]=17,u[s[18]="FLOAT8E4M3FNUZ"]=18,u[s[19]="FLOAT8E5M2"]=19,u[s[20]="FLOAT8E5M2FNUZ"]=20,u}(),c.Segment=function(){function s(u){if(u)for(var d=Object.keys(u),h=0;h<d.length;++h)u[d[h]]!=null&&(this[d[h]]=u[d[h]])}return s.prototype.begin=o.Long?o.Long.fromBits(0,0,!1):0,s.prototype.end=o.Long?o.Long.fromBits(0,0,!1):0,s.create=function(u){return new s(u)},s.encode=function(u,d){return d||(d=i.create()),u.begin!=null&&Object.hasOwnProperty.call(u,"begin")&&d.uint32(8).int64(u.begin),u.end!=null&&Object.hasOwnProperty.call(u,"end")&&d.uint32(16).int64(u.end),d},s.encodeDelimited=function(u,d){return this.encode(u,d).ldelim()},s.decode=function(u,d){u instanceof r||(u=r.create(u));for(var h=d===void 0?u.len:u.pos+d,f=new l.onnx.TensorProto.Segment;u.pos<h;){var p=u.uint32();switch(p>>>3){case 1:{f.begin=u.int64();break}case 2:{f.end=u.int64();break}default:u.skipType(p&7);break}}return f},s.decodeDelimited=function(u){return u instanceof r||(u=new r(u)),this.decode(u,u.uint32())},s.verify=function(u){return typeof u!="object"||u===null?"object expected":u.begin!=null&&u.hasOwnProperty("begin")&&!o.isInteger(u.begin)&&!(u.begin&&o.isInteger(u.begin.low)&&o.isInteger(u.begin.high))?"begin: integer|Long expected":u.end!=null&&u.hasOwnProperty("end")&&!o.isInteger(u.end)&&!(u.end&&o.isInteger(u.end.low)&&o.isInteger(u.end.high))?"end: integer|Long expected":null},s.fromObject=function(u){if(u instanceof l.onnx.TensorProto.Segment)return u;var d=new l.onnx.TensorProto.Segment;return u.begin!=null&&(o.Long?(d.begin=o.Long.fromValue(u.begin)).unsigned=!1:typeof u.begin=="string"?d.begin=parseInt(u.begin,10):typeof u.begin=="number"?d.begin=u.begin:typeof u.begin=="object"&&(d.begin=new o.LongBits(u.begin.low>>>0,u.begin.high>>>0).toNumber())),u.end!=null&&(o.Long?(d.end=o.Long.fromValue(u.end)).unsigned=!1:typeof u.end=="string"?d.end=parseInt(u.end,10):typeof u.end=="number"?d.end=u.end:typeof u.end=="object"&&(d.end=new o.LongBits(u.end.low>>>0,u.end.high>>>0).toNumber())),d},s.toObject=function(u,d){d||(d={});var h={};if(d.defaults){if(o.Long){var f=new o.Long(0,0,!1);h.begin=d.longs===String?f.toString():d.longs===Number?f.toNumber():f}else h.begin=d.longs===String?"0":0;if(o.Long){var f=new o.Long(0,0,!1);h.end=d.longs===String?f.toString():d.longs===Number?f.toNumber():f}else h.end=d.longs===String?"0":0}return u.begin!=null&&u.hasOwnProperty("begin")&&(typeof u.begin=="number"?h.begin=d.longs===String?String(u.begin):u.begin:h.begin=d.longs===String?o.Long.prototype.toString.call(u.begin):d.longs===Number?new o.LongBits(u.begin.low>>>0,u.begin.high>>>0).toNumber():u.begin),u.end!=null&&u.hasOwnProperty("end")&&(typeof u.end=="number"?h.end=d.longs===String?String(u.end):u.end:h.end=d.longs===String?o.Long.prototype.toString.call(u.end):d.longs===Number?new o.LongBits(u.end.low>>>0,u.end.high>>>0).toNumber():u.end),h},s.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},s.getTypeUrl=function(u){return u===void 0&&(u="type.googleapis.com"),u+"/onnx.TensorProto.Segment"},s}(),c.DataLocation=function(){var s={},u=Object.create(s);return u[s[0]="DEFAULT"]=0,u[s[1]="EXTERNAL"]=1,u}(),c}(),a.SparseTensorProto=function(){function c(s){if(this.dims=[],s)for(var u=Object.keys(s),d=0;d<u.length;++d)s[u[d]]!=null&&(this[u[d]]=s[u[d]])}return c.prototype.values=null,c.prototype.indices=null,c.prototype.dims=o.emptyArray,c.create=function(s){return new c(s)},c.encode=function(s,u){if(u||(u=i.create()),s.values!=null&&Object.hasOwnProperty.call(s,"values")&&l.onnx.TensorProto.encode(s.values,u.uint32(10).fork()).ldelim(),s.indices!=null&&Object.hasOwnProperty.call(s,"indices")&&l.onnx.TensorProto.encode(s.indices,u.uint32(18).fork()).ldelim(),s.dims!=null&&s.dims.length){u.uint32(26).fork();for(var d=0;d<s.dims.length;++d)u.int64(s.dims[d]);u.ldelim()}return u},c.encodeDelimited=function(s,u){return this.encode(s,u).ldelim()},c.decode=function(s,u){s instanceof r||(s=r.create(s));for(var d=u===void 0?s.len:s.pos+u,h=new l.onnx.SparseTensorProto;s.pos<d;){var f=s.uint32();switch(f>>>3){case 1:{h.values=l.onnx.TensorProto.decode(s,s.uint32());break}case 2:{h.indices=l.onnx.TensorProto.decode(s,s.uint32());break}case 3:{if(h.dims&&h.dims.length||(h.dims=[]),(f&7)===2)for(var p=s.uint32()+s.pos;s.pos<p;)h.dims.push(s.int64());else h.dims.push(s.int64());break}default:s.skipType(f&7);break}}return h},c.decodeDelimited=function(s){return s instanceof r||(s=new r(s)),this.decode(s,s.uint32())},c.verify=function(s){if(typeof s!="object"||s===null)return"object expected";if(s.values!=null&&s.hasOwnProperty("values")){var u=l.onnx.TensorProto.verify(s.values);if(u)return"values."+u}if(s.indices!=null&&s.hasOwnProperty("indices")){var u=l.onnx.TensorProto.verify(s.indices);if(u)return"indices."+u}if(s.dims!=null&&s.hasOwnProperty("dims")){if(!Array.isArray(s.dims))return"dims: array expected";for(var d=0;d<s.dims.length;++d)if(!o.isInteger(s.dims[d])&&!(s.dims[d]&&o.isInteger(s.dims[d].low)&&o.isInteger(s.dims[d].high)))return"dims: integer|Long[] expected"}return null},c.fromObject=function(s){if(s instanceof l.onnx.SparseTensorProto)return s;var u=new l.onnx.SparseTensorProto;if(s.values!=null){if(typeof s.values!="object")throw TypeError(".onnx.SparseTensorProto.values: object expected");u.values=l.onnx.TensorProto.fromObject(s.values)}if(s.indices!=null){if(typeof s.indices!="object")throw TypeError(".onnx.SparseTensorProto.indices: object expected");u.indices=l.onnx.TensorProto.fromObject(s.indices)}if(s.dims){if(!Array.isArray(s.dims))throw TypeError(".onnx.SparseTensorProto.dims: array expected");u.dims=[];for(var d=0;d<s.dims.length;++d)o.Long?(u.dims[d]=o.Long.fromValue(s.dims[d])).unsigned=!1:typeof s.dims[d]=="string"?u.dims[d]=parseInt(s.dims[d],10):typeof s.dims[d]=="number"?u.dims[d]=s.dims[d]:typeof s.dims[d]=="object"&&(u.dims[d]=new o.LongBits(s.dims[d].low>>>0,s.dims[d].high>>>0).toNumber())}return u},c.toObject=function(s,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.dims=[]),u.defaults&&(d.values=null,d.indices=null),s.values!=null&&s.hasOwnProperty("values")&&(d.values=l.onnx.TensorProto.toObject(s.values,u)),s.indices!=null&&s.hasOwnProperty("indices")&&(d.indices=l.onnx.TensorProto.toObject(s.indices,u)),s.dims&&s.dims.length){d.dims=[];for(var h=0;h<s.dims.length;++h)typeof s.dims[h]=="number"?d.dims[h]=u.longs===String?String(s.dims[h]):s.dims[h]:d.dims[h]=u.longs===String?o.Long.prototype.toString.call(s.dims[h]):u.longs===Number?new o.LongBits(s.dims[h].low>>>0,s.dims[h].high>>>0).toNumber():s.dims[h]}return d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/onnx.SparseTensorProto"},c}(),a.TensorShapeProto=function(){function c(s){if(this.dim=[],s)for(var u=Object.keys(s),d=0;d<u.length;++d)s[u[d]]!=null&&(this[u[d]]=s[u[d]])}return c.prototype.dim=o.emptyArray,c.create=function(s){return new c(s)},c.encode=function(s,u){if(u||(u=i.create()),s.dim!=null&&s.dim.length)for(var d=0;d<s.dim.length;++d)l.onnx.TensorShapeProto.Dimension.encode(s.dim[d],u.uint32(10).fork()).ldelim();return u},c.encodeDelimited=function(s,u){return this.encode(s,u).ldelim()},c.decode=function(s,u){s instanceof r||(s=r.create(s));for(var d=u===void 0?s.len:s.pos+u,h=new l.onnx.TensorShapeProto;s.pos<d;){var f=s.uint32();switch(f>>>3){case 1:{h.dim&&h.dim.length||(h.dim=[]),h.dim.push(l.onnx.TensorShapeProto.Dimension.decode(s,s.uint32()));break}default:s.skipType(f&7);break}}return h},c.decodeDelimited=function(s){return s instanceof r||(s=new r(s)),this.decode(s,s.uint32())},c.verify=function(s){if(typeof s!="object"||s===null)return"object expected";if(s.dim!=null&&s.hasOwnProperty("dim")){if(!Array.isArray(s.dim))return"dim: array expected";for(var u=0;u<s.dim.length;++u){var d=l.onnx.TensorShapeProto.Dimension.verify(s.dim[u]);if(d)return"dim."+d}}return null},c.fromObject=function(s){if(s instanceof l.onnx.TensorShapeProto)return s;var u=new l.onnx.TensorShapeProto;if(s.dim){if(!Array.isArray(s.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");u.dim=[];for(var d=0;d<s.dim.length;++d){if(typeof s.dim[d]!="object")throw TypeError(".onnx.TensorShapeProto.dim: object expected");u.dim[d]=l.onnx.TensorShapeProto.Dimension.fromObject(s.dim[d])}}return u},c.toObject=function(s,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.dim=[]),s.dim&&s.dim.length){d.dim=[];for(var h=0;h<s.dim.length;++h)d.dim[h]=l.onnx.TensorShapeProto.Dimension.toObject(s.dim[h],u)}return d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/onnx.TensorShapeProto"},c.Dimension=function(){function s(d){if(d)for(var h=Object.keys(d),f=0;f<h.length;++f)d[h[f]]!=null&&(this[h[f]]=d[h[f]])}s.prototype.dimValue=null,s.prototype.dimParam=null,s.prototype.denotation="";var u;return Object.defineProperty(s.prototype,"value",{get:o.oneOfGetter(u=["dimValue","dimParam"]),set:o.oneOfSetter(u)}),s.create=function(d){return new s(d)},s.encode=function(d,h){return h||(h=i.create()),d.dimValue!=null&&Object.hasOwnProperty.call(d,"dimValue")&&h.uint32(8).int64(d.dimValue),d.dimParam!=null&&Object.hasOwnProperty.call(d,"dimParam")&&h.uint32(18).string(d.dimParam),d.denotation!=null&&Object.hasOwnProperty.call(d,"denotation")&&h.uint32(26).string(d.denotation),h},s.encodeDelimited=function(d,h){return this.encode(d,h).ldelim()},s.decode=function(d,h){d instanceof r||(d=r.create(d));for(var f=h===void 0?d.len:d.pos+h,p=new l.onnx.TensorShapeProto.Dimension;d.pos<f;){var g=d.uint32();switch(g>>>3){case 1:{p.dimValue=d.int64();break}case 2:{p.dimParam=d.string();break}case 3:{p.denotation=d.string();break}default:d.skipType(g&7);break}}return p},s.decodeDelimited=function(d){return d instanceof r||(d=new r(d)),this.decode(d,d.uint32())},s.verify=function(d){if(typeof d!="object"||d===null)return"object expected";var h={};if(d.dimValue!=null&&d.hasOwnProperty("dimValue")&&(h.value=1,!o.isInteger(d.dimValue)&&!(d.dimValue&&o.isInteger(d.dimValue.low)&&o.isInteger(d.dimValue.high))))return"dimValue: integer|Long expected";if(d.dimParam!=null&&d.hasOwnProperty("dimParam")){if(h.value===1)return"value: multiple values";if(h.value=1,!o.isString(d.dimParam))return"dimParam: string expected"}return d.denotation!=null&&d.hasOwnProperty("denotation")&&!o.isString(d.denotation)?"denotation: string expected":null},s.fromObject=function(d){if(d instanceof l.onnx.TensorShapeProto.Dimension)return d;var h=new l.onnx.TensorShapeProto.Dimension;return d.dimValue!=null&&(o.Long?(h.dimValue=o.Long.fromValue(d.dimValue)).unsigned=!1:typeof d.dimValue=="string"?h.dimValue=parseInt(d.dimValue,10):typeof d.dimValue=="number"?h.dimValue=d.dimValue:typeof d.dimValue=="object"&&(h.dimValue=new o.LongBits(d.dimValue.low>>>0,d.dimValue.high>>>0).toNumber())),d.dimParam!=null&&(h.dimParam=String(d.dimParam)),d.denotation!=null&&(h.denotation=String(d.denotation)),h},s.toObject=function(d,h){h||(h={});var f={};return h.defaults&&(f.denotation=""),d.dimValue!=null&&d.hasOwnProperty("dimValue")&&(typeof d.dimValue=="number"?f.dimValue=h.longs===String?String(d.dimValue):d.dimValue:f.dimValue=h.longs===String?o.Long.prototype.toString.call(d.dimValue):h.longs===Number?new o.LongBits(d.dimValue.low>>>0,d.dimValue.high>>>0).toNumber():d.dimValue,h.oneofs&&(f.value="dimValue")),d.dimParam!=null&&d.hasOwnProperty("dimParam")&&(f.dimParam=d.dimParam,h.oneofs&&(f.value="dimParam")),d.denotation!=null&&d.hasOwnProperty("denotation")&&(f.denotation=d.denotation),f},s.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},s.getTypeUrl=function(d){return d===void 0&&(d="type.googleapis.com"),d+"/onnx.TensorShapeProto.Dimension"},s}(),c}(),a.TypeProto=function(){function c(u){if(u)for(var d=Object.keys(u),h=0;h<d.length;++h)u[d[h]]!=null&&(this[d[h]]=u[d[h]])}c.prototype.tensorType=null,c.prototype.sequenceType=null,c.prototype.mapType=null,c.prototype.optionalType=null,c.prototype.sparseTensorType=null,c.prototype.denotation="";var s;return Object.defineProperty(c.prototype,"value",{get:o.oneOfGetter(s=["tensorType","sequenceType","mapType","optionalType","sparseTensorType"]),set:o.oneOfSetter(s)}),c.create=function(u){return new c(u)},c.encode=function(u,d){return d||(d=i.create()),u.tensorType!=null&&Object.hasOwnProperty.call(u,"tensorType")&&l.onnx.TypeProto.Tensor.encode(u.tensorType,d.uint32(10).fork()).ldelim(),u.sequenceType!=null&&Object.hasOwnProperty.call(u,"sequenceType")&&l.onnx.TypeProto.Sequence.encode(u.sequenceType,d.uint32(34).fork()).ldelim(),u.mapType!=null&&Object.hasOwnProperty.call(u,"mapType")&&l.onnx.TypeProto.Map.encode(u.mapType,d.uint32(42).fork()).ldelim(),u.denotation!=null&&Object.hasOwnProperty.call(u,"denotation")&&d.uint32(50).string(u.denotation),u.sparseTensorType!=null&&Object.hasOwnProperty.call(u,"sparseTensorType")&&l.onnx.TypeProto.SparseTensor.encode(u.sparseTensorType,d.uint32(66).fork()).ldelim(),u.optionalType!=null&&Object.hasOwnProperty.call(u,"optionalType")&&l.onnx.TypeProto.Optional.encode(u.optionalType,d.uint32(74).fork()).ldelim(),d},c.encodeDelimited=function(u,d){return this.encode(u,d).ldelim()},c.decode=function(u,d){u instanceof r||(u=r.create(u));for(var h=d===void 0?u.len:u.pos+d,f=new l.onnx.TypeProto;u.pos<h;){var p=u.uint32();switch(p>>>3){case 1:{f.tensorType=l.onnx.TypeProto.Tensor.decode(u,u.uint32());break}case 4:{f.sequenceType=l.onnx.TypeProto.Sequence.decode(u,u.uint32());break}case 5:{f.mapType=l.onnx.TypeProto.Map.decode(u,u.uint32());break}case 9:{f.optionalType=l.onnx.TypeProto.Optional.decode(u,u.uint32());break}case 8:{f.sparseTensorType=l.onnx.TypeProto.SparseTensor.decode(u,u.uint32());break}case 6:{f.denotation=u.string();break}default:u.skipType(p&7);break}}return f},c.decodeDelimited=function(u){return u instanceof r||(u=new r(u)),this.decode(u,u.uint32())},c.verify=function(u){if(typeof u!="object"||u===null)return"object expected";var d={};if(u.tensorType!=null&&u.hasOwnProperty("tensorType")){d.value=1;{var h=l.onnx.TypeProto.Tensor.verify(u.tensorType);if(h)return"tensorType."+h}}if(u.sequenceType!=null&&u.hasOwnProperty("sequenceType")){if(d.value===1)return"value: multiple values";d.value=1;{var h=l.onnx.TypeProto.Sequence.verify(u.sequenceType);if(h)return"sequenceType."+h}}if(u.mapType!=null&&u.hasOwnProperty("mapType")){if(d.value===1)return"value: multiple values";d.value=1;{var h=l.onnx.TypeProto.Map.verify(u.mapType);if(h)return"mapType."+h}}if(u.optionalType!=null&&u.hasOwnProperty("optionalType")){if(d.value===1)return"value: multiple values";d.value=1;{var h=l.onnx.TypeProto.Optional.verify(u.optionalType);if(h)return"optionalType."+h}}if(u.sparseTensorType!=null&&u.hasOwnProperty("sparseTensorType")){if(d.value===1)return"value: multiple values";d.value=1;{var h=l.onnx.TypeProto.SparseTensor.verify(u.sparseTensorType);if(h)return"sparseTensorType."+h}}return u.denotation!=null&&u.hasOwnProperty("denotation")&&!o.isString(u.denotation)?"denotation: string expected":null},c.fromObject=function(u){if(u instanceof l.onnx.TypeProto)return u;var d=new l.onnx.TypeProto;if(u.tensorType!=null){if(typeof u.tensorType!="object")throw TypeError(".onnx.TypeProto.tensorType: object expected");d.tensorType=l.onnx.TypeProto.Tensor.fromObject(u.tensorType)}if(u.sequenceType!=null){if(typeof u.sequenceType!="object")throw TypeError(".onnx.TypeProto.sequenceType: object expected");d.sequenceType=l.onnx.TypeProto.Sequence.fromObject(u.sequenceType)}if(u.mapType!=null){if(typeof u.mapType!="object")throw TypeError(".onnx.TypeProto.mapType: object expected");d.mapType=l.onnx.TypeProto.Map.fromObject(u.mapType)}if(u.optionalType!=null){if(typeof u.optionalType!="object")throw TypeError(".onnx.TypeProto.optionalType: object expected");d.optionalType=l.onnx.TypeProto.Optional.fromObject(u.optionalType)}if(u.sparseTensorType!=null){if(typeof u.sparseTensorType!="object")throw TypeError(".onnx.TypeProto.sparseTensorType: object expected");d.sparseTensorType=l.onnx.TypeProto.SparseTensor.fromObject(u.sparseTensorType)}return u.denotation!=null&&(d.denotation=String(u.denotation)),d},c.toObject=function(u,d){d||(d={});var h={};return d.defaults&&(h.denotation=""),u.tensorType!=null&&u.hasOwnProperty("tensorType")&&(h.tensorType=l.onnx.TypeProto.Tensor.toObject(u.tensorType,d),d.oneofs&&(h.value="tensorType")),u.sequenceType!=null&&u.hasOwnProperty("sequenceType")&&(h.sequenceType=l.onnx.TypeProto.Sequence.toObject(u.sequenceType,d),d.oneofs&&(h.value="sequenceType")),u.mapType!=null&&u.hasOwnProperty("mapType")&&(h.mapType=l.onnx.TypeProto.Map.toObject(u.mapType,d),d.oneofs&&(h.value="mapType")),u.denotation!=null&&u.hasOwnProperty("denotation")&&(h.denotation=u.denotation),u.sparseTensorType!=null&&u.hasOwnProperty("sparseTensorType")&&(h.sparseTensorType=l.onnx.TypeProto.SparseTensor.toObject(u.sparseTensorType,d),d.oneofs&&(h.value="sparseTensorType")),u.optionalType!=null&&u.hasOwnProperty("optionalType")&&(h.optionalType=l.onnx.TypeProto.Optional.toObject(u.optionalType,d),d.oneofs&&(h.value="optionalType")),h},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(u){return u===void 0&&(u="type.googleapis.com"),u+"/onnx.TypeProto"},c.Tensor=function(){function u(d){if(d)for(var h=Object.keys(d),f=0;f<h.length;++f)d[h[f]]!=null&&(this[h[f]]=d[h[f]])}return u.prototype.elemType=0,u.prototype.shape=null,u.create=function(d){return new u(d)},u.encode=function(d,h){return h||(h=i.create()),d.elemType!=null&&Object.hasOwnProperty.call(d,"elemType")&&h.uint32(8).int32(d.elemType),d.shape!=null&&Object.hasOwnProperty.call(d,"shape")&&l.onnx.TensorShapeProto.encode(d.shape,h.uint32(18).fork()).ldelim(),h},u.encodeDelimited=function(d,h){return this.encode(d,h).ldelim()},u.decode=function(d,h){d instanceof r||(d=r.create(d));for(var f=h===void 0?d.len:d.pos+h,p=new l.onnx.TypeProto.Tensor;d.pos<f;){var g=d.uint32();switch(g>>>3){case 1:{p.elemType=d.int32();break}case 2:{p.shape=l.onnx.TensorShapeProto.decode(d,d.uint32());break}default:d.skipType(g&7);break}}return p},u.decodeDelimited=function(d){return d instanceof r||(d=new r(d)),this.decode(d,d.uint32())},u.verify=function(d){if(typeof d!="object"||d===null)return"object expected";if(d.elemType!=null&&d.hasOwnProperty("elemType")&&!o.isInteger(d.elemType))return"elemType: integer expected";if(d.shape!=null&&d.hasOwnProperty("shape")){var h=l.onnx.TensorShapeProto.verify(d.shape);if(h)return"shape."+h}return null},u.fromObject=function(d){if(d instanceof l.onnx.TypeProto.Tensor)return d;var h=new l.onnx.TypeProto.Tensor;if(d.elemType!=null&&(h.elemType=d.elemType|0),d.shape!=null){if(typeof d.shape!="object")throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");h.shape=l.onnx.TensorShapeProto.fromObject(d.shape)}return h},u.toObject=function(d,h){h||(h={});var f={};return h.defaults&&(f.elemType=0,f.shape=null),d.elemType!=null&&d.hasOwnProperty("elemType")&&(f.elemType=d.elemType),d.shape!=null&&d.hasOwnProperty("shape")&&(f.shape=l.onnx.TensorShapeProto.toObject(d.shape,h)),f},u.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},u.getTypeUrl=function(d){return d===void 0&&(d="type.googleapis.com"),d+"/onnx.TypeProto.Tensor"},u}(),c.Sequence=function(){function u(d){if(d)for(var h=Object.keys(d),f=0;f<h.length;++f)d[h[f]]!=null&&(this[h[f]]=d[h[f]])}return u.prototype.elemType=null,u.create=function(d){return new u(d)},u.encode=function(d,h){return h||(h=i.create()),d.elemType!=null&&Object.hasOwnProperty.call(d,"elemType")&&l.onnx.TypeProto.encode(d.elemType,h.uint32(10).fork()).ldelim(),h},u.encodeDelimited=function(d,h){return this.encode(d,h).ldelim()},u.decode=function(d,h){d instanceof r||(d=r.create(d));for(var f=h===void 0?d.len:d.pos+h,p=new l.onnx.TypeProto.Sequence;d.pos<f;){var g=d.uint32();switch(g>>>3){case 1:{p.elemType=l.onnx.TypeProto.decode(d,d.uint32());break}default:d.skipType(g&7);break}}return p},u.decodeDelimited=function(d){return d instanceof r||(d=new r(d)),this.decode(d,d.uint32())},u.verify=function(d){if(typeof d!="object"||d===null)return"object expected";if(d.elemType!=null&&d.hasOwnProperty("elemType")){var h=l.onnx.TypeProto.verify(d.elemType);if(h)return"elemType."+h}return null},u.fromObject=function(d){if(d instanceof l.onnx.TypeProto.Sequence)return d;var h=new l.onnx.TypeProto.Sequence;if(d.elemType!=null){if(typeof d.elemType!="object")throw TypeError(".onnx.TypeProto.Sequence.elemType: object expected");h.elemType=l.onnx.TypeProto.fromObject(d.elemType)}return h},u.toObject=function(d,h){h||(h={});var f={};return h.defaults&&(f.elemType=null),d.elemType!=null&&d.hasOwnProperty("elemType")&&(f.elemType=l.onnx.TypeProto.toObject(d.elemType,h)),f},u.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},u.getTypeUrl=function(d){return d===void 0&&(d="type.googleapis.com"),d+"/onnx.TypeProto.Sequence"},u}(),c.Map=function(){function u(d){if(d)for(var h=Object.keys(d),f=0;f<h.length;++f)d[h[f]]!=null&&(this[h[f]]=d[h[f]])}return u.prototype.keyType=0,u.prototype.valueType=null,u.create=function(d){return new u(d)},u.encode=function(d,h){return h||(h=i.create()),d.keyType!=null&&Object.hasOwnProperty.call(d,"keyType")&&h.uint32(8).int32(d.keyType),d.valueType!=null&&Object.hasOwnProperty.call(d,"valueType")&&l.onnx.TypeProto.encode(d.valueType,h.uint32(18).fork()).ldelim(),h},u.encodeDelimited=function(d,h){return this.encode(d,h).ldelim()},u.decode=function(d,h){d instanceof r||(d=r.create(d));for(var f=h===void 0?d.len:d.pos+h,p=new l.onnx.TypeProto.Map;d.pos<f;){var g=d.uint32();switch(g>>>3){case 1:{p.keyType=d.int32();break}case 2:{p.valueType=l.onnx.TypeProto.decode(d,d.uint32());break}default:d.skipType(g&7);break}}return p},u.decodeDelimited=function(d){return d instanceof r||(d=new r(d)),this.decode(d,d.uint32())},u.verify=function(d){if(typeof d!="object"||d===null)return"object expected";if(d.keyType!=null&&d.hasOwnProperty("keyType")&&!o.isInteger(d.keyType))return"keyType: integer expected";if(d.valueType!=null&&d.hasOwnProperty("valueType")){var h=l.onnx.TypeProto.verify(d.valueType);if(h)return"valueType."+h}return null},u.fromObject=function(d){if(d instanceof l.onnx.TypeProto.Map)return d;var h=new l.onnx.TypeProto.Map;if(d.keyType!=null&&(h.keyType=d.keyType|0),d.valueType!=null){if(typeof d.valueType!="object")throw TypeError(".onnx.TypeProto.Map.valueType: object expected");h.valueType=l.onnx.TypeProto.fromObject(d.valueType)}return h},u.toObject=function(d,h){h||(h={});var f={};return h.defaults&&(f.keyType=0,f.valueType=null),d.keyType!=null&&d.hasOwnProperty("keyType")&&(f.keyType=d.keyType),d.valueType!=null&&d.hasOwnProperty("valueType")&&(f.valueType=l.onnx.TypeProto.toObject(d.valueType,h)),f},u.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},u.getTypeUrl=function(d){return d===void 0&&(d="type.googleapis.com"),d+"/onnx.TypeProto.Map"},u}(),c.Optional=function(){function u(d){if(d)for(var h=Object.keys(d),f=0;f<h.length;++f)d[h[f]]!=null&&(this[h[f]]=d[h[f]])}return u.prototype.elemType=null,u.create=function(d){return new u(d)},u.encode=function(d,h){return h||(h=i.create()),d.elemType!=null&&Object.hasOwnProperty.call(d,"elemType")&&l.onnx.TypeProto.encode(d.elemType,h.uint32(10).fork()).ldelim(),h},u.encodeDelimited=function(d,h){return this.encode(d,h).ldelim()},u.decode=function(d,h){d instanceof r||(d=r.create(d));for(var f=h===void 0?d.len:d.pos+h,p=new l.onnx.TypeProto.Optional;d.pos<f;){var g=d.uint32();switch(g>>>3){case 1:{p.elemType=l.onnx.TypeProto.decode(d,d.uint32());break}default:d.skipType(g&7);break}}return p},u.decodeDelimited=function(d){return d instanceof r||(d=new r(d)),this.decode(d,d.uint32())},u.verify=function(d){if(typeof d!="object"||d===null)return"object expected";if(d.elemType!=null&&d.hasOwnProperty("elemType")){var h=l.onnx.TypeProto.verify(d.elemType);if(h)return"elemType."+h}return null},u.fromObject=function(d){if(d instanceof l.onnx.TypeProto.Optional)return d;var h=new l.onnx.TypeProto.Optional;if(d.elemType!=null){if(typeof d.elemType!="object")throw TypeError(".onnx.TypeProto.Optional.elemType: object expected");h.elemType=l.onnx.TypeProto.fromObject(d.elemType)}return h},u.toObject=function(d,h){h||(h={});var f={};return h.defaults&&(f.elemType=null),d.elemType!=null&&d.hasOwnProperty("elemType")&&(f.elemType=l.onnx.TypeProto.toObject(d.elemType,h)),f},u.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},u.getTypeUrl=function(d){return d===void 0&&(d="type.googleapis.com"),d+"/onnx.TypeProto.Optional"},u}(),c.SparseTensor=function(){function u(d){if(d)for(var h=Object.keys(d),f=0;f<h.length;++f)d[h[f]]!=null&&(this[h[f]]=d[h[f]])}return u.prototype.elemType=0,u.prototype.shape=null,u.create=function(d){return new u(d)},u.encode=function(d,h){return h||(h=i.create()),d.elemType!=null&&Object.hasOwnProperty.call(d,"elemType")&&h.uint32(8).int32(d.elemType),d.shape!=null&&Object.hasOwnProperty.call(d,"shape")&&l.onnx.TensorShapeProto.encode(d.shape,h.uint32(18).fork()).ldelim(),h},u.encodeDelimited=function(d,h){return this.encode(d,h).ldelim()},u.decode=function(d,h){d instanceof r||(d=r.create(d));for(var f=h===void 0?d.len:d.pos+h,p=new l.onnx.TypeProto.SparseTensor;d.pos<f;){var g=d.uint32();switch(g>>>3){case 1:{p.elemType=d.int32();break}case 2:{p.shape=l.onnx.TensorShapeProto.decode(d,d.uint32());break}default:d.skipType(g&7);break}}return p},u.decodeDelimited=function(d){return d instanceof r||(d=new r(d)),this.decode(d,d.uint32())},u.verify=function(d){if(typeof d!="object"||d===null)return"object expected";if(d.elemType!=null&&d.hasOwnProperty("elemType")&&!o.isInteger(d.elemType))return"elemType: integer expected";if(d.shape!=null&&d.hasOwnProperty("shape")){var h=l.onnx.TensorShapeProto.verify(d.shape);if(h)return"shape."+h}return null},u.fromObject=function(d){if(d instanceof l.onnx.TypeProto.SparseTensor)return d;var h=new l.onnx.TypeProto.SparseTensor;if(d.elemType!=null&&(h.elemType=d.elemType|0),d.shape!=null){if(typeof d.shape!="object")throw TypeError(".onnx.TypeProto.SparseTensor.shape: object expected");h.shape=l.onnx.TensorShapeProto.fromObject(d.shape)}return h},u.toObject=function(d,h){h||(h={});var f={};return h.defaults&&(f.elemType=0,f.shape=null),d.elemType!=null&&d.hasOwnProperty("elemType")&&(f.elemType=d.elemType),d.shape!=null&&d.hasOwnProperty("shape")&&(f.shape=l.onnx.TensorShapeProto.toObject(d.shape,h)),f},u.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},u.getTypeUrl=function(d){return d===void 0&&(d="type.googleapis.com"),d+"/onnx.TypeProto.SparseTensor"},u}(),c}(),a.OperatorSetIdProto=function(){function c(s){if(s)for(var u=Object.keys(s),d=0;d<u.length;++d)s[u[d]]!=null&&(this[u[d]]=s[u[d]])}return c.prototype.domain="",c.prototype.version=o.Long?o.Long.fromBits(0,0,!1):0,c.create=function(s){return new c(s)},c.encode=function(s,u){return u||(u=i.create()),s.domain!=null&&Object.hasOwnProperty.call(s,"domain")&&u.uint32(10).string(s.domain),s.version!=null&&Object.hasOwnProperty.call(s,"version")&&u.uint32(16).int64(s.version),u},c.encodeDelimited=function(s,u){return this.encode(s,u).ldelim()},c.decode=function(s,u){s instanceof r||(s=r.create(s));for(var d=u===void 0?s.len:s.pos+u,h=new l.onnx.OperatorSetIdProto;s.pos<d;){var f=s.uint32();switch(f>>>3){case 1:{h.domain=s.string();break}case 2:{h.version=s.int64();break}default:s.skipType(f&7);break}}return h},c.decodeDelimited=function(s){return s instanceof r||(s=new r(s)),this.decode(s,s.uint32())},c.verify=function(s){return typeof s!="object"||s===null?"object expected":s.domain!=null&&s.hasOwnProperty("domain")&&!o.isString(s.domain)?"domain: string expected":s.version!=null&&s.hasOwnProperty("version")&&!o.isInteger(s.version)&&!(s.version&&o.isInteger(s.version.low)&&o.isInteger(s.version.high))?"version: integer|Long expected":null},c.fromObject=function(s){if(s instanceof l.onnx.OperatorSetIdProto)return s;var u=new l.onnx.OperatorSetIdProto;return s.domain!=null&&(u.domain=String(s.domain)),s.version!=null&&(o.Long?(u.version=o.Long.fromValue(s.version)).unsigned=!1:typeof s.version=="string"?u.version=parseInt(s.version,10):typeof s.version=="number"?u.version=s.version:typeof s.version=="object"&&(u.version=new o.LongBits(s.version.low>>>0,s.version.high>>>0).toNumber())),u},c.toObject=function(s,u){u||(u={});var d={};if(u.defaults)if(d.domain="",o.Long){var h=new o.Long(0,0,!1);d.version=u.longs===String?h.toString():u.longs===Number?h.toNumber():h}else d.version=u.longs===String?"0":0;return s.domain!=null&&s.hasOwnProperty("domain")&&(d.domain=s.domain),s.version!=null&&s.hasOwnProperty("version")&&(typeof s.version=="number"?d.version=u.longs===String?String(s.version):s.version:d.version=u.longs===String?o.Long.prototype.toString.call(s.version):u.longs===Number?new o.LongBits(s.version.low>>>0,s.version.high>>>0).toNumber():s.version),d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/onnx.OperatorSetIdProto"},c}(),a.OperatorStatus=function(){var c={},s=Object.create(c);return s[c[0]="EXPERIMENTAL"]=0,s[c[1]="STABLE"]=1,s}(),a.FunctionProto=function(){function c(s){if(this.input=[],this.output=[],this.attribute=[],this.attributeProto=[],this.node=[],this.opsetImport=[],s)for(var u=Object.keys(s),d=0;d<u.length;++d)s[u[d]]!=null&&(this[u[d]]=s[u[d]])}return c.prototype.name="",c.prototype.input=o.emptyArray,c.prototype.output=o.emptyArray,c.prototype.attribute=o.emptyArray,c.prototype.attributeProto=o.emptyArray,c.prototype.node=o.emptyArray,c.prototype.docString="",c.prototype.opsetImport=o.emptyArray,c.prototype.domain="",c.create=function(s){return new c(s)},c.encode=function(s,u){if(u||(u=i.create()),s.name!=null&&Object.hasOwnProperty.call(s,"name")&&u.uint32(10).string(s.name),s.input!=null&&s.input.length)for(var d=0;d<s.input.length;++d)u.uint32(34).string(s.input[d]);if(s.output!=null&&s.output.length)for(var d=0;d<s.output.length;++d)u.uint32(42).string(s.output[d]);if(s.attribute!=null&&s.attribute.length)for(var d=0;d<s.attribute.length;++d)u.uint32(50).string(s.attribute[d]);if(s.node!=null&&s.node.length)for(var d=0;d<s.node.length;++d)l.onnx.NodeProto.encode(s.node[d],u.uint32(58).fork()).ldelim();if(s.docString!=null&&Object.hasOwnProperty.call(s,"docString")&&u.uint32(66).string(s.docString),s.opsetImport!=null&&s.opsetImport.length)for(var d=0;d<s.opsetImport.length;++d)l.onnx.OperatorSetIdProto.encode(s.opsetImport[d],u.uint32(74).fork()).ldelim();if(s.domain!=null&&Object.hasOwnProperty.call(s,"domain")&&u.uint32(82).string(s.domain),s.attributeProto!=null&&s.attributeProto.length)for(var d=0;d<s.attributeProto.length;++d)l.onnx.AttributeProto.encode(s.attributeProto[d],u.uint32(90).fork()).ldelim();return u},c.encodeDelimited=function(s,u){return this.encode(s,u).ldelim()},c.decode=function(s,u){s instanceof r||(s=r.create(s));for(var d=u===void 0?s.len:s.pos+u,h=new l.onnx.FunctionProto;s.pos<d;){var f=s.uint32();switch(f>>>3){case 1:{h.name=s.string();break}case 4:{h.input&&h.input.length||(h.input=[]),h.input.push(s.string());break}case 5:{h.output&&h.output.length||(h.output=[]),h.output.push(s.string());break}case 6:{h.attribute&&h.attribute.length||(h.attribute=[]),h.attribute.push(s.string());break}case 11:{h.attributeProto&&h.attributeProto.length||(h.attributeProto=[]),h.attributeProto.push(l.onnx.AttributeProto.decode(s,s.uint32()));break}case 7:{h.node&&h.node.length||(h.node=[]),h.node.push(l.onnx.NodeProto.decode(s,s.uint32()));break}case 8:{h.docString=s.string();break}case 9:{h.opsetImport&&h.opsetImport.length||(h.opsetImport=[]),h.opsetImport.push(l.onnx.OperatorSetIdProto.decode(s,s.uint32()));break}case 10:{h.domain=s.string();break}default:s.skipType(f&7);break}}return h},c.decodeDelimited=function(s){return s instanceof r||(s=new r(s)),this.decode(s,s.uint32())},c.verify=function(s){if(typeof s!="object"||s===null)return"object expected";if(s.name!=null&&s.hasOwnProperty("name")&&!o.isString(s.name))return"name: string expected";if(s.input!=null&&s.hasOwnProperty("input")){if(!Array.isArray(s.input))return"input: array expected";for(var u=0;u<s.input.length;++u)if(!o.isString(s.input[u]))return"input: string[] expected"}if(s.output!=null&&s.hasOwnProperty("output")){if(!Array.isArray(s.output))return"output: array expected";for(var u=0;u<s.output.length;++u)if(!o.isString(s.output[u]))return"output: string[] expected"}if(s.attribute!=null&&s.hasOwnProperty("attribute")){if(!Array.isArray(s.attribute))return"attribute: array expected";for(var u=0;u<s.attribute.length;++u)if(!o.isString(s.attribute[u]))return"attribute: string[] expected"}if(s.attributeProto!=null&&s.hasOwnProperty("attributeProto")){if(!Array.isArray(s.attributeProto))return"attributeProto: array expected";for(var u=0;u<s.attributeProto.length;++u){var d=l.onnx.AttributeProto.verify(s.attributeProto[u]);if(d)return"attributeProto."+d}}if(s.node!=null&&s.hasOwnProperty("node")){if(!Array.isArray(s.node))return"node: array expected";for(var u=0;u<s.node.length;++u){var d=l.onnx.NodeProto.verify(s.node[u]);if(d)return"node."+d}}if(s.docString!=null&&s.hasOwnProperty("docString")&&!o.isString(s.docString))return"docString: string expected";if(s.opsetImport!=null&&s.hasOwnProperty("opsetImport")){if(!Array.isArray(s.opsetImport))return"opsetImport: array expected";for(var u=0;u<s.opsetImport.length;++u){var d=l.onnx.OperatorSetIdProto.verify(s.opsetImport[u]);if(d)return"opsetImport."+d}}return s.domain!=null&&s.hasOwnProperty("domain")&&!o.isString(s.domain)?"domain: string expected":null},c.fromObject=function(s){if(s instanceof l.onnx.FunctionProto)return s;var u=new l.onnx.FunctionProto;if(s.name!=null&&(u.name=String(s.name)),s.input){if(!Array.isArray(s.input))throw TypeError(".onnx.FunctionProto.input: array expected");u.input=[];for(var d=0;d<s.input.length;++d)u.input[d]=String(s.input[d])}if(s.output){if(!Array.isArray(s.output))throw TypeError(".onnx.FunctionProto.output: array expected");u.output=[];for(var d=0;d<s.output.length;++d)u.output[d]=String(s.output[d])}if(s.attribute){if(!Array.isArray(s.attribute))throw TypeError(".onnx.FunctionProto.attribute: array expected");u.attribute=[];for(var d=0;d<s.attribute.length;++d)u.attribute[d]=String(s.attribute[d])}if(s.attributeProto){if(!Array.isArray(s.attributeProto))throw TypeError(".onnx.FunctionProto.attributeProto: array expected");u.attributeProto=[];for(var d=0;d<s.attributeProto.length;++d){if(typeof s.attributeProto[d]!="object")throw TypeError(".onnx.FunctionProto.attributeProto: object expected");u.attributeProto[d]=l.onnx.AttributeProto.fromObject(s.attributeProto[d])}}if(s.node){if(!Array.isArray(s.node))throw TypeError(".onnx.FunctionProto.node: array expected");u.node=[];for(var d=0;d<s.node.length;++d){if(typeof s.node[d]!="object")throw TypeError(".onnx.FunctionProto.node: object expected");u.node[d]=l.onnx.NodeProto.fromObject(s.node[d])}}if(s.docString!=null&&(u.docString=String(s.docString)),s.opsetImport){if(!Array.isArray(s.opsetImport))throw TypeError(".onnx.FunctionProto.opsetImport: array expected");u.opsetImport=[];for(var d=0;d<s.opsetImport.length;++d){if(typeof s.opsetImport[d]!="object")throw TypeError(".onnx.FunctionProto.opsetImport: object expected");u.opsetImport[d]=l.onnx.OperatorSetIdProto.fromObject(s.opsetImport[d])}}return s.domain!=null&&(u.domain=String(s.domain)),u},c.toObject=function(s,u){u||(u={});var d={};if((u.arrays||u.defaults)&&(d.input=[],d.output=[],d.attribute=[],d.node=[],d.opsetImport=[],d.attributeProto=[]),u.defaults&&(d.name="",d.docString="",d.domain=""),s.name!=null&&s.hasOwnProperty("name")&&(d.name=s.name),s.input&&s.input.length){d.input=[];for(var h=0;h<s.input.length;++h)d.input[h]=s.input[h]}if(s.output&&s.output.length){d.output=[];for(var h=0;h<s.output.length;++h)d.output[h]=s.output[h]}if(s.attribute&&s.attribute.length){d.attribute=[];for(var h=0;h<s.attribute.length;++h)d.attribute[h]=s.attribute[h]}if(s.node&&s.node.length){d.node=[];for(var h=0;h<s.node.length;++h)d.node[h]=l.onnx.NodeProto.toObject(s.node[h],u)}if(s.docString!=null&&s.hasOwnProperty("docString")&&(d.docString=s.docString),s.opsetImport&&s.opsetImport.length){d.opsetImport=[];for(var h=0;h<s.opsetImport.length;++h)d.opsetImport[h]=l.onnx.OperatorSetIdProto.toObject(s.opsetImport[h],u)}if(s.domain!=null&&s.hasOwnProperty("domain")&&(d.domain=s.domain),s.attributeProto&&s.attributeProto.length){d.attributeProto=[];for(var h=0;h<s.attributeProto.length;++h)d.attributeProto[h]=l.onnx.AttributeProto.toObject(s.attributeProto[h],u)}return d},c.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},c.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/onnx.FunctionProto"},c}(),a}(),e.exports=l});function np(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function C0(t){return new TextDecoder().decode(t)}var je,jc,LI,Ir,kM,In,Dr,oe,S0,rp,Qc,Jc,Oe=P(()=>{"use strict";iw(),PM(),je=Ya(nu()),Qa(),jc=class{static arraysEqual(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}},LI=class{static preprocessInputShapes(t,e){let n=t.length===1?[1,t[0]]:t,r=e.length===1?[e[0],1]:e;return[n,r]}static postprocessOutputShape(t,e,n){e===1&&t.splice(t.length-2,1),n===1&&t.pop()}static calcMatMulShape(t,e){return t[1]!==e[0]?void 0:[t[0],e[1]]}},Ir=class Vc{static calcShape(e,n,r=!1){let i=e.length,o=n.length;if(i===0)return n;if(o===0)return e;let l=Math.max(e.length,n.length),a=new Array(l);if(r){if(i<2||o<2)return;let c=LI.calcMatMulShape([e[i-2],e[i-1]],[n[o-2],n[o-1]]);if(c===void 0)return;[a[l-2],a[l-1]]=c}for(let c=r?3:1;c<=l;c++){let s=i-c<0?1:e[i-c],u=o-c<0?1:n[o-c];if(s!==u&&s>1&&u>1)return;a[l-c]=Math.max(s,u)}return a}static index(e,n){let r=new Array(n.length);return Vc.fillIndex(e,n,r),r}static fillIndex(e,n,r){let i=e.length-n.length;for(let o=0;o<n.length;o++)r[o]=e[i+o]%n[o]}static calc(e,n,r,i,o){let l=Vc.calcShape(e.dims,n.dims);if(l){if(i&&!oe.areEqual(l,e.dims))return;let a=oe.size(l),c=i?e:new An(l,o||e.type);if(l.length===0)c.set([],r(e.get([]),n.get([])));else{let s=new Array(l.length),u=new Array(e.dims.length),d=new Array(n.dims.length),h=0,f=0,p=!1,g=!1;e.dims.length===0&&(h=e.get([]),p=!0),n.dims.length===0&&(f=n.get([]),g=!0);let y;for(let b=0;b<a;b++){y=b;for(let v=l.length-1;v>=0;v--)s[v]=y%l[v],y=Math.floor(y/l[v]);p||(Vc.fillIndex(s,e.dims,u),h=e.get(u)),g||(Vc.fillIndex(s,n.dims,d),f=n.get(d)),c.set(s,r(h,f))}}return c}}static isValidBroadcast(e,n){let r=e.length,i=n.length;if(r>i)return!1;for(let o=1;o<=r;o++)if(e[r-o]!==1&&e[r-o]!==n[i-o])return!1;return!0}static getBroadcastDims(e,n){let r=e.length,i=[];for(let o=0;o<r;o++){let l=r-1-o,a=e[l]||1;(n[n.length-1-o]||1)>1&&a===1&&i.unshift(l)}return i}},kM=class{static getShapeOfGemmResult(t,e,n,r,i){if(t.length!==2||n.length!==2)throw new Error("shape need to be of size 2");let o,l,a;e?(o=t[1],l=t[0]):(o=t[0],l=t[1]);let c=-1;if(r?(a=n[0],c=1):(a=n[1],c=0),n[c]!==l)throw new Error("dimension mismatch");if(o<=0||a<=0||l<=0)throw new Error("invalid shape specified");if(i&&!Ir.isValidBroadcast(i,[o,a]))throw new Error("gemm: invalid bias shape for broadcast");return[o,a,l]}},In=class D0{static tensorDataTypeFromProto(e){switch(e){case je.onnx.TensorProto.DataType.INT8:return"int8";case je.onnx.TensorProto.DataType.UINT8:return"uint8";case je.onnx.TensorProto.DataType.BOOL:return"bool";case je.onnx.TensorProto.DataType.INT16:return"int16";case je.onnx.TensorProto.DataType.UINT16:return"uint16";case je.onnx.TensorProto.DataType.INT32:return"int32";case je.onnx.TensorProto.DataType.UINT32:return"uint32";case je.onnx.TensorProto.DataType.FLOAT:return"float32";case je.onnx.TensorProto.DataType.DOUBLE:return"float64";case je.onnx.TensorProto.DataType.STRING:return"string";case je.onnx.TensorProto.DataType.INT64:return"int32";case je.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw new Error(`unsupported data type: ${je.onnx.TensorProto.DataType[e]}`)}}static tensorDataTypeStringToEnum(e){switch(e){case"int8":return je.onnx.TensorProto.DataType.INT8;case"uint8":return je.onnx.TensorProto.DataType.UINT8;case"bool":return je.onnx.TensorProto.DataType.BOOL;case"int16":return je.onnx.TensorProto.DataType.INT16;case"uint16":return je.onnx.TensorProto.DataType.UINT16;case"int32":return je.onnx.TensorProto.DataType.INT32;case"uint32":return je.onnx.TensorProto.DataType.UINT32;case"float32":return je.onnx.TensorProto.DataType.FLOAT;case"float64":return je.onnx.TensorProto.DataType.DOUBLE;case"string":return je.onnx.TensorProto.DataType.STRING;case"int64":return je.onnx.TensorProto.DataType.INT64;case"uint64":return je.onnx.TensorProto.DataType.UINT64;default:throw new Error(`unsupported data type: ${e}`)}}static tensorDimsFromProto(e){return e.map(n=>Zi.isLong(n)?n.toNumber():n)}static tensorValueTypeFromProto(e){return{tensorType:D0.tensorDataTypeFromProto(e.elemType),shape:{dims:D0.tensorDimsFromProto(e.shape.dim.map(n=>n.dimValue))}}}static tensorDimsFromORTFormat(e){let n=[];for(let r=0;r<e.dimsLength();r++)n.push(Dr.longToNumber(e.dims(r)));return n}static tensorAttributesFromORTFormat(e){let n=[];for(let r=0;r<e.attributesLength();r++)n.push(e.attributes(r));return n}},Dr=class{static longToNumber(t,e){return Zi.isLong(t)?t.toNumber():t instanceof D.Long?Zi.fromValue({low:t.low,high:t.high,unsigned:e??!1}).toNumber():t}static isLong(t){return Zi.isLong(t)||t instanceof D.Long}},oe=class Xi{static size(e){return Xi.getSizeFromDimensionRange(e,0,e.length)}static sizeFromDimension(e,n){if(n<0||n>e.length)throw new Error(`invalid dimension of ${n} for sizeFromDimension as Tensor has ${e.length} dimensions.`);return Xi.getSizeFromDimensionRange(e,n,e.length)}static sizeToDimension(e,n){if(n<0||n>e.length)throw new Error(`invalid dimension of ${n} for sizeToDimension as Tensor has ${e.length} dimensions.`);return Xi.getSizeFromDimensionRange(e,0,n)}static getSizeFromDimensionRange(e,n,r){let i=1;for(let o=n;o<r;o++){if(e[o]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");i*=e[o]}return i}static computeStrides(e){let n=e.length;if(n===0)return[];if(n===1)return[1];let r=new Array(n);r[n-1]=1,r[n-2]=e[n-1];for(let i=n-3;i>=0;--i)r[i]=r[i+1]*e[i+1];return r}static transpose(e){return e.slice().reverse()}static indicesToOffset(e,n,r){r===void 0&&(r=e.length);let i=0;for(let o=0;o<r;++o)i+=n[o]*e[o];return i}static offsetToIndices(e,n){let r=n.length;if(r===0)return[];if(r===1)return[e*n[0]];let i=new Array(n.length);for(let o=0;o<i.length-1;++o)i[o]=Math.floor(e/n[o]),e-=i[o]*n[o];return i[i.length-1]=e,i}static normalizeAxis(e,n){if(e<-n&&e>=n)throw new Error("unsupported axis for this operation.");return e<0?e+n:e}static normalizeAxes(e,n){return e.map(r=>this.normalizeAxis(r,n))}static incrementIndex(e,n,r){if(n.length===0||e.length===0)throw new Error("Index incrementing unsupported for scalar Tensor");if(r===void 0)r=n.length;else if(r<=0||r>n.length)throw new Error("Incorrect axis to increment on");for(let i=r-1;i>=0&&(e[i]++,!(e[i]<n[i]));--i)e[i]=0}static calculateReshapedDims(e,n){if(n.length===0){if(e.length===0||Xi.size(e)===1)return[];throw new Error("cannot reshape to a scalar Tensor")}let r=n.length,i=new Array(r),o=-1,l=1;for(let c=0;c<r;c++){if(n[c]<-1)throw new Error("a dimension in shape hints cannot be less than -1");if(n[c]===-1){if(o!==-1)throw new Error("at most one dimension in shape hints can be -1");o=c}else{if(n[c]===0){if(c>=e.length)throw new Error("the dimension with value zero exceeds the dimension size of the input tensor");i[c]=e[c]}else i[c]=n[c];l*=i[c]}}let a=Xi.size(e);if(o!==-1){if(a%l!==0)throw new Error(`the input tensor cannot be reshaped to the requested shape. Input shape: [${e}] Output shape: [${n}]`);i[o]=a/l}else if(l!==a)throw new Error("reshapedDims and originalDims don't have matching sizes");return i}static sortBasedOnPerm(e,n){return n?n.map(r=>e[r]):e.slice().reverse()}static padShape(e,n){let r=e.length;return e.map((i,o)=>i+n[o]+n[o+r])}static areEqual(e,n){return e.length!==n.length?!1:e.every((r,i)=>r===n[i])}static validateDimsAndCalcSize(e){if(e.length>6)throw new TypeError("Only rank 0 to 6 is supported for tensor shape.");let n=1;for(let r of e){if(!Number.isInteger(r))throw new TypeError(`Invalid shape: ${r} is not an integer`);if(r<0||r>2147483647)throw new TypeError(`Invalid shape: length ${r} is not allowed`);n*=r}return n}static flattenShape(e,n){n<0&&(n+=e.length);let r=e.reduce((o,l)=>o*l,1),i=e.slice(n).reduce((o,l)=>o*l,1);return[r/i,i]}static squeezeShape(e,n){let r=new Array;n=Xi.normalizeAxes(n,e.length);for(let i=0;i<e.length;i++){let o=n.indexOf(i)>=0;if(o&&e[i]!==1)throw new Error("squeeze an axis of size different than 1");(n.length===0&&e[i]>1||n.length>0&&!o)&&r.push(e[i])}return r}static unsqueezeShape(e,n){let r=new Array(e.length+n.length);r.fill(0);for(let o=0;o<n.length;o++){let l=Xi.normalizeAxis(n[o],r.length);if(l>=r.length)throw new Error("'axes' has an out of range axis");if(r[l]!==0)throw new Error("'axes' has a duplicate axis");r[l]=1}let i=0;for(let o=0;o<r.length;o++)r[o]===0&&(r[o]=e[i++]);if(i!==e.length)throw new Error("the unsqueezed dimension could not be established");return r}},S0=class FM{static splitShape(e,n,r,i){if(r.length===0){if(!i)throw new Error("need to know number of outputs when the 'split' attribute is not specified");FM.determineSplit(e[n],i,r)}let o=[],l=[0];for(let a=0;a<r.length;++a){a!==0&&l.push(l[a-1]+r[a-1]);let c=e.slice();c[n]=r[a],o.push(c)}return[o,l]}static determineSplit(e,n,r){if(e%n!==0)throw new Error("cannot split tensor to equal sized parts");for(let i=0;i<n;++i)r.push(e/n)}},rp=class $c{static adjustPoolAttributes(e,n,r,i,o,l){if(!e&&r.length!==n.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(e)for(let a=0;a<n.length-2;a++)a>=r.length?r.push(n[a+2]):r[a]=n[a+2];for(let a=0;a<r.length;a++)if(a<i.length){if(i[a]<0)throw new Error("strides should be greater than or equal to 1")}else i.push(1);for(let a=0;a<r.length;a++)if(a<o.length){if(o[a]<0)throw new Error("dilations should be greater than or equal to 1")}else o.push(1);for(let a=0;a<r.length*2;a++)if(a<l.length){if(l[a]<0)throw new Error("pad should be greater than or equal to 1")}else l.push(0);for(let a=0;a<r.length;a++){if(r[a]<=0)throw new Error("kernel shapes need to be greater than 0");if(l[a]>=r[a]||l[a+r.length]>=r[a])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(e,n,r,i,o,l){if(l){if(o.length!==2*(e.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(n.length!==e.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==e.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let a=0;a<e.length-2;a++)$c.adjustPadAndReturnShape(e[a+2],n[a],r[a],i[a],o,a,a+e.length-2,l)}}static computePoolOutputShape(e,n,r,i,o,l,a){if(n.length<=0)throw new Error("input shape must be of size greater than 0");let c=[n[0],n[1]];return $c.computeShapeHelper(e,n,c,r,i,o,l,a),c}static computeConvOutputShape(e,n,r,i,o,l,a){if(e.length<=0||n.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let c=[e[0],n[0]];return $c.computeShapeHelper(!1,e,c,r,i,o,l,a),c}static computeShapeHelper(e,n,r,i,o,l,a,c){if(e)for(let s=0;s<n.length-2;s++)r.push(1);else for(let s=0;s<n.length-2;s++)r.push($c.adjustPadAndReturnShape(n[s+2],i[s],o[s],l[s],a,s,s+n.length-2,c))}static adjustPadAndReturnShape(e,n,r,i,o,l,a,c){let s=r*(i-1)+1;if(c&&c!=="NOTSET")switch(c){case"VALID":return o[l]=0,o[a]=0,Math.floor((e-s)/n+1);case"SAME_LOWER":case"SAME_UPPER":if(r!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let u=((e+n-1)/n-1)*n+i-e;return o[l]=Math.floor(c==="SAME_LOWER"?(u+1)/2:u/2),o[a]=u-o[l],Math.floor((e+u-i)/n+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((e+o[l]+o[a]-s)/n+1)}},Qc=-34028234663852886e22,Jc=34028234663852886e22});function Bz(t){switch(t){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw new Error(`cannot calculate sizeof() on type ${t}`)}}function BI(t){switch(t){case ce.onnx.TensorProto.DataType.UINT8:case ce.onnx.TensorProto.DataType.INT8:case ce.onnx.TensorProto.DataType.BOOL:return 1;case ce.onnx.TensorProto.DataType.UINT16:case ce.onnx.TensorProto.DataType.INT16:return 2;case ce.onnx.TensorProto.DataType.FLOAT:case ce.onnx.TensorProto.DataType.INT32:case ce.onnx.TensorProto.DataType.UINT32:return 4;case ce.onnx.TensorProto.DataType.INT64:case ce.onnx.TensorProto.DataType.DOUBLE:case ce.onnx.TensorProto.DataType.UINT64:return 8;default:throw new Error(`cannot calculate sizeof() on type ${ce.onnx.TensorProto.DataType[t]}`)}}function jz(t,e){return new(LM(e))(t)}function LM(t){switch(t){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw new Error("unspecified error")}}function I0(t,e){if(e===ce.onnx.TensorProto.DataType.INT64||e===Jf.TensorDataType.INT64){if(t.greaterThanOrEqual(2147483648)||t.lessThan(-2147483648))throw new TypeError("int64 is not supported")}else if(e===ce.onnx.TensorProto.DataType.UINT32||e===Jf.TensorDataType.UINT32||e===ce.onnx.TensorProto.DataType.UINT64||e===Jf.TensorDataType.UINT64){if(t.greaterThanOrEqual(4294967296)||t.lessThan(0))throw new TypeError("uint64 is not supported")}else throw new TypeError(`not a LONG type: ${ce.onnx.TensorProto.DataType[e]}`);return t.toNumber()}function jI(t,e,n){switch(e){case ce.onnx.TensorProto.DataType.BOOL:case ce.onnx.TensorProto.DataType.UINT8:return t.getUint8(n);case ce.onnx.TensorProto.DataType.INT8:return t.getInt8(n);case ce.onnx.TensorProto.DataType.UINT16:return t.getUint16(n,!0);case ce.onnx.TensorProto.DataType.INT16:return t.getInt16(n,!0);case ce.onnx.TensorProto.DataType.FLOAT:return t.getFloat32(n,!0);case ce.onnx.TensorProto.DataType.INT32:return t.getInt32(n,!0);case ce.onnx.TensorProto.DataType.UINT32:return t.getUint32(n,!0);case ce.onnx.TensorProto.DataType.INT64:return I0(Zi.fromBits(t.getUint32(n,!0),t.getUint32(n+4,!0),!1),e);case ce.onnx.TensorProto.DataType.DOUBLE:return t.getFloat64(n,!0);case ce.onnx.TensorProto.DataType.UINT64:return I0(Zi.fromBits(t.getUint32(n,!0),t.getUint32(n+4,!0),!0),e);default:throw new Error(`cannot read from DataView for type ${ce.onnx.TensorProto.DataType[e]}`)}}var VI,ce,Jf,An,Qa=P(()=>{"use strict";VI=Ya(Tz()),PM(),up(),ce=Ya(nu()),Oe(),Jf=Ne.experimental.fbs,An=class ep{constructor(e,n,r,i,o,l=VI.Guid.create()){this.dims=e,this.type=n,this.dataProvider=r,this.asyncDataProvider=i,this.cache=o,this.dataId=l,this.size=oe.validateDimsAndCalcSize(e);let a=this.size,c=r===void 0&&i===void 0&&o===void 0;if(o!==void 0&&o.length!==a)throw new RangeError("Input dims doesn't match data length.");if(n==="string"){if(o!==void 0&&(!Array.isArray(o)||!o.every(s=>typeof s=="string")))throw new TypeError("cache should be a string array");c&&(this.cache=new Array(a))}else{if(o!==void 0){let s=LM(n);if(!(o instanceof s))throw new TypeError(`cache should be type ${s.name}`)}if(c){let s=new ArrayBuffer(a*Bz(n));this.cache=jz(s,n)}}}get data(){if(this.cache===void 0){let e=this.dataProvider(this.dataId);if(e.length!==this.size)throw new Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=e}return this.cache}get stringData(){if(this.type!=="string")throw new TypeError("data type is not string");return this.data}get integerData(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw new TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)")}}get floatData(){switch(this.type){case"float32":case"float64":return this.data;default:throw new TypeError("data type is not float (float32, float64)")}}get numberData(){if(this.type!=="string")return this.data;throw new TypeError("type cannot be non-number (string)")}get(e){return this.data[oe.indicesToOffset(e,this.strides)]}set(e,n){this.data[oe.indicesToOffset(e,this.strides)]=n}getData(){return R(this,null,function*(){return this.cache===void 0&&(this.cache=yield this.asyncDataProvider(this.dataId)),this.cache})}get strides(){return this._strides||(this._strides=oe.computeStrides(this.dims)),this._strides}static fromProto(e){if(!e)throw new Error("cannot construct Value from an empty tensor");let n=In.tensorDataTypeFromProto(e.dataType),r=In.tensorDimsFromProto(e.dims),i=new ep(r,n);if(n==="string")e.stringData.forEach((o,l)=>{i.data[l]=C0(o)});else if(e.rawData&&typeof e.rawData.byteLength=="number"&&e.rawData.byteLength>0){let o=i.data,l=new DataView(e.rawData.buffer,e.rawData.byteOffset,e.rawData.byteLength),a=BI(e.dataType),c=e.rawData.byteLength/a;if(e.rawData.byteLength%a!==0)throw new Error("invalid buffer length");if(o.length!==c)throw new Error("buffer length mismatch");for(let s=0;s<c;s++){let u=jI(l,e.dataType,s*a);o[s]=u}}else{let o;switch(e.dataType){case ce.onnx.TensorProto.DataType.FLOAT:o=e.floatData;break;case ce.onnx.TensorProto.DataType.INT32:case ce.onnx.TensorProto.DataType.INT16:case ce.onnx.TensorProto.DataType.UINT16:case ce.onnx.TensorProto.DataType.INT8:case ce.onnx.TensorProto.DataType.UINT8:case ce.onnx.TensorProto.DataType.BOOL:o=e.int32Data;break;case ce.onnx.TensorProto.DataType.INT64:o=e.int64Data;break;case ce.onnx.TensorProto.DataType.DOUBLE:o=e.doubleData;break;case ce.onnx.TensorProto.DataType.UINT32:case ce.onnx.TensorProto.DataType.UINT64:o=e.uint64Data;break;default:throw new Error("unspecific error")}if(o==null)throw new Error("failed to populate data from a tensorproto value");let l=i.data;if(l.length!==o.length)throw new Error("array length mismatch");for(let a=0;a<o.length;a++){let c=o[a];Zi.isLong(c)?l[a]=I0(c,e.dataType):l[a]=c}}return i}static fromData(e,n,r){return new ep(n,r,void 0,void 0,e)}static fromOrtTensor(e){if(!e)throw new Error("cannot construct Value from an empty tensor");let n=In.tensorDimsFromORTFormat(e),r=In.tensorDataTypeFromProto(e.dataType()),i=new ep(n,r);if(r==="string")for(let o=0;o<e.stringDataLength();o++)i.data[o]=e.stringData(o);else if(e.rawDataArray()&&typeof e.rawDataLength()=="number"&&e.rawDataLength()>0){let o=i.data,l=new DataView(e.rawDataArray().buffer,e.rawDataArray().byteOffset,e.rawDataLength()),a=BI(e.dataType()),c=e.rawDataLength()/a;if(e.rawDataLength()%a!==0)throw new Error("invalid buffer length");if(o.length!==c)throw new Error("buffer length mismatch");for(let s=0;s<c;s++){let u=jI(l,e.dataType(),s*a);o[s]=u}}return i}}});function be(t){return t===1?BM:jM}function Vz(t){let e=be(t);return`${e.version}
      precision highp float;
      ${e.attribute} vec3 position;
      ${e.attribute} vec2 textureCoord;

      ${e.varyingVertex} vec2 TexCoords;

      void main()
      {
          gl_Position = vec4(position, 1.0);
          TexCoords = textureCoord;
      }`}function $z(t){let e=be(t);return`${e.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${e.varyingFrag} vec2 TexCoords;
    ${e.outputDeclaration}
    const vec2 halfCR = vec2(0.5, 0.5);

    // Custom vector types to handle higher dimenalities.
    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    `}function Uz(t,e){let n=be(t);return`
  void main() {
    int indices[${e}];
    toVec(TexCoords, indices);
    vec4 result = vec4(process(indices));
    ${n.output} = result;
  }
  `}var BM,jM,Ze=P(()=>{"use strict";BM={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},jM={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"}}),xe=P(()=>{"use strict"});function $I(t,e=r=>0,n){return R(this,null,function*(){return new Promise((r,i)=>{let o=0,l=()=>{if(t()){r();return}o++;let a=e(o);if(n!=null&&o>=n){i();return}setTimeout(l,a)};l()})})}function Lb(t){return np(typeof t<"u"&&t.length!==0,()=>"empty string found for sampler name"),"get"+t.charAt(0).toUpperCase()+t.slice(1)}function Hz(t){return np(typeof t<"u"&&t.length!==0,()=>"empty string found for sampler name"),"get"+t.charAt(0).toUpperCase()+t.slice(1)+"AtOutCoords"}function Oc(t,e){let n=JSON.parse(JSON.stringify(t));return n=e,n}function Ac(t,e){return e.map(n=>t[n]).join(", ")}function Qi(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function Za(t=6){return["x","y","z","w","u","v"].slice(0,t)}var si=P(()=>{"use strict";Oe()});function Gz(t,e){return Za(e).map(n=>`${t}.${n}`)}function ow(t,e){return e===1?[t]:Gz(t,e)}function ru(){return`
    float getChannel(vec4 frag, int dim) {
      int modCoord = imod(dim, 2);
      return modCoord == 0 ? frag.r : frag.g;
    }

    float getChannel(vec4 frag, vec2 innerDims) {
      vec2 modCoord = mod(innerDims, 2.);
      return modCoord.x == 0. ?
        (modCoord.y == 0. ? frag.r : frag.g) :
        (modCoord.y == 0. ? frag.b : frag.a);
    }
  `}var Ja=P(()=>{"use strict";si()});function zz(t,e,n){if(t===0)return"false";if(t===1)return`rc > ${e[0]}`;let r="";for(let i=t-2;i<t;i++)r+=`${n[i]} >= ${e[i-t+2]}`,i<t-1&&(r+="||");return r}function Wz(t,e){let n=t.length;if(n===0)return"getA(), 0, 0, 0";if(n===1)return`getA(rc),
            rc + 1 >= ${t[0]} ? 0. : getA(rc + 1),
            0, 0`;let r="r, c",i="r, cp1",o="rp1, c",l="rp1, cp1",a="";if(n>2)for(let c=0;c<n-2;++c)a=a+`${e[c]},`;return`getA(${a}${r}),
          rEdge ? 0. : getA(${a}${o}),
          cEdge ? 0. : getA(${a}${i}),
          rEdge || cEdge ? 0. : getA(${a}${l})`}function qz(t,e,n,r){return t===0||t===1?"":`
    int r = ${e[t-2]};
    int c = ${e[t-1]};
    int rp1 = ${e[t-2]} + 1;
    int cp1 = ${e[t-1]} + 1;
    bool rEdge = rp1 >= ${r};
    bool cEdge = cp1 >= ${n};
    `}var Bb,UI,VM,Yz=P(()=>{"use strict";Ze(),xe(),si(),Ja(),Bb={name:"pack",inputNames:["A"],inputTypes:[1]},UI=(t,e)=>{let n=be(t.session.backend.glContext.version),r=e.dims,i=r.length,o=e.dims.length,l=Qi(o),a=ow("rc",o),c=qz(o,a,r[r.length-2],r[r.length-1]),s;i===0?s=[1,1]:i===1?s=[r[0],1]:s=[r[o-1],r[o-2]];let u=zz(o,s,a),d=Wz(r,a),h=`
        void main() {
          ${l} rc = getOutputCoords();

          if(${u}) {
            ${n.output} = vec4(0);
          } else {
            ${c}

            ${n.output} = vec4(${d});
          }
        }
      `;return N(C({},Bb),{hasMain:!0,output:{dims:e.dims,type:e.type,textureType:2},shaderSource:h})},VM=(t,e)=>N(C({},Bb),{get:()=>UI(t,e)})});function HI(t){if(t.length===0)return[1,1,1];let e=1;for(let n=0;n<t.length-2;++n)e*=t[n];return[e,t.length>1?t[t.length-2]:1,t[t.length-1]]}function Xz(t,e){let n=!1;return t.length===0||e.length===0?n=!0:t.length<2||e.length<2?n=t[t.length-1]===e[e.length-1]:n=t[t.length-1]===e[e.length-1]&&t[t.length-2]===e[e.length-2],n}function Kz(t){let e=oe.computeStrides(t),n=["b","r","c"],r="index";return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e.map((i,o)=>{let l=`int ${n[o]} = ${r} / ${i}`,a=o===e.length-1?`int ${n[o+1]} = ${r} - ${n[o]} * ${i}`:`index -= ${n[o]} * ${i}`;return`${l}; ${a};`}).join("")}
      return ivec3(b, r, c);
    }
  `}function Zz(t){let e=oe.computeStrides(t);return`
  int getFlattenedIndex(ivec3 coords) {
    // reverse y, z order
    return coords.x * ${e[0]} + coords.z * ${e[1]} + coords.y;
  }
`}var GI,zI,$M,Qz=P(()=>{"use strict";Oe(),Ze(),xe(),Ja(),GI=t=>({name:"Reshape (packed)",inputTypes:[2],inputNames:["A"],cacheHint:`${t}`}),zI=(t,e,n,r)=>{let i=e.dims,o=r,l="";for(let s=0;s<4;s++){let u="";switch(s){case 0:u="outputCoords = rc;";break;case 1:u="outputCoords = ivec3(rc.x, rc.y+1, rc.z);";break;case 2:u="outputCoords = ivec3(rc.x, rc.y, rc.z+1);";break;case 3:u="outputCoords = ivec3(rc.x, rc.y+1, rc.z+1);";break;default:throw new Error}l+=`
        ${u}
        ${s>0?"if(outputCoords.y < rows && outputCoords.z < cols){":""}
          int flattenedIndex = getFlattenedIndex(outputCoords);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flattenedIndex);
          vec2 innerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] = getChannel(getA(inputRC.x, inputRC.y, inputRC.z), innerDims);

        ${s>0?"}":""}
      `}let a=be(t.session.backend.glContext.version),c=`
      ${Kz(i)}
      ${Zz(o)}
      ${ru()}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.0);

        ivec3 outputCoords;
        int rows = ${o[2]};
        int cols = ${o[1]};

        ${l}
        ${a.output} = result;
      }
    `;return N(C({},n),{output:{dims:o,type:e.type,textureType:2},shaderSource:c,hasMain:!0})},$M=(t,e,n)=>{let r=GI(n);return N(C({},r),{get:()=>zI(t,e,r,n)})}}),O0,Jz=P(()=>{"use strict";Ze(),xe(),O0=(t,e)=>{let n=e.shape,r=be(t.session.backend.glContext.version),i=`
    const float FLOAT_MAX = 1.70141184e38;
    const float FLOAT_MIN = 1.17549435e-38;

    bool isNaN(float val) {
      return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;
    }

    highp vec4 encodeAsUint8(highp float v) {
      if (isNaN(v)) {
        return vec4(255, 255, 255, 255);
      }

      highp float av = abs(v);

      if(av < FLOAT_MIN) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      } else if(v > FLOAT_MAX) {
        return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
      } else if(v < -FLOAT_MAX) {
        return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
      }

      highp vec4 c = vec4(0,0,0,0);

      highp float e = floor(log2(av));
      highp float m = exp2(fract(log2(av))) - 1.0;

      c[2] = floor(128.0 * m);
      m -= c[2] / 128.0;
      c[1] = floor(32768.0 * m);
      m -= c[1] / 32768.0;
      c[0] = floor(8388608.0 * m);

      highp float ebias = e + 127.0;
      c[3] = floor(ebias / 2.0);
      ebias -= c[3] * 2.0;
      c[2] += floor(ebias) * 128.0;

      c[3] += 128.0 * step(0.0, -v);

      return c / 255.0;
    }

    void main() {
      float value = ${r.texture2D}(X,TexCoords).r;
      ${r.output} = encodeAsUint8(value);
    }`,o={name:"Uint8Encode",inputTypes:[0],inputNames:["X"],output:{dims:n,type:e.tensor.type,textureType:3},shaderSource:i,hasMain:!0};return t.executeProgram(o,[e.tensor])}});function e5(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}var jb,WI,UM,t5=P(()=>{"use strict";Ze(),xe(),si(),Ja(),jb={name:"unpack",inputNames:["A"],inputTypes:[2]},WI=(t,e)=>{let n=e.dims.length,r=ow("rc",n),i=r.slice(-2),o=Qi(n),l=ru(),a=e.dims.length===0?"":e5(n,r),c=n<=1?"rc":`vec2(${i.join(",")})`,s=be(t.session.backend.glContext.version),u=`
    ${l}
    void main() {
      ${o} rc = getOutputCoords();

       // Sample the texture with the coords to get the rgba channel value.
       vec4 packedInput = getA(${a});

       ${s.output} = vec4(getChannel(packedInput, ${c}), 0, 0, 0);
     }
   `;return N(C({},jb),{hasMain:!0,output:{dims:e.dims,type:e.type,textureType:0},shaderSource:u})},UM=(t,e)=>N(C({},jb),{get:()=>WI(t,e)})}),HM,A0,GM,ip=P(()=>{"use strict";dr(),HM=class{constructor(t,e=1){if(e===1)this.internalFormat=t.R32F,this.format=t.RED,this.textureType=t.FLOAT,this.channelSize=e;else if(e===4)this.internalFormat=t.RGBA32F,this.format=t.RGBA,this.textureType=t.FLOAT,this.channelSize=e;else throw new Error(`Invalid number of channels: ${e}`)}encode(t,e){let n,r;return t.constructor!==Float32Array&&(st.warning("Encoder","data was not of type Float32; creating new Float32Array"),r=new Float32Array(t)),e*this.channelSize>t.length?(st.warning("Encoder","Source data too small. Allocating larger array"),r=t,n=this.allocate(e*this.channelSize),r.forEach((i,o)=>n[o]=i)):(r=t,n=r),n}allocate(t){return new Float32Array(t*4)}decode(t,e){return this.channelSize===1?t.filter((n,r)=>r%4===0).subarray(0,e):t.subarray(0,e)}},A0=class{constructor(t,e=1,n){if(e!==1&&e!==4)throw new Error(`Invalid number of channels: ${e}`);this.internalFormat=t.RGBA,this.format=t.RGBA,this.channelSize=e,this.textureType=n||t.FLOAT}encode(t,e){let n=t;return this.channelSize===1&&(st.verbose("Encoder","Exploding into a larger array"),n=this.allocate(e),t.forEach((r,i)=>n[i*4]=r)),n}allocate(t){return new Float32Array(t*4)}decode(t,e){return this.channelSize===1?t.filter((n,r)=>r%4===0).subarray(0,e):t.subarray(0,e)}},GM=class{constructor(t,e=1){if(this.channelSize=4,e===1)this.internalFormat=t.ALPHA,this.format=t.ALPHA,this.textureType=t.UNSIGNED_BYTE,this.channelSize=e;else if(e===4)this.internalFormat=t.RGBA,this.format=t.RGBA,this.textureType=t.UNSIGNED_BYTE,this.channelSize=e;else throw new Error(`Invalid number of channels: ${e}`)}encode(t,e){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}allocate(t){return new Uint8Array(t*this.channelSize)}decode(t,e){if(t instanceof Uint8Array)return t.subarray(0,e);throw new Error(`Invalid array type: ${t.constructor}`)}}}),Yc,zM,M0,n5=P(()=>{"use strict";Oe(),xe(),Yc=(t,e,n)=>{let r=n===0||n===1?1:4,i=n===2,o=n===1||n===2,l=n===4?e.length-1:void 0,a=n===4?e.map((c,s)=>s===e.length-1?c*4:c):void 0;return M0(t,e,r,a,{isPacked:i,reverseWH:o,breakAxis:l})},zM=(t,e,n)=>{let r=Yc(t,e,n);return[r.width,r.height]},M0=(t,e,n=1,r,i)=>{let o=!!(i&&i.isPacked),[l,a]=t.computeTextureWH(o&&r||e,i),c=e.length,s=e.slice(0);if(c===0&&(s=[1]),n===1)r=e;else if(o){if(n!==4)throw new Error("a packed texture must be 4-channel");r=e,c>0&&(s[c-1]=Math.ceil(s[c-1]/2)),c>1&&(s[c-2]=Math.ceil(s[c-2]/2))}else if(!r)throw new Error("Unpacked shape is needed when using channels > 1");return{width:l,height:a,channels:n,isPacked:o,shape:s,strides:oe.computeStrides(s),unpackedShape:r,reversedWH:i&&i.reverseWH}}}),qI,WM,r5=P(()=>{"use strict";dr(),Qa(),Oe(),Yz(),Qz(),Jz(),t5(),ip(),n5(),xe(),qI=(t,e)=>{let n=e.map(i=>`${i.unpackedShape.join(",")};${i.width}x${i.height}`).join("_"),r=t.name;return t.cacheHint&&(r+="["+t.cacheHint+"]"),r+=":"+n,r},WM=class{constructor(t){this.session=t,this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map}calculateTextureWidthAndHeight(t,e){return zM(this.session.layoutStrategy,t,e)}executeProgram(t,e){if(e.length<t.inputNames.length)throw new Error(`Input size mustn't be less than ${t.inputNames.length}.`);if(t.inputNames.length!==t.inputTypes.length)throw new Error("input names size does not match input types");let n=[];for(let c=0;c<t.inputNames.length;++c)n[c]=this.getOrCreateTextureData(e[c],t.inputTypes[c]);let r=qI(t,n),i=this.session.programManager.getArtifact(r),o=i?i.programInfo:typeof t.get=="function"?t.get():t,l=Yc(this.session.layoutStrategy,o.output.dims,o.output.textureType),a=this.createTextureData(l,o.output.type);return i||(i=this.session.programManager.build(o,n,a),this.session.programManager.setArtifact(r,i)),this.runProgram(i,n,a),a}run(t,e){return this.executeProgram(t,e).tensor}runProgram(t,e,n){for(let r=0;r<e.length;++r)if(!!e[r].isPacked!=(t.programInfo.inputTypes[r]===2))throw new Error(`input[${r}] property packed inconsistent`);if(!!n.isPacked!=(t.programInfo.output.textureType===2))throw new Error("output property packed inconsistent");this.session.programManager.run(t,e,n)}getOrCreateTextureData(t,e){let n=this.getTextureData(t.dataId,e===2);if(!n&&(n=this.getTextureData(t.dataId,e!==2),n))return e===2?this.pack(n):this.unpack(n);if(!n){let r=Yc(this.session.layoutStrategy,t.dims,e);if(e===4){let i=t.dims;if(i.length===4){let o=[i[0],Math.ceil(i[1]*i[2]*i[3]/4)],l=Yc(this.session.layoutStrategy,o,e),a=t.numberData;if(i[1]*i[2]*i[3]%4!==0){let c=i[0],s=i[1]*i[2]*i[3],u=Math.ceil(s*1/4)*4,d=c*u;a=new Float32Array(d);for(let h=0;h<c;++h){let f=h*s,p=h*u+h%1*s;a.set(t.numberData.subarray(f,f+s),p)}}return this.createTextureData(l,t.type,a,t,1)}}if(e===2){let i=M0(this.session.layoutStrategy,t.dims,1,[],{reverseWH:!0}),o=this.createTextureData(i,t.type,t.numberData,t,1);n=this.pack(o)}else n=this.createTextureData(r,t.type,t.numberData,t,1)}return n}createTextureDataFromLayoutBindTensor(t,e,n,r){return this.createTextureData(t,e,n,r,1)}createTextureData(t,e,n,r,i){st.verbose("InferenceHandler",`Creating TextureData: layout:[${JSON.stringify(t)}]`);let o=this.session.textureManager.createTextureFromLayout(e,t,n,i);return this.createTextureDataFromTexture(t,e,o,r)}reshapeUnpacked(t,e){let n=this.getOrCreateTextureData(t,0),r={channels:n.channels,height:n.height,width:n.width,shape:e.length!==0?e:[1],strides:oe.computeStrides(e),unpackedShape:e};return this.createTextureDataFromTexture(r,t.type,n.texture).tensor}reshapePacked(t,e){let n=this.getOrCreateTextureData(t,2);if(Xz(t.dims,e)){let a={channels:n.channels,height:n.height,width:n.width,shape:e.length!==0?e:[1],strides:oe.computeStrides(e),unpackedShape:e,isPacked:!0};return this.createTextureDataFromTexture(a,t.type,n.texture).tensor}let r=HI(t.dims),i=HI(e),o=this.reshapePacked(t,r),l=this.run($M(this,o,i),[o]);return this.reshapePacked(l,e)}cast(t,e){let n=this.getOrCreateTextureData(t,0);return this.createTextureDataFromTexture(n,e,n.texture).tensor}createTextureDataFromTexture(t,e,n,r,i){let o=N(C({},t),{tensor:r||new An(t.unpackedShape,e,l=>this.readTexture(o),l=>R(this,null,function*(){return this.readTextureAsync(o)}),void 0,i),texture:n});return this.setTextureData(o.tensor.dataId,o,t.isPacked),o}getTextureData(t,e=!1){return this.session.isInitializer(t)?this.session.getTextureData(t,e):e?this.packedTextureDataCache.get(t):this.unpackedTextureDataCache.get(t)}setTextureData(t,e,n=!1){this.session.isInitializer(t)?this.session.setTextureData(t,e,n):(n?this.packedTextureDataCache:this.unpackedTextureDataCache).set(t,e)}isTextureLayoutCached(t,e=!1){return!!this.getTextureData(t.dataId,e)}dispose(){this.session.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(t=>this.session.textureManager.releaseTexture(t)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(t=>this.session.textureManager.releaseTexture(t)),this.unpackedTextureDataCache=new Map}readTexture(t){return t.isPacked?this.readTexture(this.unpack(t)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTexture(t,t.tensor.type,t.channels):this.session.textureManager.readUint8TextureAsFloat(O0(this,t))}readTextureAsync(t){return R(this,null,function*(){return t.isPacked?this.readTextureAsync(this.unpack(t)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTextureAsync(t,t.tensor.type,t.channels):this.session.textureManager.readUint8TextureAsFloat(O0(this,t))})}pack(t){return this.executeProgram(VM(this,t.tensor),[t.tensor])}unpack(t){return this.executeProgram(UM(this,t.tensor),[t.tensor])}}}),YI,$e,Pt=P(()=>{"use strict";YI=class{constructor(t){Object.assign(this,t)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(t=>`${this[t]}`).join(";")),this.key}},$e=t=>new YI(t)}),Vb,qM,YM,XI,KI,i5=P(()=>{"use strict";Pt(),Ze(),xe(),Vb={name:"BatchNormalization",inputNames:["A","Scale","B","Mean","Variance"],inputTypes:[0,0,0,0,0]},qM=(t,e,n)=>(KI(e),[t.run(N(C({},Vb),{cacheHint:n.cacheKey,get:()=>XI(t,e,n)}),e)]),YM=t=>{let e=t.attributes.getFloat("epsilon",1e-5),n=t.attributes.getFloat("momentum",.9),r=t.attributes.getInt("spatial",1);return $e({epsilon:e,momentum:n,spatial:r})},XI=(t,e,n)=>{let r=be(t.session.backend.glContext.version),i=e[0].dims.length,[o,l]=t.calculateTextureWidthAndHeight(e[1].dims,0),a=`
  float process(int[${i}] indices) {
    vec2 position = offsetToCoords(indices[1], ${o}, ${l});
    float scale = getColorAsFloat(${r.texture2D}(Scale, position));
    float mean = getColorAsFloat(${r.texture2D}(Mean, position));
    float variance = getColorAsFloat(${r.texture2D}(Variance, position));
    float b = getColorAsFloat(${r.texture2D}(B, position));

    return scale * ( (_A(indices) - mean) / sqrt(variance + float(${n.epsilon})) ) + b;
  }`;return N(C({},Vb),{output:{dims:e[0].dims,type:e[0].type,textureType:0},shaderSource:a})},KI=t=>{if(!t||t.length!==5)throw new Error("BatchNormalization requires 5 inputs.");let e=t[0],n=t[1],r=t[2],i=t[3],o=t[4];if(e.dims.length<3||n.dims.length!==1||r.dims.length!==1||i.dims.length!==1||o.dims.length!==1)throw new Error("invalid input shape.");if(n.dims[0]!==e.dims[1]||r.dims[0]!==e.dims[1]||i.dims[0]!==e.dims[1]||o.dims[0]!==e.dims[1])throw new Error("invalid input shape.");if(e.type!=="float32"&&e.type!=="float64"||n.type!=="float32"&&n.type!=="float64"||r.type!=="float32"&&r.type!=="float64"||i.type!=="float32"&&i.type!=="float64"||o.type!=="float32"&&o.type!=="float64")throw new Error("invalid input tensor types.")}}),XM,el,$,P0,KM,Ji=P(()=>{"use strict";XM=class{constructor(t,e,n,r){this.glContext=t,this.programInfo=e,this.inputTextureLayouts=n,this.outputTextureLayout=r}},el=class{constructor(t){this.context=t}},$=class{constructor(t,e){this.routineBody=t,this.dependencies=e}},P0=class{constructor(t,e,n){this.name=t,n?this.dependencies=n:this.dependencies=[],e&&(this.routineBody=e)}addDependency(t){t&&this.dependencies.push(t)}},KM=class{static returnOrderedNodes(t){if(!t||t.length===0)return[];if(t.length===1)return t;let e=new Set,n=new Set,r=new Array;return this.createOrderedNodes(t,e,n,r),r}static createOrderedNodes(t,e,n,r){for(let i=0;i<t.length;++i)this.dfsTraverse(t[i],e,n,r)}static dfsTraverse(t,e,n,r){if(!t||n.has(t.name))return;if(e.has(t.name))throw new Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");e.add(t.name);let i=t.dependencies;if(i&&i.length>0)for(let o=0;o<i.length;++o)this.dfsTraverse(i[o],e,n,r);r.push(t),n.add(t.name),e.delete(t.name)}}});function o5(){let t="add_";return{body:`
  float ${t}(float a, float b) {
    return a + b;
  }
  vec4 ${t}(vec4 v1, vec4 v2) {
    return v1 + v2;
  }
  `,name:t,type:0}}function s5(){let t="div_";return{body:`
  float ${t}(float a, float b) {
    return a / b;
  }
  vec4 ${t}(vec4 v1, vec4 v2) {
    return v1 / v2;
  }
  `,name:t,type:0}}function a5(){let t="mul_";return{body:`
  float ${t}(float a, float b) {
    return a * b;
  }
  vec4 ${t}(vec4 v1, vec4 v2) {
    return v1 * v2;
  }
  `,name:t,type:0}}function l5(){let t="sub_";return{body:`
  float ${t}(float a, float b) {
    return a - b;
  }
  vec4 ${t}(vec4 v1, vec4 v2) {
    return v1 - v2;
  }
  `,name:t,type:0}}function c5(){let t="equal_";return{body:`
  float ${t}(float a, float b) {
    return float(a == b);
  }
  vec4 ${t}(vec4 v1, vec4 v2) {
    return vec4(equal(v1, v2));
  }
  `,name:t,type:0}}function u5(){let t="greater_";return{body:`
  float ${t}(float a, float b) {
    return float(a > b);
  }
  vec4 ${t}(vec4 v1, vec4 v2) {
    return vec4( v1.r > v2.r ,
      v1.g > v2.g,
      v1.b > v2.b,
      v1.a > v2.a );
  }
  `,name:t,type:0}}function d5(){let t="less_";return{body:`
  float ${t}(float a, float b) {
    return float(a < b);
  }
  vec4 ${t}(vec4 v1, vec4 v2) {
    return vec4( v1.r < v2.r ,
                v1.g < v2.g,
                v1.b < v2.b,
                v1.a < v2.a );
  }
  `,name:t,type:0}}function h5(){let t="and_";return{body:`
  float ${t}(float a, float b) {
    return float( bool(a) && bool(b) );
  }
  vec4 ${t}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r && b2.r ,
                b1.g && b2.g,
                b1.b && b2.b,
                b1.a && b2.a );
  }
  `,name:t,type:0}}function f5(){let t="or_";return{body:`
  float ${t}(float a, float b) {
    return float( bool(a) || bool(b) );
  }
  vec4 ${t}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r || b2.r ,
                b1.g || b2.g,
                b1.b || b2.b,
                b1.a || b2.a );
  }
  `,name:t,type:0}}function p5(){let t="xor_";return{body:`
  float ${t}(float a, float b) {
    return float( bool(a) ^^ bool(b) );
  }
  vec4 ${t}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r ^^ b2.r ,
                b1.g ^^ b2.g,
                b1.b ^^ b2.b,
                b1.a ^^ b2.a );
  }
  `,name:t,type:0}}function g5(){return y5("pow")}function m5(){let t="prelu_";return{body:`
  float ${t}(float a, float b) {
    return a < 0.0 ? a * b: a;
  }
  vec4 ${t}(vec4 v1, vec4 v2) {
    return vec4(
      v1.r < 0.0 ? v1.r * v2.r: v1.r,
      v1.g < 0.0 ? v1.g * v2.g: v1.g,
      v1.b < 0.0 ? v1.b * v2.b: v1.b,
      v1.a < 0.0 ? v1.a * v2.a: v1.a
      );
  }
  `,name:t,type:0}}function y5(t){let e=`${t}_`;return{body:`
  float ${e}(float a, float b) {
    return ${t}(a, b);
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return ${t}(v1, v2);
  }
  `,name:e,type:0}}var Sn,ZI,ZM,QM,JM,eP,tP,nP,rP,iP,oP,sP,aP,lP,v5=P(()=>{"use strict";Oe(),Ji(),Ze(),xe(),Sn=(t,e,n,r=e[0].type,i)=>{let o=t.session.pack?2:0;return{name:n.name,inputNames:["A","B"],inputTypes:[o,o],cacheHint:i,get:()=>ZI(t,e,n,r)}},ZI=(t,e,n,r=e[0].type)=>{let i=t.session.pack?2:0,o=!oe.areEqual(e[0].dims,e[1].dims),l=e[0].dims,a=t.session.pack;if(o){let u=Ir.calcShape(e[0].dims,e[1].dims,!1);if(!u)throw new Error("Can't perform binary op on the given tensors");l=u;let d=l.length,h=e[0].dims.length!==0?e[0].dims.length:1,f=e[1].dims.length!==0?e[1].dims.length:1,p=e[0].dims.length!==0?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",g=e[1].dims.length!==0?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",y=be(t.session.backend.glContext.version),b=a?`
      ${n.body}
      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();
        vec4 result = ${n.name}(a, b);
        ${y.output} = result;
      }`:`
      ${n.body}
      float process(int indices[${d}]) {
        int aindices[${h}];
        int bindices[${f}];
        ${p}
        ${g}
        return ${n.name}(_A(aindices), _B(bindices));
      }`;return{name:n.name,inputNames:["A","B"],inputTypes:[i,i],output:{dims:l,type:r,textureType:i},shaderSource:b,hasMain:a}}let c=be(t.session.backend.glContext.version),s=`
    ${n.body}
    void main() {
      vec4 v1 = ${c.texture2D}(A, TexCoords);
      vec4 v2 = ${c.texture2D}(B, TexCoords);
      vec4 result = ${n.name}(v1, v2);
      ${c.output} = result;
    }
    `;return{name:n.name,inputNames:["A","B"],inputTypes:[i,i],output:{dims:e[0].dims,type:r,textureType:i},shaderSource:s,hasMain:!0}},ZM=(t,e)=>[t.run(Sn(t,e,o5()),e)],QM=(t,e)=>[t.run(Sn(t,e,h5(),"bool"),e)],JM=(t,e)=>[t.run(Sn(t,e,s5()),e)],eP=(t,e)=>[t.run(Sn(t,e,c5(),"bool"),e)],tP=(t,e)=>[t.run(Sn(t,e,u5(),"bool"),e)],nP=(t,e)=>[t.run(Sn(t,e,d5(),"bool"),e)],rP=(t,e)=>[t.run(Sn(t,e,a5()),e)],iP=(t,e)=>[t.run(Sn(t,e,f5(),"bool"),e)],oP=(t,e)=>[t.run(Sn(t,e,g5()),e)],sP=(t,e)=>[t.run(Sn(t,e,m5()),e)],aP=(t,e)=>[t.run(Sn(t,e,l5()),e)],lP=(t,e)=>[t.run(Sn(t,e,p5(),"bool"),e)]}),cP,uP,QI,b5=P(()=>{"use strict";Oe(),cP=(t,e,n)=>(QI(e),[t.cast(e[0],n)]),uP=t=>In.tensorDataTypeFromProto(t.attributes.getInt("to")),QI=t=>{if(!t||t.length!==1)throw new Error("Cast requires 1 input.");if(t[0].type==="string")throw new Error("Invalid input type.")}}),JI,eO,dP,Mc,w5=P(()=>{"use strict";Ze(),xe(),si(),Ja(),JI=(t,e)=>({name:"Concat (packed)",inputNames:Array.from({length:t},(n,r)=>`X${r}`),inputTypes:Array(t).fill(2),cacheHint:e}),eO=(t,e,n,r)=>{let i=n[0].dims.slice();if(r>=i.length||r<-1*i.length)throw new Error("axis specified for concat doesn't match input dimensionality");r<0&&(r=i.length+r);let o=i.slice(0);for(let k=1;k<n.length;k++){let V=n[k].dims.slice();for(let G=0;G<i.length;G++)if(G===r)o[r]+=V[G];else if(i[G]!==V[G])throw new Error("non concat dimensions must match")}let l=o.length,a=ow("coords",l),c=Qi(l),s=ru(),u=n.map(k=>k.dims),d=Za(l),h=new Array(u.length-1);h[0]=u[0][r];for(let k=1;k<h.length;k++)h[k]=h[k-1]+u[k][r];let f=d[r],p=d.slice(-2),g=d.join(),y=`if (${f} < ${h[0]}) {
        return getChannel(
            getX0(${g}), vec2(${p.join()}));
        }`;for(let k=1;k<h.length;k++){let V=h[k-1];y+=`
            if (${f} < ${h[k]}  && ${f} >= ${h[k-1]}) {
              return getChannel(
                getX${k}(${Mc(d,f,V)}),
                vec2(${Mc(p,f,V)}));
            }`}let b=h.length,v=h[h.length-1];y+=`
            return getChannel(
              getX${b}(${Mc(d,f,v)}),
              vec2(${Mc(p,f,v)}));`;let _=be(t.session.backend.glContext.version),I=`
          ${s}
          float getValue(${d.map(k=>"int "+k)}) {
            ${y}
          }

          void main() {
            ${c} coords = getOutputCoords();
            int lastDim = coords.${d[l-1]};
            coords.${d[l-1]} = coords.${d[l-2]};
            coords.${d[l-2]} = lastDim;

            vec4 result = vec4(getValue(${a}), 0., 0., 0.);

            ${a[l-1]} = ${a[l-1]} + 1;
            if (${a[l-1]} < ${o[l-1]}) {
              result.g = getValue(${a});
            }

            ${a[l-2]} = ${a[l-2]} + 1;
            if (${a[l-2]} < ${o[l-2]}) {
              result.a = getValue(${a});
            }

            ${a[l-1]} = ${a[l-1]} - 1;
            if (${a[l-2]} < ${o[l-2]} &&
                ${a[l-1]} < ${o[l-1]}) {
              result.b = getValue(${a});
            }
            ${_.output} = result;
          }
        `;return N(C({},e),{output:{dims:o,type:n[0].type,textureType:2},shaderSource:I,hasMain:!0})},dP=(t,e,n)=>{let r=JI(e.length,n.cacheKey);return N(C({},r),{get:()=>eO(t,r,e,n.axis)})},Mc=(t,e,n)=>{let r=t.indexOf(e);return t.map((i,o)=>o===r?`${i} - ${n}`:i).join()}}),hP,tO,nO,rO,$b,iO,oO,sO,fP,aO,_5=P(()=>{"use strict";Pt(),xe(),w5(),hP=(t,e,n)=>(aO(e),t.session.pack&&e[0].dims.length>1?[t.run(dP(t,e,n),e)]:[t.run(rO(t,e,n),e)]),tO=(t,e)=>({name:"Concat",inputNames:Array.from({length:t},(n,r)=>`X${r}`),inputTypes:Array(t).fill(0),cacheHint:e}),nO=(t,e,n,r)=>{let i=n[0].dims.slice();if(r>=i.length||r<-1*i.length)throw new Error("axis specified for concat doesn't match input dimensionality");r<0&&(r=i.length+r);let o=i.slice(0);for(let f=1;f<n.length;f++){let p=n[f].dims.slice();for(let g=0;g<i.length;g++)if(g===r)o[r]+=p[g];else if(i[g]!==p[g])throw new Error("non concat dimensions must match")}let l=o.length,a=new Array(n.length),c=0;for(let f=0;f<a.length;++f)c+=n[f].dims[r],a[f]=c;let s="";n.length<5?s=$b(a):s=iO(a);let u=oO(n.length,l),d=sO(a),h=`
        ${u}
        ${d}
        ${s}
        float process(int indices[${l}]) {
          int textureIndex = getTextureWhereDataResides (indices[${r}]);

          if(textureIndex != 0) {
            indices[${r}] = indices[${r}] - int(getSizeInConcatAxisValueFromIndex(textureIndex-int(1)));
          }

          return fetchDataFromCorrectTexture(textureIndex, indices);
        }`;return N(C({},e),{output:{dims:o,type:n[0].type,textureType:0},shaderSource:h})},rO=(t,e,n)=>{let r=tO(e.length,n.cacheKey);return N(C({},r),{get:()=>nO(t,r,e,n.axis)})},$b=t=>`int getTextureWhereDataResides(int index) {
      ${t.map((e,n)=>`if(index<${e}) {return ${n};}
`).join("")}
    }`,iO=t=>$b(t),oO=(t,e)=>{let n=[`float fetchDataFromCorrectTexture(int textureIndex, int indices[${e}]) {`];for(let r=0;r<t;++r)r===0?n.push(`	if (textureIndex == ${r}) { return _X${r}(indices); }`):r===t-1?n.push(`	else { return _X${r}(indices); }`):n.push(`	else if (textureIndex == ${r}) { return _X${r}(indices); }`);return n.push("	}"),n.join(`
`)},sO=t=>{let e=["int getSizeInConcatAxisValueFromIndex(int index) {"];for(let n=0;n<t.length;++n)n===0?e.push(`	if (index == ${n}) { return ${t[n]}; }`):n===t.length-1?e.push(`	else { return ${t[n]}; }`):e.push(`	else if (index == ${n}) { return ${t[n]}; }`);return e.push("	}"),e.join(`
`)},fP=t=>$e({axis:t.attributes.getInt("axis")}),aO=t=>{if(!t||t.length<1)throw new Error("too few inputs");let e=t[0].type,n=t[0].dims.length;if(e==="string")throw new Error("string tensor is not supported yet");for(let r of t){if(r.type!==e)throw new Error("input tensors should be one type");if(r.dims.length!==n)throw new Error("input tensors should have the same shape")}}});function T5(){return Yn("abs")}function x5(){return Yn("acos")}function E5(){return Yn("asin")}function C5(){return Yn("atan")}function S5(){return Yn("ceil")}function D5(){return Yn("cos")}function I5(t){let e="elu";return{body:`
  const float alpha = float(${t});

  float ${e}_(float a) {
    return a >= 0.0 ? a: (exp(a) - 1.0) * alpha;
  }
  vec4 ${e}_(vec4 v) {
    return vec4(${e}_(v.x), ${e}_(v.y), ${e}_(v.z), ${e}_(v.w));
  }
  `,name:e,type:0}}function O5(){return Yn("exp")}function A5(){return Yn("floor")}function pP(t,e){let n="clip";return{body:`
  const float min = float(${t});
  const float max = float(${e});

  float ${n}_(float a) {
    return clamp(a, min, max);
  }
  vec4 ${n}_(vec4 v) {
    return clamp(v, min, max);
  }
  `,name:n,type:0}}function M5(){let t="indentity";return{body:`
  float ${t}_(float a) {
    return a;
  }
  vec4 ${t}_(vec4 v) {
    return v;
  }
  `,name:t,type:0}}function P5(t){let e="leakyRelu";return{body:`
  const float alpha = float(${t});

  float ${e}_(float a) {
    return a < 0.0 ? a * alpha : a;
  }
  vec4 ${e}_(vec4 v) {
    return vec4(${e}_(v.x), ${e}_(v.y), ${e}_(v.z), ${e}_(v.w));
  }
  `,name:e,type:0}}function N5(){return Yn("log")}function R5(){let t="neg";return{body:`
  float ${t}_(float a) {
    return -a;
  }
  vec4 ${t}_(vec4 v) {
    return -v;
  }
  `,name:t,type:0}}function k5(){let t="not";return{body:`
  float ${t}_(float a) {
    return float( ! bool(a) );
  }
  bool ${t}_(bool a) {
    return !a;
  }
  vec4 ${t}_(vec4 v) {
    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));
  }
  bvec4 ${t}_(bvec4 v) {
    return bvec4(!v.x, !v.y, !v.z, !v.w);
  }
  `,name:t,type:0}}function F5(){return Yn("sin")}function gP(){let t="relu";return{body:`
  float ${t}_(float a) {
    return max( a, 0.0 );
  }
  vec4 ${t}_(vec4 v) {
    return max( v, 0.0 );
  }
  `,name:t,type:0}}function mP(){let t="sigmoid";return{body:`
  float ${t}_(float a) {
    return 1.0 / (1.0 + exp(-a));
  }
  vec4 ${t}_(vec4 v) {
    return 1.0 / (1.0 + exp(-v));
  }
  `,name:t,type:0}}function L5(){return Yn("sqrt")}function B5(){return Yn("tan")}function j5(){let t="tanh";return{body:`
  float ${t}_(float a) {
    a = clamp(a, -10., 10.);
    a = exp(2.*a);
    return (a - 1.) / (a + 1.);
  }
  vec4 ${t}_(vec4 v) {
    v = clamp(v, -10., 10.);
    v = exp(2.*v);
    return (v - 1.) / (v + 1.);
  }
  `,name:t,type:0}}function Yn(t){return{body:`
  float ${t}_(float a) {
    return ${t}(a);
  }
  vec4 ${t}_(vec4 v) {
    return ${t}(v);
  }
  `,name:t,type:0}}var lO,ot,yP,vP,bP,wP,N0,_P,TP,cO,xP,EP,CP,SP,DP,IP,R0,OP,AP,MP,PP,NP,RP,kP,FP,LP,BP,jP,VP=P(()=>{"use strict";Pt(),Oe(),Ji(),Ze(),xe(),lO=(t,e,n,r)=>{let i=t.session.pack?2:0,o=be(t.session.backend.glContext.version);return N(C({},e),{output:{dims:n.dims,type:n.type,textureType:i},shaderSource:`
     ${r.body}
     void main() {
       vec4 v = ${o.texture2D}(A, TexCoords);
       v = ${r.name}_(v);
       ${o.output} = v;
     }
     `,hasMain:!0})},ot=(t,e,n,r)=>{let i=t.session.pack?2:0,o={name:n.name,inputTypes:[i],inputNames:["A"],cacheHint:r};return N(C({},o),{get:()=>lO(t,o,e,n)})},yP=(t,e)=>[t.run(ot(t,e[0],T5()),e)],vP=(t,e)=>[t.run(ot(t,e[0],x5()),e)],bP=(t,e)=>[t.run(ot(t,e[0],E5()),e)],wP=(t,e)=>[t.run(ot(t,e[0],C5()),e)],N0=(t,e,n)=>[t.run(ot(t,e[0],pP(n.min,n.max),n.cacheKey),e)],_P=t=>$e({min:t.attributes.getFloat("min",Qc),max:t.attributes.getFloat("max",Jc)}),TP=(t,e)=>{let n=cO(t,e);return N0(t,[e[0]],n)},cO=(t,e)=>{if(e.length>=3&&(!t.session.isInitializer(e[1].dataId)||!t.session.isInitializer(e[2].dataId)))throw new Error("dynamic clip attributes are not allowed");let n=e.length>=3?e[1].numberData[0]:Qc,r=e.length>=3?e[2].numberData[0]:Jc;return $e({min:n,max:r})},xP=(t,e)=>[t.run(ot(t,e[0],S5()),e)],EP=(t,e)=>[t.run(ot(t,e[0],D5()),e)],CP=(t,e,n)=>[t.run(ot(t,e[0],I5(n.alpha),n.cacheKey),e)],SP=t=>$e({alpha:t.attributes.getFloat("alpha",1)}),DP=(t,e)=>[t.run(ot(t,e[0],O5()),e)],IP=(t,e)=>[t.run(ot(t,e[0],A5()),e)],R0=(t,e)=>[t.run(ot(t,e[0],M5()),e)],OP=(t,e,n)=>[t.run(ot(t,e[0],P5(n.alpha),n.cacheKey),e)],AP=t=>$e({alpha:t.attributes.getFloat("alpha",.01)}),MP=(t,e)=>[t.run(ot(t,e[0],N5()),e)],PP=(t,e)=>[t.run(ot(t,e[0],R5()),e)],NP=(t,e)=>[t.run(ot(t,e[0],k5()),e)],RP=(t,e)=>[t.run(ot(t,e[0],gP()),e)],kP=(t,e)=>[t.run(ot(t,e[0],mP()),e)],FP=(t,e)=>[t.run(ot(t,e[0],F5()),e)],LP=(t,e)=>[t.run(ot(t,e[0],L5()),e)],BP=(t,e)=>[t.run(ot(t,e[0],B5()),e)],jP=(t,e)=>[t.run(ot(t,e[0],j5()),e)]});function iu(t){let e;switch(t.activation){case"Relu":e=gP();break;case"Sigmoid":e=mP();break;case"Clip":e=pP(t.clipMin,t.clipMax);break;default:return{activationFunction:"",applyActivation:""}}let n=e.name,r=e.body,i=`value = ${n}_(value);`;return{activationFunction:r,applyActivation:i}}var dp,tl=P(()=>{"use strict";Oe(),VP(),dp=t=>{let e=t.getString("activation","");if(e==="Clip"){let[n,r]=t.getFloats("activation_params",[Qc,Jc]);return{activation:e,clipMax:r,clipMin:n,activationCacheKey:`${e}:${n},${r}`}}return{activation:e,activationCacheKey:e}}}),uO,dO,$P,V5=P(()=>{"use strict";dr(),Ze(),xe(),lw(),tl(),uO=(t,e)=>({name:"GroupedConv",inputNames:t?["X","W","Bias"]:["X","W"],inputTypes:t?[0,0,0]:[0,0],cacheHint:e}),dO=(t,e,n,r)=>{let i=e.length>2?"value += getBias(output_channel);":"",o=e[0].dims.slice(),l=e[1].dims.slice(),a=l[0]/r.group;st.verbose("GroupedConv",`autpPad:${r.autoPad}, dilations:${r.dilations}, group:${r.group}, kernelShape:${r.kernelShape}, pads:${r.pads}, strides:${r.strides}`);let c=Xc(o,l,r.dilations,r.pads,r.strides),s=be(t.session.backend.glContext.version),{activationFunction:u,applyActivation:d}=iu(r),h=`
  const ivec2 strides = ivec2(${r.strides[0]}, ${r.strides[1]});
  const ivec2 pads = ivec2(${r.pads[0]}, ${r.pads[1]});
  ${u}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;
    ivec2 xRCCorner = coords.zw * strides - pads;
    int group_id = output_channel / ${a};

    float value = 0.0;
    for (int wInChannel = 0; wInChannel < ${l[1]}; wInChannel++) {
      int input_channel = group_id * ${l[1]} + wInChannel;
      for (int wHeight = 0; wHeight < ${l[2]}; wHeight++) {
        int xHeight = xRCCorner.x + wHeight * ${r.dilations[0]};

        if (xHeight < 0 || xHeight >= ${o[2]}) {
          continue;
        }

        for (int wWidth = 0; wWidth < ${l[3]}; wWidth++) {
          int xWidth = xRCCorner.y + wWidth * ${r.dilations[1]};
          if (xWidth < 0 || xWidth >= ${o[3]}) {
            continue;
          }

          float xVal = getX(batch, input_channel, xWidth, xHeight);
          float wVal = getW(output_channel, wInChannel, wWidth, wHeight);
          value += xVal*wVal;
        }
      }
    }
    ${i}
    ${d}
    ${s.output} = vec4(value, .0, .0, .0);
  }
`;return N(C({},n),{output:{dims:c,type:e[0].type,textureType:0},shaderSource:h,hasMain:!0})},$P=(t,e,n)=>{let r=uO(e.length>2,n.cacheKey);return N(C({},r),{get:()=>dO(t,e,r,n)})}}),hO,fO,UP,$5=P(()=>{"use strict";Ze(),xe(),Ja(),hO=t=>({name:"Im2Col (packed)",inputNames:["A"],inputTypes:[2],cacheHint:t}),fO=(t,e,n,r,i,o)=>{let l=n.dims,a=r.dims,c=2,s=3,u=i.length,d=[a[1]*a[2]*a[3],i[2]*i[3]],h=a[2]*a[3],f=ru(),p=be(t.session.backend.glContext.version),g="";for(let b=0;b<=1;b++)for(let v=0;v<=1;v++)g+=`
            blockIndex = rc.x + ${v};
            pos = rc.y + ${b};

            if(blockIndex < ${d[1]} && pos < ${d[0]}) {
              offsetY = int(blockIndex / (${i[u-1]})) * ${o.strides[0]} -
                ${o.pads[0]};
              d0 = offsetY + ${o.dilations[0]} * (imod(pos, ${h}) / ${a[2]});

              if(d0 < ${l[c]} && d0 >= 0) {
                offsetX = imod(blockIndex, ${i[u-1]}) * ${o.strides[1]} -
                  ${o.pads[1]};
                d1 = offsetX + ${o.dilations[1]} * imod(imod(pos, ${h}), ${a[2]});

                if(d1 < ${l[s]} && d1 >= 0) {

                  ch = int(float(pos)/ ${h}.);
                    innerDims = vec2(d0, d1);
                    result[${b*2+v}] = getChannel(
                      getA(0, ch, int(innerDims.x),
                      int(innerDims.y)), innerDims);
                }
              }
            }

          `;let y=`
      ${f}

      void main() {
        ivec2 rc = getOutputCoords();
          vec4 result = vec4(0.0);
          int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
          vec2 innerDims;
          ${g}
          ${p.output} = result;
      }
            `;return N(C({},e),{output:{dims:d,type:n.type,textureType:2},shaderSource:y,hasMain:!0})},UP=(t,e,n,r,i)=>{let o=hO(i.cacheKey);return N(C({},o),{get:()=>fO(t,o,e,n,r,i)})}});function U5(t,e,n){let r=e[0].dims,i=e[1].dims,o=Ir.calcShape(r,i,!0);if(!o)throw new Error("Can't use matmul on the given tensors");let l=Qi(o.length),a=Za(),{activationFunction:c,applyActivation:s}=iu(n),u=e.length>2,d=u?"value += getBiasForMatmul();":"",h=u?`${GP(l,a,e[2].dims,o,!1)}`:"",f=o.length,p=r.length,g=i.length,y=r[r.length-1],b=`
    ${c}
    ${h}
    float process(int indices[${f}]) {
        int a[${p}];
        int b[${g}];
        bcastMatmulIndices_A(indices, a);
        bcastMatmulIndices_B(indices, b);

        float value;
        for (int k=0; k<${y}; ++k) {
            a[${p-1}] = k;
            b[${g-2}] = k;
            value += _A(a) * _B(b);
        }
        ${d}
        ${s}
        return value;
    }`;return N(C({},t),{output:{dims:o,type:e[0].type,textureType:0},shaderSource:b})}function HP(t,e){let n=qP(t.length>2,e.activationCacheKey);return N(C({},n),{get:()=>U5(n,t,e)})}function GP(t,e,n,r,i){let o="",l=n.length,a=r.length,c=a-l;a<2&&l>0?o="coords":o=n.map((h,f)=>`coords.${e[f+c]}`).join(", ");let s=Ir.getBroadcastDims(n,r).map(h=>`coords.${e[h+c]} = 0;`).join(`
`),u=oe.size(n)===1,d="vec4(outputValue.xx, outputValue.yy)";return u&&(d="vec4(outputValue.x)"),i?`
vec4 getBiasForMatmul() {
  ${t} coords = getOutputCoords();
  ${s}
  vec4 outputValue = getBias(${o});
  return ${d};
}`:`
float getBiasForMatmul() {
  ${t} coords = getOutputCoords();
  ${s}
  return getBias(coords.x);
}`}var zP,WP,qP,pO,sw=P(()=>{"use strict";Oe(),xe(),si(),tl(),YP(),zP=(t,e,n)=>(pO(e),t.session.pack?[t.run(aw(t,e,n),e)]:[t.run(HP(e,n),e)]),WP=t=>dp(t.attributes),qP=(t,e)=>({name:"MatMul",inputNames:t?["A","B","Bias"]:["A","B"],inputTypes:t?[0,0,0]:[0,0],cacheHint:e}),pO=t=>{if(!t||t.length!==2)throw new Error("MatMul requires 2 inputs.");if(t[0].dims[t[0].dims.length-1]!==t[1].dims[t[1].dims.length-2])throw new Error("shared dimension does not match.");if(t[0].type!=="float32"&&t[0].type!=="float64"||t[1].type!=="float32"&&t[1].type!=="float64")throw new Error("inputs should be float type");if(t[0].type!==t[1].type)throw new Error("inputs types should match")}});function H5(t,e,n,r){let i=[],o=[],l=n[0].dims,a=n[1].dims,c=l.length,s=a.length,u=r.length,d=u-c,h=u-s;i=l.map((v,_)=>`coords.${e[_+d]}`),i[c-1]="i*2",i.join(", "),o=a.map((v,_)=>`coords.${e[_+h]}`),o[s-2]="i*2",o.join(", ");let f=Ir.getBroadcastDims(l,r),p=Ir.getBroadcastDims(a,r),g=f.map(v=>`coords.${e[v+d]} = 0;`).join(`
`),y=p.map(v=>`coords.${e[v+h]} = 0;`).join(`
`),b=`int lastDim = coords.${e[u-1]};
  coords.${e[u-1]} = coords.${e[u-2]};
  coords.${e[u-2]} = lastDim;`;return`
vec4 getAAtOutCoordsMatmul(int i) {
  ${t} coords = getOutputCoords();
  ${b}
  ${g}
  vec4 outputValue = getA(${i});
  return outputValue;
}

vec4 getBAtOutCoordsMatmul(int i) {
  ${t} coords = getOutputCoords();
  ${b}
  ${y}
  vec4 outputValue = getB(${o});
  return outputValue;
}`}function G5(t,e){let n="";for(let r=0;r<e-2;r++)n+=`rc.${t[r]}, `;return n+=`rc.${t[e-2]}, i*2`,n}function z5(t,e){let n="";for(let r=0;r<e-2;r++)n+=`rc.${t[r]}, `;return n+=`i*2, rc.${t[e-1]}`,n}var gO,mO,aw,YP=P(()=>{"use strict";Oe(),Ze(),xe(),si(),tl(),sw(),gO=(t,e)=>({name:"MatMul (packed)",inputNames:t?["A","B","Bias"]:["A","B"],inputTypes:t?[2,2,2]:[2,2],cacheHint:e}),mO=(t,e,n,r)=>{let i=n.length>2,o=i?"value += getBiasForMatmul();":"",l=n[0].dims,a=n[1].dims,c=Ir.calcShape(l,a,!0),s=!oe.areEqual(n[0].dims,n[1].dims);if(!c)throw new Error("Can't use matmul on the given tensors");let u=l[l.length-1],d=Math.ceil(u/2),h=l.length,f=a.length,p=be(t.session.backend.glContext.version),g=Qi(c.length),y=c.length,b=Za(),{activationFunction:v,applyActivation:_}=iu(r),I=i?`${GP(g,b,n[2].dims,c,!0)}`:"",k=s?`${H5(g,b,n,c)}`:"",V=s?"getAAtOutCoordsMatmul(i)":`getA(${G5(b,h)})`,G=s?"getBAtOutCoordsMatmul(i)":`getB(${z5(b,f)})`,j=s?"":`${g} rc =
          getOutputCoords(); int lastDim = rc.${b[y-1]}; rc.${b[y-1]} =
          rc.${b[y-2]}; rc.${b[y-2]} = lastDim;
      `,ge=`
            ${k}
            ${I}
            ${v}
            void main() {
              ${j}

              vec4 value = vec4(0);
              for (int i = 0; i < ${d}; i++) {
                vec4 a = ${V};
                vec4 b = ${G};

                value += (a.rrbb * b.rgrg);
                value += (a.ggaa * b.baba);
              }
              ${o}
              ${_}
              ${p.output} = value;
            }`;return N(C({},e),{output:{dims:c,type:n[0].type,textureType:2},shaderSource:ge,hasMain:!0})},aw=(t,e,n)=>{let r=gO(e.length>2,n.activationCacheKey);return N(C({},r),{get:()=>mO(t,r,e,n)})}}),XP,W5=P(()=>{"use strict";lw(),$5(),YP(),XP=(t,e,n)=>{let r=e[0].dims,i=e[1].dims,o=Xc(r,i,n.dilations,n.pads,n.strides),l=t.run(UP(t,e[0],e[1],o,n),[e[0]]),a=t.reshapePacked(e[1],[i[0],i[1]*i[2]*i[3]]),c=e.length===3?[a,l,e[2]]:[a,l],s=t.run(aw(t,c,n),c);return t.reshapePacked(s,o)}}),yO,vO,KP,k0,ZP=P(()=>{"use strict";xe(),yO=t=>({name:"Im2Col",inputNames:["X"],inputTypes:[0],cacheHint:t}),vO=(t,e,n,r,i,o)=>{let l=n.dims,a=r.dims,c=i.length,s=k0(l,a,i,4),u=`
        const int XC = ${l[1]};
        const int XH = ${l[2]};
        const int XW = ${l[3]};
        const int KH = ${o.kernelShape[0]};
        const int KW = ${o.kernelShape[1]};
        const int dilationH = ${o.dilations[0]};
        const int dilationW = ${o.dilations[1]};
        const int strideH = ${o.strides[0]};
        const int strideW = ${o.strides[1]};
        const int padH = ${o.pads[0]};
        const int padW = ${o.pads[1]};
        const int KHKW = KH*KW;
        const int XCKHKW = XC * KHKW;
        const int outputChannels = 4;
        vec4 process(int indices[${c}]) {
          int b  = indices[0]; // batch size
          int oh = indices[1] * strideH - padH; //output height
          int ow = indices[2] * strideW - padW; //output width
          int p = indices[3] * outputChannels; //patch
          vec4 value = vec4(0.0);
          for(int i=0; i < outputChannels; ++i) {
            if(p < XCKHKW) {
              int patchC = p / KHKW;
              int patchH = (p - patchC*KHKW) / KW;
              int patchW = (p - patchC*KHKW) - patchH * KW;
              int xh2 = oh + patchH * dilationH;
              int xw2 = ow + patchW * dilationW;
              int x[${l.length}];
              x[0] = b;
              x[1] = patchC;
              x[2] = xh2;
              x[3] = xw2;
              if(xh2 >= 0 &&
                  xh2 < XH &&
                  xw2 >= 0 &&
                  xw2 < XW) {
                value[i] = _X(x);
              }
            }
            ++p;
          }
          return value;
        }
        `;return N(C({},e),{output:{dims:s,type:n.type,textureType:4},shaderSource:u})},KP=(t,e,n,r,i)=>{let o=yO(i.cacheKey);return N(C({},o),{get:()=>vO(t,o,e,n,r,i)})},k0=(t,e,n,r=4)=>[n[0],n[2],n[3],Math.ceil(t[1]*e[2]*e[3]/r)]}),bO,wO,QP,q5=P(()=>{"use strict";Oe(),Ze(),xe(),tl(),ZP(),bO=(t,e)=>({name:"ConvDotProduct",inputNames:t?["Im2Col","K","B"]:["Im2Col","K"],inputTypes:t?[0,4,0]:[0,4],cacheKey:e.activationCacheKey}),wO=(t,e,n,r,i)=>{let o=n[0].dims,l=n[1].dims,a=[l[0],Math.ceil(o[1]*l[2]*l[3]/4)],c=k0(o,l,r),[s,u]=t.calculateTextureWidthAndHeight(a,4),d=oe.computeStrides(c),[h,f]=t.calculateTextureWidthAndHeight(c,4),p=r.length,g=n.length<3?"0.0":"_B(b)",y=Math.ceil(o[1]*l[2]*l[3]/4),{activationFunction:b,applyActivation:v}=iu(i),_=be(t.session.backend.glContext.version),I=`
${b}
float process(int indices[${p}]) {
  int b[1];
  b[0] = indices[1];
  int im2col[4];
  im2col[0] = indices[0];
  im2col[1] = indices[2];
  im2col[2] = indices[3];
  int im2colOffset = im2col[0] * ${d[0]} + im2col[1] * ${d[1]} + im2col[2] * ${d[2]};
  int kernelOffset = indices[1] * ${a[1]};
  float value = ${g};
  for (int i = 0; i < ${y}; ++i) {
    vec2 im2colCoords = offsetToCoords(im2colOffset, ${h}, ${f});
    vec2 kernelCoords = offsetToCoords(kernelOffset, ${s}, ${u});
    value += dot(${_.texture2D}(Im2Col, im2colCoords), ${_.texture2D}(K, kernelCoords));
    ++im2colOffset;
    ++kernelOffset;
  }
  ${v}
  return value;
}`;return N(C({},e),{output:{dims:r,type:n[0].type,textureType:0},shaderSource:I})},QP=(t,e,n,r)=>{let i=bO(e.length>2,r);return N(C({},i),{get:()=>wO(t,i,e,n,r)})}}),Xc,F0,_O,TO,xO,EO,L0,CO,lw=P(()=>{"use strict";Pt(),Oe(),V5(),W5(),q5(),tl(),ZP(),sw(),Xc=(t,e,n,r,i)=>{let o=t[0],l=t.slice(2),a=l.length,c=e[0],s=e.slice(2).map((d,h)=>d+(d-1)*(n[h]-1)),u=l.map((d,h)=>d+r[h]+r[h+a]).map((d,h)=>Math.floor((d-s[h]+i[h])/i[h]));return[o,c].concat(...u)},F0=(t,e,n)=>(CO(e,n),_O(t,e,n)),_O=(t,e,n)=>{let r=EO(n,e),i=t.session.pack,o=r.kernelShape[0]===1&&r.kernelShape[1]===1;return r.group>1?[t.run($P(t,e,r),e)]:o&&i?[TO(t,e,r)]:i&&e[0].dims.length===4&&e[0].dims[0]===1&&!o?[XP(t,e,r)]:[xO(t,e,r)]},TO=(t,e,n)=>{let r=e[0].dims,i=e[1].dims,o=Xc(r,i,n.dilations,n.pads,n.strides),l=t.reshapeUnpacked(e[0],[r[1],r[2]*r[3]]),a=t.reshapeUnpacked(e[1],[i[0],i[1]]),c=e.length>2?[a,l,e[2]]:[a,l],s=t.run(HP(c,n),c);return t.reshapeUnpacked(s,o)},xO=(t,e,n)=>{let r=e[0].dims,i=e[1].dims,o=Xc(r,i,n.dilations,n.pads,n.strides),l=t.run(KP(t,e[0],e[1],o,n),[e[0]]),a=e.length===3?[l,e[1],e[2]]:[l,e[1]];return t.run(QP(t,e,o,n),a)},EO=(t,e)=>{let n=t.kernelShape.slice();if(t.kernelShape.length===0)for(let o=2;o<e[1].dims.length;++o)n.push(e[1].dims[o]);let r=t.pads.slice();rp.adjustPadsBasedOnAutoPad(e[0].dims,t.strides,t.dilations,n,r,t.autoPad);let i=Object.assign({},t);return Object.assign(i,{kernelShape:n,pads:r,cacheKey:t.cacheKey}),i},L0=t=>{let e=t.attributes,n=dp(e),r=e.getString("auto_pad","NOTSET"),i=e.getInts("dilations",[1,1]),o=e.getInt("group",1),l=e.getInts("kernel_shape",[]),a=e.getInts("pads",[0,0,0,0]),c=e.getInts("strides",[1,1]);return $e(C({autoPad:r,dilations:i,group:o,kernelShape:l,pads:a,strides:c},n))},CO=(t,e)=>{if(!t||t.length!==2&&t.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(t[0].dims.length!==4||t[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");let n=t[0].dims[1],r=t[1].dims[1]*e.group;if(n!==r)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(t.length===3&&(t[2].dims.length!==1||t[1].dims[0]!==t[2].dims[0]))throw new Error("invalid bias");let i=t[0].dims.length-2;if(e.dilations.length!==i)throw new Error(`dilations should be ${i}D`);if(e.strides.length!==i)throw new Error(`strides should be ${i}D`);if(e.pads.length!==i*2)throw new Error(`pads should be ${i*2}D`);if(e.kernelShape.length!==0&&e.kernelShape.length!==t[1].dims.length-2)throw new Error("invalid kernel shape");if(t[0].type!=="float32"||t[1].type!=="float32")throw new Error("Conv input(X,W) should be float tensor");if(t.length===3&&t[2].type!=="float32")throw new Error("Conv input(bias) should be float tensor")}}),SO,DO,IO,JP,OO,AO,MO,PO,NO,RO,eN,kO,Y5=P(()=>{"use strict";Pt(),Ze(),xe(),tl(),SO=(t,e,n,r,i,o)=>(t-1)*e+n+(r-1)*i+1-o,DO=(t,e,n,r,i)=>{let o=Math.floor(t/2);e==="SAME_UPPER"?(n[r]=o,n[i]=t-o):e==="SAME_LOWER"&&(n[r]=t-o,n[i]=o)},IO=(t,e,n,r,i,o,l,a)=>{let c=t.length-2,s=a.length===0;for(let u=0;u<c;++u){let d=s?t[u+2]*o[u]:a[u],h=SO(t[u+2],o[u],i[u],e[u],n[u],d);DO(h,r,i,u,u+c),s&&a.push(o[u]*(t[u+2]-1)+l[u]+(e[u]-1)*n[u]+1-i[u]-i[u+c])}},JP=(t,e,n)=>(kO(e,n),OO(t,e,n)),OO=(t,e,n)=>{let r=RO(n,e);return[NO(t,e,r)]},AO=(t,e)=>({name:"ConvTranspose",inputNames:t?["X","W","B"]:["X","W"],inputTypes:t?[0,0,0]:[0,0],cacheHint:e}),MO=(t,e,n,r)=>{let i=e.length>2?"getB(output_channel)":"0.0",o=e[0].dims,l=e[1].dims,a=l[1],c=l[0]/r.group,s=[e[0].dims[0],e[1].dims[1]*r.group,...r.outputShape],u=be(t.session.backend.glContext.version),{activationFunction:d,applyActivation:h}=iu(r),f=`
  const ivec2 strides = ivec2(${r.strides[0]}, ${r.strides[1]});
  const ivec2 pads = ivec2(${r.pads[0]}, ${r.pads[1]});
  ${d}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;

    ivec2 loc = coords.zw + pads;

    int group_id = output_channel / ${a};
    int wOutChannel = output_channel - group_id * ${a};

    float value = ${i};
    for (int inChannelOffset = 0; inChannelOffset < ${c}; inChannelOffset++) {
      int input_channel = group_id * ${c} + inChannelOffset;
      for (int wWOff = 0; wWOff < ${l[2]}; wWOff++) {
        for (int wHOff = 0; wHOff < ${l[3]}; wHOff++) {
          ivec2 wOff = ivec2(wWOff * ${r.dilations[0]}, wHOff * ${r.dilations[1]});
          ivec2 wLoc = loc - wOff;
          ivec2 wLocIn = wLoc / strides;
          if (
            wLocIn * strides == wLoc &&
            wLocIn.x >= 0 && wLocIn.x < ${o[2]} &&
            wLocIn.y >= 0 && wLocIn.y < ${o[3]}
          ) {
            float xVal = getX(batch, input_channel, wLocIn.y, wLocIn.x);
            float wVal = getW(input_channel, wOutChannel, wHOff, wWOff);
            value += xVal * wVal;
          }
        }
      }
    }
    ${h}
    ${u.output} = vec4(value, .0, .0, .0);
  }
`;return N(C({},n),{output:{dims:s,type:e[0].type,textureType:0},shaderSource:f,hasMain:!0})},PO=(t,e,n)=>{let r=AO(e.length>2,n.cacheKey);return N(C({},r),{get:()=>MO(t,e,r,n)})},NO=(t,e,n)=>t.run(PO(t,e,n),e),RO=(t,e)=>{let n=t.kernelShape.slice();if(t.kernelShape.length===0)for(let a=2;a<e[1].dims.length;++a)n.push(e[1].dims[a]);let r=t.pads.slice(),i=t.outputShape.slice(),o=e[0].dims;IO(o,n,t.dilations,t.autoPad,r,t.strides,t.outputPadding,i);let l=Object.assign({},t);return Object.assign(l,{kernelShape:n,pads:r,outputShape:i,cacheKey:t.cacheKey}),l},eN=t=>{let e=t.attributes,n=dp(e),r=e.getString("auto_pad","NOTSET"),i=e.getInts("dilations",[1,1]),o=e.getInt("group",1),l=e.getInts("kernel_shape",[]),a=e.getInts("output_padding",[0,0]),c=e.getInts("output_shape",[]),s=e.getInts("pads",[0,0,0,0]),u=e.getInts("strides",[1,1]);return $e(C({autoPad:r,dilations:i,group:o,kernelShape:l,outputPadding:a,outputShape:c,pads:s,strides:u},n))},kO=(t,e)=>{if(!t||t.length!==2&&t.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(t[0].dims.length!==4||t[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");let n=t[0].dims[1],r=t[1].dims[0];if(n!==r)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let i=t[1].dims[1]*e.group;if(t.length===3&&(t[2].dims.length!==1||t[2].dims[0]!==i))throw new Error("invalid bias");let o=t[0].dims.length-2;if(e.dilations.length!==o)throw new Error(`dilations should be ${o}D`);if(e.strides.length!==o)throw new Error(`strides should be ${o}D`);if(e.pads.length!==o*2)throw new Error(`pads should be ${o*2}D`);if(e.outputPadding.length!==o)throw new Error(`output_padding should be ${o}D`);if(e.kernelShape.length!==0&&e.kernelShape.length!==t[1].dims.length-2)throw new Error("invalid kernel shape");if(e.outputShape.length!==0&&e.outputShape.length!==t[0].dims.length-2)throw new Error("invalid output shape");if(t[0].type!=="float32"||t[1].type!=="float32")throw new Error("ConvTranspose input(X,W) should be float tensor");if(t.length===3&&t[2].type!=="float32")throw new Error("ConvTranspose input(bias) should be float tensor")}}),Ub,eu,tN,FO,Hb,LO,BO,jO,cw=P(()=>{"use strict";Pt(),Oe(),xe(),Ub={name:"Transpose",inputNames:["A"],inputTypes:[0]},eu=(t,e,n)=>(jO(e),[t.run(N(C({},Ub),{cacheHint:n.cacheKey,get:()=>FO(t,e[0],n.perm)}),e)]),tN=t=>$e({perm:t.attributes.getInts("perm",[])}),FO=(t,e,n)=>{let r=e.dims;n=Hb(r,n);let i=LO(r,n),o=r.length,l=`
      ${BO("perm",n,o)}
      float process(int indices[${o}]) {
        int a[${o}];
        perm(a, indices);
        return _A(a);
      }`;return N(C({},Ub),{output:{dims:i,type:e.type,textureType:0},shaderSource:l})},Hb=(t,e)=>(e&&e.length!==t.length&&(e=[...t.keys()].reverse()),e),LO=(t,e)=>(e=Hb(t,e),oe.sortBasedOnPerm(t,e)),BO=(t,e,n)=>{let r=[];r.push(`void ${t}(out int a[${n}], int src[${n}]) {`);for(let i=0;i<n;++i)r.push(`	a[${e[i]}]=src[${i}];`);return r.push("	}"),r.join(`
`)},jO=t=>{if(!t||t.length!==1)throw new Error("Transpose requires 1 input.");if(t[0].type!=="float32"&&t[0].type!=="float64")throw new Error("input should be float tensor")}}),nN,rN,VO,X5=P(()=>{"use strict";cw(),nN=(t,e,n)=>{VO(e);let r=n.blocksize,i=r*r,o=n.mode==="DCR"?[0,3,4,1,5,2]:[0,1,4,2,5,3],l=n.mode==="DCR"?[e[0].dims[0],r,r,e[0].dims[1]/i,e[0].dims[2],e[0].dims[3]]:[e[0].dims[0],e[0].dims[1]/i,r,r,e[0].dims[2],e[0].dims[3]],a=t.reshapeUnpacked(e[0],l),c={perm:o,cacheKey:`${o}`},[s]=eu(t,[a],c),u=[e[0].dims[0],e[0].dims[1]/i,e[0].dims[2]*r,e[0].dims[3]*r];return[t.reshapeUnpacked(s,u)]},rN=t=>{let e=t.attributes.getInt("blocksize");if(e<1)throw new Error(`blocksize must be >= 1, but got : ${e} for DepthToSpace`);let n=t.attributes.getString("mode","DCR");if(n!=="DCR"&&n!=="CRD")throw new Error(`unrecognized mode: ${n} for DepthToSpace`);return{mode:n,blocksize:e}},VO=t=>{if(t.length!==1)throw new Error(`DepthToSpace expect 1 inputs, but got ${t.length}`);if(t[0].type==="string"||t[0].dims.length!==4)throw new TypeError("DepthToSpace input should be a 4-D numeric tensor")}}),iN,oN,$O,K5=P(()=>{"use strict";Oe(),iN=(t,e,n)=>{$O(e,n);let r=oe.flattenShape(e[0].dims,n);return[t.reshapeUnpacked(e[0],r)]},oN=t=>t.attributes.getInt("axis",1),$O=(t,e)=>{if(!t||t.length!==1)throw new Error("Flatten requires 1 input.");let n=t[0].dims.length;if(n===0)throw new Error("scalar tensor is not supported.");if(e<-n||e>n)throw new Error("Invalid axis");if(t[0].type==="string")throw new Error("string tensor is not supported.")}}),ou,hp=P(()=>{"use strict";ou=["float32","float64","int32","int16","int8","uint16","uint32","uint8"]}),sN,aN,UO,HO,GO,zO,Z5=P(()=>{"use strict";Pt(),hp(),Oe(),xe(),sN=(t,e,n)=>(zO(e,n.axis),[t.run(GO(t,e,n),e)]),aN=t=>$e({axis:t.attributes.getInt("axis",0)}),UO={name:"Gather",inputNames:["A","B"],inputTypes:[0,0]},HO=(t,e,n,r)=>{let i=n[0].dims.slice(),o=n[1].dims.slice(),l=new Array(i.length+o.length-1);r=oe.normalizeAxis(r,i.length);let a=[];for(let h=0;h<l.length;h++)h<r?(l[h]=i[h],a.push(`inputIdx[${h}] = outputIdx[${h}];`)):h<r+o.length?(l[h]=o[h-r],a.push(`indexDataIdx[${h-r}] = outputIdx[${h}];`)):(l[h]=i[h-o.length+1],a.push(`inputIdx[${h-o.length+1}] = outputIdx[${h}];`));let c=l.length||1,s=i.length,u=o.length||1,d=`
      float process(int outputIdx[${c}]) {
        int inputIdx[${s}];
        int indexDataIdx[${u}];
        indexDataIdx[0] = 0;
        ${a.join(`
        `)}
        int idx = int(_B(indexDataIdx));
        inputIdx[${r}] = idx < 0 ? idx + ${i[r]} : idx;
        return _A(inputIdx);
      }`;return N(C({},e),{output:{dims:l,type:n[0].type,textureType:0},shaderSource:d})},GO=(t,e,n)=>{let r=N(C({},UO),{cacheHint:n.cacheKey});return N(C({},r),{get:()=>HO(t,r,e,n.axis)})},zO=(t,e)=>{if(!t||t.length!==2)throw new Error("Gather requires 2 inputs.");let n=t[0].dims.length;if(n<1)throw new Error("Invalid input shape.");if(e<-n||e>n-1)throw new Error("Invalid axis.");if(ou.indexOf(t[0].type)===-1)throw new Error("Invaid input type.");if(t[1].type!=="int32"&&t[1].type!=="int16")throw new Error("Invaid input type.")}}),B0,Gb,lN,cN,WO,qO,YO,Q5=P(()=>{"use strict";Pt(),Oe(),xe(),B0=(t,e,n)=>(YO(e,n),[t.run(WO(e,n),e)]),Gb=(t,e)=>{let n=t.attributes.getInt("transA",0)!==0,r=t.attributes.getInt("transB",0)!==0,i=t.attributes.getFloat("alpha",1),o=t.attributes.getFloat("beta",1);return $e({transA:n,transB:r,alpha:i,beta:o,isOptionalC:e})},lN=t=>Gb(t,!1),cN=t=>Gb(t,!0),WO=(t,e)=>{let n={name:"Gemm",inputNames:t.length===3?["A","B","C"]:["A","B"],inputTypes:t.length===3?[0,0,0]:[0,0],key:e.cacheKey};return N(C({},n),{get:()=>qO(n,t,e)})},qO=(t,e,n)=>{let r=e[0].dims.slice(),i=e[1].dims.slice(),[o,l]=kM.getShapeOfGemmResult(r,n.transA,i,n.transB,e.length===3?e[2].dims:void 0),a=[o,l];if(!a)throw new Error("Can't use gemm on the given tensors");let c=r[r.length-1],s="";n.transA&&(c=r[0]),n.transA&&n.transB?s="value += _A_T(a) * _B_T(b);":n.transA&&!n.transB?s="value += _A_T(a) * _B(b);":!n.transA&&n.transB?s="value += _A(a) * _B_T(b);":!n.transA&&!n.transB&&(s="value += _A(a) * _B(b);");let u=a.length,d=e.length===3?`int c[${e[2].dims.length}];`:"",h=e.length===3?"bcastIndices_C(indices, c);":"",f=e.length===3?"value += beta * _C(c);":"",p=`
      float process(int indices[${u}]) {
          int a[${u}];
          int b[${u}];
          ${d}

          copyVec(indices, a);
          copyVec(indices, b);
          ${h}

          float value = 0.0;
          for (int k=0; k<${c}; ++k) {
              a[${u-1}] = k;
              b[${u-2}] = k;
              ${s}
          }

          value = value * alpha;
          ${f}
          return value;
      }`;return N(C({},t),{output:{dims:a,type:e[0].type,textureType:0},variables:[{name:"alpha",type:"float",data:n.alpha},{name:"beta",type:"float",data:n.beta}],shaderSource:p})},YO=(t,e)=>{if(!t)throw new Error("Input is missing");if(e.isOptionalC&&(t.length<2||t.length>3))throw new Error("Invaid input shape.");if(!e.isOptionalC&&t.length!==3)throw new Error("Gemm requires 3 inputs");if(t.length===3&&t[2].dims.length!==1&&t[2].dims.length!==2)throw new Error("Invalid input shape of C");if(t[0].type!=="float32"&&t[0].type!=="float64"||t[1].type!=="float32"&&t[1].type!=="float64"||t.length===3&&t[2].type!=="float32"&&t[2].type!=="float64")throw new Error("Invalid input type.");if(t[0].type!==t[1].type||t.length===3&&t[0].type!==t[2].type)throw new Error("Input types are mismatched")}}),uN,dN,XO,KO,ZO,QO,JO,J5=P(()=>{"use strict";Pt(),xe(),uN=(t,e,n)=>(JO(e),[t.run(ZO(t,e,n),e)]),dN=t=>{let e=t.attributes.getFloat("scale"),n=t.attributes.getFloats("bias");return $e({scale:e,bias:n})},XO={name:"ImageScaler",inputNames:["X"],inputTypes:[0]},KO=(t,e,n,r)=>{let i=n[0].dims.slice(),o=i.length,l=`
      ${QO(r.bias.length)}
      float process(int indices[${o}]) {
        return _X(indices) * scale + getBias(bias, indices[1]);
      }`;return N(C({},e),{output:{dims:i,type:n[0].type,textureType:0},variables:[{name:"bias",type:"float",arrayLength:r.bias.length,data:r.bias},{name:"scale",type:"float",data:r.scale}],shaderSource:l})},ZO=(t,e,n)=>{let r=N(C({},XO),{cacheHint:n.cacheKey});return N(C({},r),{get:()=>KO(t,r,e,n)})},QO=t=>{let e=[`float getBias(float bias[${t}], int channel) {`];for(let n=0;n<t;++n)n===0?e.push(`	if (channel == ${n}) { return bias[${n}]; }`):n===t-1?e.push(`	else { return bias[${n}]; }`):e.push(`	else if (channel == ${n}) { return bias[${n}]; }`);return e.push("	}"),e.join(`
`)},JO=t=>{if(!t||t.length!==1)throw new Error("ImageScaler requires 1 input.");if(t[0].dims.length!==4)throw new Error("Invalid input shape.");if(t[0].type!=="float32"&&t[0].type!=="float64")throw new Error("Invalid input type.")}}),hN,fN,zb,eA,tA,nA,rA,iA,oA,e8=P(()=>{"use strict";Ze(),xe(),hN=(t,e,n)=>{oA(e);let r=t.run(tA(e[0]),e);return[t.run(iA(t,e[0],n,r.dims),[e[0],r,e[1],e[2]])]},fN=t=>t.attributes.getFloat("epsilon",1e-5),zb={name:"InstanceNormalization_MeanAndVariance",inputNames:["X"],inputTypes:[0]},eA=(t,e)=>{let n=e.dims.slice(),r=n[1],i=n[2]*n[3],o=[n[0],r],l=`
      vec4 process(int[2] indices) {
        vec4 v = vec4(0.0);
        int a[4];
        a[0] = indices[0];
        a[1] = indices[1];
        float temp = 0.0;
        for(int a2=0; a2<${n[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${n[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += x;
          }
        }
        float mean = temp / float(${i});
        temp = 0.0;
        for(int a2=0; a2<${n[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${n[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += (x - mean) * (x - mean);
          }
        }
        v.r = mean;
        v.g = temp / float(${i});

        return v;
      }`;return N(C({},t),{output:{dims:o,type:e.type,textureType:4},shaderSource:l})},tA=t=>N(C({},zb),{get:()=>eA(zb,t)}),nA={name:"InstanceNormalization_ComputeOutput",inputNames:["X","MeanAndVariance","Scale","B"],inputTypes:[0,4,0,0]},rA=(t,e,n,r,i)=>{let o=be(t.session.backend.glContext.version),[l,a]=t.calculateTextureWidthAndHeight(i,4),[c,s]=[l/4,a],u=`
      vec4 get_MeanAndVariance(int[2] mv) {
        int offset = indicesToOffset_MeanAndVariance(mv);
        vec2 coords = offsetToCoords(offset, ${c}, ${s});
        return ${o.texture2D}(MeanAndVariance, coords);
      }

      float process(int[4] indices) {
        int mv[2];
        mv[0] = indices[0];
        mv[1] = indices[1];
        vec4 mean_and_variance = get_MeanAndVariance(mv);
        float mean = mean_and_variance.r;
        float variance = mean_and_variance.g;

        int sb[1];
        sb[0] = indices[1];
        float scale = _Scale(sb);
        float b = _B(sb);

        return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;
      }`;return N(C({},e),{output:{dims:n.dims,type:n.type,textureType:0},variables:[{name:"epsilon",type:"float",data:r}],shaderSource:u})},iA=(t,e,n,r)=>{let i=N(C({},nA),{cacheHint:`${n}`});return N(C({},i),{get:()=>rA(t,i,e,n,r)})},oA=t=>{if(!t||t.length!==3)throw new Error("InstanceNormalization requires 3 inputs.");let e=t[0],n=t[1],r=t[2];if(e.dims.length<3||n.dims.length!==1||r.dims.length!==1)throw new Error("Invalid input shape.");if(n.dims[0]!==e.dims[1]||r.dims[0]!==e.dims[1])throw new Error("Input shapes are mismatched.");if(e.type!=="float32"&&e.type!=="float64"||n.type!=="float32"&&n.type!=="float64"||r.type!=="float32"&&r.type!=="float64")throw new Error("Invalid input type.");if(t[0].dims.length!==4)throw new Error("Only support 4-D input shape.")}});function t8(t,e){let n=t[0].dims[1],r=t[0].dims.length,i=-Math.floor((e.size-1)/2),o=Math.ceil((e.size-1)/2),l=`float(${e.alpha}) / float(${e.size})`,a=`float(${e.bias})`,c=`float(${e.beta})`,s=`
    float process(int indices[${r}]) {
        int c = indices[1];
        float x = _X(indices);
        float square_sum = 0.0;

        for (int i = ${i}; i <= ${o}; i++) {
          int idx = c + i;
          if (c >= 0 && c < ${n}) {
            indices[1] = idx;
            float j = _X(indices);
            square_sum += j * j;
          }
        }
        return x / pow(${a} + ${l} * square_sum, ${c});
    }`;return N(C({},uw),{cacheHint:e.cacheKey,output:{dims:t[0].dims,type:t[0].type,textureType:0},shaderSource:s})}function n8(t,e){return N(C({},uw),{cacheHint:e.cacheKey,get:()=>t8(t,e)})}var pN,gN,uw,sA,r8=P(()=>{"use strict";Pt(),xe(),pN=(t,e,n)=>(sA(e),[t.run(n8(e,n),e)]),gN=t=>{let e=t.attributes.getFloat("alpha",1e-4),n=t.attributes.getFloat("beta",.75),r=t.attributes.getFloat("bias",1),i=t.attributes.getInt("size");return $e({alpha:e,beta:n,bias:r,size:i})},uw={name:"LRN",inputNames:["X"],inputTypes:[0]},sA=t=>{if(!t||t.length!==1)throw new Error("LRN requires 1 input.");if(t[0].dims.length!==4)throw new Error('currently only support LRN for input with "NCHW" format');if(t[0].type!=="float32")throw new Error("input should be float type")}}),aA,j0,mN,yN,vN,lA,cA,uA,dA,hA,fA,pA,gA,i8=P(()=>{"use strict";Pt(),Oe(),Ze(),xe(),aA={name:"Pad",inputNames:["A"],inputTypes:[0]},j0=(t,e,n)=>(uA(e),[t.run(N(C({},aA),{cacheHint:n.cacheKey,get:()=>cA(t,e[0],n)}),e)]),mN=t=>{let e=t.attributes.getString("mode","constant"),n=t.attributes.getFloat("value",0),r=t.attributes.getInts("pads");return $e({mode:e,value:n,pads:r})},yN=(t,e,n)=>{dA(e);let r=lA(t,e,n);return j0(t,[e[0]],r)},vN=t=>t.attributes.getString("mode","constant"),lA=(t,e,n)=>{if(!t.session.isInitializer(e[1].dataId)||e.length>=3&&!t.session.isInitializer(e[2].dataId))throw new Error("dynamic pad attributes are not allowed");let r=Array.from(e[1].integerData),i=e.length>=3?e[2].floatData[0]:0;return $e({mode:n,pads:r,value:i})},cA=(t,e,n)=>{let r=oe.padShape(e.dims.slice(),n.pads),i=r.length,o=`
      ${hA(t,e,n)}
      float process(int[${i}] indices) {
          return padA(indices);
      }`;return{name:"Pad",inputNames:["A"],inputTypes:[0],output:{dims:r,type:e.type,textureType:0},shaderSource:o}},uA=t=>{if(!t||t.length!==1)throw new Error("Pad requires 1 input");if(t[0].type!=="float32"&&t[0].type!=="float64")throw new Error("Invalid input type.")},dA=t=>{if(!t||t.length!==2&&t.length!==3)throw new Error("Pad requires 2 or 3 inputs");if(t[1].type!=="int32")throw new Error("Invalid input type.");if(t.length>=3&&t[2].type==="string")throw new Error("Invalid input type.")},hA=(t,e,n)=>{let r=be(t.session.backend.glContext.version),[i,o]=t.calculateTextureWidthAndHeight(e.dims,0),l=oe.computeStrides(e.dims);switch(n.mode){case"constant":return fA(r,e.dims,l,i,o,n.pads,n.value);case"reflect":return pA(r,e.dims,l,i,o,n.pads);case"edge":return gA(r,e.dims,l,i,o,n.pads);default:throw new Error("Invalid mode")}},fA=(t,e,n,r,i,o,l)=>{let a=e.length,c="";for(let s=a-1;s>=0;--s)c+=`
        k = m[${s}] - ${o[s]};
        if (k < 0)  return constant;
        if (k >= ${e[s]}) return constant;
        offset += k * ${n[s]};
        `;return`
      float padA(int m[${a}]) {
        const float constant = float(${l});
        int offset = 0;
        int k = 0;
        ${c}
        vec2 coords = offsetToCoords(offset, ${r}, ${i});
        float value = getColorAsFloat(${t.texture2D}(A, coords));
        return value;
      }
      `},pA=(t,e,n,r,i,o)=>{let l=e.length,a="";for(let c=l-1;c>=0;--c)a+=`
        k = m[${c}] - ${o[c]};
        if (k < 0) { k = -k; }
        {
          const int _2n_1 = ${2*(e[c]-1)};
          k = int( mod( float(k), float(_2n_1) ) ) ;
          if(k >= ${e[c]}) { k = _2n_1 - k; }
        }
        offset += k * ${n[c]};
        `;return`
      float padA(int m[${l}]) {
        int offset = 0;
        int k = 0;
        ${a}
        vec2 coords = offsetToCoords(offset, ${r}, ${i});
        float value = getColorAsFloat(${t.texture2D}(A, coords));
        return value;
      }
      `},gA=(t,e,n,r,i,o)=>{let l=e.length,a="";for(let c=l-1;c>=0;--c)a+=`
        k = m[${c}] - ${o[c]};
        if (k < 0)  k = 0;
        if (k >= ${e[c]}) k = ${e[c]-1};
        offset += k * ${n[c]};
      `;return`
      float padA(int m[${l}]) {
        int offset = 0;
        int k = 0;
        ${a}
        vec2 coords = offsetToCoords(offset, ${r}, ${i});
        float value = getColorAsFloat(${t.texture2D}(A, coords));
        return value;
      }
      `}}),bN,wN,Wb,_N,TN,xN,EN,qb,Yb,mA,Xb,CN,Pc,Kb,Nc,yA,o8=P(()=>{"use strict";Pt(),Oe(),xe(),bN=(t,e,n)=>{Pc(e);let r={name:"AveragePool",inputNames:["X"],inputTypes:[0],cacheHint:n.cacheKey};return[t.run(N(C({},r),{get:()=>Wb(e,r,!1,n)}),e)]},wN=t=>{let e=t.attributes.getString("auto_pad","NOTSET"),n=t.attributes.getInt("ceil_mode",0),r=t.attributes.getInt("count_include_pad",0)!==0,i=t.attributes.getInts("kernel_shape"),o=t.attributes.getInts("strides",[]),l=t.attributes.getInts("pads",[]);if(n!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return $e({autoPad:e,ceilMode:n,countIncludePad:r,kernelShape:i,strides:o,pads:l})},Wb=(t,e,n,r)=>{let[i,o]=Yb(t,r,n),l=oe.size(i.kernelShape),a="value += _X(x);",c="";i.countIncludePad?c+=`value /= float(${l});`:c+=`value /= float(${l} - pad);`;let s=`
        ${Kb(t[0].dims,i,a,c,"0.0")}
      `;return N(C({},e),{output:{dims:o,type:t[0].type,textureType:0},shaderSource:s})},_N=(t,e,n)=>{Pc(e);let r={name:"GlobalAveragePool",inputNames:["X"],inputTypes:[0],cacheHint:`${n.countIncludePad}`};return[t.run(N(C({},r),{get:()=>Wb(e,r,!0,n)}),e)]},TN=t=>{let e=t.attributes.getInt("count_include_pad",0)!==0;return $e({autoPad:"",ceilMode:0,countIncludePad:e,kernelShape:[],strides:[],pads:[]})},xN=(t,e,n)=>{Pc(e);let r={name:"MaxPool",inputNames:["X"],inputTypes:[0],cacheHint:n.cacheKey};return[t.run(N(C({},r),{get:()=>qb(e,r,!1,n)}),e)]},EN=t=>{let e=t.attributes.getString("auto_pad","NOTSET"),n=t.attributes.getInt("ceil_mode",0),r=t.attributes.getInts("kernel_shape"),i=t.attributes.getInts("strides",[]),o=t.attributes.getInts("pads",[]),l=t.attributes.getInt("storage_order",0),a=t.attributes.getInts("dilations",[]);if(l!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(n!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return $e({autoPad:e,ceilMode:n,countIncludePad:!1,kernelShape:r,strides:i,pads:o,storageOrder:l,dilations:a})},qb=(t,e,n,r)=>{let[i,o]=Yb(t,r,n),l=`
      value = max(_X(x), value);
    `,a="",c=`
      ${Kb(t[0].dims,i,l,a,"-1e5")}
    `;return N(C({},e),{output:{dims:o,type:t[0].type,textureType:0},shaderSource:c})},Yb=(t,e,n)=>{let r=t[0].dims.slice(),i=Object.hasOwnProperty.call(e,"dilations"),o=e.kernelShape.slice(),l=e.strides.slice(),a=i?e.dilations.slice():[],c=e.pads.slice();rp.adjustPoolAttributes(n,r,o,l,a,c);let s=rp.computePoolOutputShape(n,r,l,a,o,c,e.autoPad),u=Object.assign({},e);return i?Object.assign(u,{kernelShape:o,strides:l,pads:c,dilations:a,cacheKey:e.cacheKey}):Object.assign(u,{kernelShape:o,strides:l,pads:c,cacheKey:e.cacheKey}),[u,s]},mA={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""},Xb={name:"GlobalMaxPool",inputNames:["X"],inputTypes:[0]},CN=(t,e)=>(Pc(e),[t.run(N(C({},Xb),{get:()=>qb(e,Xb,!0,mA)}),e)]),Pc=t=>{if(!t||t.length!==1)throw new Error("Pool ops requires 1 input.");if(t[0].type!=="float32"&&t[0].type!=="float64")throw new Error("Invalid input type.")},Kb=(t,e,n,r,i)=>{let o=t.length;if(e.kernelShape.length<=2){let l=e.kernelShape[e.kernelShape.length-1],a=e.strides[e.strides.length-1],c=e.pads[e.pads.length/2-1],s=e.pads[e.pads.length-1],u=t[o-1],d="",h="",f="";if(c+s!==0?d=`
          for (int i = 0; i < ${l}; i++) {
            x[${o} - 1] = indices[${o} - 1] * ${a} - ${c} + i;
            if (x[${o} - 1] < 0 || x[${o} - 1] >= ${u}) {
              pad++;
              continue;
            }
            ${n}
          }`:d=`
          for (int i = 0; i < ${l}; i++) {
            x[${o} - 1] = indices[${o} - 1] * ${a} - ${c} + i;
            ${n}
          }`,e.kernelShape.length===2){let p=e.kernelShape[e.kernelShape.length-2],g=e.strides[e.strides.length-2],y=e.pads[e.pads.length/2-2],b=e.pads[e.pads.length-2],v=t[o-2];y+b!==0?h=`
            for (int j = 0; j < ${p}; j++) {
              x[${o} - 2] = indices[${o} - 2] * ${g} - ${y} + j;
              if (x[${o} - 2] < 0 || x[${o} - 2] >= ${v}) {
                pad+= ${l};
                continue;
              }
          `:h=`
            for (int j = 0; j < ${p}; j++) {
              x[${o} - 2] = indices[${o} - 2] * ${g} - ${y} + j;
            `,f=`
          }
        `}return`
        float process(int indices[${o}]) {
          int x[${o}];
          copyVec(indices, x);

          float value = ${i};
          int pad = 0;
          ${h}
          ${d}
          ${f}
          ${r}
          return value;
        }
      `}else{let l=oe.size(e.kernelShape),a=oe.computeStrides(e.kernelShape),c=a.length,s=e.pads.length,u=yA(c),d=Nc(t,"inputDims"),h=Nc(e.pads,"pads"),f=Nc(a,"kernelStrides"),p=Nc(e.strides,"strides"),g=e.pads.reduce((b,v)=>b+v),y="";return g?y=`
            if (x[j] >= inputDims[j] || x[j] < 0) {
              pad++;
              isPad = true;
              break;
            }
          }
          if (!isPad) {
            ${n}
          }`:y=`
          }
          ${n}
        `,`
        ${u}
        float process(int indices[${o}]) {
          int x[${o}];
          copyVec(indices, x);
          int offset[${c}];
          int pads[${s}];
          int inputDims[${o}];
          int kernelStrides[${c}];
          int strides[${c}];
          ${h}
          ${d}
          ${p}
          ${f}

          float value = ${i};
          int pad = 0;
          bool isPad = false;
          for (int i = 0; i < ${l}; i++) {
            offsetToIndices(i, kernelStrides, offset);
            isPad = false;
            for (int j = ${o} - ${c}; j < ${o}; j++) {
              x[j] = indices[j] * strides[j - ${o} + ${c}]
                + offset[j - ${o} + ${c}] - pads[j - 2];
              ${y}
          }
          ${r}

          return value;
        }
      `}},Nc=(t,e)=>{let n="";for(let r=0;r<t.length;r++)n+=`
      ${e}[${r}] = ${t[r]};
    `;return n},yA=t=>`
  void offsetToIndices(int offset, int[${t}] strides, out int[${t}] indices) {
    if (${t} == 0) {
      return;
    }
    for (int i = 0; i < ${t} - 1; ++i) {
      indices[i] = offset / strides[i];
      offset -= indices[i] * strides[i];
    }
    indices[${t} - 1] = offset;
  }`}),qi,Ki,vA,bA,SN,DN,IN,ON,AN,MN,PN,s8=P(()=>{"use strict";Pt(),hp(),Oe(),xe(),qi=(t,e,n,r,i)=>{bA(e);let o={name:r,inputNames:["A"],inputTypes:[0]};return[t.run(N(C({},o),{cacheHint:n.cacheKey,get:()=>vA(t,e,n,r,i,o)}),e)]},Ki=t=>{let e=t.attributes.getInts("axes",[]),n=t.attributes.getInt("keepdims",1)===1;return $e({axes:e,keepDims:n})},vA=(t,e,n,r,i,o)=>{let l=[],a=e[0].dims.length||1,c=[],s=oe.normalizeAxes(n.axes,e[0].dims.length),u=i(e,s),d=u[1];for(let f=0;f<e[0].dims.length;f++)s.indexOf(f)>=0||s.length===0?(n.keepDims&&l.push(1),d=`
          for(int j${f} = 0; j${f} < ${e[0].dims[f]}; j${f}++) {
            inputIdx[${f}] = j${f};
            ${d}
          }`):(c.push(`inputIdx[${f}] = outputIdx[${l.length}];`),l.push(e[0].dims[f]));let h=`
      float process(int outputIdx[${l.length||1}]) {
        float value;                 // final result
        int inputIdx[${a}];      // addressing input data
        ${c.join(`
`)}
        ${u[0]}       // init ops for reduce max/min
        ${d}
        ${u[2]}       // final computation for reduce mean
        return value;
      }`;return N(C({},o),{output:{dims:l,type:e[0].type,textureType:0},shaderSource:h})},bA=t=>{if(!t||t.length!==1)throw new Error("Reduce op requires 1 input.");if(ou.indexOf(t[0].type)===-1)throw new Error("Invalid input type.")},SN=(t,e,n)=>qi(t,e,n,"ReduceSum",()=>["value = 0.0;","value += _A(inputIdx);",""]),DN=(t,e,n)=>qi(t,e,n,"ReduceMean",(r,i)=>{let o=1;for(let l=0;l<r[0].dims.length;l++)(i.indexOf(l)>=0||i.length===0)&&(o*=r[0].dims[l]);return["value = 0.0;","value += _A(inputIdx);",`value /= ${o}.;`]}),IN=(t,e,n)=>qi(t,e,n,"ReduceMax",(r,i)=>{let o=[];for(let l=0;l<r[0].dims.length;l++)(i.indexOf(l)>=0||i.length===0)&&o.push(`inputIdx[${l}] = 0;`);return[`${o.join(`
`)}
value = _A(inputIdx);`,"value = max(value, _A(inputIdx));",""]}),ON=(t,e,n)=>qi(t,e,n,"ReduceMin",(r,i)=>{let o=[];for(let l=0;l<r[0].dims.length;l++)(i.indexOf(l)>=0||i.length===0)&&o.push(`inputIdx[${l}] = 0;`);return[`${o.join(`
`)}
value = _A(inputIdx);`,"value = min(value, _A(inputIdx));",""]}),AN=(t,e,n)=>qi(t,e,n,"ReduceProd",()=>["value = 1.0;","value *= _A(inputIdx);",""]),MN=(t,e,n)=>qi(t,e,n,"ReduceLogSum",()=>["value = 0.0;","value += _A(inputIdx);","value = log(value);"]),PN=(t,e,n)=>qi(t,e,n,"ReduceLogSumSquare",()=>["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""])}),NN,a8=P(()=>{"use strict";Oe(),NN=(t,e)=>{let n=oe.calculateReshapedDims(e[0].dims,e[1].integerData);return t.session.pack?[t.reshapePacked(e[0],n)]:[t.reshapeUnpacked(e[0],n)]}}),Zb,V0,RN,kN,Kc,wA,$0,op,FN=P(()=>{"use strict";Pt(),Ze(),xe(),Zb={name:"Upsample",inputNames:["X"],inputTypes:[0]},V0=(t,e,n)=>($0(e,n),[t.run(N(C({},Zb),{cacheHint:n.cacheKey,get:()=>wA(t,e,n)}),e)]),RN=t=>Kc(t,7),kN=t=>Kc(t,9),Kc=(t,e)=>{let n=e>=10,r=t.attributes.getString("mode","nearest");if(r!=="nearest"&&r!=="linear"&&(e<11||r!=="cubic"))throw new Error(`unrecognized mode: ${r}`);let i=[];e<9&&(i=t.attributes.getFloats("scales"),op(i,r,n));let o=t.attributes.getFloat("extrapolation_value",0),l=e>10?t.attributes.getString("coordinate_transformation_mode","half_pixel"):"asymmetric";if(["asymmetric","pytorch_half_pixel","tf_half_pixel_for_nn","align_corners","tf_crop_and_resize","half_pixel"].indexOf(l)===-1)throw new Error(`coordinate_transform_mode '${l}' is not supported`);let a=l==="tf_crop_and_resize",c=a,s=r==="nearest"&&e>=11?t.attributes.getString("nearest_mode","round_prefer_floor"):"";if(["round_prefer_floor","round_prefer_ceil","floor","ceil",""].indexOf(s)===-1)throw new Error(`nearest_mode '${s}' is not supported`);let u=t.attributes.getFloat("cubic_coeff_a",-.75),d=t.attributes.getInt("exclude_outside",0)!==0;if(d&&r!=="cubic")throw new Error("exclude_outside can be set to 1 only when mode is CUBIC.");let h=e<11?!0:r==="nearest"&&l==="asymmetric"&&s==="floor",f=0,p=0,g=0;return e>10?t.inputs.length>2?(f=1,p=2,g=3):(p=1,g=2):e===9&&(p=1),$e({opset:e,isResize:n,mode:r,scales:i,extrapolationValue:o,coordinateTransformMode:l,useExtrapolation:c,needRoiInput:a,nearestMode:s,cubicCoefficientA:u,excludeOutside:d,useNearest2xOptimization:h,roiInputIdx:f,scalesInputIdx:p,sizesInputIdx:g})},wA=(t,e,n)=>{let r=be(t.session.backend.glContext.version),[i,o]=t.calculateTextureWidthAndHeight(e[0].dims,0),l=e[0].dims.map((g,y)=>Math.floor(g*n.scales[y])),[a,c]=t.calculateTextureWidthAndHeight(l,0),s=l.length,u=new Array(s),d=new Array(s),h=`
      int output_pitches[${s}];
      int input_pitches[${s}];
      `;for(let g=s-1;g>=0;g--)u[g]=g===s-1?1:u[g+1]*l[g+1],d[g]=g===s-1?1:d[g+1]*e[0].dims[g+1],h+=`
        output_pitches[${g}] = ${u[g]};
        input_pitches[${g}] = ${d[g]};
        `;let f=`
      float getInputFloat(int index) {
        vec2 coords = offsetToCoords(index, ${i}, ${o});
        float value = getColorAsFloat(${r.texture2D}(X, coords));
        return value;
      }
      `,p=n.mode==="nearest"?`
    ${f}
    float process(int indices[${s}]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${a}, ${c});

      ${h}

      int d, m;
      for (int dim = 0; dim < ${s}; ++dim) {
        d = output_index / output_pitches[dim];
        m = output_index - d * output_pitches[dim];
        output_index = m;

        if (scales[dim] != 1 && d > 0) {
          int d2 = d / scales[dim];
          m = d - d2 * scales[dim];
          d = d2;
        }
        input_index += input_pitches[dim] * d;
      }

      return getInputFloat(input_index);
    }`:s===4?`
    ${f}
    float process(int indices[4]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${a}, ${c});

      ${h}

      int m;
      int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m / output_pitches[1];
      m = m - index_of_dim1 * output_pitches[1];
      index_of_dim2 = m / output_pitches[2];
      m = m - index_of_dim2 * output_pitches[2];
      index_of_dim3 = m;

      int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;
      index_of_input_dim2 = index_of_dim2 / scales[2];
      y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];
      index_of_input_dim3 = index_of_dim3 / scales[3];
      x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];

      input_index = index_of_dim0 * input_pitches[0] +
            index_of_dim1 * input_pitches[1] +
            index_of_input_dim2 * input_pitches[2] +
            index_of_input_dim3;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim2 = false;
      if (index_of_input_dim2 == (${e[0].dims[2]} - 1)) {
        // It's the end in dimension 2
        x01 = x00;
        end_of_dim2 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[2]);
      }

      if (index_of_input_dim3 == (input_pitches[2] - 1)) {
        // It's the end in dimension 3
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);
    }`:`
    ${f}
    float process(int indices[2]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${a}, ${c});

      ${h}

      int m;
      int index_of_dim0, index_of_dim1;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m;

      int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;
      index_of_input_dim0 = index_of_dim0 / scales[0];
      y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];
      index_of_input_dim1 = index_of_dim1 / scales[1];
      x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];

      input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim0 = false;
      if (index_of_input_dim0 == (${e[0].dims[0]} - 1)) {
        // It's the end in dimension 0
        x01 = x00;
        end_of_dim0 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[0]);
      }

      if (index_of_input_dim1 == (input_pitches[0] - 1)) {
        // It's the end in dimension 1
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);
    }`;return N(C({},Zb),{output:{dims:l,type:e[0].type,textureType:0},shaderSource:p,variables:[{name:"scales",type:"int",arrayLength:n.scales.length,data:n.scales.map(g=>Math.ceil(g))}]})},$0=(t,e)=>{if(!t||e.opset<9&&t.length!==1||e.opset>=9&&e.opset<11&&t.length!==2||e.opset>=11&&t.length<2)throw new Error("invalid inputs.");if(e.scales.length>0&&t[0].dims.length!==e.scales.length)throw new Error("Invalid input shape.");if(t[0].type==="string")throw new Error("Invalid input tensor types.")},op=(t,e,n)=>{if(n){for(let r of t)if(r<=0)throw new Error("Scale value should be greater than 0.")}else for(let r of t)if(r<1)throw new Error("Scale value should be greater than or equal to 1.");if((e==="linear"||e==="cubic")&&t.length!==2&&(t.length!==4||t[0]!==1||t[1]!==1))throw new Error(`'Linear' mode and 'Cubic' mode only support 2-D inputs ('Bilinear', 'Bicubic')         or 4-D inputs with the corresponding outermost 2 scale values being 1         in the ${n?"Resize":"Upsample"} opeartor.`)}}),Yf,U0,LN,BN,_A,TA,xA,EA,l8=P(()=>{"use strict";Ze(),xe(),si(),Ja(),FN(),Yf={name:"Resize",inputNames:["A"],inputTypes:[2]},U0=(t,e,n)=>($0(e,n),[t.run(N(C({},Yf),{cacheHint:n.cacheKey,get:()=>_A(t,e,n)}),e)]),LN=t=>Kc(t,10),BN=t=>Kc(t,11),_A=(t,e,n)=>{let r=be(t.session.backend.glContext.version),[i,o]=TA(e,n);if(i.every(v=>v===1)&&n.coordinateTransformMode!=="tf_crop_and_resize")return N(C({},Yf),{output:{dims:o,type:e[0].type,textureType:2},hasMain:!0,shaderSource:`void main() {
                    vec4 v = ${r.texture2D}(X, TexCoords);
                    ${r.output} = v;
                }`});let l=o.length;if(l<2)throw new Error(`output dimension should be at least 2, but got ${l}`);let a=o[l-2],c=o[l-1],s=e[0].dims;if(l!==s.length)throw new Error(`output dimension should match input ${s.length}, but got ${l}`);let u=s[l-2],d=s[l-1],h=i[l-2],f=i[l-1],p="";if(n.mode!=="linear")throw new Error(`resize (packed) does not support mode: '${n.mode}'`);switch(n.coordinateTransformMode){case"asymmetric":p=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return vec4(coords) / scaleWHWH;
                    }
                `;break;case"half_pixel":p=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return (vec4(coords) + 0.5) / scaleWHWH - 0.5;
                    }
                `;break;case"pytorch_half_pixel":p=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 fcoords = vec4(coords);
                        return vec4(
                            ${c}.0 > 1.0 ? (fcoords.x + 0.5) / scaleWHWH.x - 0.5 : 0.0,
                            ${a}.0 > 1.0 ? (fcoords.y + 0.5) / scaleWHWH.y - 0.5 : 0.0,
                            ${c}.0 > 1.0 ? (fcoords.z + 0.5) / scaleWHWH.z - 0.5 : 0.0,
                            ${a}.0 > 1.0 ? (fcoords.w + 0.5) / scaleWHWH.w - 0.5 : 0.0
                          );
                    }
                `;break;case"align_corners":p=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 resized = vec4(${c}.0 - 1.0, ${a}.0 - 1.0, ${c}.0 - 1.0,
                            ${a}.0 - 1.0);
                        vec4 original = vec4(${d}.0 - 1.0, ${u}.0 - 1.0, ${d}.0 - 1.0,
                            ${u}.0 - 1.0);
                        vec4 new_scale = original / resized;
                        return vec4(coords) * new_scale;
                    }
                `;break;default:throw new Error(`resize (packed) does not support coordinateTransformMode:                                 '${n.coordinateTransformMode}'`)}let g=Qi(l),y=ru(),b=`
            const vec2 inputWH = vec2(${u}.0, ${d}.0);
            const vec4 scaleWHWH = vec4(float(${h}), float(${f}), float(${h}), float(${f}));
            ${y}
            ${p}
            float getAValue(int x10, int r, int c, int d) {
                return getChannel(getA(x10, r, c, d), vec2(c, d));
            }
            void main() {
                ${g} rc = getOutputCoords();

                int batch = rc[0];
                int depth = rc[1];

                // retrieve the 4 coordinates that is used in the 4 packed output values.
                ivec4 coords = ivec4(rc.wz, rc.w + 1, rc.z + 1);

                // calculate the source index in fraction
                vec4 sourceFrac = getSourceFracIndex(coords);

                // get the lower and upper bound of the 4 values that will be packed into one texel.
                ivec4 x00 = ivec4(max(sourceFrac.xy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xy)));
                ivec4 x01 = ivec4(max(sourceFrac.xw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xw)));
                ivec4 x10 = ivec4(max(sourceFrac.zy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zy)));
                ivec4 x11 = ivec4(max(sourceFrac.zw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zw)));

                bool hasNextRow = rc.w < ${a-1};
                bool hasNextCol = rc.z < ${c-1};

                // pack x00, x01, x10, x11's top-left corner into one vec4 structure
                vec4 topLeft = vec4(
                    getAValue(batch, depth, x00.x, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.y) : 0.0);

                // pack x00, x01, x10, x11's top-right corner into one vec4 structure
                vec4 topRight = vec4(
                    getAValue(batch, depth, x00.x, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.w) : 0.0);

                // pack x00, x01, x10, x11's bottom-left corner into one vec4 structure
                vec4 bottomLeft = vec4(
                    getAValue(batch, depth, x00.z, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.y) : 0.0);

                // pack x00, x01, x10, x11's bottom-right corner into one vec4 structure
                vec4 bottomRight = vec4(
                    getAValue(batch, depth, x00.z, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.w) : 0.0);

                // calculate the interpolation fraction on u and v direction
                vec4 frac = vec4(sourceFrac) - floor(sourceFrac);
                vec4 clampFrac = clamp(frac, vec4(0.0), vec4(1.0));

                vec4 top = mix(topLeft, topRight, clampFrac.ywyw);
                vec4 bottom = mix(bottomLeft, bottomRight, clampFrac.ywyw);
                vec4 newValue = mix(top, bottom, clampFrac.xxzz);

                ${r.output} = vec4(newValue);
            }
        `;return N(C({},Yf),{output:{dims:o,type:e[0].type,textureType:2},hasMain:!0,shaderSource:b})},TA=(t,e)=>{let n=t[0].dims,r=e.scales,i;if(r.length===0){let l=t[e.scalesInputIdx];if(l&&l.size!==0){if(t[e.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");r=xA(l,e.mode,e.isResize)}else{let a=t[e.sizesInputIdx];if(!a||a.size===0)throw new Error("Either scales or sizes MUST be provided as input.");i=Array.from(a.integerData),r=EA(i,n,e.mode,e.isResize)}}else if(t[e.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");let o=i||n.map((l,a)=>Math.floor(l*r[a]));return[r,o]},xA=(t,e,n)=>{let r=Array.from(t.floatData);return op(r,e,n),r},EA=(t,e,n,r)=>{let i=e.length,o=new Array(i);for(let l=0,a=i;l<a;l++)if(e[l]===0){if(t[l]!==0)throw new Error("Input dim is zero but required output dim is non-zero.");o[l]=1}else o[l]=t[l]/e[l];return op(o,n,r),o}}),jN,CA,c8=P(()=>{"use strict";Qa(),jN=(t,e)=>(CA(e),[new An([e[0].dims.length],"int32",void 0,void 0,new Int32Array(e[0].dims))]),CA=t=>{if(!t||t.length!==1)throw new Error("Shape requires 1 input.")}}),Xf,VN,$N,Qb,SA,UN,DA,IA,u8=P(()=>{"use strict";Pt(),hp(),Oe(),xe(),Xf={name:"Slice",inputNames:["A"],inputTypes:[0]},VN=(t,e,n)=>(SA(e),[t.run(N(C({},Xf),{cacheHint:n.cacheKey,get:()=>Qb(t,e[0],n)}),e)]),$N=t=>{let e=t.attributes.getInts("starts"),n=t.attributes.getInts("ends"),r=t.attributes.getInts("axes",[]);return $e({starts:e,ends:n,axes:r})},Qb=(t,e,n)=>{let r=n.axes.length===0?e.dims.slice(0).map((u,d)=>d):n.axes,i=oe.normalizeAxes(r,e.dims.length),o=n.starts.map((u,d)=>u>e.dims[i[d]]-1?e.dims[i[d]]:oe.normalizeAxis(u,e.dims[i[d]])),l=n.ends.map((u,d)=>u>e.dims[i[d]]-1?e.dims[i[d]]:oe.normalizeAxis(u,e.dims[i[d]])),a=e.dims.slice(),c=[];for(let u=0;u<i.length;u++)a[i[u]]=l[u]-o[u],o[u]>0&&c.push(`outputIdx[${i[u]}] += ${o[u]};`);let s=`
      float process(int outputIdx[${a.length}]) {
        ${c.join(`
      `)}
        return _A(outputIdx);
      }`;return N(C({},Xf),{output:{dims:a,type:e.type,textureType:0},shaderSource:s})},SA=t=>{if(!t||t.length!==1)throw new Error("Slice requires 1 input.");if(ou.indexOf(t[0].type)===-1)throw new Error("Invalid input type.")},UN=(t,e)=>{IA(e);let n=DA(t,e);return[t.run(N(C({},Xf),{cacheHint:n.cacheKey,get:()=>Qb(t,e[0],n)}),[e[0]])]},DA=(t,e)=>{if(!t.session.isInitializer(e[1].dataId)||!t.session.isInitializer(e[2].dataId)||e.length>=4&&!t.session.isInitializer(e[3].dataId)||e.length>=5&&!t.session.isInitializer(e[4].dataId))throw new Error("dynamic slice attributes are not allowed");if(e.length>=5&&e[4].integerData.some(l=>l!==1))throw new Error("currently non-1 steps is not supported for Slice");let n=Array.from(e[1].integerData),r=Array.from(e[2].integerData),i=e.length>=4?Array.from(e[3].integerData):[],o=`${i};${n};${r}`;return{starts:n,ends:r,axes:i,cacheKey:o}},IA=t=>{if(!t||t.length<3||t.length>5)throw new Error("Invalid input number.");if(t[1].type!=="int32"||t[1].dims.length!==1)throw new Error("Invalid input type.");if(t[2].type!=="int32"||t[2].dims.length!==1)throw new Error("Invalid input type.");if(t.length>=4&&(t[3].type!=="int32"||t[3].dims.length!==1))throw new Error("Invalid input type.");if(t.length>=5&&(t[4].type!=="int32"||t[4].dims.length!==1))throw new Error("Invalid input type.")}}),Jb,e0,t0,HN,GN,zN,WN,n0,OA,AA,MA,r0,d8=P(()=>{"use strict";Pt(),Oe(),Ze(),xe(),cw(),Jb={name:"SoftmaxComputeMax",inputNames:["A"],inputTypes:[0]},e0={name:"SoftmaxComputeScale",inputNames:["A","Max"],inputTypes:[0,0]},t0={name:"SoftMax",inputNames:["A","Max","Norm"],inputTypes:[0,0,0]},HN=(t,e,n)=>{r0(e);let r=e[0].dims.slice(),i=oe.normalizeAxis(n.axis,r.length),o=oe.sizeToDimension(r,i),l=oe.sizeFromDimension(r,i);return n0(t,e,n,o,l)},GN=t=>$e({axis:t.attributes.getInt("axis",1)}),zN=t=>$e({axis:t.attributes.getInt("axis",-1)}),WN=(t,e,n)=>{r0(e);let r=e[0].dims.slice(),i=oe.normalizeAxis(n.axis,r.length),o=r.length,l=i!==o-1,a=[],c=[],s=[],u;l&&(c=Array.from({length:o}).map((p,g)=>g),c[i]=o-1,c[o-1]=i,c.map(p=>a.push(r[p])),u=$e({perm:c}),s=eu(t,e,u));let d=l?oe.sizeToDimension(a,o-1):oe.sizeToDimension(r,o-1),h=l?oe.sizeFromDimension(a,o-1):oe.sizeFromDimension(r,o-1),f=n0(t,l?s:e,n,d,h);return l?eu(t,f,u):f},n0=(t,e,n,r,i)=>{let o=OA(t,e[0],r,i,[r]),l=t.run(N(C({},Jb),{cacheHint:n.cacheKey,get:()=>o}),e),a=AA(t,e[0],r,i,o.output.dims,[r]),c=t.run(N(C({},e0),{cacheHint:n.cacheKey,get:()=>a}),[e[0],l]),s=MA(t,e[0],r,i,o.output.dims,a.output.dims);return[t.run(N(C({},t0),{cacheHint:n.cacheKey,get:()=>s}),[e[0],l,c])]},OA=(t,e,n,r,i)=>{let[o,l]=t.calculateTextureWidthAndHeight(e.dims,0),a=i.length;if(n<1||r<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(i.length!==1)throw new Error("Dimensionality of the output should be 1");if(i[0]!==n)throw new Error("Shape of the output should be equal to logical row count");let c=be(t.session.backend.glContext.version),s=`
      float process(int[${a}] indices) {
        int logical_row_start_offset = indices[0] * ${r};

        float max = getColorAsFloat(${c.texture2D}(A, offsetToCoords(logical_row_start_offset, ${o},
        ${l} )));
        for(int i=1; i<${r}; ++i)
        {
          float current = getColorAsFloat(${c.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${o}, ${l})));
          if(current > max)
          max = current;
        }

        return max;
      }`;return N(C({},Jb),{output:{dims:i,type:e.type,textureType:0},shaderSource:s})},AA=(t,e,n,r,i,o)=>{let[l,a]=t.calculateTextureWidthAndHeight(e.dims,0),c=o.length;if(n<1||r<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(o.length!==1)throw new Error("Dimensionality of the output should be 1");if(o[0]!==n)throw new Error("Shape of the output should be equal to logical row count");if(i.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(i[0]!==n)throw new Error("Shape of the intermediate results should be equal to logical row count");let s=be(t.session.backend.glContext.version),u=`
      float process(int[${c}] indices) {
        int logical_row_start_offset = indices[0] * ${r};

        float norm_factor = 0.0;
        float max = _Max(indices);
        for(int i=0; i<${r}; ++i)
        {
          norm_factor += exp(getColorAsFloat(${s.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${l}, ${a}))) - max);
        }

        return norm_factor;
      }`;return N(C({},e0),{output:{dims:o,type:e.type,textureType:0},shaderSource:u})},MA=(t,e,n,r,i,o)=>{let[l,a]=t.calculateTextureWidthAndHeight(e.dims,0),c=e.dims.length;if(n<1||r<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(i.length!==1||o.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(i[0]!==n||o[0]!==n)throw new Error("Shape of the intermediate results should be equal to logical row count");let s=`
      float process(int[${c}] indices) {

      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)
      int offset = coordsToOffset(TexCoords, ${l}, ${a});

      //determine the logical row for this index
      int logical_row_index[1];
      logical_row_index[0] = offset / ${r};

      float norm_factor = _Norm(logical_row_index);

      // avoid possible division by 0
      // if norm_facor is 0, all elements are zero
      // if so, return 0
      if(norm_factor == 0.0)
        return 0.0;

      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;
    }`;return N(C({},t0),{output:{dims:e.dims,type:e.type,textureType:0},shaderSource:s})},r0=t=>{if(!t||t.length!==1)throw new Error("Softmax requires 1 input.");if(t[0].type!=="float32"&&t[0].type!=="float64")throw new Error("Invalid input type")}}),i0,qN,YN,PA,NA,RA,h8=P(()=>{"use strict";Pt(),Oe(),xe(),i0={name:"Split",inputNames:["A"],inputTypes:[0]},qN=(t,e,n)=>{RA(e);let r=oe.normalizeAxis(n.axis,e[0].dims.length),i=PA(t,e,r,n),o=[];for(let l=0;l<i;++l)o.push(t.run(N(C({},i0),{cacheHint:`${n.cacheKey};${l}`,get:()=>NA(t,e[0],n,r,l)}),e));return o},YN=t=>{let e=t.attributes.getInt("axis",0),n=t.attributes.getInts("split",[]),r=t.outputs.length;return $e({axis:e,split:n,numOutputs:r})},PA=(t,e,n,r)=>{let[,i]=S0.splitShape(e[0].dims,n,r.split,r.numOutputs);return i.length},NA=(t,e,n,r,i)=>{let[o,l]=S0.splitShape(e.dims,r,n.split,n.numOutputs),a=l[i],c=o[i],s=`
      float process(int indices[${c.length}]) {
        indices[${r}] += ${a};
        return _A(indices);
      }
    `;return N(C({},i0),{cacheHint:`${n.cacheKey}:${i}`,output:{dims:c,type:e.type,textureType:0},shaderSource:s})},RA=t=>{if(!t||t.length!==1)throw new Error("Split requires one input.");if(t[0].type!=="int8"&&t[0].type!=="uint8"&&t[0].type!=="int16"&&t[0].type!=="uint16"&&t[0].type!=="int32"&&t[0].type!=="uint32"&&t[0].type!=="float32"&&t[0].type!=="float64"&&t[0].type!=="bool")throw new Error("Invalid input type.")}}),H0,XN,KN,kA,FA,f8=P(()=>{"use strict";Oe(),H0=(t,e,n)=>{kA(e);let r=oe.squeezeShape(e[0].dims,n);return[t.reshapeUnpacked(e[0],r)]},XN=(t,e)=>(FA(e),H0(t,[e[0]],Array.from(e[1].integerData))),KN=t=>t.attributes.getInts("axes"),kA=t=>{if(!t||t.length!==1)throw new Error("Squeeze requires 1 input.");if(t[0].type==="string")throw new Error("invalid input tensor types.")},FA=t=>{if(!t||t.length!==2)throw new Error("Squeeze requires 2 inputs.");if(t[1].type!=="int32")throw new Error("Invalid input type.")}}),ZN,LA,BA,p8=P(()=>{"use strict";Ze(),xe(),ZN=(t,e)=>{BA(e);let n={name:"Sum",inputNames:e.map((r,i)=>`X${i}`),inputTypes:new Array(e.length).fill(0)};return[t.run(N(C({},n),{get:()=>LA(t,e,n)}),e)]},LA=(t,e,n)=>{let r=be(t.session.backend.glContext.version),i=e[0].dims.slice(),o=`
      void main() {
        vec4 result = ${e.map((l,a)=>`${r.texture2D}(X${a},TexCoords)`).join(" + ")};
        ${r.output} = result;
      }
    `;return N(C({},n),{output:{dims:i,type:e[0].type,textureType:0},hasMain:!0,shaderSource:o})},BA=t=>{if(!t||t.length===0)throw new Error("Sum requires inputs.");let e=t[0].dims.length;for(let n=1;n<t.length;n++){if(e!==t[n].dims.length)throw new Error("Input shapes are mismatched.");for(let r=0;r<e;r++)if(t[0].dims[r]!==t[n].dims[r])throw new Error("Input shapes are not matched.")}if(t[0].type!=="float32"&&t[0].type!=="float64")throw new Error("Invalid input type.");for(let n=1;n<t.length;n++)if(t[0].type!==t[n].type)throw new Error("Input types are not matched.")}}),QN,jA,VA,g8=P(()=>{"use strict";hp(),xe(),QN=(t,e)=>{VA(e);let n={name:"Tile",inputNames:["A"],inputTypes:[0]};return[t.run(N(C({},n),{get:()=>jA(t,e,n)}),e)]},jA=(t,e,n)=>{let r=e[0].dims.slice(),i=new Array(r.length),o=[];for(let c=0;c<r.length;c++)i[c]=r[c]*e[1].numberData[c],o.push(`inputIdx[${c}] = int(mod(float(outputIdx[${c}]), ${r[c]}.));`);let l=i.length,a=`
      float process(int outputIdx[${l}]) {
        int inputIdx[${l}];
        ${o.join(`
`)}
        return _A(inputIdx);
      }
    `;return N(C({},n),{output:{dims:i,type:e[0].type,textureType:0},shaderSource:a})},VA=t=>{if(!t||t.length!==2)throw new Error("Tile requires 2 input.");if(t[1].dims.length!==1)throw new Error("The second input shape must 1 dimension.");if(t[1].dims[0]!==t[0].dims.length)throw new Error("Invalid input shape.");if(ou.indexOf(t[0].type)===-1)throw new Error("Invalid input type.");if(t[1].type!=="int32"&&t[1].type!=="int16")throw new Error("Invalid repeat type.")}}),G0,JN,eR,$A,UA,m8=P(()=>{"use strict";Oe(),G0=(t,e,n)=>{$A(e);let r=oe.unsqueezeShape(e[0].dims,n);return[t.reshapeUnpacked(e[0],r)]},JN=(t,e)=>(UA(e),G0(t,[e[0]],Array.from(e[1].integerData))),eR=t=>t.attributes.getInts("axes"),$A=t=>{if(!t||t.length!==1)throw new Error("Unsqueeze requires 1 input.");if(t[0].type==="string")throw new Error("invalid input tensor types.")},UA=t=>{if(!t||t.length!==2)throw new Error("Unsqueeze requires 2 inputs.");if(t[1].type!=="int32")throw new Error("Invalid input type.")}}),tR,y8=P(()=>{"use strict";i5(),v5(),b5(),_5(),lw(),Y5(),X5(),K5(),Z5(),Q5(),J5(),e8(),r8(),sw(),i8(),o8(),s8(),a8(),l8(),c8(),u8(),d8(),h8(),f8(),p8(),g8(),cw(),VP(),m8(),FN(),tR=[["Abs","","6+",yP],["Acos","","7+",vP],["Add","","7+",ZM],["And","","7+",QM],["Asin","","7+",bP],["Atan","","7+",wP],["AveragePool","","7+",bN,wN],["BatchNormalization","","7+",qM,YM],["Cast","","6+",cP,uP],["Ceil","","6+",xP],["Clip","","6-10",N0,_P],["Clip","","11+",TP],["Concat","","4+",hP,fP],["Conv","","1+",F0,L0],["ConvTranspose","","1+",JP,eN],["Cos","","7+",EP],["Div","","7+",JM],["Dropout","","7+",R0],["DepthToSpace","","1+",nN,rN],["Equal","","7+",eP],["Elu","","6+",CP,SP],["Exp","","6+",DP],["Flatten","","1+",iN,oN],["Floor","","6+",IP],["FusedConv","com.microsoft","1+",F0,L0],["Gather","","1+",sN,aN],["Gemm","","7-10",B0,lN],["Gemm","","11+",B0,cN],["GlobalAveragePool","","1+",_N,TN],["GlobalMaxPool","","1+",CN],["Greater","","7+",tP],["Identity","","1+",R0],["ImageScaler","","1+",uN,dN],["InstanceNormalization","","6+",hN,fN],["LeakyRelu","","6+",OP,AP],["Less","","7+",nP],["LRN","","1+",pN,gN],["Log","","6+",MP],["MatMul","","1+",zP,WP],["MaxPool","","1+",xN,EN],["Mul","","7+",rP],["Neg","","6+",PP],["Not","","1+",NP],["Or","","7+",iP],["Pad","","2-10",j0,mN],["Pad","","11+",yN,vN],["Pow","","7+",oP],["PRelu","","7+",sP],["ReduceLogSum","","1+",MN,Ki],["ReduceMax","","1+",IN,Ki],["ReduceMean","","1+",DN,Ki],["ReduceMin","","1+",ON,Ki],["ReduceProd","","1+",AN,Ki],["ReduceSum","","1-12",SN,Ki],["ReduceSumSquare","","1+",PN,Ki],["Relu","","6+",RP],["Reshape","","5+",NN],["Resize","","10",U0,LN],["Resize","","11+",U0,BN],["Shape","","1+",jN],["Sigmoid","","6+",kP],["Sin","","7+",FP],["Slice","","10+",UN],["Slice","","1-9",VN,$N],["Softmax","","1-12",HN,GN],["Softmax","","13+",WN,zN],["Split","","2-12",qN,YN],["Sqrt","","6+",LP],["Squeeze","","1-12",H0,KN],["Squeeze","","13+",XN],["Sub","","7+",aP],["Sum","","6+",ZN],["Tan","","7+",BP],["Tanh","","6+",jP],["Tile","","6+",QN],["Transpose","","1+",eu,tN],["Upsample","","7-8",V0,RN],["Upsample","","9",V0,kN],["Unsqueeze","","1-12",G0,eR],["Unsqueeze","","13+",JN],["Xor","","7+",lP]]});function v8(t){let e={},n;for(;(n=z0.exec(t))!==null;){let r=n[3].split(",").map(i=>{let o=i.trim().split(" ");return o&&o.length===2?{type:o[0],name:o[1]}:null}).filter(i=>i!==null);e[n[2]]={params:r,body:n[4]}}for(let r in e){let i=nR.replace("__FUNC__",r),o=new RegExp(i,"gm");for(;(n=o.exec(t))!==null;){let l=n[1],a=n[2],c=n[3].split(","),s=l?`${l} ${a};`:"",u=e[r].body,d="";e[r].params.forEach((f,p)=>{f&&(d+=`${f.type} ${f.name} = ${c[p]};
`)}),u=`${d}
 ${u}`,u=u.replace("return",`${a} = `);let h=`
      ${s}
      {
        ${u}
      }
      `;t=t.replace(n[0],h)}}return t=t.replace(z0,""),t}var z0,nR,b8=P(()=>{"use strict";z0=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm,nR="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;"});function Uc(t,e){let n=[],r=[],i=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||i?null:w8(e,t).sort(),l=0;for(let a=0;a<t.length;++a){if(o!=null){if(o[l]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(o[l]==null||o[l]>a)&&t[a]===1&&(n.push(t[a]),r.push(a)),o[l]<=a&&l++}t[a]!==1&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function w8(t,e){let n=e.length;return t=t==null?e.map((r,i)=>i):[].concat(t),np(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),np(t.every(_8),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function _8(t){return t%1===0}function T8(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function HA(t){let e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}var rR,iR=P(()=>{"use strict";dr(),Oe(),rR=class{constructor(t){this.maxTextureSize=t}computeTextureWH(t,e){let n=this.computeTexture(t,e);return e&&e.isPacked&&(n[0]/=2,n[1]/=2),e&&e.reverseWH?[n[1],n[0]]:n}computeTexture(t,e){let n=e&&e.isPacked;if(t.length===0)return n?[2,2]:[1,1];let r=this.maxTextureSize;if(e&&e.breakAxis!==void 0){let l=e.breakAxis>=t.length?1:t.slice(e.breakAxis).reduce((c,s)=>c*s),a=e.breakAxis<=0?1:t.slice(0,e.breakAxis).reduce((c,s)=>c*s);if(l>r||a>r)st.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${t}, breakAxis:${e.breakAxis}`);else return[l,a]}let i=t.slice(0);n&&(r=r*2,i=i.map((l,a)=>a>=i.length-2?i[a]%2===0?i[a]:i[a]+1:i[a]),i.length===1&&(i=[2,i[0]])),i.length!==2&&(i=Uc(i).newShape);let o=T8(i);return i.length<=1&&o<=r?[1,o]:i.length===2&&i[0]<=r&&i[1]<=r?i:i.length===3&&i[0]*i[1]<=r&&i[2]<=r?[i[0]*i[1],i[2]]:i.length===3&&i[0]<=r&&i[1]*i[2]<=r?[i[0],i[1]*i[2]]:i.length===4&&i[0]*i[1]*i[2]<=r&&i[3]<=r?[i[0]*i[1]*i[2],i[3]]:i.length===4&&i[0]<=r&&i[1]*i[2]*i[3]<=r?[i[0],i[1]*i[2]*i[3]]:n?HA(o/4).map(l=>l*2):HA(o)}}}),oR,x8=P(()=>{"use strict";Oe(),Ji(),Ze(),iR(),si(),oR=class extends el{constructor(t){super(t)}getFunctions(){return C(C(C(C(C(C(C({},this.offsetToCoords()),this.coordsToOffset()),this.toVec()),this.valueFrom()),this.getCommonUtilFuncs()),this.getInputsSamplingSnippets()),this.getOutputSamplingSnippet())}getCustomTypes(){return{}}offsetToCoords(){let t="offsetToCoords";return{offsetToCoords:new $(`
      vec2 ${t}(int offset, int width, int height) {
        int t = offset / width;
        int s = offset - t*width;
        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);
        return coords;
      }
      `)}}coordsToOffset(){let t="coordsToOffset";return{coordsToOffset:new $(`
      int ${t}(vec2 coords, int width, int height) {
        float s = coords.s * float(width);
        float t = coords.t * float(height);
        int offset = int(t) * width + int(s);
        return offset;
      }
      `)}}getOutputSamplingSnippet(){let t=this.context.outputTextureLayout;return t.isPacked?this.getPackedOutputSamplingSnippet(t):this.getUnpackedOutputSamplingSnippet(t)}getPackedOutputSamplingSnippet(t){let e=t.unpackedShape,n=[t.width,t.height],r={},i="getOutputCoords";switch(e.length){case 0:r[i]=this.getOutputScalarCoords();break;case 1:r[i]=this.getOutputPacked1DCoords(e,n);break;case 2:r[i]=this.getOutputPacked2DCoords(e,n);break;case 3:r[i]=this.getOutputPacked3DCoords(e,n);break;default:r[i]=this.getOutputPackedNDCoords(e,n)}let o=`
      void setOutput(vec4 val) {
        ${be(this.context.glContext.version).output} = val;
      }
    `,l="floatTextureSetRGBA";return r[l]=new $(o),r}getUnpackedOutputSamplingSnippet(t){let e=t.unpackedShape,n=[t.width,t.height],r={},i="getOutputCoords";switch(e.length){case 0:r[i]=this.getOutputScalarCoords();break;case 1:r[i]=this.getOutputUnpacked1DCoords(e,n);break;case 2:r[i]=this.getOutputUnpacked2DCoords(e,n);break;case 3:r[i]=this.getOutputUnpacked3DCoords(e,n);break;case 4:r[i]=this.getOutputUnpacked4DCoords(e,n);break;case 5:r[i]=this.getOutputUnpacked5DCoords(e,n);break;case 6:r[i]=this.getOutputUnpacked6DCoords(e,n);break;default:throw new Error(`Unsupported output dimensionality: ${e.length}`)}let o=`
        void setOutput(float val) {
          ${be(this.context.glContext.version).output} = vec4(val, 0, 0, 0);
        }
    `,l="floatTextureSetR";return r[l]=new $(o),r}getOutputScalarCoords(){return new $(`
      int getOutputCoords() {
        return 0;
      }
    `)}getOutputPacked1DCoords(t,e){let n=e,r="";return n[0]===1?(r=`
          int getOutputCoords() {
            return 2 * int(TexCoords.y * ${n[1]}.0);
          }
        `,new $(r)):n[1]===1?(r=`
          int getOutputCoords() {
            return 2 * int(TexCoords.x * ${n[0]}.0);
          }
        `,new $(r)):(r=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                 vec2(${n[0]}, ${n[1]}));
          return 2 * (resTexRC.y * ${n[0]} + resTexRC.x);
        }
      `,new $(r))}getOutputPacked2DCoords(t,e){let n="";if(jc.arraysEqual(t,e))return n=`
        ivec2 getOutputCoords() {
          return 2 * ivec2(TexCoords.xy * vec2(${e[0]}, ${e[1]}));
        }
      `,new $(n);let r=e,i=Math.ceil(t[1]/2);return n=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${r[0]}, ${r[1]}));

          int index = resTexRC.y * ${r[0]} + resTexRC.x;

          // reverse r and c order for packed texture
          int r = imod(index, ${i}) * 2;
          int c = 2 * (index / ${i});

          return ivec2(r, c);
        }
      `,new $(n)}getOutputPacked3DCoords(t,e){let n=[e[0],e[1]],r=Math.ceil(t[2]/2),i=r*Math.ceil(t[1]/2),o=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${n[0]}, ${n[1]}));
          int index = resTexRC.y * ${n[0]} + resTexRC.x;

          int b = index / ${i};
          index -= b * ${i};

          // reverse r and c order for packed texture
          int r = imod(index, ${r}) * 2;
          int c = 2 * (index / ${r});

          return ivec3(b, r, c);
        }
      `;return new $(o)}getOutputPackedNDCoords(t,e){let n=[e[0],e[1]],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2),o=i,l="",a="b, r, c";for(let s=2;s<t.length-1;s++)o*=t[t.length-s-1],l=`
      int b${s} = index / ${o};
      index -= b${s} * ${o};
    `+l,a=`b${s}, `+a;let c=`
      ivec${t.length} getOutputCoords() {
        ivec2 resTexRC = ivec2(TexCoords.xy *
                              vec2(${n[0]}, ${n[1]}));
        int index = resTexRC.y * ${n[0]} + resTexRC.x;

        ${l}

        int b = index / ${i};
        index -= b * ${i};

        // reverse r and c order for packed texture
        int r = imod(index, ${r}) * 2;
        int c = 2 * (index / ${r});

        return ivec${t.length}(${a});
      }
    `;return new $(c)}getOutputUnpacked1DCoords(t,e){let n=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${e[0]}, ${e[1]}));
          return resTexRC.y * ${e[0]} + resTexRC.x;
        }
      `;return new $(n)}getOutputUnpacked2DCoords(t,e){let n=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${e[0]}, ${e[1]}));
          int index = resTexRC.y * ${e[0]} + resTexRC.x;
          int r = index / ${t[1]};
          int c = index - r * ${t[1]};
          return ivec2(r, c);
        }
      `;return new $(n)}getOutputUnpacked3DCoords(t,e){let n="",r=t.length,i=null;r<2&&(i=[]),i=new Array(r-1),i[r-2]=t[r-1];for(let a=r-3;a>=0;--a)i[a]=i[a+1]*t[a+1];let o=["r","c","d"],l=i.map((a,c)=>{let s=`int ${o[c]} = index / ${a}`,u=c===i.length-1?`int ${o[c+1]} = index - ${o[c]} * ${a}`:`index -= ${o[c]} * ${a}`;return`${s}; ${u};`}).join("");return n=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${e[0]}, ${e[1]}));
          int index = resTexRC.y * ${e[0]} + resTexRC.x;
          ${l}
          return ivec3(r, c, d);
        }
      `,new $(n)}getOutputUnpacked4DCoords(t,e){let n="",r=t.length,i=null;r<2&&(i=[]),i=new Array(r-1),i[r-2]=t[r-1];for(let a=r-3;a>=0;--a)i[a]=i[a+1]*t[a+1];let o=["r","c","d","d2"],l=i.map((a,c)=>{let s=`int ${o[c]} = index / ${a}`,u=c===i.length-1?`int ${o[c+1]} = index - ${o[c]} * ${a}`:`index -= ${o[c]} * ${a}`;return`${s}; ${u};`}).join("");return n=`
      ivec4 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${e[0]}, ${e[1]}));
          int index = resTexRC.y * ${e[0]} + resTexRC.x;
          ${l}
          return ivec4(r, c, d, d2);
        }
      `,new $(n)}getOutputUnpacked5DCoords(t,e){let n="",r=t.length,i=null;r<2&&(i=[]),i=new Array(r-1),i[r-2]=t[r-1];for(let a=r-3;a>=0;--a)i[a]=i[a+1]*t[a+1];let o=["r","c","d","d2","d3"],l=i.map((a,c)=>{let s=`int ${o[c]} = index / ${a}`,u=c===i.length-1?`int ${o[c+1]} = index - ${o[c]} * ${a}`:`index -= ${o[c]} * ${a}`;return`${s}; ${u};`}).join("");return n=`
      ivec5 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${e[0]}, ${e[1]}));
          int index = resTexRC.y * ${e[0]} + resTexRC.x;
          ${l}
          return ivec5(r, c, d, d2, d3);
        }
      `,new $(n)}getOutputUnpacked6DCoords(t,e){let n="",r=t.length,i=null;r<2&&(i=[]),i=new Array(r-1),i[r-2]=t[r-1];for(let a=r-3;a>=0;--a)i[a]=i[a+1]*t[a+1];let o=["r","c","d","d2","d3","d4"],l=i.map((a,c)=>{let s=`int ${o[c]} = index / ${a}`,u=c===i.length-1?`int ${o[c+1]} = index - ${o[c]} * ${a}`:`index -= ${o[c]} * ${a}`;return`${s}; ${u};`}).join("");return n=`
     ivec6 getOutputCoords() {
         ivec2 resTexRC = ivec2(TexCoords.xy *
                               vec2(${e[0]}, ${e[1]}));
         int index = resTexRC.y * ${e[0]} + resTexRC.x;
         ${l}
         return ivec6(r, c, d, d2, d3, d4);
       }
     `,new $(n)}getCommonUtilFuncs(){let t={},e="uvFromFlat";t[e]=new $(`
    vec2 uvFromFlat(int texNumR, int texNumC, int index) {
      int texC = index / texNumR;
      int texR = index - texC * texNumR;
      // TODO: swap texR, texC order in following function so row is corresponding to u and column is corresponding to
      //       v.
      return (vec2(texR, texC) + halfCR) / vec2(texNumR, texNumC);
    }
    `),e="packedUVfrom1D",t[e]=new $(`
      vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
        int texelIndex = index / 2;
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),e="packedUVfrom2D",t[e]=new $(`
      vec2 packedUVfrom2D(int texNumR, int texNumC, int texelsInLogicalRow, int row, int col) {
        int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),e="packedUVfrom3D",t[e]=new $(`
      vec2 packedUVfrom3D(int texNumR, int texNumC,
          int texelsInBatch, int texelsInLogicalRow, int b,
          int row, int col) {
        int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = index / texNumC;
        int texC = index - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),e="sampleTexture";let n=be(this.context.glContext.version);return t[e]=new $(`
        float sampleTexture(sampler2D textureSampler, vec2 uv) {
            return ${n.texture2D}(textureSampler, uv).r;
        }`),t}getInputsSamplingSnippets(){let t={},e=this.context.outputTextureLayout;return this.context.programInfo.inputNames.forEach((n,r)=>{let i=this.context.inputTextureLayouts[r],o=Lb(n);i.isPacked?t[o]=this.getPackedSamplerFromInput(o,n,i):t[o]=this.getUnpackedSamplerFromInput(o,n,i);let l=Hz(n);i.unpackedShape.length<=e.unpackedShape.length&&(i.isPacked?t[l]=this.getPackedSamplerAtOutputCoords(l,i,e,n):t[l]=this.getUnpackedSamplerAtOutputCoords(l,i,e,n))}),t}getPackedSamplerAtOutputCoords(t,e,n,r){let i=e.unpackedShape,o=n.unpackedShape,l=Lb(r),a=i.length,c=o.length,s=Ir.getBroadcastDims(i,o),u=Qi(c),d=c-a,h,f=Za();a===0?h="":c<2&&s.length>=1?h="coords = 0;":h=s.map(I=>`coords.${f[I+d]} = 0;`).join(`
`);let p="";c<2&&a>0?p="coords":p=i.map((I,k)=>`coords.${f[k+d]}`).join(", ");let g="return outputValue;",y=oe.size(i)===1,b=oe.size(o)===1;if(a===1&&!y&&!b)g=`
        return vec4(outputValue.xy, outputValue.xy);
      `;else if(y&&!b)c===1?g=`
          return vec4(outputValue.x, outputValue.x, 0., 0.);
        `:g=`
          return vec4(outputValue.x);
        `;else if(s.length){let I=a-2,k=a-1;s.indexOf(I)>-1&&s.indexOf(k)>-1?g="return vec4(outputValue.x);":s.indexOf(I)>-1?g="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(k)>-1&&(g="return vec4(outputValue.xx, outputValue.zz);")}let v=`
        int lastDim = coords.${f[c-1]};
        coords.${f[c-1]} = coords.${f[c-2]};
        coords.${f[c-2]} = lastDim;
      `,_=`
      vec4 ${t}() {
        ${u} coords = getOutputCoords();
        ${v}
        ${h}
        vec4 outputValue = ${l}(${p});
        ${g}
      }
    `;return new $(_,["coordinates.getOutputCoords"])}getUnpackedSamplerAtOutputCoords(t,e,n,r){let i=[n.width,n.height],o=[e.width,e.height],l=e.unpackedShape.length,a=n.unpackedShape.length,c=e.unpackedShape,s=n.unpackedShape,u=Lb(r);if(l===a&&jc.arraysEqual(o,i)){let v=`
          float ${t}() {
            return sampleTexture(${r}, TexCoords);
          }
        `;return new $(v,["coordinates.sampleTexture"])}let d=Qi(a),h=Ir.getBroadcastDims(c,s),f=a-l,p,g=Za();l===0?p="":a<2&&h.length>=1?p="coords = 0;":p=h.map(v=>`coords.${g[v+f]} = 0;`).join(`
`);let y="";a<2&&l>0?y="coords":y=e.unpackedShape.map((v,_)=>`coords.${g[_+f]}`).join(", ");let b=`
        float ${t}() {
          ${d} coords = getOutputCoords();
          ${p}
          return ${u}(${y});
        }
      `;return new $(b,["coordinates.getOutputCoords"])}getPackedSamplerFromInput(t,e,n){switch(n.unpackedShape.length){case 0:return this.getPackedSamplerScalar(t,e);case 1:return this.getPackedSampler1D(t,e,n);case 2:return this.getPackedSampler2D(t,e,n);case 3:return this.getPackedSampler3D(t,e,n);default:return this.getPackedSamplerND(t,e,n)}}getUnpackedSamplerFromInput(t,e,n){let r=n.unpackedShape;switch(r.length){case 0:return this.getUnpackedSamplerScalar(t,e,n);case 1:return this.getUnpackedSampler1D(t,e,n);case 2:return this.getUnpackedSampler2D(t,e,n);case 3:return this.getUnpackedSampler3D(t,e,n);case 4:return this.getUnpackedSampler4D(t,e,n);case 5:return this.getUnpackedSampler5D(t,e,n);case 6:return this.getUnpackedSampler6D(t,e,n);default:throw new Error(`Unsupported dimension ${r.length}-D`)}}getPackedSamplerScalar(t,e){let n=be(this.context.glContext.version),r=`
          vec4 ${t}() {
            return ${n.texture2D}(${e}, halfCR);
          }
        `;return new $(r)}getPackedSampler1D(t,e,n){let r=[n.width,n.height],i=[r[1],r[0]],o=be(this.context.glContext.version),l=`vec4 ${t}(int index) {
      vec2 uv = packedUVfrom1D(
      ${i[0]}, ${i[1]}, index);
      return ${o.texture2D}(${e}, uv);
    }`;return new $(l,["coordinates.packedUVfrom1D"])}getPackedSampler2D(t,e,n){let r=n.unpackedShape,i=[n.width,n.height],o=be(this.context.glContext.version),l=i[0],a=i[1];if(i!=null&&jc.arraysEqual(r,i)){let d=`vec4 ${t}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${l}.0);
        return ${o.texture2D}(${e}, uv);
      }`;return new $(d)}let c=i,s=Math.ceil(r[1]/2),u=`vec4 ${t}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c[1]}, ${c[0]}, ${s}, row, col);
      return ${o.texture2D}(${e}, uv);
    }`;return new $(u,["coordinates.packedUVfrom2D"])}getPackedSampler3D(t,e,n){let r=n.unpackedShape,i=[n.width,n.height],o=[i[0],i[1]],l=be(this.context.glContext.version);if(r[0]===1){let h=r.slice(1),f=[1,2],p=Oc(r,h),g=["b","row","col"],y=JSON.parse(JSON.stringify(n));y.unpackedShape=p;let b=this.getPackedSamplerFromInput(t,e,y),v=`${b.routineBody}
      vec4 ${t}(int b, int row, int col) {
        return ${t}(${Ac(g,f)});
      } `;return new $(v,b.dependencies)}let a=o[0],c=o[1],s=Math.ceil(r[2]/2),u=s*Math.ceil(r[1]/2),d=`vec4 ${t}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${c}, ${a}, ${u}, ${s}, b, row, col);
      return ${l.texture2D}(${e}, uv);}`;return new $(d,["coordinates.packedUVfrom3D"])}getPackedSamplerND(t,e,n){let r=n.unpackedShape,i=r.length,o=[n.width,n.height],l=be(this.context.glContext.version),a=[o[0],o[1]],c=a[1],s=a[0],u=Math.ceil(r[i-1]/2),d=u*Math.ceil(r[i-2]/2),h="int b, int row, int col",f=`b * ${d} + (row / 2) * ${u} + (col / 2)`;for(let g=2;g<i-1;g++)h=`int b${g}, `+h,d*=r[i-g-1],f=`b${g} * ${d} + `+f;let p=`vec4 ${t}(${h}) {
      int index = ${f};
      int texR = index / ${s};
      int texC = index - texR * ${s};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}, ${c});
      return ${l.texture2D}(${e}, uv);
    }`;return new $(p)}getUnpackedSamplerScalar(t,e,n){let[r,i]=[n.width,n.height];if(r===1&&i===1){let l=`
          float ${t}() {
            return sampleTexture(${e}, halfCR);
          }
        `;return new $(l,["coordinates.sampleTexture"])}let o=`
        float ${t}() {
          int offset_${e} = coordsToOffset(TexCoords, ${r}, ${i});
          vec2 uv = uvFromFlat(${r}, ${i}, offset_${e});
          return sampleTexture(${e}, uv);
        }
      `;return new $(o,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler1D(t,e,n){let r=n.width,i=n.height;if(i===1&&r===1){let l=`
        float ${t}(int index) {
          return sampleTexture(${e}, halfCR);
        }
      `;return new $(l,["coordinates.sampleTexture"])}if(i===1){let l=`
          float ${t}(int index) {
            vec2 uv = vec2((float(index) + 0.5) / ${r}.0, 0.5);
            return sampleTexture(${e}, uv);
          }
        `;return new $(l,["coordinates.sampleTexture"])}if(r===1){let l=`
          float ${t}(int index) {
            vec2 uv = vec2(0.5, (float(index) + 0.5) / ${i}.0);
            return sampleTexture(${e}, uv);
          }
        `;return new $(l,["coordinates.sampleTexture"])}let o=`
        float ${t}(int index) {
          vec2 uv = uvFromFlat(${r}, ${i}, index);
          return sampleTexture(${e}, uv);
        }
      `;return new $(o,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler2D(t,e,n){let r=n.unpackedShape,i=[n.height,n.width];if(i!=null&&jc.arraysEqual(r,i)){let d=i[1],h=i[0],f=`
          float ${t}(int row, int col) {
            vec2 uv = (vec2(row, col) + halfCR) / vec2(${d}.0, ${h}.0);
            return sampleTexture(${e}, uv);
          }
        `;return new $(f,["coordinates.sampleTexture"])}let{newShape:o,keptDims:l}=Uc(r),a=o;if(a.length<r.length){let d=Oc(r,a),h=JSON.parse(JSON.stringify(n));h.unpackedShape=d;let f=["col","row"],p=`
          ${this.getUnpackedSamplerFromInput(t,e,h).routineBody}
          float ${t}(int row, int col) {
            return ${t}(${Ac(f,l)});
          }
        `;return new $(p,["coordinates.sampleTexture"])}let c=i[1],s=i[0];if(s===1){let d=`
          float ${t}(int row, int col) {
            int offset_${e} = coordsToOffset(TexCoords, ${c}, ${s});
            float index = dot(vec3(row, col, offset_${e}), vec3(${r[1]}, 1, 1));
            vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
            return sampleTexture(${e}, uv);
          }
        `;return new $(d,["coordinates.sampleTexture","coordinates.coordsToOffset"])}if(c===1){let d=`
          float ${t}(int row, int col) {
            int offset_${e} = coordsToOffset(TexCoords, ${c}, ${s});
            float index = dot(vec3(row, col, offset_${e}), vec3(${r[1]}, 1, 1));
            vec2 uv = vec2((index + 0.5) / ${s}.0, 0.5);
            return sampleTexture(${e}, uv);
          }
        `;return new $(d,["coordinates.sampleTexture","coordinates.coordsToOffset"])}let u=`
        float ${t}(int row, int col) {
          int index = col * ${r[1]} + row;
          vec2 uv = uvFromFlat(${c}, ${s}, index);
          return sampleTexture(${e}, uv);
        }
      `;return new $(u,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler3D(t,e,n){let r=n.unpackedShape,i=r[1]*r[2],o=r[2],{newShape:l,keptDims:a}=Uc(r),c=l;if(c.length<r.length){let h=Oc(r,c),f=["batch","col","row"],p=JSON.parse(JSON.stringify(n));p.unpackedShape=h;let g=this.getUnpackedSamplerFromInput(t,e,p),y=a.reverse(),b=`
          ${g.routineBody}
          float ${t}(int batch, int row, int col) {
            return ${t}(${Ac(f,y)});
          }
        `;return new $(b,g.dependencies)}let s=n.width,u=n.height,d=`
          float ${t}(int depth, int row, int col) {
            // Explicitly use integer operations as dot() only works on floats.
            int index = depth * ${i} + col * ${o} + row;
            vec2 uv = uvFromFlat(${s}, ${u}, index);
            return sampleTexture(${e}, uv);
          }
      `;return new $(d,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler4D(t,e,n){let r=n.unpackedShape,i=r[3],o=r[2]*i,l=r[1]*o,a=n.width,c=n.height,s=`
        float ${t}(int row, int col, int depth, int depth2) {
          int index = row * ${l} + col * ${o} +
              depth2 * ${i} + depth;
          vec2 uv = uvFromFlat(${a}, ${c}, index);
          return sampleTexture(${e}, uv);
        }
      `;return new $(s,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler5D(t,e,n){let r=n.unpackedShape,i=r[4],o=r[3]*i,l=r[2]*o,a=r[1]*l,{newShape:c,keptDims:s}=Uc(r);if(c.length<r.length){let f=Oc(r,c),p=["row","col","depth","depth2","depth3"],g=JSON.parse(JSON.stringify(n));g.unpackedShape=f;let y=`
          ${this.getUnpackedSamplerFromInput(t,e,g).routineBody}
          float ${t}(int row, int col, int depth, int depth2, int depth3) {
            return ${t}(${Ac(p,s)});
          }
        `;return new $(y,["coordinates.sampleTexture","coordinates.uvFromFlat"])}let u=n.width,d=n.height,h=`
        float ${t}(int row, int col, int depth, int depth2, int depth3) {
          int index = row * ${a} + col * ${l} + depth * ${o} +
          depth3 * ${i} + depth2;
          vec2 uv = uvFromFlat(${u}, ${d}, index);
          return sampleTexture(${e}, uv);
        }
      `;return new $(h,["coordinates.sampleTexture","coordinates.uvFromFlat"])}getUnpackedSampler6D(t,e,n){let r=n.unpackedShape,i=r[5],o=r[4]*i,l=r[3]*o,a=r[2]*l,c=r[1]*a,{newShape:s,keptDims:u}=Uc(r);if(s.length<r.length){let p=Oc(r,s),g=["row","col","depth","depth2","depth3","depth4"],y=JSON.parse(JSON.stringify(n));y.unpackedShape=p;let b=`
            ${this.getUnpackedSamplerFromInput(t,e,y).routineBody}
            float ${t}(int row, int col, int depth,
              int depth2, int depth3, int depth4) {
              return ${t}(${Ac(g,u)});
            }
          `;return new $(b,["coordinates.sampleTexture","coordinates.uvFromFlat"])}let d=n.width,h=n.height,f=`
          float ${t}(int row, int col, int depth,
            int depth2, int depth3, int depth4) {
            int index = row * ${c} + col * ${a} + depth * ${l} +
            depth2 * ${o} + depth3 * ${i} + depth4;
            vec2 uv = uvFromFlat(${d}, ${h}, index);
            return sampleTexture(${e}, uv);
          }
        `;return new $(f,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}toVec(){let t=this.context.outputTextureLayout,e=t.shape.length,n=t.strides,r=t.width,i=t.height,o=[];for(let a=0;a<e-1;++a)o.push(`
        c[${a}] = offset / ${n[a]};`),o.push(`
        offset -= c[${a}] * ${n[a]};`);o.push(`
        c[${e-1}] = offset;`);let l=`
      void toVec(vec2 texCoords, out int c[${e}]) {
        int offset = coordsToOffset(texCoords, ${r}, ${i});
        ${o.join("")}
      }
      void toVec(int offset, out int c[${e}]) {
        ${o.join("")}
      }
    `;return{toVec:new $(l,["coordinates.coordsToOffset"])}}valueFrom(){let t={};return this.context.programInfo.inputNames.forEach((e,n)=>{let r=this.context.inputTextureLayouts[n],i=(r.unpackedShape.length>0?r.unpackedShape:r.shape).length,o=`_${e}`;t[o]=new $(this.getValueFromSingle(e,i,r.width,r.height,!1),[`shapeUtils.indicesToOffset${o}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),o=o+"_T",t[o]=new $(this.getValueFromSingle(e,i,r.width,r.height,!0),[`shapeUtils.indicesToOffset${o}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"])}),t}getValueFromSingle(t,e,n,r,i){let o=`_${t}`;i&&(o=o+"_T");let l=be(this.context.glContext.version);return`
        float ${o}(int m[${e}]) {
          int offset = indicesToOffset${o}(m);
          vec2 coords = offsetToCoords(offset, ${n}, ${r});
          float value = getColorAsFloat(${l.texture2D}(${t}, coords));
          return value;
        }
        `}getPackedValueFrom(t,e,n,r,i){let o=`_${t}_Pack`;i&&(o=o+"_T");let l=be(this.context.glContext.version);return`
        vec4 ${o}(int m[${e}]) {
          int offset = indicesToOffset_${t}(m);
          vec2 coords = offsetToCoords(offset, ${n}, ${r});
          return ${l.texture2D}(${t}, coords);
        }
        `}}}),sR,E8=P(()=>{"use strict";Ji(),sR=class W0 extends el{constructor(e){super(e)}getFunctions(){return C(C({},this.encodeFloat32()),this.decodeFloat32())}getCustomTypes(){return{}}encodeFloat32(){return{encode:new $(`highp vec4 encode(highp float f) {
        return vec4(f, 0.0, 0.0, 0.0);
      }
        `)}}decodeFloat32(){return{decode:new $(`highp float decode(highp vec4 rgba) {
        return rgba.r;
      }
        `)}}encodeUint8(){let e=W0.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new $(`
      highp vec4 encode(highp float f) {
        highp float F = abs(f);
        highp float Sign = step(0.0,-f);
        highp float Exponent = floor(log2(F));
        highp float Mantissa = (exp2(- Exponent) * F);
        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));
        highp vec4 rgba;
        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));
        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);
        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));
        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));
        ${e}
        rgba = rgba / 255.0; // values need to be normalized to [0,1]
        return rgba;
    }
        `)}}decodeUint8(){let e=W0.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new $(`
        highp float decode(highp vec4 rgba) {
          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]
          ${e}
          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;
          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;
          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);
          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));
          return Result;
      }
        `)}}static isLittleEndian(){let e=new ArrayBuffer(4),n=new Uint32Array(e),r=new Uint8Array(e);if(n[0]=3735928559,r[0]===239)return!0;if(r[0]===222)return!1;throw new Error("unknown endianness")}}}),aR,C8=P(()=>{"use strict";Ji(),Ze(),aR=class extends el{constructor(t){super(t)}getFunctions(){return C(C({},this.setFragColor()),this.getColorAsFloat())}getCustomTypes(){return{}}setFragColor(){let t=be(this.context.glContext.version);return{setFragColor:new $(`
        void setFragColor(float value) {
            ${t.output} = encode(value);
        }
        `,["encoding.encode"])}}getColorAsFloat(){return{getColorAsFloat:new $(`
        float getColorAsFloat(vec4 color) {
            return decode(color);
        }
        `,["encoding.decode"])}}}}),lR,S8=P(()=>{"use strict";Ji(),lR=class Hc extends el{constructor(e){super(e)}getFunctions(){return C(C(C(C(C({},this.bcastIndex()),this.bcastMatmulIndex()),this.offsetToIndices()),this.indicesToOffset()),this.incrementIndices())}getCustomTypes(){return{}}bcastIndex(){let e=this.context.outputTextureLayout.shape.length,n={};return this.context.programInfo.inputNames.forEach((r,i)=>{let o=this.context.inputTextureLayouts[i].unpackedShape;if(o.length<=e){let l=o.length,a=e-l,c=`bcastIndices_${r}`,s="";for(let d=0;d<l;++d)s+=`
          realIndices[${d}] = int( mod(float(bcastedIndices[${a+d}]), ${o[d]}.0) );
          `;let u=`
        void ${c} (int bcastedIndices[${e}], out int realIndices[${l}]) {
          ${s}
        }
        `;n[c]=new $(u)}}),n}bcastMatmulIndex(){let e=this.context.outputTextureLayout.shape.length,n={};return this.context.programInfo.inputNames.forEach((r,i)=>{let o=this.context.inputTextureLayouts[i].shape;if(!(o.length<2||o.length>e)){let l=o.length,a=e-l,c=`bcastMatmulIndices_${r}`,s="";for(let d=0;d<l-2;++d)s+=`
          realIndices[${d}] = int( mod(float(bcastedIndices[${a+d}]), ${o[d]}.0) );
          `;let u=`
        void ${c}(int bcastedIndices[${e}], out int realIndices[${l}]) {
          ${s}
          realIndices[${l-1}] = bcastedIndices[${e-1}];
          realIndices[${l-2}] = bcastedIndices[${e-2}];
        }
        `;n[c]=new $(u)}}),n}indicesToOffset(){let e={};return this.context.programInfo.inputNames.forEach((n,r)=>{let i=this.context.inputTextureLayouts[r].shape,o=this.context.inputTextureLayouts[r].strides,l=i.length,a=`indicesToOffset_${n}`;e[a]=new $(Hc.indexToOffsetSingle(a,l,o)),a=`indicesToOffset_${n}_T`,e[a]=new $(Hc.indexToOffsetSingle(a,l,o.slice().reverse()))}),e}static indexToOffsetSingle(e,n,r){let i="";for(let o=n-1;o>=0;--o)i+=`
        offset += indices[${o}] * ${r[o]};
        `;return`
      int ${e}(int indices[${n}]) {
        int offset = 0;
        ${i}
        return offset;
      }
      `}offsetToIndices(){let e={};return this.context.programInfo.inputNames.forEach((n,r)=>{let i=this.context.inputTextureLayouts[r].shape,o=this.context.inputTextureLayouts[r].strides,l=i.length,a=`offsetToIndices_${n}`;e[a]=new $(Hc.offsetToIndicesSingle(a,l,o)),a=`offsetToIndices_${n}_T`,e[a]=new $(Hc.offsetToIndicesSingle(a,l,o.slice().reverse()))}),e}static offsetToIndicesSingle(e,n,r){let i=[];for(let o=0;o<n-1;++o)i.push(`
      indices[${o}] = offset / ${r[o]};`),i.push(`
        offset -= indices[${o}] * ${r[o]};`);return i.push(`
      indices[${n-1}] = offset;`),`
      void ${e}(int offset, out int indices[${n}]) {
        ${i.join("")}
      }
      `}incrementIndices(){let e={};return this.context.programInfo.inputNames.forEach((n,r)=>{let i=this.context.inputTextureLayouts[r].shape,o=i.length,l=`incrementIndices_${n}`,a="";for(let s=0;s<o;++s)a+=`
        shape[${s}] = ${i[s]};`;let c=`
        void ${l}(int axis, out int indices[${o}]) {
          int shape[${o}];
          ${a};
          for(int i = ${o} -1 ; i >= 0; --i) {
            if(i > axis) continue;
            indices[i] += 1;
            if(indices[i] < shape[i]) {
              break;
            }
            indices[i] = 0;
          }
        }
        `;e[l]=new $(c)}),e}}}),cR,D8=P(()=>{"use strict";Ji(),cR=class extends el{constructor(t){super(t)}getCustomTypes(){return{}}getFunctions(){return C(C(C(C({},this.binaryVecFunctions()),this.copyVec()),this.setVecItem()),this.getVecItem())}binaryVecFunctions(){let t=this.context.outputTextureLayout.shape.length,e={add:"+=",sub:"-=",mul:"*=",div:"/="},n={};for(let r in e){let i=`${r}Vec`,o="";for(let a=0;a<t;++a)o+=`
          dest[${a}] ${e[r]} src[${a}];
          `;let l=`
        void ${i}(int src[${t}], out int dest[${t}]) {
          ${o}
        }
        `;n[i]=new $(l)}return n}copyVec(){let t=this.context.outputTextureLayout.shape.length,e="";for(let r=0;r<t;++r)e+=`
        dest[${r}] = src[${r}];
        `;let n=`
      void copyVec(int src[${t}], out int dest[${t}]) {
        ${e}
      }
      `;return{copyVec:new $(n)}}setVecItem(){let t=this.context.outputTextureLayout.shape.length,e=`
        if(index < 0)
            index =${t} + index;
        if (index == 0)
            m[0] = value;
        `;for(let r=1;r<t-1;++r)e+=`
        else if (index == ${r})
            m[${r}] = value;
            `;e+=`
        else
            m[${t-1}] = value;
        `;let n=`
      void setVecItem(out int m[${t}], int index, int value) {
        ${e}
      }
        `;return{setVecItem:new $(n)}}getVecItem(){let t=this.context.outputTextureLayout.shape.length,e=`
        if(index < 0)
            index = ${t} + index;
        if (index == 0)
            return m[0];
      `;for(let r=1;r<t-1;++r)e+=`
        else if (index == ${r})
            return m[${r}];
      `;e+=`
        else
            return m[${t-1}];
        `;let n=`
      int getVecItem(int m[${t}], int index) {
        ${e}
      }
    `;return{getVecItem:new $(n)}}}}),q0,I8=P(()=>{"use strict";x8(),E8(),C8(),S8(),D8(),q0={encoding:sR,fragcolor:aR,vec:cR,shapeUtils:lR,coordinates:oR}}),uR,O8=P(()=>{"use strict";Ji(),b8(),I8(),Ze(),uR=class{constructor(t,e,n,r){this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new XM(t,e,n,r),Object.keys(q0).forEach(o=>{let l=new q0[o](this.context);this.libs[o]=l});let i=this.glslLibRoutineDependencyGraph;for(let o in this.libs){let l=this.libs[o].getFunctions();for(let a in l){let c=o+"."+a,s;i[c]?(s=i[c],s.routineBody=l[a].routineBody):(s=new P0(c,l[a].routineBody),i[c]=s);let u=l[a].dependencies;if(u)for(let d=0;d<u.length;++d)if(i[u[d]])s.addDependency(i[u[d]]);else{let h=new P0(u[d]);i[u[d]]=h,s.addDependency(h)}}}}preprocess(){let t=this.context.programInfo,e=t.shaderSource;return this.context.programInfo.hasMain||(e=`${e}
      ${Uz(this.context.glContext.version,this.context.outputTextureLayout.shape.length)}`),e=v8(e),`${$z(this.context.glContext.version)}
    ${this.getUniforms(t.inputNames,t.variables)}
    ${this.getImports(e)}
    ${e}`}getImports(t){let e=this.selectGlslLibRoutinesToBeIncluded(t);if(e.length===0)return"";let n="";for(let r=0;r<e.length;++r)if(e[r].routineBody)n+=e[r].routineBody+`
`;else throw new Error(`Missing body for the Glsl Library routine: ${e[r].name}`);return n}selectGlslLibRoutinesToBeIncluded(t){let e=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach(n=>{let r=n.split(".")[1];t.indexOf(r)!==-1&&e.push(this.glslLibRoutineDependencyGraph[n])}),KM.returnOrderedNodes(e)}getUniforms(t,e){let n=[];if(t)for(let r of t)n.push(`uniform sampler2D ${r};`);if(e)for(let r of e)n.push(`uniform ${r.type} ${r.name}${r.arrayLength?`[${r.arrayLength}]`:""};`);return n.join(`
`)}}}),dR,A8=P(()=>{"use strict";Or(),dr(),O8(),Ze(),dR=class{constructor(t,e,n){this.profiler=t,this.glContext=e,this.textureLayoutStrategy=n,this.repo=new Map,this.attributesBound=!1}getArtifact(t){return this.repo.get(t)}setArtifact(t,e){this.repo.set(t,e)}run(t,e,n){this.profiler.event("op",`ProgramManager.run ${t.programInfo.name??"unknown kernel"}`,()=>{let r=this.glContext.gl,i=t.program;r.useProgram(i);try{this.bindOutput(n),this.attributesBound||this.bindAttributes(t.attribLocations),this.bindUniforms(t.uniformLocations,t.programInfo.variables??[],e)}catch(o){throw st.error("ProgramManager",t.programInfo.shaderSource),o}this.profiler.event("backend","GlContext.draw()",()=>{this.glContext.draw()})},this.glContext)}dispose(){this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach(t=>this.glContext.deleteProgram(t.program))}build(t,e,n){return this.profiler.event("backend","ProgramManager.build",()=>{let r=new uR(this.glContext,t,e,n),i=r.preprocess(),o=this.compile(i);return{programInfo:t,program:o,uniformLocations:this.getUniformLocations(o,r.context.programInfo.inputNames,r.context.programInfo.variables),attribLocations:this.getAttribLocations(o)}})}compile(t){if(!this.vertexShader){st.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");let r=Vz(this.glContext.version);this.vertexShader=this.glContext.compileShader(r,this.glContext.gl.VERTEX_SHADER)}de.debug&&st.verbose("ProrgramManager",`FragShader:
${t}
`);let e=this.glContext.compileShader(t,this.glContext.gl.FRAGMENT_SHADER),n=this.glContext.createProgram(this.vertexShader,e);return this.glContext.deleteShader(e),n}bindOutput(t){let e=t.width,n=t.height;st.verbose("ProrgramManager",`Binding output texture to Framebuffer: w/h=${e}/${n}, shape=${t.shape}, type=${t.tensor.type}`),this.glContext.attachFramebuffer(t.texture,e,n)}bindAttributes(t){let e=t.position,n=t.textureCoord;this.glContext.setVertexAttributes(e,n),this.attributesBound=!0}bindUniforms(t,e,n){let r=this.glContext.gl,i=0;for(let{name:o,type:l,location:a,arrayLength:c}of t){let s=e.find(u=>u.name===o)?.data;if(l!=="sampler2D"&&!s)throw new Error(`variable '${o}' does not have data defined in program info`);switch(l){case"sampler2D":this.bindTexture(n[i],a,i),i++;break;case"float":c?r.uniform1fv(a,s):r.uniform1f(a,s);break;case"int":c?r.uniform1iv(a,s):r.uniform1i(a,s);break;default:throw new Error(`Uniform not implemented: ${l}`)}}}bindTexture(t,e,n){this.glContext.bindTextureToUniform(t.texture,n,e)}getAttribLocations(t){return{position:this.getAttribLocation(t,"position"),textureCoord:this.getAttribLocation(t,"textureCoord")}}getUniformLocations(t,e,n){let r=[];if(e)for(let i of e)r.push({name:i,type:"sampler2D",location:this.getUniformLocation(t,i)});if(n)for(let i of n)r.push(N(C({},i),{location:this.getUniformLocation(t,i.name)}));return r}getUniformLocation(t,e){let n=this.glContext.gl.getUniformLocation(t,e);if(n===null)throw new Error(`Uniform ${e} not found.`);return n}getAttribLocation(t,e){return this.glContext.gl.getAttribLocation(t,e)}}}),hR,M8=P(()=>{"use strict";dr(),ip(),hR=class{constructor(t,e,n,r){this.glContext=t,this.layoutStrategy=e,this.profiler=n,this.config=r,this.pendingRead=new Map,r.reuseTextures&&(this.inUseTextures=new Map,this.idleTextures=new Map,this.textureLookup=new Map)}createTextureFromLayout(t,e,n,r){let i=this.toEncoderType(t),o=this.glContext.getEncoder(i,e.channels||1,r);if(e.isPacked&&r===1)throw new Error("not implemented");let l=e.width,a=e.height,c,s;if(this.config.reuseTextures){c=`${l}x${a}_${o.format}_${o.internalFormat}_${o.textureType}`,s=this.inUseTextures.get(c),s||(s=[],this.inUseTextures.set(c,s));let d=this.idleTextures.get(c);if(d&&d.length>0){let h=d.pop();return s.push(h),r===1&&this.glContext.updateTexture(h,l,a,o,this.toTextureData(t,n)),h}}st.verbose("TextureManager",`Creating new texture of size ${e.width}x${e.height}`);let u=this.glContext.allocateTexture(l,a,o,this.toTextureData(t,n));return this.config.reuseTextures&&(s.push(u),this.textureLookup.set(u,c)),u}readTexture(t,e,n){return n||(n=1),this.profiler.event("backend","TextureManager.readTexture",()=>{let r=t.shape.reduce((o,l)=>o*l)*n,i=this.glContext.readTexture(t.texture,t.width,t.height,r,this.toEncoderType(e),n);return this.toTensorData(e,i)})}readTextureAsync(t,e,n){return R(this,null,function*(){let r=t.tensor.dataId;if(n||(n=1),this.pendingRead.has(r)){let i=this.pendingRead.get(r);return new Promise(o=>i?.push(o))}return this.profiler.event("backend","TextureManager.readTextureAsync",()=>R(this,null,function*(){this.pendingRead.set(r,[]);let i=t.shape.reduce((c,s)=>c*s)*n;yield this.glContext.createAndWaitForFence();let o=this.glContext.readTexture(t.texture,t.width,t.height,i,this.toEncoderType(e),n),l=this.toTensorData(e,o),a=this.pendingRead.get(r);return this.pendingRead.delete(r),a?.forEach(c=>c(l)),l}))})}readUint8TextureAsFloat(t){return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",()=>{let e=t.shape.reduce((r,i)=>r*i),n=this.glContext.readTexture(t.texture,t.width,t.height,e*4,"byte",4);return new Float32Array(n.buffer,n.byteOffset,e)})}releaseTexture(t,e){let n;if(this.config.reuseTextures&&(n=this.textureLookup.get(t.texture),n)){e&&this.textureLookup.delete(n);let r=this.inUseTextures.get(n);if(r){let i=r.indexOf(t.texture);if(i!==-1){r.splice(i,1);let o=this.idleTextures.get(n);o||(o=[],this.idleTextures.set(n,o)),o.push(t.texture)}}}(!n||e)&&(st.verbose("TextureManager",`Deleting texture of size ${t.width}x${t.height}`),this.glContext.deleteTexture(t.texture))}toTensorData(t,e){switch(t){case"int16":return e instanceof Int16Array?e:Int16Array.from(e);case"int32":return e instanceof Int32Array?e:Int32Array.from(e);case"int8":return e instanceof Int8Array?e:Int8Array.from(e);case"uint16":return e instanceof Uint16Array?e:Uint16Array.from(e);case"uint32":return e instanceof Uint32Array?e:Uint32Array.from(e);case"uint8":case"bool":return e instanceof Uint8Array?e:Uint8Array.from(e);case"float32":return e instanceof Float32Array?e:Float32Array.from(e);case"float64":return e instanceof Float64Array?e:Float64Array.from(e);default:throw new Error(`TensorData type ${t} is not supported`)}}toTextureData(t,e){if(e)return e instanceof Float32Array?e:new Float32Array(e)}toEncoderType(t){return"float"}clearActiveTextures(){this.glContext.clearActiveTextures()}}}),fR,P8=P(()=>{"use strict";dr(),_z(),r5(),y8(),A8(),iR(),M8(),fR=class{constructor(t,e){this.backend=t,this.context=e,this.layoutStrategy=new rR(t.glContext.maxTextureSize),this.programManager=new dR(this.context.profiler,t.glContext,this.layoutStrategy),this.textureManager=new hR(t.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:t.textureCacheMode==="full"}),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map,this.pack=t.pack,this.pack2unpackMap=new Map,this.unpack2packMap=new Map}createInferenceHandler(){return new WM(this)}onGraphInitialized(t){let e=t.getValues().filter(n=>n.from===-1&&n.tensor).map(n=>n.tensor.dataId);this.initializers=new Set(e)}isInitializer(t){return this.initializers?this.initializers.has(t):!1}addInitializer(t){this.initializers.add(t)}getTextureData(t,e){return e?this.packedTextureDataCache.get(t):this.unpackedTextureDataCache.get(t)}setTextureData(t,e,n=!1){st.verbose("WebGLSessionHandler","Storing Texture data in cache"),n?this.packedTextureDataCache.set(t,e):this.unpackedTextureDataCache.set(t,e)}dispose(){this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(t=>this.textureManager.releaseTexture(t,!0)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(t=>this.textureManager.releaseTexture(t,!0)),this.unpackedTextureDataCache=new Map}resolve(t,e,n){let r=bz(t,e,tR);return{impl:r.opImpl,context:r.opInit?r.opInit(t,n):t}}}});function N8(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}var Y0,R8=P(()=>{"use strict";Or(),ip(),ip(),si(),Y0=class{constructor(t,e){this.frameBufferBound=!1,this.itemsToPoll=[],this.gl=t,this.version=e,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters()}allocateTexture(t,e,n,r){let i=this.gl,o=i.createTexture();i.bindTexture(i.TEXTURE_2D,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE);let l=r?n.encode(r,t*e):null;return i.texImage2D(i.TEXTURE_2D,0,n.internalFormat,t,e,0,n.format,n.textureType,l),this.checkError(),o}updateTexture(t,e,n,r,i){let o=this.gl;o.bindTexture(o.TEXTURE_2D,t);let l=r.encode(i,e*n);o.texSubImage2D(o.TEXTURE_2D,0,0,0,e,n,r.format,r.textureType,l),this.checkError()}attachFramebuffer(t,e,n){let r=this.gl;r.bindTexture(r.TEXTURE_2D,t),r.bindFramebuffer(r.FRAMEBUFFER,this.framebuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0),this.checkError(),r.viewport(0,0,e,n),r.scissor(0,0,e,n)}readTexture(t,e,n,r,i,o){let l=this.gl;o||(o=1),this.frameBufferBound||this.attachFramebuffer(t,e,n);let a=this.getEncoder(i,o),c=a.allocate(e*n);return l.bindTexture(l.TEXTURE_2D,t),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,t,0),l.readPixels(0,0,e,n,l.RGBA,a.textureType,c),this.checkError(),a.decode(c,r)}isFramebufferReady(){return!0}getActiveTexture(){let t=this.gl;return`TEXTURE${t.getParameter(this.gl.ACTIVE_TEXTURE)-t.TEXTURE0}`}getTextureBinding(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D)}getFramebufferBinding(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)}setVertexAttributes(t,e){let n=this.gl;n.vertexAttribPointer(t,3,n.FLOAT,!1,20,0),n.enableVertexAttribArray(t),e!==-1&&(n.vertexAttribPointer(e,2,n.FLOAT,!1,20,12),n.enableVertexAttribArray(e)),this.checkError()}createProgram(t,e){let n=this.gl,r=n.createProgram();return n.attachShader(r,t),n.attachShader(r,e),n.linkProgram(r),r}compileShader(t,e){let n=this.gl,r=n.createShader(e);if(!r)throw new Error(`createShader() returned null with type ${e}`);if(n.shaderSource(r,t),n.compileShader(r),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw new Error(`Failed to compile shader: ${n.getShaderInfoLog(r)}
Shader source:
${t}`);return r}deleteShader(t){this.gl.deleteShader(t)}bindTextureToUniform(t,e,n){let r=this.gl;r.activeTexture(r.TEXTURE0+e),this.checkError(),r.bindTexture(r.TEXTURE_2D,t),this.checkError(),r.uniform1i(n,e),this.checkError()}draw(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError()}checkError(){if(de.debug){let t=this.gl,e=t.getError(),n="";switch(e){case t.NO_ERROR:return;case t.INVALID_ENUM:n="INVALID_ENUM";break;case t.INVALID_VALUE:n="INVALID_VALUE";break;case t.INVALID_OPERATION:n="INVALID_OPERATION";break;case t.INVALID_FRAMEBUFFER_OPERATION:n="INVALID_FRAMEBUFFER_OPERATION";break;case t.OUT_OF_MEMORY:n="OUT_OF_MEMORY";break;case t.CONTEXT_LOST_WEBGL:n="CONTEXT_LOST_WEBGL";break;default:n=`Unknown WebGL Error: ${e.toString(16)}`}throw new Error(n)}}deleteTexture(t){this.gl.deleteTexture(t)}deleteProgram(t){this.gl.deleteProgram(t)}getEncoder(t,e,n=0){if(this.version===2)return new HM(this.gl,e);switch(t){case"float":return n===1||this.isRenderFloat32Supported?new A0(this.gl,e):new A0(this.gl,e,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw new Error("not implemented");case"byte":return new GM(this.gl,e);default:throw new Error(`Invalid dataType: ${t}`)}}clearActiveTextures(){let t=this.gl;for(let e=0;e<this.maxTextureImageUnits;++e)t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,null)}dispose(){if(this.disposed)return;let t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(this.framebuffer),t.bindBuffer(t.ARRAY_BUFFER,null),t.deleteBuffer(this.vertexbuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.finish(),this.disposed=!0}createDefaultGeometry(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0])}createVertexbuffer(){let t=this.gl,e=t.createBuffer();if(!e)throw new Error("createBuffer() returned null");let n=this.createDefaultGeometry();return t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW),this.checkError(),e}createFramebuffer(){let t=this.gl.createFramebuffer();if(!t)throw new Error("createFramebuffer returned null");return t}queryVitalParameters(){let t=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),this.version===1&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw new Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),this.version}getExtensions(){this.version===2?(this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"),this.disjointTimerQueryWebgl2Extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"))}checkFloatTextureAttachableToFrameBuffer(){let t=this.gl,e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);let n=this.version===2?t.RGBA32F:t.RGBA;t.texImage2D(t.TEXTURE_2D,0,n,1,1,0,t.RGBA,t.FLOAT,null);let r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0);let i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(e),t.deleteFramebuffer(r),i}checkRenderFloat32(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Download(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension||!this.gl.getExtension("WEBGL_color_buffer_float"))return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Blend(){let t=this.gl,e,n,r,i,o;try{e=t.createTexture(),n=t.createFramebuffer(),t.bindTexture(t.TEXTURE_2D,e);let l=this.version===2?t.RGBA32F:t.RGBA;return t.texImage2D(t.TEXTURE_2D,0,l,1,1,0,t.RGBA,t.FLOAT,null),t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),t.enable(t.BLEND),r=t.createShader(t.VERTEX_SHADER),!r||(t.shaderSource(r,"void main(){}"),t.compileShader(r),i=t.createShader(t.FRAGMENT_SHADER),!i)||(t.shaderSource(i,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),t.compileShader(i),o=t.createProgram(),!o)?!1:(t.attachShader(o,r),t.attachShader(o,i),t.linkProgram(o),t.useProgram(o),t.drawArrays(t.POINTS,0,1),t.getError()===t.NO_ERROR)}finally{t.disable(t.BLEND),o&&t.deleteProgram(o),r&&t.deleteShader(r),i&&t.deleteShader(i),n&&(t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(n)),e&&(t.bindTexture(t.TEXTURE_2D,null),t.deleteTexture(e))}}beginTimer(){if(this.version===2&&this.disjointTimerQueryWebgl2Extension){let t=this.gl,e=this.disjointTimerQueryWebgl2Extension,n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}else throw new Error("WebGL1 profiling currently not supported.")}endTimer(){if(this.version===2&&this.disjointTimerQueryWebgl2Extension){let t=this.gl,e=this.disjointTimerQueryWebgl2Extension;t.endQuery(e.TIME_ELAPSED_EXT);return}else throw new Error("WebGL1 profiling currently not supported")}isTimerResultAvailable(t){let e=!1,n=!1;if(this.version===2&&this.disjointTimerQueryWebgl2Extension){let r=this.gl,i=this.disjointTimerQueryWebgl2Extension;e=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE),n=r.getParameter(i.GPU_DISJOINT_EXT)}else throw new Error("WebGL1 profiling currently not supported");return e&&!n}getTimerResult(t){let e=0;if(this.version===2){let n=this.gl;e=n.getQueryParameter(t,n.QUERY_RESULT),n.deleteQuery(t)}else throw new Error("WebGL1 profiling currently not supported");return e/1e6}waitForQueryAndGetTime(t){return R(this,null,function*(){return yield $I(()=>this.isTimerResultAvailable(t)),this.getTimerResult(t)})}createAndWaitForFence(){return R(this,null,function*(){let t=this.createFence(this.gl);return this.pollFence(t)})}createFence(t){let e,n=t,r=n.fenceSync(n.SYNC_GPU_COMMANDS_COMPLETE,0);return t.flush(),r===null?e=()=>!0:e=()=>{let i=n.clientWaitSync(r,0,0);return i===n.ALREADY_SIGNALED||i===n.CONDITION_SATISFIED},{query:r,isFencePassed:e}}pollFence(t){return R(this,null,function*(){return new Promise(e=>{this.addItemToPoll(()=>t.isFencePassed(),()=>e())})})}pollItems(){let t=N8(this.itemsToPoll.map(e=>e.isDoneFn));for(let e=0;e<=t;++e){let{resolveFn:n}=this.itemsToPoll[e];n()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){return R(this,null,function*(){this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),!(this.itemsToPoll.length>1)&&(yield $I(()=>(this.pollItems(),this.itemsToPoll.length===0)))})}}});function pR(t){let e;if((!t||t==="webgl2")&&"webgl2"in ls?e=ls.webgl2:(!t||t==="webgl")&&"webgl"in ls&&(e=ls.webgl),!e)try{let r=F8();e=GA(r,t)}catch{let r=k8();e=GA(r,t)}t=t||e.version===1?"webgl":"webgl2";let n=e.gl;return ls[t]=e,n.isContextLost()?(delete ls[t],pR(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),e)}function GA(t,e){let n={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1},r,i=n;if((!e||e==="webgl2")&&(r=t.getContext("webgl2",i),r))try{return new Y0(r,2)}catch(o){st.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl2'. Error: ${o}`)}if((!e||e==="webgl")&&(r=t.getContext("webgl",i)||t.getContext("experimental-webgl",i),r))try{return new Y0(r,1)}catch(o){st.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: ${o}`)}throw new Error("WebGL is not supported")}function k8(){if(typeof document>"u")throw new TypeError("failed to create canvas: document is not supported");let t=document.createElement("canvas");return t.width=1,t.height=1,t}function F8(){if(typeof OffscreenCanvas>"u")throw new TypeError("failed to create offscreen canvas: OffscreenCanvas is not supported");return new OffscreenCanvas(1,1)}var ls,L8=P(()=>{"use strict";dr(),R8(),ls={}}),gR,B8=P(()=>{"use strict";Or(),dr(),P8(),L8(),gR=class{get contextId(){return de.webgl.contextId}set contextId(t){de.webgl.contextId=t}get matmulMaxBatchSize(){return de.webgl.matmulMaxBatchSize}set matmulMaxBatchSize(t){de.webgl.matmulMaxBatchSize=t}get textureCacheMode(){return de.webgl.textureCacheMode}set textureCacheMode(t){de.webgl.textureCacheMode=t}get pack(){return de.webgl.pack}set pack(t){de.webgl.pack=t}get async(){return de.webgl.async}set async(t){de.webgl.async=t}initialize(){try{return this.glContext=pR(this.contextId),typeof this.matmulMaxBatchSize!="number"&&(this.matmulMaxBatchSize=16),typeof this.textureCacheMode!="string"&&(this.textureCacheMode="full"),typeof this.pack!="boolean"&&(this.pack=!1),typeof this.async!="boolean"&&(this.async=!1),st.setWithEnv(de),de.webgl.context||Object.defineProperty(de.webgl,"context",{value:this.glContext.gl}),st.verbose("WebGLBackend",`Created WebGLContext: ${typeof this.glContext} with matmulMaxBatchSize: ${this.matmulMaxBatchSize}; textureCacheMode: ${this.textureCacheMode}; pack: ${this.pack}; async: ${this.async}.`),!0}catch(t){return st.warning("WebGLBackend",`Unable to initialize WebGLBackend. ${t}`),!1}}createSessionHandler(t){return new fR(this,t)}dispose(){this.glContext.dispose()}}});function mR(t){return R(this,null,function*(){if(t){let e=typeof t=="string"?[t]:t;for(let n of e){let r=dw.get(n);if(r)return r;let i=yield j8(n);if(i)return i}}else return mR(["webgl"]);throw new Error("no available backend to use")})}function j8(t){return R(this,null,function*(){let e=yR;if(typeof e[t]<"u"&&V8(e[t])){let n=e[t],r=n.initialize();if(typeof r=="object"&&"then"in r&&(r=yield r),r)return dw.set(t,n),n}})}function V8(t){let e=t;return"initialize"in e&&typeof e.initialize=="function"&&"createSessionHandler"in e&&typeof e.createSessionHandler=="function"&&"dispose"in e&&typeof e.dispose=="function"}var dw,yR,$8=P(()=>{"use strict";B8(),dw=new Map,yR={webgl:new gR}}),zA,vR,U8=P(()=>{"use strict";dr(),zA=class{constructor(t,e){this.op=t,this.node=e}},vR=class{constructor(t,e,n){this.graph=t,this.profiler=n,this.initialize(e)}initialize(t){this.profiler.event("session","ExecutionPlan.initialize",()=>{let e=this.graph.getNodes();if(e.length!==t.length)throw new Error("The size of nodes and OPs do not match.");this._ops=t.map((n,r)=>new zA(n,e[r])),this.reset(),this._starter=[],this._ops.forEach((n,r)=>{let i=!0;for(let o of n.node.inputs)if(!this._values[o]&&this.graph.getInputIndices().indexOf(o)===-1){i=!1;break}i&&this._starter.push(r)})})}reset(){this._values=this.graph.getValues().map(t=>t.tensor)}execute(t,e){return R(this,null,function*(){return this.profiler.event("session","ExecutionPlan.execute",()=>R(this,null,function*(){this.reset();let n=t.createInferenceHandler(),r=this.graph.getInputIndices();if(e.length!==r.length)throw new Error(`number of input tensors don't match the number of inputs to the model: actual: ${e.length} expected: ${r.length}`);e.forEach((s,u)=>{let d=r[u];this._values[d]=s});let i=this._starter.slice(0),o=this.graph.getValues(),l=this.graph.getNodes(),a=0;for(;a<i.length;){let s=i[a++],u=this._ops[s],d=u.node.inputs.map(g=>this._values[g]);if(d.indexOf(void 0)!==-1)throw new Error(`unresolved input detected: op: ${u.node}`);let h=d;st.verbose("ExecPlan",`Running op:${u.node.name} (${h.map((g,y)=>`'${u.node.inputs[y]}': ${g.type}[${g.dims.join(",")}]`).join(", ")})`);let f=yield this.profiler.event("node",u.node.name,()=>R(this,null,function*(){return u.op.impl(n,h,u.op.context)}));if(f.length!==u.node.outputs.length)throw new Error("the size of output does not match model definition.");f.forEach((g,y)=>{let b=u.node.outputs[y];if(this._values[b])throw new Error(`output [${b}] already has value: op:${u.node.name}`);this._values[b]=g});let p=new Set;f.forEach((g,y)=>{let b=u.node.outputs[y];for(let v of o[b].to){let _=l[v],I=!0;for(let k of _.inputs)if(!this._values[k]){I=!1;break}I&&p.add(v)}}),i.push(...p)}let c=[];for(let s=0;s<this.graph.getOutputIndices().length;s++){let u=this.graph.getOutputIndices()[s],d=this._values[u];if(d===void 0)throw new Error(`required output [${u}] does not have value`);u===0?yield d.getData():d.data,c.push(d)}return st.verbose("ExecPlan","disposing of inferenceHandler"),n.dispose(),c}))})}}}),pe,Dn,X0,H8=P(()=>{"use strict";up(),pe=Ya(nu()),Qa(),Oe(),Dn=Ne.experimental.fbs,X0=class Gc{constructor(e){if(this._attributes=new Map,e!=null){for(let n of e)n instanceof pe.onnx.AttributeProto?this._attributes.set(n.name,[Gc.getValue(n),Gc.getType(n)]):n instanceof Dn.Attribute&&this._attributes.set(n.name(),[Gc.getValue(n),Gc.getType(n)]);if(this._attributes.size<e.length)throw new Error("duplicated attribute names")}}set(e,n,r){this._attributes.set(e,[r,n])}delete(e){this._attributes.delete(e)}getFloat(e,n){return this.get(e,"float",n)}getInt(e,n){return this.get(e,"int",n)}getString(e,n){return this.get(e,"string",n)}getTensor(e,n){return this.get(e,"tensor",n)}getFloats(e,n){return this.get(e,"floats",n)}getInts(e,n){return this.get(e,"ints",n)}getStrings(e,n){return this.get(e,"strings",n)}getTensors(e,n){return this.get(e,"tensors",n)}get(e,n,r){let i=this._attributes.get(e);if(i===void 0){if(r!==void 0)return r;throw new Error(`required attribute not found: ${e}`)}if(i[1]!==n)throw new Error(`type mismatch: expected ${n} but got ${i[1]}`);return i[0]}static getType(e){let n=e instanceof pe.onnx.AttributeProto?e.type:e.type();switch(n){case pe.onnx.AttributeProto.AttributeType.FLOAT:return"float";case pe.onnx.AttributeProto.AttributeType.INT:return"int";case pe.onnx.AttributeProto.AttributeType.STRING:return"string";case pe.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case pe.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case pe.onnx.AttributeProto.AttributeType.INTS:return"ints";case pe.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case pe.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw new Error(`attribute type is not supported yet: ${pe.onnx.AttributeProto.AttributeType[n]}`)}}static getValue(e){let n=e instanceof pe.onnx.AttributeProto?e.type:e.type();if(n===pe.onnx.AttributeProto.AttributeType.GRAPH||n===pe.onnx.AttributeProto.AttributeType.GRAPHS)throw new Error("graph attribute is not supported yet");let r=this.getValueNoCheck(e);if(n===pe.onnx.AttributeProto.AttributeType.INT&&Dr.isLong(r))return Dr.longToNumber(r);if(n===pe.onnx.AttributeProto.AttributeType.INTS){let i=r,o=new Array(i.length);for(let l=0;l<i.length;l++){let a=i[l];o[l]=Dr.longToNumber(a)}return o}if(n===pe.onnx.AttributeProto.AttributeType.TENSOR)return e instanceof pe.onnx.AttributeProto?An.fromProto(r):An.fromOrtTensor(r);if(n===pe.onnx.AttributeProto.AttributeType.TENSORS){if(e instanceof pe.onnx.AttributeProto)return r.map(i=>An.fromProto(i));if(e instanceof Dn.Attribute)return r.map(i=>An.fromOrtTensor(i))}return n===pe.onnx.AttributeProto.AttributeType.STRING&&e instanceof pe.onnx.AttributeProto?C0(r):n===pe.onnx.AttributeProto.AttributeType.STRINGS&&e instanceof pe.onnx.AttributeProto?r.map(C0):r}static getValueNoCheck(e){return e instanceof pe.onnx.AttributeProto?this.getValueNoCheckFromOnnxFormat(e):this.getValueNoCheckFromOrtFormat(e)}static getValueNoCheckFromOnnxFormat(e){switch(e.type){case pe.onnx.AttributeProto.AttributeType.FLOAT:return e.f;case pe.onnx.AttributeProto.AttributeType.INT:return e.i;case pe.onnx.AttributeProto.AttributeType.STRING:return e.s;case pe.onnx.AttributeProto.AttributeType.TENSOR:return e.t;case pe.onnx.AttributeProto.AttributeType.GRAPH:return e.g;case pe.onnx.AttributeProto.AttributeType.FLOATS:return e.floats;case pe.onnx.AttributeProto.AttributeType.INTS:return e.ints;case pe.onnx.AttributeProto.AttributeType.STRINGS:return e.strings;case pe.onnx.AttributeProto.AttributeType.TENSORS:return e.tensors;case pe.onnx.AttributeProto.AttributeType.GRAPHS:return e.graphs;default:throw new Error(`unsupported attribute type: ${pe.onnx.AttributeProto.AttributeType[e.type]}`)}}static getValueNoCheckFromOrtFormat(e){switch(e.type()){case Dn.AttributeType.FLOAT:return e.f();case Dn.AttributeType.INT:return e.i();case Dn.AttributeType.STRING:return e.s();case Dn.AttributeType.TENSOR:return e.t();case Dn.AttributeType.GRAPH:return e.g();case Dn.AttributeType.FLOATS:return e.floatsArray();case Dn.AttributeType.INTS:{let n=[];for(let r=0;r<e.intsLength();r++)n.push(e.ints(r));return n}case Dn.AttributeType.STRINGS:{let n=[];for(let r=0;r<e.stringsLength();r++)n.push(e.strings(r));return n}case Dn.AttributeType.TENSORS:{let n=[];for(let r=0;r<e.tensorsLength();r++)n.push(e.tensors(r));return n}default:throw new Error(`unsupported attribute type: ${Dn.AttributeType[e.type()]}`)}}}}),o0,Rc,K0,oi,s0,WA,G8=P(()=>{"use strict";H8(),up(),o0=Ya(nu()),Qa(),Oe(),Rc=Ne.experimental.fbs,K0={from:(t,e)=>new WA(t,e)},oi=class{constructor(t){this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,t&&(this.type=In.tensorValueTypeFromProto(t.type.tensorType))}get from(){return this._from}get to(){return this._to}},s0=class{constructor(t,e){t instanceof o0.onnx.NodeProto?(this.name=t.name,this.opType=t.opType,this.attributes=new X0(t.attribute)):t instanceof Rc.Node&&(this.name=e??t.name(),this.opType=t.opType(),this.attributes=new X0(In.tensorAttributesFromORTFormat(t))),this.inputs=[],this.outputs=[],this.executeNode=!0}},WA=class{constructor(t,e){if(!t)throw new TypeError("graph is empty");this.buildGraph(t),this.transformGraph(e),this.checkIsAcyclic()}getInputIndices(){return this._allInputIndices}getInputNames(){return this._allInputNames}getOutputIndices(){return this._allOutputIndices}getOutputNames(){return this._allOutputNames}getValues(){return this._allData}getNodes(){return this._nodes}buildGraph(t){if(t instanceof o0.onnx.GraphProto)this.buildGraphFromOnnxFormat(t);else if(t instanceof Rc.Graph)this.buildGraphFromOrtFormat(t);else throw new TypeError("Graph type is not supported.")}buildGraphFromOnnxFormat(t){let e=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];let n=new Map;if(!t.input)throw new Error("missing information in graph: input");let r=[];for(let i of t.input){if(e.has(i.name))throw new Error(`duplicated input name: ${i.name}`);let o=this._allData.push(new oi(i))-1;e.set(i.name,o),r.push(i.name)}if(!t.initializer)throw new Error("missing information in graph: initializer");for(let i of t.initializer){let o=e.get(i.name);if(o===void 0){let l=new oi;l.type={shape:{dims:In.tensorDimsFromProto(i.dims)},tensorType:In.tensorDataTypeFromProto(i.dataType)},o=this._allData.push(l)-1,e.set(i.name,o)}this._allData[o]._from=-1,this._allData[o].tensor=An.fromProto(i)}for(let i=0;i<this._allData.length;i++)this._allData[i].tensor||(this._allInputIndices.push(i),this._allInputNames.push(r[i]));if(!t.output)throw new Error("missing information in graph: output");for(let i of t.output){if(e.has(i.name))throw new Error(`duplicated output name: ${i.name}`);let o=this._allData.push(new oi(i))-1;e.set(i.name,o),this._allOutputIndices.push(o),this._allOutputNames.push(i.name)}if(!t.node)throw new Error("missing information in graph: node");for(let i of t.node){if(!i.name)for(let l=0;;l++){let a=`unnamed_${i.opType}_${l}`;if(!n.has(a)){i.name=a;break}}if(n.has(i.name))throw new Error(`duplicated node name: ${i.name}`);let o=this._nodes.push(new s0(i))-1;n.set(i.name,o)}for(let i=0;i<this._nodes.length;i++){let o=this._nodes[i],l=t.node[i];if(!l.output)throw new Error(`missing output for node: ${l.name}`);for(let a of l.output){let c=e.get(a);if(typeof c>"u"&&(c=this._allData.push(new oi)-1,e.set(a,c)),o.outputs.push(c),this._allData[c]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${c}`);if(this._allData[c]._from=i,l.opType==="Constant"){if(!l.attribute||l.attribute.length!==1||!l.attribute[0].t)throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!l.output||l.output.length!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");o.outputs.pop(),o.executeNode=!1,this._allData[c]._from=-1,this._allData[c].tensor=An.fromProto(l.attribute[0].t)}}}for(let i=0;i<this._nodes.length;i++){let o=this._nodes[i],l=t.node[i];if(!l.input)throw new Error(`missing input for node: ${l.name}`);for(let a of l.input){let c=e.get(a);if(typeof c>"u"){if(a===""&&(l.input.length===3||l.input.length===4)&&l.opType==="Resize")continue;throw new Error(`unrecognized input '${a}' for node: ${l.name}`)}o.inputs.push(c),this._allData[c]._to.push(i)}}return!0}buildGraphFromOrtFormat(t){let e=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];let n=new Map,r=[];for(let i=0;i<t.inputsLength();i++){let o=t.inputs(i);if(e.has(o))throw new Error(`duplicated input name: ${o}`);for(let l=0;l<t.nodeArgsLength();l++)if(t.nodeArgs(l)?.name()===o){let a=new oi;if(t.nodeArgs(l)?.type()?.valueType()!==Rc.TypeInfoValue.tensor_type)throw new Error("Unexpected value type for the nodeArg.");let c=t.nodeArgs(l).type().value(new Rc.TensorTypeAndShape),s=In.tensorDataTypeFromProto(c.elemType()),u=c.shape(),d=[];for(let f=0;f<u.dimLength();f++)d.push(Dr.longToNumber(u.dim(f).value().dimValue()));a.type={shape:{dims:d},tensorType:s};let h=this._allData.push(a)-1;e.set(o,h),r.push(o)}}for(let i=0;i<t.initializersLength();i++){let o=t.initializers(i),l=e.get(o.name());if(l===void 0){let a=new oi,c=In.tensorDimsFromORTFormat(o),s=In.tensorDataTypeFromProto(o.dataType());a.type={shape:{dims:c},tensorType:s},l=this._allData.push(a)-1,e.set(o.name(),l)}this._allData[l]._from=-1,this._allData[l].tensor=An.fromOrtTensor(o)}for(let i=0;i<this._allData.length;i++)this._allData[i].tensor||(this._allInputIndices.push(i),this._allInputNames.push(r[i]));for(let i=0;i<t.outputsLength();i++){let o=t.outputs(i);if(e.has(o))throw new Error(`duplicated output name: ${o}`);let l=this._allData.push(new oi)-1;e.set(o,l),this._allOutputIndices.push(l),this._allOutputNames.push(o)}if(!t.nodes)throw new Error("missing information in graph: node");for(let i=0;i<t.nodesLength();i++){let o=t.nodes(i),l=o.name();if(!l)for(let c=0;l=`unnamed_${o.opType()}_${c}`,!!n.has(l);c++);if(n.has(l))throw new Error(`duplicated node name: ${l}`);let a=this._nodes.push(new s0(o,l))-1;n.set(l,a)}for(let i=0;i<this._nodes.length;i++){let o=this._nodes[i],l=t.nodes(i);if(l==null)throw new Error(`No node exists at index ${i}`);if(l?.outputsLength()===0)throw new Error(`missing output for node: ${l.name}`);for(let a=0;a<l?.outputsLength();a++){let c=l?.outputs(a),s=e.get(c);if(typeof s>"u"&&(s=this._allData.push(new oi)-1,e.set(c,s)),o.outputs.push(s),this._allData[s]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${s}`);if(this._allData[s]._from=i,l.opType()==="Constant"){if(l.attributesLength()!==1||!l.attributes(0).t())throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(l.outputsLength()!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");o.outputs.pop(),o.executeNode=!1,this._allData[s]._from=-1,this._allData[s].tensor=An.fromOrtTensor(l.attributes(0).t())}}}for(let i=0;i<this._nodes.length;i++){let o=this._nodes[i],l=t.nodes(i);if(l.inputsLength()===0)throw new Error(`missing input for node: ${l.name}`);for(let a=0;a<l.inputsLength();a++){let c=l.inputs(a),s=e.get(c);if(typeof s>"u")throw new Error(`unrecognized input '${c}' for node: ${l.name()}`);o.inputs.push(s),this._allData[s]._to.push(i)}}}checkIsAcyclic(){let t=new Set;this._allInputIndices.forEach(r=>{this._allData[r]._to.forEach(i=>{t.add(i)})});let e=Array.from(t),n=new Array(this._nodes.length).fill("white");for(;e.length>0;){let r=e.pop();n[r]==="gray"?n[r]="black":(e.push(r),n[r]="gray",this._nodes[r].outputs.forEach(i=>{let o=this._allData[i];if(typeof o.tensor<"u")throw new Error("node outputs should not be initialized");if(o._from!==r)throw new Error("from property of the Value object doesn't match index of Node being processed");o._to.forEach(l=>{if(n[l]==="gray")throw new Error("model graph is cyclic");n[l]==="white"&&e.push(l)})}))}}transformGraph(t){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),this.fuseConvActivationNodes(),t&&t.transformGraph(this),this.finalizeGraph()}finalizeGraph(){let t=0,e=new Array(this._nodes.length,0),n=0;for(let r=0;r<this._nodes.length;r++)e[r]=n,this._nodes[r].executeNode?(n!==r&&(this._nodes[n]=this._nodes[r]),n++):this._nodes[r].outputs.forEach(i=>{this._allData[i]._from=-2});this._nodes.splice(n,this._nodes.length-n);for(let r=0;r<this._allData.length;r++){let i=this._allData[r];i._from!==void 0&&i._from!==-1&&i._from!==-2&&(i._from=e[i._from]);for(let o=0;o<i._to.length;o++)if(i._to[o]>=0)i._to[o]=e[i._to[o]];else throw new Error("Trying to update a removed node")}t=0;for(let r=0;r<this._allData.length;r++){if(this._allData[r].from===-2&&this._allOutputIndices.indexOf(r+t)===-1){t++,this._allData.splice(r,1),r--;continue}if(t>0){let i=-1;this._allData[r].from!==void 0&&this._allData[r].from!==-1?(i=this._nodes[this._allData[r].from].outputs.indexOf(r+t),i!==-1&&(this._nodes[this._allData[r].from].outputs[i]=r)):(i=this._allInputIndices.indexOf(r+t),i!==-1&&(this._allInputIndices[i]=r)),this._allData[r].to.forEach(o=>{i=this._nodes[o].inputs.indexOf(r+t),i!==-1&&(this._nodes[o].inputs[i]=r)}),this._allData[r].to.length===0&&(i=this._allOutputIndices.indexOf(r+t),i!==-1&&(this._allOutputIndices[i]=r))}}}deleteNode(t){let e=this._nodes[t];if(e.outputs.length>1){for(let l=1;l<e.outputs.length;l++)if(this._allData[e.outputs[l]].to.length>0)throw new Error("Node deletion with more than one output connected to other nodes is not supported. ")}e.executeNode=!1;let n=e.inputs[0],r=e.outputs[0],i=this._allData[r].to;for(let l=0;l<e.inputs.length;l++){let a=this._allData[e.inputs[l]].to.indexOf(t);if(a===-1)throw new Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[e.inputs[l]].to.splice(a,1)}this._allData[r]._to=[];let o=this._allOutputIndices.indexOf(r);if(o!==-1&&(this._allOutputIndices[o]=n),i&&i.length>0)for(let l of i){let a=this._nodes[l].inputs.indexOf(r);if(a===-1)throw new Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[l].inputs[a]=n,this._allData[n].to.push(l)}}removeAllDropoutNodes(){let t=0;for(let e of this._nodes){if(e.opType==="Dropout"){if(e.inputs.length!==1)throw new Error("Dropout nodes should only contain one input. ");if(e.outputs.length!==1&&e.outputs.length!==2)throw new Error("Dropout nodes should contain either 1 or 2 output(s)");if(e.outputs.length===2&&this._allData[e.outputs[1]]._to.length!==0)throw new Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(t)}t++}}removeAllIdentityNodes(){let t=0;for(let e of this._nodes)e.opType==="Identity"&&this.deleteNode(t),t++}isActivation(t){switch(t.opType){case"Relu":case"Sigmoid":case"Clip":return!0;default:return!1}}fuseConvActivationNodes(){for(let t of this._nodes)if(t.opType==="Conv"){let e=this._allData[t.outputs[0]]._to;if(e.length===1&&this.isActivation(this._nodes[e[0]])){let n=this._nodes[e[0]];if(n.opType==="Clip")if(n.inputs.length===1)try{t.attributes.set("activation_params","floats",[n.attributes.getFloat("min"),n.attributes.getFloat("max")])}catch{t.attributes.set("activation_params","floats",[Qc,Jc])}else if(n.inputs.length>=3&&this._allData[n.inputs[1]].tensor!==void 0&&this._allData[n.inputs[2]].tensor!==void 0)t.attributes.set("activation_params","floats",[this._allData[n.inputs[1]].tensor.floatData[0],this._allData[n.inputs[2]].tensor.floatData[0]]);else continue;t.attributes.set("activation","string",n.opType),this.deleteNode(e[0])}}}}}),qA,YA,bR,z8=P(()=>{"use strict";iw(),G8(),up(),qA=Ya(nu()),Oe(),YA=Ne.experimental.fbs,bR=class{constructor(){}load(t,e,n){let r;if(!n)try{this.loadFromOnnxFormat(t,e);return}catch(i){if(n!==void 0)throw i;r=i}try{this.loadFromOrtFormat(t,e)}catch(i){throw n!==void 0?i:new Error(`Failed to load model as ONNX format: ${r}
as ORT format: ${i}`)}}loadFromOnnxFormat(t,e){let n=qA.onnx.ModelProto.decode(t);if(Dr.longToNumber(n.irVersion)<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=n.opsetImport.map(r=>({domain:r.domain,version:Dr.longToNumber(r.version)})),this._graph=K0.from(n.graph,e)}loadFromOrtFormat(t,e){let n=new D.ByteBuffer(t),r=YA.InferenceSession.getRootAsInferenceSession(n).model();if(Dr.longToNumber(r.irVersion())<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=[];for(let i=0;i<r.opsetImportLength();i++){let o=r.opsetImport(i);this._opsets.push({domain:o?.domain(),version:Dr.longToNumber(o.version())})}this._graph=K0.from(r.graph(),e)}get graph(){return this._graph}get opsets(){return this._opsets}}}),wR,W8=P(()=>{"use strict";$8(),U8(),dr(),z8(),wR=class{constructor(t={}){this._initialized=!1,this.backendHint=t.backendHint,this.profiler=MM.create(t.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]}}get inputNames(){return this._model.graph.getInputNames()}get outputNames(){return this._model.graph.getOutputNames()}startProfiling(){this.profiler.start()}endProfiling(){this.profiler.stop()}loadModel(t,e,n){return R(this,null,function*(){yield this.profiler.event("session","Session.loadModel",()=>R(this,null,function*(){let r=yield mR(this.backendHint);if(this.sessionHandler=r.createSessionHandler(this.context),this._model=new bR,typeof t=="string"){let i=t.endsWith(".ort");{let o=yield(yield fetch(t)).arrayBuffer();this.initialize(new Uint8Array(o),i)}}else if(ArrayBuffer.isView(t))this.initialize(t);else{let i=new Uint8Array(t,e||0,n||t.byteLength);this.initialize(i)}}))})}initialize(t,e){if(this._initialized)throw new Error("already initialized");this.profiler.event("session","Session.initialize",()=>{let n=this.sessionHandler.transformGraph?this.sessionHandler:void 0;this._model.load(t,n,e),this.sessionHandler.onGraphInitialized&&this.sessionHandler.onGraphInitialized(this._model.graph),this.initializeOps(this._model.graph),this._executionPlan=new vR(this._model.graph,this._ops,this.profiler)}),this._initialized=!0}run(t){return R(this,null,function*(){if(!this._initialized)throw new Error("session not initialized yet");return this.profiler.event("session","Session.run",()=>R(this,null,function*(){let e=this.normalizeAndValidateInputs(t),n=yield this._executionPlan.execute(this.sessionHandler,e);return this.createOutput(n)}))})}normalizeAndValidateInputs(t){let e=this._model.graph.getInputNames();if(Array.isArray(t)){if(t.length!==e.length)throw new Error(`incorrect input array length: expected ${e.length} but got ${t.length}`)}else{if(t.size!==e.length)throw new Error(`incorrect input map size: expected ${e.length} but got ${t.size}`);let n=new Array(t.size),r=0;for(let i=0;i<e.length;++i){let o=t.get(e[i]);if(!o)throw new Error(`missing input tensor for: '${name}'`);n[r++]=o}t=n}if(!this.context.graphInputTypes||this.context.graphInputTypes.length===0||!this.context.graphInputDims||this.context.graphInputDims.length===0){let n=this._model.graph.getInputIndices(),r=this._model.graph.getValues(),i=new Array(n.length);for(let o=0;o<n.length;++o){let l=r[n[o]];i[o]=l.type.shape.dims,this.context.graphInputTypes.push(l.type.tensorType),this.context.graphInputDims.push(t[o].dims)}this.validateInputTensorDims(i,t,!0)}else this.validateInputTensorDims(this.context.graphInputDims,t,!1);return this.validateInputTensorTypes(this.context.graphInputTypes,t),t}validateInputTensorTypes(t,e){for(let n=0;n<e.length;n++){let r=t[n],i=e[n].type;if(r!==i)throw new Error(`input tensor[${n}] check failed: expected type '${r}' but got ${i}`)}}validateInputTensorDims(t,e,n){for(let r=0;r<e.length;r++){let i=t[r],o=e[r].dims;if(!this.compareTensorDims(i,o,n))throw new Error(`input tensor[${r}] check failed: expected shape '[${i.join(",")}]' but got [${o.join(",")}]`)}}compareTensorDims(t,e,n){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r]&&(!n||t[r]!==0))return!1;return!0}createOutput(t){let e=this._model.graph.getOutputNames();if(t.length!==e.length)throw new Error("expected number of outputs do not match number of generated outputs");let n=new Map;for(let r=0;r<e.length;++r)n.set(e[r],t[r]);return n}initializeOps(t){let e=t.getNodes();this._ops=new Array(e.length);for(let n=0;n<e.length;n++)this._ops[n]=this.sessionHandler.resolve(e[n],this._model.opsets,t)}}}),_R,q8=P(()=>{"use strict";Or(),Qa(),_R=class{constructor(t){this.session=t,this.inputNames=this.session.inputNames,this.outputNames=this.session.outputNames}dispose(){return R(this,null,function*(){})}run(t,e,n){return R(this,null,function*(){let r=new Map;for(let l in t)if(Object.hasOwnProperty.call(t,l)){let a=t[l];r.set(l,new An(a.dims,a.type,void 0,void 0,a.data))}let i=yield this.session.run(r),o={};return i.forEach((l,a)=>{o[a]=new Et(l.type,l.data,l.dims)}),o})}startProfiling(){this.session.startProfiling()}endProfiling(){this.session.endProfiling()}}}),TR={};tu(TR,{onnxjsBackend:()=>xR});var XA,xR,Y8=P(()=>{"use strict";W8(),q8(),XA=class{init(){return R(this,null,function*(){})}createInferenceSessionHandler(t,e){return R(this,null,function*(){let n=new wR(e);return typeof t=="string"?yield n.loadModel(t):yield n.loadModel(t),new _R(n)})}},xR=new XA}),hw=P(()=>{"use strict"}),ER={};tu(ER,{default:()=>CR});var a0,l0,CR,X8=P(()=>{"use strict";BR(),nl(),fp(),a0="ort-wasm-proxy-worker",l0=globalThis.self?.name===a0,l0&&(self.onmessage=t=>{let{type:e,in:n}=t.data;try{switch(e){case"init-wasm":fw(n.wasm).then(()=>{vw(n).then(()=>{postMessage({type:e})},r=>{postMessage({type:e,err:r})})},r=>{postMessage({type:e,err:r})});break;case"init-ep":{let{epName:r,env:i}=n;bw(i,r).then(()=>{postMessage({type:e})},o=>{postMessage({type:e,err:o})});break}case"copy-from":{let{buffer:r}=n,i=ap(r);postMessage({type:e,out:i});break}case"create":{let{model:r,options:i}=n;ww(r,i).then(o=>{postMessage({type:e,out:o})},o=>{postMessage({type:e,err:o})});break}case"release":_w(n),postMessage({type:e});break;case"run":{let{sessionId:r,inputIndices:i,inputs:o,outputIndices:l,options:a}=n;Tw(r,i,o,l,new Array(l.length).fill(null),a).then(c=>{c.some(s=>s[3]!=="cpu")?postMessage({type:e,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:e,out:c},Ew([...o,...c]))},c=>{postMessage({type:e,err:c})});break}case"end-profiling":xw(n),postMessage({type:e});break;default:}}catch(r){postMessage({type:e,err:r})}}),CR=l0?null:t=>new Worker(t??Wa,{type:"module",name:a0})}),SR={};tu(SR,{default:()=>DR});var c0,u0,DR,K8=P(()=>{"use strict";u0=(c0=import.meta.url,function(){return R(this,arguments,function*(t={}){function e(){return me.buffer!=ke.buffer&&Ke(),ke}function n(){return me.buffer!=ke.buffer&&Ke(),ee}function r(){return me.buffer!=ke.buffer&&Ke(),ct}function i(){return me.buffer!=ke.buffer&&Ke(),Fe}function o(){return me.buffer!=ke.buffer&&Ke(),Nt}var l,a,c=Object.assign({},t),s=new Promise((m,w)=>{l=m,a=w}),u=typeof window=="object",d=typeof importScripts=="function",h=d&&self.name=="em-pthread";c.mountExternalData=(m,w)=>{m.startsWith("./")&&(m=m.substring(2)),(c.Ua||(c.Ua=new Map)).set(m,w)},c.unmountExternalData=()=>{delete c.Ua};var f,p,g=globalThis.SharedArrayBuffer??new WebAssembly.Memory({initial:0,maximum:0,shared:!0}).buffer.constructor,y=Object.assign({},c),b="./this.program",v=(m,w)=>{throw w},_="";(u||d)&&(d?_=self.location.href:typeof document<"u"&&document.currentScript&&(_=document.currentScript.src),c0&&(_=c0),_=_.startsWith("blob:")?"":_.substr(0,_.replace(/[?#].*/,"").lastIndexOf("/")+1),d&&(p=m=>{var w=new XMLHttpRequest;return w.open("GET",m,!1),w.responseType="arraybuffer",w.send(null),new Uint8Array(w.response)}),f=(m,w,T)=>{var S=new XMLHttpRequest;S.open("GET",m,!0),S.responseType="arraybuffer",S.onload=()=>{S.status==200||S.status==0&&S.response?w(S.response):T()},S.onerror=T,S.send(null)});var I,k=console.log.bind(console),V=console.error.bind(console),G=k,j=V;if(Object.assign(c,y),y=null,h){let m=function(w){try{var T=w.data,S=T.cmd;if(S==="load"){let O=[];self.onmessage=F=>O.push(F),self.startWorker=()=>{postMessage({cmd:"loaded"});for(let F of O)m(F);self.onmessage=m};for(let F of T.handlers)c[F]&&!c[F].proxy||(c[F]=(...q)=>{postMessage({Za:"callHandler",kb:F,args:q})},F=="print"&&(G=c[F]),F=="printErr"&&(j=c[F]));me=T.wasmMemory,Ke(),Z(T.wasmModule)}else if(S==="run"){Sp(T.pthread_ptr,0,0,1,0,0),_p(T.pthread_ptr),JR(),Pw(),Be||=!0;try{e2(T.start_routine,T.arg)}catch(O){if(O!="unwind")throw O}}else S==="cancel"?gs()&&hu(-1):T.target!=="setimmediate"&&(S==="checkMailbox"?Be&&cu():S&&(j(`worker: received unknown command ${S}`),j(T)))}catch(O){throw y_(),O}};var ge=m,Z,Be=!1;j=function(...w){w=w.join(" "),console.error(w)},self.alert=function(...w){postMessage({Za:"alert",text:w.join(" "),nb:gs()})},c.instantiateWasm=(w,T)=>new Promise(S=>{Z=O=>{O=new WebAssembly.Instance(O,Sw()),T(O),S()}}),self.onunhandledrejection=w=>{throw w.reason||w},self.onmessage=m}c.wasmBinary&&(I=c.wasmBinary);var me,we,Se,ke,ee,ct,Fe,ze,Nt,We=!1;function Ke(){var m=me.buffer;c.HEAP8=ke=new Int8Array(m),c.HEAP16=new Int16Array(m),c.HEAPU8=ee=new Uint8Array(m),c.HEAPU16=new Uint16Array(m),c.HEAP32=ct=new Int32Array(m),c.HEAPU32=Fe=new Uint32Array(m),c.HEAPF32=new Float32Array(m),c.HEAPF64=Nt=new Float64Array(m),c.HEAP64=ze=new BigInt64Array(m),c.HEAPU64=new BigUint64Array(m)}if(!h){if(!((me=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0})).buffer instanceof g))throw j("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),Error("bad memory");Ke()}var dn=[],Ct=[],Ar=[],Ht=0,St=null,Gt=null;function Xn(){if(--Ht==0&&(St!==null&&(clearInterval(St),St=null),Gt)){var m=Gt;Gt=null,m()}}function Ae(m){throw j(m="Aborted("+m+")"),We=!0,Se=1,m=new WebAssembly.RuntimeError(m+". Build with -sASSERTIONS for more info."),a(m),m}var gt,Mr=m=>m.startsWith("data:application/octet-stream;base64,"),rl=m=>m.startsWith("file://");function su(m){if(m==gt&&I)return new Uint8Array(I);if(p)return p(m);throw"both async and sync fetching of the wasm failed"}function Cw(m,w,T){return function(S){if(!I&&(u||d)){if(typeof fetch=="function"&&!rl(S))return fetch(S,{credentials:"same-origin"}).then(O=>{if(!O.ok)throw`failed to load wasm binary file at '${S}'`;return O.arrayBuffer()}).catch(()=>su(S));if(f)return new Promise((O,F)=>{f(S,q=>O(new Uint8Array(q)),F)})}return Promise.resolve().then(()=>su(S))}(m).then(S=>WebAssembly.instantiate(S,w)).then(T,S=>{j(`failed to asynchronously prepare wasm: ${S}`),Ae(S)})}function Sw(){return{a:{j:QR,b:n2,E:Lw,g:Vw,V:$w,A:Gw,C:zw,W:Ww,T:qw,L:Yw,S:Xw,o:Kw,B:Zw,y:Qw,U:Jw,z:e_,_:r2,Z:i2,P:o2,w:s2,F:a2,k:l2,O:_p,Y:c2,I:u2,J:d2,K:h2,G:r_,H:i_,v:f2,q:p2,l:g2,p:m2,e:y2,X:v2,x:b2,d:o_,f:w2,i:_2,u:T2,t:x2,s:E2,Q:l_,R:c_,D:wp,h:u_,n:d_,M:h_,m:f_,a:me,r:bp,N:m_,c:D2}}}var Dw={837620:(m,w,T,S,O)=>{if(c===void 0||!c.Ua)return 1;if((m=ol(m>>>0)).startsWith("./")&&(m=m.substring(2)),!(m=c.Ua.get(m)))return 2;if(S>>>=0,(w>>>=0)+(T>>>=0)>m.byteLength)return 3;try{let F=m.subarray(w,w+T);switch(O){case 0:n().set(F,S>>>0);break;case 1:c.mb(S,F);break;default:return 4}return 0}catch{return 4}},838303:()=>typeof wasmOffsetConverter<"u"};function QR(){return typeof wasmOffsetConverter<"u"}function yp(m){this.name="ExitStatus",this.message=`Program terminated with exit(${m})`,this.status=m}var vp=m=>{m.terminate(),m.onmessage=()=>{}},Iw=m=>{ai.length==0&&(Rw(),Nw(ai[0]));var w=ai.pop();if(!w)return 6;eo.push(w),hr[m.Ra]=w,w.Ra=m.Ra;var T={cmd:"run",start_routine:m.cb,arg:m.ab,pthread_ptr:m.Ra};return w.postMessage(T,m.ib),0},il=0,qe=(m,w,...T)=>{for(var S=2*T.length,O=Op(),F=Ip(8*S),q=F>>>3,Ue=0;Ue<T.length;Ue++){var Rt=T[Ue];typeof Rt=="bigint"?(ze[q+2*Ue]=1n,ze[q+2*Ue+1]=Rt):(ze[q+2*Ue]=0n,o()[q+2*Ue+1>>>0]=Rt)}return m=v_(m,0,S,F,w),fu(O),m};function bp(m){if(h)return qe(0,1,m);if(Se=m,!(0<il)){for(var w of eo)vp(w);for(w of ai)vp(w);ai=[],eo=[],hr=[],We=!0}v(m,new yp(m))}function Ow(m){if(h)return qe(1,0,m);wp(m)}var wp=m=>{if(Se=m,h)throw Ow(m),"unwind";bp(m)},ai=[],eo=[],Aw=[],hr={},Mw=m=>{var w=m.Ra;delete hr[w],ai.push(m),eo.splice(eo.indexOf(m),1),m.Ra=0,Dp(w)};function Pw(){Aw.forEach(m=>m())}var Nw=m=>new Promise(w=>{m.onmessage=O=>{var F=(O=O.data).cmd;if(O.targetThread&&O.targetThread!=gs()){var q=hr[O.targetThread];q?q.postMessage(O,O.transferList):j(`Internal error! Worker sent a message "${F}" to target pthread ${O.targetThread}, but that thread no longer exists!`)}else F==="checkMailbox"?cu():F==="spawnThread"?Iw(O):F==="cleanupThread"?Mw(hr[O.thread]):F==="killThread"?(O=O.thread,F=hr[O],delete hr[O],vp(F),Dp(O),eo.splice(eo.indexOf(F),1),F.Ra=0):F==="cancelThread"?hr[O.thread].postMessage({cmd:"cancel"}):F==="loaded"?(m.loaded=!0,w(m)):F==="alert"?alert(`Thread ${O.threadId}: ${O.text}`):O.target==="setimmediate"?m.postMessage(O):F==="callHandler"?c[O.handler](...O.args):F&&j(`worker sent an unknown command ${F}`)},m.onerror=O=>{throw j(`worker sent an error! ${O.filename}:${O.lineno}: ${O.message}`),O};var T,S=[];for(T of[])c.hasOwnProperty(T)&&S.push(T);m.postMessage({cmd:"load",handlers:S,wasmMemory:me,wasmModule:we})});function Rw(){var m=new Worker(new URL(import.meta.url),{type:"module",workerData:"em-pthread",name:"em-pthread"});ai.push(m)}var kw,au=m=>{for(;0<m.length;)m.shift()(c)},JR=()=>{var m=gs(),w=i()[m+52>>>2>>>0];m=i()[m+56>>>2>>>0],w_(w,w-m),fu(w)},lu=[],e2=(m,w)=>{il=0;var T=lu[m];T||(m>=lu.length&&(lu.length=m+1),lu[m]=T=kw.get(m)),m=T(w),0<il?Se=m:hu(m)};class t2{constructor(w){this.Xa=w-24}}function n2(m,w,T){var S=new t2(m>>>=0);throw w>>>=0,T>>>=0,i()[S.Xa+16>>>2>>>0]=0,i()[S.Xa+4>>>2>>>0]=w,i()[S.Xa+8>>>2>>>0]=T,m}function Fw(m,w,T,S){return h?qe(2,1,m,w,T,S):Lw(m,w,T,S)}function Lw(m,w,T,S){if(m>>>=0,w>>>=0,T>>>=0,S>>>=0,g===void 0)return j("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var O=[];return h&&O.length===0?Fw(m,w,T,S):(m={cb:T,Ra:m,ab:S,ib:O},h?(m.Za="spawnThread",postMessage(m,O),0):Iw(m))}var Bw=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,jw=(m,w,T)=>{var S=(w>>>=0)+T;for(T=w;m[T]&&!(T>=S);)++T;if(16<T-w&&m.buffer&&Bw)return Bw.decode(m.buffer instanceof g?m.slice(w,T):m.subarray(w,T));for(S="";w<T;){var O=m[w++];if(128&O){var F=63&m[w++];if((224&O)==192)S+=String.fromCharCode((31&O)<<6|F);else{var q=63&m[w++];65536>(O=(240&O)==224?(15&O)<<12|F<<6|q:(7&O)<<18|F<<12|q<<6|63&m[w++])?S+=String.fromCharCode(O):(O-=65536,S+=String.fromCharCode(55296|O>>10,56320|1023&O))}}else S+=String.fromCharCode(O)}return S},ol=(m,w)=>(m>>>=0)?jw(n(),m,w):"";function Vw(m,w,T){return h?qe(3,1,m,w,T):0}function $w(m,w){if(h)return qe(4,1,m,w)}var Uw=m=>{for(var w=0,T=0;T<m.length;++T){var S=m.charCodeAt(T);127>=S?w++:2047>=S?w+=2:55296<=S&&57343>=S?(w+=4,++T):w+=3}return w},Hw=(m,w,T,S)=>{if(!(0<S))return 0;var O=T>>>=0;S=T+S-1;for(var F=0;F<m.length;++F){var q=m.charCodeAt(F);if(55296<=q&&57343>=q&&(q=65536+((1023&q)<<10)|1023&m.charCodeAt(++F)),127>=q){if(T>=S)break;w[T++>>>0]=q}else{if(2047>=q){if(T+1>=S)break;w[T++>>>0]=192|q>>6}else{if(65535>=q){if(T+2>=S)break;w[T++>>>0]=224|q>>12}else{if(T+3>=S)break;w[T++>>>0]=240|q>>18,w[T++>>>0]=128|q>>12&63}w[T++>>>0]=128|q>>6&63}w[T++>>>0]=128|63&q}}return w[T>>>0]=0,T-O},sl=(m,w,T)=>Hw(m,n(),w,T);function Gw(m,w){if(h)return qe(5,1,m,w)}function zw(m,w,T){if(h)return qe(6,1,m,w,T)}function Ww(m,w,T){return h?qe(7,1,m,w,T):0}function qw(m,w){if(h)return qe(8,1,m,w)}function Yw(m,w,T){if(h)return qe(9,1,m,w,T)}function Xw(m,w,T,S){if(h)return qe(10,1,m,w,T,S)}function Kw(m,w,T,S){if(h)return qe(11,1,m,w,T,S)}function Zw(m,w,T,S){if(h)return qe(12,1,m,w,T,S)}function Qw(m){if(h)return qe(13,1,m)}function Jw(m,w){if(h)return qe(14,1,m,w)}function e_(m,w,T){if(h)return qe(15,1,m,w,T)}var r2=()=>{Ae("")},i2=()=>1;function o2(m){Sp(m>>>0,!d,1,!u,131072,!1),Pw()}function _p(m){m>>>=0,typeof Atomics.jb=="function"&&(Atomics.jb(r(),m>>>2,m).value.then(cu),m+=128,Atomics.store(r(),m>>>2,1))}var cu=()=>{var m=gs();if(m&&(_p(m),m=b_,!We))try{if(m(),!(0<il))try{h?hu(Se):wp(Se)}catch(w){w instanceof yp||w=="unwind"||v(1,w)}}catch(w){w instanceof yp||w=="unwind"||v(1,w)}};function s2(m,w){(m>>>=0)==w>>>0?setTimeout(cu):h?postMessage({targetThread:m,cmd:"checkMailbox"}):(m=hr[m])&&m.postMessage({cmd:"checkMailbox"})}var Tp=[];function a2(m,w,T,S,O){for(w>>>=0,S/=2,Tp.length=S,T=O>>>0>>>3,O=0;O<S;O++)Tp[O]=ze[T+2*O]?ze[T+2*O+1]:o()[T+2*O+1>>>0];return(w?Dw[w]:I2[m])(...Tp)}function l2(m){m>>>=0,h?postMessage({cmd:"cleanupThread",thread:m}):Mw(hr[m])}function c2(m){}function u2(m,w){m=-9007199254740992>m||9007199254740992<m?NaN:Number(m),w>>>=0,m=new Date(1e3*m),r()[w>>>2>>>0]=m.getUTCSeconds(),r()[w+4>>>2>>>0]=m.getUTCMinutes(),r()[w+8>>>2>>>0]=m.getUTCHours(),r()[w+12>>>2>>>0]=m.getUTCDate(),r()[w+16>>>2>>>0]=m.getUTCMonth(),r()[w+20>>>2>>>0]=m.getUTCFullYear()-1900,r()[w+24>>>2>>>0]=m.getUTCDay(),m=(m.getTime()-Date.UTC(m.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,r()[w+28>>>2>>>0]=m}var fs=m=>m%4==0&&(m%100!=0||m%400==0),t_=[0,31,60,91,121,152,182,213,244,274,305,335],n_=[0,31,59,90,120,151,181,212,243,273,304,334];function d2(m,w){m=-9007199254740992>m||9007199254740992<m?NaN:Number(m),w>>>=0,m=new Date(1e3*m),r()[w>>>2>>>0]=m.getSeconds(),r()[w+4>>>2>>>0]=m.getMinutes(),r()[w+8>>>2>>>0]=m.getHours(),r()[w+12>>>2>>>0]=m.getDate(),r()[w+16>>>2>>>0]=m.getMonth(),r()[w+20>>>2>>>0]=m.getFullYear()-1900,r()[w+24>>>2>>>0]=m.getDay();var T=(fs(m.getFullYear())?t_:n_)[m.getMonth()]+m.getDate()-1|0;r()[w+28>>>2>>>0]=T,r()[w+36>>>2>>>0]=-60*m.getTimezoneOffset(),T=new Date(m.getFullYear(),6,1).getTimezoneOffset();var S=new Date(m.getFullYear(),0,1).getTimezoneOffset();m=0|(T!=S&&m.getTimezoneOffset()==Math.min(S,T)),r()[w+32>>>2>>>0]=m}function h2(m){m>>>=0;var w=new Date(r()[m+20>>>2>>>0]+1900,r()[m+16>>>2>>>0],r()[m+12>>>2>>>0],r()[m+8>>>2>>>0],r()[m+4>>>2>>>0],r()[m>>>2>>>0],0),T=r()[m+32>>>2>>>0],S=w.getTimezoneOffset(),O=new Date(w.getFullYear(),6,1).getTimezoneOffset(),F=new Date(w.getFullYear(),0,1).getTimezoneOffset(),q=Math.min(F,O);return 0>T?r()[m+32>>>2>>>0]=+(O!=F&&q==S):0<T!=(q==S)&&(O=Math.max(F,O),w.setTime(w.getTime()+6e4*((0<T?q:O)-S))),r()[m+24>>>2>>>0]=w.getDay(),T=(fs(w.getFullYear())?t_:n_)[w.getMonth()]+w.getDate()-1|0,r()[m+28>>>2>>>0]=T,r()[m>>>2>>>0]=w.getSeconds(),r()[m+4>>>2>>>0]=w.getMinutes(),r()[m+8>>>2>>>0]=w.getHours(),r()[m+12>>>2>>>0]=w.getDate(),r()[m+16>>>2>>>0]=w.getMonth(),r()[m+20>>>2>>>0]=w.getYear(),m=w.getTime(),BigInt(isNaN(m)?-1:m/1e3)}function r_(m,w,T,S,O,F,q){return h?qe(16,1,m,w,T,S,O,F,q):-52}function i_(m,w,T,S,O,F){if(h)return qe(17,1,m,w,T,S,O,F)}function f2(m,w,T,S){m>>>=0,w>>>=0,T>>>=0,S>>>=0;var O=new Date().getFullYear(),F=new Date(O,0,1),q=new Date(O,6,1);O=F.getTimezoneOffset();var Ue=q.getTimezoneOffset(),Rt=Math.max(O,Ue);i()[m>>>2>>>0]=60*Rt,r()[w>>>2>>>0]=+(O!=Ue),F=(m=zt=>zt.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1])(F),q=m(q),Ue<O?(sl(F,T,17),sl(q,S,17)):(sl(F,S,17),sl(q,T,17))}var xp=[];function p2(m,w,T){m>>>=0,w>>>=0,T>>>=0,xp.length=0;for(var S;S=n()[w++>>>0];){var O=S!=105;T+=(O&=S!=112)&&T%8?4:0,xp.push(S==112?i()[T>>>2>>>0]:S==106?ze[T>>>3]:S==105?r()[T>>>2>>>0]:o()[T>>>3>>>0]),T+=O?8:4}return Dw[m](...xp)}var g2=()=>{},m2=()=>Date.now();function y2(m,w){return j(ol(m>>>0,w>>>0))}var o_,v2=()=>{throw il+=1,"unwind"};function b2(){return 4294901760}o_=()=>performance.timeOrigin+performance.now();var w2=()=>navigator.hardwareConcurrency;function _2(){return Ae("Cannot use emscripten_pc_get_function without -sUSE_OFFSET_CONVERTER"),0}function T2(m){m>>>=0;var w=n().length;if(m<=w||4294901760<m)return!1;for(var T=1;4>=T;T*=2){var S=w*(1+.2/T);S=Math.min(S,m+100663296);var O=Math;S=Math.max(m,S);e:{O=(O.min.call(O,4294901760,S+(65536-S%65536)%65536)-me.buffer.byteLength+65535)/65536;try{me.grow(O),Ke();var F=1;break e}catch{}F=void 0}if(F)return!0}return!1}var uu=()=>(Ae("Cannot use convertFrameToPC (needed by __builtin_return_address) without -sUSE_OFFSET_CONVERTER"),0),ps={},s_=m=>{m.forEach(w=>{var T=uu();T&&(ps[T]=w)})};function x2(){var m=Error().stack.toString().split(`
`);return m[0]=="Error"&&m.shift(),s_(m),ps.$a=uu(),ps.bb=m,ps.$a}function E2(m,w,T){if(m>>>=0,w>>>=0,ps.$a==m)var S=ps.bb;else(S=Error().stack.toString().split(`
`))[0]=="Error"&&S.shift(),s_(S);for(var O=3;S[O]&&uu()!=m;)++O;for(m=0;m<T&&S[m+O];++m)r()[w+4*m>>>2>>>0]=uu();return m}var Ep,Cp={},a_=()=>{if(!Ep){var m,w={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:b||"./this.program"};for(m in Cp)Cp[m]===void 0?delete w[m]:w[m]=Cp[m];var T=[];for(m in w)T.push(`${m}=${w[m]}`);Ep=T}return Ep};function l_(m,w){if(h)return qe(18,1,m,w);m>>>=0,w>>>=0;var T=0;return a_().forEach((S,O)=>{var F=w+T;for(O=i()[m+4*O>>>2>>>0]=F,F=0;F<S.length;++F)e()[O++>>>0]=S.charCodeAt(F);e()[O>>>0]=0,T+=S.length+1}),0}function c_(m,w){if(h)return qe(19,1,m,w);m>>>=0,w>>>=0;var T=a_();i()[m>>>2>>>0]=T.length;var S=0;return T.forEach(O=>S+=O.length+1),i()[w>>>2>>>0]=S,0}function u_(m){return h?qe(20,1,m):52}function d_(m,w,T,S){return h?qe(21,1,m,w,T,S):52}function h_(m,w,T,S){return h?qe(22,1,m,w,T,S):70}var C2=[null,[],[]];function f_(m,w,T,S){if(h)return qe(23,1,m,w,T,S);w>>>=0,T>>>=0,S>>>=0;for(var O=0,F=0;F<T;F++){var q=i()[w>>>2>>>0],Ue=i()[w+4>>>2>>>0];w+=8;for(var Rt=0;Rt<Ue;Rt++){var zt=n()[q+Rt>>>0],nn=C2[m];zt===0||zt===10?((m===1?G:j)(jw(nn,0)),nn.length=0):nn.push(zt)}O+=Ue}return i()[S>>>2>>>0]=O,0}var p_=[31,29,31,30,31,30,31,31,30,31,30,31],g_=[31,28,31,30,31,30,31,31,30,31,30,31],S2=(m,w)=>{e().set(m,w>>>0)};function m_(m,w,T,S){function O(M,Ie,at){for(M=typeof M=="number"?M.toString():M||"";M.length<Ie;)M=at[0]+M;return M}function F(M,Ie){return O(M,Ie,"0")}function q(M,Ie){function at(E_){return 0>E_?-1:0<E_?1:0}var to;return(to=at(M.getFullYear()-Ie.getFullYear()))===0&&(to=at(M.getMonth()-Ie.getMonth()))===0&&(to=at(M.getDate()-Ie.getDate())),to}function Ue(M){switch(M.getDay()){case 0:return new Date(M.getFullYear()-1,11,29);case 1:return M;case 2:return new Date(M.getFullYear(),0,3);case 3:return new Date(M.getFullYear(),0,2);case 4:return new Date(M.getFullYear(),0,1);case 5:return new Date(M.getFullYear()-1,11,31);case 6:return new Date(M.getFullYear()-1,11,30)}}function Rt(M){var Ie=M.Sa;for(M=new Date(new Date(M.Ta+1900,0,1).getTime());0<Ie;){var at=M.getMonth(),to=(fs(M.getFullYear())?p_:g_)[at];if(!(Ie>to-M.getDate())){M.setDate(M.getDate()+Ie);break}Ie-=to-M.getDate()+1,M.setDate(1),11>at?M.setMonth(at+1):(M.setMonth(0),M.setFullYear(M.getFullYear()+1))}return at=new Date(M.getFullYear()+1,0,4),Ie=Ue(new Date(M.getFullYear(),0,4)),at=Ue(at),0>=q(Ie,M)?0>=q(at,M)?M.getFullYear()+1:M.getFullYear():M.getFullYear()-1}m>>>=0,w>>>=0,T>>>=0,S>>>=0;var zt=i()[S+40>>>2>>>0];for(var nn in S={gb:r()[S>>>2>>>0],fb:r()[S+4>>>2>>>0],Va:r()[S+8>>>2>>>0],Ya:r()[S+12>>>2>>>0],Wa:r()[S+16>>>2>>>0],Ta:r()[S+20>>>2>>>0],Qa:r()[S+24>>>2>>>0],Sa:r()[S+28>>>2>>>0],ob:r()[S+32>>>2>>>0],eb:r()[S+36>>>2>>>0],hb:zt?ol(zt):""},T=ol(T),zt={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})T=T.replace(new RegExp(nn,"g"),zt[nn]);var T_="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),x_="January February March April May June July August September October November December".split(" ");for(nn in zt={"%a":M=>T_[M.Qa].substring(0,3),"%A":M=>T_[M.Qa],"%b":M=>x_[M.Wa].substring(0,3),"%B":M=>x_[M.Wa],"%C":M=>F((M.Ta+1900)/100|0,2),"%d":M=>F(M.Ya,2),"%e":M=>O(M.Ya,2," "),"%g":M=>Rt(M).toString().substring(2),"%G":Rt,"%H":M=>F(M.Va,2),"%I":M=>((M=M.Va)==0?M=12:12<M&&(M-=12),F(M,2)),"%j":M=>{for(var Ie=0,at=0;at<=M.Wa-1;Ie+=(fs(M.Ta+1900)?p_:g_)[at++]);return F(M.Ya+Ie,3)},"%m":M=>F(M.Wa+1,2),"%M":M=>F(M.fb,2),"%n":()=>`
`,"%p":M=>0<=M.Va&&12>M.Va?"AM":"PM","%S":M=>F(M.gb,2),"%t":()=>"	","%u":M=>M.Qa||7,"%U":M=>F(Math.floor((M.Sa+7-M.Qa)/7),2),"%V":M=>{var Ie=Math.floor((M.Sa+7-(M.Qa+6)%7)/7);if(2>=(M.Qa+371-M.Sa-2)%7&&Ie++,Ie)Ie==53&&((at=(M.Qa+371-M.Sa)%7)==4||at==3&&fs(M.Ta)||(Ie=1));else{Ie=52;var at=(M.Qa+7-M.Sa-1)%7;(at==4||at==5&&fs(M.Ta%400-1))&&Ie++}return F(Ie,2)},"%w":M=>M.Qa,"%W":M=>F(Math.floor((M.Sa+7-(M.Qa+6)%7)/7),2),"%y":M=>(M.Ta+1900).toString().substring(2),"%Y":M=>M.Ta+1900,"%z":M=>{var Ie=0<=(M=M.eb);return M=Math.abs(M)/60,(Ie?"+":"-")+("0000"+(M/60*100+M%60)).slice(-4)},"%Z":M=>M.hb,"%%":()=>"%"},T=T.replace(/%%/g,"\0\0"),zt)T.includes(nn)&&(T=T.replace(new RegExp(nn,"g"),zt[nn](S)));return nn=function(M){var Ie=Array(Uw(M)+1);return Hw(M,Ie,0,Ie.length),Ie}(T=T.replace(/\0\0/g,"%")),nn.length>w?0:(S2(nn,m),nn.length-1)}function D2(m,w,T,S){return m_(m>>>0,w>>>0,T>>>0,S>>>0)}h||function(){for(var m=c.numThreads-1;m--;)Rw();dn.unshift(()=>{Ht++,function(w){h?w():Promise.all(ai.map(Nw)).then(w)}(()=>Xn())})}();var I2=[bp,Ow,Fw,Vw,$w,Gw,zw,Ww,qw,Yw,Xw,Kw,Zw,Qw,Jw,e_,r_,i_,l_,c_,u_,d_,h_,f_],Q=function(){function m(T,S){return Q=T.exports,Q=function(){var O=Q,F=Ue=>()=>Ue()>>>0,q=Ue=>Rt=>Ue(Rt)>>>0;return(O=Object.assign({},O)).Ba=F(O.Ba),O.Ca=q(O.Ca),O.emscripten_main_runtime_thread_id=F(O.emscripten_main_runtime_thread_id),O.Oa=q(O.Oa),O.Pa=F(O.Pa),O}(),Aw.push(Q.Ea),kw=Q.Fa,Ct.unshift(Q.$),we=S,Xn(),Q}var w=Sw();if(Ht++,c.instantiateWasm)try{return c.instantiateWasm(w,m)}catch(T){j(`Module.instantiateWasm callback failed with error: ${T}`),a(T)}return gt||=c.locateFile?Mr("ort-wasm-simd-threaded.wasm")?"ort-wasm-simd-threaded.wasm":c.locateFile?c.locateFile("ort-wasm-simd-threaded.wasm",_):_+"ort-wasm-simd-threaded.wasm":new URL("ort-wasm-simd-threaded.wasm",import.meta.url).href,function(T,S){var O=gt;return I||typeof WebAssembly.instantiateStreaming!="function"||Mr(O)||rl(O)||typeof fetch!="function"?Cw(O,T,S):fetch(O,{credentials:"same-origin"}).then(F=>WebAssembly.instantiateStreaming(F,T).then(S,function(q){return j(`wasm streaming compile failed: ${q}`),j("falling back to ArrayBuffer instantiation"),Cw(O,T,S)}))}(w,function(T){m(T.instance,T.module)}).catch(a),{}}();c._OrtInit=(m,w)=>(c._OrtInit=Q.aa)(m,w),c._OrtGetLastError=(m,w)=>(c._OrtGetLastError=Q.ba)(m,w),c._OrtCreateSessionOptions=(m,w,T,S,O,F,q,Ue,Rt,zt)=>(c._OrtCreateSessionOptions=Q.ca)(m,w,T,S,O,F,q,Ue,Rt,zt),c._OrtAppendExecutionProvider=(m,w)=>(c._OrtAppendExecutionProvider=Q.da)(m,w),c._OrtAddFreeDimensionOverride=(m,w,T)=>(c._OrtAddFreeDimensionOverride=Q.ea)(m,w,T),c._OrtAddSessionConfigEntry=(m,w,T)=>(c._OrtAddSessionConfigEntry=Q.fa)(m,w,T),c._OrtReleaseSessionOptions=m=>(c._OrtReleaseSessionOptions=Q.ga)(m),c._OrtCreateSession=(m,w,T)=>(c._OrtCreateSession=Q.ha)(m,w,T),c._OrtReleaseSession=m=>(c._OrtReleaseSession=Q.ia)(m),c._OrtGetInputOutputCount=(m,w,T)=>(c._OrtGetInputOutputCount=Q.ja)(m,w,T),c._OrtGetInputName=(m,w)=>(c._OrtGetInputName=Q.ka)(m,w),c._OrtGetOutputName=(m,w)=>(c._OrtGetOutputName=Q.la)(m,w),c._OrtFree=m=>(c._OrtFree=Q.ma)(m),c._OrtCreateTensor=(m,w,T,S,O,F)=>(c._OrtCreateTensor=Q.na)(m,w,T,S,O,F),c._OrtGetTensorData=(m,w,T,S,O)=>(c._OrtGetTensorData=Q.oa)(m,w,T,S,O),c._OrtReleaseTensor=m=>(c._OrtReleaseTensor=Q.pa)(m),c._OrtCreateRunOptions=(m,w,T,S)=>(c._OrtCreateRunOptions=Q.qa)(m,w,T,S),c._OrtAddRunConfigEntry=(m,w,T)=>(c._OrtAddRunConfigEntry=Q.ra)(m,w,T),c._OrtReleaseRunOptions=m=>(c._OrtReleaseRunOptions=Q.sa)(m),c._OrtCreateBinding=m=>(c._OrtCreateBinding=Q.ta)(m),c._OrtBindInput=(m,w,T)=>(c._OrtBindInput=Q.ua)(m,w,T),c._OrtBindOutput=(m,w,T,S)=>(c._OrtBindOutput=Q.va)(m,w,T,S),c._OrtClearBoundOutputs=m=>(c._OrtClearBoundOutputs=Q.wa)(m),c._OrtReleaseBinding=m=>(c._OrtReleaseBinding=Q.xa)(m),c._OrtRunWithBinding=(m,w,T,S,O)=>(c._OrtRunWithBinding=Q.ya)(m,w,T,S,O),c._OrtRun=(m,w,T,S,O,F,q,Ue)=>(c._OrtRun=Q.za)(m,w,T,S,O,F,q,Ue),c._OrtEndProfiling=m=>(c._OrtEndProfiling=Q.Aa)(m);var gs=()=>(gs=Q.Ba)();c._malloc=m=>(c._malloc=Q.Ca)(m),c._free=m=>(c._free=Q.Da)(m);var du,Sp=(m,w,T,S,O,F)=>(Sp=Q.Ga)(m,w,T,S,O,F),y_=()=>(y_=Q.Ha)(),v_=(m,w,T,S,O)=>(v_=Q.Ia)(m,w,T,S,O),Dp=m=>(Dp=Q.Ja)(m),hu=m=>(hu=Q.Ka)(m),b_=()=>(b_=Q.La)(),w_=(m,w)=>(w_=Q.Ma)(m,w),fu=m=>(fu=Q.Na)(m),Ip=m=>(Ip=Q.Oa)(m),Op=()=>(Op=Q.Pa)();function __(){0<Ht||(h?(l(c),h||au(Ct),startWorker(c)):(au(dn),0<Ht||du||(du=!0,c.calledRun=!0,We||(h||au(Ct),l(c),h||au(Ar)))))}return c.___start_em_js=838360,c.___stop_em_js=838421,c.stackSave=()=>Op(),c.stackRestore=m=>fu(m),c.stackAlloc=m=>Ip(m),c.UTF8ToString=ol,c.stringToUTF8=sl,c.lengthBytesUTF8=Uw,Gt=function m(){du||__(),du||(Gt=m)},__(),s})}),DR=u0,globalThis.self?.name==="em-pthread"&&u0()}),Wa,KA,ZA,QA,d0,IR,JA,OR,fp=P(()=>{"use strict";hw(),Wa=import.meta.url??(typeof document<"u"?document.currentScript?.src:typeof self<"u"?self.location?.href:void 0),KA=typeof location>"u"?void 0:location.origin,ZA=(t,e)=>{try{let n=e??Wa;return(n?new URL(t,n):new URL(t)).origin===KA}catch{return!1}},QA=t=>R(void 0,null,function*(){let e=yield(yield fetch(t,{credentials:"same-origin"})).blob();return URL.createObjectURL(e)}),d0=(X8(),tp(ER)).default,IR=()=>R(void 0,null,function*(){if(!Wa)throw new Error("Failed to load proxy worker: cannot determine the script source URL.");if(ZA(Wa))return[void 0,d0()];let t=yield QA(Wa);return[t,d0(t)]}),JA=(K8(),tp(SR)).default,OR=(t,e,n)=>R(void 0,null,function*(){return[void 0,JA]})}),h0,Kf,kc,f0,eM,tM,fw,Ut,nl=P(()=>{"use strict";fp(),Kf=!1,kc=!1,f0=!1,eM=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},tM=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},fw=t=>R(void 0,null,function*(){if(Kf)return Promise.resolve();if(kc)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(f0)throw new Error("previous call to 'initializeWebAssembly()' failed.");kc=!0;let e=t.initTimeout,n=t.numThreads;if(!tM())throw new Error("WebAssembly SIMD is not supported in the current environment.");let r=eM();n>1&&!r&&(typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+n+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),t.numThreads=n=1);let i=t.wasmPaths,o=typeof i=="string"?i:void 0,l=i?.mjs,a=l?.href??l,c=i?.wasm,s=c?.href??c,u=t.wasmBinary,[d,h]=yield OR(a,o,n>1),f=!1,p=[];if(e>0&&p.push(new Promise(g=>{setTimeout(()=>{f=!0,g()},e)})),p.push(new Promise((g,y)=>{let b={numThreads:n};u?b.wasmBinary=u:(s||o)&&(b.locateFile=(v,_)=>s??(o??_)+v),h(b).then(v=>{kc=!1,Kf=!0,h0=v,g(),d&&URL.revokeObjectURL(d)},v=>{kc=!1,f0=!0,y(v)})})),yield Promise.race(p),f)throw new Error(`WebAssembly backend initializing failed due to timeout: ${e}ms`)}),Ut=()=>{if(Kf&&h0)return h0;throw new Error("WebAssembly is not initialized yet.")}}),Mt,sp,wt,pw=P(()=>{"use strict";nl(),Mt=(t,e)=>{let n=Ut(),r=n.lengthBytesUTF8(t)+1,i=n._malloc(r);return n.stringToUTF8(t,i,r),e.push(i),i},sp=(t,e,n,r)=>{if(typeof t=="object"&&t!==null){if(n.has(t))throw new Error("Circular reference in options");n.add(t)}Object.entries(t).forEach(([i,o])=>{let l=e?e+i:i;if(typeof o=="object")sp(o,l+".",n,r);else if(typeof o=="string"||typeof o=="number")r(l,o.toString());else if(typeof o=="boolean")r(l,o?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof o}`)})},wt=t=>{let e=Ut(),n=e.stackSave();try{let r=e.stackAlloc(8);e._OrtGetLastError(r,r+4);let i=e.HEAP32[r/4],o=e.HEAPU32[r/4+1],l=o?e.UTF8ToString(o):"";throw new Error(`${t} ERROR_CODE: ${i}, ERROR_MESSAGE: ${l}`)}finally{e.stackRestore(n)}}}),AR,Z8=P(()=>{"use strict";nl(),pw(),AR=t=>{let e=Ut(),n=0,r=[],i=t||{};try{if(t?.logSeverityLevel===void 0)i.logSeverityLevel=2;else if(typeof t.logSeverityLevel!="number"||!Number.isInteger(t.logSeverityLevel)||t.logSeverityLevel<0||t.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${t.logSeverityLevel}`);if(t?.logVerbosityLevel===void 0)i.logVerbosityLevel=0;else if(typeof t.logVerbosityLevel!="number"||!Number.isInteger(t.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${t.logVerbosityLevel}`);t?.terminate===void 0&&(i.terminate=!1);let o=0;return t?.tag!==void 0&&(o=Mt(t.tag,r)),n=e._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,o),n===0&&wt("Can't create run options."),t?.extra!==void 0&&sp(t.extra,"",new WeakSet,(l,a)=>{let c=Mt(l,r),s=Mt(a,r);e._OrtAddRunConfigEntry(n,c,s)!==0&&wt(`Can't set a run config entry: ${l} - ${a}.`)}),[n,r]}catch(o){throw n!==0&&e._OrtReleaseRunOptions(n),r.forEach(l=>e._free(l)),o}}}),nM,rM,iM,oM,MR,Q8=P(()=>{"use strict";nl(),pw(),nM=t=>{switch(t){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${t}`)}},rM=t=>{switch(t){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${t}`)}},iM=t=>{t.extra||(t.extra={}),t.extra.session||(t.extra.session={});let e=t.extra.session;e.use_ort_model_bytes_directly||(e.use_ort_model_bytes_directly="1"),t.executionProviders&&t.executionProviders.some(n=>(typeof n=="string"?n:n.name)==="webgpu")&&(t.enableMemPattern=!1)},oM=(t,e,n)=>{for(let r of e){let i=typeof r=="string"?r:r.name;switch(i){case"webnn":if(i="WEBNN",typeof r!="string"){let l=r?.deviceType;if(l){let a=Mt("deviceType",n),c=Mt(l,n);Ut()._OrtAddSessionConfigEntry(t,a,c)!==0&&wt(`Can't set a session config entry: 'deviceType' - ${l}.`)}}break;case"webgpu":if(i="JS",typeof r!="string"){let l=r;if(l?.preferredLayout){if(l.preferredLayout!=="NCHW"&&l.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${l.preferredLayout}`);let a=Mt("preferredLayout",n),c=Mt(l.preferredLayout,n);Ut()._OrtAddSessionConfigEntry(t,a,c)!==0&&wt(`Can't set a session config entry: 'preferredLayout' - ${l.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${i}`)}let o=Mt(i,n);Ut()._OrtAppendExecutionProvider(t,o)!==0&&wt(`Can't append execution provider: ${i}.`)}},MR=t=>{let e=Ut(),n=0,r=[],i=t||{};iM(i);try{let o=nM(i.graphOptimizationLevel??"all"),l=rM(i.executionMode??"sequential"),a=typeof i.logId=="string"?Mt(i.logId,r):0,c=i.logSeverityLevel??2;if(!Number.isInteger(c)||c<0||c>4)throw new Error(`log serverity level is not valid: ${c}`);let s=i.logVerbosityLevel??0;if(!Number.isInteger(s)||s<0||s>4)throw new Error(`log verbosity level is not valid: ${s}`);let u=typeof i.optimizedModelFilePath=="string"?Mt(i.optimizedModelFilePath,r):0;if(n=e._OrtCreateSessionOptions(o,!!i.enableCpuMemArena,!!i.enableMemPattern,l,!!i.enableProfiling,0,a,c,s,u),n===0&&wt("Can't create session options."),i.executionProviders&&oM(n,i.executionProviders,r),i.enableGraphCapture!==void 0){if(typeof i.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${i.enableGraphCapture}`);let d=Mt("enableGraphCapture",r),h=Mt(i.enableGraphCapture.toString(),r);e._OrtAddSessionConfigEntry(n,d,h)!==0&&wt(`Can't set a session config entry: 'enableGraphCapture' - ${i.enableGraphCapture}.`)}if(i.freeDimensionOverrides)for(let[d,h]of Object.entries(i.freeDimensionOverrides)){if(typeof d!="string")throw new Error(`free dimension override name must be a string: ${d}`);if(typeof h!="number"||!Number.isInteger(h)||h<0)throw new Error(`free dimension override value must be a non-negative integer: ${h}`);let f=Mt(d,r);e._OrtAddFreeDimensionOverride(n,f,h)!==0&&wt(`Can't set a free dimension override: ${d} - ${h}.`)}return i.extra!==void 0&&sp(i.extra,"",new WeakSet,(d,h)=>{let f=Mt(d,r),p=Mt(h,r);e._OrtAddSessionConfigEntry(n,f,p)!==0&&wt(`Can't set a session config entry: ${d} - ${h}.`)}),[n,r]}catch(o){throw n!==0&&e._OrtReleaseSessionOptions(n),r.forEach(l=>e._free(l)),o}}}),zc,PR,Wc,NR,RR,gw,mw,kR,FR=P(()=>{"use strict";zc=t=>{switch(t){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw new Error(`unsupported data type: ${t}`)}},PR=t=>{switch(t){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw new Error(`unsupported data type: ${t}`)}},Wc=(t,e)=>{let n=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][t],r=typeof e=="number"?e:e.reduce((i,o)=>i*o,1);return n>0?Math.ceil(r*n):void 0},NR=t=>{switch(t){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${t}`)}},RR=t=>{switch(t){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${t}`)}},gw=t=>t==="float32"||t==="float16"||t==="int32"||t==="int64"||t==="uint32"||t==="uint8"||t==="bool"||t==="uint4"||t==="int4",mw=t=>t==="float32"||t==="float16"||t==="int32"||t==="int64"||t==="uint32"||t==="uint64"||t==="int8"||t==="uint8"||t==="bool",kR=t=>{switch(t){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw new Error(`unsupported data location: ${t}`)}}}),yw,LR=P(()=>{"use strict";hw(),yw=t=>R(void 0,null,function*(){if(typeof t=="string")if(0)try{}catch(o){if(o.code==="ERR_FS_FILE_TOO_LARGE")try{for(var e=cee(a),n,r,i;n=!(r=yield e.next()).done;n=!1){let s=r.value;;}}catch(r){i=[r]}finally{try{n&&(r=e.return)&&(yield r.call(e))}finally{if(i)throw i[0]}}}else{let o=yield fetch(t);if(!o.ok)throw new Error(`failed to load external data file: ${t}`);let l=o.headers.get("Content-Length"),a=l?parseInt(l,10):0;if(a<1073741824)return new Uint8Array(yield o.arrayBuffer());{if(!o.body)throw new Error(`failed to load external data file: ${t}, no response body.`);let c=o.body.getReader(),s;try{s=new ArrayBuffer(a)}catch(d){if(d instanceof RangeError){let h=Math.ceil(a/65536);s=new WebAssembly.Memory({initial:h,maximum:h}).buffer}else throw d}let u=0;for(;;){let{done:d,value:h}=yield c.read();if(d)break;let f=h.byteLength;new Uint8Array(s,u,f).set(h),u+=f}return new Uint8Array(s,0,a)}}else return t instanceof Blob?new Uint8Array(yield t.arrayBuffer()):t instanceof Uint8Array?t:new Uint8Array(t)})}),sM,vw,bw,os,aM,ap,ww,_w,p0,Tw,xw,Ew,BR=P(()=>{"use strict";Z8(),Q8(),FR(),nl(),pw(),LR(),sM=(t,e)=>{Ut()._OrtInit(t,e)!==0&&wt("Can't initialize onnxruntime.")},vw=t=>R(void 0,null,function*(){sM(t.wasm.numThreads,RR(t.logLevel))}),bw=(t,e)=>R(void 0,null,function*(){}),os=new Map,aM=t=>{let e=Ut(),n=e.stackSave();try{let r=e.stackAlloc(8);return e._OrtGetInputOutputCount(t,r,r+4)!==0&&wt("Can't get session input/output count."),[e.HEAP32[r/4],e.HEAP32[r/4+1]]}finally{e.stackRestore(n)}},ap=t=>{let e=Ut(),n=e._malloc(t.byteLength);if(n===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${t.byteLength}.`);return e.HEAPU8.set(t,n),[n,t.byteLength]},ww=(t,e)=>R(void 0,null,function*(){let n,r,i=Ut();Array.isArray(t)?[n,r]=t:t.buffer===i.HEAPU8.buffer?[n,r]=[t.byteOffset,t.byteLength]:[n,r]=ap(t);let o=0,l=0,a=0,c=[],s=[],u=[];try{if([l,c]=MR(e),e?.externalData&&i.mountExternalData){let v=[];for(let _ of e.externalData){let I=typeof _=="string"?_:_.path;v.push(yw(typeof _=="string"?_:_.data).then(k=>{i.mountExternalData(I,k)}))}yield Promise.all(v)}for(let v of e?.executionProviders??[])if((typeof v=="string"?v:v.name)==="webnn"){if(i.shouldTransferToMLTensor=!1,i.currentContext)throw new Error("WebNN execution provider is already set.");if(typeof v!="string"){let _=v,I=_?.context,k=_?.gpuDevice,V=_?.deviceType,G=_?.numThreads,j=_?.powerPreference;I?i.currentContext=I:k?i.currentContext=yield navigator.ml.createContext(k):i.currentContext=yield navigator.ml.createContext({deviceType:V,numThreads:G,powerPreference:j})}else i.currentContext=yield navigator.ml.createContext();break}o=yield i._OrtCreateSession(n,r,l),o===0&&wt("Can't create a session."),i.currentContext&&(i.jsepRegisterMLContext(o,i.currentContext),i.currentContext=void 0,i.shouldTransferToMLTensor=!0);let[d,h]=aM(o),f=!!e?.enableGraphCapture,p=[],g=[],y=[];for(let v=0;v<d;v++){let _=i._OrtGetInputName(o,v);_===0&&wt("Can't get an input name."),s.push(_),p.push(i.UTF8ToString(_))}for(let v=0;v<h;v++){let _=i._OrtGetOutputName(o,v);_===0&&wt("Can't get an output name."),u.push(_);let I=i.UTF8ToString(_);g.push(I)}return os.set(o,[o,s,u,null,f,!1]),[o,p,g]}catch(d){throw s.forEach(h=>i._OrtFree(h)),u.forEach(h=>i._OrtFree(h)),a!==0&&i._OrtReleaseBinding(a),o!==0&&i._OrtReleaseSession(o),d}finally{i._free(n),l!==0&&i._OrtReleaseSessionOptions(l),c.forEach(d=>i._free(d)),i.unmountExternalData?.()}}),_w=t=>{let e=Ut(),n=os.get(t);if(!n)throw new Error(`cannot release session. invalid session id: ${t}`);let[r,i,o,l,a]=n;l&&(a&&e._OrtClearBoundOutputs(l.handle),e._OrtReleaseBinding(l.handle)),e.jsepOnReleaseSession?.(t),i.forEach(c=>e._OrtFree(c)),o.forEach(c=>e._OrtFree(c)),e._OrtReleaseSession(r),os.delete(t)},p0=(t,e,n,r,i,o=!1)=>{if(!t){e.push(0);return}let l=Ut(),a=t[0],c=t[1],s=t[3],u,d;if(a==="string"&&(s==="gpu-buffer"||s==="ml-tensor"))throw new Error("String tensor is not supported on GPU.");if(o&&s!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${i} when enableGraphCapture is true.`);if(s==="gpu-buffer"){let p=t[2].gpuBuffer;d=Wc(zc(a),c);let g=l.jsepRegisterBuffer;if(!g)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');u=g(r,i,p,d)}else if(s==="ml-tensor"){let p=t[2].mlTensor;d=Wc(zc(a),c);let g=l.jsepRegisterMLTensor;if(!g)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');u=g(p,zc(a),c)}else{let p=t[2];if(Array.isArray(p)){d=4*p.length,u=l._malloc(d),n.push(u);let g=u/4;for(let y=0;y<p.length;y++){if(typeof p[y]!="string")throw new TypeError(`tensor data at index ${y} is not a string`);l.HEAPU32[g++]=Mt(p[y],n)}}else d=p.byteLength,u=l._malloc(d),n.push(u),l.HEAPU8.set(new Uint8Array(p.buffer,p.byteOffset,d),u)}let h=l.stackSave(),f=l.stackAlloc(4*c.length);try{let p=f/4;c.forEach(y=>l.HEAP32[p++]=y);let g=l._OrtCreateTensor(zc(a),u,d,f,c.length,kR(s));g===0&&wt(`Can't create tensor for input/output. session=${r}, index=${i}.`),e.push(g)}finally{l.stackRestore(h)}},Tw=(t,e,n,r,i,o)=>R(void 0,null,function*(){let l=Ut(),a=os.get(t);if(!a)throw new Error(`cannot run inference. invalid session id: ${t}`);let c=a[0],s=a[1],u=a[2],d=a[3],h=a[4],f=a[5],p=e.length,g=r.length,y=0,b=[],v=[],_=[],I=[],k=l.stackSave(),V=l.stackAlloc(p*4),G=l.stackAlloc(p*4),j=l.stackAlloc(g*4),ge=l.stackAlloc(g*4);try{l.jsepOnRunStart?.(c),[y,b]=AR(o);for(let ee=0;ee<p;ee++)p0(n[ee],v,I,t,e[ee],h);for(let ee=0;ee<g;ee++)p0(i[ee],_,I,t,p+r[ee],h);let Z=V/4,Be=G/4,me=j/4,we=ge/4;for(let ee=0;ee<p;ee++)l.HEAPU32[Z++]=v[ee],l.HEAPU32[Be++]=s[e[ee]];for(let ee=0;ee<g;ee++)l.HEAPU32[me++]=_[ee],l.HEAPU32[we++]=u[r[ee]];let Se;Se=yield l._OrtRun(c,G,V,p,ge,g,j,y),Se!==0&&wt("failed to call OrtRun().");let ke=[];for(let ee=0;ee<g;ee++){let ct=l.HEAPU32[j/4+ee];if(ct===_[ee]){ke.push(i[ee]);continue}let Fe=l.stackSave(),ze=l.stackAlloc(4*4),Nt=!1,We,Ke=0;try{l._OrtGetTensorData(ct,ze,ze+4,ze+8,ze+12)!==0&&wt(`Can't access output tensor data on index ${ee}.`);let dn=ze/4,Ct=l.HEAPU32[dn++];Ke=l.HEAPU32[dn++];let Ar=l.HEAPU32[dn++],Ht=l.HEAPU32[dn++],St=[];for(let Ae=0;Ae<Ht;Ae++)St.push(l.HEAPU32[Ar/4+Ae]);l._OrtFree(Ar);let Gt=St.reduce((Ae,gt)=>Ae*gt,1);We=PR(Ct);let Xn=d?.outputPreferredLocations[r[ee]];if(We==="string"){if(Xn==="gpu-buffer"||Xn==="ml-tensor")throw new Error("String tensor is not supported on GPU.");let Ae=[],gt=Ke/4;for(let Mr=0;Mr<Gt;Mr++){let rl=l.HEAPU32[gt++],su=Mr===Gt-1?void 0:l.HEAPU32[gt]-rl;Ae.push(l.UTF8ToString(rl,su))}ke.push([We,St,Ae,"cpu"])}else if(Xn==="gpu-buffer"&&Gt>0){let Ae=l.jsepGetBuffer;if(!Ae)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let gt=Ae(Ke),Mr=Wc(Ct,Gt);if(Mr===void 0||!gw(We))throw new Error(`Unsupported data type: ${We}`);Nt=!0,ke.push([We,St,{gpuBuffer:gt,download:l.jsepCreateDownloader(gt,Mr,We),dispose:()=>{l._OrtReleaseTensor(ct)}},"gpu-buffer"])}else if(Xn==="ml-tensor"&&Gt>0){let Ae=l.jsepEnsureTensor;if(!Ae)throw new Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(Wc(Ct,Gt)===void 0||!mw(We))throw new Error(`Unsupported data type: ${We}`);let gt=yield Ae(Ke,Ct,St,!1);Nt=!0,ke.push([We,St,{mlTensor:gt,download:l.jsepCreateMLTensorDownloader(Ke,We),dispose:()=>{l.jsepReleaseTensorId(Ke),l._OrtReleaseTensor(ct)}},"ml-tensor"])}else{let Ae=NR(We),gt=new Ae(Gt);new Uint8Array(gt.buffer,gt.byteOffset,gt.byteLength).set(l.HEAPU8.subarray(Ke,Ke+gt.byteLength)),ke.push([We,St,gt,"cpu"])}}finally{l.stackRestore(Fe),We==="string"&&Ke&&l._free(Ke),Nt||l._OrtReleaseTensor(ct)}}return d&&!h&&(l._OrtClearBoundOutputs(d.handle),os.set(t,[c,s,u,d,h,!1])),ke}finally{l.stackRestore(k),v.forEach(Z=>l._OrtReleaseTensor(Z)),_.forEach(Z=>l._OrtReleaseTensor(Z)),I.forEach(Z=>l._free(Z)),y!==0&&l._OrtReleaseRunOptions(y),b.forEach(Z=>l._free(Z))}}),xw=t=>{let e=Ut(),n=os.get(t);if(!n)throw new Error("invalid session id");let r=n[0],i=e._OrtEndProfiling(r);i===0&&wt("Can't get an profile file name."),e._OrtFree(i)},Ew=t=>{let e=[];for(let n of t){let r=n[2];!Array.isArray(r)&&"buffer"in r&&e.push(r.buffer)}return e}}),Yi,Gn,za,Fc,Lc,Zf,g0,Qf,ss,as,lM,jR,VR,$R,UR,HR,GR,zR,WR=P(()=>{"use strict";Or(),BR(),nl(),fp(),Yi=()=>!!de.wasm.proxy&&typeof document<"u",za=!1,Fc=!1,Lc=!1,Qf=new Map,ss=(t,e)=>{let n=Qf.get(t);n?n.push(e):Qf.set(t,[e])},as=()=>{if(za||!Fc||Lc||!Gn)throw new Error("worker not ready")},lM=t=>{switch(t.data.type){case"init-wasm":za=!1,t.data.err?(Lc=!0,g0[1](t.data.err)):(Fc=!0,g0[0]()),Zf&&(URL.revokeObjectURL(Zf),Zf=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let e=Qf.get(t.data.type);t.data.err?e.shift()[1](t.data.err):e.shift()[0](t.data.out);break}default:}},jR=()=>R(void 0,null,function*(){if(!Fc){if(za)throw new Error("multiple calls to 'initWasm()' detected.");if(Lc)throw new Error("previous call to 'initWasm()' failed.");if(za=!0,Yi())return new Promise((t,e)=>{Gn?.terminate(),IR().then(([n,r])=>{try{Gn=r,Gn.onerror=o=>e(o),Gn.onmessage=lM,g0=[t,e];let i={type:"init-wasm",in:de};Gn.postMessage(i),Zf=n}catch(i){e(i)}},e)});try{yield fw(de.wasm),yield vw(de),Fc=!0}catch(t){throw Lc=!0,t}finally{za=!1}}}),VR=t=>R(void 0,null,function*(){if(Yi())return as(),new Promise((e,n)=>{ss("init-ep",[e,n]);let r={type:"init-ep",in:{epName:t,env:de}};Gn.postMessage(r)});yield bw(de,t)}),$R=t=>R(void 0,null,function*(){return Yi()?(as(),new Promise((e,n)=>{ss("copy-from",[e,n]);let r={type:"copy-from",in:{buffer:t}};Gn.postMessage(r,[t.buffer])})):ap(t)}),UR=(t,e)=>R(void 0,null,function*(){if(Yi()){if(e?.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return as(),new Promise((n,r)=>{ss("create",[n,r]);let i={type:"create",in:{model:t,options:C({},e)}},o=[];t instanceof Uint8Array&&o.push(t.buffer),Gn.postMessage(i,o)})}else return ww(t,e)}),HR=t=>R(void 0,null,function*(){if(Yi())return as(),new Promise((e,n)=>{ss("release",[e,n]);let r={type:"release",in:t};Gn.postMessage(r)});_w(t)}),GR=(t,e,n,r,i,o)=>R(void 0,null,function*(){if(Yi()){if(n.some(l=>l[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(i.some(l=>l))throw new Error("pre-allocated output tensor is not supported for proxy.");return as(),new Promise((l,a)=>{ss("run",[l,a]);let c=n,s={type:"run",in:{sessionId:t,inputIndices:e,inputs:c,outputIndices:r,options:o}};Gn.postMessage(s,Ew(c))})}else return Tw(t,e,n,r,i,o)}),zR=t=>R(void 0,null,function*(){if(Yi())return as(),new Promise((e,n)=>{ss("end-profiling",[e,n]);let r={type:"end-profiling",in:t};Gn.postMessage(r)});xw(t)})}),m0,cM,qR,J8=P(()=>{"use strict";Or(),WR(),FR(),hw(),LR(),m0=(t,e)=>{switch(t.location){case"cpu":return[t.type,t.dims,t.data,"cpu"];case"gpu-buffer":return[t.type,t.dims,{gpuBuffer:t.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[t.type,t.dims,{mlTensor:t.mlTensor},"ml-tensor"];default:throw new Error(`invalid data location: ${t.location} for ${e()}`)}},cM=t=>{switch(t[3]){case"cpu":return new Et(t[0],t[2],t[1]);case"gpu-buffer":{let e=t[0];if(!gw(e))throw new Error(`not supported data type: ${e} for deserializing GPU tensor`);let{gpuBuffer:n,download:r,dispose:i}=t[2];return Et.fromGpuBuffer(n,{dataType:e,dims:t[1],download:r,dispose:i})}case"ml-tensor":{let e=t[0];if(!mw(e))throw new Error(`not supported data type: ${e} for deserializing MLTensor tensor`);let{mlTensor:n,download:r,dispose:i}=t[2];return Et.fromMLTensor(n,{dataType:e,dims:t[1],download:r,dispose:i})}default:throw new Error(`invalid data location: ${t[3]}`)}},qR=class{fetchModelAndCopyToWasmMemory(t){return R(this,null,function*(){return $R(yield yw(t))})}loadModel(t,e){return R(this,null,function*(){Xa();let n;typeof t=="string"?n=yield this.fetchModelAndCopyToWasmMemory(t):n=t,[this.sessionId,this.inputNames,this.outputNames]=yield UR(n,e),Ka()})}dispose(){return R(this,null,function*(){return HR(this.sessionId)})}run(t,e,n){return R(this,null,function*(){Xa();let r=[],i=[];Object.entries(t).forEach(d=>{let h=d[0],f=d[1],p=this.inputNames.indexOf(h);if(p===-1)throw new Error(`invalid input '${h}'`);r.push(f),i.push(p)});let o=[],l=[];Object.entries(e).forEach(d=>{let h=d[0],f=d[1],p=this.outputNames.indexOf(h);if(p===-1)throw new Error(`invalid output '${h}'`);o.push(f),l.push(p)});let a=r.map((d,h)=>m0(d,()=>`input "${this.inputNames[i[h]]}"`)),c=o.map((d,h)=>d?m0(d,()=>`output "${this.outputNames[l[h]]}"`):null),s=yield GR(this.sessionId,i,a,l,c,n),u={};for(let d=0;d<s.length;d++)u[this.outputNames[l[d]]]=o[d]??cM(s[d]);return Ka(),u})}startProfiling(){}endProfiling(){zR(this.sessionId)}}}),YR={};tu(YR,{OnnxruntimeWebAssemblyBackend:()=>Q0,initializeFlags:()=>Z0,wasmBackend:()=>XR});var Z0,Q0,XR,eW=P(()=>{"use strict";Or(),WR(),J8(),fp(),Z0=()=>{if((typeof de.wasm.initTimeout!="number"||de.wasm.initTimeout<0)&&(de.wasm.initTimeout=0),de.wasm.simd===!1&&console.warn('Deprecated property "env.wasm.simd" is set to false. non-SIMD build is no longer provided, and this setting will be ignored.'),typeof de.wasm.proxy!="boolean"&&(de.wasm.proxy=!1),typeof de.wasm.trace!="boolean"&&(de.wasm.trace=!1),typeof de.wasm.numThreads!="number"||!Number.isInteger(de.wasm.numThreads)||de.wasm.numThreads<=0)if(typeof self<"u"&&!self.crossOriginIsolated)de.wasm.numThreads=1;else{let t=typeof navigator>"u"?nz("node:os").cpus().length:navigator.hardwareConcurrency;de.wasm.numThreads=Math.min(4,Math.ceil((t||1)/2))}},Q0=class{init(t){return R(this,null,function*(){Z0(),yield jR(),yield VR(t)})}createInferenceSessionHandler(t,e){return R(this,null,function*(){let n=new qR;return yield n.loadModel(t,e),Promise.resolve(n)})}},XR=new Q0});Or();Or();Or();var tW="1.20.1",uee=OM;{let t=(Y8(),tp(TR)).onnxjsBackend;Zc("webgl",t,-10)}{let t=(eW(),tp(YR)).wasmBackend;Zc("cpu",t,10),Zc("wasm",t,10)}Object.defineProperty(de.versions,"web",{value:tW,enumerable:!0});var pp=class t{constructor(e){this.downloadService=e;this.session=this.loadResources()}session;loadResources(){return R(this,null,function*(){let e="assets/onnxruntime-web/ort-wasm-simd-threaded.wasm",n="assets/models/best.onnx",[r,i]=yield this.downloadService.loadResources([e,n]);return de.wasm.wasmBinary=r,cp.create(i)})}annotate(e){return R(this,null,function*(){let[n,r,i]=yield this.prepare_input(e),o=new Et(Float32Array.from(n),[1,3,640,640]),a=yield(yield this.session).run({images:o});return this.process_output(a.output0.data,r,i)})}iou(e,n){return this.intersection(e,n)/this.union(e,n)}union(e,n){let r=e.width*e.height,i=n.width*n.height;return r+i-this.intersection(e,n)}intersection(e,n){let r=e.x,i=e.y,o=e.x+e.width,l=e.y+e.height,a=n.x,c=n.y,s=n.x+n.width,u=n.y+n.height,d=Math.max(r,a),h=Math.max(i,c),f=Math.min(o,s),p=Math.min(l,u);return f<=d||p<=h?0:(f-d)*(p-h)}resizeAndPadTo640(e){return R(this,null,function*(){return new Promise((n,r)=>{let i=new Image;i.src=e,i.onload=()=>{let o=640/Math.max(i.width,i.height),l=Math.round(i.width*o),a=Math.round(i.height*o),c=document.createElement("canvas");c.width=640,c.height=640;let s=c.getContext("2d");if(!s){r("Canvas context is not supported");return}s.fillStyle="black",s.fillRect(0,0,640,640);let u=(640-l)/2,d=(640-a)/2;s.drawImage(i,u,d,l,a),n({imageData:s.getImageData(0,0,640,640),imgWidth:i.width,imgHeight:i.height})},i.onerror=o=>r(o)})})}prepare_input(e){return R(this,null,function*(){return new Promise(n=>{let r=new Image;r.src=e,r.onload=()=>{let[i,o]=[r.width,r.height],l=document.createElement("canvas");l.width=640,l.height=640;let a=l.getContext("2d");if(!a)throw new Error("Could not get context");a.drawImage(r,0,0,640,640);let s=a.getImageData(0,0,640,640).data,u=[],d=[],h=[];for(let p=0;p<s.length;p+=4)u.push(s[p]/255),d.push(s[p+1]/255),h.push(s[p+2]/255);let f=[...u,...d,...h];n([f,i,o])}})})}process_output(e,n,r){let i=[];for(let a=0;a<8400;a++){let[c,s]=[...Array(267).keys()].map(_=>[_,e[8400*(_+4)+a]]).reduce((_,I)=>I[1]>_[1]?I:_,[0,0]);if(s<.5)continue;let u=c,d=e[a],h=e[8400+a],f=e[2*8400+a],p=e[3*8400+a],g=d/640*n,y=h/640*r,b=f/640*n,v=p/640*r;i.push({class:u,class_id:c,confidence:s,detection_id:"",x:g,y,width:b,height:v})}i=i.sort((a,c)=>c.class_id-a.class_id);let o=[];for(;i.length>0;)o.push(i[0]),i=i.filter(a=>this.iou(i[0],a)<.7);return{time:0,image:{width:n,height:r},predictions:o}}static \u0275fac=function(n){return new(n||t)(Y(Ga))};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})};var iW=t=>["/edit",t];function oW(t,e){t&1&&(J(0,"span",36)(1,"span",37),vt(2,"Loading..."),X()())}function sW(t,e){if(t&1&&(J(0,"div",32)(1,"a",33),tt(2,"img",34),Ge(3,oW,3,0,"span",35),X()()),t&2){let n=Lt(),r=n.$implicit,i=n.index;ie(),Te("routerLink",r.annotations?aC(3,iW,i):null),ie(),Te("src",r.boardGame,Om),ie(),Te("ngIf",!r.annotations)}}function aW(t,e){if(t&1){let n=Il();J(0,"tr")(1,"td")(2,"input",24),Al("ngModelChange",function(i){let o=yr(n).$implicit;return Qd(o.name,i)||(o.name=i),vr(i)}),X()(),J(3,"td")(4,"button",25),At("click",function(){yr(n);let i=qm(7);return vr(i.click())}),tt(5,"i",26),X(),J(6,"input",27,0),At("change",function(i){let o=yr(n).index,l=Lt();return vr(l.onFileSelected(o,i))}),X(),J(8,"button",25),At("click",function(){yr(n);let i=qm(11);return vr(i.click())}),tt(9,"i",28),X(),J(10,"input",29,1),At("change",function(i){let o=yr(n).index,l=Lt();return vr(l.onFileSelected(o,i))}),X(),Ge(12,sW,4,5,"div",30),X(),J(13,"td")(14,"input",31),Al("ngModelChange",function(i){let o=yr(n).$implicit;return Qd(o.cardsInCave,i)||(o.cardsInCave=i),vr(i)}),X()()()}if(t&2){let n=e.$implicit,r=e.index;ie(2),Ol("ngModel",n.name),Te("placeholder","Player"+(r+1)),ie(10),Te("ngIf",n.boardGame),ie(2),Ol("ngModel",n.cardsInCave)}}function lW(t,e){if(t&1){let n=Il();J(0,"div",8)(1,"div",38)(2,"input",39),Al("ngModelChange",function(i){yr(n);let o=Lt();return Qd(o.uploadData,i)||(o.uploadData=i),vr(i)}),X(),J(3,"label",40),vt(4," Upload Images to improve Card Detection "),X()()()}if(t&2){let n=Lt();ie(2),Ol("ngModel",n.uploadData)}}function cW(t,e){t&1&&tt(0,"span",41)}function uW(t,e){t&1&&(J(0,"span"),vt(1,"Submit"),X())}function dW(t,e){t&1&&(J(0,"span",37),vt(1,"Loading..."),X())}function hW(t,e){if(t&1&&(J(0,"th"),vt(1),X()),t&2){let n=e.$implicit;ie(),vn(" ",n.playerName," ")}}function fW(t,e){if(t&1&&(J(0,"div"),vt(1),X()),t&2){let n=Lt().$implicit;ie(),vn(" ",n.treePoints()," ")}}function pW(t,e){if(t&1&&(J(0,"td"),Ge(1,fW,2,1,"div",12),X()),t&2){let n=e.$implicit;ie(),Te("ngIf",n)}}function gW(t,e){if(t&1&&(J(0,"div"),vt(1),X()),t&2){let n=Lt().$implicit;ie(),vn(" ",n.topPoints()," ")}}function mW(t,e){if(t&1&&(J(0,"td"),Ge(1,gW,2,1,"div",12),X()),t&2){let n=e.$implicit;ie(),Te("ngIf",n)}}function yW(t,e){if(t&1&&(J(0,"div"),vt(1),X()),t&2){let n=Lt().$implicit;ie(),vn(" ",n.bottomPoints()," ")}}function vW(t,e){if(t&1&&(J(0,"td"),Ge(1,yW,2,1,"div",12),X()),t&2){let n=e.$implicit;ie(),Te("ngIf",n)}}function bW(t,e){if(t&1&&(J(0,"div"),vt(1),X()),t&2){let n=Lt().$implicit;ie(),vn(" ",n.sidePoints()," ")}}function wW(t,e){if(t&1&&(J(0,"td"),Ge(1,bW,2,1,"div",12),X()),t&2){let n=e.$implicit;ie(),Te("ngIf",n)}}function _W(t,e){if(t&1&&(J(0,"div"),vt(1),X()),t&2){let n=Lt().$implicit;ie(),vn(" ",n.caveCount," ")}}function TW(t,e){if(t&1&&(J(0,"td"),Ge(1,_W,2,1,"div",12),X()),t&2){let n=e.$implicit;ie(),Te("ngIf",n)}}function xW(t,e){if(t&1&&(J(0,"div"),vt(1),X()),t&2){let n=Lt().$implicit;ie(),vn(" ",n.points," ")}}function EW(t,e){if(t&1&&(J(0,"td"),Ge(1,xW,2,1,"div",12),X()),t&2){let n=e.$implicit;ie(),Te("ngIf",n)}}var gp=class t{constructor(e,n,r,i){this.imageAnnotator=e;this.router=n;this.playerService=r;this.headerService=i}allForests=[];isLoading=!1;uploadData=!0;ngOnInit(){this.headerService.setButtons([{label:"",icon:"bi-question-circle",class:"btn-primary",action:this.showHelp,visible:!0}]);for(let[e,n]of this.playerService.players.entries())n.boardGame&&!n.annotations&&this.predictPlayer(e,n.boardGame)}showHelp(e){alert("Help dialog opened")}onFileSelected(e,n){let r=n.target.files[0];if(r){let i=new FileReader;i.onload=o=>R(this,null,function*(){console.log("Image:",o.target.result),yield this.predictPlayer(e,o.target.result)}),i.readAsDataURL(r)}}predictPlayer(e,n){return R(this,null,function*(){try{this.playerService.updatePlayerBoardGame(e,n);let r=yield this.imageAnnotator.annotate(n);this.playerService.players[e].annotations=r}catch(r){console.error("Error annotating image:",r)}})}submit(){return R(this,null,function*(){this.allForests.length=0;try{this.isLoading=!0;let e=this.playerService.players;console.log("Submitted data:",e);for(let[n,r]of e.entries())if(r.annotations){let i=r.name||`Player${n+1}`,o=new Hf(i,this.allForests);this.allForests.push(o);let l=Vf.assembleForest(r.annotations);o.setCards(l),o.caveCount=r.cardsInCave}for(let n of this.allForests)n.updatePoints()}catch(e){alert(e)}finally{this.isLoading=!1,setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}})}static \u0275fac=function(n){return new(n||t)(te(pp),te(Ln),te(Va),te(zi))};static \u0275cmp=br({type:t,selectors:[["app-home"]],decls:58,vars:14,consts:[["fileInputCamera",""],["fileInputImage",""],[1,"container"],[1,"table-responsive"],[1,"table","table-bordered"],["src","glImg/cave.png","alt","cave",1,"icon"],[4,"ngFor","ngForOf"],["class","d-flex justify-content-center mt-3",4,"ngIf"],[1,"d-flex","justify-content-center","mt-3"],[1,"ms-3"],[1,"btn","btn-success",3,"click","disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],[4,"ngIf"],["class","visually-hidden",4,"ngIf"],[1,"mt-3","points",3,"hidden"],["src","glImg/symbols/tree.png","alt","tree","height","24"],["src","glImg/symbols/shrub.png","alt","shrub","height","24"],[1,"point-icon","border","border-2","text-light","border-light","rounded","justify-content-center","align-items-center","d-flex"],[1,"bi","bi-arrow-up"],[1,"bi","bi-arrow-down"],[1,"bi","bi-arrows"],["src","glImg/cave.png","alt","cave"],[2,"border-top","2px solid #000"],["src","glImg/points.png","alt","Total Points"],["type","text",1,"form-control",3,"ngModelChange","ngModel","placeholder"],[1,"btn","btn-primary",3,"click"],[1,"bi","bi-camera"],["type","file","accept","image/*","capture","environment",2,"display","none",3,"change"],[1,"bi","bi-image"],["type","file","accept","image/*",2,"display","none",3,"change"],["style","margin-top: 10px;",4,"ngIf"],["type","number","min","0",1,"form-control",3,"ngModelChange","ngModel"],[2,"margin-top","10px"],[1,"d-flex","justify-content-center","align-items-center",3,"routerLink"],["alt","BoardGame","width","80",2,"border","1px solid #ccc","padding","4px",3,"src"],["class","spinner-border text-primary position-absolute","role","status",4,"ngIf"],["role","status",1,"spinner-border","text-primary","position-absolute"],[1,"visually-hidden"],[1,"form-check","ms-3"],["disabled","","type","checkbox","id","saveDataCheckbox",1,"form-check-input",3,"ngModelChange","ngModel"],["for","saveDataCheckbox",1,"form-check-label"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(n,r){n&1&&(J(0,"div",2),tt(1,"app-download-progress"),X(),J(2,"div",3)(3,"table",4)(4,"thead")(5,"tr")(6,"th"),vt(7,"Name"),X(),J(8,"th"),vt(9,"BoardGame (Picture/Upload)"),X(),J(10,"th"),vt(11,"Cards in Cave "),tt(12,"img",5),X()()(),J(13,"tbody"),Ge(14,aW,15,4,"tr",6),X()()(),Ge(15,lW,5,1,"div",7),J(16,"div",8)(17,"div",9)(18,"button",10),At("click",function(){return r.submit()}),Ge(19,cW,1,0,"span",11)(20,uW,2,0,"span",12)(21,dW,2,0,"span",13),X()()(),J(22,"div",14)(23,"table",4)(24,"thead")(25,"tr"),tt(26,"th"),Ge(27,hW,2,1,"th",6),X()(),J(28,"tbody")(29,"tr")(30,"td"),tt(31,"img",15)(32,"img",16),X(),Ge(33,pW,2,1,"td",6),X(),J(34,"tr")(35,"td")(36,"div",17),tt(37,"i",18),X()(),Ge(38,mW,2,1,"td",6),X(),J(39,"tr")(40,"td")(41,"div",17),tt(42,"i",19),X()(),Ge(43,vW,2,1,"td",6),X(),J(44,"tr")(45,"td")(46,"div",17),tt(47,"i",20),X()(),Ge(48,wW,2,1,"td",6),X(),J(49,"tr")(50,"td"),tt(51,"img",21),X(),Ge(52,TW,2,1,"td",6),X(),J(53,"tr",22)(54,"td")(55,"div"),tt(56,"img",23),X()(),Ge(57,EW,2,1,"td",6),X()()()()),n&2&&(ie(14),Te("ngForOf",r.playerService.players),ie(),Te("ngIf",!1),ie(3),Te("disabled",r.isLoading),ie(),Te("ngIf",r.isLoading),ie(),Te("ngIf",!r.isLoading),ie(),Te("ngIf",r.isLoading),ie(),Te("hidden",r.allForests.length==0),ie(5),Te("ngForOf",r.allForests),ie(6),Te("ngForOf",r.allForests),ie(5),Te("ngForOf",r.allForests),ie(5),Te("ngForOf",r.allForests),ie(5),Te("ngForOf",r.allForests),ie(4),Te("ngForOf",r.allForests),ie(5),Te("ngForOf",r.allForests))},dependencies:[Xr,rh,oa,jf,Lf,Cb,Tb,dI,Sb,Eb,BS,Ph,Gf],styles:[".table[_ngcontent-%COMP%]{margin:20px auto;width:90%;max-width:800px}button[_ngcontent-%COMP%]{margin-right:1rem}.point-icon[_ngcontent-%COMP%]{width:24px;height:24px;background-color:#1d931d}.points[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], img.icon[_ngcontent-%COMP%]{max-width:24px;max-height:24px}.points[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:24px;height:24px;text-align:center}"]})};var KR=[{path:"",component:gp},{path:"edit/:playerNumber",component:Mf}];var ZR={providers:[uC({eventCoalescing:!0}),VS(KR,tv()),jC()]};function CW(t,e){if(t&1&&tt(0,"i",6),t&2){let n=Lt().$implicit;Te("ngClass",n.icon)}}function SW(t,e){if(t&1){let n=Il();zm(0),J(1,"button",4),At("click",function(){let i=yr(n).$implicit;return vr(i.action(i))}),Ge(2,CW,1,1,"i",5),vt(3),X(),Wm()}if(t&2){let n=e.$implicit;ie(),ea("visibility",n.visible?"visible":"hidden"),Te("ngClass",n.class),ie(),Te("ngIf",n.icon),ie(),vn(" ",n.label," ")}}var mp=class t{constructor(e){this.headerService=e}static \u0275fac=function(n){return new(n||t)(te(zi))};static \u0275cmp=br({type:t,selectors:[["app-root"]],decls:6,vars:3,consts:[["id","navBar",1,"navbar","navbar-expand-lg","navbar-light","bg-success"],[1,"container","container-fluid"],[1,"ms-auto"],[4,"ngFor","ngForOf"],[1,"btn","btn-outline-dark","me-4",3,"click","ngClass"],["class","bi",3,"ngClass",4,"ngIf"],[1,"bi",3,"ngClass"]],template:function(n,r){n&1&&(J(0,"nav",0)(1,"div",1)(2,"div",2),Ge(3,SW,4,5,"ng-container",3),na(4,"async"),X()()(),tt(5,"router-outlet")),n&2&&(ie(3),Te("ngForOf",ra(4,1,r.headerService.buttons$)))},dependencies:[Xr,EC,rh,oa,ih,jf,Ph,Xy],encapsulation:2})};XC(mp,ZR).catch(t=>console.error(t));
